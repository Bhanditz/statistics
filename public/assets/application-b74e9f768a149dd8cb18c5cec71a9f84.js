/*!
 * jQuery JavaScript Library v1.10.2
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-07-03T13:48Z
 */
(function(window,undefined){var readyList,rootjQuery,core_strundefined=typeof undefined,location=window.location,document=window.document,docElem=document.documentElement,_jQuery=window.jQuery,_$=window.$,class2type={},core_deletedIds=[],core_version="1.10.2",core_concat=core_deletedIds.concat,core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_indexOf=core_deletedIds.indexOf,core_toString=class2type.toString,core_hasOwn=class2type.hasOwnProperty,core_trim=core_version.trim,jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},core_pnum=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,core_rnotwhite=/\S+/g,rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,rvalidchars=/^[\],:{}\s]*$/,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rvalidescape=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,rvalidtokens=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()},completed=function(event){if(document.addEventListener||event.type==="load"||document.readyState==="complete"){detach();jQuery.ready()}},detach=function(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false)}else{document.detachEvent("onreadystatechange",completed);window.detachEvent("onload",completed)}};jQuery.fn=jQuery.prototype={jquery:core_version,constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem;if(!selector){return this}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match])}else{this.attr(match,context[match])}}}return this}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector)}this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else{if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}}else{if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}else{if(jQuery.isFunction(selector)){return rootjQuery.ready(selector)}}}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)},selector:"",length:0,toArray:function(){return core_slice.call(this)},get:function(num){return num==null?this.toArray():(num<0?this[this.length+num]:this[num])},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){jQuery.ready.promise().done(fn);return this},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:core_push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}if(length===i){target=this;--i}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}target[name]=jQuery.extend(deep,clone,copy)}else{if(copy!==undefined){target[name]=copy}}}}}return target};jQuery.extend({expando:"jQuery"+(core_version+Math.random()).replace(/\D/g,""),noConflict:function(deep){if(window.$===jQuery){window.$=_$}if(deep&&window.jQuery===jQuery){window.jQuery=_jQuery}return jQuery},isReady:false,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(true)}},ready:function(wait){if(wait===true?--jQuery.readyWait:jQuery.isReady){return}if(!document.body){return setTimeout(jQuery.ready)}jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0){return}readyList.resolveWith(document,[jQuery]);if(jQuery.fn.trigger){jQuery(document).trigger("ready").off("ready")}},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"},isWindow:function(obj){return obj!=null&&obj==obj.window},isNumeric:function(obj){return !isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){if(obj==null){return String(obj)}return typeof obj==="object"||typeof obj==="function"?class2type[core_toString.call(obj)]||"object":typeof obj},isPlainObject:function(obj){var key;if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return false}try{if(obj.constructor&&!core_hasOwn.call(obj,"constructor")&&!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}if(jQuery.support.ownLast){for(key in obj){return core_hasOwn.call(obj,key)}}for(key in obj){}return key===undefined||core_hasOwn.call(obj,key)},isEmptyObject:function(obj){var name;for(name in obj){return false}return true},error:function(msg){throw new Error(msg)},parseHTML:function(data,context,keepScripts){if(!data||typeof data!=="string"){return null}if(typeof context==="boolean"){keepScripts=context;context=false}context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])]}parsed=jQuery.buildFragment([data],context,scripts);if(scripts){jQuery(scripts).remove()}return jQuery.merge([],parsed.childNodes)},parseJSON:function(data){if(window.JSON&&window.JSON.parse){return window.JSON.parse(data)}if(data===null){return data}if(typeof data==="string"){data=jQuery.trim(data);if(data){if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,""))){return(new Function("return "+data))()}}}jQuery.error("Invalid JSON: "+data)},parseXML:function(data){var xml,tmp;if(!data||typeof data!=="string"){return null}try{if(window.DOMParser){tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}}catch(e){xml=undefined}if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}return xml},noop:function(){},globalEval:function(data){if(data&&jQuery.trim(data)){(window.execScript||function(data){window["eval"].call(window,data)})(data)}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===false){break}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===false){break}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===false){break}}}}return obj},trim:core_trim&&!core_trim.call("\uFEFF\xA0")?function(text){return text==null?"":core_trim.call(text)}:function(text){return text==null?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr)}else{core_push.call(ret,arr)}}return ret},inArray:function(elem,arr,i){var len;if(arr){if(core_indexOf){return core_indexOf.call(arr,elem,i)}len=arr.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;i++){if(i in arr&&arr[i]===elem){return i}}}return -1},merge:function(first,second){var l=second.length,i=first.length,j=0;if(typeof l==="number"){for(;j<l;j++){first[i++]=second[j]}}else{while(second[j]!==undefined){first[i++]=second[j++]}}first.length=i;return first},grep:function(elems,callback,inv){var retVal,ret=[],i=0,length=elems.length;inv=!!inv;for(;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal){ret.push(elems[i])}}return ret},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret[ret.length]=value}}}return core_concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}if(!jQuery.isFunction(fn)){return undefined}args=core_slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(core_slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy},access:function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=true;for(i in key){jQuery.access(elems,fn,i,key[i],true,emptyGet,raw)}}else{if(value!==undefined){chainable=true;if(!jQuery.isFunction(value)){raw=true}if(bulk){if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}}if(fn){for(;i<length;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}}}}return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet},now:function(){return(new Date()).getTime()},swap:function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name]}return ret}});jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready)}else{if(document.addEventListener){document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false)}else{document.attachEvent("onreadystatechange",completed);window.attachEvent("onload",completed);var top=false;try{top=window.frameElement==null&&document.documentElement}catch(e){}if(top&&top.doScroll){(function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}detach();jQuery.ready()}})()}}}}return readyList.promise(obj)};jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);if(jQuery.isWindow(obj)){return false}if(obj.nodeType===1&&length){return true}return type==="array"||type!=="function"&&(length===0||typeof length==="number"&&length>0&&(length-1) in obj)}rootjQuery=jQuery(document);
/*!
 * Sizzle CSS Selector Engine v1.10.2
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: 2013-07-03
 */
(function(window,undefined){var i,support,cachedruns,Expr,getText,isXML,compile,outermostContext,sortInput,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+-(new Date()),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),hasDuplicate=false,sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}return 0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i}}return -1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rsibling=new RegExp(whitespace+"*[+~]"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={ID:new RegExp("^#("+characterEncoding+")"),CLASS:new RegExp("^\\.("+characterEncoding+")"),TAG:new RegExp("^("+characterEncoding.replace("w","w*")+")"),ATTR:new RegExp("^"+attributes),PSEUDO:new RegExp("^"+pseudos),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),bool:new RegExp("^(?:"+booleans+")$","i"),needsContext:new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-65536;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+65536):String.fromCharCode(high>>10|55296,high&1023|56320)};try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while((target[j++]=els[i++])){}target.length=j-1}}}function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results}if((nodeType=context.nodeType)!==1&&nodeType!==9){return[]}if(documentIsHTML&&!seed){if((match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else{if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else{if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}}}if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if((old=context.getAttribute("id"))){nid=old.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}newContext=rsibling.test(selector)&&context.parentNode||context;newSelector=groups.join(",")}if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}}return select(selector.replace(rtrim,"$1"),context,results,seed)}function createCache(){var keys=[];function cache(key,value){if(keys.push(key+=" ")>Expr.cacheLength){delete cache[keys.shift()]}return(cache[key]=value)}return cache}function markFunction(fn){fn[expando]=true;return fn}function assert(fn){var div=document.createElement("div");try{return !!fn(div)}catch(e){return false}finally{if(div.parentNode){div.parentNode.removeChild(div)}div=null}}function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler}}function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff}if(cur){while((cur=cur.nextSibling)){if(cur===b){return -1}}}return a?1:-1}function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j])}}})})}isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":false};support=Sizzle.support={};setDocument=Sizzle.setDocument=function(node){var doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent.attachEvent&&parent!==parent.top){parent.attachEvent("onbeforeunload",function(){setDocument()})}support.attributes=assert(function(div){div.className="i";return !div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return !div.getElementsByTagName("*").length});support.getElementsByClassName=assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";div.firstChild.className="i";return div.getElementsByClassName("i").length===2});support.getById=assert(function(div){docElem.appendChild(div).id=expando;return !doc.getElementsByName||!doc.getElementsByName(expando).length});if(support.getById){Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}};Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find.ID;Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}}Expr.find.TAG=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag)}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem)}}return tmp}return results};Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];if((support.qsa=rnative.test(doc.querySelectorAll))){assert(function(div){div.innerHTML="<select><option selected=''></option></select>";if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")}if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("t","");if(div.querySelectorAll("[t^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")}if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}if((support.matchesSelector=rnative.test((matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)})}rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));contains=rnative.test(docElem.contains)||docElem.compareDocumentPosition?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return true}}}return false};sortOrder=docElem.compareDocumentPosition?function(a,b){if(a===b){hasDuplicate=true;return 0}var compare=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b);if(compare){if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a===doc||contains(preferredDoc,a)){return -1}if(b===doc||contains(preferredDoc,b)){return 1}return sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0}return compare&4?-1:1}return a.compareDocumentPosition?-1:1}:function(a,b){var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(a===b){hasDuplicate=true;return 0}else{if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0}else{if(aup===bup){return siblingCheck(a,b)}}}cur=a;while((cur=cur.parentNode)){ap.unshift(cur)}cur=b;while((cur=cur.parentNode)){bp.unshift(cur)}while(ap[i]===bp[i]){i++}return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return doc};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val===undefined?support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null:val};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i)}}while(j--){results.splice(duplicates[j],1)}}return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){for(;(node=elem[i]);i++){ret+=getText(node)}}else{if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else{if(nodeType===3||nodeType===4){return elem.nodeValue}}}return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}return match.slice(0,4)},CHILD:function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+((match[7]+match[8])||match[3]==="odd")}else{if(match[3]){Sizzle.error(match[0])}}return match},PSEUDO:function(match){var excess,unquoted=!match[5]&&match[2];if(matchExpr.CHILD.test(match[0])){return null}if(match[3]&&match[4]!==undefined){match[2]=match[4]}else{if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,true))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}}return match.slice(0,3)}},filter:{TAG:function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return true}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},CLASS:function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},ATTR:function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}if(!operator){return true}result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":false}},CHILD:function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return !!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return false}}start=dir=type==="only"&&!start&&"nextSibling"}return true}start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}}else{if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]}else{while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]}if(node===elem){break}}}}}diff-=last;return diff===first||(diff%first===0&&diff/first>=0)}}},PSEUDO:function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}return fn}},pseudos:{not:markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return !results.pop()}}),has:markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),contains:markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),lang:markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return false}}),target:function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},root:function(elem){return elem===docElem},focus:function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},enabled:function(elem){return elem.disabled===false},disabled:function(elem){return elem.disabled===true},checked:function(elem){var nodeName=elem.nodeName.toLowerCase();return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected)},selected:function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}return elem.selected===true},empty:function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeName>"@"||elem.nodeType===3||elem.nodeType===4){return false}}return true},parent:function(elem){return !Expr.pseudos.empty(elem)},header:function(elem){return rheader.test(elem.nodeName)},input:function(elem){return rinputs.test(elem.nodeName)},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},text:function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()===elem.type)},first:createPositionalPseudo(function(){return[0]}),last:createPositionalPseudo(function(matchIndexes,length){return[length-1]}),eq:createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),even:createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),odd:createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}return matchIndexes}),lt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}return matchIndexes}),gt:createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}return matchIndexes})}};Expr.pseudos.nth=Expr.pseudos.eq;for(i in {radio:true,checkbox:true,file:true,password:true,image:true}){Expr.pseudos[i]=createInputPseudo(i)}for(i in {submit:true,reset:true}){Expr.pseudos[i]=createButtonPseudo(i)}function setFilters(){}setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}groups.push(tokens=[])}matched=false;if((match=rcombinators.exec(soFar))){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}if(!matched){break}}return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}return selector}function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}}:function(elem,context,xml){var data,cache,outerCache,dirkey=dirruns+" "+doneName;if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return true}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((cache=outerCache[dir])&&cache[0]===dirkey){if((data=cache[1])===true||data===cachedruns){return data===true}}else{cache=outerCache[dir]=[dirkey];cache[1]=matcher(elem,context,xml)||cachedruns;if(cache[1]===true){return true}}}}}}}function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return false}}return true}:matchers[0]}function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}return newUnmatched}function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem))}}postFinder(null,(matcherOut=[]),temp,xml)}i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,true),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,true),matchers=[function(elem,context,xml){return(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];for(;i<len;i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens))}matchers.push(matcher)}}return elementMatcher(matchers)}function matcherFromGroupMatchers(elementMatchers,setMatchers){var matcherCachedRuns=0,bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,expandContext){var elem,j,matcher,setMatched=[],matchedCount=0,i="0",unmatched=seed&&[],outermost=expandContext!=null,contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",expandContext&&context.parentNode||context),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1);if(outermost){outermostContext=context!==document&&context;cachedruns=matcherCachedRuns}for(;(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while((matcher=elementMatchers[j++])){if(matcher(elem,context,xml)){results.push(elem);break}}if(outermost){dirruns=dirrunsUnique;cachedruns=++matcherCachedRuns}}if(bySet){if((elem=!matcher&&elem)){matchedCount--}if(seed){unmatched.push(elem)}}}matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml)}if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}setMatched=condense(setMatched)}push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results)}}if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}return unmatched};return bySet?markFunction(superMatcher):superMatcher}compile=Sizzle.compile=function(selector,group){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!group){group=tokenize(selector)}i=group.length;while(i--){cached=matcherFromTokens(group[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers))}return cached};function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}return results}function select(selector,context,results,seed){var i,tokens,token,type,find,match=tokenize(selector);if(!seed){if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}selector=selector.slice(tokens.shift().value.length)}i=matchExpr.needsContext.test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[(type=token.type)]){break}if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&context.parentNode||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}break}}}}}compile(selector,match)(seed,context,!documentIsHTML,results,rsibling.test(selector));return results}support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#"})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)}})}if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")===""})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue}})}if(!assert(function(div){return div.getAttribute("disabled")==null})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return(val=elem.getAttributeNode(name))&&val.specified?val.value:elem[name]===true?name.toLowerCase():null}})}jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains})(window);var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(core_rnotwhite)||[],function(_,flag){object[flag]=true});return object}jQuery.Callbacks=function(options){options=typeof options==="string"?(optionsCache[options]||createOptions(options)):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=true;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===false&&options.stopOnFalse){memory=false;break}}firing=false;if(list){if(stack){if(stack.length){fire(stack.shift())}}else{if(memory){list=[]}else{self.disable()}}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg)}}else{if(arg&&arg.length&&type!=="string"){add(arg)}}})})(arguments);if(firing){firingLength=list.length}else{if(memory){firingStart=start;fire(memory)}}}return this},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--}if(index<=firingIndex){firingIndex--}}}})}return this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length)},empty:function(){list=[];firingLength=0;return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return !list},lock:function(){stack=undefined;if(!memory){self.disable()}return this},locked:function(){return !stack},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args)}else{fire(args)}}return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return !!fired}};return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var action=tuple[0],fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify)}else{newDefer[action+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)}})});fns=null}).promise()},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString},tuples[i^1][2].disable,tuples[2][2].lock)}deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func){func.call(deferred,deferred)}return deferred},when:function(subordinate){var i=0,resolveValues=core_slice.call(arguments),length=resolveValues.length,remaining=length!==1||(subordinate&&jQuery.isFunction(subordinate.promise))?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?core_slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values)}else{if(!(--remaining)){deferred.resolveWith(contexts,values)}}}},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues))}else{--remaining}}}if(!remaining){deferred.resolveWith(resolveContexts,resolveValues)}return deferred.promise()}});jQuery.support=(function(support){var all,a,input,select,fragment,opt,eventName,isSupported,i,div=document.createElement("div");div.setAttribute("className","t");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";all=div.getElementsByTagName("*")||[];a=div.getElementsByTagName("a")[0];if(!a||!a.style||!all.length){return support}select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];a.style.cssText="top:1px;float:left;opacity:.5";support.getSetAttribute=div.className!=="t";support.leadingWhitespace=div.firstChild.nodeType===3;support.tbody=!div.getElementsByTagName("tbody").length;support.htmlSerialize=!!div.getElementsByTagName("link").length;support.style=/top/.test(a.getAttribute("style"));support.hrefNormalized=a.getAttribute("href")==="/a";support.opacity=/^0.5/.test(a.style.opacity);support.cssFloat=!!a.style.cssFloat;support.checkOn=!!input.value;support.optSelected=opt.selected;support.enctype=!!document.createElement("form").enctype;support.html5Clone=document.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>";support.inlineBlockNeedsLayout=false;support.shrinkWrapBlocks=false;support.pixelPosition=false;support.deleteExpando=true;support.noCloneEvent=true;support.reliableMarginRight=true;support.boxSizingReliable=true;input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=false}input=document.createElement("input");input.setAttribute("value","");support.input=input.getAttribute("value")==="";input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";input.setAttribute("checked","t");input.setAttribute("name","t");fragment=document.createDocumentFragment();fragment.appendChild(input);support.appendChecked=input.checked;support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;if(div.attachEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false});div.cloneNode(true).click()}for(i in {submit:true,change:true,focusin:true}){div.setAttribute(eventName="on"+i,"t");support[i+"Bubbles"]=eventName in window||div.attributes[eventName].expando===false}div.style.backgroundClip="content-box";div.cloneNode(true).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";for(i in jQuery(support)){break}support.ownLast=i!=="0";jQuery(function(){var container,marginDiv,tds,divReset="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",body=document.getElementsByTagName("body")[0];if(!body){return}container=document.createElement("div");container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";body.appendChild(container).appendChild(div);div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");tds[0].style.cssText="padding:0;margin:0;border:0;display:none";isSupported=(tds[0].offsetHeight===0);tds[0].style.display="";tds[1].style.display="none";support.reliableHiddenOffsets=isSupported&&(tds[0].offsetHeight===0);div.innerHTML="";div.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";jQuery.swap(body,body.style.zoom!=null?{zoom:1}:{},function(){support.boxSizing=div.offsetWidth===4});if(window.getComputedStyle){support.pixelPosition=(window.getComputedStyle(div,null)||{}).top!=="1%";support.boxSizingReliable=(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px";marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText=divReset;marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";support.reliableMarginRight=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight)}if(typeof div.style.zoom!==core_strundefined){div.innerHTML="";div.style.cssText=divReset+"width:1px;padding:1px;display:inline;zoom:1";support.inlineBlockNeedsLayout=(div.offsetWidth===3);div.style.display="block";div.innerHTML="<div></div>";div.firstChild.style.width="5px";support.shrinkWrapBlocks=(div.offsetWidth!==3);if(support.inlineBlockNeedsLayout){body.style.zoom=1}}body.removeChild(container);container=div=tds=marginDiv=null});all=select=fragment=opt=a=input=null;return support})({});var rbrace=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,rmultiDash=/([A-Z])/g;function internalData(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return}var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if((!id||!cache[id]||(!pvt&&!cache[id].data))&&data===undefined&&typeof name==="string"){return}if(!id){if(isNode){id=elem[internalKey]=core_deletedIds.pop()||jQuery.guid++}else{id=internalKey}}if(!cache[id]){cache[id]=isNode?{}:{toJSON:jQuery.noop}}if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name)}else{cache[id].data=jQuery.extend(cache[id].data,name)}}thisCache=cache[id];if(!pvt){if(!thisCache.data){thisCache.data={}}thisCache=thisCache.data}if(data!==undefined){thisCache[jQuery.camelCase(name)]=data}if(typeof name==="string"){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)]}}else{ret=thisCache}return ret}function internalRemoveData(elem,name,pvt){if(!jQuery.acceptData(elem)){return}var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id]){return}if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name]}else{name=jQuery.camelCase(name);if(name in thisCache){name=[name]}else{name=name.split(" ")}}}else{name=name.concat(jQuery.map(name,jQuery.camelCase))}i=name.length;while(i--){delete thisCache[name[i]]}if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache)){return}}}if(!pvt){delete cache[id].data;if(!isEmptyDataObject(cache[id])){return}}if(isNode){jQuery.cleanData([elem],true)}else{if(jQuery.support.deleteExpando||cache!=cache.window){delete cache[id]}else{cache[id]=null}}}jQuery.extend({cache:{},noData:{applet:true,embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return !!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,true)},_removeData:function(elem,name){return internalRemoveData(elem,name,true)},acceptData:function(elem){if(elem.nodeType&&elem.nodeType!==1&&elem.nodeType!==9){return false}var noData=elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()];return !noData||noData!==true&&elem.getAttribute("classid")===noData}});jQuery.fn.extend({data:function(key,value){var attrs,name,data=null,i=0,elem=this[0];if(key===undefined){if(this.length){data=jQuery.data(elem);if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){attrs=elem.attributes;for(;i<attrs.length;i++){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name])}}jQuery._data(elem,"parsedAttrs",true)}}return data}if(typeof key==="object"){return this.each(function(){jQuery.data(this,key)})}return arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):null},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}});function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else{data=undefined}}return data}function isEmptyDataObject(obj){var name;for(name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue}if(name!=="toJSON"){return false}}return true}jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=jQuery._data(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=jQuery._data(elem,type,jQuery.makeArray(data))}else{queue.push(data)}}return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}if(fn){if(type==="fx"){queue.unshift("inprogress")}delete hooks.stop;fn.call(elem,next,hooks)}if(!startLength&&hooks){hooks.empty.fire()}},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue");jQuery._removeData(elem,key)})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}if(arguments.length<setter){return jQuery.queue(this[0],type)}return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!(--count)){defer.resolveWith(elements,[elements])}};if(typeof type!=="string"){obj=type;type=undefined}type=type||"fx";while(i--){tmp=jQuery._data(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}resolve();return defer.promise(obj)}});var nodeHook,boolHook,rclass=/[\t\r\n\f]/g,rreturn=/\r/g,rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=jQuery.support.getSetAttribute,getSetInput=jQuery.support.input;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name]}catch(e){}})},addClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(core_rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while((clazz=classes[j++])){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" "}}elem.className=jQuery.trim(cur)}}}return this},removeClass:function(value){var classes,elem,cur,clazz,j,i=0,len=this.length,proceed=arguments.length===0||typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}if(proceed){classes=(value||"").match(core_rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while((clazz=classes[j++])){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ")}}elem.className=value?jQuery.trim(cur):""}}}return this},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value)}if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(core_rnotwhite)||[];while((className=classNames[i++])){if(self.hasClass(className)){self.removeClass(className)}else{self.addClass(className)}}}else{if(type===core_strundefined||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className)}this.className=this.className||value===false?"":jQuery._data(this,"__className__")||""}}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return true}}return false},val:function(value){var ret,hooks,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get" in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return}if(isFunction){val=value.call(this,i,jQuery(this).val())}else{val=value}if(val==null){val=""}else{if(typeof val==="number"){val+=""}else{if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}}}hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set" in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:elem.text}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}values.push(value)}}return values},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if((option.selected=jQuery.inArray(jQuery(option).val(),values)>=0)){optionSet=true}}if(!optionSet){elem.selectedIndex=-1}return values}}},attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}if(typeof elem.getAttribute===core_strundefined){return jQuery.prop(elem,name,value)}if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)}if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name)}else{if(hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,value+"");return value}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret}}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(core_rnotwhite);if(attrNames&&elem.nodeType===1){while((name=attrNames[i++])){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem[propName]=false}else{elem[jQuery.camelCase("default-"+name)]=elem[propName]=false}}else{jQuery.attr(elem,name,"")}elem.removeAttribute(getSetAttribute?name:propName)}}},attrHooks:{type:{set:function(elem,value){if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}return value}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==undefined){return hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem[name]=value)}else{return hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name]}},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}});boolHook={set:function(elem,value,name){if(value===false){jQuery.removeAttr(elem,name)}else{if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name)}else{elem[jQuery.camelCase("default-"+name)]=elem[name]=true}}return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=jQuery.expr.attrHandle[name]||jQuery.find.attr;jQuery.expr.attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var fn=jQuery.expr.attrHandle[name],ret=isXML?undefined:(jQuery.expr.attrHandle[name]=undefined)!=getter(elem,name,isXML)?name.toLowerCase():null;jQuery.expr.attrHandle[name]=fn;return ret}:function(elem,name,isXML){return isXML?undefined:elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}});if(!getSetInput||!getSetAttribute){jQuery.attrHooks.value={set:function(elem,value,name){if(jQuery.nodeName(elem,"input")){elem.defaultValue=value}else{return nodeHook&&nodeHook.set(elem,value,name)}}}}if(!getSetAttribute){nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){elem.setAttributeNode((ret=elem.ownerDocument.createAttribute(name)))}ret.value=value+="";return name==="value"||value===elem.getAttribute(name)?value:undefined}};jQuery.expr.attrHandle.id=jQuery.expr.attrHandle.name=jQuery.expr.attrHandle.coords=function(elem,name,isXML){var ret;return isXML?undefined:(ret=elem.getAttributeNode(name))&&ret.value!==""?ret.value:null};jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);return ret&&ret.specified?ret.value:undefined},set:nodeHook.set};jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,value===""?false:value,name)}};jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value}}}})}if(!jQuery.support.hrefNormalized){jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}})}if(!jQuery.support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined},set:function(elem,value){return(elem.style.cssText=value+"")}}}if(!jQuery.support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex}}return null}}}jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});if(!jQuery.support.enctype){jQuery.propFix.enctype="encoding"}jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0)}}};if(!jQuery.support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return true}function returnFalse(){return false}function safeActiveElement(){try{return document.activeElement}catch(err){}}jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(!elemData){return}if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}if(!handler.guid){handler.guid=jQuery.guid++}if(!(events=elemData.events)){events=elemData.events={}}if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==core_strundefined&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined};eventHandle.elem=elem}types=(types||"").match(core_rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false){if(elem.addEventListener){elem.addEventListener(type,eventHandle,false)}else{if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle)}}}}if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}jQuery.event.global[type]=true}elem=null},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(!elemData||!(events=elemData.events)){return}types=(types||"").match(core_rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,true)}continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--}if(special.remove){special.remove.call(elem,handleObj)}}}if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===false){jQuery.removeEvent(elem,type,elemData.handle)}delete events[type]}}if(jQuery.isEmptyObject(events)){delete elemData.handle;jQuery._removeData(elem,"events")}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=core_hasOwn.call(event,"type")?event.type:event,namespaces=core_hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return}if(rfocusMorph.test(type+jQuery.event.triggered)){return}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem}data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===false){return}if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode}for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window)}}i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle){handle.apply(cur,data)}handle=ontype&&cur[ontype];if(handle&&jQuery.acceptData(cur)&&handle.apply&&handle.apply(cur,data)===false){event.preventDefault()}}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===false)&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null}jQuery.event.triggered=type;try{elem[type]()}catch(e){}jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp}}}}return event.result},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=core_slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===false){return}handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===false){event.preventDefault();event.stopPropagation()}}}}}if(special.postDispatch){special.postDispatch.call(this,event)}return event.result},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!=this;cur=cur.parentNode||this){if(cur.nodeType===1&&(cur.disabled!==true||event.type!=="click")){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length}if(matches[sel]){matches.push(handleObj)}}if(matches.length){handlerQueue.push({elem:cur,handlers:matches})}}}}if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)})}return handlerQueue},fix:function(event){if(event[jQuery.expando]){return event}var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}}copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop]}if(!event.target){event.target=originalEvent.srcElement||document}if(event.target.nodeType===3){event.target=event.target.parentNode}event.metaKey=!!event.metaKey;return fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}return event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement}if(!event.which&&button!==undefined){event.which=(button&1?1:(button&2?3:(button&4?2:0)))}return event}},special:{load:{noBubble:true},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){try{this.focus();return false}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return false}},delegateType:"focusout"},click:{trigger:function(){if(jQuery.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return false}},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){if(event.result!==undefined){event.originalEvent.returnValue=event.result}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:true,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,false)}}:function(elem,type,handle){var name="on"+type;if(elem.detachEvent){if(typeof elem[name]===core_strundefined){elem[name]=null}elem.detachEvent(name,handle)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=(src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse}else{this.type=src}if(props){jQuery.extend(this,props)}this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(!e){return}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(!e){return}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!jQuery.support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&!jQuery._data(form,"submitBubbles")){jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=true});jQuery._data(form,"submitBubbles",true)}})},postDispatch:function(event){if(event._submit_bubble){delete event._submit_bubble;if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,true)}}},teardown:function(){if(jQuery.nodeName(this,"form")){return false}jQuery.event.remove(this,"._submit")}}}if(!jQuery.support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=true}});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false}jQuery.event.simulate("change",this,event,true)})}return false}jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,true)}});jQuery._data(elem,"changeBubbles",true)}})},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||(elem.type!=="radio"&&elem.type!=="checkbox")){return event.handleObj.handler.apply(this,arguments)}},teardown:function(){jQuery.event.remove(this,"._change");return !rformElems.test(this.nodeName)}}}if(!jQuery.support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){if(attaches++===0){document.addEventListener(orig,handler,true)}},teardown:function(){if(--attaches===0){document.removeEventListener(orig,handler,true)}}}})}jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}for(type in types){this.on(type,selector,data,types[type],one)}return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else{if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}}if(fn===false){fn=returnFalse}else{if(!fn){return this}}if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])}return this}if(selector===false||typeof selector==="function"){fn=selector;selector=undefined}if(fn===false){fn=returnFalse}return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,true)}}});var isSimple=/^.[^:#\[\.,]*$/,rparentsprev=/^(?:parents|prev(?:Until|All))/,rneedsContext=jQuery.expr.match.needsContext,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return true}}}))}for(i=0;i<len;i++){jQuery.find(selector,self[i],ret)}ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret},has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;i<len;i++){if(jQuery.contains(this,targets[i])){return true}}})},not:function(selector){return this.pushStack(winnow(this,selector||[],true))},filter:function(selector){return this.pushStack(winnow(this,selector||[],false))},is:function(selector){return !!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],false).length},closest:function(selectors,context){var cur,i=0,l=this.length,ret=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){cur=ret.push(cur);break}}}return this.pushStack(ret.length>1?jQuery.unique(ret):ret)},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1}if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem))}return jQuery.inArray(elem.jquery?elem[0]:elem,this)},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(jQuery.unique(all))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});function sibling(cur,dir){do{cur=cur[dir]}while(cur&&cur.nodeType!==1);return cur}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until}if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret)}if(this.length>1){if(!guaranteedUnique[name]){ret=jQuery.unique(ret)}if(rparentsprev.test(name)){ret=ret.reverse()}}return this.pushStack(ret)}});jQuery.extend({filter:function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")"}return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1}))},dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur)}cur=cur[dir]}return matched},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n)}}return r}});function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return !!qualifier.call(elem,i,elem)!==not})}if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return(elem===qualifier)!==not})}if(typeof qualifier==="string"){if(isSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not)}qualifier=jQuery.filter(qualifier,elements)}return jQuery.grep(elements,function(elem){return(jQuery.inArray(elem,qualifier)>=0)!==not})}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop())}}return safeFrag}var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,manipulation_rcheckableType=/^(?:checkbox|radio)$/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:jQuery.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;jQuery.fn.extend({text:function(value){return jQuery.access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this)}})},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling)}})},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem))}if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"))}elem.parentNode.removeChild(elem)}}return this},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false))}while(elem.firstChild){elem.removeChild(elem.firstChild)}if(elem.options&&jQuery.nodeName(elem,"select")){elem.options.length=0}}return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return jQuery.access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined){return elem.nodeType===1?elem.innerHTML.replace(rinlinejQuery,""):undefined}if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(jQuery.support.htmlSerialize||!rnoshimcache.test(value))&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,false));elem.innerHTML=value}}elem=0}catch(e){}}if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(){var args=jQuery.map(this,function(elem){return[elem.nextSibling,elem.parentNode]}),i=0;this.domManip(arguments,function(elem){var next=args[i++],parent=args[i++];if(parent){if(next&&next.parentNode!==parent){next=this.nextSibling}jQuery(this).remove();parent.insertBefore(elem,next)}},true);return i?this:this.remove()},detach:function(selector){return this.remove(selector,true)},domManip:function(args,callback,allowIntersection){args=core_concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||!(l<=1||typeof value!=="string"||jQuery.support.checkClone||!rchecked.test(value))){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html())}self.domManip(args,callback,allowIntersection)})}if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,false,!allowIntersection&&this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first}if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,true,true);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"))}}callback.call(this[i],node,i)}if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){jQuery._evalUrl(node.src)}else{jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,""))}}}}fragment=first=null}}return this}});function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType===1?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function disableScript(elem){elem.type=(jQuery.find.attr(elem,"type")!==null)+"/"+elem.type;return elem}function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1]}else{elem.removeAttribute("type")}return elem}function setGlobalEval(elems,refElements){var elem,i=0;for(;(elem=elems[i])!=null;i++){jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return}var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}if(curData.data){curData.data=jQuery.extend({},curData.data)}}function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(dest.nodeType!==1){return}nodeName=dest.nodeName.toLowerCase();if(!jQuery.support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events){jQuery.removeEvent(dest,e,data.handle)}dest.removeAttribute(jQuery.expando)}if(nodeName==="script"&&dest.text!==src.text){disableScript(dest).text=src.text;restoreScript(dest)}else{if(nodeName==="object"){if(dest.parentNode){dest.outerHTML=src.outerHTML}if(jQuery.support.html5Clone&&(src.innerHTML&&!jQuery.trim(dest.innerHTML))){dest.innerHTML=src.innerHTML}}else{if(nodeName==="input"&&manipulation_rcheckableType.test(src.type)){dest.defaultChecked=dest.checked=src.checked;if(dest.value!==src.value){dest.value=src.value}}else{if(nodeName==="option"){dest.defaultSelected=dest.selected=src.defaultSelected}else{if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}}}}}}jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;for(;i<=last;i++){elems=i===last?this:this.clone(true);jQuery(insert[i])[original](elems);core_push.apply(ret,elems.get())}return this.pushStack(ret)}});function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==core_strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==core_strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found){for(found=[],elems=context.childNodes||context;(elem=elems[i])!=null;i++){if(!tag||jQuery.nodeName(elem,tag)){found.push(elem)}else{jQuery.merge(found,getAll(elem,tag))}}}return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}function fixDefaultChecked(elem){if(manipulation_rcheckableType.test(elem.type)){elem.defaultChecked=elem.checked}}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(jQuery.support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){clone=elem.cloneNode(true)}else{fragmentDiv.innerHTML=elem.outerHTML;fragmentDiv.removeChild(clone=fragmentDiv.firstChild)}if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0;(node=srcElements[i])!=null;++i){if(destElements[i]){fixCloneNodeIssues(node,destElements[i])}}}if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0;(node=srcElements[i])!=null;i++){cloneCopyEvent(node,destElements[i])}}else{cloneCopyEvent(elem,clone)}}destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"))}destElements=srcElements=node=null;return clone},buildFragment:function(elems,context,scripts,selection){var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem)}else{if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem))}else{tmp=tmp||safe.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild}if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem)){nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0]))}if(!jQuery.support.tbody){elem=tag==="table"&&!rtbody.test(elem)?tmp.firstChild:wrap[1]==="<table>"&&!rtbody.test(elem)?tmp:0;j=elem&&elem.childNodes.length;while(j--){if(jQuery.nodeName((tbody=elem.childNodes[j]),"tbody")&&!tbody.childNodes.length){elem.removeChild(tbody)}}}jQuery.merge(nodes,tmp.childNodes);tmp.textContent="";while(tmp.firstChild){tmp.removeChild(tmp.firstChild)}tmp=safe.lastChild}}}}if(tmp){safe.removeChild(tmp)}if(!jQuery.support.appendChecked){jQuery.grep(getAll(nodes,"input"),fixDefaultChecked)}i=0;while((elem=nodes[i++])){if(selection&&jQuery.inArray(elem,selection)!==-1){continue}contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(safe.appendChild(elem),"script");if(contains){setGlobalEval(tmp)}if(scripts){j=0;while((elem=tmp[j++])){if(rscriptType.test(elem.type||"")){scripts.push(elem)}}}}tmp=null;return safe},cleanData:function(elems,acceptData){var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=jQuery.support.deleteExpando,special=jQuery.event.special;for(;(elem=elems[i])!=null;i++){if(acceptData||jQuery.acceptData(elem)){id=elem[internalKey];data=id&&cache[id];if(data){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}}if(cache[id]){delete cache[id];if(deleteExpando){delete elem[internalKey]}else{if(typeof elem.removeAttribute!==core_strundefined){elem.removeAttribute(internalKey)}else{elem[internalKey]=null}}core_deletedIds.push(id)}}}}},_evalUrl:function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:false,global:false,"throws":true})}});jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){wrap.insertBefore(this[0])}wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild}return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()}});var iframe,getStyles,curCSS,ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rposition=/^(top|right|bottom|left)$/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rmargin=/^margin/,rnumsplit=new RegExp("^("+core_pnum+")(.*)$","i"),rnumnonpx=new RegExp("^("+core_pnum+")(?!px)[a-z%]+$","i"),rrelNum=new RegExp("^([+-])=("+core_pnum+")","i"),elemdisplay={BODY:"block"},cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssExpand=["Top","Right","Bottom","Left"],cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name}var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name}}return origName}function isHidden(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)}function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue}values[index]=jQuery._data(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display=""}if(elem.style.display===""&&isHidden(elem)){values[index]=jQuery._data(elem,"olddisplay",css_defaultDisplay(elem.nodeName))}}else{if(!values[index]){hidden=isHidden(elem);if(display&&display!=="none"||!hidden){jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))}}}}for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue}if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none"}}return elements}jQuery.fn.extend({css:function(name,value){return jQuery.access(this,function(elem,name,value){var len,styles,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],false,styles)}return map}return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,true)},hide:function(){return showHide(this)},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide()}return this.each(function(){if(isHidden(this)){jQuery(this).show()}else{jQuery(this).hide()}})}});jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{columnCount:true,fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||type==="number"&&isNaN(value)){return}if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}if(!jQuery.support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit"}if(!hooks||!("set" in hooks)||(value=hooks.set(elem,value,extra))!==undefined){try{style[name]=value}catch(e){}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,false,extra))!==undefined){return ret}return style[name]}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get" in hooks){val=hooks.get(elem,true,extra)}if(val===undefined){val=curCSS(elem,name,styles)}if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]}if(extra===""||extra){num=parseFloat(val);return extra===true||jQuery.isNumeric(num)?num||0:val}return val}});if(window.getComputedStyle){getStyles=function(elem){return window.getComputedStyle(elem,null)};curCSS=function(elem,name,_computed){var width,minWidth,maxWidth,computed=_computed||getStyles(elem),ret=computed?computed.getPropertyValue(name)||computed[name]:undefined,style=elem.style;if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)}if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}return ret}}else{if(document.documentElement.currentStyle){getStyles=function(elem){return elem.currentStyle};curCSS=function(elem,name,_computed){var left,rs,rsLeft,computed=_computed||getStyles(elem),ret=computed?computed[name]:undefined,style=elem.style;if(ret==null&&style&&style[name]){ret=style[name]}if(rnumnonpx.test(ret)&&!rposition.test(name)){left=style.left;rs=elem.runtimeStyle;rsLeft=rs&&rs.left;if(rsLeft){rs.left=elem.currentStyle.left}style.left=name==="fontSize"?"1em":ret;ret=style.pixelLeft+"px";style.left=left;if(rsLeft){rs.left=rsLeft}}return ret===""?"auto":ret}}}function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],true,styles)}if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],true,styles)}if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],true,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",true,styles)}}}return val}function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=true,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name]}if(rnumnonpx.test(val)){return val}valueIsBorderBox=isBorderBox&&(jQuery.support.boxSizingReliable||val===elem.style[name]);val=parseFloat(val)||0}return(val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles))+"px"}function css_defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(doc.documentElement);doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;doc.write("<!doctype html><html><body>");doc.close();display=actualDisplay(nodeName,doc);iframe.detach()}elemdisplay[nodeName]=display}return display}function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=jQuery.css(elem[0],"display");elem.remove();return display}jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return elem.offsetWidth===0&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,jQuery.support.boxSizing&&jQuery.css(elem,"boxSizing",false,styles)==="border-box",styles):0)}}});if(!jQuery.support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if((value>=1||value==="")&&jQuery.trim(filter.replace(ralpha,""))===""&&style.removeAttribute){style.removeAttribute("filter");if(value===""||currentStyle&&!currentStyle.filter){return}}style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity}}}jQuery(function(){if(!jQuery.support.reliableMarginRight){jQuery.cssHooks.marginRight={get:function(elem,computed){if(computed){return jQuery.swap(elem,{display:"inline-block"},curCSS,[elem,"marginRight"])}}}}if(!jQuery.support.pixelPosition&&jQuery.fn.position){jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]={get:function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}}}})}});if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||(!jQuery.support.reliableHiddenOffsets&&((elem.style&&elem.style.display)||jQuery.css(elem,"display"))==="none")};jQuery.expr.filters.visible=function(elem){return !jQuery.expr.filters.hidden(elem)}}jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}return expanded}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber}});var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!manipulation_rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():(value==null?"":value);s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional}if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value)})}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)}}return s.join("&").replace(r20,"+")};function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)}})}else{if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}}jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var ajaxLocParts,ajaxLocation,ajax_nonce=jQuery.now(),ajax_rquery=/\?/,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,_load=jQuery.fn.load,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(core_rnotwhite)||[];if(jQuery.isFunction(func)){while((dataType=dataTypes[i++])){if(dataType[0]==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else{(structure[dataType]=structure[dataType]||[]).push(func)}}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=(structure===transports);function inspect(dataType){var selected;inspected[dataType]=true;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return false}else{if(seekingTransport){return !(selected=dataTypeOrTransport)}}});return selected}return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key]}}if(deep){jQuery.extend(true,target,deep)}return target}jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}var selector,response,type,self=this,off=url.indexOf(" ");if(off>=0){selector=url.slice(off,url.length);url=url.slice(0,off)}if(jQuery.isFunction(params)){callback=params;params=undefined}else{if(params&&typeof params==="object"){type="POST"}}if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])})}return this};jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,processData:true,async:true,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:true,context:true}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2]}}match=responseHeaders[key.toLowerCase()]}return match==null?null:match},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}return this},overrideMimeType:function(type){if(!state){s.mimeType=type}return this},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]]}}else{jqXHR.always(map[jqXHR.status])}}return this},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText)}done(0,finalText);return this}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(core_rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))))}if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR}fireGlobals=s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=(s.url+=(ajax_rquery.test(cacheURL)?"&":"?")+s.data);delete s.data}if(s.cache===false){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+ajax_nonce++):cacheURL+(ajax_rquery.test(cacheURL)?"&":"?")+"_="+ajax_nonce++}}if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL])}if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){return jqXHR.abort()}strAbort="abort";for(i in {success:1,error:1,complete:1}){jqXHR[i](s[i])}transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport){done(-1,"No Transport")}else{jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return}state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses)}response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified}modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified}}if(status===204||s.type==="HEAD"){statusText="nocontent"}else{if(status===304){statusText="notmodified"}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0}}}jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error])}completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop")}}}return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}});function ajaxHandleResponses(s,jqXHR,responses){var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")}}if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}if(dataTypes[0] in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType){firstDataType=type}}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}return responses[finalDataType]}}function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]}}current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response}if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType)}prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev}else{if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===true){conv=converters[conv2]}else{if(converters[conv2]!==true){current=tmp[0];dataTypes.unshift(tmp[1])}}break}}}}if(conv!==true){if(conv&&s["throws"]){response=conv(response)}else{try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}}}}}return{state:"success",data:response}}jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=false}if(s.crossDomain){s.type="GET";s.global=false}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async=true;if(s.scriptCharset){script.charset=s.scriptCharset}script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(script.parentNode){script.parentNode.removeChild(script)}script=null;if(!isAbort){callback(200,"success")}}};head.insertBefore(script,head.firstChild)},abort:function(){if(script){script.onload(undefined,true)}}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(ajax_nonce++));this[callback]=true;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==false&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName)}else{if(s.jsonp!==false){s.url+=(ajax_rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName}}s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")}return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0])}responseContainer=overwritten=undefined});return"script"}});var xhrCallbacks,xhrSupported,xhrId=0,xhrOnUnloadAbort=window.ActiveXObject&&function(){var key;for(key in xhrCallbacks){xhrCallbacks[key](undefined,true)}};function createStandardXHR(){try{return new window.XMLHttpRequest()}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return !this.isLocal&&createStandardXHR()||createActiveXHR()}:createStandardXHR;xhrSupported=jQuery.ajaxSettings.xhr();jQuery.support.cors=!!xhrSupported&&("withCredentials" in xhrSupported);xhrSupported=jQuery.support.ajax=!!xhrSupported;if(xhrSupported){jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var handle,i,xhr=s.xhr();if(s.username){xhr.open(s.type,s.url,s.async,s.username,s.password)}else{xhr.open(s.type,s.url,s.async)}if(s.xhrFields){for(i in s.xhrFields){xhr[i]=s.xhrFields[i]}}if(s.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(s.mimeType)}if(!s.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}try{for(i in headers){xhr.setRequestHeader(i,headers[i])}}catch(err){}xhr.send((s.hasContent&&s.data)||null);callback=function(_,isAbort){var status,responseHeaders,statusText,responses;try{if(callback&&(isAbort||xhr.readyState===4)){callback=undefined;if(handle){xhr.onreadystatechange=jQuery.noop;if(xhrOnUnloadAbort){delete xhrCallbacks[handle]}}if(isAbort){if(xhr.readyState!==4){xhr.abort()}}else{responses={};status=xhr.status;responseHeaders=xhr.getAllResponseHeaders();if(typeof xhr.responseText==="string"){responses.text=xhr.responseText}try{statusText=xhr.statusText}catch(e){statusText=""}if(!status&&s.isLocal&&!s.crossDomain){status=responses.text?200:404}else{if(status===1223){status=204}}}}}catch(firefoxAccessException){if(!isAbort){complete(-1,firefoxAccessException)}}if(responses){complete(status,statusText,responses,responseHeaders)}};if(!s.async){callback()}else{if(xhr.readyState===4){setTimeout(callback)}else{handle=++xhrId;if(xhrOnUnloadAbort){if(!xhrCallbacks){xhrCallbacks={};jQuery(window).unload(xhrOnUnloadAbort)}xhrCallbacks[handle]=callback}xhr.onreadystatechange=callback}}},abort:function(){if(callback){callback(undefined,true)}}}}})}var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+core_pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit)}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations)}if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]}return tween}]};function createFxNow(){setTimeout(function(){fxNow=undefined});return(fxNow=jQuery.now())}function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if((tween=collection[index].call(animation,prop,value))){return tween}}}function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped){return false}var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent)}deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining}else{deferred.resolveWith(elem,[animation]);return false}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(true,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this}stopped=true;for(;index<length;index++){animation.tweens[index].run(1)}if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd])}else{deferred.rejectWith(elem,[animation,gotoEnd])}return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result}}jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)}jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0]}if(index!==name){props[name]=value;delete props[index]}hooks=jQuery.cssHooks[name];if(hooks&&"expand" in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}}else{specialEasing[name]=easing}}}jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else{props=props.split(" ")}var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback)}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback)}else{animationPrefilters.push(callback)}}});function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()}}}hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()}})})}if(elem.nodeType===1&&("height" in props||"width" in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];if(jQuery.css(elem,"display")==="inline"&&jQuery.css(elem,"float")==="none"){if(!jQuery.support.inlineBlockNeedsLayout||css_defaultDisplay(elem.nodeName)==="inline"){style.display="inline-block"}else{style.zoom=1}}}if(opts.overflow){style.overflow="hidden";if(!jQuery.support.shrinkWrapBlocks){anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}}for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){continue}orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}}if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden" in dataShow){hidden=dataShow.hidden}}else{dataShow=jQuery._data(elem,"fxshow",{})}if(toggle){dataShow.hidden=!hidden}if(hidden){jQuery(elem).show()}else{anim.done(function(){jQuery(elem).hide()})}anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop])}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0}}}}}function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)}else{this.pos=eased=percent}this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}if(hooks&&hooks.set){hooks.set(this)}else{Tween.propHooks._default.set(this)}return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop]}result=jQuery.css(tween.elem,tween.prop,"");return !result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)}else{if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}else{tween.elem[tween.prop]=tween.now}}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now}}};jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,true),speed,easing,callback)}});jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||jQuery._data(this,"finish")){anim.stop(true)}};doAnimation.finish=doAnimation;return empty||optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&type!==false){this.queue(type||"fx",[])}return this.each(function(){var dequeue=true,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index])}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])}}}for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=false;timers.splice(index,1)}}if(dequeue||!gotoEnd){jQuery.dequeue(this,type)}})},finish:function(type){if(type!==false){type=type||"fx"}return this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=true;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,true)}for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(true);timers.splice(index,1)}}for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this)}}delete data.finish})}});function genFx(type,includeWidth){var which,attrs={height:type},i=0;includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}if(includeWidth){attrs.opacity=attrs.width=type}return attrs}jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true){opt.queue="fx"}opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this)}if(opt.queue){jQuery.dequeue(this,opt.queue)}};return opt};jQuery.easing={linear:function(p){return p},swing:function(p){return 0.5-Math.cos(p*Math.PI)/2}};jQuery.timers=[];jQuery.fx=Tween.prototype.init;jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}if(!timers.length){jQuery.fx.stop()}fxNow=undefined};jQuery.fx.timer=function(timer){if(timer()&&jQuery.timers.push(timer)){jQuery.fx.start()}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval)}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fx.step={};if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length}}jQuery.fn.offset=function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(!doc){return}docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box}if(typeof elem.getBoundingClientRect!==core_strundefined){box=elem.getBoundingClientRect()}win=getWindow(doc);return{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}};jQuery.offset={setOffset:function(elem,options,i){var position=jQuery.css(elem,"position");if(position==="static"){elem.style.position="relative"}var curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={},curTop,curLeft;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}if(options.top!=null){props.top=(options.top-curOffset.top)+curTop}if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft}if("using" in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({position:function(){if(!this[0]){return}var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect()}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset()}parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",true);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",true)}return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",true),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",true)}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}return offsetParent||docElem})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return jQuery.access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?(prop in win)?win[prop]:win.document.documentElement[method]:elem[method]}if(win){win.scrollTo(!top?val:jQuery(win).scrollLeft(),top?val:jQuery(win).scrollTop())}else{elem[method]=val}},method,val,arguments.length,null)}});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false}jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===true||value===true?"margin":"border");return jQuery.access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name]}if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})});jQuery.fn.size=function(){return this.length};jQuery.fn.andSelf=jQuery.fn.addBack;if(typeof module==="object"&&module&&typeof module.exports==="object"){module.exports=jQuery}else{window.jQuery=window.$=jQuery;if(typeof define==="function"&&define.amd){define("jquery",[],function(){return jQuery})}}})(window);(function($,undefined){if($.rails!==undefined){$.error("jquery-ujs has already been loaded!")}var rails;var $document=$(document);$.rails=rails={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",buttonClickSelector:"button[data-remote]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(xhr){var token=$('meta[name="csrf-token"]').attr("content");if(token){xhr.setRequestHeader("X-CSRF-Token",token)}},fire:function(obj,name,data){var event=$.Event(name);obj.trigger(event,data);return event.result!==false},confirm:function(message){return confirm(message)},ajax:function(options){return $.ajax(options)},href:function(element){return element.attr("href")},handleRemote:function(element){var method,url,data,elCrossDomain,crossDomain,withCredentials,dataType,options;if(rails.fire(element,"ajax:before")){elCrossDomain=element.data("cross-domain");crossDomain=elCrossDomain===undefined?null:elCrossDomain;withCredentials=element.data("with-credentials")||null;dataType=element.data("type")||($.ajaxSettings&&$.ajaxSettings.dataType);if(element.is("form")){method=element.attr("method");url=element.attr("action");data=element.serializeArray();var button=element.data("ujs:submit-button");if(button){data.push(button);element.data("ujs:submit-button",null)}}else{if(element.is(rails.inputChangeSelector)){method=element.data("method");url=element.data("url");data=element.serialize();if(element.data("params")){data=data+"&"+element.data("params")}}else{if(element.is(rails.buttonClickSelector)){method=element.data("method")||"get";url=element.data("url");data=element.serialize();if(element.data("params")){data=data+"&"+element.data("params")}}else{method=element.data("method");url=rails.href(element);data=element.data("params")||null}}}options={type:method||"GET",data:data,dataType:dataType,beforeSend:function(xhr,settings){if(settings.dataType===undefined){xhr.setRequestHeader("accept","*/*;q=0.5, "+settings.accepts.script)}return rails.fire(element,"ajax:beforeSend",[xhr,settings])},success:function(data,status,xhr){element.trigger("ajax:success",[data,status,xhr])},complete:function(xhr,status){element.trigger("ajax:complete",[xhr,status])},error:function(xhr,status,error){element.trigger("ajax:error",[xhr,status,error])},crossDomain:crossDomain};if(withCredentials){options.xhrFields={withCredentials:withCredentials}}if(url){options.url=url}var jqxhr=rails.ajax(options);element.trigger("ajax:send",jqxhr);return jqxhr}else{return false}},handleMethod:function(link){var href=rails.href(link),method=link.data("method"),target=link.attr("target"),csrf_token=$("meta[name=csrf-token]").attr("content"),csrf_param=$("meta[name=csrf-param]").attr("content"),form=$('<form method="post" action="'+href+'"></form>'),metadata_input='<input name="_method" value="'+method+'" type="hidden" />';if(csrf_param!==undefined&&csrf_token!==undefined){metadata_input+='<input name="'+csrf_param+'" value="'+csrf_token+'" type="hidden" />'}if(target){form.attr("target",target)}form.hide().append(metadata_input).appendTo("body");form.submit()},disableFormElements:function(form){form.find(rails.disableSelector).each(function(){var element=$(this),method=element.is("button")?"html":"val";element.data("ujs:enable-with",element[method]());element[method](element.data("disable-with"));element.prop("disabled",true)})},enableFormElements:function(form){form.find(rails.enableSelector).each(function(){var element=$(this),method=element.is("button")?"html":"val";if(element.data("ujs:enable-with")){element[method](element.data("ujs:enable-with"))}element.prop("disabled",false)})},allowAction:function(element){var message=element.data("confirm"),answer=false,callback;if(!message){return true}if(rails.fire(element,"confirm")){answer=rails.confirm(message);callback=rails.fire(element,"confirm:complete",[answer])}return answer&&callback},blankInputs:function(form,specifiedSelector,nonBlank){var inputs=$(),input,valueToCheck,selector=specifiedSelector||"input,textarea",allInputs=form.find(selector);allInputs.each(function(){input=$(this);valueToCheck=input.is("input[type=checkbox],input[type=radio]")?input.is(":checked"):input.val();if(!valueToCheck===!nonBlank){if(input.is("input[type=radio]")&&allInputs.filter('input[type=radio]:checked[name="'+input.attr("name")+'"]').length){return true}inputs=inputs.add(input)}});return inputs.length?inputs:false},nonBlankInputs:function(form,specifiedSelector){return rails.blankInputs(form,specifiedSelector,true)},stopEverything:function(e){$(e.target).trigger("ujs:everythingStopped");e.stopImmediatePropagation();return false},disableElement:function(element){element.data("ujs:enable-with",element.html());element.html(element.data("disable-with"));element.bind("click.railsDisable",function(e){return rails.stopEverything(e)})},enableElement:function(element){if(element.data("ujs:enable-with")!==undefined){element.html(element.data("ujs:enable-with"));element.removeData("ujs:enable-with")}element.unbind("click.railsDisable")}};if(rails.fire($document,"rails:attachBindings")){$.ajaxPrefilter(function(options,originalOptions,xhr){if(!options.crossDomain){rails.CSRFProtection(xhr)}});$document.delegate(rails.linkDisableSelector,"ajax:complete",function(){rails.enableElement($(this))});$document.delegate(rails.linkClickSelector,"click.rails",function(e){var link=$(this),method=link.data("method"),data=link.data("params");if(!rails.allowAction(link)){return rails.stopEverything(e)}if(link.is(rails.linkDisableSelector)){rails.disableElement(link)}if(link.data("remote")!==undefined){if((e.metaKey||e.ctrlKey)&&(!method||method==="GET")&&!data){return true}var handleRemote=rails.handleRemote(link);if(handleRemote===false){rails.enableElement(link)}else{handleRemote.error(function(){rails.enableElement(link)})}return false}else{if(link.data("method")){rails.handleMethod(link);return false}}});$document.delegate(rails.buttonClickSelector,"click.rails",function(e){var button=$(this);if(!rails.allowAction(button)){return rails.stopEverything(e)}rails.handleRemote(button);return false});$document.delegate(rails.inputChangeSelector,"change.rails",function(e){var link=$(this);if(!rails.allowAction(link)){return rails.stopEverything(e)}rails.handleRemote(link);return false});$document.delegate(rails.formSubmitSelector,"submit.rails",function(e){var form=$(this),remote=form.data("remote")!==undefined,blankRequiredInputs=rails.blankInputs(form,rails.requiredInputSelector),nonBlankFileInputs=rails.nonBlankInputs(form,rails.fileInputSelector);if(!rails.allowAction(form)){return rails.stopEverything(e)}if(blankRequiredInputs&&form.attr("novalidate")==undefined&&rails.fire(form,"ajax:aborted:required",[blankRequiredInputs])){return rails.stopEverything(e)}if(remote){if(nonBlankFileInputs){setTimeout(function(){rails.disableFormElements(form)},13);var aborted=rails.fire(form,"ajax:aborted:file",[nonBlankFileInputs]);if(!aborted){setTimeout(function(){rails.enableFormElements(form)},13)}return aborted}rails.handleRemote(form);return false}else{setTimeout(function(){rails.disableFormElements(form)},13)}});$document.delegate(rails.formInputClickSelector,"click.rails",function(event){var button=$(this);if(!rails.allowAction(button)){return rails.stopEverything(event)}var name=button.attr("name"),data=name?{name:name,value:button.val()}:null;button.closest("form").data("ujs:submit-button",data)});$document.delegate(rails.formSubmitSelector,"ajax:beforeSend.rails",function(event){if(this==event.target){rails.disableFormElements($(this))}});$document.delegate(rails.formSubmitSelector,"ajax:complete.rails",function(event){if(this==event.target){rails.enableFormElements($(this))}});$(function(){var csrf_token=$("meta[name=csrf-token]").attr("content");var csrf_param=$("meta[name=csrf-param]").attr("content");$('form input[name="'+csrf_param+'"]').val(csrf_token)})}})(jQuery);var colorbrewer={YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]},PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]},Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}};(function(exports){crossfilter.version="1.0.3";function crossfilter_identity(d){return d}crossfilter.permute=permute;function permute(array,index){for(var i=0,n=index.length,copy=new Array(n);i<n;++i){copy[i]=array[index[i]]}return copy}var bisect=crossfilter.bisect=bisect_by(crossfilter_identity);bisect.by=bisect_by;function bisect_by(f){function bisectLeft(a,x,lo,hi){while(lo<hi){var mid=lo+hi>>1;if(f(a[mid])<x){lo=mid+1}else{hi=mid}}return lo}function bisectRight(a,x,lo,hi){while(lo<hi){var mid=lo+hi>>1;if(x<f(a[mid])){hi=mid}else{lo=mid+1}}return lo}bisectRight.right=bisectRight;bisectRight.left=bisectLeft;return bisectRight}var heap=crossfilter.heap=heap_by(crossfilter_identity);heap.by=heap_by;function heap_by(f){function heap(a,lo,hi){var n=hi-lo,i=(n>>>1)+1;while(--i>0){sift(a,i,n,lo)}return a}function sort(a,lo,hi){var n=hi-lo,t;while(--n>0){t=a[lo],a[lo]=a[lo+n],a[lo+n]=t,sift(a,1,n,lo)}return a}function sift(a,i,n,lo){var d=a[--lo+i],x=f(d),child;while((child=i<<1)<=n){if(child<n&&f(a[lo+child])>f(a[lo+child+1])){child++}if(x<=f(a[lo+child])){break}a[lo+i]=a[lo+child];i=child}a[lo+i]=d}heap.sort=sort;return heap}var heapselect=crossfilter.heapselect=heapselect_by(crossfilter_identity);heapselect.by=heapselect_by;function heapselect_by(f){var heap=heap_by(f);function heapselect(a,lo,hi,k){var queue=new Array(k=Math.min(hi-lo,k)),min,i,x,d;for(i=0;i<k;++i){queue[i]=a[lo++]}heap(queue,0,k);if(lo<hi){min=f(queue[0]);do{if(x=f(d=a[lo])>min){queue[0]=d;min=f(heap(queue,0,k)[0])}}while(++lo<hi)}return queue}return heapselect}var insertionsort=crossfilter.insertionsort=insertionsort_by(crossfilter_identity);insertionsort.by=insertionsort_by;function insertionsort_by(f){function insertionsort(a,lo,hi){for(var i=lo+1;i<hi;++i){for(var j=i,t=a[i],x=f(t);j>lo&&f(a[j-1])>x;--j){a[j]=a[j-1]}a[j]=t}return a}return insertionsort}var quicksort=crossfilter.quicksort=quicksort_by(crossfilter_identity);quicksort.by=quicksort_by;function quicksort_by(f){var insertionsort=insertionsort_by(f);function sort(a,lo,hi){return(hi-lo<quicksort_sizeThreshold?insertionsort:quicksort)(a,lo,hi)}function quicksort(a,lo,hi){var sixth=(hi-lo)/6|0,i1=lo+sixth,i5=hi-1-sixth,i3=lo+hi-1>>1,i2=i3-sixth,i4=i3+sixth;var e1=a[i1],x1=f(e1),e2=a[i2],x2=f(e2),e3=a[i3],x3=f(e3),e4=a[i4],x4=f(e4),e5=a[i5],x5=f(e5);var t;if(x1>x2){t=e1,e1=e2,e2=t,t=x1,x1=x2,x2=t}if(x4>x5){t=e4,e4=e5,e5=t,t=x4,x4=x5,x5=t}if(x1>x3){t=e1,e1=e3,e3=t,t=x1,x1=x3,x3=t}if(x2>x3){t=e2,e2=e3,e3=t,t=x2,x2=x3,x3=t}if(x1>x4){t=e1,e1=e4,e4=t,t=x1,x1=x4,x4=t}if(x3>x4){t=e3,e3=e4,e4=t,t=x3,x3=x4,x4=t}if(x2>x5){t=e2,e2=e5,e5=t,t=x2,x2=x5,x5=t}if(x2>x3){t=e2,e2=e3,e3=t,t=x2,x2=x3,x3=t}if(x4>x5){t=e4,e4=e5,e5=t,t=x4,x4=x5,x5=t}var pivot1=e2,pivotValue1=x2,pivot2=e4,pivotValue2=x4;a[i1]=e1;a[i2]=a[lo];a[i3]=e3;a[i4]=a[hi-1];a[i5]=e5;var less=lo+1,great=hi-2;var pivotsEqual=pivotValue1<=pivotValue2&&pivotValue1>=pivotValue2;if(pivotsEqual){for(var k=less;k<=great;++k){var ek=a[k],xk=f(ek);if(xk<pivotValue1){if(k!==less){a[k]=a[less];a[less]=ek}++less}else{if(xk>pivotValue1){while(true){var greatValue=f(a[great]);if(greatValue>pivotValue1){great--;continue}else{if(greatValue<pivotValue1){a[k]=a[less];a[less++]=a[great];a[great--]=ek;break}else{a[k]=a[great];a[great--]=ek;break}}}}}}}else{for(var k=less;k<=great;k++){var ek=a[k],xk=f(ek);if(xk<pivotValue1){if(k!==less){a[k]=a[less];a[less]=ek}++less}else{if(xk>pivotValue2){while(true){var greatValue=f(a[great]);if(greatValue>pivotValue2){great--;if(great<k){break}continue}else{if(greatValue<pivotValue1){a[k]=a[less];a[less++]=a[great];a[great--]=ek}else{a[k]=a[great];a[great--]=ek}break}}}}}}a[lo]=a[less-1];a[less-1]=pivot1;a[hi-1]=a[great+1];a[great+1]=pivot2;sort(a,lo,less-1);sort(a,great+2,hi);if(pivotsEqual){return a}if(less<i1&&great>i5){var lessValue,greatValue;while((lessValue=f(a[less]))<=pivotValue1&&lessValue>=pivotValue1){++less}while((greatValue=f(a[great]))<=pivotValue2&&greatValue>=pivotValue2){--great}for(var k=less;k<=great;k++){var ek=a[k],xk=f(ek);if(xk<=pivotValue1&&xk>=pivotValue1){if(k!==less){a[k]=a[less];a[less]=ek}less++}else{if(xk<=pivotValue2&&xk>=pivotValue2){while(true){var greatValue=f(a[great]);if(greatValue<=pivotValue2&&greatValue>=pivotValue2){great--;if(great<k){break}continue}else{if(greatValue<pivotValue1){a[k]=a[less];a[less++]=a[great];a[great--]=ek}else{a[k]=a[great];a[great--]=ek}break}}}}}}return sort(a,less,great+1)}return sort}var quicksort_sizeThreshold=32;var crossfilter_array8=crossfilter_arrayUntyped,crossfilter_array16=crossfilter_arrayUntyped,crossfilter_array32=crossfilter_arrayUntyped,crossfilter_arrayLengthen=crossfilter_identity,crossfilter_arrayWiden=crossfilter_identity;if(typeof Uint8Array!=="undefined"){crossfilter_array8=function(n){return new Uint8Array(n)};crossfilter_array16=function(n){return new Uint16Array(n)};crossfilter_array32=function(n){return new Uint32Array(n)};crossfilter_arrayLengthen=function(array,length){var copy=new array.constructor(length);copy.set(array);return copy};crossfilter_arrayWiden=function(array,width){var copy;switch(width){case 16:copy=crossfilter_array16(array.length);break;case 32:copy=crossfilter_array32(array.length);break;default:throw new Error("invalid array width!")}copy.set(array);return copy}}function crossfilter_arrayUntyped(n){return new Array(n)}function crossfilter_filterExact(bisect,value){return function(values){var n=values.length;return[bisect.left(values,value,0,n),bisect.right(values,value,0,n)]}}function crossfilter_filterRange(bisect,range){var min=range[0],max=range[1];return function(values){var n=values.length;return[bisect.left(values,min,0,n),bisect.left(values,max,0,n)]}}function crossfilter_filterAll(values){return[0,values.length]}function crossfilter_null(){return null}function crossfilter_zero(){return 0}function crossfilter_reduceIncrement(p){return p+1}function crossfilter_reduceDecrement(p){return p-1}function crossfilter_reduceAdd(f){return function(p,v){return p+ +f(v)}}function crossfilter_reduceSubtract(f){return function(p,v){return p-f(v)}}exports.crossfilter=crossfilter;function crossfilter(){var crossfilter={add:add,dimension:dimension,groupAll:groupAll,size:size};var data=[],n=0,m=0,M=8,filters=crossfilter_array8(0),filterListeners=[],dataListeners=[];function add(newData){var n0=n,n1=newData.length;if(n1){data=data.concat(newData);filters=crossfilter_arrayLengthen(filters,n+=n1);dataListeners.forEach(function(l){l(newData,n0,n1)})}return crossfilter}function dimension(value){var dimension={filter:filter,filterExact:filterExact,filterRange:filterRange,filterAll:filterAll,top:top,group:group,groupAll:groupAll};var one=1<<m++,zero=~one,values,index,newValues,newIndex,sort=quicksort_by(function(i){return newValues[i]}),refilter=crossfilter_filterAll,indexListeners=[],lo0=0,hi0=0;dataListeners.unshift(preAdd);dataListeners.push(postAdd);if(m>M){filters=crossfilter_arrayWiden(filters,M<<=1)}preAdd(data,0,n);postAdd(data,0,n);function preAdd(newData,n0,n1){newValues=newData.map(value);newIndex=sort(crossfilter_range(n1),0,n1);newValues=permute(newValues,newIndex);var bounds=refilter(newValues),lo1=bounds[0],hi1=bounds[1],i;for(i=0;i<lo1;++i){filters[newIndex[i]+n0]|=one}for(i=hi1;i<n1;++i){filters[newIndex[i]+n0]|=one}if(!n0){values=newValues;index=newIndex;lo0=lo1;hi0=hi1;return}var oldValues=values,oldIndex=index,i0=0,i1=0;values=new Array(n);index=crossfilter_index(n,n);for(i=0;i0<n0&&i1<n1;++i){if(oldValues[i0]<newValues[i1]){values[i]=oldValues[i0];index[i]=oldIndex[i0++]}else{values[i]=newValues[i1];index[i]=newIndex[i1++]+n0}}for(;i0<n0;++i0,++i){values[i]=oldValues[i0];index[i]=oldIndex[i0]}for(;i1<n1;++i1,++i){values[i]=newValues[i1];index[i]=newIndex[i1]+n0}bounds=refilter(values),lo0=bounds[0],hi0=bounds[1]}function postAdd(newData,n0,n1){indexListeners.forEach(function(l){l(newValues,newIndex,n0,n1)});newValues=newIndex=null}function filterIndex(bounds){var i,j,k,lo1=bounds[0],hi1=bounds[1],added=[],removed=[];if(lo1<lo0){for(i=lo1,j=Math.min(lo0,hi1);i<j;++i){filters[k=index[i]]^=one;added.push(k)}}else{if(lo1>lo0){for(i=lo0,j=Math.min(lo1,hi0);i<j;++i){filters[k=index[i]]^=one;removed.push(k)}}}if(hi1>hi0){for(i=Math.max(lo1,hi0),j=hi1;i<j;++i){filters[k=index[i]]^=one;added.push(k)}}else{if(hi1<hi0){for(i=Math.max(lo0,hi1),j=hi0;i<j;++i){filters[k=index[i]]^=one;removed.push(k)}}}lo0=lo1;hi0=hi1;filterListeners.forEach(function(l){l(one,added,removed)});return dimension}function filter(range){return range==null?filterAll():Array.isArray(range)?filterRange(range):filterExact(range)}function filterExact(value){return filterIndex((refilter=crossfilter_filterExact(bisect,value))(values))}function filterRange(range){return filterIndex((refilter=crossfilter_filterRange(bisect,range))(values))}function filterAll(){return filterIndex((refilter=crossfilter_filterAll)(values))}function top(k){var array=[],i=hi0,j;while(--i>=lo0&&k>0){if(!filters[j=index[i]]){array.push(data[j]);--k}}return array}function group(key){var group={top:top,all:all,reduce:reduce,reduceCount:reduceCount,reduceSum:reduceSum,order:order,orderNatural:orderNatural,size:size};var groups,groupIndex,groupWidth=8,groupCapacity=crossfilter_capacity(groupWidth),k=0,select,heap,reduceAdd,reduceRemove,reduceInitial,update=crossfilter_null,reset=crossfilter_null,resetNeeded=true;if(arguments.length<1){key=crossfilter_identity}filterListeners.push(update);indexListeners.push(add);add(values,index,0,n);function add(newValues,newIndex,n0,n1){var oldGroups=groups,reIndex=crossfilter_index(k,groupCapacity),add=reduceAdd,initial=reduceInitial,k0=k,i0=0,i1=0,j,g0,x0,x1,g,x;if(resetNeeded){add=initial=crossfilter_null}groups=new Array(k),k=0;groupIndex=k0>1?crossfilter_arrayLengthen(groupIndex,n):crossfilter_index(n,groupCapacity);if(k0){x0=(g0=oldGroups[0]).key}while(i1<n1&&!((x1=key(newValues[i1]))>=x1)){++i1}while(i1<n1){if(g0&&x0<=x1){g=g0,x=x0;reIndex[i0]=k;if(g0=oldGroups[++i0]){x0=g0.key}}else{g={key:x1,value:initial()},x=x1}groups[k]=g;while(!(x1>x)){groupIndex[j=newIndex[i1]+n0]=k;if(!(filters[j]&zero)){g.value=add(g.value,data[j])}if(++i1>=n1){break}x1=key(newValues[i1])}groupIncrement()}while(i0<k0){groups[reIndex[i0]=k]=oldGroups[i0++];groupIncrement()}if(k>i0){for(i0=0;i0<n0;++i0){groupIndex[i0]=reIndex[groupIndex[i0]]}}j=filterListeners.indexOf(update);if(k>1){update=updateMany;reset=resetMany}else{if(k===1){update=updateOne;reset=resetOne}else{update=crossfilter_null;reset=crossfilter_null}groupIndex=null}filterListeners[j]=update;function groupIncrement(){if(++k===groupCapacity){reIndex=crossfilter_arrayWiden(reIndex,groupWidth<<=1);groupIndex=crossfilter_arrayWiden(groupIndex,groupWidth);groupCapacity=crossfilter_capacity(groupWidth)}}}function updateMany(filterOne,added,removed){if(filterOne===one||resetNeeded){return}var i,k,n,g;for(i=0,n=added.length;i<n;++i){if(!(filters[k=added[i]]&zero)){g=groups[groupIndex[k]];g.value=reduceAdd(g.value,data[k])}}for(i=0,n=removed.length;i<n;++i){if((filters[k=removed[i]]&zero)===filterOne){g=groups[groupIndex[k]];g.value=reduceRemove(g.value,data[k])}}}function updateOne(filterOne,added,removed){if(filterOne===one||resetNeeded){return}var i,k,n,g=groups[0];for(i=0,n=added.length;i<n;++i){if(!(filters[k=added[i]]&zero)){g.value=reduceAdd(g.value,data[k])}}for(i=0,n=removed.length;i<n;++i){if((filters[k=removed[i]]&zero)===filterOne){g.value=reduceRemove(g.value,data[k])}}}function resetMany(){var i,g;for(i=0;i<k;++i){groups[i].value=reduceInitial()}for(i=0;i<n;++i){if(!(filters[i]&zero)){g=groups[groupIndex[i]];g.value=reduceAdd(g.value,data[i])}}}function resetOne(){var i,g=groups[0];g.value=reduceInitial();for(i=0;i<n;++i){if(!(filters[i]&zero)){g.value=reduceAdd(g.value,data[i])}}}function all(){if(resetNeeded){reset(),resetNeeded=false}return groups}function top(k){var top=select(all(),0,groups.length,k);return heap.sort(top,0,top.length)}function reduce(add,remove,initial){reduceAdd=add;reduceRemove=remove;reduceInitial=initial;resetNeeded=true;return group}function reduceCount(){return reduce(crossfilter_reduceIncrement,crossfilter_reduceDecrement,crossfilter_zero)}function reduceSum(value){return reduce(crossfilter_reduceAdd(value),crossfilter_reduceSubtract(value),crossfilter_zero)}function order(value){select=heapselect_by(valueOf);heap=heap_by(valueOf);function valueOf(d){return value(d.value)}return group}function orderNatural(){return order(crossfilter_identity)}function size(){return k}return reduceCount().orderNatural()}function groupAll(){var g=group(crossfilter_null),all=g.all;delete g.all;delete g.top;delete g.order;delete g.orderNatural;delete g.size;g.value=function(){return all()[0].value};return g}return dimension}function groupAll(){var group={reduce:reduce,reduceCount:reduceCount,reduceSum:reduceSum,value:value};var reduceValue,reduceAdd,reduceRemove,reduceInitial,resetNeeded=true;filterListeners.push(update);dataListeners.push(add);add(data,0,n);function add(newData,n0,n1){var i;if(resetNeeded){return}for(i=n0;i<n;++i){if(!filters[i]){reduceValue=reduceAdd(reduceValue,data[i])}}}function update(filterOne,added,removed){var i,k,n;if(resetNeeded){return}for(i=0,n=added.length;i<n;++i){if(!filters[k=added[i]]){reduceValue=reduceAdd(reduceValue,data[k])}}for(i=0,n=removed.length;i<n;++i){if(filters[k=removed[i]]===filterOne){reduceValue=reduceRemove(reduceValue,data[k])}}}function reset(){var i;reduceValue=reduceInitial();for(i=0;i<n;++i){if(!filters[i]){reduceValue=reduceAdd(reduceValue,data[i])}}}function reduce(add,remove,initial){reduceAdd=add;reduceRemove=remove;reduceInitial=initial;resetNeeded=true;return group}function reduceCount(){return reduce(crossfilter_reduceIncrement,crossfilter_reduceDecrement,crossfilter_zero)}function reduceSum(value){return reduce(crossfilter_reduceAdd(value),crossfilter_reduceSubtract(value),crossfilter_zero)}function value(){if(resetNeeded){reset(),resetNeeded=false}return reduceValue}return reduceCount()}function size(){return n}return arguments.length?add(arguments[0]):crossfilter}function crossfilter_index(n,m){return(m<257?crossfilter_array8:m<65537?crossfilter_array16:crossfilter_array32)(n)}function crossfilter_range(n){var range=crossfilter_index(n,n);for(var i=-1;++i<n;){range[i]=i}return range}function crossfilter_capacity(w){return w===8?256:w===16?65536:4294967296}})(this);(function(a){function b(a){return a}function c(a,b){for(var c=0,d=b.length,e=new Array(d);c<d;++c){e[c]=a[b[c]]}return e}function e(a){function b(b,c,d,e){while(d<e){var f=d+e>>1;a(b[f])<c?d=f+1:e=f}return d}function c(b,c,d,e){while(d<e){var f=d+e>>1;c<a(b[f])?e=f:d=f+1}return d}return c.right=c,c.left=b,c}function g(a){function b(a,b,c){var e=c-b,f=(e>>>1)+1;while(--f>0){d(a,f,e,b)}return a}function c(a,b,c){var e=c-b,f;while(--e>0){f=a[b],a[b]=a[b+e],a[b+e]=f,d(a,1,e,b)}return a}function d(b,c,d,e){var f=b[--e+c],g=a(f),h;while((h=c<<1)<=d){h<d&&a(b[e+h])>a(b[e+h+1])&&h++;if(g<=a(b[e+h])){break}b[e+c]=b[e+h],c=h}b[e+c]=f}return b.sort=c,b}function i(a){function c(c,d,e,f){var g=new Array(f=Math.min(e-d,f)),h,i,j,k;for(i=0;i<f;++i){g[i]=c[d++]}b(g,0,f);if(d<e){h=a(g[0]);do{if(j=a(k=c[d])>h){g[0]=k,h=a(b(g,0,f)[0])}}while(++d<e)}return g}var b=g(a);return c}function k(a){function b(b,c,d){for(var e=c+1;e<d;++e){for(var f=e,g=b[e],h=a(g);f>c&&a(b[f-1])>h;--f){b[f]=b[f-1]}b[f]=g}return b}return b}function m(a){function c(a,c,e){return(e-c<n?b:d)(a,c,e)}function d(b,d,e){var f=(e-d)/6|0,g=d+f,h=e-1-f,i=d+e-1>>1,j=i-f,k=i+f,l=b[g],m=a(l),n=b[j],o=a(n),p=b[i],q=a(p),r=b[k],s=a(r),t=b[h],u=a(t),v;m>o&&(v=l,l=n,n=v,v=m,m=o,o=v),s>u&&(v=r,r=t,t=v,v=s,s=u,u=v),m>q&&(v=l,l=p,p=v,v=m,m=q,q=v),o>q&&(v=n,n=p,p=v,v=o,o=q,q=v),m>s&&(v=l,l=r,r=v,v=m,m=s,s=v),q>s&&(v=p,p=r,r=v,v=q,q=s,s=v),o>u&&(v=n,n=t,t=v,v=o,o=u,u=v),o>q&&(v=n,n=p,p=v,v=o,o=q,q=v),s>u&&(v=r,r=t,t=v,v=s,s=u,u=v);var w=n,x=o,y=r,z=s;b[g]=l,b[j]=b[d],b[i]=p,b[k]=b[e-1],b[h]=t;var A=d+1,B=e-2,C=x<=z&&x>=z;if(C){for(var D=A;D<=B;++D){var E=b[D],F=a(E);if(F<x){D!==A&&(b[D]=b[A],b[A]=E),++A}else{if(F>x){for(;;){var G=a(b[B]);if(G>x){B--;continue}if(G<x){b[D]=b[A],b[A++]=b[B],b[B--]=E;break}b[D]=b[B],b[B--]=E;break}}}}}else{for(var D=A;D<=B;D++){var E=b[D],F=a(E);if(F<x){D!==A&&(b[D]=b[A],b[A]=E),++A}else{if(F>z){for(;;){var G=a(b[B]);if(G>z){B--;if(B<D){break}continue}G<x?(b[D]=b[A],b[A++]=b[B],b[B--]=E):(b[D]=b[B],b[B--]=E);break}}}}}b[d]=b[A-1],b[A-1]=w,b[e-1]=b[B+1],b[B+1]=y,c(b,d,A-1),c(b,B+2,e);if(C){return b}if(A<g&&B>h){var H,G;while((H=a(b[A]))<=x&&H>=x){++A}while((G=a(b[B]))<=z&&G>=z){--B}for(var D=A;D<=B;D++){var E=b[D],F=a(E);if(F<=x&&F>=x){D!==A&&(b[D]=b[A],b[A]=E),A++}else{if(F<=z&&F>=z){for(;;){var G=a(b[B]);if(G<=z&&G>=z){B--;if(B<D){break}continue}G<x?(b[D]=b[A],b[A++]=b[B],b[B--]=E):(b[D]=b[B],b[B--]=E);break}}}}}return c(b,A,B+1)}var b=k(a);return c}function t(a){return new Array(a)}function u(a,b){return function(c){var d=c.length;return[a.left(c,b,0,d),a.right(c,b,0,d)]}}function v(a,b){var c=b[0],d=b[1];return function(b){var e=b.length;return[a.left(b,c,0,e),a.left(b,d,0,e)]}}function w(a){return[0,a.length]}function x(){return null}function y(){return 0}function z(a){return a+1}function A(a){return a-1}function B(a){return function(b,c){return b+ +a(c)}}function C(a){return function(b,c){return b-a(c)}}function D(){function p(b){var c=f,d=b.length;return d&&(e=e.concat(b),k=r(k,f+=d),n.forEach(function(a){a(b,c,d)})),a}function q(a){function P(b,d,e){H=b.map(a),I=J(F(e),0,e),H=c(H,I);var g=K(H),h=g[0],i=g[1],j;for(j=0;j<h;++j){k[I[j]+d]|=p}for(j=i;j<e;++j){k[I[j]+d]|=p}if(!d){t=H,D=I,N=h,O=i;return}var l=t,m=D,n=0,o=0;t=new Array(f),D=E(f,f);for(j=0;n<d&&o<e;++j){l[n]<H[o]?(t[j]=l[n],D[j]=m[n++]):(t[j]=H[o],D[j]=I[o++]+d)}for(;n<d;++n,++j){t[j]=l[n],D[j]=m[n]}for(;o<e;++o,++j){t[j]=H[o],D[j]=I[o]+d}g=K(t),N=g[0],O=g[1]}function Q(a,b,c){L.forEach(function(a){a(H,I,b,c)}),H=I=null}function R(a){var b,c,d,e=a[0],f=a[1],g=[],h=[];if(e<N){for(b=e,c=Math.min(N,f);b<c;++b){k[d=D[b]]^=p,g.push(d)}}else{if(e>N){for(b=N,c=Math.min(e,O);b<c;++b){k[d=D[b]]^=p,h.push(d)}}}if(f>O){for(b=Math.max(e,O),c=f;b<c;++b){k[d=D[b]]^=p,g.push(d)}}else{if(f<O){for(b=Math.max(N,f),c=O;b<c;++b){k[d=D[b]]^=p,h.push(d)}}}return N=e,O=f,l.forEach(function(a){a(p,g,h)}),o}function S(a){return a==null?V():Array.isArray(a)?U(a):T(a)}function T(a){return R((K=u(d,a))(t))}function U(a){return R((K=v(d,a))(t))}function V(){return R((K=w)(t))}function W(a){var b=[],c=O,d;while(--c>=N&&a>0){k[d=D[c]]||(b.push(e[d]),--a)}return b}function X(a){function K(b,c,g,i){function Q(){++n===m&&(p=s(p,j<<=1),h=s(h,j),m=G(j))}var o=d,p=E(n,m),t=v,u=F,w=n,y=0,z=0,A,B,C,D,K,L;J&&(t=u=x),d=new Array(n),n=0,h=w>1?r(h,f):E(f,m),w&&(C=(B=o[0]).key);while(z<i&&!((D=a(b[z]))>=D)){++z}while(z<i){if(B&&C<=D){K=B,L=C,p[y]=n;if(B=o[++y]){C=B.key}}else{K={key:D,value:u()},L=D}d[n]=K;while(!(D>L)){h[A=c[z]+g]=n,k[A]&q||(K.value=t(K.value,e[A]));if(++z>=i){break}D=a(b[z])}Q()}while(y<w){d[p[y]=n]=o[y++],Q()}if(n>y){for(y=0;y<g;++y){h[y]=p[h[y]]}}A=l.indexOf(H),n>1?(H=M,I=O):(n===1?(H=N,I=P):(H=x,I=x),h=null),l[A]=H}function M(a,b,c){if(a===p||J){return}var f,g,i,j;for(f=0,i=b.length;f<i;++f){k[g=b[f]]&q||(j=d[h[g]],j.value=v(j.value,e[g]))}for(f=0,i=c.length;f<i;++f){(k[g=c[f]]&q)===a&&(j=d[h[g]],j.value=w(j.value,e[g]))}}function N(a,b,c){if(a===p||J){return}var f,g,h,i=d[0];for(f=0,h=b.length;f<h;++f){k[g=b[f]]&q||(i.value=v(i.value,e[g]))}for(f=0,h=c.length;f<h;++f){(k[g=c[f]]&q)===a&&(i.value=w(i.value,e[g]))}}function O(){var a,b;for(a=0;a<n;++a){d[a].value=F()}for(a=0;a<f;++a){k[a]&q||(b=d[h[a]],b.value=v(b.value,e[a]))}}function P(){var a,b=d[0];b.value=F();for(a=0;a<f;++a){k[a]&q||(b.value=v(b.value,e[a]))}}function Q(){return J&&(I(),J=!1),d}function R(a){var b=o(Q(),0,d.length,a);return u.sort(b,0,b.length)}function S(a,b,d){return v=a,w=b,F=d,J=!0,c}function T(){return S(z,A,y)}function U(a){return S(B(a),C(a),y)}function V(a){function b(b){return a(b.value)}return o=i(b),u=g(b),c}function W(){return V(b)}function X(){return n}var c={top:R,all:Q,reduce:S,reduceCount:T,reduceSum:U,order:V,orderNatural:W,size:X},d,h,j=8,m=G(j),n=0,o,u,v,w,F,H=x,I=x,J=!0;return arguments.length<1&&(a=b),l.push(H),L.push(K),K(t,D,0,f),T().orderNatural()}function Y(){var a=X(x),b=a.all;return delete a.all,delete a.top,delete a.order,delete a.orderNatural,delete a.size,a.value=function(){return b()[0].value},a}var o={filter:S,filterExact:T,filterRange:U,filterAll:V,top:W,group:X,groupAll:Y},p=1<<h++,q=~p,t,D,H,I,J=m(function(a){return H[a]}),K=w,L=[],N=0,O=0;return n.unshift(P),n.push(Q),h>j&&(k=s(k,j<<=1)),P(e,0,f),Q(e,0,f),o}function t(){function i(a,d,g){var i;if(h){return}for(i=d;i<f;++i){k[i]||(b=c(b,e[i]))}}function j(a,f,g){var i,j,l;if(h){return}for(i=0,l=f.length;i<l;++i){k[j=f[i]]||(b=c(b,e[j]))}for(i=0,l=g.length;i<l;++i){k[j=g[i]]===a&&(b=d(b,e[j]))}}function m(){var a;b=g();for(a=0;a<f;++a){k[a]||(b=c(b,e[a]))}}function o(b,e,f){return c=b,d=e,g=f,h=!0,a}function p(){return o(z,A,y)}function q(a){return o(B(a),C(a),y)}function r(){return h&&(m(),h=!1),b}var a={reduce:o,reduceCount:p,reduceSum:q,value:r},b,c,d,g,h=!0;return l.push(j),n.push(i),i(e,0,f),p()}function D(){return f}var a={add:p,dimension:q,groupAll:t,size:D},e=[],f=0,h=0,j=8,k=o(0),l=[],n=[];return arguments.length?p(arguments[0]):a}function E(a,b){return(b<257?o:b<65537?p:q)(a)}function F(a){var b=E(a,a);for(var c=-1;++c<a;){b[c]=c}return b}function G(a){return a===8?256:a===16?65536:4294967296}D.version="1.0.3",D.permute=c;var d=D.bisect=e(b);d.by=e;var f=D.heap=g(b);f.by=g;var h=D.heapselect=i(b);h.by=i;var j=D.insertionsort=k(b);j.by=k;var l=D.quicksort=m(b);l.by=m;var n=32,o=t,p=t,q=t,r=b,s=b;typeof Uint8Array!="undefined"&&(o=function(a){return new Uint8Array(a)},p=function(a){return new Uint16Array(a)},q=function(a){return new Uint32Array(a)},r=function(a,b){var c=new a.constructor(b);return c.set(a),c},s=function(a,b){var c;switch(b){case 16:c=p(a.length);break;case 32:c=q(a.length);break;default:throw new Error("invalid array width!")}return c.set(a),c}),a.crossfilter=D})(this);(function(){function d3_class(ctor,properties){try{for(var key in properties){Object.defineProperty(ctor.prototype,key,{value:properties[key],enumerable:false})}}catch(e){ctor.prototype=properties}}function d3_arrayCopy(pseudoarray){var i=-1,n=pseudoarray.length,array=[];while(++i<n){array.push(pseudoarray[i])}return array}function d3_arraySlice(pseudoarray){return Array.prototype.slice.call(pseudoarray)}function d3_Map(){}function d3_identity(d){return d}function d3_this(){return this}function d3_true(){return true}function d3_functor(v){return typeof v==="function"?v:function(){return v}}function d3_rebind(target,source,method){return function(){var value=method.apply(source,arguments);return arguments.length?target:value}}function d3_number(x){return x!=null&&!isNaN(x)}function d3_zipLength(d){return d.length}function d3_splitter(d){return d==null}function d3_collapse(s){return s.trim().replace(/\s+/g," ")}function d3_range_integerScale(x){var k=1;while(x*k%1){k*=10}return k}function d3_dispatch(){}function d3_dispatch_event(dispatch){function event(){var z=listeners,i=-1,n=z.length,l;while(++i<n){if(l=z[i].on){l.apply(this,arguments)}}return dispatch}var listeners=[],listenerByName=new d3_Map;event.on=function(name,listener){var l=listenerByName.get(name),i;if(arguments.length<2){return l&&l.on}if(l){l.on=null;listeners=listeners.slice(0,i=listeners.indexOf(l)).concat(listeners.slice(i+1));listenerByName.remove(name)}if(listener){listeners.push(listenerByName.set(name,{on:listener}))}return dispatch};return event}function d3_format_precision(x,p){return p-(x?1+Math.floor(Math.log(x+Math.pow(10,1+Math.floor(Math.log(x)/Math.LN10)-p))/Math.LN10):1)}function d3_format_typeDefault(x){return x+""}function d3_format_group(value){var i=value.lastIndexOf("."),f=i>=0?value.substring(i):(i=value.length,""),t=[];while(i>0){t.push(value.substring(i-=3,i+3))}return t.reverse().join(",")+f}function d3_formatPrefix(d,i){var k=Math.pow(10,Math.abs(8-i)*3);return{scale:i>8?function(d){return d/k}:function(d){return d*k},symbol:d}}function d3_ease_clamp(f){return function(t){return t<=0?0:t>=1?1:f(t)}}function d3_ease_reverse(f){return function(t){return 1-f(1-t)}}function d3_ease_reflect(f){return function(t){return 0.5*(t<0.5?f(2*t):2-f(2-2*t))}}function d3_ease_identity(t){return t}function d3_ease_poly(e){return function(t){return Math.pow(t,e)}}function d3_ease_sin(t){return 1-Math.cos(t*Math.PI/2)}function d3_ease_exp(t){return Math.pow(2,10*(t-1))}function d3_ease_circle(t){return 1-Math.sqrt(1-t*t)}function d3_ease_elastic(a,p){var s;if(arguments.length<2){p=0.45}if(arguments.length<1){a=1;s=p/4}else{s=p/(2*Math.PI)*Math.asin(1/a)}return function(t){return 1+a*Math.pow(2,10*-t)*Math.sin((t-s)*2*Math.PI/p)}}function d3_ease_back(s){if(!s){s=1.70158}return function(t){return t*t*((s+1)*t-s)}}function d3_ease_bounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+0.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+0.9375:7.5625*(t-=2.625/2.75)*t+0.984375}function d3_eventCancel(){d3.event.stopPropagation();d3.event.preventDefault()}function d3_eventSource(){var e=d3.event,s;while(s=e.sourceEvent){e=s}return e}function d3_eventDispatch(target){var dispatch=new d3_dispatch,i=0,n=arguments.length;while(++i<n){dispatch[arguments[i]]=d3_dispatch_event(dispatch)}dispatch.of=function(thiz,argumentz){return function(e1){try{var e0=e1.sourceEvent=d3.event;e1.target=target;d3.event=e1;dispatch[e1.type].apply(thiz,argumentz)}finally{d3.event=e0}}};return dispatch}function d3_transform(m){var r0=[m.a,m.b],r1=[m.c,m.d],kx=d3_transformNormalize(r0),kz=d3_transformDot(r0,r1),ky=d3_transformNormalize(d3_transformCombine(r1,r0,-kz))||0;if(r0[0]*r1[1]<r1[0]*r0[1]){r0[0]*=-1;r0[1]*=-1;kx*=-1;kz*=-1}this.rotate=(kx?Math.atan2(r0[1],r0[0]):Math.atan2(-r1[0],r1[1]))*d3_transformDegrees;this.translate=[m.e,m.f];this.scale=[kx,ky];this.skew=ky?Math.atan2(kz,ky)*d3_transformDegrees:0}function d3_transformDot(a,b){return a[0]*b[0]+a[1]*b[1]}function d3_transformNormalize(a){var k=Math.sqrt(d3_transformDot(a,a));if(k){a[0]/=k;a[1]/=k}return k}function d3_transformCombine(a,b,k){a[0]+=k*b[0];a[1]+=k*b[1];return a}function d3_interpolateByName(name){return name=="transform"?d3.interpolateTransform:d3.interpolate}function d3_uninterpolateNumber(a,b){b=b-(a=+a)?1/(b-a):0;return function(x){return(x-a)*b}}function d3_uninterpolateClamp(a,b){b=b-(a=+a)?1/(b-a):0;return function(x){return Math.max(0,Math.min(1,(x-a)*b))}}function d3_rgb(r,g,b){return new d3_Rgb(r,g,b)}function d3_Rgb(r,g,b){this.r=r;this.g=g;this.b=b}function d3_rgb_hex(v){return v<16?"0"+Math.max(0,v).toString(16):Math.min(255,v).toString(16)}function d3_rgb_parse(format,rgb,hsl){var r=0,g=0,b=0,m1,m2,name;m1=/([a-z]+)\((.*)\)/i.exec(format);if(m1){m2=m1[2].split(",");switch(m1[1]){case"hsl":return hsl(parseFloat(m2[0]),parseFloat(m2[1])/100,parseFloat(m2[2])/100);case"rgb":return rgb(d3_rgb_parseNumber(m2[0]),d3_rgb_parseNumber(m2[1]),d3_rgb_parseNumber(m2[2]))}}if(name=d3_rgb_names.get(format)){return rgb(name.r,name.g,name.b)}if(format!=null&&format.charAt(0)==="#"){if(format.length===4){r=format.charAt(1);r+=r;g=format.charAt(2);g+=g;b=format.charAt(3);b+=b}else{if(format.length===7){r=format.substring(1,3);g=format.substring(3,5);b=format.substring(5,7)}}r=parseInt(r,16);g=parseInt(g,16);b=parseInt(b,16)}return rgb(r,g,b)}function d3_rgb_hsl(r,g,b){var min=Math.min(r/=255,g/=255,b/=255),max=Math.max(r,g,b),d=max-min,h,s,l=(max+min)/2;if(d){s=l<0.5?d/(max+min):d/(2-max-min);if(r==max){h=(g-b)/d+(g<b?6:0)}else{if(g==max){h=(b-r)/d+2}else{h=(r-g)/d+4}}h*=60}else{s=h=0}return d3_hsl(h,s,l)}function d3_rgb_lab(r,g,b){r=d3_rgb_xyz(r);g=d3_rgb_xyz(g);b=d3_rgb_xyz(b);var x=d3_xyz_lab((0.4124564*r+0.3575761*g+0.1804375*b)/d3_lab_X),y=d3_xyz_lab((0.2126729*r+0.7151522*g+0.072175*b)/d3_lab_Y),z=d3_xyz_lab((0.0193339*r+0.119192*g+0.9503041*b)/d3_lab_Z);return d3_lab(116*y-16,500*(x-y),200*(y-z))}function d3_rgb_xyz(r){return(r/=255)<=0.04045?r/12.92:Math.pow((r+0.055)/1.055,2.4)}function d3_rgb_parseNumber(c){var f=parseFloat(c);return c.charAt(c.length-1)==="%"?Math.round(f*2.55):f}function d3_hsl(h,s,l){return new d3_Hsl(h,s,l)}function d3_Hsl(h,s,l){this.h=h;this.s=s;this.l=l}function d3_hsl_rgb(h,s,l){function v(h){if(h>360){h-=360}else{if(h<0){h+=360}}if(h<60){return m1+(m2-m1)*h/60}if(h<180){return m2}if(h<240){return m1+(m2-m1)*(240-h)/60}return m1}function vv(h){return Math.round(v(h)*255)}var m1,m2;h=h%360;if(h<0){h+=360}s=s<0?0:s>1?1:s;l=l<0?0:l>1?1:l;m2=l<=0.5?l*(1+s):l+s-l*s;m1=2*l-m2;return d3_rgb(vv(h+120),vv(h),vv(h-120))}function d3_hcl(h,c,l){return new d3_Hcl(h,c,l)}function d3_Hcl(h,c,l){this.h=h;this.c=c;this.l=l}function d3_hcl_lab(h,c,l){return d3_lab(l,Math.cos(h*=Math.PI/180)*c,Math.sin(h)*c)}function d3_lab(l,a,b){return new d3_Lab(l,a,b)}function d3_Lab(l,a,b){this.l=l;this.a=a;this.b=b}function d3_lab_rgb(l,a,b){var y=(l+16)/116,x=y+a/500,z=y-b/200;x=d3_lab_xyz(x)*d3_lab_X;y=d3_lab_xyz(y)*d3_lab_Y;z=d3_lab_xyz(z)*d3_lab_Z;return d3_rgb(d3_xyz_rgb(3.2404542*x-1.5371385*y-0.4985314*z),d3_xyz_rgb(-0.969266*x+1.8760108*y+0.041556*z),d3_xyz_rgb(0.0556434*x-0.2040259*y+1.0572252*z))}function d3_lab_hcl(l,a,b){return d3_hcl(Math.atan2(b,a)/Math.PI*180,Math.sqrt(a*a+b*b),l)}function d3_lab_xyz(x){return x>0.206893034?x*x*x:(x-4/29)/7.787037}function d3_xyz_lab(x){return x>0.008856?Math.pow(x,1/3):7.787037*x+4/29}function d3_xyz_rgb(r){return Math.round(255*(r<=0.00304?12.92*r:1.055*Math.pow(r,1/2.4)-0.055))}function d3_selection(groups){d3_arraySubclass(groups,d3_selectionPrototype);return groups}function d3_selection_selector(selector){return function(){return d3_select(selector,this)}}function d3_selection_selectorAll(selector){return function(){return d3_selectAll(selector,this)}}function d3_selection_attr(name,value){function attrNull(){this.removeAttribute(name)}function attrNullNS(){this.removeAttributeNS(name.space,name.local)}function attrConstant(){this.setAttribute(name,value)}function attrConstantNS(){this.setAttributeNS(name.space,name.local,value)}function attrFunction(){var x=value.apply(this,arguments);if(x==null){this.removeAttribute(name)}else{this.setAttribute(name,x)}}function attrFunctionNS(){var x=value.apply(this,arguments);if(x==null){this.removeAttributeNS(name.space,name.local)}else{this.setAttributeNS(name.space,name.local,x)}}name=d3.ns.qualify(name);return value==null?name.local?attrNullNS:attrNull:typeof value==="function"?name.local?attrFunctionNS:attrFunction:name.local?attrConstantNS:attrConstant}function d3_selection_classedRe(name){return new RegExp("(?:^|\\s+)"+d3.requote(name)+"(?:\\s+|$)","g")}function d3_selection_classed(name,value){function classedConstant(){var i=-1;while(++i<n){name[i](this,value)}}function classedFunction(){var i=-1,x=value.apply(this,arguments);while(++i<n){name[i](this,x)}}name=name.trim().split(/\s+/).map(d3_selection_classedName);var n=name.length;return typeof value==="function"?classedFunction:classedConstant}function d3_selection_classedName(name){var re=d3_selection_classedRe(name);return function(node,value){if(c=node.classList){return value?c.add(name):c.remove(name)}var c=node.className,cb=c.baseVal!=null,cv=cb?c.baseVal:c;if(value){re.lastIndex=0;if(!re.test(cv)){cv=d3_collapse(cv+" "+name);if(cb){c.baseVal=cv}else{node.className=cv}}}else{if(cv){cv=d3_collapse(cv.replace(re," "));if(cb){c.baseVal=cv}else{node.className=cv}}}}}function d3_selection_style(name,value,priority){function styleNull(){this.style.removeProperty(name)}function styleConstant(){this.style.setProperty(name,value,priority)}function styleFunction(){var x=value.apply(this,arguments);if(x==null){this.style.removeProperty(name)}else{this.style.setProperty(name,x,priority)}}return value==null?styleNull:typeof value==="function"?styleFunction:styleConstant}function d3_selection_property(name,value){function propertyNull(){delete this[name]}function propertyConstant(){this[name]=value}function propertyFunction(){var x=value.apply(this,arguments);if(x==null){delete this[name]}else{this[name]=x}}return value==null?propertyNull:typeof value==="function"?propertyFunction:propertyConstant}function d3_selection_dataNode(data){return{__data__:data}}function d3_selection_filter(selector){return function(){return d3_selectMatches(this,selector)}}function d3_selection_sortComparator(comparator){if(!arguments.length){comparator=d3.ascending}return function(a,b){return comparator(a&&a.__data__,b&&b.__data__)}}function d3_selection_on(type,listener,capture){function onRemove(){var wrapper=this[name];if(wrapper){this.removeEventListener(type,wrapper,wrapper.$);delete this[name]}}function onAdd(){function wrapper(e){var o=d3.event;d3.event=e;args[0]=node.__data__;try{listener.apply(node,args)}finally{d3.event=o}}var node=this,args=arguments;onRemove.call(this);this.addEventListener(type,this[name]=wrapper,wrapper.$=capture);wrapper._=listener}var name="__on"+type,i=type.indexOf(".");if(i>0){type=type.substring(0,i)}return listener?onAdd:onRemove}function d3_selection_each(groups,callback){for(var j=0,m=groups.length;j<m;j++){for(var group=groups[j],i=0,n=group.length,node;i<n;i++){if(node=group[i]){callback(node,i,j)}}}return groups}function d3_selection_enter(selection){d3_arraySubclass(selection,d3_selection_enterPrototype);return selection}function d3_transition(groups,id,time){d3_arraySubclass(groups,d3_transitionPrototype);var tweens=new d3_Map,event=d3.dispatch("start","end"),ease=d3_transitionEase;groups.id=id;groups.time=time;groups.tween=function(name,tween){if(arguments.length<2){return tweens.get(name)}if(tween==null){tweens.remove(name)}else{tweens.set(name,tween)}return groups};groups.ease=function(value){if(!arguments.length){return ease}ease=typeof value==="function"?value:d3.ease.apply(d3,arguments);return groups};groups.each=function(type,listener){if(arguments.length<2){return d3_transition_each.call(groups,type)}event.on(type,listener);return groups};d3.timer(function(elapsed){return d3_selection_each(groups,function(node,i,j){function start(elapsed){if(lock.active>id){return stop()}lock.active=id;tweens.forEach(function(key,value){if(value=value.call(node,d,i)){tweened.push(value)}});event.start.call(node,d,i);if(!tick(elapsed)){d3.timer(tick,0,time)}return 1}function tick(elapsed){if(lock.active!==id){return stop()}var t=(elapsed-delay)/duration,e=ease(t),n=tweened.length;while(n>0){tweened[--n].call(node,e)}if(t>=1){stop();d3_transitionId=id;event.end.call(node,d,i);d3_transitionId=0;return 1}}function stop(){if(!--lock.count){delete node.__transition__}return 1}var tweened=[],delay=node.delay,duration=node.duration,lock=(node=node.node).__transition__||(node.__transition__={active:0,count:0}),d=node.__data__;++lock.count;delay<=elapsed?start(elapsed):d3.timer(start,delay,time)})},0,time);return groups}function d3_transition_each(callback){var id=d3_transitionId,ease=d3_transitionEase,delay=d3_transitionDelay,duration=d3_transitionDuration;d3_transitionId=this.id;d3_transitionEase=this.ease();d3_selection_each(this,function(node,i,j){d3_transitionDelay=node.delay;d3_transitionDuration=node.duration;callback.call(node=node.node,node.__data__,i,j)});d3_transitionId=id;d3_transitionEase=ease;d3_transitionDelay=delay;d3_transitionDuration=duration;return this}function d3_tweenNull(d,i,a){return a!=""&&d3_tweenRemove}function d3_tweenByName(b,name){return d3.tween(b,d3_interpolateByName(name))}function d3_timer_step(){var elapsed,now=Date.now(),t1=d3_timer_queue;while(t1){elapsed=now-t1.then;if(elapsed>=t1.delay){t1.flush=t1.callback(elapsed)}t1=t1.next}var delay=d3_timer_flush()-now;if(delay>24){if(isFinite(delay)){clearTimeout(d3_timer_timeout);d3_timer_timeout=setTimeout(d3_timer_step,delay)}d3_timer_interval=0}else{d3_timer_interval=1;d3_timer_frame(d3_timer_step)}}function d3_timer_flush(){var t0=null,t1=d3_timer_queue,then=Infinity;while(t1){if(t1.flush){t1=t0?t0.next=t1.next:d3_timer_queue=t1.next}else{then=Math.min(then,t1.then+t1.delay);t1=(t0=t1).next}}return then}function d3_mousePoint(container,e){var svg=container.ownerSVGElement||container;if(svg.createSVGPoint){var point=svg.createSVGPoint();if(d3_mouse_bug44083<0&&(window.scrollX||window.scrollY)){svg=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var ctm=svg[0][0].getScreenCTM();d3_mouse_bug44083=!(ctm.f||ctm.e);svg.remove()}if(d3_mouse_bug44083){point.x=e.pageX;point.y=e.pageY}else{point.x=e.clientX;point.y=e.clientY}point=point.matrixTransform(container.getScreenCTM().inverse());return[point.x,point.y]}var rect=container.getBoundingClientRect();return[e.clientX-rect.left-container.clientLeft,e.clientY-rect.top-container.clientTop]}function d3_noop(){}function d3_scaleExtent(domain){var start=domain[0],stop=domain[domain.length-1];return start<stop?[start,stop]:[stop,start]}function d3_scaleRange(scale){return scale.rangeExtent?scale.rangeExtent():d3_scaleExtent(scale.range())}function d3_scale_nice(domain,nice){var i0=0,i1=domain.length-1,x0=domain[i0],x1=domain[i1],dx;if(x1<x0){dx=i0,i0=i1,i1=dx;dx=x0,x0=x1,x1=dx}if(nice=nice(x1-x0)){domain[i0]=nice.floor(x0);domain[i1]=nice.ceil(x1)}return domain}function d3_scale_niceDefault(){return Math}function d3_scale_linear(domain,range,interpolate,clamp){function rescale(){var linear=Math.min(domain.length,range.length)>2?d3_scale_polylinear:d3_scale_bilinear,uninterpolate=clamp?d3_uninterpolateClamp:d3_uninterpolateNumber;output=linear(domain,range,uninterpolate,interpolate);input=linear(range,domain,uninterpolate,d3.interpolate);return scale}function scale(x){return output(x)}var output,input;scale.invert=function(y){return input(y)};scale.domain=function(x){if(!arguments.length){return domain}domain=x.map(Number);return rescale()};scale.range=function(x){if(!arguments.length){return range}range=x;return rescale()};scale.rangeRound=function(x){return scale.range(x).interpolate(d3.interpolateRound)};scale.clamp=function(x){if(!arguments.length){return clamp}clamp=x;return rescale()};scale.interpolate=function(x){if(!arguments.length){return interpolate}interpolate=x;return rescale()};scale.ticks=function(m){return d3_scale_linearTicks(domain,m)};scale.tickFormat=function(m){return d3_scale_linearTickFormat(domain,m)};scale.nice=function(){d3_scale_nice(domain,d3_scale_linearNice);return rescale()};scale.copy=function(){return d3_scale_linear(domain,range,interpolate,clamp)};return rescale()}function d3_scale_linearRebind(scale,linear){return d3.rebind(scale,linear,"range","rangeRound","interpolate","clamp")}function d3_scale_linearNice(dx){dx=Math.pow(10,Math.round(Math.log(dx)/Math.LN10)-1);return dx&&{floor:function(x){return Math.floor(x/dx)*dx},ceil:function(x){return Math.ceil(x/dx)*dx}}}function d3_scale_linearTickRange(domain,m){var extent=d3_scaleExtent(domain),span=extent[1]-extent[0],step=Math.pow(10,Math.floor(Math.log(span/m)/Math.LN10)),err=m/span*step;if(err<=0.15){step*=10}else{if(err<=0.35){step*=5}else{if(err<=0.75){step*=2}}}extent[0]=Math.ceil(extent[0]/step)*step;extent[1]=Math.floor(extent[1]/step)*step+step*0.5;extent[2]=step;return extent}function d3_scale_linearTicks(domain,m){return d3.range.apply(d3,d3_scale_linearTickRange(domain,m))}function d3_scale_linearTickFormat(domain,m){return d3.format(",."+Math.max(0,-Math.floor(Math.log(d3_scale_linearTickRange(domain,m)[2])/Math.LN10+0.01))+"f")}function d3_scale_bilinear(domain,range,uninterpolate,interpolate){var u=uninterpolate(domain[0],domain[1]),i=interpolate(range[0],range[1]);return function(x){return i(u(x))}}function d3_scale_polylinear(domain,range,uninterpolate,interpolate){var u=[],i=[],j=0,k=Math.min(domain.length,range.length)-1;if(domain[k]<domain[0]){domain=domain.slice().reverse();range=range.slice().reverse()}while(++j<=k){u.push(uninterpolate(domain[j-1],domain[j]));i.push(interpolate(range[j-1],range[j]))}return function(x){var j=d3.bisect(domain,x,1,k)-1;return i[j](u[j](x))}}function d3_scale_log(linear,log){function scale(x){return linear(log(x))}var pow=log.pow;scale.invert=function(x){return pow(linear.invert(x))};scale.domain=function(x){if(!arguments.length){return linear.domain().map(pow)}log=x[0]<0?d3_scale_logn:d3_scale_logp;pow=log.pow;linear.domain(x.map(log));return scale};scale.nice=function(){linear.domain(d3_scale_nice(linear.domain(),d3_scale_niceDefault));return scale};scale.ticks=function(){var extent=d3_scaleExtent(linear.domain()),ticks=[];if(extent.every(isFinite)){var i=Math.floor(extent[0]),j=Math.ceil(extent[1]),u=pow(extent[0]),v=pow(extent[1]);if(log===d3_scale_logn){ticks.push(pow(i));for(;i++<j;){for(var k=9;k>0;k--){ticks.push(pow(i)*k)}}}else{for(;i<j;i++){for(var k=1;k<10;k++){ticks.push(pow(i)*k)}}ticks.push(pow(i))}for(i=0;ticks[i]<u;i++){}for(j=ticks.length;ticks[j-1]>v;j--){}ticks=ticks.slice(i,j)}return ticks};scale.tickFormat=function(n,format){if(arguments.length<2){format=d3_scale_logFormat}if(arguments.length<1){return format}var k=Math.max(0.1,n/scale.ticks().length),f=log===d3_scale_logn?(e=-1e-12,Math.floor):(e=1e-12,Math.ceil),e;return function(d){return d/pow(f(log(d)+e))<=k?format(d):""}};scale.copy=function(){return d3_scale_log(linear.copy(),log)};return d3_scale_linearRebind(scale,linear)}function d3_scale_logp(x){return Math.log(x<0?0:x)/Math.LN10}function d3_scale_logn(x){return -Math.log(x>0?0:-x)/Math.LN10}function d3_scale_pow(linear,exponent){function scale(x){return linear(powp(x))}var powp=d3_scale_powPow(exponent),powb=d3_scale_powPow(1/exponent);scale.invert=function(x){return powb(linear.invert(x))};scale.domain=function(x){if(!arguments.length){return linear.domain().map(powb)}linear.domain(x.map(powp));return scale};scale.ticks=function(m){return d3_scale_linearTicks(scale.domain(),m)};scale.tickFormat=function(m){return d3_scale_linearTickFormat(scale.domain(),m)};scale.nice=function(){return scale.domain(d3_scale_nice(scale.domain(),d3_scale_linearNice))};scale.exponent=function(x){if(!arguments.length){return exponent}var domain=scale.domain();powp=d3_scale_powPow(exponent=x);powb=d3_scale_powPow(1/exponent);return scale.domain(domain)};scale.copy=function(){return d3_scale_pow(linear.copy(),exponent)};return d3_scale_linearRebind(scale,linear)}function d3_scale_powPow(e){return function(x){return x<0?-Math.pow(-x,e):Math.pow(x,e)}}function d3_scale_ordinal(domain,ranger){function scale(x){return range[((index.get(x)||index.set(x,domain.push(x)))-1)%range.length]}function steps(start,step){return d3.range(domain.length).map(function(i){return start+step*i})}var index,range,rangeBand;scale.domain=function(x){if(!arguments.length){return domain}domain=[];index=new d3_Map;var i=-1,n=x.length,xi;while(++i<n){if(!index.has(xi=x[i])){index.set(xi,domain.push(xi))}}return scale[ranger.t].apply(scale,ranger.a)};scale.range=function(x){if(!arguments.length){return range}range=x;rangeBand=0;ranger={t:"range",a:arguments};return scale};scale.rangePoints=function(x,padding){if(arguments.length<2){padding=0}var start=x[0],stop=x[1],step=(stop-start)/(Math.max(1,domain.length-1)+padding);range=steps(domain.length<2?(start+stop)/2:start+step*padding/2,step);rangeBand=0;ranger={t:"rangePoints",a:arguments};return scale};scale.rangeBands=function(x,padding,outerPadding){if(arguments.length<2){padding=0}if(arguments.length<3){outerPadding=padding}var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=(stop-start)/(domain.length-padding+2*outerPadding);range=steps(start+step*outerPadding,step);if(reverse){range.reverse()}rangeBand=step*(1-padding);ranger={t:"rangeBands",a:arguments};return scale};scale.rangeRoundBands=function(x,padding,outerPadding){if(arguments.length<2){padding=0}if(arguments.length<3){outerPadding=padding}var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=Math.floor((stop-start)/(domain.length-padding+2*outerPadding)),error=stop-start-(domain.length-padding)*step;range=steps(start+Math.round(error/2),step);if(reverse){range.reverse()}rangeBand=Math.round(step*(1-padding));ranger={t:"rangeRoundBands",a:arguments};return scale};scale.rangeBand=function(){return rangeBand};scale.rangeExtent=function(){return d3_scaleExtent(ranger.a[0])};scale.copy=function(){return d3_scale_ordinal(domain,ranger)};return scale.domain(domain)}function d3_scale_quantile(domain,range){function rescale(){var k=0,n=domain.length,q=range.length;thresholds=[];while(++k<q){thresholds[k-1]=d3.quantile(domain,k/q)}return scale}function scale(x){if(isNaN(x=+x)){return NaN}return range[d3.bisect(thresholds,x)]}var thresholds;scale.domain=function(x){if(!arguments.length){return domain}domain=x.filter(function(d){return !isNaN(d)}).sort(d3.ascending);return rescale()};scale.range=function(x){if(!arguments.length){return range}range=x;return rescale()};scale.quantiles=function(){return thresholds};scale.copy=function(){return d3_scale_quantile(domain,range)};return rescale()}function d3_scale_quantize(x0,x1,range){function scale(x){return range[Math.max(0,Math.min(i,Math.floor(kx*(x-x0))))]}function rescale(){kx=range.length/(x1-x0);i=range.length-1;return scale}var kx,i;scale.domain=function(x){if(!arguments.length){return[x0,x1]}x0=+x[0];x1=+x[x.length-1];return rescale()};scale.range=function(x){if(!arguments.length){return range}range=x;return rescale()};scale.copy=function(){return d3_scale_quantize(x0,x1,range)};return rescale()}function d3_scale_threshold(domain,range){function scale(x){return range[d3.bisect(domain,x)]}scale.domain=function(_){if(!arguments.length){return domain}domain=_;return scale};scale.range=function(_){if(!arguments.length){return range}range=_;return scale};scale.copy=function(){return d3_scale_threshold(domain,range)};return scale}function d3_scale_identity(domain){function identity(x){return +x}identity.invert=identity;identity.domain=identity.range=function(x){if(!arguments.length){return domain}domain=x.map(identity);return identity};identity.ticks=function(m){return d3_scale_linearTicks(domain,m)};identity.tickFormat=function(m){return d3_scale_linearTickFormat(domain,m)};identity.copy=function(){return d3_scale_identity(domain)};return identity}function d3_svg_arcInnerRadius(d){return d.innerRadius}function d3_svg_arcOuterRadius(d){return d.outerRadius}function d3_svg_arcStartAngle(d){return d.startAngle}function d3_svg_arcEndAngle(d){return d.endAngle}function d3_svg_line(projection){function line(data){function segment(){segments.push("M",interpolate(projection(points),tension))}var segments=[],points=[],i=-1,n=data.length,d,fx=d3_functor(x),fy=d3_functor(y);while(++i<n){if(defined.call(this,d=data[i],i)){points.push([+fx.call(this,d,i),+fy.call(this,d,i)])}else{if(points.length){segment();points=[]}}}if(points.length){segment()}return segments.length?segments.join(""):null}var x=d3_svg_lineX,y=d3_svg_lineY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,tension=0.7;line.x=function(_){if(!arguments.length){return x}x=_;return line};line.y=function(_){if(!arguments.length){return y}y=_;return line};line.defined=function(_){if(!arguments.length){return defined}defined=_;return line};line.interpolate=function(_){if(!arguments.length){return interpolateKey}if(typeof _==="function"){interpolateKey=interpolate=_}else{interpolateKey=(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key}return line};line.tension=function(_){if(!arguments.length){return tension}tension=_;return line};return line}function d3_svg_lineX(d){return d[0]}function d3_svg_lineY(d){return d[1]}function d3_svg_lineLinear(points){return points.join("L")}function d3_svg_lineLinearClosed(points){return d3_svg_lineLinear(points)+"Z"}function d3_svg_lineStepBefore(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];while(++i<n){path.push("V",(p=points[i])[1],"H",p[0])}return path.join("")}function d3_svg_lineStepAfter(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];while(++i<n){path.push("H",(p=points[i])[0],"V",p[1])}return path.join("")}function d3_svg_lineCardinalOpen(points,tension){return points.length<4?d3_svg_lineLinear(points):points[1]+d3_svg_lineHermite(points.slice(1,points.length-1),d3_svg_lineCardinalTangents(points,tension))}function d3_svg_lineCardinalClosed(points,tension){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite((points.push(points[0]),points),d3_svg_lineCardinalTangents([points[points.length-2]].concat(points,[points[1]]),tension))}function d3_svg_lineCardinal(points,tension,closed){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineCardinalTangents(points,tension))}function d3_svg_lineHermite(points,tangents){if(tangents.length<1||points.length!=tangents.length&&points.length!=tangents.length+2){return d3_svg_lineLinear(points)}var quad=points.length!=tangents.length,path="",p0=points[0],p=points[1],t0=tangents[0],t=t0,pi=1;if(quad){path+="Q"+(p[0]-t0[0]*2/3)+","+(p[1]-t0[1]*2/3)+","+p[0]+","+p[1];p0=points[1];pi=2}if(tangents.length>1){t=tangents[1];p=points[pi];pi++;path+="C"+(p0[0]+t0[0])+","+(p0[1]+t0[1])+","+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1];for(var i=2;i<tangents.length;i++,pi++){p=points[pi];t=tangents[i];path+="S"+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1]}}if(quad){var lp=points[pi];path+="Q"+(p[0]+t[0]*2/3)+","+(p[1]+t[1]*2/3)+","+lp[0]+","+lp[1]}return path}function d3_svg_lineCardinalTangents(points,tension){var tangents=[],a=(1-tension)/2,p0,p1=points[0],p2=points[1],i=1,n=points.length;while(++i<n){p0=p1;p1=p2;p2=points[i];tangents.push([a*(p2[0]-p0[0]),a*(p2[1]-p0[1])])}return tangents}function d3_svg_lineBasis(points){if(points.length<3){return d3_svg_lineLinear(points)}var i=1,n=points.length,pi=points[0],x0=pi[0],y0=pi[1],px=[x0,x0,x0,(pi=points[1])[0]],py=[y0,y0,y0,pi[1]],path=[x0,",",y0];d3_svg_lineBasisBezier(path,px,py);while(++i<n){pi=points[i];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}i=-1;while(++i<2){px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}return path.join("")}function d3_svg_lineBasisOpen(points){if(points.length<4){return d3_svg_lineLinear(points)}var path=[],i=-1,n=points.length,pi,px=[0],py=[0];while(++i<3){pi=points[i];px.push(pi[0]);py.push(pi[1])}path.push(d3_svg_lineDot4(d3_svg_lineBasisBezier3,px)+","+d3_svg_lineDot4(d3_svg_lineBasisBezier3,py));--i;while(++i<n){pi=points[i];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}return path.join("")}function d3_svg_lineBasisClosed(points){var path,i=-1,n=points.length,m=n+4,pi,px=[],py=[];while(++i<4){pi=points[i%n];px.push(pi[0]);py.push(pi[1])}path=[d3_svg_lineDot4(d3_svg_lineBasisBezier3,px),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)];--i;while(++i<m){pi=points[i%n];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}return path.join("")}function d3_svg_lineBundle(points,tension){var n=points.length-1;if(n){var x0=points[0][0],y0=points[0][1],dx=points[n][0]-x0,dy=points[n][1]-y0,i=-1,p,t;while(++i<=n){p=points[i];t=i/n;p[0]=tension*p[0]+(1-tension)*(x0+t*dx);p[1]=tension*p[1]+(1-tension)*(y0+t*dy)}}return d3_svg_lineBasis(points)}function d3_svg_lineDot4(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}function d3_svg_lineBasisBezier(path,x,y){path.push("C",d3_svg_lineDot4(d3_svg_lineBasisBezier1,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier1,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,y))}function d3_svg_lineSlope(p0,p1){return(p1[1]-p0[1])/(p1[0]-p0[0])}function d3_svg_lineFiniteDifferences(points){var i=0,j=points.length-1,m=[],p0=points[0],p1=points[1],d=m[0]=d3_svg_lineSlope(p0,p1);while(++i<j){m[i]=(d+(d=d3_svg_lineSlope(p0=p1,p1=points[i+1])))/2}m[i]=d;return m}function d3_svg_lineMonotoneTangents(points){var tangents=[],d,a,b,s,m=d3_svg_lineFiniteDifferences(points),i=-1,j=points.length-1;while(++i<j){d=d3_svg_lineSlope(points[i],points[i+1]);if(Math.abs(d)<0.000001){m[i]=m[i+1]=0}else{a=m[i]/d;b=m[i+1]/d;s=a*a+b*b;if(s>9){s=d*3/Math.sqrt(s);m[i]=s*a;m[i+1]=s*b}}}i=-1;while(++i<=j){s=(points[Math.min(j,i+1)][0]-points[Math.max(0,i-1)][0])/(6*(1+m[i]*m[i]));tangents.push([s||0,m[i]*s||0])}return tangents}function d3_svg_lineMonotone(points){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineMonotoneTangents(points))}function d3_svg_lineRadial(points){var point,i=-1,n=points.length,r,a;while(++i<n){point=points[i];r=point[0];a=point[1]+d3_svg_arcOffset;point[0]=r*Math.cos(a);point[1]=r*Math.sin(a)}return points}function d3_svg_area(projection){function area(data){function segment(){segments.push("M",interpolate(projection(points1),tension),L,interpolateReverse(projection(points0.reverse()),tension),"Z")}var segments=[],points0=[],points1=[],i=-1,n=data.length,d,fx0=d3_functor(x0),fy0=d3_functor(y0),fx1=x0===x1?function(){return x}:d3_functor(x1),fy1=y0===y1?function(){return y}:d3_functor(y1),x,y;while(++i<n){if(defined.call(this,d=data[i],i)){points0.push([x=+fx0.call(this,d,i),y=+fy0.call(this,d,i)]);points1.push([+fx1.call(this,d,i),+fy1.call(this,d,i)])}else{if(points0.length){segment();points0=[];points1=[]}}}if(points0.length){segment()}return segments.length?segments.join(""):null}var x0=d3_svg_lineX,x1=d3_svg_lineX,y0=0,y1=d3_svg_lineY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,interpolateReverse=interpolate,L="L",tension=0.7;area.x=function(_){if(!arguments.length){return x1}x0=x1=_;return area};area.x0=function(_){if(!arguments.length){return x0}x0=_;return area};area.x1=function(_){if(!arguments.length){return x1}x1=_;return area};area.y=function(_){if(!arguments.length){return y1}y0=y1=_;return area};area.y0=function(_){if(!arguments.length){return y0}y0=_;return area};area.y1=function(_){if(!arguments.length){return y1}y1=_;return area};area.defined=function(_){if(!arguments.length){return defined}defined=_;return area};area.interpolate=function(_){if(!arguments.length){return interpolateKey}if(typeof _==="function"){interpolateKey=interpolate=_}else{interpolateKey=(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key}interpolateReverse=interpolate.reverse||interpolate;L=interpolate.closed?"M":"L";return area};area.tension=function(_){if(!arguments.length){return tension}tension=_;return area};return area}function d3_svg_chordSource(d){return d.source}function d3_svg_chordTarget(d){return d.target}function d3_svg_chordRadius(d){return d.radius}function d3_svg_chordStartAngle(d){return d.startAngle}function d3_svg_chordEndAngle(d){return d.endAngle}function d3_svg_diagonalProjection(d){return[d.x,d.y]}function d3_svg_diagonalRadialProjection(projection){return function(){var d=projection.apply(this,arguments),r=d[0],a=d[1]+d3_svg_arcOffset;return[r*Math.cos(a),r*Math.sin(a)]}}function d3_svg_symbolSize(){return 64}function d3_svg_symbolType(){return"circle"}function d3_svg_symbolCircle(size){var r=Math.sqrt(size/Math.PI);return"M0,"+r+"A"+r+","+r+" 0 1,1 0,"+-r+"A"+r+","+r+" 0 1,1 0,"+r+"Z"}function d3_svg_axisX(selection,x){selection.attr("transform",function(d){return"translate("+x(d)+",0)"})}function d3_svg_axisY(selection,y){selection.attr("transform",function(d){return"translate(0,"+y(d)+")"})}function d3_svg_axisSubdivide(scale,ticks,m){subticks=[];if(m&&ticks.length>1){var extent=d3_scaleExtent(scale.domain()),subticks,i=-1,n=ticks.length,d=(ticks[1]-ticks[0])/++m,j,v;while(++i<n){for(j=m;--j>0;){if((v=+ticks[i]-j*d)>=extent[0]){subticks.push(v)}}}for(--i,j=0;++j<m&&(v=+ticks[i]+j*d)<extent[1];){subticks.push(v)}}return subticks}function d3_behavior_zoomDelta(){if(!d3_behavior_zoomDiv){d3_behavior_zoomDiv=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode}var e=d3.event,delta;try{d3_behavior_zoomDiv.scrollTop=1000;d3_behavior_zoomDiv.dispatchEvent(e);delta=1000-d3_behavior_zoomDiv.scrollTop}catch(error){delta=e.wheelDelta||-e.detail*5}return delta}function d3_layout_bundlePath(link){var start=link.source,end=link.target,lca=d3_layout_bundleLeastCommonAncestor(start,end),points=[start];while(start!==lca){start=start.parent;points.push(start)}var k=points.length;while(end!==lca){points.splice(k,0,end);end=end.parent}return points}function d3_layout_bundleAncestors(node){var ancestors=[],parent=node.parent;while(parent!=null){ancestors.push(node);node=parent;parent=parent.parent}ancestors.push(node);return ancestors}function d3_layout_bundleLeastCommonAncestor(a,b){if(a===b){return a}var aNodes=d3_layout_bundleAncestors(a),bNodes=d3_layout_bundleAncestors(b),aNode=aNodes.pop(),bNode=bNodes.pop(),sharedNode=null;while(aNode===bNode){sharedNode=aNode;aNode=aNodes.pop();bNode=bNodes.pop()}return sharedNode}function d3_layout_forceDragstart(d){d.fixed|=2}function d3_layout_forceDragend(d){d.fixed&=1}function d3_layout_forceMouseover(d){d.fixed|=4}function d3_layout_forceMouseout(d){d.fixed&=3}function d3_layout_forceAccumulate(quad,alpha,charges){var cx=0,cy=0;quad.charge=0;if(!quad.leaf){var nodes=quad.nodes,n=nodes.length,i=-1,c;while(++i<n){c=nodes[i];if(c==null){continue}d3_layout_forceAccumulate(c,alpha,charges);quad.charge+=c.charge;cx+=c.charge*c.cx;cy+=c.charge*c.cy}}if(quad.point){if(!quad.leaf){quad.point.x+=Math.random()-0.5;quad.point.y+=Math.random()-0.5}var k=alpha*charges[quad.point.index];quad.charge+=quad.pointCharge=k;cx+=k*quad.point.x;cy+=k*quad.point.y}quad.cx=cx/quad.charge;quad.cy=cy/quad.charge}function d3_layout_forceLinkDistance(link){return 20}function d3_layout_forceLinkStrength(link){return 1}function d3_layout_stackX(d){return d.x}function d3_layout_stackY(d){return d.y}function d3_layout_stackOut(d,y0,y){d.y0=y0;d.y=y}function d3_layout_stackOrderDefault(data){return d3.range(data.length)}function d3_layout_stackOffsetZero(data){var j=-1,m=data[0].length,y0=[];while(++j<m){y0[j]=0}return y0}function d3_layout_stackMaxIndex(array){var i=1,j=0,v=array[0][1],k,n=array.length;for(;i<n;++i){if((k=array[i][1])>v){j=i;v=k}}return j}function d3_layout_stackReduceSum(d){return d.reduce(d3_layout_stackSum,0)}function d3_layout_stackSum(p,d){return p+d[1]}function d3_layout_histogramBinSturges(range,values){return d3_layout_histogramBinFixed(range,Math.ceil(Math.log(values.length)/Math.LN2+1))}function d3_layout_histogramBinFixed(range,n){var x=-1,b=+range[0],m=(range[1]-b)/n,f=[];while(++x<=n){f[x]=m*x+b}return f}function d3_layout_histogramRange(values){return[d3.min(values),d3.max(values)]}function d3_layout_hierarchyRebind(object,hierarchy){d3.rebind(object,hierarchy,"sort","children","value");object.links=d3_layout_hierarchyLinks;object.nodes=function(d){d3_layout_hierarchyInline=true;return(object.nodes=object)(d)};return object}function d3_layout_hierarchyChildren(d){return d.children}function d3_layout_hierarchyValue(d){return d.value}function d3_layout_hierarchySort(a,b){return b.value-a.value}function d3_layout_hierarchyLinks(nodes){return d3.merge(nodes.map(function(parent){return(parent.children||[]).map(function(child){return{source:parent,target:child}})}))}function d3_layout_packSort(a,b){return a.value-b.value}function d3_layout_packInsert(a,b){var c=a._pack_next;a._pack_next=b;b._pack_prev=a;b._pack_next=c;c._pack_prev=b}function d3_layout_packSplice(a,b){a._pack_next=b;b._pack_prev=a}function d3_layout_packIntersects(a,b){var dx=b.x-a.x,dy=b.y-a.y,dr=a.r+b.r;return dr*dr-dx*dx-dy*dy>0.001}function d3_layout_packSiblings(node){function bound(node){xMin=Math.min(node.x-node.r,xMin);xMax=Math.max(node.x+node.r,xMax);yMin=Math.min(node.y-node.r,yMin);yMax=Math.max(node.y+node.r,yMax)}if(!(nodes=node.children)||!(n=nodes.length)){return}var nodes,xMin=Infinity,xMax=-Infinity,yMin=Infinity,yMax=-Infinity,a,b,c,i,j,k,n;nodes.forEach(d3_layout_packLink);a=nodes[0];a.x=-a.r;a.y=0;bound(a);if(n>1){b=nodes[1];b.x=b.r;b.y=0;bound(b);if(n>2){c=nodes[2];d3_layout_packPlace(a,b,c);bound(c);d3_layout_packInsert(a,c);a._pack_prev=c;d3_layout_packInsert(c,b);b=a._pack_next;for(i=3;i<n;i++){d3_layout_packPlace(a,b,c=nodes[i]);var isect=0,s1=1,s2=1;for(j=b._pack_next;j!==b;j=j._pack_next,s1++){if(d3_layout_packIntersects(j,c)){isect=1;break}}if(isect==1){for(k=a._pack_prev;k!==j._pack_prev;k=k._pack_prev,s2++){if(d3_layout_packIntersects(k,c)){break}}}if(isect){if(s1<s2||s1==s2&&b.r<a.r){d3_layout_packSplice(a,b=j)}else{d3_layout_packSplice(a=k,b)}i--}else{d3_layout_packInsert(a,c);b=c;bound(c)}}}}var cx=(xMin+xMax)/2,cy=(yMin+yMax)/2,cr=0;for(i=0;i<n;i++){c=nodes[i];c.x-=cx;c.y-=cy;cr=Math.max(cr,c.r+Math.sqrt(c.x*c.x+c.y*c.y))}node.r=cr;nodes.forEach(d3_layout_packUnlink)}function d3_layout_packLink(node){node._pack_next=node._pack_prev=node}function d3_layout_packUnlink(node){delete node._pack_next;delete node._pack_prev}function d3_layout_packTransform(node,x,y,k){var children=node.children;node.x=x+=k*node.x;node.y=y+=k*node.y;node.r*=k;if(children){var i=-1,n=children.length;while(++i<n){d3_layout_packTransform(children[i],x,y,k)}}}function d3_layout_packPlace(a,b,c){var db=a.r+c.r,dx=b.x-a.x,dy=b.y-a.y;if(db&&(dx||dy)){var da=b.r+c.r,dc=dx*dx+dy*dy;da*=da;db*=db;var x=0.5+(db-da)/(2*dc),y=Math.sqrt(Math.max(0,2*da*(db+dc)-(db-=dc)*db-da*da))/(2*dc);c.x=a.x+x*dx+y*dy;c.y=a.y+x*dy-y*dx}else{c.x=a.x+db;c.y=a.y}}function d3_layout_clusterY(children){return 1+d3.max(children,function(child){return child.y})}function d3_layout_clusterX(children){return children.reduce(function(x,child){return x+child.x},0)/children.length}function d3_layout_clusterLeft(node){var children=node.children;return children&&children.length?d3_layout_clusterLeft(children[0]):node}function d3_layout_clusterRight(node){var children=node.children,n;return children&&(n=children.length)?d3_layout_clusterRight(children[n-1]):node}function d3_layout_treeSeparation(a,b){return a.parent==b.parent?1:2}function d3_layout_treeLeft(node){var children=node.children;return children&&children.length?children[0]:node._tree.thread}function d3_layout_treeRight(node){var children=node.children,n;return children&&(n=children.length)?children[n-1]:node._tree.thread}function d3_layout_treeSearch(node,compare){var children=node.children;if(children&&(n=children.length)){var child,n,i=-1;while(++i<n){if(compare(child=d3_layout_treeSearch(children[i],compare),node)>0){node=child}}}return node}function d3_layout_treeRightmost(a,b){return a.x-b.x}function d3_layout_treeLeftmost(a,b){return b.x-a.x}function d3_layout_treeDeepest(a,b){return a.depth-b.depth}function d3_layout_treeVisitAfter(node,callback){function visit(node,previousSibling){var children=node.children;if(children&&(n=children.length)){var child,previousChild=null,i=-1,n;while(++i<n){child=children[i];visit(child,previousChild);previousChild=child}}callback(node,previousSibling)}visit(node,null)}function d3_layout_treeShift(node){var shift=0,change=0,children=node.children,i=children.length,child;while(--i>=0){child=children[i]._tree;child.prelim+=shift;child.mod+=shift;shift+=child.shift+(change+=child.change)}}function d3_layout_treeMove(ancestor,node,shift){ancestor=ancestor._tree;node=node._tree;var change=shift/(node.number-ancestor.number);ancestor.change+=change;node.change-=change;node.shift+=shift;node.prelim+=shift;node.mod+=shift}function d3_layout_treeAncestor(vim,node,ancestor){return vim._tree.ancestor.parent==node.parent?vim._tree.ancestor:ancestor}function d3_layout_treemapPadNull(node){return{x:node.x,y:node.y,dx:node.dx,dy:node.dy}}function d3_layout_treemapPad(node,padding){var x=node.x+padding[3],y=node.y+padding[0],dx=node.dx-padding[1]-padding[3],dy=node.dy-padding[0]-padding[2];if(dx<0){x+=dx/2;dx=0}if(dy<0){y+=dy/2;dy=0}return{x:x,y:y,dx:dx,dy:dy}}function d3_dsv(delimiter,mimeType){function dsv(url,callback){d3.text(url,mimeType,function(text){callback(text&&dsv.parse(text))})}function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(text){return reFormat.test(text)?'"'+text.replace(/\"/g,'""')+'"':text}var reParse=new RegExp("\r\n|["+delimiter+"\r\n]","g"),reFormat=new RegExp('["'+delimiter+"\n]"),delimiterCode=delimiter.charCodeAt(0);dsv.parse=function(text){var header;return dsv.parseRows(text,function(row,i){if(i){var o={},j=-1,m=header.length;while(++j<m){o[header[j]]=row[j]}return o}else{header=row;return null}})};dsv.parseRows=function(text,f){function token(){if(reParse.lastIndex>=text.length){return EOF}if(eol){eol=false;return EOL}var j=reParse.lastIndex;if(text.charCodeAt(j)===34){var i=j;while(i++<text.length){if(text.charCodeAt(i)===34){if(text.charCodeAt(i+1)!==34){break}i++}}reParse.lastIndex=i+2;var c=text.charCodeAt(i+1);if(c===13){eol=true;if(text.charCodeAt(i+2)===10){reParse.lastIndex++}}else{if(c===10){eol=true}}return text.substring(j+1,i).replace(/""/g,'"')}var m=reParse.exec(text);if(m){eol=m[0].charCodeAt(0)!==delimiterCode;return text.substring(j,m.index)}reParse.lastIndex=text.length;return text.substring(j)}var EOL={},EOF={},rows=[],n=0,t,eol;reParse.lastIndex=0;while((t=token())!==EOF){var a=[];while(t!==EOL&&t!==EOF){a.push(t);t=token()}if(f&&!(a=f(a,n++))){continue}rows.push(a)}return rows};dsv.format=function(rows){return rows.map(formatRow).join("\n")};return dsv}function d3_geo_type(types,defaultValue){return function(object){return object&&types.hasOwnProperty(object.type)?types[object.type](object):defaultValue}}function d3_path_circle(radius){return"m0,"+radius+"a"+radius+","+radius+" 0 1,1 0,"+-2*radius+"a"+radius+","+radius+" 0 1,1 0,"+ +2*radius+"z"}function d3_geo_bounds(o,f){if(d3_geo_boundsTypes.hasOwnProperty(o.type)){d3_geo_boundsTypes[o.type](o,f)}}function d3_geo_boundsFeature(o,f){d3_geo_bounds(o.geometry,f)}function d3_geo_boundsFeatureCollection(o,f){for(var a=o.features,i=0,n=a.length;i<n;i++){d3_geo_bounds(a[i].geometry,f)}}function d3_geo_boundsGeometryCollection(o,f){for(var a=o.geometries,i=0,n=a.length;i<n;i++){d3_geo_bounds(a[i],f)}}function d3_geo_boundsLineString(o,f){for(var a=o.coordinates,i=0,n=a.length;i<n;i++){f.apply(null,a[i])}}function d3_geo_boundsMultiLineString(o,f){for(var a=o.coordinates,i=0,n=a.length;i<n;i++){for(var b=a[i],j=0,m=b.length;j<m;j++){f.apply(null,b[j])}}}function d3_geo_boundsMultiPolygon(o,f){for(var a=o.coordinates,i=0,n=a.length;i<n;i++){for(var b=a[i][0],j=0,m=b.length;j<m;j++){f.apply(null,b[j])}}}function d3_geo_boundsPoint(o,f){f.apply(null,o.coordinates)}function d3_geo_boundsPolygon(o,f){for(var a=o.coordinates[0],i=0,n=a.length;i<n;i++){f.apply(null,a[i])}}function d3_geo_greatArcSource(d){return d.source}function d3_geo_greatArcTarget(d){return d.target}function d3_geo_greatArcInterpolator(){function interpolate(t){var B=Math.sin(t*=d)*k,A=Math.sin(d-t)*k,x=A*kx0+B*kx1,y=A*ky0+B*ky1,z=A*sy0+B*sy1;return[Math.atan2(y,x)/d3_geo_radians,Math.atan2(z,Math.sqrt(x*x+y*y))/d3_geo_radians]}var x0,y0,cy0,sy0,kx0,ky0,x1,y1,cy1,sy1,kx1,ky1,d,k;interpolate.distance=function(){if(d==null){k=1/Math.sin(d=Math.acos(Math.max(-1,Math.min(1,sy0*sy1+cy0*cy1*Math.cos(x1-x0)))))}return d};interpolate.source=function(_){var cx0=Math.cos(x0=_[0]*d3_geo_radians),sx0=Math.sin(x0);cy0=Math.cos(y0=_[1]*d3_geo_radians);sy0=Math.sin(y0);kx0=cy0*cx0;ky0=cy0*sx0;d=null;return interpolate};interpolate.target=function(_){var cx1=Math.cos(x1=_[0]*d3_geo_radians),sx1=Math.sin(x1);cy1=Math.cos(y1=_[1]*d3_geo_radians);sy1=Math.sin(y1);kx1=cy1*cx1;ky1=cy1*sx1;d=null;return interpolate};return interpolate}function d3_geo_greatArcInterpolate(a,b){var i=d3_geo_greatArcInterpolator().source(a).target(b);i.distance();return i}function d3_geom_contourStart(grid){var x=0,y=0;while(true){if(grid(x,y)){return[x,y]}if(x===0){x=y+1;y=0}else{x=x-1;y=y+1}}}function d3_geom_hullCCW(i1,i2,i3,v){var t,a,b,c,d,e,f;t=v[i1];a=t[0];b=t[1];t=v[i2];c=t[0];d=t[1];t=v[i3];e=t[0];f=t[1];return(f-b)*(c-a)-(d-b)*(e-a)>0}function d3_geom_polygonInside(p,a,b){return(b[0]-a[0])*(p[1]-a[1])<(b[1]-a[1])*(p[0]-a[0])}function d3_geom_polygonIntersect(c,d,a,b){var x1=c[0],x2=d[0],x3=a[0],x4=b[0],y1=c[1],y2=d[1],y3=a[1],y4=b[1],x13=x1-x3,x21=x2-x1,x43=x4-x3,y13=y1-y3,y21=y2-y1,y43=y4-y3,ua=(x43*y13-y43*x13)/(y43*x21-x43*y21);return[x1+ua*x21,y1+ua*y21]}function d3_voronoi_tessellate(vertices,callback){var Sites={list:vertices.map(function(v,i){return{index:i,x:v[0],y:v[1]}}).sort(function(a,b){return a.y<b.y?-1:a.y>b.y?1:a.x<b.x?-1:a.x>b.x?1:0}),bottomSite:null};var EdgeList={list:[],leftEnd:null,rightEnd:null,init:function(){EdgeList.leftEnd=EdgeList.createHalfEdge(null,"l");EdgeList.rightEnd=EdgeList.createHalfEdge(null,"l");EdgeList.leftEnd.r=EdgeList.rightEnd;EdgeList.rightEnd.l=EdgeList.leftEnd;EdgeList.list.unshift(EdgeList.leftEnd,EdgeList.rightEnd)},createHalfEdge:function(edge,side){return{edge:edge,side:side,vertex:null,l:null,r:null}},insert:function(lb,he){he.l=lb;he.r=lb.r;lb.r.l=he;lb.r=he},leftBound:function(p){var he=EdgeList.leftEnd;do{he=he.r}while(he!=EdgeList.rightEnd&&Geom.rightOf(he,p));he=he.l;return he},del:function(he){he.l.r=he.r;he.r.l=he.l;he.edge=null},right:function(he){return he.r},left:function(he){return he.l},leftRegion:function(he){return he.edge==null?Sites.bottomSite:he.edge.region[he.side]},rightRegion:function(he){return he.edge==null?Sites.bottomSite:he.edge.region[d3_voronoi_opposite[he.side]]}};var Geom={bisect:function(s1,s2){var newEdge={region:{l:s1,r:s2},ep:{l:null,r:null}};var dx=s2.x-s1.x,dy=s2.y-s1.y,adx=dx>0?dx:-dx,ady=dy>0?dy:-dy;newEdge.c=s1.x*dx+s1.y*dy+(dx*dx+dy*dy)*0.5;if(adx>ady){newEdge.a=1;newEdge.b=dy/dx;newEdge.c/=dx}else{newEdge.b=1;newEdge.a=dx/dy;newEdge.c/=dy}return newEdge},intersect:function(el1,el2){var e1=el1.edge,e2=el2.edge;if(!e1||!e2||e1.region.r==e2.region.r){return null}var d=e1.a*e2.b-e1.b*e2.a;if(Math.abs(d)<1e-10){return null}var xint=(e1.c*e2.b-e2.c*e1.b)/d,yint=(e2.c*e1.a-e1.c*e2.a)/d,e1r=e1.region.r,e2r=e2.region.r,el,e;if(e1r.y<e2r.y||e1r.y==e2r.y&&e1r.x<e2r.x){el=el1;e=e1}else{el=el2;e=e2}var rightOfSite=xint>=e.region.r.x;if(rightOfSite&&el.side==="l"||!rightOfSite&&el.side==="r"){return null}return{x:xint,y:yint}},rightOf:function(he,p){var e=he.edge,topsite=e.region.r,rightOfSite=p.x>topsite.x;if(rightOfSite&&he.side==="l"){return 1}if(!rightOfSite&&he.side==="r"){return 0}if(e.a===1){var dyp=p.y-topsite.y,dxp=p.x-topsite.x,fast=0,above=0;if(!rightOfSite&&e.b<0||rightOfSite&&e.b>=0){above=fast=dyp>=e.b*dxp}else{above=p.x+p.y*e.b>e.c;if(e.b<0){above=!above}if(!above){fast=1}}if(!fast){var dxs=topsite.x-e.region.l.x;above=e.b*(dxp*dxp-dyp*dyp)<dxs*dyp*(1+2*dxp/dxs+e.b*e.b);if(e.b<0){above=!above}}}else{var yl=e.c-e.a*p.x,t1=p.y-yl,t2=p.x-topsite.x,t3=yl-topsite.y;above=t1*t1>t2*t2+t3*t3}return he.side==="l"?above:!above},endPoint:function(edge,side,site){edge.ep[side]=site;if(!edge.ep[d3_voronoi_opposite[side]]){return}callback(edge)},distance:function(s,t){var dx=s.x-t.x,dy=s.y-t.y;return Math.sqrt(dx*dx+dy*dy)}};var EventQueue={list:[],insert:function(he,site,offset){he.vertex=site;he.ystar=site.y+offset;for(var i=0,list=EventQueue.list,l=list.length;i<l;i++){var next=list[i];if(he.ystar>next.ystar||he.ystar==next.ystar&&site.x>next.vertex.x){continue}else{break}}list.splice(i,0,he)},del:function(he){for(var i=0,ls=EventQueue.list,l=ls.length;i<l&&ls[i]!=he;++i){}ls.splice(i,1)},empty:function(){return EventQueue.list.length===0},nextEvent:function(he){for(var i=0,ls=EventQueue.list,l=ls.length;i<l;++i){if(ls[i]==he){return ls[i+1]}}return null},min:function(){var elem=EventQueue.list[0];return{x:elem.vertex.x,y:elem.ystar}},extractMin:function(){return EventQueue.list.shift()}};EdgeList.init();Sites.bottomSite=Sites.list.shift();var newSite=Sites.list.shift(),newIntStar;var lbnd,rbnd,llbnd,rrbnd,bisector;var bot,top,temp,p,v;var e,pm;while(true){if(!EventQueue.empty()){newIntStar=EventQueue.min()}if(newSite&&(EventQueue.empty()||newSite.y<newIntStar.y||newSite.y==newIntStar.y&&newSite.x<newIntStar.x)){lbnd=EdgeList.leftBound(newSite);rbnd=EdgeList.right(lbnd);bot=EdgeList.rightRegion(lbnd);e=Geom.bisect(bot,newSite);bisector=EdgeList.createHalfEdge(e,"l");EdgeList.insert(lbnd,bisector);p=Geom.intersect(lbnd,bisector);if(p){EventQueue.del(lbnd);EventQueue.insert(lbnd,p,Geom.distance(p,newSite))}lbnd=bisector;bisector=EdgeList.createHalfEdge(e,"r");EdgeList.insert(lbnd,bisector);p=Geom.intersect(bisector,rbnd);if(p){EventQueue.insert(bisector,p,Geom.distance(p,newSite))}newSite=Sites.list.shift()}else{if(!EventQueue.empty()){lbnd=EventQueue.extractMin();llbnd=EdgeList.left(lbnd);rbnd=EdgeList.right(lbnd);rrbnd=EdgeList.right(rbnd);bot=EdgeList.leftRegion(lbnd);top=EdgeList.rightRegion(rbnd);v=lbnd.vertex;Geom.endPoint(lbnd.edge,lbnd.side,v);Geom.endPoint(rbnd.edge,rbnd.side,v);EdgeList.del(lbnd);EventQueue.del(rbnd);EdgeList.del(rbnd);pm="l";if(bot.y>top.y){temp=bot;bot=top;top=temp;pm="r"}e=Geom.bisect(bot,top);bisector=EdgeList.createHalfEdge(e,pm);EdgeList.insert(llbnd,bisector);Geom.endPoint(e,d3_voronoi_opposite[pm],v);p=Geom.intersect(llbnd,bisector);if(p){EventQueue.del(llbnd);EventQueue.insert(llbnd,p,Geom.distance(p,bot))}p=Geom.intersect(bisector,rrbnd);if(p){EventQueue.insert(bisector,p,Geom.distance(p,bot))}}else{break}}}for(lbnd=EdgeList.right(EdgeList.leftEnd);lbnd!=EdgeList.rightEnd;lbnd=EdgeList.right(lbnd)){callback(lbnd.edge)}}function d3_geom_quadtreeNode(){return{leaf:true,nodes:[],point:null}}function d3_geom_quadtreeVisit(f,node,x1,y1,x2,y2){if(!f(node,x1,y1,x2,y2)){var sx=(x1+x2)*0.5,sy=(y1+y2)*0.5,children=node.nodes;if(children[0]){d3_geom_quadtreeVisit(f,children[0],x1,y1,sx,sy)}if(children[1]){d3_geom_quadtreeVisit(f,children[1],sx,y1,x2,sy)}if(children[2]){d3_geom_quadtreeVisit(f,children[2],x1,sy,sx,y2)}if(children[3]){d3_geom_quadtreeVisit(f,children[3],sx,sy,x2,y2)}}}function d3_geom_quadtreePoint(p){return{x:p[0],y:p[1]}}function d3_time_utc(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function d3_time_formatAbbreviate(name){return name.substring(0,3)}function d3_time_parse(date,template,string,j){var c,p,i=0,n=template.length,m=string.length;while(i<n){if(j>=m){return -1}c=template.charCodeAt(i++);if(c==37){p=d3_time_parsers[template.charAt(i++)];if(!p||(j=p(date,string,j))<0){return -1}}else{if(c!=string.charCodeAt(j++)){return -1}}}return j}function d3_time_formatRe(names){return new RegExp("^(?:"+names.map(d3.requote).join("|")+")","i")}function d3_time_formatLookup(names){var map=new d3_Map,i=-1,n=names.length;while(++i<n){map.set(names[i].toLowerCase(),i)}return map}function d3_time_parseWeekdayAbbrev(date,string,i){d3_time_dayAbbrevRe.lastIndex=0;var n=d3_time_dayAbbrevRe.exec(string.substring(i));return n?i+=n[0].length:-1}function d3_time_parseWeekday(date,string,i){d3_time_dayRe.lastIndex=0;var n=d3_time_dayRe.exec(string.substring(i));return n?i+=n[0].length:-1}function d3_time_parseMonthAbbrev(date,string,i){d3_time_monthAbbrevRe.lastIndex=0;var n=d3_time_monthAbbrevRe.exec(string.substring(i));return n?(date.m=d3_time_monthAbbrevLookup.get(n[0].toLowerCase()),i+=n[0].length):-1}function d3_time_parseMonth(date,string,i){d3_time_monthRe.lastIndex=0;var n=d3_time_monthRe.exec(string.substring(i));return n?(date.m=d3_time_monthLookup.get(n[0].toLowerCase()),i+=n[0].length):-1}function d3_time_parseLocaleFull(date,string,i){return d3_time_parse(date,d3_time_formats.c.toString(),string,i)}function d3_time_parseLocaleDate(date,string,i){return d3_time_parse(date,d3_time_formats.x.toString(),string,i)}function d3_time_parseLocaleTime(date,string,i){return d3_time_parse(date,d3_time_formats.X.toString(),string,i)}function d3_time_parseFullYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+4));return n?(date.y=+n[0],i+=n[0].length):-1}function d3_time_parseYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.y=d3_time_expandYear(+n[0]),i+=n[0].length):-1}function d3_time_expandYear(d){return d+(d>68?1900:2000)}function d3_time_parseMonthNumber(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.m=n[0]-1,i+=n[0].length):-1}function d3_time_parseDay(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.d=+n[0],i+=n[0].length):-1}function d3_time_parseHour24(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.H=+n[0],i+=n[0].length):-1}function d3_time_parseMinutes(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.M=+n[0],i+=n[0].length):-1}function d3_time_parseSeconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.S=+n[0],i+=n[0].length):-1}function d3_time_parseMilliseconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+3));return n?(date.L=+n[0],i+=n[0].length):-1}function d3_time_parseAmPm(date,string,i){var n=d3_time_amPmLookup.get(string.substring(i,i+=2).toLowerCase());return n==null?-1:(date.p=n,i)}function d3_time_zone(d){var z=d.getTimezoneOffset(),zs=z>0?"-":"+",zh=~~(Math.abs(z)/60),zm=Math.abs(z)%60;return zs+d3_time_zfill2(zh)+d3_time_zfill2(zm)}function d3_time_formatIsoNative(date){return date.toISOString()}function d3_time_interval(local,step,number){function round(date){var d0=local(date),d1=offset(d0,1);return date-d0<d1-date?d0:d1}function ceil(date){step(date=local(new d3_time(date-1)),1);return date}function offset(date,k){step(date=new d3_time(+date),k);return date}function range(t0,t1,dt){var time=ceil(t0),times=[];if(dt>1){while(time<t1){if(!(number(time)%dt)){times.push(new Date(+time))}step(time,1)}}else{while(time<t1){times.push(new Date(+time)),step(time,1)}}return times}function range_utc(t0,t1,dt){try{d3_time=d3_time_utc;var utc=new d3_time_utc;utc._=t0;return range(utc,t1,dt)}finally{d3_time=Date}}local.floor=local;local.round=round;local.ceil=ceil;local.offset=offset;local.range=range;var utc=local.utc=d3_time_interval_utc(local);utc.floor=utc;utc.round=d3_time_interval_utc(round);utc.ceil=d3_time_interval_utc(ceil);utc.offset=d3_time_interval_utc(offset);utc.range=range_utc;return local}function d3_time_interval_utc(method){return function(date,k){try{d3_time=d3_time_utc;var utc=new d3_time_utc;utc._=date;return method(utc,k)._}finally{d3_time=Date}}}function d3_time_scale(linear,methods,format){function scale(x){return linear(x)}scale.invert=function(x){return d3_time_scaleDate(linear.invert(x))};scale.domain=function(x){if(!arguments.length){return linear.domain().map(d3_time_scaleDate)}linear.domain(x);return scale};scale.nice=function(m){return scale.domain(d3_scale_nice(scale.domain(),function(){return m}))};scale.ticks=function(m,k){var extent=d3_time_scaleExtent(scale.domain());if(typeof m!=="function"){var span=extent[1]-extent[0],target=span/m,i=d3.bisect(d3_time_scaleSteps,target);if(i==d3_time_scaleSteps.length){return methods.year(extent,m)}if(!i){return linear.ticks(m).map(d3_time_scaleDate)}if(Math.log(target/d3_time_scaleSteps[i-1])<Math.log(d3_time_scaleSteps[i]/target)){--i}m=methods[i];k=m[1];m=m[0].range}return m(extent[0],new Date(+extent[1]+1),k)};scale.tickFormat=function(){return format};scale.copy=function(){return d3_time_scale(linear.copy(),methods,format)};return d3.rebind(scale,linear,"range","rangeRound","interpolate","clamp")}function d3_time_scaleExtent(domain){var start=domain[0],stop=domain[domain.length-1];return start<stop?[start,stop]:[stop,start]}function d3_time_scaleDate(t){return new Date(t)}function d3_time_scaleFormat(formats){return function(date){var i=formats.length-1,f=formats[i];while(!f[1](date)){f=formats[--i]}return f[0](date)}}function d3_time_scaleSetYear(y){var d=new Date(y,0,1);d.setFullYear(y);return d}function d3_time_scaleGetYear(d){var y=d.getFullYear(),d0=d3_time_scaleSetYear(y),d1=d3_time_scaleSetYear(y+1);return y+(d-d0)/(d1-d0)}function d3_time_scaleUTCSetYear(y){var d=new Date(Date.UTC(y,0,1));d.setUTCFullYear(y);return d}function d3_time_scaleUTCGetYear(d){var y=d.getUTCFullYear(),d0=d3_time_scaleUTCSetYear(y),d1=d3_time_scaleUTCSetYear(y+1);return y+(d-d0)/(d1-d0)}if(!Date.now){Date.now=function(){return +(new Date)}}try{document.createElement("div").style.setProperty("opacity",0,"")}catch(error){var d3_style_prototype=CSSStyleDeclaration.prototype,d3_style_setProperty=d3_style_prototype.setProperty;d3_style_prototype.setProperty=function(name,value,priority){d3_style_setProperty.call(this,name,value+"",priority)}}d3={version:"2.10.2"};var d3_array=d3_arraySlice;try{d3_array(document.documentElement.childNodes)[0].nodeType}catch(e){d3_array=d3_arrayCopy}var d3_arraySubclass=[].__proto__?function(array,prototype){array.__proto__=prototype}:function(array,prototype){for(var property in prototype){array[property]=prototype[property]}};d3.map=function(object){var map=new d3_Map;for(var key in object){map.set(key,object[key])}return map};d3_class(d3_Map,{has:function(key){return d3_map_prefix+key in this},get:function(key){return this[d3_map_prefix+key]},set:function(key,value){return this[d3_map_prefix+key]=value},remove:function(key){key=d3_map_prefix+key;return key in this&&delete this[key]},keys:function(){var keys=[];this.forEach(function(key){keys.push(key)});return keys},values:function(){var values=[];this.forEach(function(key,value){values.push(value)});return values},entries:function(){var entries=[];this.forEach(function(key,value){entries.push({key:key,value:value})});return entries},forEach:function(f){for(var key in this){if(key.charCodeAt(0)===d3_map_prefixCode){f.call(this,key.substring(1),this[key])}}}});var d3_map_prefix="\0",d3_map_prefixCode=d3_map_prefix.charCodeAt(0);d3.functor=d3_functor;d3.rebind=function(target,source){var i=1,n=arguments.length,method;while(++i<n){target[method=arguments[i]]=d3_rebind(target,source,source[method])}return target};d3.ascending=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN};d3.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN};d3.mean=function(array,f){var n=array.length,a,m=0,i=-1,j=0;if(arguments.length===1){while(++i<n){if(d3_number(a=array[i])){m+=(a-m)/++j}}}else{while(++i<n){if(d3_number(a=f.call(array,array[i],i))){m+=(a-m)/++j}}}return j?m:undefined};d3.median=function(array,f){if(arguments.length>1){array=array.map(f)}array=array.filter(d3_number);return array.length?d3.quantile(array.sort(d3.ascending),0.5):undefined};d3.min=function(array,f){var i=-1,n=array.length,a,b;if(arguments.length===1){while(++i<n&&((a=array[i])==null||a!=a)){a=undefined}while(++i<n){if((b=array[i])!=null&&a>b){a=b}}}else{while(++i<n&&((a=f.call(array,array[i],i))==null||a!=a)){a=undefined}while(++i<n){if((b=f.call(array,array[i],i))!=null&&a>b){a=b}}}return a};d3.max=function(array,f){var i=-1,n=array.length,a,b;if(arguments.length===1){while(++i<n&&((a=array[i])==null||a!=a)){a=undefined}while(++i<n){if((b=array[i])!=null&&b>a){a=b}}}else{while(++i<n&&((a=f.call(array,array[i],i))==null||a!=a)){a=undefined}while(++i<n){if((b=f.call(array,array[i],i))!=null&&b>a){a=b}}}return a};d3.extent=function(array,f){var i=-1,n=array.length,a,b,c;if(arguments.length===1){while(++i<n&&((a=c=array[i])==null||a!=a)){a=c=undefined}while(++i<n){if((b=array[i])!=null){if(a>b){a=b}if(c<b){c=b}}}}else{while(++i<n&&((a=c=f.call(array,array[i],i))==null||a!=a)){a=undefined}while(++i<n){if((b=f.call(array,array[i],i))!=null){if(a>b){a=b}if(c<b){c=b}}}}return[a,c]};d3.random={normal:function(µ,σ){var n=arguments.length;if(n<2){σ=1}if(n<1){µ=0}return function(){var x,y,r;do{x=Math.random()*2-1;y=Math.random()*2-1;r=x*x+y*y}while(!r||r>1);return µ+σ*x*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(µ,σ){var n=arguments.length;if(n<2){σ=1}if(n<1){µ=0}var random=d3.random.normal();return function(){return Math.exp(µ+σ*random())}},irwinHall:function(m){return function(){for(var s=0,j=0;j<m;j++){s+=Math.random()}return s/m}}};d3.sum=function(array,f){var s=0,n=array.length,a,i=-1;if(arguments.length===1){while(++i<n){if(!isNaN(a=+array[i])){s+=a}}}else{while(++i<n){if(!isNaN(a=+f.call(array,array[i],i))){s+=a}}}return s};d3.quantile=function(values,p){var H=(values.length-1)*p+1,h=Math.floor(H),v=values[h-1],e=H-h;return e?v+e*(values[h]-v):v};d3.transpose=function(matrix){return d3.zip.apply(d3,matrix)};d3.zip=function(){if(!(n=arguments.length)){return[]}for(var i=-1,m=d3.min(arguments,d3_zipLength),zips=new Array(m);++i<m;){for(var j=-1,n,zip=zips[i]=new Array(n);++j<n;){zip[j]=arguments[j][i]}}return zips};d3.bisector=function(f){return{left:function(a,x,lo,hi){if(arguments.length<3){lo=0}if(arguments.length<4){hi=a.length}while(lo<hi){var mid=lo+hi>>>1;if(f.call(a,a[mid],mid)<x){lo=mid+1}else{hi=mid}}return lo},right:function(a,x,lo,hi){if(arguments.length<3){lo=0}if(arguments.length<4){hi=a.length}while(lo<hi){var mid=lo+hi>>>1;if(x<f.call(a,a[mid],mid)){hi=mid}else{lo=mid+1}}return lo}}};var d3_bisector=d3.bisector(function(d){return d});d3.bisectLeft=d3_bisector.left;d3.bisect=d3.bisectRight=d3_bisector.right;d3.first=function(array,f){var i=0,n=array.length,a=array[0],b;if(arguments.length===1){f=d3.ascending}while(++i<n){if(f.call(array,a,b=array[i])>0){a=b}}return a};d3.last=function(array,f){var i=0,n=array.length,a=array[0],b;if(arguments.length===1){f=d3.ascending}while(++i<n){if(f.call(array,a,b=array[i])<=0){a=b}}return a};d3.nest=function(){function map(array,depth){if(depth>=keys.length){return rollup?rollup.call(nest,array):sortValues?array.sort(sortValues):array}var i=-1,n=array.length,key=keys[depth++],keyValue,object,valuesByKey=new d3_Map,values,o={};while(++i<n){if(values=valuesByKey.get(keyValue=key(object=array[i]))){values.push(object)}else{valuesByKey.set(keyValue,[object])}}valuesByKey.forEach(function(keyValue,values){o[keyValue]=map(values,depth)});return o}function entries(map,depth){if(depth>=keys.length){return map}var a=[],sortKey=sortKeys[depth++],key;for(key in map){a.push({key:key,values:entries(map[key],depth)})}if(sortKey){a.sort(function(a,b){return sortKey(a.key,b.key)})}return a}var nest={},keys=[],sortKeys=[],sortValues,rollup;nest.map=function(array){return map(array,0)};nest.entries=function(array){return entries(map(array,0),0)};nest.key=function(d){keys.push(d);return nest};nest.sortKeys=function(order){sortKeys[keys.length-1]=order;return nest};nest.sortValues=function(order){sortValues=order;return nest};nest.rollup=function(f){rollup=f;return nest};return nest};d3.keys=function(map){var keys=[];for(var key in map){keys.push(key)}return keys};d3.values=function(map){var values=[];for(var key in map){values.push(map[key])}return values};d3.entries=function(map){var entries=[];for(var key in map){entries.push({key:key,value:map[key]})}return entries};d3.permute=function(array,indexes){var permutes=[],i=-1,n=indexes.length;while(++i<n){permutes[i]=array[indexes[i]]}return permutes};d3.merge=function(arrays){return Array.prototype.concat.apply([],arrays)};d3.split=function(array,f){var arrays=[],values=[],value,i=-1,n=array.length;if(arguments.length<2){f=d3_splitter}while(++i<n){if(f.call(values,value=array[i],i)){values=[]}else{if(!values.length){arrays.push(values)}values.push(value)}}return arrays};d3.range=function(start,stop,step){if(arguments.length<3){step=1;if(arguments.length<2){stop=start;start=0}}if((stop-start)/step===Infinity){throw new Error("infinite range")}var range=[],k=d3_range_integerScale(Math.abs(step)),i=-1,j;start*=k,stop*=k,step*=k;if(step<0){while((j=start+step*++i)>stop){range.push(j/k)}}else{while((j=start+step*++i)<stop){range.push(j/k)}}return range};d3.requote=function(s){return s.replace(d3_requote_re,"\\$&")};var d3_requote_re=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(x,n){return n?Math.round(x*(n=Math.pow(10,n)))/n:Math.round(x)};d3.xhr=function(url,mime,callback){var req=new XMLHttpRequest;if(arguments.length<3){callback=mime,mime=null}else{if(mime&&req.overrideMimeType){req.overrideMimeType(mime)}}req.open("GET",url,true);if(mime){req.setRequestHeader("Accept",mime)}req.onreadystatechange=function(){if(req.readyState===4){var s=req.status;callback(!s&&req.response||s>=200&&s<300||s===304?req:null)}};req.send(null)};d3.text=function(url,mime,callback){function ready(req){callback(req&&req.responseText)}if(arguments.length<3){callback=mime;mime=null}d3.xhr(url,mime,ready)};d3.json=function(url,callback){d3.text(url,"application/json",function(text){callback(text?JSON.parse(text):null)})};d3.html=function(url,callback){d3.text(url,"text/html",function(text){if(text!=null){var range=document.createRange();range.selectNode(document.body);text=range.createContextualFragment(text)}callback(text)})};d3.xml=function(url,mime,callback){function ready(req){callback(req&&req.responseXML)}if(arguments.length<3){callback=mime;mime=null}d3.xhr(url,mime,ready)};var d3_nsPrefix={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:d3_nsPrefix,qualify:function(name){var i=name.indexOf(":"),prefix=name;if(i>=0){prefix=name.substring(0,i);name=name.substring(i+1)}return d3_nsPrefix.hasOwnProperty(prefix)?{space:d3_nsPrefix[prefix],local:name}:name}};d3.dispatch=function(){var dispatch=new d3_dispatch,i=-1,n=arguments.length;while(++i<n){dispatch[arguments[i]]=d3_dispatch_event(dispatch)}return dispatch};d3_dispatch.prototype.on=function(type,listener){var i=type.indexOf("."),name="";if(i>0){name=type.substring(i+1);type=type.substring(0,i)}return arguments.length<2?this[type].on(name):this[type].on(name,listener)};d3.format=function(specifier){var match=d3_format_re.exec(specifier),fill=match[1]||" ",sign=match[3]||"",zfill=match[5],width=+match[6],comma=match[7],precision=match[8],type=match[9],scale=1,suffix="",integer=false;if(precision){precision=+precision.substring(1)}if(zfill){fill="0";if(comma){width-=Math.floor((width-1)/4)}}switch(type){case"n":comma=true;type="g";break;case"%":scale=100;suffix="%";type="f";break;case"p":scale=100;suffix="%";type="r";break;case"d":integer=true;precision=0;break;case"s":scale=-1;type="r";break}if(type=="r"&&!precision){type="g"}type=d3_format_types.get(type)||d3_format_typeDefault;return function(value){if(integer&&value%1){return""}var negative=value<0&&(value=-value)?"-":sign;if(scale<0){var prefix=d3.formatPrefix(value,precision);value=prefix.scale(value);suffix=prefix.symbol}else{value*=scale}value=type(value,precision);if(zfill){var length=value.length+negative.length;if(length<width){value=(new Array(width-length+1)).join(fill)+value}if(comma){value=d3_format_group(value)}value=negative+value}else{if(comma){value=d3_format_group(value)}value=negative+value;var length=value.length;if(length<width){value=(new Array(width-length+1)).join(fill)+value}}return value+suffix}};var d3_format_re=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/;var d3_format_types=d3.map({g:function(x,p){return x.toPrecision(p)},e:function(x,p){return x.toExponential(p)},f:function(x,p){return x.toFixed(p)},r:function(x,p){return d3.round(x,p=d3_format_precision(x,p)).toFixed(Math.max(0,Math.min(20,p)))}});var d3_formatPrefixes=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(d3_formatPrefix);d3.formatPrefix=function(value,precision){var i=0;if(value){if(value<0){value*=-1}if(precision){value=d3.round(value,d3_format_precision(value,precision))}i=1+Math.floor(1e-12+Math.log(value)/Math.LN10);i=Math.max(-24,Math.min(24,Math.floor((i<=0?i+1:i-1)/3)*3))}return d3_formatPrefixes[8+i/3]};var d3_ease_quad=d3_ease_poly(2),d3_ease_cubic=d3_ease_poly(3),d3_ease_default=function(){return d3_ease_identity};var d3_ease=d3.map({linear:d3_ease_default,poly:d3_ease_poly,quad:function(){return d3_ease_quad},cubic:function(){return d3_ease_cubic},sin:function(){return d3_ease_sin},exp:function(){return d3_ease_exp},circle:function(){return d3_ease_circle},elastic:d3_ease_elastic,back:d3_ease_back,bounce:function(){return d3_ease_bounce}});var d3_ease_mode=d3.map({"in":d3_ease_identity,out:d3_ease_reverse,"in-out":d3_ease_reflect,"out-in":function(f){return d3_ease_reflect(d3_ease_reverse(f))}});d3.ease=function(name){var i=name.indexOf("-"),t=i>=0?name.substring(0,i):name,m=i>=0?name.substring(i+1):"in";t=d3_ease.get(t)||d3_ease_default;m=d3_ease_mode.get(m)||d3_ease_identity;return d3_ease_clamp(m(t.apply(null,Array.prototype.slice.call(arguments,1))))};d3.event=null;d3.transform=function(string){var g=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(string){g.setAttribute("transform",string);var t=g.transform.baseVal.consolidate();return new d3_transform(t?t.matrix:d3_transformIdentity)})(string)};d3_transform.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var d3_transformDegrees=180/Math.PI,d3_transformIdentity={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(a,b){var i=d3.interpolators.length,f;while(--i>=0&&!(f=d3.interpolators[i](a,b))){}return f};d3.interpolateNumber=function(a,b){b-=a;return function(t){return a+b*t}};d3.interpolateRound=function(a,b){b-=a;return function(t){return Math.round(a+b*t)}};d3.interpolateString=function(a,b){var m,i,j,s0=0,s1=0,s=[],q=[],n,o;d3_interpolate_number.lastIndex=0;for(i=0;m=d3_interpolate_number.exec(b);++i){if(m.index){s.push(b.substring(s0,s1=m.index))}q.push({i:s.length,x:m[0]});s.push(null);s0=d3_interpolate_number.lastIndex}if(s0<b.length){s.push(b.substring(s0))}for(i=0,n=q.length;(m=d3_interpolate_number.exec(a))&&i<n;++i){o=q[i];if(o.x==m[0]){if(o.i){if(s[o.i+1]==null){s[o.i-1]+=o.x;s.splice(o.i,1);for(j=i+1;j<n;++j){q[j].i--}}else{s[o.i-1]+=o.x+s[o.i+1];s.splice(o.i,2);for(j=i+1;j<n;++j){q[j].i-=2}}}else{if(s[o.i+1]==null){s[o.i]=o.x}else{s[o.i]=o.x+s[o.i+1];s.splice(o.i+1,1);for(j=i+1;j<n;++j){q[j].i--}}}q.splice(i,1);n--;i--}else{o.x=d3.interpolateNumber(parseFloat(m[0]),parseFloat(o.x))}}while(i<n){o=q.pop();if(s[o.i+1]==null){s[o.i]=o.x}else{s[o.i]=o.x+s[o.i+1];s.splice(o.i+1,1)}n--}if(s.length===1){return s[0]==null?q[0].x:function(){return b}}return function(t){for(i=0;i<n;++i){s[(o=q[i]).i]=o.x(t)}return s.join("")}};d3.interpolateTransform=function(a,b){var s=[],q=[],n,A=d3.transform(a),B=d3.transform(b),ta=A.translate,tb=B.translate,ra=A.rotate,rb=B.rotate,wa=A.skew,wb=B.skew,ka=A.scale,kb=B.scale;if(ta[0]!=tb[0]||ta[1]!=tb[1]){s.push("translate(",null,",",null,")");q.push({i:1,x:d3.interpolateNumber(ta[0],tb[0])},{i:3,x:d3.interpolateNumber(ta[1],tb[1])})}else{if(tb[0]||tb[1]){s.push("translate("+tb+")")}else{s.push("")}}if(ra!=rb){if(ra-rb>180){rb+=360}else{if(rb-ra>180){ra+=360}}q.push({i:s.push(s.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(ra,rb)})}else{if(rb){s.push(s.pop()+"rotate("+rb+")")}}if(wa!=wb){q.push({i:s.push(s.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(wa,wb)})}else{if(wb){s.push(s.pop()+"skewX("+wb+")")}}if(ka[0]!=kb[0]||ka[1]!=kb[1]){n=s.push(s.pop()+"scale(",null,",",null,")");q.push({i:n-4,x:d3.interpolateNumber(ka[0],kb[0])},{i:n-2,x:d3.interpolateNumber(ka[1],kb[1])})}else{if(kb[0]!=1||kb[1]!=1){s.push(s.pop()+"scale("+kb+")")}}n=q.length;return function(t){var i=-1,o;while(++i<n){s[(o=q[i]).i]=o.x(t)}return s.join("")}};d3.interpolateRgb=function(a,b){a=d3.rgb(a);b=d3.rgb(b);var ar=a.r,ag=a.g,ab=a.b,br=b.r-ar,bg=b.g-ag,bb=b.b-ab;return function(t){return"#"+d3_rgb_hex(Math.round(ar+br*t))+d3_rgb_hex(Math.round(ag+bg*t))+d3_rgb_hex(Math.round(ab+bb*t))}};d3.interpolateHsl=function(a,b){a=d3.hsl(a);b=d3.hsl(b);var h0=a.h,s0=a.s,l0=a.l,h1=b.h-h0,s1=b.s-s0,l1=b.l-l0;if(h1>180){h1-=360}else{if(h1<-180){h1+=360}}return function(t){return d3_hsl_rgb(h0+h1*t,s0+s1*t,l0+l1*t)+""}};d3.interpolateLab=function(a,b){a=d3.lab(a);b=d3.lab(b);var al=a.l,aa=a.a,ab=a.b,bl=b.l-al,ba=b.a-aa,bb=b.b-ab;return function(t){return d3_lab_rgb(al+bl*t,aa+ba*t,ab+bb*t)+""}};d3.interpolateHcl=function(a,b){a=d3.hcl(a);b=d3.hcl(b);var ah=a.h,ac=a.c,al=a.l,bh=b.h-ah,bc=b.c-ac,bl=b.l-al;if(bh>180){bh-=360}else{if(bh<-180){bh+=360}}return function(t){return d3_hcl_lab(ah+bh*t,ac+bc*t,al+bl*t)+""}};d3.interpolateArray=function(a,b){var x=[],c=[],na=a.length,nb=b.length,n0=Math.min(a.length,b.length),i;for(i=0;i<n0;++i){x.push(d3.interpolate(a[i],b[i]))}for(;i<na;++i){c[i]=a[i]}for(;i<nb;++i){c[i]=b[i]}return function(t){for(i=0;i<n0;++i){c[i]=x[i](t)}return c}};d3.interpolateObject=function(a,b){var i={},c={},k;for(k in a){if(k in b){i[k]=d3_interpolateByName(k)(a[k],b[k])}else{c[k]=a[k]}}for(k in b){if(!(k in a)){c[k]=b[k]}}return function(t){for(k in i){c[k]=i[k](t)}return c}};var d3_interpolate_number=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(a,b){return b instanceof Array&&d3.interpolateArray(a,b)},function(a,b){return(typeof a==="string"||typeof b==="string")&&d3.interpolateString(a+"",b+"")},function(a,b){return(typeof b==="string"?d3_rgb_names.has(b)||/^(#|rgb\(|hsl\()/.test(b):b instanceof d3_Rgb||b instanceof d3_Hsl)&&d3.interpolateRgb(a,b)},function(a,b){return !isNaN(a=+a)&&!isNaN(b=+b)&&d3.interpolateNumber(a,b)}];d3.rgb=function(r,g,b){return arguments.length===1?r instanceof d3_Rgb?d3_rgb(r.r,r.g,r.b):d3_rgb_parse(""+r,d3_rgb,d3_hsl_rgb):d3_rgb(~~r,~~g,~~b)};d3_Rgb.prototype.brighter=function(k){k=Math.pow(0.7,arguments.length?k:1);var r=this.r,g=this.g,b=this.b,i=30;if(!r&&!g&&!b){return d3_rgb(i,i,i)}if(r&&r<i){r=i}if(g&&g<i){g=i}if(b&&b<i){b=i}return d3_rgb(Math.min(255,Math.floor(r/k)),Math.min(255,Math.floor(g/k)),Math.min(255,Math.floor(b/k)))};d3_Rgb.prototype.darker=function(k){k=Math.pow(0.7,arguments.length?k:1);return d3_rgb(Math.floor(k*this.r),Math.floor(k*this.g),Math.floor(k*this.b))};d3_Rgb.prototype.hsl=function(){return d3_rgb_hsl(this.r,this.g,this.b)};d3_Rgb.prototype.toString=function(){return"#"+d3_rgb_hex(this.r)+d3_rgb_hex(this.g)+d3_rgb_hex(this.b)};var d3_rgb_names=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});d3_rgb_names.forEach(function(key,value){d3_rgb_names.set(key,d3_rgb_parse(value,d3_rgb,d3_hsl_rgb))});d3.hsl=function(h,s,l){return arguments.length===1?h instanceof d3_Hsl?d3_hsl(h.h,h.s,h.l):d3_rgb_parse(""+h,d3_rgb_hsl,d3_hsl):d3_hsl(+h,+s,+l)};d3_Hsl.prototype.brighter=function(k){k=Math.pow(0.7,arguments.length?k:1);return d3_hsl(this.h,this.s,this.l/k)};d3_Hsl.prototype.darker=function(k){k=Math.pow(0.7,arguments.length?k:1);return d3_hsl(this.h,this.s,k*this.l)};d3_Hsl.prototype.rgb=function(){return d3_hsl_rgb(this.h,this.s,this.l)};d3_Hsl.prototype.toString=function(){return this.rgb().toString()};d3.hcl=function(h,c,l){return arguments.length===1?h instanceof d3_Hcl?d3_hcl(h.h,h.c,h.l):h instanceof d3_Lab?d3_lab_hcl(h.l,h.a,h.b):d3_lab_hcl((h=d3_rgb_lab((h=d3.rgb(h)).r,h.g,h.b)).l,h.a,h.b):d3_hcl(+h,+c,+l)};d3_Hcl.prototype.brighter=function(k){return d3_hcl(this.h,this.c,Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)))};d3_Hcl.prototype.darker=function(k){return d3_hcl(this.h,this.c,Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)))};d3_Hcl.prototype.rgb=function(){return d3_hcl_lab(this.h,this.c,this.l).rgb()};d3_Hcl.prototype.toString=function(){return this.rgb()+""};d3.lab=function(l,a,b){return arguments.length===1?l instanceof d3_Lab?d3_lab(l.l,l.a,l.b):l instanceof d3_Hcl?d3_hcl_lab(l.l,l.c,l.h):d3_rgb_lab((l=d3.rgb(l)).r,l.g,l.b):d3_lab(+l,+a,+b)};var d3_lab_K=18;var d3_lab_X=0.95047,d3_lab_Y=1,d3_lab_Z=1.08883;d3_Lab.prototype.brighter=function(k){return d3_lab(Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)),this.a,this.b)};d3_Lab.prototype.darker=function(k){return d3_lab(Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)),this.a,this.b)};d3_Lab.prototype.rgb=function(){return d3_lab_rgb(this.l,this.a,this.b)};d3_Lab.prototype.toString=function(){return this.rgb()+""};var d3_select=function(s,n){return n.querySelector(s)},d3_selectAll=function(s,n){return n.querySelectorAll(s)},d3_selectRoot=document.documentElement,d3_selectMatcher=d3_selectRoot.matchesSelector||d3_selectRoot.webkitMatchesSelector||d3_selectRoot.mozMatchesSelector||d3_selectRoot.msMatchesSelector||d3_selectRoot.oMatchesSelector,d3_selectMatches=function(n,s){return d3_selectMatcher.call(n,s)};if(typeof Sizzle==="function"){d3_select=function(s,n){return Sizzle(s,n)[0]||null};d3_selectAll=function(s,n){return Sizzle.uniqueSort(Sizzle(s,n))};d3_selectMatches=Sizzle.matchesSelector}var d3_selectionPrototype=[];d3.selection=function(){return d3_selectionRoot};d3.selection.prototype=d3_selectionPrototype;d3_selectionPrototype.select=function(selector){var subgroups=[],subgroup,subnode,group,node;if(typeof selector!=="function"){selector=d3_selection_selector(selector)}for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);subgroup.parentNode=(group=this[j]).parentNode;for(var i=-1,n=group.length;++i<n;){if(node=group[i]){subgroup.push(subnode=selector.call(node,node.__data__,i));if(subnode&&"__data__" in node){subnode.__data__=node.__data__}}else{subgroup.push(null)}}}return d3_selection(subgroups)};d3_selectionPrototype.selectAll=function(selector){var subgroups=[],subgroup,node;if(typeof selector!=="function"){selector=d3_selection_selectorAll(selector)}for(var j=-1,m=this.length;++j<m;){for(var group=this[j],i=-1,n=group.length;++i<n;){if(node=group[i]){subgroups.push(subgroup=d3_array(selector.call(node,node.__data__,i)));subgroup.parentNode=node}}}return d3_selection(subgroups)};d3_selectionPrototype.attr=function(name,value){if(arguments.length<2){if(typeof name==="string"){var node=this.node();name=d3.ns.qualify(name);return name.local?node.getAttributeNS(name.space,name.local):node.getAttribute(name)}for(value in name){this.each(d3_selection_attr(value,name[value]))}return this}return this.each(d3_selection_attr(name,value))};d3_selectionPrototype.classed=function(name,value){if(arguments.length<2){if(typeof name==="string"){var node=this.node(),n=(name=name.trim().split(/^|\s+/g)).length,i=-1;if(value=node.classList){while(++i<n){if(!value.contains(name[i])){return false}}}else{value=node.className;if(value.baseVal!=null){value=value.baseVal}while(++i<n){if(!d3_selection_classedRe(name[i]).test(value)){return false}}}return true}for(value in name){this.each(d3_selection_classed(value,name[value]))}return this}return this.each(d3_selection_classed(name,value))};d3_selectionPrototype.style=function(name,value,priority){var n=arguments.length;if(n<3){if(typeof name!=="string"){if(n<2){value=""}for(priority in name){this.each(d3_selection_style(priority,name[priority],value))}return this}if(n<2){return window.getComputedStyle(this.node(),null).getPropertyValue(name)}priority=""}return this.each(d3_selection_style(name,value,priority))};d3_selectionPrototype.property=function(name,value){if(arguments.length<2){if(typeof name==="string"){return this.node()[name]}for(value in name){this.each(d3_selection_property(value,name[value]))}return this}return this.each(d3_selection_property(name,value))};d3_selectionPrototype.text=function(value){return arguments.length<1?this.node().textContent:this.each(typeof value==="function"?function(){var v=value.apply(this,arguments);this.textContent=v==null?"":v}:value==null?function(){this.textContent=""}:function(){this.textContent=value})};d3_selectionPrototype.html=function(value){return arguments.length<1?this.node().innerHTML:this.each(typeof value==="function"?function(){var v=value.apply(this,arguments);this.innerHTML=v==null?"":v}:value==null?function(){this.innerHTML=""}:function(){this.innerHTML=value})};d3_selectionPrototype.append=function(name){function append(){return this.appendChild(document.createElementNS(this.namespaceURI,name))}function appendNS(){return this.appendChild(document.createElementNS(name.space,name.local))}name=d3.ns.qualify(name);return this.select(name.local?appendNS:append)};d3_selectionPrototype.insert=function(name,before){function insert(){return this.insertBefore(document.createElementNS(this.namespaceURI,name),d3_select(before,this))}function insertNS(){return this.insertBefore(document.createElementNS(name.space,name.local),d3_select(before,this))}name=d3.ns.qualify(name);return this.select(name.local?insertNS:insert)};d3_selectionPrototype.remove=function(){return this.each(function(){var parent=this.parentNode;if(parent){parent.removeChild(this)}})};d3_selectionPrototype.data=function(value,key){function bind(group,groupData){var i,n=group.length,m=groupData.length,n0=Math.min(n,m),n1=Math.max(n,m),updateNodes=[],enterNodes=[],exitNodes=[],node,nodeData;if(key){var nodeByKeyValue=new d3_Map,keyValues=[],keyValue,j=groupData.length;for(i=-1;++i<n;){keyValue=key.call(node=group[i],node.__data__,i);if(nodeByKeyValue.has(keyValue)){exitNodes[j++]=node}else{nodeByKeyValue.set(keyValue,node)}keyValues.push(keyValue)}for(i=-1;++i<m;){keyValue=key.call(groupData,nodeData=groupData[i],i);if(nodeByKeyValue.has(keyValue)){updateNodes[i]=node=nodeByKeyValue.get(keyValue);node.__data__=nodeData;enterNodes[i]=exitNodes[i]=null}else{enterNodes[i]=d3_selection_dataNode(nodeData);updateNodes[i]=exitNodes[i]=null}nodeByKeyValue.remove(keyValue)}for(i=-1;++i<n;){if(nodeByKeyValue.has(keyValues[i])){exitNodes[i]=group[i]}}}else{for(i=-1;++i<n0;){node=group[i];nodeData=groupData[i];if(node){node.__data__=nodeData;updateNodes[i]=node;enterNodes[i]=exitNodes[i]=null}else{enterNodes[i]=d3_selection_dataNode(nodeData);updateNodes[i]=exitNodes[i]=null}}for(;i<m;++i){enterNodes[i]=d3_selection_dataNode(groupData[i]);updateNodes[i]=exitNodes[i]=null}for(;i<n1;++i){exitNodes[i]=group[i];enterNodes[i]=updateNodes[i]=null}}enterNodes.update=updateNodes;enterNodes.parentNode=updateNodes.parentNode=exitNodes.parentNode=group.parentNode;enter.push(enterNodes);update.push(updateNodes);exit.push(exitNodes)}var i=-1,n=this.length,group,node;if(!arguments.length){value=new Array(n=(group=this[0]).length);while(++i<n){if(node=group[i]){value[i]=node.__data__}}return value}var enter=d3_selection_enter([]),update=d3_selection([]),exit=d3_selection([]);if(typeof value==="function"){while(++i<n){bind(group=this[i],value.call(group,group.parentNode.__data__,i))}}else{while(++i<n){bind(group=this[i],value)}}update.enter=function(){return enter};update.exit=function(){return exit};return update};d3_selectionPrototype.datum=d3_selectionPrototype.map=function(value){return arguments.length<1?this.property("__data__"):this.property("__data__",value)};d3_selectionPrototype.filter=function(filter){var subgroups=[],subgroup,group,node;if(typeof filter!=="function"){filter=d3_selection_filter(filter)}for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);subgroup.parentNode=(group=this[j]).parentNode;for(var i=0,n=group.length;i<n;i++){if((node=group[i])&&filter.call(node,node.__data__,i)){subgroup.push(node)}}}return d3_selection(subgroups)};d3_selectionPrototype.order=function(){for(var j=-1,m=this.length;++j<m;){for(var group=this[j],i=group.length-1,next=group[i],node;--i>=0;){if(node=group[i]){if(next&&next!==node.nextSibling){next.parentNode.insertBefore(node,next)}next=node}}}return this};d3_selectionPrototype.sort=function(comparator){comparator=d3_selection_sortComparator.apply(this,arguments);for(var j=-1,m=this.length;++j<m;){this[j].sort(comparator)}return this.order()};d3_selectionPrototype.on=function(type,listener,capture){var n=arguments.length;if(n<3){if(typeof type!=="string"){if(n<2){listener=false}for(capture in type){this.each(d3_selection_on(capture,type[capture],listener))}return this}if(n<2){return(n=this.node()["__on"+type])&&n._}capture=false}return this.each(d3_selection_on(type,listener,capture))};d3_selectionPrototype.each=function(callback){return d3_selection_each(this,function(node,i,j){callback.call(node,node.__data__,i,j)})};d3_selectionPrototype.call=function(callback){callback.apply(this,(arguments[0]=this,arguments));return this};d3_selectionPrototype.empty=function(){return !this.node()};d3_selectionPrototype.node=function(callback){for(var j=0,m=this.length;j<m;j++){for(var group=this[j],i=0,n=group.length;i<n;i++){var node=group[i];if(node){return node}}}return null};d3_selectionPrototype.transition=function(){var subgroups=[],subgroup,node;for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;){subgroup.push((node=group[i])?{node:node,delay:d3_transitionDelay,duration:d3_transitionDuration}:null)}}return d3_transition(subgroups,d3_transitionId||++d3_transitionNextId,Date.now())};var d3_selectionRoot=d3_selection([[document]]);d3_selectionRoot[0].parentNode=d3_selectRoot;d3.select=function(selector){return typeof selector==="string"?d3_selectionRoot.select(selector):d3_selection([[selector]])};d3.selectAll=function(selector){return typeof selector==="string"?d3_selectionRoot.selectAll(selector):d3_selection([d3_array(selector)])};var d3_selection_enterPrototype=[];d3.selection.enter=d3_selection_enter;d3.selection.enter.prototype=d3_selection_enterPrototype;d3_selection_enterPrototype.append=d3_selectionPrototype.append;d3_selection_enterPrototype.insert=d3_selectionPrototype.insert;d3_selection_enterPrototype.empty=d3_selectionPrototype.empty;d3_selection_enterPrototype.node=d3_selectionPrototype.node;d3_selection_enterPrototype.select=function(selector){var subgroups=[],subgroup,subnode,upgroup,group,node;for(var j=-1,m=this.length;++j<m;){upgroup=(group=this[j]).update;subgroups.push(subgroup=[]);subgroup.parentNode=group.parentNode;for(var i=-1,n=group.length;++i<n;){if(node=group[i]){subgroup.push(upgroup[i]=subnode=selector.call(group.parentNode,node.__data__,i));subnode.__data__=node.__data__}else{subgroup.push(null)}}}return d3_selection(subgroups)};var d3_transitionPrototype=[],d3_transitionNextId=0,d3_transitionId=0,d3_transitionDefaultDelay=0,d3_transitionDefaultDuration=250,d3_transitionDefaultEase=d3.ease("cubic-in-out"),d3_transitionDelay=d3_transitionDefaultDelay,d3_transitionDuration=d3_transitionDefaultDuration,d3_transitionEase=d3_transitionDefaultEase;d3_transitionPrototype.call=d3_selectionPrototype.call;d3.transition=function(selection){return arguments.length?d3_transitionId?selection.transition():selection:d3_selectionRoot.transition()};d3.transition.prototype=d3_transitionPrototype;d3_transitionPrototype.select=function(selector){var subgroups=[],subgroup,subnode,node;if(typeof selector!=="function"){selector=d3_selection_selector(selector)}for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;){if((node=group[i])&&(subnode=selector.call(node.node,node.node.__data__,i))){if("__data__" in node.node){subnode.__data__=node.node.__data__}subgroup.push({node:subnode,delay:node.delay,duration:node.duration})}else{subgroup.push(null)}}}return d3_transition(subgroups,this.id,this.time).ease(this.ease())};d3_transitionPrototype.selectAll=function(selector){var subgroups=[],subgroup,subnodes,node;if(typeof selector!=="function"){selector=d3_selection_selectorAll(selector)}for(var j=-1,m=this.length;++j<m;){for(var group=this[j],i=-1,n=group.length;++i<n;){if(node=group[i]){subnodes=selector.call(node.node,node.node.__data__,i);subgroups.push(subgroup=[]);for(var k=-1,o=subnodes.length;++k<o;){subgroup.push({node:subnodes[k],delay:node.delay,duration:node.duration})}}}}return d3_transition(subgroups,this.id,this.time).ease(this.ease())};d3_transitionPrototype.filter=function(filter){var subgroups=[],subgroup,group,node;if(typeof filter!=="function"){filter=d3_selection_filter(filter)}for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);for(var group=this[j],i=0,n=group.length;i<n;i++){if((node=group[i])&&filter.call(node.node,node.node.__data__,i)){subgroup.push(node)}}}return d3_transition(subgroups,this.id,this.time).ease(this.ease())};d3_transitionPrototype.attr=function(name,value){if(arguments.length<2){for(value in name){this.attrTween(value,d3_tweenByName(name[value],value))}return this}return this.attrTween(name,d3_tweenByName(value,name))};d3_transitionPrototype.attrTween=function(nameNS,tween){function attrTween(d,i){var f=tween.call(this,d,i,this.getAttribute(name));return f===d3_tweenRemove?(this.removeAttribute(name),null):f&&function(t){this.setAttribute(name,f(t))}}function attrTweenNS(d,i){var f=tween.call(this,d,i,this.getAttributeNS(name.space,name.local));return f===d3_tweenRemove?(this.removeAttributeNS(name.space,name.local),null):f&&function(t){this.setAttributeNS(name.space,name.local,f(t))}}var name=d3.ns.qualify(nameNS);return this.tween("attr."+nameNS,name.local?attrTweenNS:attrTween)};d3_transitionPrototype.style=function(name,value,priority){var n=arguments.length;if(n<3){if(typeof name!=="string"){if(n<2){value=""}for(priority in name){this.styleTween(priority,d3_tweenByName(name[priority],priority),value)}return this}priority=""}return this.styleTween(name,d3_tweenByName(value,name),priority)};d3_transitionPrototype.styleTween=function(name,tween,priority){if(arguments.length<3){priority=""}return this.tween("style."+name,function(d,i){var f=tween.call(this,d,i,window.getComputedStyle(this,null).getPropertyValue(name));return f===d3_tweenRemove?(this.style.removeProperty(name),null):f&&function(t){this.style.setProperty(name,f(t),priority)}})};d3_transitionPrototype.text=function(value){return this.tween("text",function(d,i){this.textContent=typeof value==="function"?value.call(this,d,i):value})};d3_transitionPrototype.remove=function(){return this.each("end.transition",function(){var p;if(!this.__transition__&&(p=this.parentNode)){p.removeChild(this)}})};d3_transitionPrototype.delay=function(value){return d3_selection_each(this,typeof value==="function"?function(node,i,j){node.delay=value.call(node=node.node,node.__data__,i,j)|0}:(value=value|0,function(node){node.delay=value}))};d3_transitionPrototype.duration=function(value){return d3_selection_each(this,typeof value==="function"?function(node,i,j){node.duration=Math.max(1,value.call(node=node.node,node.__data__,i,j)|0)}:(value=Math.max(1,value|0),function(node){node.duration=value}))};d3_transitionPrototype.transition=function(){return this.select(d3_this)};d3.tween=function(b,interpolate){function tweenFunction(d,i,a){var v=b.call(this,d,i);return v==null?a!=""&&d3_tweenRemove:a!=v&&interpolate(a,v)}function tweenString(d,i,a){return a!=b&&interpolate(a,b)}return typeof b==="function"?tweenFunction:b==null?d3_tweenNull:(b+="",tweenString)};var d3_tweenRemove={};var d3_timer_queue=null,d3_timer_interval,d3_timer_timeout;d3.timer=function(callback,delay,then){var found=false,t0,t1=d3_timer_queue;if(arguments.length<3){if(arguments.length<2){delay=0}else{if(!isFinite(delay)){return}}then=Date.now()}while(t1){if(t1.callback===callback){t1.then=then;t1.delay=delay;found=true;break}t0=t1;t1=t1.next}if(!found){d3_timer_queue={callback:callback,then:then,delay:delay,next:d3_timer_queue}}if(!d3_timer_interval){d3_timer_timeout=clearTimeout(d3_timer_timeout);d3_timer_interval=1;d3_timer_frame(d3_timer_step)}};d3.timer.flush=function(){var elapsed,now=Date.now(),t1=d3_timer_queue;while(t1){elapsed=now-t1.then;if(!t1.delay){t1.flush=t1.callback(elapsed)}t1=t1.next}d3_timer_flush()};var d3_timer_frame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){setTimeout(callback,17)};d3.mouse=function(container){return d3_mousePoint(container,d3_eventSource())};var d3_mouse_bug44083=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(container,touches){if(arguments.length<2){touches=d3_eventSource().touches}return touches?d3_array(touches).map(function(touch){var point=d3_mousePoint(container,touch);point.identifier=touch.identifier;return point}):[]};d3.scale={};d3.scale.linear=function(){return d3_scale_linear([0,1],[0,1],d3.interpolate,false)};d3.scale.log=function(){return d3_scale_log(d3.scale.linear(),d3_scale_logp)};var d3_scale_logFormat=d3.format(".0e");d3_scale_logp.pow=function(x){return Math.pow(10,x)};d3_scale_logn.pow=function(x){return -Math.pow(10,-x)};d3.scale.pow=function(){return d3_scale_pow(d3.scale.linear(),1)};d3.scale.sqrt=function(){return d3.scale.pow().exponent(0.5)};d3.scale.ordinal=function(){return d3_scale_ordinal([],{t:"range",a:[[]]})};d3.scale.category10=function(){return d3.scale.ordinal().range(d3_category10)};d3.scale.category20=function(){return d3.scale.ordinal().range(d3_category20)};d3.scale.category20b=function(){return d3.scale.ordinal().range(d3_category20b)};d3.scale.category20c=function(){return d3.scale.ordinal().range(d3_category20c)};var d3_category10=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];var d3_category20=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"];var d3_category20b=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"];var d3_category20c=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return d3_scale_quantile([],[])};d3.scale.quantize=function(){return d3_scale_quantize(0,1,[0,1])};d3.scale.threshold=function(){return d3_scale_threshold([0.5],[0,1])};d3.scale.identity=function(){return d3_scale_identity([0,1])};d3.svg={};d3.svg.arc=function(){function arc(){var r0=innerRadius.apply(this,arguments),r1=outerRadius.apply(this,arguments),a0=startAngle.apply(this,arguments)+d3_svg_arcOffset,a1=endAngle.apply(this,arguments)+d3_svg_arcOffset,da=(a1<a0&&(da=a0,a0=a1,a1=da),a1-a0),df=da<Math.PI?"0":"1",c0=Math.cos(a0),s0=Math.sin(a0),c1=Math.cos(a1),s1=Math.sin(a1);return da>=d3_svg_arcMax?r0?"M0,"+r1+"A"+r1+","+r1+" 0 1,1 0,"+-r1+"A"+r1+","+r1+" 0 1,1 0,"+r1+"M0,"+r0+"A"+r0+","+r0+" 0 1,0 0,"+-r0+"A"+r0+","+r0+" 0 1,0 0,"+r0+"Z":"M0,"+r1+"A"+r1+","+r1+" 0 1,1 0,"+-r1+"A"+r1+","+r1+" 0 1,1 0,"+r1+"Z":r0?"M"+r1*c0+","+r1*s0+"A"+r1+","+r1+" 0 "+df+",1 "+r1*c1+","+r1*s1+"L"+r0*c1+","+r0*s1+"A"+r0+","+r0+" 0 "+df+",0 "+r0*c0+","+r0*s0+"Z":"M"+r1*c0+","+r1*s0+"A"+r1+","+r1+" 0 "+df+",1 "+r1*c1+","+r1*s1+"L0,0Z"}var innerRadius=d3_svg_arcInnerRadius,outerRadius=d3_svg_arcOuterRadius,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle;arc.innerRadius=function(v){if(!arguments.length){return innerRadius}innerRadius=d3_functor(v);return arc};arc.outerRadius=function(v){if(!arguments.length){return outerRadius}outerRadius=d3_functor(v);return arc};arc.startAngle=function(v){if(!arguments.length){return startAngle}startAngle=d3_functor(v);return arc};arc.endAngle=function(v){if(!arguments.length){return endAngle}endAngle=d3_functor(v);return arc};arc.centroid=function(){var r=(innerRadius.apply(this,arguments)+outerRadius.apply(this,arguments))/2,a=(startAngle.apply(this,arguments)+endAngle.apply(this,arguments))/2+d3_svg_arcOffset;return[Math.cos(a)*r,Math.sin(a)*r]};return arc};var d3_svg_arcOffset=-Math.PI/2,d3_svg_arcMax=2*Math.PI-0.000001;d3.svg.line=function(){return d3_svg_line(d3_identity)};var d3_svg_lineInterpolators=d3.map({linear:d3_svg_lineLinear,"linear-closed":d3_svg_lineLinearClosed,"step-before":d3_svg_lineStepBefore,"step-after":d3_svg_lineStepAfter,basis:d3_svg_lineBasis,"basis-open":d3_svg_lineBasisOpen,"basis-closed":d3_svg_lineBasisClosed,bundle:d3_svg_lineBundle,cardinal:d3_svg_lineCardinal,"cardinal-open":d3_svg_lineCardinalOpen,"cardinal-closed":d3_svg_lineCardinalClosed,monotone:d3_svg_lineMonotone});d3_svg_lineInterpolators.forEach(function(key,value){value.key=key;value.closed=/-closed$/.test(key)});var d3_svg_lineBasisBezier1=[0,2/3,1/3,0],d3_svg_lineBasisBezier2=[0,1/3,2/3,0],d3_svg_lineBasisBezier3=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var line=d3_svg_line(d3_svg_lineRadial);line.radius=line.x,delete line.x;line.angle=line.y,delete line.y;return line};d3_svg_lineStepBefore.reverse=d3_svg_lineStepAfter;d3_svg_lineStepAfter.reverse=d3_svg_lineStepBefore;d3.svg.area=function(){return d3_svg_area(d3_identity)};d3.svg.area.radial=function(){var area=d3_svg_area(d3_svg_lineRadial);area.radius=area.x,delete area.x;area.innerRadius=area.x0,delete area.x0;area.outerRadius=area.x1,delete area.x1;area.angle=area.y,delete area.y;area.startAngle=area.y0,delete area.y0;area.endAngle=area.y1,delete area.y1;return area};d3.svg.chord=function(){function chord(d,i){var s=subgroup(this,source,d,i),t=subgroup(this,target,d,i);return"M"+s.p0+arc(s.r,s.p1,s.a1-s.a0)+(equals(s,t)?curve(s.r,s.p1,s.r,s.p0):curve(s.r,s.p1,t.r,t.p0)+arc(t.r,t.p1,t.a1-t.a0)+curve(t.r,t.p1,s.r,s.p0))+"Z"}function subgroup(self,f,d,i){var subgroup=f.call(self,d,i),r=radius.call(self,subgroup,i),a0=startAngle.call(self,subgroup,i)+d3_svg_arcOffset,a1=endAngle.call(self,subgroup,i)+d3_svg_arcOffset;return{r:r,a0:a0,a1:a1,p0:[r*Math.cos(a0),r*Math.sin(a0)],p1:[r*Math.cos(a1),r*Math.sin(a1)]}}function equals(a,b){return a.a0==b.a0&&a.a1==b.a1}function arc(r,p,a){return"A"+r+","+r+" 0 "+ +(a>Math.PI)+",1 "+p}function curve(r0,p0,r1,p1){return"Q 0,0 "+p1}var source=d3_svg_chordSource,target=d3_svg_chordTarget,radius=d3_svg_chordRadius,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle;chord.radius=function(v){if(!arguments.length){return radius}radius=d3_functor(v);return chord};chord.source=function(v){if(!arguments.length){return source}source=d3_functor(v);return chord};chord.target=function(v){if(!arguments.length){return target}target=d3_functor(v);return chord};chord.startAngle=function(v){if(!arguments.length){return startAngle}startAngle=d3_functor(v);return chord};chord.endAngle=function(v){if(!arguments.length){return endAngle}endAngle=d3_functor(v);return chord};return chord};d3.svg.diagonal=function(){function diagonal(d,i){var p0=source.call(this,d,i),p3=target.call(this,d,i),m=(p0.y+p3.y)/2,p=[p0,{x:p0.x,y:m},{x:p3.x,y:m},p3];p=p.map(projection);return"M"+p[0]+"C"+p[1]+" "+p[2]+" "+p[3]}var source=d3_svg_chordSource,target=d3_svg_chordTarget,projection=d3_svg_diagonalProjection;diagonal.source=function(x){if(!arguments.length){return source}source=d3_functor(x);return diagonal};diagonal.target=function(x){if(!arguments.length){return target}target=d3_functor(x);return diagonal};diagonal.projection=function(x){if(!arguments.length){return projection}projection=x;return diagonal};return diagonal};d3.svg.diagonal.radial=function(){var diagonal=d3.svg.diagonal(),projection=d3_svg_diagonalProjection,projection_=diagonal.projection;diagonal.projection=function(x){return arguments.length?projection_(d3_svg_diagonalRadialProjection(projection=x)):projection};return diagonal};d3.svg.mouse=d3.mouse;d3.svg.touches=d3.touches;d3.svg.symbol=function(){function symbol(d,i){return(d3_svg_symbols.get(type.call(this,d,i))||d3_svg_symbolCircle)(size.call(this,d,i))}var type=d3_svg_symbolType,size=d3_svg_symbolSize;symbol.type=function(x){if(!arguments.length){return type}type=d3_functor(x);return symbol};symbol.size=function(x){if(!arguments.length){return size}size=d3_functor(x);return symbol};return symbol};var d3_svg_symbols=d3.map({circle:d3_svg_symbolCircle,cross:function(size){var r=Math.sqrt(size/5)/2;return"M"+-3*r+","+-r+"H"+-r+"V"+-3*r+"H"+r+"V"+-r+"H"+3*r+"V"+r+"H"+r+"V"+3*r+"H"+-r+"V"+r+"H"+-3*r+"Z"},diamond:function(size){var ry=Math.sqrt(size/(2*d3_svg_symbolTan30)),rx=ry*d3_svg_symbolTan30;return"M0,"+-ry+"L"+rx+",0 0,"+ry+" "+-rx+",0Z"},square:function(size){var r=Math.sqrt(size)/2;return"M"+-r+","+-r+"L"+r+","+-r+" "+r+","+r+" "+-r+","+r+"Z"},"triangle-down":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+ry+"L"+rx+","+-ry+" "+-rx+","+-ry+"Z"},"triangle-up":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+-ry+"L"+rx+","+ry+" "+-rx+","+ry+"Z"}});d3.svg.symbolTypes=d3_svg_symbols.keys();var d3_svg_symbolSqrt3=Math.sqrt(3),d3_svg_symbolTan30=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function axis(g){g.each(function(){var g=d3.select(this);var ticks=tickValues==null?scale.ticks?scale.ticks.apply(scale,tickArguments_):scale.domain():tickValues,tickFormat=tickFormat_==null?scale.tickFormat?scale.tickFormat.apply(scale,tickArguments_):String:tickFormat_;var subticks=d3_svg_axisSubdivide(scale,ticks,tickSubdivide),subtick=g.selectAll(".minor").data(subticks,String),subtickEnter=subtick.enter().insert("line","g").attr("class","tick minor").style("opacity",0.000001),subtickExit=d3.transition(subtick.exit()).style("opacity",0.000001).remove(),subtickUpdate=d3.transition(subtick).style("opacity",1);var tick=g.selectAll("g").data(ticks,String),tickEnter=tick.enter().insert("g","path").style("opacity",0.000001),tickExit=d3.transition(tick.exit()).style("opacity",0.000001).remove(),tickUpdate=d3.transition(tick).style("opacity",1),tickTransform;var range=d3_scaleRange(scale),path=g.selectAll(".domain").data([0]),pathEnter=path.enter().append("path").attr("class","domain"),pathUpdate=d3.transition(path);var scale1=scale.copy(),scale0=this.__chart__||scale1;this.__chart__=scale1;tickEnter.append("line").attr("class","tick");tickEnter.append("text");var lineEnter=tickEnter.select("line"),lineUpdate=tickUpdate.select("line"),text=tick.select("text").text(tickFormat),textEnter=tickEnter.select("text"),textUpdate=tickUpdate.select("text");switch(orient){case"bottom":tickTransform=d3_svg_axisX;subtickEnter.attr("y2",tickMinorSize);subtickUpdate.attr("x2",0).attr("y2",tickMinorSize);lineEnter.attr("y2",tickMajorSize);textEnter.attr("y",Math.max(tickMajorSize,0)+tickPadding);lineUpdate.attr("x2",0).attr("y2",tickMajorSize);textUpdate.attr("x",0).attr("y",Math.max(tickMajorSize,0)+tickPadding);text.attr("dy",".71em").attr("text-anchor","middle");pathUpdate.attr("d","M"+range[0]+","+tickEndSize+"V0H"+range[1]+"V"+tickEndSize);break;case"top":tickTransform=d3_svg_axisX;subtickEnter.attr("y2",-tickMinorSize);subtickUpdate.attr("x2",0).attr("y2",-tickMinorSize);lineEnter.attr("y2",-tickMajorSize);textEnter.attr("y",-(Math.max(tickMajorSize,0)+tickPadding));lineUpdate.attr("x2",0).attr("y2",-tickMajorSize);textUpdate.attr("x",0).attr("y",-(Math.max(tickMajorSize,0)+tickPadding));text.attr("dy","0em").attr("text-anchor","middle");pathUpdate.attr("d","M"+range[0]+","+-tickEndSize+"V0H"+range[1]+"V"+-tickEndSize);break;case"left":tickTransform=d3_svg_axisY;subtickEnter.attr("x2",-tickMinorSize);subtickUpdate.attr("x2",-tickMinorSize).attr("y2",0);lineEnter.attr("x2",-tickMajorSize);textEnter.attr("x",-(Math.max(tickMajorSize,0)+tickPadding));lineUpdate.attr("x2",-tickMajorSize).attr("y2",0);textUpdate.attr("x",-(Math.max(tickMajorSize,0)+tickPadding)).attr("y",0);text.attr("dy",".32em").attr("text-anchor","end");pathUpdate.attr("d","M"+-tickEndSize+","+range[0]+"H0V"+range[1]+"H"+-tickEndSize);break;case"right":tickTransform=d3_svg_axisY;subtickEnter.attr("x2",tickMinorSize);subtickUpdate.attr("x2",tickMinorSize).attr("y2",0);lineEnter.attr("x2",tickMajorSize);textEnter.attr("x",Math.max(tickMajorSize,0)+tickPadding);lineUpdate.attr("x2",tickMajorSize).attr("y2",0);textUpdate.attr("x",Math.max(tickMajorSize,0)+tickPadding).attr("y",0);text.attr("dy",".32em").attr("text-anchor","start");pathUpdate.attr("d","M"+tickEndSize+","+range[0]+"H0V"+range[1]+"H"+tickEndSize);break}if(scale.ticks){tickEnter.call(tickTransform,scale0);tickUpdate.call(tickTransform,scale1);tickExit.call(tickTransform,scale1);subtickEnter.call(tickTransform,scale0);subtickUpdate.call(tickTransform,scale1);subtickExit.call(tickTransform,scale1)}else{var dx=scale1.rangeBand()/2,x=function(d){return scale1(d)+dx};tickEnter.call(tickTransform,x);tickUpdate.call(tickTransform,x)}})}var scale=d3.scale.linear(),orient="bottom",tickMajorSize=6,tickMinorSize=6,tickEndSize=6,tickPadding=3,tickArguments_=[10],tickValues=null,tickFormat_,tickSubdivide=0;axis.scale=function(x){if(!arguments.length){return scale}scale=x;return axis};axis.orient=function(x){if(!arguments.length){return orient}orient=x;return axis};axis.ticks=function(){if(!arguments.length){return tickArguments_}tickArguments_=arguments;return axis};axis.tickValues=function(x){if(!arguments.length){return tickValues}tickValues=x;return axis};axis.tickFormat=function(x){if(!arguments.length){return tickFormat_}tickFormat_=x;return axis};axis.tickSize=function(x,y,z){if(!arguments.length){return tickMajorSize}var n=arguments.length-1;tickMajorSize=+x;tickMinorSize=n>1?+y:tickMajorSize;tickEndSize=n>0?+arguments[n]:tickMajorSize;return axis};axis.tickPadding=function(x){if(!arguments.length){return tickPadding}tickPadding=+x;return axis};axis.tickSubdivide=function(x){if(!arguments.length){return tickSubdivide}tickSubdivide=+x;return axis};return axis};d3.svg.brush=function(){function brush(g){g.each(function(){var g=d3.select(this),bg=g.selectAll(".background").data([0]),fg=g.selectAll(".extent").data([0]),tz=g.selectAll(".resize").data(resizes,String),e;g.style("pointer-events","all").on("mousedown.brush",brushstart).on("touchstart.brush",brushstart);bg.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");fg.enter().append("rect").attr("class","extent").style("cursor","move");tz.enter().append("g").attr("class",function(d){return"resize "+d}).style("cursor",function(d){return d3_svg_brushCursor[d]}).append("rect").attr("x",function(d){return/[ew]$/.test(d)?-3:null}).attr("y",function(d){return/^[ns]/.test(d)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");tz.style("display",brush.empty()?"none":null);tz.exit().remove();if(x){e=d3_scaleRange(x);bg.attr("x",e[0]).attr("width",e[1]-e[0]);redrawX(g)}if(y){e=d3_scaleRange(y);bg.attr("y",e[0]).attr("height",e[1]-e[0]);redrawY(g)}redraw(g)})}function redraw(g){g.selectAll(".resize").attr("transform",function(d){return"translate("+extent[+/e$/.test(d)][0]+","+extent[+/^s/.test(d)][1]+")"})}function redrawX(g){g.select(".extent").attr("x",extent[0][0]);g.selectAll(".extent,.n>rect,.s>rect").attr("width",extent[1][0]-extent[0][0])}function redrawY(g){g.select(".extent").attr("y",extent[0][1]);g.selectAll(".extent,.e>rect,.w>rect").attr("height",extent[1][1]-extent[0][1])}function brushstart(){function mouse(){var touches=d3.event.changedTouches;return touches?d3.touches(target,touches)[0]:d3.mouse(target)}function keydown(){if(d3.event.keyCode==32){if(!dragging){center=null;origin[0]-=extent[1][0];origin[1]-=extent[1][1];dragging=2}d3_eventCancel()}}function keyup(){if(d3.event.keyCode==32&&dragging==2){origin[0]+=extent[1][0];origin[1]+=extent[1][1];dragging=0;d3_eventCancel()}}function brushmove(){var point=mouse(),moved=false;if(offset){point[0]+=offset[0];point[1]+=offset[1]}if(!dragging){if(d3.event.altKey){if(!center){center=[(extent[0][0]+extent[1][0])/2,(extent[0][1]+extent[1][1])/2]}origin[0]=extent[+(point[0]<center[0])][0];origin[1]=extent[+(point[1]<center[1])][1]}else{center=null}}if(resizingX&&move1(point,x,0)){redrawX(g);moved=true}if(resizingY&&move1(point,y,1)){redrawY(g);moved=true}if(moved){redraw(g);event_({type:"brush",mode:dragging?"move":"resize"})}}function move1(point,scale,i){var range=d3_scaleRange(scale),r0=range[0],r1=range[1],position=origin[i],size=extent[1][i]-extent[0][i],min,max;if(dragging){r0-=position;r1-=size+position}min=Math.max(r0,Math.min(r1,point[i]));if(dragging){max=(min+=position)+size}else{if(center){position=Math.max(r0,Math.min(r1,2*center[i]-min))}if(position<min){max=min;min=position}else{max=position}}if(extent[0][i]!==min||extent[1][i]!==max){extentDomain=null;extent[0][i]=min;extent[1][i]=max;return true}}function brushend(){brushmove();g.style("pointer-events","all").selectAll(".resize").style("display",brush.empty()?"none":null);d3.select("body").style("cursor",null);w.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);event_({type:"brushend"});d3_eventCancel()}var target=this,eventTarget=d3.select(d3.event.target),event_=event.of(target,arguments),g=d3.select(target),resizing=eventTarget.datum(),resizingX=!/^(n|s)$/.test(resizing)&&x,resizingY=!/^(e|w)$/.test(resizing)&&y,dragging=eventTarget.classed("extent"),center,origin=mouse(),offset;var w=d3.select(window).on("mousemove.brush",brushmove).on("mouseup.brush",brushend).on("touchmove.brush",brushmove).on("touchend.brush",brushend).on("keydown.brush",keydown).on("keyup.brush",keyup);if(dragging){origin[0]=extent[0][0]-origin[0];origin[1]=extent[0][1]-origin[1]}else{if(resizing){var ex=+/w$/.test(resizing),ey=+/^n/.test(resizing);offset=[extent[1-ex][0]-origin[0],extent[1-ey][1]-origin[1]];origin[0]=extent[ex][0];origin[1]=extent[ey][1]}else{if(d3.event.altKey){center=origin.slice()}}}g.style("pointer-events","none").selectAll(".resize").style("display",null);d3.select("body").style("cursor",eventTarget.style("cursor"));event_({type:"brushstart"});brushmove();d3_eventCancel()}var event=d3_eventDispatch(brush,"brushstart","brush","brushend"),x=null,y=null,resizes=d3_svg_brushResizes[0],extent=[[0,0],[0,0]],extentDomain;brush.x=function(z){if(!arguments.length){return x}x=z;resizes=d3_svg_brushResizes[!x<<1|!y];return brush};brush.y=function(z){if(!arguments.length){return y}y=z;resizes=d3_svg_brushResizes[!x<<1|!y];return brush};brush.extent=function(z){var x0,x1,y0,y1,t;if(!arguments.length){z=extentDomain||extent;if(x){x0=z[0][0],x1=z[1][0];if(!extentDomain){x0=extent[0][0],x1=extent[1][0];if(x.invert){x0=x.invert(x0),x1=x.invert(x1)}if(x1<x0){t=x0,x0=x1,x1=t}}}if(y){y0=z[0][1],y1=z[1][1];if(!extentDomain){y0=extent[0][1],y1=extent[1][1];if(y.invert){y0=y.invert(y0),y1=y.invert(y1)}if(y1<y0){t=y0,y0=y1,y1=t}}}return x&&y?[[x0,y0],[x1,y1]]:x?[x0,x1]:y&&[y0,y1]}extentDomain=[[0,0],[0,0]];if(x){x0=z[0],x1=z[1];if(y){x0=x0[0],x1=x1[0]}extentDomain[0][0]=x0,extentDomain[1][0]=x1;if(x.invert){x0=x(x0),x1=x(x1)}if(x1<x0){t=x0,x0=x1,x1=t}extent[0][0]=x0|0,extent[1][0]=x1|0}if(y){y0=z[0],y1=z[1];if(x){y0=y0[1],y1=y1[1]}extentDomain[0][1]=y0,extentDomain[1][1]=y1;if(y.invert){y0=y(y0),y1=y(y1)}if(y1<y0){t=y0,y0=y1,y1=t}extent[0][1]=y0|0,extent[1][1]=y1|0}return brush};brush.clear=function(){extentDomain=null;extent[0][0]=extent[0][1]=extent[1][0]=extent[1][1]=0;return brush};brush.empty=function(){return x&&extent[0][0]===extent[1][0]||y&&extent[0][1]===extent[1][1]};return d3.rebind(brush,event,"on")};var d3_svg_brushCursor={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var d3_svg_brushResizes=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={};d3.behavior.drag=function(){function drag(){this.on("mousedown.drag",mousedown).on("touchstart.drag",mousedown)}function mousedown(){function point(){var p=target.parentNode;return touchId?d3.touches(p).filter(function(p){return p.identifier===touchId})[0]:d3.mouse(p)}function dragmove(){if(!target.parentNode){return dragend()}var p=point(),dx=p[0]-origin_[0],dy=p[1]-origin_[1];moved|=dx|dy;origin_=p;d3_eventCancel();event_({type:"drag",x:p[0]+offset[0],y:p[1]+offset[1],dx:dx,dy:dy})}function dragend(){event_({type:"dragend"});if(moved){d3_eventCancel();if(d3.event.target===eventTarget){w.on("click.drag",click,true)}}w.on(touchId?"touchmove.drag-"+touchId:"mousemove.drag",null).on(touchId?"touchend.drag-"+touchId:"mouseup.drag",null)}function click(){d3_eventCancel();w.on("click.drag",null)}var target=this,event_=event.of(target,arguments),eventTarget=d3.event.target,touchId=d3.event.touches&&d3.event.changedTouches[0].identifier,offset,origin_=point(),moved=0;var w=d3.select(window).on(touchId?"touchmove.drag-"+touchId:"mousemove.drag",dragmove).on(touchId?"touchend.drag-"+touchId:"mouseup.drag",dragend,true);if(origin){offset=origin.apply(target,arguments);offset=[offset.x-origin_[0],offset.y-origin_[1]]}else{offset=[0,0]}if(!touchId){d3_eventCancel()}event_({type:"dragstart"})}var event=d3_eventDispatch(drag,"drag","dragstart","dragend"),origin=null;drag.origin=function(x){if(!arguments.length){return origin}origin=x;return drag};return d3.rebind(drag,event,"on")};d3.behavior.zoom=function(){function zoom(){this.on("mousedown.zoom",mousedown).on("mousewheel.zoom",mousewheel).on("mousemove.zoom",mousemove).on("DOMMouseScroll.zoom",mousewheel).on("dblclick.zoom",dblclick).on("touchstart.zoom",touchstart).on("touchmove.zoom",touchmove).on("touchend.zoom",touchstart)}function location(p){return[(p[0]-translate[0])/scale,(p[1]-translate[1])/scale]}function point(l){return[l[0]*scale+translate[0],l[1]*scale+translate[1]]}function scaleTo(s){scale=Math.max(scaleExtent[0],Math.min(scaleExtent[1],s))}function translateTo(p,l){l=point(l);translate[0]+=p[0]-l[0];translate[1]+=p[1]-l[1]}function dispatch(event){if(x1){x1.domain(x0.range().map(function(x){return(x-translate[0])/scale}).map(x0.invert))}if(y1){y1.domain(y0.range().map(function(y){return(y-translate[1])/scale}).map(y0.invert))}d3.event.preventDefault();event({type:"zoom",scale:scale,translate:translate})}function mousedown(){function mousemove(){moved=1;translateTo(d3.mouse(target),l);dispatch(event_)}function mouseup(){if(moved){d3_eventCancel()}w.on("mousemove.zoom",null).on("mouseup.zoom",null);if(moved&&d3.event.target===eventTarget){w.on("click.zoom",click,true)}}function click(){d3_eventCancel();w.on("click.zoom",null)}var target=this,event_=event.of(target,arguments),eventTarget=d3.event.target,moved=0,w=d3.select(window).on("mousemove.zoom",mousemove).on("mouseup.zoom",mouseup),l=location(d3.mouse(target));window.focus();d3_eventCancel()}function mousewheel(){if(!translate0){translate0=location(d3.mouse(this))}scaleTo(Math.pow(2,d3_behavior_zoomDelta()*0.002)*scale);translateTo(d3.mouse(this),translate0);dispatch(event.of(this,arguments))}function mousemove(){translate0=null}function dblclick(){var p=d3.mouse(this),l=location(p);scaleTo(d3.event.shiftKey?scale/2:scale*2);translateTo(p,l);dispatch(event.of(this,arguments))}function touchstart(){var touches=d3.touches(this),now=Date.now();scale0=scale;translate0={};touches.forEach(function(t){translate0[t.identifier]=location(t)});d3_eventCancel();if(touches.length===1){if(now-touchtime<500){var p=touches[0],l=location(touches[0]);scaleTo(scale*2);translateTo(p,l);dispatch(event.of(this,arguments))}touchtime=now}}function touchmove(){var touches=d3.touches(this),p0=touches[0],l0=translate0[p0.identifier];if(p1=touches[1]){var p1,l1=translate0[p1.identifier];p0=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2];l0=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2];scaleTo(d3.event.scale*scale0)}translateTo(p0,l0);touchtime=null;dispatch(event.of(this,arguments))}var translate=[0,0],translate0,scale=1,scale0,scaleExtent=d3_behavior_zoomInfinity,event=d3_eventDispatch(zoom,"zoom"),x0,x1,y0,y1,touchtime;zoom.translate=function(x){if(!arguments.length){return translate}translate=x.map(Number);return zoom};zoom.scale=function(x){if(!arguments.length){return scale}scale=+x;return zoom};zoom.scaleExtent=function(x){if(!arguments.length){return scaleExtent}scaleExtent=x==null?d3_behavior_zoomInfinity:x.map(Number);return zoom};zoom.x=function(z){if(!arguments.length){return x1}x1=z;x0=z.copy();return zoom};zoom.y=function(z){if(!arguments.length){return y1}y1=z;y0=z.copy();return zoom};return d3.rebind(zoom,event,"on")};var d3_behavior_zoomDiv,d3_behavior_zoomInfinity=[0,Infinity];d3.layout={};d3.layout.bundle=function(){return function(links){var paths=[],i=-1,n=links.length;while(++i<n){paths.push(d3_layout_bundlePath(links[i]))}return paths}};d3.layout.chord=function(){function relayout(){var subgroups={},groupSums=[],groupIndex=d3.range(n),subgroupIndex=[],k,x,x0,i,j;chords=[];groups=[];k=0,i=-1;while(++i<n){x=0,j=-1;while(++j<n){x+=matrix[i][j]}groupSums.push(x);subgroupIndex.push(d3.range(n));k+=x}if(sortGroups){groupIndex.sort(function(a,b){return sortGroups(groupSums[a],groupSums[b])})}if(sortSubgroups){subgroupIndex.forEach(function(d,i){d.sort(function(a,b){return sortSubgroups(matrix[i][a],matrix[i][b])})})}k=(2*Math.PI-padding*n)/k;x=0,i=-1;while(++i<n){x0=x,j=-1;while(++j<n){var di=groupIndex[i],dj=subgroupIndex[di][j],v=matrix[di][dj],a0=x,a1=x+=v*k;subgroups[di+"-"+dj]={index:di,subindex:dj,startAngle:a0,endAngle:a1,value:v}}groups[di]={index:di,startAngle:x0,endAngle:x,value:(x-x0)/k};x+=padding}i=-1;while(++i<n){j=i-1;while(++j<n){var source=subgroups[i+"-"+j],target=subgroups[j+"-"+i];if(source.value||target.value){chords.push(source.value<target.value?{source:target,target:source}:{source:source,target:target})}}}if(sortChords){resort()}}function resort(){chords.sort(function(a,b){return sortChords((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}var chord={},chords,groups,matrix,n,padding=0,sortGroups,sortSubgroups,sortChords;chord.matrix=function(x){if(!arguments.length){return matrix}n=(matrix=x)&&matrix.length;chords=groups=null;return chord};chord.padding=function(x){if(!arguments.length){return padding}padding=x;chords=groups=null;return chord};chord.sortGroups=function(x){if(!arguments.length){return sortGroups}sortGroups=x;chords=groups=null;return chord};chord.sortSubgroups=function(x){if(!arguments.length){return sortSubgroups}sortSubgroups=x;chords=null;return chord};chord.sortChords=function(x){if(!arguments.length){return sortChords}sortChords=x;if(chords){resort()}return chord};chord.chords=function(){if(!chords){relayout()}return chords};chord.groups=function(){if(!groups){relayout()}return groups};return chord};d3.layout.force=function(){function repulse(node){return function(quad,x1,y1,x2,y2){if(quad.point!==node){var dx=quad.cx-node.x,dy=quad.cy-node.y,dn=1/Math.sqrt(dx*dx+dy*dy);if((x2-x1)*dn<theta){var k=quad.charge*dn*dn;node.px-=dx*k;node.py-=dy*k;return true}if(quad.point&&isFinite(dn)){var k=quad.pointCharge*dn*dn;node.px-=dx*k;node.py-=dy*k}}return !quad.charge}}function dragmove(d){d.px=d3.event.x;d.py=d3.event.y;force.resume()}var force={},event=d3.dispatch("start","tick","end"),size=[1,1],drag,alpha,friction=0.9,linkDistance=d3_layout_forceLinkDistance,linkStrength=d3_layout_forceLinkStrength,charge=-30,gravity=0.1,theta=0.8,interval,nodes=[],links=[],distances,strengths,charges;force.tick=function(){if((alpha*=0.99)<0.005){event.end({type:"end",alpha:alpha=0});return true}var n=nodes.length,m=links.length,q,i,o,s,t,l,k,x,y;for(i=0;i<m;++i){o=links[i];s=o.source;t=o.target;x=t.x-s.x;y=t.y-s.y;if(l=x*x+y*y){l=alpha*strengths[i]*((l=Math.sqrt(l))-distances[i])/l;x*=l;y*=l;t.x-=x*(k=s.weight/(t.weight+s.weight));t.y-=y*k;s.x+=x*(k=1-k);s.y+=y*k}}if(k=alpha*gravity){x=size[0]/2;y=size[1]/2;i=-1;if(k){while(++i<n){o=nodes[i];o.x+=(x-o.x)*k;o.y+=(y-o.y)*k}}}if(charge){d3_layout_forceAccumulate(q=d3.geom.quadtree(nodes),alpha,charges);i=-1;while(++i<n){if(!(o=nodes[i]).fixed){q.visit(repulse(o))}}}i=-1;while(++i<n){o=nodes[i];if(o.fixed){o.x=o.px;o.y=o.py}else{o.x-=(o.px-(o.px=o.x))*friction;o.y-=(o.py-(o.py=o.y))*friction}}event.tick({type:"tick",alpha:alpha})};force.nodes=function(x){if(!arguments.length){return nodes}nodes=x;return force};force.links=function(x){if(!arguments.length){return links}links=x;return force};force.size=function(x){if(!arguments.length){return size}size=x;return force};force.linkDistance=function(x){if(!arguments.length){return linkDistance}linkDistance=d3_functor(x);return force};force.distance=force.linkDistance;force.linkStrength=function(x){if(!arguments.length){return linkStrength}linkStrength=d3_functor(x);return force};force.friction=function(x){if(!arguments.length){return friction}friction=x;return force};force.charge=function(x){if(!arguments.length){return charge}charge=typeof x==="function"?x:+x;return force};force.gravity=function(x){if(!arguments.length){return gravity}gravity=x;return force};force.theta=function(x){if(!arguments.length){return theta}theta=x;return force};force.alpha=function(x){if(!arguments.length){return alpha}if(alpha){if(x>0){alpha=x}else{alpha=0}}else{if(x>0){event.start({type:"start",alpha:alpha=x});d3.timer(force.tick)}}return force};force.start=function(){function position(dimension,size){var neighbors=neighbor(i),j=-1,m=neighbors.length,x;while(++j<m){if(!isNaN(x=neighbors[j][dimension])){return x}}return Math.random()*size}function neighbor(){if(!neighbors){neighbors=[];for(j=0;j<n;++j){neighbors[j]=[]}for(j=0;j<m;++j){var o=links[j];neighbors[o.source.index].push(o.target);neighbors[o.target.index].push(o.source)}}return neighbors[i]}var i,j,n=nodes.length,m=links.length,w=size[0],h=size[1],neighbors,o;for(i=0;i<n;++i){(o=nodes[i]).index=i;o.weight=0}distances=[];strengths=[];for(i=0;i<m;++i){o=links[i];if(typeof o.source=="number"){o.source=nodes[o.source]}if(typeof o.target=="number"){o.target=nodes[o.target]}distances[i]=linkDistance.call(this,o,i);strengths[i]=linkStrength.call(this,o,i);++o.source.weight;++o.target.weight}for(i=0;i<n;++i){o=nodes[i];if(isNaN(o.x)){o.x=position("x",w)}if(isNaN(o.y)){o.y=position("y",h)}if(isNaN(o.px)){o.px=o.x}if(isNaN(o.py)){o.py=o.y}}charges=[];if(typeof charge==="function"){for(i=0;i<n;++i){charges[i]=+charge.call(this,nodes[i],i)}}else{for(i=0;i<n;++i){charges[i]=charge}}return force.resume()};force.resume=function(){return force.alpha(0.1)};force.stop=function(){return force.alpha(0)};force.drag=function(){if(!drag){drag=d3.behavior.drag().origin(d3_identity).on("dragstart",d3_layout_forceDragstart).on("drag",dragmove).on("dragend",d3_layout_forceDragend)}this.on("mouseover.force",d3_layout_forceMouseover).on("mouseout.force",d3_layout_forceMouseout).call(drag)};return d3.rebind(force,event,"on")};d3.layout.partition=function(){function position(node,x,dx,dy){var children=node.children;node.x=x;node.y=node.depth*dy;node.dx=dx;node.dy=dy;if(children&&(n=children.length)){var i=-1,n,c,d;dx=node.value?dx/node.value:0;while(++i<n){position(c=children[i],x,d=c.value*dx,dy);x+=d}}}function depth(node){var children=node.children,d=0;if(children&&(n=children.length)){var i=-1,n;while(++i<n){d=Math.max(d,depth(children[i]))}}return 1+d}function partition(d,i){var nodes=hierarchy.call(this,d,i);position(nodes[0],0,size[0],size[1]/depth(nodes[0]));return nodes}var hierarchy=d3.layout.hierarchy(),size=[1,1];partition.size=function(x){if(!arguments.length){return size}size=x;return partition};return d3_layout_hierarchyRebind(partition,hierarchy)};d3.layout.pie=function(){function pie(data,i){var values=data.map(function(d,i){return +value.call(pie,d,i)});var a=+(typeof startAngle==="function"?startAngle.apply(this,arguments):startAngle);var k=((typeof endAngle==="function"?endAngle.apply(this,arguments):endAngle)-startAngle)/d3.sum(values);var index=d3.range(data.length);if(sort!=null){index.sort(sort===d3_layout_pieSortByValue?function(i,j){return values[j]-values[i]}:function(i,j){return sort(data[i],data[j])})}var arcs=[];index.forEach(function(i){var d;arcs[i]={data:data[i],value:d=values[i],startAngle:a,endAngle:a+=d*k}});return arcs}var value=Number,sort=d3_layout_pieSortByValue,startAngle=0,endAngle=2*Math.PI;pie.value=function(x){if(!arguments.length){return value}value=x;return pie};pie.sort=function(x){if(!arguments.length){return sort}sort=x;return pie};pie.startAngle=function(x){if(!arguments.length){return startAngle}startAngle=x;return pie};pie.endAngle=function(x){if(!arguments.length){return endAngle}endAngle=x;return pie};return pie};var d3_layout_pieSortByValue={};d3.layout.stack=function(){function stack(data,index){var series=data.map(function(d,i){return values.call(stack,d,i)});var points=series.map(function(d,i){return d.map(function(v,i){return[x.call(stack,v,i),y.call(stack,v,i)]})});var orders=order.call(stack,points,index);series=d3.permute(series,orders);points=d3.permute(points,orders);var offsets=offset.call(stack,points,index);var n=series.length,m=series[0].length,i,j,o;for(j=0;j<m;++j){out.call(stack,series[0][j],o=offsets[j],points[0][j][1]);for(i=1;i<n;++i){out.call(stack,series[i][j],o+=points[i-1][j][1],points[i][j][1])}}return data}var values=d3_identity,order=d3_layout_stackOrderDefault,offset=d3_layout_stackOffsetZero,out=d3_layout_stackOut,x=d3_layout_stackX,y=d3_layout_stackY;stack.values=function(x){if(!arguments.length){return values}values=x;return stack};stack.order=function(x){if(!arguments.length){return order}order=typeof x==="function"?x:d3_layout_stackOrders.get(x)||d3_layout_stackOrderDefault;return stack};stack.offset=function(x){if(!arguments.length){return offset}offset=typeof x==="function"?x:d3_layout_stackOffsets.get(x)||d3_layout_stackOffsetZero;return stack};stack.x=function(z){if(!arguments.length){return x}x=z;return stack};stack.y=function(z){if(!arguments.length){return y}y=z;return stack};stack.out=function(z){if(!arguments.length){return out}out=z;return stack};return stack};var d3_layout_stackOrders=d3.map({"inside-out":function(data){var n=data.length,i,j,max=data.map(d3_layout_stackMaxIndex),sums=data.map(d3_layout_stackReduceSum),index=d3.range(n).sort(function(a,b){return max[a]-max[b]}),top=0,bottom=0,tops=[],bottoms=[];for(i=0;i<n;++i){j=index[i];if(top<bottom){top+=sums[j];tops.push(j)}else{bottom+=sums[j];bottoms.push(j)}}return bottoms.reverse().concat(tops)},reverse:function(data){return d3.range(data.length).reverse()},"default":d3_layout_stackOrderDefault});var d3_layout_stackOffsets=d3.map({silhouette:function(data){var n=data.length,m=data[0].length,sums=[],max=0,i,j,o,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<n;i++){o+=data[i][j][1]}if(o>max){max=o}sums.push(o)}for(j=0;j<m;++j){y0[j]=(max-sums[j])/2}return y0},wiggle:function(data){var n=data.length,x=data[0],m=x.length,max=0,i,j,k,s1,s2,s3,dx,o,o0,y0=[];y0[0]=o=o0=0;for(j=1;j<m;++j){for(i=0,s1=0;i<n;++i){s1+=data[i][j][1]}for(i=0,s2=0,dx=x[j][0]-x[j-1][0];i<n;++i){for(k=0,s3=(data[i][j][1]-data[i][j-1][1])/(2*dx);k<i;++k){s3+=(data[k][j][1]-data[k][j-1][1])/dx}s2+=s3*data[i][j][1]}y0[j]=o-=s1?s2/s1*dx:0;if(o<o0){o0=o}}for(j=0;j<m;++j){y0[j]-=o0}return y0},expand:function(data){var n=data.length,m=data[0].length,k=1/n,i,j,o,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<n;i++){o+=data[i][j][1]}if(o){for(i=0;i<n;i++){data[i][j][1]/=o}}else{for(i=0;i<n;i++){data[i][j][1]=k}}}for(j=0;j<m;++j){y0[j]=0}return y0},zero:d3_layout_stackOffsetZero});d3.layout.histogram=function(){function histogram(data,i){var bins=[],values=data.map(valuer,this),range=ranger.call(this,values,i),thresholds=binner.call(this,range,values,i),bin,i=-1,n=values.length,m=thresholds.length-1,k=frequency?1:1/n,x;while(++i<m){bin=bins[i]=[];bin.dx=thresholds[i+1]-(bin.x=thresholds[i]);bin.y=0}if(m>0){i=-1;while(++i<n){x=values[i];if(x>=range[0]&&x<=range[1]){bin=bins[d3.bisect(thresholds,x,1,m)-1];bin.y+=k;bin.push(data[i])}}}return bins}var frequency=true,valuer=Number,ranger=d3_layout_histogramRange,binner=d3_layout_histogramBinSturges;histogram.value=function(x){if(!arguments.length){return valuer}valuer=x;return histogram};histogram.range=function(x){if(!arguments.length){return ranger}ranger=d3_functor(x);return histogram};histogram.bins=function(x){if(!arguments.length){return binner}binner=typeof x==="number"?function(range){return d3_layout_histogramBinFixed(range,x)}:d3_functor(x);return histogram};histogram.frequency=function(x){if(!arguments.length){return frequency}frequency=!!x;return histogram};return histogram};d3.layout.hierarchy=function(){function recurse(data,depth,nodes){var childs=children.call(hierarchy,data,depth),node=d3_layout_hierarchyInline?data:{data:data};node.depth=depth;nodes.push(node);if(childs&&(n=childs.length)){var i=-1,n,c=node.children=[],v=0,j=depth+1,d;while(++i<n){d=recurse(childs[i],j,nodes);d.parent=node;c.push(d);v+=d.value}if(sort){c.sort(sort)}if(value){node.value=v}}else{if(value){node.value=+value.call(hierarchy,data,depth)||0}}return node}function revalue(node,depth){var children=node.children,v=0;if(children&&(n=children.length)){var i=-1,n,j=depth+1;while(++i<n){v+=revalue(children[i],j)}}else{if(value){v=+value.call(hierarchy,d3_layout_hierarchyInline?node:node.data,depth)||0}}if(value){node.value=v}return v}function hierarchy(d){var nodes=[];recurse(d,0,nodes);return nodes}var sort=d3_layout_hierarchySort,children=d3_layout_hierarchyChildren,value=d3_layout_hierarchyValue;hierarchy.sort=function(x){if(!arguments.length){return sort}sort=x;return hierarchy};hierarchy.children=function(x){if(!arguments.length){return children}children=x;return hierarchy};hierarchy.value=function(x){if(!arguments.length){return value}value=x;return hierarchy};hierarchy.revalue=function(root){revalue(root,0);return root};return hierarchy};var d3_layout_hierarchyInline=false;d3.layout.pack=function(){function pack(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0];root.x=0;root.y=0;d3_layout_treeVisitAfter(root,function(d){d.r=Math.sqrt(d.value)});d3_layout_treeVisitAfter(root,d3_layout_packSiblings);var w=size[0],h=size[1],k=Math.max(2*root.r/w,2*root.r/h);if(padding>0){var dr=padding*k/2;d3_layout_treeVisitAfter(root,function(d){d.r+=dr});d3_layout_treeVisitAfter(root,d3_layout_packSiblings);d3_layout_treeVisitAfter(root,function(d){d.r-=dr});k=Math.max(2*root.r/w,2*root.r/h)}d3_layout_packTransform(root,w/2,h/2,1/k);return nodes}var hierarchy=d3.layout.hierarchy().sort(d3_layout_packSort),padding=0,size=[1,1];pack.size=function(x){if(!arguments.length){return size}size=x;return pack};pack.padding=function(_){if(!arguments.length){return padding}padding=+_;return pack};return d3_layout_hierarchyRebind(pack,hierarchy)};d3.layout.cluster=function(){function cluster(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0],previousNode,x=0,kx,ky;d3_layout_treeVisitAfter(root,function(node){var children=node.children;if(children&&children.length){node.x=d3_layout_clusterX(children);node.y=d3_layout_clusterY(children)}else{node.x=previousNode?x+=separation(node,previousNode):0;node.y=0;previousNode=node}});var left=d3_layout_clusterLeft(root),right=d3_layout_clusterRight(root),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2;d3_layout_treeVisitAfter(root,function(node){node.x=(node.x-x0)/(x1-x0)*size[0];node.y=(1-(root.y?node.y/root.y:1))*size[1]});return nodes}var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1];cluster.separation=function(x){if(!arguments.length){return separation}separation=x;return cluster};cluster.size=function(x){if(!arguments.length){return size}size=x;return cluster};return d3_layout_hierarchyRebind(cluster,hierarchy)};d3.layout.tree=function(){function tree(d,i){function firstWalk(node,previousSibling){var children=node.children,layout=node._tree;if(children&&(n=children.length)){var n,firstChild=children[0],previousChild,ancestor=firstChild,child,i=-1;while(++i<n){child=children[i];firstWalk(child,previousChild);ancestor=apportion(child,previousChild,ancestor);previousChild=child}d3_layout_treeShift(node);var midpoint=0.5*(firstChild._tree.prelim+child._tree.prelim);if(previousSibling){layout.prelim=previousSibling._tree.prelim+separation(node,previousSibling);layout.mod=layout.prelim-midpoint}else{layout.prelim=midpoint}}else{if(previousSibling){layout.prelim=previousSibling._tree.prelim+separation(node,previousSibling)}}}function secondWalk(node,x){node.x=node._tree.prelim+x;var children=node.children;if(children&&(n=children.length)){var i=-1,n;x+=node._tree.mod;while(++i<n){secondWalk(children[i],x)}}}function apportion(node,previousSibling,ancestor){if(previousSibling){var vip=node,vop=node,vim=previousSibling,vom=node.parent.children[0],sip=vip._tree.mod,sop=vop._tree.mod,sim=vim._tree.mod,som=vom._tree.mod,shift;while(vim=d3_layout_treeRight(vim),vip=d3_layout_treeLeft(vip),vim&&vip){vom=d3_layout_treeLeft(vom);vop=d3_layout_treeRight(vop);vop._tree.ancestor=node;shift=vim._tree.prelim+sim-vip._tree.prelim-sip+separation(vim,vip);if(shift>0){d3_layout_treeMove(d3_layout_treeAncestor(vim,node,ancestor),node,shift);sip+=shift;sop+=shift}sim+=vim._tree.mod;sip+=vip._tree.mod;som+=vom._tree.mod;sop+=vop._tree.mod}if(vim&&!d3_layout_treeRight(vop)){vop._tree.thread=vim;vop._tree.mod+=sim-sop}if(vip&&!d3_layout_treeLeft(vom)){vom._tree.thread=vip;vom._tree.mod+=sip-som;ancestor=node}}return ancestor}var nodes=hierarchy.call(this,d,i),root=nodes[0];d3_layout_treeVisitAfter(root,function(node,previousSibling){node._tree={ancestor:node,prelim:0,mod:0,change:0,shift:0,number:previousSibling?previousSibling._tree.number+1:0}});firstWalk(root);secondWalk(root,-root._tree.prelim);var left=d3_layout_treeSearch(root,d3_layout_treeLeftmost),right=d3_layout_treeSearch(root,d3_layout_treeRightmost),deep=d3_layout_treeSearch(root,d3_layout_treeDeepest),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2,y1=deep.depth||1;d3_layout_treeVisitAfter(root,function(node){node.x=(node.x-x0)/(x1-x0)*size[0];node.y=node.depth/y1*size[1];delete node._tree});return nodes}var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1];tree.separation=function(x){if(!arguments.length){return separation}separation=x;return tree};tree.size=function(x){if(!arguments.length){return size}size=x;return tree};return d3_layout_hierarchyRebind(tree,hierarchy)};d3.layout.treemap=function(){function scale(children,k){var i=-1,n=children.length,child,area;while(++i<n){area=(child=children[i]).value*(k<0?0:k);child.area=isNaN(area)||area<=0?0:area}}function squarify(node){var children=node.children;if(children&&children.length){var rect=pad(node),row=[],remaining=children.slice(),child,best=Infinity,score,u=Math.min(rect.dx,rect.dy),n;scale(remaining,rect.dx*rect.dy/node.value);row.area=0;while((n=remaining.length)>0){row.push(child=remaining[n-1]);row.area+=child.area;if((score=worst(row,u))<=best){remaining.pop();best=score}else{row.area-=row.pop().area;position(row,u,rect,false);u=Math.min(rect.dx,rect.dy);row.length=row.area=0;best=Infinity}}if(row.length){position(row,u,rect,true);row.length=row.area=0}children.forEach(squarify)}}function stickify(node){var children=node.children;if(children&&children.length){var rect=pad(node),remaining=children.slice(),child,row=[];scale(remaining,rect.dx*rect.dy/node.value);row.area=0;while(child=remaining.pop()){row.push(child);row.area+=child.area;if(child.z!=null){position(row,child.z?rect.dx:rect.dy,rect,!remaining.length);row.length=row.area=0}}children.forEach(stickify)}}function worst(row,u){var s=row.area,r,rmax=0,rmin=Infinity,i=-1,n=row.length;while(++i<n){if(!(r=row[i].area)){continue}if(r<rmin){rmin=r}if(r>rmax){rmax=r}}s*=s;u*=u;return s?Math.max(u*rmax*ratio/s,s/(u*rmin*ratio)):Infinity}function position(row,u,rect,flush){var i=-1,n=row.length,x=rect.x,y=rect.y,v=u?round(row.area/u):0,o;if(u==rect.dx){if(flush||v>rect.dy){v=rect.dy}while(++i<n){o=row[i];o.x=x;o.y=y;o.dy=v;x+=o.dx=Math.min(rect.x+rect.dx-x,v?round(o.area/v):0)}o.z=true;o.dx+=rect.x+rect.dx-x;rect.y+=v;rect.dy-=v}else{if(flush||v>rect.dx){v=rect.dx}while(++i<n){o=row[i];o.x=x;o.y=y;o.dx=v;y+=o.dy=Math.min(rect.y+rect.dy-y,v?round(o.area/v):0)}o.z=false;o.dy+=rect.y+rect.dy-y;rect.x+=v;rect.dx-=v}}function treemap(d){var nodes=stickies||hierarchy(d),root=nodes[0];root.x=0;root.y=0;root.dx=size[0];root.dy=size[1];if(stickies){hierarchy.revalue(root)}scale([root],root.dx*root.dy/root.value);(stickies?stickify:squarify)(root);if(sticky){stickies=nodes}return nodes}var hierarchy=d3.layout.hierarchy(),round=Math.round,size=[1,1],padding=null,pad=d3_layout_treemapPadNull,sticky=false,stickies,ratio=0.5*(1+Math.sqrt(5));treemap.size=function(x){if(!arguments.length){return size}size=x;return treemap};treemap.padding=function(x){function padFunction(node){var p=x.call(treemap,node,node.depth);return p==null?d3_layout_treemapPadNull(node):d3_layout_treemapPad(node,typeof p==="number"?[p,p,p,p]:p)}function padConstant(node){return d3_layout_treemapPad(node,x)}if(!arguments.length){return padding}var type;pad=(padding=x)==null?d3_layout_treemapPadNull:(type=typeof x)==="function"?padFunction:type==="number"?(x=[x,x,x,x],padConstant):padConstant;return treemap};treemap.round=function(x){if(!arguments.length){return round!=Number}round=x?Math.round:Number;return treemap};treemap.sticky=function(x){if(!arguments.length){return sticky}sticky=x;stickies=null;return treemap};treemap.ratio=function(x){if(!arguments.length){return ratio}ratio=x;return treemap};return d3_layout_hierarchyRebind(treemap,hierarchy)};d3.csv=d3_dsv(",","text/csv");d3.tsv=d3_dsv("	","text/tab-separated-values");d3.geo={};var d3_geo_radians=Math.PI/180;d3.geo.azimuthal=function(){function azimuthal(coordinates){var x1=coordinates[0]*d3_geo_radians-x0,y1=coordinates[1]*d3_geo_radians,cx1=Math.cos(x1),sx1=Math.sin(x1),cy1=Math.cos(y1),sy1=Math.sin(y1),cc=mode!=="orthographic"?sy0*sy1+cy0*cy1*cx1:null,c,k=mode==="stereographic"?1/(1+cc):mode==="gnomonic"?1/cc:mode==="equidistant"?(c=Math.acos(cc),c?c/Math.sin(c):0):mode==="equalarea"?Math.sqrt(2/(1+cc)):1,x=k*cy1*sx1,y=k*(sy0*cy1*cx1-cy0*sy1);return[scale*x+translate[0],scale*y+translate[1]]}var mode="orthographic",origin,scale=200,translate=[480,250],x0,y0,cy0,sy0;azimuthal.invert=function(coordinates){var x=(coordinates[0]-translate[0])/scale,y=(coordinates[1]-translate[1])/scale,p=Math.sqrt(x*x+y*y),c=mode==="stereographic"?2*Math.atan(p):mode==="gnomonic"?Math.atan(p):mode==="equidistant"?p:mode==="equalarea"?2*Math.asin(0.5*p):Math.asin(p),sc=Math.sin(c),cc=Math.cos(c);return[(x0+Math.atan2(x*sc,p*cy0*cc+y*sy0*sc))/d3_geo_radians,Math.asin(cc*sy0-(p?y*sc*cy0/p:0))/d3_geo_radians]};azimuthal.mode=function(x){if(!arguments.length){return mode}mode=x+"";return azimuthal};azimuthal.origin=function(x){if(!arguments.length){return origin}origin=x;x0=origin[0]*d3_geo_radians;y0=origin[1]*d3_geo_radians;cy0=Math.cos(y0);sy0=Math.sin(y0);return azimuthal};azimuthal.scale=function(x){if(!arguments.length){return scale}scale=+x;return azimuthal};azimuthal.translate=function(x){if(!arguments.length){return translate}translate=[+x[0],+x[1]];return azimuthal};return azimuthal.origin([0,0])};d3.geo.albers=function(){function albers(coordinates){var t=n*(d3_geo_radians*coordinates[0]-lng0),p=Math.sqrt(C-2*n*Math.sin(d3_geo_radians*coordinates[1]))/n;return[scale*p*Math.sin(t)+translate[0],scale*(p*Math.cos(t)-p0)+translate[1]]}function reload(){var phi1=d3_geo_radians*parallels[0],phi2=d3_geo_radians*parallels[1],lat0=d3_geo_radians*origin[1],s=Math.sin(phi1),c=Math.cos(phi1);lng0=d3_geo_radians*origin[0];n=0.5*(s+Math.sin(phi2));C=c*c+2*n*s;p0=Math.sqrt(C-2*n*Math.sin(lat0))/n;return albers}var origin=[-98,38],parallels=[29.5,45.5],scale=1000,translate=[480,250],lng0,n,C,p0;albers.invert=function(coordinates){var x=(coordinates[0]-translate[0])/scale,y=(coordinates[1]-translate[1])/scale,p0y=p0+y,t=Math.atan2(x,p0y),p=Math.sqrt(x*x+p0y*p0y);return[(lng0+t/n)/d3_geo_radians,Math.asin((C-p*p*n*n)/(2*n))/d3_geo_radians]};albers.origin=function(x){if(!arguments.length){return origin}origin=[+x[0],+x[1]];return reload()};albers.parallels=function(x){if(!arguments.length){return parallels}parallels=[+x[0],+x[1]];return reload()};albers.scale=function(x){if(!arguments.length){return scale}scale=+x;return albers};albers.translate=function(x){if(!arguments.length){return translate}translate=[+x[0],+x[1]];return albers};return reload()};d3.geo.albersUsa=function(){function albersUsa(coordinates){var lon=coordinates[0],lat=coordinates[1];return(lat>50?alaska:lon<-140?hawaii:lat<21?puertoRico:lower48)(coordinates)}var lower48=d3.geo.albers();var alaska=d3.geo.albers().origin([-160,60]).parallels([55,65]);var hawaii=d3.geo.albers().origin([-160,20]).parallels([8,18]);var puertoRico=d3.geo.albers().origin([-60,10]).parallels([8,18]);albersUsa.scale=function(x){if(!arguments.length){return lower48.scale()}lower48.scale(x);alaska.scale(x*0.6);hawaii.scale(x);puertoRico.scale(x*1.5);return albersUsa.translate(lower48.translate())};albersUsa.translate=function(x){if(!arguments.length){return lower48.translate()}var dz=lower48.scale()/1000,dx=x[0],dy=x[1];lower48.translate(x);alaska.translate([dx-400*dz,dy+170*dz]);hawaii.translate([dx-190*dz,dy+200*dz]);puertoRico.translate([dx+580*dz,dy+430*dz]);return albersUsa};return albersUsa.scale(lower48.scale())};d3.geo.bonne=function(){function bonne(coordinates){var x=coordinates[0]*d3_geo_radians-x0,y=coordinates[1]*d3_geo_radians-y0;if(y1){var p=c1+y1-y,E=x*Math.cos(y)/p;x=p*Math.sin(E);y=p*Math.cos(E)-c1}else{x*=Math.cos(y);y*=-1}return[scale*x+translate[0],scale*y+translate[1]]}var scale=200,translate=[480,250],x0,y0,y1,c1;bonne.invert=function(coordinates){var x=(coordinates[0]-translate[0])/scale,y=(coordinates[1]-translate[1])/scale;if(y1){var c=c1+y,p=Math.sqrt(x*x+c*c);y=c1+y1-p;x=x0+p*Math.atan2(x,c)/Math.cos(y)}else{y*=-1;x/=Math.cos(y)}return[x/d3_geo_radians,y/d3_geo_radians]};bonne.parallel=function(x){if(!arguments.length){return y1/d3_geo_radians}c1=1/Math.tan(y1=x*d3_geo_radians);return bonne};bonne.origin=function(x){if(!arguments.length){return[x0/d3_geo_radians,y0/d3_geo_radians]}x0=x[0]*d3_geo_radians;y0=x[1]*d3_geo_radians;return bonne};bonne.scale=function(x){if(!arguments.length){return scale}scale=+x;return bonne};bonne.translate=function(x){if(!arguments.length){return translate}translate=[+x[0],+x[1]];return bonne};return bonne.origin([0,0]).parallel(45)};d3.geo.equirectangular=function(){function equirectangular(coordinates){var x=coordinates[0]/360,y=-coordinates[1]/360;return[scale*x+translate[0],scale*y+translate[1]]}var scale=500,translate=[480,250];equirectangular.invert=function(coordinates){var x=(coordinates[0]-translate[0])/scale,y=(coordinates[1]-translate[1])/scale;return[360*x,-360*y]};equirectangular.scale=function(x){if(!arguments.length){return scale}scale=+x;return equirectangular};equirectangular.translate=function(x){if(!arguments.length){return translate}translate=[+x[0],+x[1]];return equirectangular};return equirectangular};d3.geo.mercator=function(){function mercator(coordinates){var x=coordinates[0]/360,y=-(Math.log(Math.tan(Math.PI/4+coordinates[1]*d3_geo_radians/2))/d3_geo_radians)/360;return[scale*x+translate[0],scale*Math.max(-0.5,Math.min(0.5,y))+translate[1]]}var scale=500,translate=[480,250];mercator.invert=function(coordinates){var x=(coordinates[0]-translate[0])/scale,y=(coordinates[1]-translate[1])/scale;return[360*x,2*Math.atan(Math.exp(-360*y*d3_geo_radians))/d3_geo_radians-90]};mercator.scale=function(x){if(!arguments.length){return scale}scale=+x;return mercator};mercator.translate=function(x){if(!arguments.length){return translate}translate=[+x[0],+x[1]];return mercator};return mercator};d3.geo.path=function(){function path(d,i){if(typeof pointRadius==="function"){pointCircle=d3_path_circle(pointRadius.apply(this,arguments))}pathType(d);var result=buffer.length?buffer.join(""):null;buffer=[];return result}function project(coordinates){return projection(coordinates).join(",")}function polygonArea(coordinates){var sum=area(coordinates[0]),i=0,n=coordinates.length;while(++i<n){sum-=area(coordinates[i])}return sum}function polygonCentroid(coordinates){var polygon=d3.geom.polygon(coordinates[0].map(projection)),area=polygon.area(),centroid=polygon.centroid(area<0?(area*=-1,1):-1),x=centroid[0],y=centroid[1],z=area,i=0,n=coordinates.length;while(++i<n){polygon=d3.geom.polygon(coordinates[i].map(projection));area=polygon.area();centroid=polygon.centroid(area<0?(area*=-1,1):-1);x-=centroid[0];y-=centroid[1];z-=area}return[x,y,6*z]}function area(coordinates){return Math.abs(d3.geom.polygon(coordinates.map(projection)).area())}var pointRadius=4.5,pointCircle=d3_path_circle(pointRadius),projection=d3.geo.albersUsa(),buffer=[];var pathType=d3_geo_type({FeatureCollection:function(o){var features=o.features,i=-1,n=features.length;while(++i<n){buffer.push(pathType(features[i].geometry))}},Feature:function(o){pathType(o.geometry)},Point:function(o){buffer.push("M",project(o.coordinates),pointCircle)},MultiPoint:function(o){var coordinates=o.coordinates,i=-1,n=coordinates.length;while(++i<n){buffer.push("M",project(coordinates[i]),pointCircle)}},LineString:function(o){var coordinates=o.coordinates,i=-1,n=coordinates.length;buffer.push("M");while(++i<n){buffer.push(project(coordinates[i]),"L")}buffer.pop()},MultiLineString:function(o){var coordinates=o.coordinates,i=-1,n=coordinates.length,subcoordinates,j,m;while(++i<n){subcoordinates=coordinates[i];j=-1;m=subcoordinates.length;buffer.push("M");while(++j<m){buffer.push(project(subcoordinates[j]),"L")}buffer.pop()}},Polygon:function(o){var coordinates=o.coordinates,i=-1,n=coordinates.length,subcoordinates,j,m;while(++i<n){subcoordinates=coordinates[i];j=-1;if((m=subcoordinates.length-1)>0){buffer.push("M");while(++j<m){buffer.push(project(subcoordinates[j]),"L")}buffer[buffer.length-1]="Z"}}},MultiPolygon:function(o){var coordinates=o.coordinates,i=-1,n=coordinates.length,subcoordinates,j,m,subsubcoordinates,k,p;while(++i<n){subcoordinates=coordinates[i];j=-1;m=subcoordinates.length;while(++j<m){subsubcoordinates=subcoordinates[j];k=-1;if((p=subsubcoordinates.length-1)>0){buffer.push("M");while(++k<p){buffer.push(project(subsubcoordinates[k]),"L")}buffer[buffer.length-1]="Z"}}}},GeometryCollection:function(o){var geometries=o.geometries,i=-1,n=geometries.length;while(++i<n){buffer.push(pathType(geometries[i]))}}});var areaType=path.area=d3_geo_type({FeatureCollection:function(o){var area=0,features=o.features,i=-1,n=features.length;while(++i<n){area+=areaType(features[i])}return area},Feature:function(o){return areaType(o.geometry)},Polygon:function(o){return polygonArea(o.coordinates)},MultiPolygon:function(o){var sum=0,coordinates=o.coordinates,i=-1,n=coordinates.length;while(++i<n){sum+=polygonArea(coordinates[i])}return sum},GeometryCollection:function(o){var sum=0,geometries=o.geometries,i=-1,n=geometries.length;while(++i<n){sum+=areaType(geometries[i])}return sum}},0);var centroidType=path.centroid=d3_geo_type({Feature:function(o){return centroidType(o.geometry)},Polygon:function(o){var centroid=polygonCentroid(o.coordinates);return[centroid[0]/centroid[2],centroid[1]/centroid[2]]},MultiPolygon:function(o){var area=0,coordinates=o.coordinates,centroid,x=0,y=0,z=0,i=-1,n=coordinates.length;while(++i<n){centroid=polygonCentroid(coordinates[i]);x+=centroid[0];y+=centroid[1];z+=centroid[2]}return[x/z,y/z]}});path.projection=function(x){projection=x;return path};path.pointRadius=function(x){if(typeof x==="function"){pointRadius=x}else{pointRadius=+x;pointCircle=d3_path_circle(pointRadius)}return path};return path};d3.geo.bounds=function(feature){var left=Infinity,bottom=Infinity,right=-Infinity,top=-Infinity;d3_geo_bounds(feature,function(x,y){if(x<left){left=x}if(x>right){right=x}if(y<bottom){bottom=y}if(y>top){top=y}});return[[left,bottom],[right,top]]};var d3_geo_boundsTypes={Feature:d3_geo_boundsFeature,FeatureCollection:d3_geo_boundsFeatureCollection,GeometryCollection:d3_geo_boundsGeometryCollection,LineString:d3_geo_boundsLineString,MultiLineString:d3_geo_boundsMultiLineString,MultiPoint:d3_geo_boundsLineString,MultiPolygon:d3_geo_boundsMultiPolygon,Point:d3_geo_boundsPoint,Polygon:d3_geo_boundsPolygon};d3.geo.circle=function(){function circle(){}function visible(point){return arc.distance(point)<radians}function clip(coordinates){var i=-1,n=coordinates.length,clipped=[],p0,p1,p2,d0,d1;while(++i<n){d1=arc.distance(p2=coordinates[i]);if(d1<radians){if(p1){clipped.push(d3_geo_greatArcInterpolate(p1,p2)((d0-radians)/(d0-d1)))}clipped.push(p2);p0=p1=null}else{p1=p2;if(!p0&&clipped.length){clipped.push(d3_geo_greatArcInterpolate(clipped[clipped.length-1],p1)((radians-d0)/(d1-d0)));p0=p1}}d0=d1}p0=coordinates[0];p1=clipped[0];if(p1&&p2[0]===p0[0]&&p2[1]===p0[1]&&!(p2[0]===p1[0]&&p2[1]===p1[1])){clipped.push(p1)}return resample(clipped)}function resample(coordinates){var i=0,n=coordinates.length,j,m,resampled=n?[coordinates[0]]:coordinates,resamples,origin=arc.source();while(++i<n){resamples=arc.source(coordinates[i-1])(coordinates[i]).coordinates;for(j=0,m=resamples.length;++j<m;){resampled.push(resamples[j])}}arc.source(origin);return resampled}var origin=[0,0],degrees=90-0.01,radians=degrees*d3_geo_radians,arc=d3.geo.greatArc().source(origin).target(d3_identity);circle.clip=function(d){if(typeof origin==="function"){arc.source(origin.apply(this,arguments))}return clipType(d)||null};var clipType=d3_geo_type({FeatureCollection:function(o){var features=o.features.map(clipType).filter(d3_identity);return features&&(o=Object.create(o),o.features=features,o)},Feature:function(o){var geometry=clipType(o.geometry);return geometry&&(o=Object.create(o),o.geometry=geometry,o)},Point:function(o){return visible(o.coordinates)&&o},MultiPoint:function(o){var coordinates=o.coordinates.filter(visible);return coordinates.length&&{type:o.type,coordinates:coordinates}},LineString:function(o){var coordinates=clip(o.coordinates);return coordinates.length&&(o=Object.create(o),o.coordinates=coordinates,o)},MultiLineString:function(o){var coordinates=o.coordinates.map(clip).filter(function(d){return d.length});return coordinates.length&&(o=Object.create(o),o.coordinates=coordinates,o)},Polygon:function(o){var coordinates=o.coordinates.map(clip);return coordinates[0].length&&(o=Object.create(o),o.coordinates=coordinates,o)},MultiPolygon:function(o){var coordinates=o.coordinates.map(function(d){return d.map(clip)}).filter(function(d){return d[0].length});return coordinates.length&&(o=Object.create(o),o.coordinates=coordinates,o)},GeometryCollection:function(o){var geometries=o.geometries.map(clipType).filter(d3_identity);return geometries.length&&(o=Object.create(o),o.geometries=geometries,o)}});circle.origin=function(x){if(!arguments.length){return origin}origin=x;if(typeof origin!=="function"){arc.source(origin)}return circle};circle.angle=function(x){if(!arguments.length){return degrees}radians=(degrees=+x)*d3_geo_radians;return circle};return d3.rebind(circle,arc,"precision")};d3.geo.greatArc=function(){function greatArc(){var d=greatArc.distance.apply(this,arguments),t=0,dt=precision/d,coordinates=[p0];while((t+=dt)<1){coordinates.push(interpolate(t))}coordinates.push(p1);return{type:"LineString",coordinates:coordinates}}var source=d3_geo_greatArcSource,p0,target=d3_geo_greatArcTarget,p1,precision=6*d3_geo_radians,interpolate=d3_geo_greatArcInterpolator();greatArc.distance=function(){if(typeof source==="function"){interpolate.source(p0=source.apply(this,arguments))}if(typeof target==="function"){interpolate.target(p1=target.apply(this,arguments))}return interpolate.distance()};greatArc.source=function(_){if(!arguments.length){return source}source=_;if(typeof source!=="function"){interpolate.source(p0=source)}return greatArc};greatArc.target=function(_){if(!arguments.length){return target}target=_;if(typeof target!=="function"){interpolate.target(p1=target)}return greatArc};greatArc.precision=function(_){if(!arguments.length){return precision/d3_geo_radians}precision=_*d3_geo_radians;return greatArc};return greatArc};d3.geo.greatCircle=d3.geo.circle;d3.geom={};d3.geom.contour=function(grid,start){var s=start||d3_geom_contourStart(grid),c=[],x=s[0],y=s[1],dx=0,dy=0,pdx=NaN,pdy=NaN,i=0;do{i=0;if(grid(x-1,y-1)){i+=1}if(grid(x,y-1)){i+=2}if(grid(x-1,y)){i+=4}if(grid(x,y)){i+=8}if(i===6){dx=pdy===-1?-1:1;dy=0}else{if(i===9){dx=0;dy=pdx===1?-1:1}else{dx=d3_geom_contourDx[i];dy=d3_geom_contourDy[i]}}if(dx!=pdx&&dy!=pdy){c.push([x,y]);pdx=dx;pdy=dy}x+=dx;y+=dy}while(s[0]!=x||s[1]!=y);return c};var d3_geom_contourDx=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],d3_geom_contourDy=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(vertices){if(vertices.length<3){return[]}var len=vertices.length,plen=len-1,points=[],stack=[],i,j,h=0,x1,y1,x2,y2,u,v,a,sp;for(i=1;i<len;++i){if(vertices[i][1]<vertices[h][1]){h=i}else{if(vertices[i][1]==vertices[h][1]){h=vertices[i][0]<vertices[h][0]?i:h}}}for(i=0;i<len;++i){if(i===h){continue}y1=vertices[i][1]-vertices[h][1];x1=vertices[i][0]-vertices[h][0];points.push({angle:Math.atan2(y1,x1),index:i})}points.sort(function(a,b){return a.angle-b.angle});a=points[0].angle;v=points[0].index;u=0;for(i=1;i<plen;++i){j=points[i].index;if(a==points[i].angle){x1=vertices[v][0]-vertices[h][0];y1=vertices[v][1]-vertices[h][1];x2=vertices[j][0]-vertices[h][0];y2=vertices[j][1]-vertices[h][1];if(x1*x1+y1*y1>=x2*x2+y2*y2){points[i].index=-1}else{points[u].index=-1;a=points[i].angle;u=i;v=j}}else{a=points[i].angle;u=i;v=j}}stack.push(h);for(i=0,j=0;i<2;++j){if(points[j].index!==-1){stack.push(points[j].index);i++}}sp=stack.length;for(;j<plen;++j){if(points[j].index===-1){continue}while(!d3_geom_hullCCW(stack[sp-2],stack[sp-1],points[j].index,vertices)){--sp}stack[sp++]=points[j].index}var poly=[];for(i=0;i<sp;++i){poly.push(vertices[stack[i]])}return poly};d3.geom.polygon=function(coordinates){coordinates.area=function(){var i=0,n=coordinates.length,a=coordinates[n-1][0]*coordinates[0][1],b=coordinates[n-1][1]*coordinates[0][0];while(++i<n){a+=coordinates[i-1][0]*coordinates[i][1];b+=coordinates[i-1][1]*coordinates[i][0]}return(b-a)*0.5};coordinates.centroid=function(k){var i=-1,n=coordinates.length,x=0,y=0,a,b=coordinates[n-1],c;if(!arguments.length){k=-1/(6*coordinates.area())}while(++i<n){a=b;b=coordinates[i];c=a[0]*b[1]-b[0]*a[1];x+=(a[0]+b[0])*c;y+=(a[1]+b[1])*c}return[x*k,y*k]};coordinates.clip=function(subject){var input,i=-1,n=coordinates.length,j,m,a=coordinates[n-1],b,c,d;while(++i<n){input=subject.slice();subject.length=0;b=coordinates[i];c=input[(m=input.length)-1];j=-1;while(++j<m){d=input[j];if(d3_geom_polygonInside(d,a,b)){if(!d3_geom_polygonInside(c,a,b)){subject.push(d3_geom_polygonIntersect(c,d,a,b))}subject.push(d)}else{if(d3_geom_polygonInside(c,a,b)){subject.push(d3_geom_polygonIntersect(c,d,a,b))}}c=d}a=b}return subject};return coordinates};d3.geom.voronoi=function(vertices){var polygons=vertices.map(function(){return[]});d3_voronoi_tessellate(vertices,function(e){var s1,s2,x1,x2,y1,y2;if(e.a===1&&e.b>=0){s1=e.ep.r;s2=e.ep.l}else{s1=e.ep.l;s2=e.ep.r}if(e.a===1){y1=s1?s1.y:-1000000;x1=e.c-e.b*y1;y2=s2?s2.y:1000000;x2=e.c-e.b*y2}else{x1=s1?s1.x:-1000000;y1=e.c-e.a*x1;x2=s2?s2.x:1000000;y2=e.c-e.a*x2}var v1=[x1,y1],v2=[x2,y2];polygons[e.region.l.index].push(v1,v2);polygons[e.region.r.index].push(v1,v2)});return polygons.map(function(polygon,i){var cx=vertices[i][0],cy=vertices[i][1];polygon.forEach(function(v){v.angle=Math.atan2(v[0]-cx,v[1]-cy)});return polygon.sort(function(a,b){return a.angle-b.angle}).filter(function(d,i){return !i||d.angle-polygon[i-1].angle>1e-10})})};var d3_voronoi_opposite={l:"r",r:"l"};d3.geom.delaunay=function(vertices){var edges=vertices.map(function(){return[]}),triangles=[];d3_voronoi_tessellate(vertices,function(e){edges[e.region.l.index].push(vertices[e.region.r.index])});edges.forEach(function(edge,i){var v=vertices[i],cx=v[0],cy=v[1];edge.forEach(function(v){v.angle=Math.atan2(v[0]-cx,v[1]-cy)});edge.sort(function(a,b){return a.angle-b.angle});for(var j=0,m=edge.length-1;j<m;j++){triangles.push([v,edge[j],edge[j+1]])}});return triangles};d3.geom.quadtree=function(points,x1,y1,x2,y2){function insert(n,p,x1,y1,x2,y2){if(isNaN(p.x)||isNaN(p.y)){return}if(n.leaf){var v=n.point;if(v){if(Math.abs(v.x-p.x)+Math.abs(v.y-p.y)<0.01){insertChild(n,p,x1,y1,x2,y2)}else{n.point=null;insertChild(n,v,x1,y1,x2,y2);insertChild(n,p,x1,y1,x2,y2)}}else{n.point=p}}else{insertChild(n,p,x1,y1,x2,y2)}}function insertChild(n,p,x1,y1,x2,y2){var sx=(x1+x2)*0.5,sy=(y1+y2)*0.5,right=p.x>=sx,bottom=p.y>=sy,i=(bottom<<1)+right;n.leaf=false;n=n.nodes[i]||(n.nodes[i]=d3_geom_quadtreeNode());if(right){x1=sx}else{x2=sx}if(bottom){y1=sy}else{y2=sy}insert(n,p,x1,y1,x2,y2)}var p,i=-1,n=points.length;if(n&&isNaN(points[0].x)){points=points.map(d3_geom_quadtreePoint)}if(arguments.length<5){if(arguments.length===3){y2=x2=y1;y1=x1}else{x1=y1=Infinity;x2=y2=-Infinity;while(++i<n){p=points[i];if(p.x<x1){x1=p.x}if(p.y<y1){y1=p.y}if(p.x>x2){x2=p.x}if(p.y>y2){y2=p.y}}var dx=x2-x1,dy=y2-y1;if(dx>dy){y2=y1+dx}else{x2=x1+dy}}}var root=d3_geom_quadtreeNode();root.add=function(p){insert(root,p,x1,y1,x2,y2)};root.visit=function(f){d3_geom_quadtreeVisit(f,root,x1,y1,x2,y2)};points.forEach(root.add);return root};d3.time={};var d3_time=Date,d3_time_daySymbols=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];d3_time_utc.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){d3_time_prototype.setUTCDate.apply(this._,arguments)},setDay:function(){d3_time_prototype.setUTCDay.apply(this._,arguments)},setFullYear:function(){d3_time_prototype.setUTCFullYear.apply(this._,arguments)},setHours:function(){d3_time_prototype.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){d3_time_prototype.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){d3_time_prototype.setUTCMinutes.apply(this._,arguments)},setMonth:function(){d3_time_prototype.setUTCMonth.apply(this._,arguments)},setSeconds:function(){d3_time_prototype.setUTCSeconds.apply(this._,arguments)},setTime:function(){d3_time_prototype.setTime.apply(this._,arguments)}};var d3_time_prototype=Date.prototype;var d3_time_formatDateTime="%a %b %e %H:%M:%S %Y",d3_time_formatDate="%m/%d/%y",d3_time_formatTime="%H:%M:%S";var d3_time_days=d3_time_daySymbols,d3_time_dayAbbreviations=d3_time_days.map(d3_time_formatAbbreviate),d3_time_months=["January","February","March","April","May","June","July","August","September","October","November","December"],d3_time_monthAbbreviations=d3_time_months.map(d3_time_formatAbbreviate);d3.time.format=function(template){function format(date){var string=[],i=-1,j=0,c,f;while(++i<n){if(template.charCodeAt(i)==37){string.push(template.substring(j,i),(f=d3_time_formats[c=template.charAt(++i)])?f(date):c);j=i+1}}string.push(template.substring(j,i));return string.join("")}var n=template.length;format.parse=function(string){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},i=d3_time_parse(d,template,string,0);if(i!=string.length){return null}if("p" in d){d.H=d.H%12+d.p*12}var date=new d3_time;date.setFullYear(d.y,d.m,d.d);date.setHours(d.H,d.M,d.S,d.L);return date};format.toString=function(){return template};return format};var d3_time_zfill2=d3.format("02d"),d3_time_zfill3=d3.format("03d"),d3_time_zfill4=d3.format("04d"),d3_time_sfill2=d3.format("2d");var d3_time_dayRe=d3_time_formatRe(d3_time_days),d3_time_dayAbbrevRe=d3_time_formatRe(d3_time_dayAbbreviations),d3_time_monthRe=d3_time_formatRe(d3_time_months),d3_time_monthLookup=d3_time_formatLookup(d3_time_months),d3_time_monthAbbrevRe=d3_time_formatRe(d3_time_monthAbbreviations),d3_time_monthAbbrevLookup=d3_time_formatLookup(d3_time_monthAbbreviations);var d3_time_formats={a:function(d){return d3_time_dayAbbreviations[d.getDay()]},A:function(d){return d3_time_days[d.getDay()]},b:function(d){return d3_time_monthAbbreviations[d.getMonth()]},B:function(d){return d3_time_months[d.getMonth()]},c:d3.time.format(d3_time_formatDateTime),d:function(d){return d3_time_zfill2(d.getDate())},e:function(d){return d3_time_sfill2(d.getDate())},H:function(d){return d3_time_zfill2(d.getHours())},I:function(d){return d3_time_zfill2(d.getHours()%12||12)},j:function(d){return d3_time_zfill3(1+d3.time.dayOfYear(d))},L:function(d){return d3_time_zfill3(d.getMilliseconds())},m:function(d){return d3_time_zfill2(d.getMonth()+1)},M:function(d){return d3_time_zfill2(d.getMinutes())},p:function(d){return d.getHours()>=12?"PM":"AM"},S:function(d){return d3_time_zfill2(d.getSeconds())},U:function(d){return d3_time_zfill2(d3.time.sundayOfYear(d))},w:function(d){return d.getDay()},W:function(d){return d3_time_zfill2(d3.time.mondayOfYear(d))},x:d3.time.format(d3_time_formatDate),X:d3.time.format(d3_time_formatTime),y:function(d){return d3_time_zfill2(d.getFullYear()%100)},Y:function(d){return d3_time_zfill4(d.getFullYear()%10000)},Z:d3_time_zone,"%":function(d){return"%"}};var d3_time_parsers={a:d3_time_parseWeekdayAbbrev,A:d3_time_parseWeekday,b:d3_time_parseMonthAbbrev,B:d3_time_parseMonth,c:d3_time_parseLocaleFull,d:d3_time_parseDay,e:d3_time_parseDay,H:d3_time_parseHour24,I:d3_time_parseHour24,L:d3_time_parseMilliseconds,m:d3_time_parseMonthNumber,M:d3_time_parseMinutes,p:d3_time_parseAmPm,S:d3_time_parseSeconds,x:d3_time_parseLocaleDate,X:d3_time_parseLocaleTime,y:d3_time_parseYear,Y:d3_time_parseFullYear};var d3_time_numberRe=/^\s*\d+/;var d3_time_amPmLookup=d3.map({am:0,pm:1});d3.time.format.utc=function(template){function format(date){try{d3_time=d3_time_utc;var utc=new d3_time;utc._=date;return local(utc)}finally{d3_time=Date}}var local=d3.time.format(template);format.parse=function(string){try{d3_time=d3_time_utc;var date=local.parse(string);return date&&date._}finally{d3_time=Date}};format.toString=local.toString;return format};var d3_time_formatIso=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?d3_time_formatIsoNative:d3_time_formatIso;d3_time_formatIsoNative.parse=function(string){var date=new Date(string);return isNaN(date)?null:date};d3_time_formatIsoNative.toString=d3_time_formatIso.toString;d3.time.second=d3_time_interval(function(date){return new d3_time(Math.floor(date/1000)*1000)},function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*1000)},function(date){return date.getSeconds()});d3.time.seconds=d3.time.second.range;d3.time.seconds.utc=d3.time.second.utc.range;d3.time.minute=d3_time_interval(function(date){return new d3_time(Math.floor(date/60000)*60000)},function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*60000)},function(date){return date.getMinutes()});d3.time.minutes=d3.time.minute.range;d3.time.minutes.utc=d3.time.minute.utc.range;d3.time.hour=d3_time_interval(function(date){var timezone=date.getTimezoneOffset()/60;return new d3_time((Math.floor(date/3600000-timezone)+timezone)*3600000)},function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*3600000)},function(date){return date.getHours()});d3.time.hours=d3.time.hour.range;d3.time.hours.utc=d3.time.hour.utc.range;d3.time.day=d3_time_interval(function(date){var day=new d3_time(1970,0);day.setFullYear(date.getFullYear(),date.getMonth(),date.getDate());return day},function(date,offset){date.setDate(date.getDate()+offset)},function(date){return date.getDate()-1});d3.time.days=d3.time.day.range;d3.time.days.utc=d3.time.day.utc.range;d3.time.dayOfYear=function(date){var year=d3.time.year(date);return Math.floor((date-year-(date.getTimezoneOffset()-year.getTimezoneOffset())*60000)/86400000)};d3_time_daySymbols.forEach(function(day,i){day=day.toLowerCase();i=7-i;var interval=d3.time[day]=d3_time_interval(function(date){(date=d3.time.day(date)).setDate(date.getDate()-(date.getDay()+i)%7);return date},function(date,offset){date.setDate(date.getDate()+Math.floor(offset)*7)},function(date){var day=d3.time.year(date).getDay();return Math.floor((d3.time.dayOfYear(date)+(day+i)%7)/7)-(day!==i)});d3.time[day+"s"]=interval.range;d3.time[day+"s"].utc=interval.utc.range;d3.time[day+"OfYear"]=function(date){var day=d3.time.year(date).getDay();return Math.floor((d3.time.dayOfYear(date)+(day+i)%7)/7)}});d3.time.week=d3.time.sunday;d3.time.weeks=d3.time.sunday.range;d3.time.weeks.utc=d3.time.sunday.utc.range;d3.time.weekOfYear=d3.time.sundayOfYear;d3.time.month=d3_time_interval(function(date){date=d3.time.day(date);date.setDate(1);return date},function(date,offset){date.setMonth(date.getMonth()+offset)},function(date){return date.getMonth()});d3.time.months=d3.time.month.range;d3.time.months.utc=d3.time.month.utc.range;d3.time.year=d3_time_interval(function(date){date=d3.time.day(date);date.setMonth(0,1);return date},function(date,offset){date.setFullYear(date.getFullYear()+offset)},function(date){return date.getFullYear()});d3.time.years=d3.time.year.range;d3.time.years.utc=d3.time.year.utc.range;var d3_time_scaleSteps=[1000,5000,15000,30000,60000,300000,900000,1800000,3600000,10800000,21600000,43200000,86400000,172800000,604800000,2592000000,7776000000,31536000000];var d3_time_scaleLocalMethods=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]];var d3_time_scaleLocalFormats=[[d3.time.format("%Y"),function(d){return true}],[d3.time.format("%B"),function(d){return d.getMonth()}],[d3.time.format("%b %d"),function(d){return d.getDate()!=1}],[d3.time.format("%a %d"),function(d){return d.getDay()&&d.getDate()!=1}],[d3.time.format("%I %p"),function(d){return d.getHours()}],[d3.time.format("%I:%M"),function(d){return d.getMinutes()}],[d3.time.format(":%S"),function(d){return d.getSeconds()}],[d3.time.format(".%L"),function(d){return d.getMilliseconds()}]];var d3_time_scaleLinear=d3.scale.linear(),d3_time_scaleLocalFormat=d3_time_scaleFormat(d3_time_scaleLocalFormats);d3_time_scaleLocalMethods.year=function(extent,m){return d3_time_scaleLinear.domain(extent.map(d3_time_scaleGetYear)).ticks(m).map(d3_time_scaleSetYear)};d3.time.scale=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleLocalMethods,d3_time_scaleLocalFormat)};var d3_time_scaleUTCMethods=d3_time_scaleLocalMethods.map(function(m){return[m[0].utc,m[1]]});var d3_time_scaleUTCFormats=[[d3.time.format.utc("%Y"),function(d){return true}],[d3.time.format.utc("%B"),function(d){return d.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(d){return d.getUTCDate()!=1}],[d3.time.format.utc("%a %d"),function(d){return d.getUTCDay()&&d.getUTCDate()!=1}],[d3.time.format.utc("%I %p"),function(d){return d.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(d){return d.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(d){return d.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(d){return d.getUTCMilliseconds()}]];var d3_time_scaleUTCFormat=d3_time_scaleFormat(d3_time_scaleUTCFormats);d3_time_scaleUTCMethods.year=function(extent,m){return d3_time_scaleLinear.domain(extent.map(d3_time_scaleUTCGetYear)).ticks(m).map(d3_time_scaleUTCSetYear)};d3.time.scale.utc=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleUTCMethods,d3_time_scaleUTCFormat)}})();(function(){function e(e,t){try{for(var n in t){Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}}catch(r){e.prototype=t}}function t(e){var t=-1,n=e.length,r=[];while(++t<n){r.push(e[t])}return r}function n(e){return Array.prototype.slice.call(e)}function r(){}function i(e){return e}function s(){return this}function o(){return !0}function u(e){return typeof e=="function"?e:function(){return e}}function a(e,t,n){return function(){var r=n.apply(t,arguments);return arguments.length?e:r}}function f(e){return e!=null&&!isNaN(e)}function l(e){return e.length}function c(e){return e==null}function h(e){return e.trim().replace(/\s+/g," ")}function p(e){var t=1;while(e*t%1){t*=10}return t}function d(){}function v(e){function t(){var t=n,r=-1,i=t.length,s;while(++r<i){(s=t[r].on)&&s.apply(this,arguments)}return e}var n=[],i=new r;return t.on=function(t,r){var s=i.get(t),o;return arguments.length<2?s&&s.on:(s&&(s.on=null,n=n.slice(0,o=n.indexOf(s)).concat(n.slice(o+1)),i.remove(t)),r&&n.push(i.set(t,{on:r})),e)},t}function m(e,t){return t-(e?1+Math.floor(Math.log(e+Math.pow(10,1+Math.floor(Math.log(e)/Math.LN10)-t))/Math.LN10):1)}function g(e){return e+""}function y(e){var t=e.lastIndexOf("."),n=t>=0?e.substring(t):(t=e.length,""),r=[];while(t>0){r.push(e.substring(t-=3,t+3))}return r.reverse().join(",")+n}function b(e,t){var n=Math.pow(10,Math.abs(8-t)*3);return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function w(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function E(e){return function(t){return 1-e(1-t)}}function S(e){return function(t){return 0.5*(t<0.5?e(2*t):2-e(2-2*t))}}function x(e){return e}function T(e){return function(t){return Math.pow(t,e)}}function N(e){return 1-Math.cos(e*Math.PI/2)}function C(e){return Math.pow(2,10*(e-1))}function k(e){return 1-Math.sqrt(1-e*e)}function L(e,t){var n;return arguments.length<2&&(t=0.45),arguments.length<1?(e=1,n=t/4):n=t/(2*Math.PI)*Math.asin(1/e),function(r){return 1+e*Math.pow(2,10*-r)*Math.sin((r-n)*2*Math.PI/t)}}function A(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function O(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+0.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+0.9375:7.5625*(e-=2.625/2.75)*e+0.984375}function M(){d3.event.stopPropagation(),d3.event.preventDefault()}function _(){var e=d3.event,t;while(t=e.sourceEvent){e=t}return e}function D(e){var t=new d,n=0,r=arguments.length;while(++n<r){t[arguments[n]]=v(t)}return t.of=function(n,r){return function(i){try{var s=i.sourceEvent=d3.event;i.target=e,d3.event=i,t[i.type].apply(n,r)}finally{d3.event=s}}},t}function P(e){var t=[e.a,e.b],n=[e.c,e.d],r=B(t),i=H(t,n),s=B(j(n,t,-i))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*fs,this.translate=[e.e,e.f],this.scale=[r,s],this.skew=s?Math.atan2(i,s)*fs:0}function H(e,t){return e[0]*t[0]+e[1]*t[1]}function B(e){var t=Math.sqrt(H(e,e));return t&&(e[0]/=t,e[1]/=t),t}function j(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function F(e){return e=="transform"?d3.interpolateTransform:d3.interpolate}function I(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function q(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function R(e,t,n){return new U(e,t,n)}function U(e,t,n){this.r=e,this.g=t,this.b=n}function z(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function W(e,t,n){var r=0,i=0,s=0,o,u,a;o=/([a-z]+)\((.*)\)/i.exec(e);if(o){u=o[2].split(",");switch(o[1]){case"hsl":return n(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(J(u[0]),J(u[1]),J(u[2]))}}return(a=hs.get(e))?t(a.r,a.g,a.b):(e!=null&&e.charAt(0)==="#"&&(e.length===4?(r=e.charAt(1),r+=r,i=e.charAt(2),i+=i,s=e.charAt(3),s+=s):e.length===7&&(r=e.substring(1,3),i=e.substring(3,5),s=e.substring(5,7)),r=parseInt(r,16),i=parseInt(i,16),s=parseInt(s,16)),t(r,i,s))}function X(e,t,n){var r=Math.min(e/=255,t/=255,n/=255),i=Math.max(e,t,n),s=i-r,o,u,a=(i+r)/2;return s?(u=a<0.5?s/(i+r):s/(2-i-r),e==i?o=(t-n)/s+(t<n?6:0):t==i?o=(n-e)/s+2:o=(e-t)/s+4,o*=60):u=o=0,K(o,u,a)}function V(e,t,n){e=$(e),t=$(t),n=$(n);var r=ot((0.4124564*e+0.3575761*t+0.1804375*n)/ds),i=ot((0.2126729*e+0.7151522*t+0.072175*n)/vs),s=ot((0.0193339*e+0.119192*t+0.9503041*n)/ms);return tt(116*i-16,500*(r-i),200*(i-s))}function $(e){return(e/=255)<=0.04045?e/12.92:Math.pow((e+0.055)/1.055,2.4)}function J(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}function K(e,t,n){return new Q(e,t,n)}function Q(e,t,n){this.h=e,this.s=t,this.l=n}function G(e,t,n){function r(e){return e>360?e-=360:e<0&&(e+=360),e<60?s+(o-s)*e/60:e<180?o:e<240?s+(o-s)*(240-e)/60:s}function i(e){return Math.round(r(e)*255)}var s,o;return e%=360,e<0&&(e+=360),t=t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,o=n<=0.5?n*(1+t):n+t-n*t,s=2*n-o,R(i(e+120),i(e),i(e-120))}function Y(e,t,n){return new Z(e,t,n)}function Z(e,t,n){this.h=e,this.c=t,this.l=n}function et(e,t,n){return tt(n,Math.cos(e*=Math.PI/180)*t,Math.sin(e)*t)}function tt(e,t,n){return new nt(e,t,n)}function nt(e,t,n){this.l=e,this.a=t,this.b=n}function rt(e,t,n){var r=(e+16)/116,i=r+t/500,s=r-n/200;return i=st(i)*ds,r=st(r)*vs,s=st(s)*ms,R(ut(3.2404542*i-1.5371385*r-0.4985314*s),ut(-0.969266*i+1.8760108*r+0.041556*s),ut(0.0556434*i-0.2040259*r+1.0572252*s))}function it(e,t,n){return Y(Math.atan2(n,t)/Math.PI*180,Math.sqrt(t*t+n*n),e)}function st(e){return e>0.206893034?e*e*e:(e-4/29)/7.787037}function ot(e){return e>0.008856?Math.pow(e,1/3):7.787037*e+4/29}function ut(e){return Math.round(255*(e<=0.00304?12.92*e:1.055*Math.pow(e,1/2.4)-0.055))}function at(e){return Ki(e,Ss),e}function ft(e){return function(){return gs(e,this)}}function lt(e){return function(){return ys(e,this)}}function ct(e,t){function n(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function i(){this.setAttribute(e,t)}function s(){this.setAttributeNS(e.space,e.local,t)}function o(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}function u(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=d3.ns.qualify(e),t==null?e.local?r:n:typeof t=="function"?e.local?u:o:e.local?s:i}function ht(e){return new RegExp("(?:^|\\s+)"+d3.requote(e)+"(?:\\s+|$)","g")}function pt(e,t){function n(){var n=-1;while(++n<i){e[n](this,t)}}function r(){var n=-1,r=t.apply(this,arguments);while(++n<i){e[n](this,r)}}e=e.trim().split(/\s+/).map(dt);var i=e.length;return typeof t=="function"?r:n}function dt(e){var t=ht(e);return function(n,r){if(i=n.classList){return r?i.add(e):i.remove(e)}var i=n.className,s=i.baseVal!=null,o=s?i.baseVal:i;r?(t.lastIndex=0,t.test(o)||(o=h(o+" "+e),s?i.baseVal=o:n.className=o)):o&&(o=h(o.replace(t," ")),s?i.baseVal=o:n.className=o)}}function vt(e,t,n){function r(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,n)}function s(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return t==null?r:typeof t=="function"?s:i}function mt(e,t){function n(){delete this[e]}function r(){this[e]=t}function i(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}return t==null?n:typeof t=="function"?i:r}function gt(e){return{__data__:e}}function yt(e){return function(){return Es(this,e)}}function bt(e){return arguments.length||(e=d3.ascending),function(t,n){return e(t&&t.__data__,n&&n.__data__)}}function wt(e,t,n){function r(){var t=this[s];t&&(this.removeEventListener(e,t,t.$),delete this[s])}function i(){function i(e){var n=d3.event;d3.event=e,u[0]=o.__data__;try{t.apply(o,u)}finally{d3.event=n}}var o=this,u=arguments;r.call(this),this.addEventListener(e,this[s]=i,i.$=n),i._=t}var s="__on"+e,o=e.indexOf(".");return o>0&&(e=e.substring(0,o)),t?i:r}function Et(e,t){for(var n=0,r=e.length;n<r;n++){for(var i=e[n],s=0,o=i.length,u;s<o;s++){(u=i[s])&&t(u,s,n)}}return e}function St(e){return Ki(e,Ts),e}function xt(e,t,n){Ki(e,Ns);var i=new r,s=d3.dispatch("start","end"),o=Ds;return e.id=t,e.time=n,e.tween=function(t,n){return arguments.length<2?i.get(t):(n==null?i.remove(t):i.set(t,n),e)},e.ease=function(t){return arguments.length?(o=typeof t=="function"?t:d3.ease.apply(d3,arguments),e):o},e.each=function(t,n){return arguments.length<2?Tt.call(e,t):(s.on(t,n),e)},d3.timer(function(r){return Et(e,function(e,u,a){function f(r){return v.active>t?c():(v.active=t,i.forEach(function(t,n){(n=n.call(e,m,u))&&h.push(n)}),s.start.call(e,m,u),l(r)||d3.timer(l,0,n),1)}function l(n){if(v.active!==t){return c()}var r=(n-p)/d,i=o(r),a=h.length;while(a>0){h[--a].call(e,i)}if(r>=1){return c(),ks=t,s.end.call(e,m,u),ks=0,1}}function c(){return --v.count||delete e.__transition__,1}var h=[],p=e.delay,d=e.duration,v=(e=e.node).__transition__||(e.__transition__={active:0,count:0}),m=e.__data__;++v.count,p<=r?f(r):d3.timer(f,p,n)})},0,n),e}function Tt(e){var t=ks,n=Ds,r=Ms,i=_s;return ks=this.id,Ds=this.ease(),Et(this,function(t,n,r){Ms=t.delay,_s=t.duration,e.call(t=t.node,t.__data__,n,r)}),ks=t,Ds=n,Ms=r,_s=i,this}function Nt(e,t,n){return n!=""&&Ps}function Ct(e,t){return d3.tween(e,F(t))}function kt(){var e,t=Date.now(),n=Hs;while(n){e=t-n.then,e>=n.delay&&(n.flush=n.callback(e)),n=n.next}var r=Lt()-t;r>24?(isFinite(r)&&(clearTimeout(js),js=setTimeout(kt,r)),Bs=0):(Bs=1,Fs(kt))}function Lt(){var e=null,t=Hs,n=Infinity;while(t){t.flush?t=e?e.next=t.next:Hs=t.next:(n=Math.min(n,t.then+t.delay),t=(e=t).next)}return n}function At(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();if(Is<0&&(window.scrollX||window.scrollY)){n=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var i=n[0][0].getScreenCTM();Is=!i.f&&!i.e,n.remove()}return Is?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}function Ot(){}function Mt(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function _t(e){return e.rangeExtent?e.rangeExtent():Mt(e.range())}function Dt(e,t){var n=0,r=e.length-1,i=e[n],s=e[r],o;s<i&&(o=n,n=r,r=o,o=i,i=s,s=o);if(t=t(s-i)){e[n]=t.floor(i),e[r]=t.ceil(s)}return e}function Pt(){return Math}function Ht(e,t,n,r){function i(){var i=Math.min(e.length,t.length)>2?Ut:Rt,a=r?q:I;return o=i(e,t,a,n),u=i(t,e,a,d3.interpolate),s}function s(e){return o(e)}var o,u;return s.invert=function(e){return u(e)},s.domain=function(t){return arguments.length?(e=t.map(Number),i()):e},s.range=function(e){return arguments.length?(t=e,i()):t},s.rangeRound=function(e){return s.range(e).interpolate(d3.interpolateRound)},s.clamp=function(e){return arguments.length?(r=e,i()):r},s.interpolate=function(e){return arguments.length?(n=e,i()):n},s.ticks=function(t){return It(e,t)},s.tickFormat=function(t){return qt(e,t)},s.nice=function(){return Dt(e,jt),i()},s.copy=function(){return Ht(e,t,n,r)},i()}function Bt(e,t){return d3.rebind(e,t,"range","rangeRound","interpolate","clamp")}function jt(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),e&&{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}}function Ft(e,t){var n=Mt(e),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),s=t/r*i;return s<=0.15?i*=10:s<=0.35?i*=5:s<=0.75&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+i*0.5,n[2]=i,n}function It(e,t){return d3.range.apply(d3,Ft(e,t))}function qt(e,t){return d3.format(",."+Math.max(0,-Math.floor(Math.log(Ft(e,t)[2])/Math.LN10+0.01))+"f")}function Rt(e,t,n,r){var i=n(e[0],e[1]),s=r(t[0],t[1]);return function(e){return s(i(e))}}function Ut(e,t,n,r){var i=[],s=[],o=0,u=Math.min(e.length,t.length)-1;e[u]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());while(++o<=u){i.push(n(e[o-1],e[o])),s.push(r(t[o-1],t[o]))}return function(t){var n=d3.bisect(e,t,1,u)-1;return s[n](i[n](t))}}function zt(e,t){function n(n){return e(t(n))}var r=t.pow;return n.invert=function(t){return r(e.invert(t))},n.domain=function(i){return arguments.length?(t=i[0]<0?Xt:Wt,r=t.pow,e.domain(i.map(t)),n):e.domain().map(r)},n.nice=function(){return e.domain(Dt(e.domain(),Pt)),n},n.ticks=function(){var n=Mt(e.domain()),i=[];if(n.every(isFinite)){var s=Math.floor(n[0]),o=Math.ceil(n[1]),u=r(n[0]),a=r(n[1]);if(t===Xt){i.push(r(s));for(;s++<o;){for(var f=9;f>0;f--){i.push(r(s)*f)}}}else{for(;s<o;s++){for(var f=1;f<10;f++){i.push(r(s)*f)}}i.push(r(s))}for(s=0;i[s]<u;s++){}for(o=i.length;i[o-1]>a;o--){}i=i.slice(s,o)}return i},n.tickFormat=function(e,i){arguments.length<2&&(i=qs);if(arguments.length<1){return i}var s=Math.max(0.1,e/n.ticks().length),o=t===Xt?(u=-1e-12,Math.floor):(u=1e-12,Math.ceil),u;return function(e){return e/r(o(t(e)+u))<=s?i(e):""}},n.copy=function(){return zt(e.copy(),t)},Bt(n,e)}function Wt(e){return Math.log(e<0?0:e)/Math.LN10}function Xt(e){return -Math.log(e>0?0:-e)/Math.LN10}function Vt(e,t){function n(t){return e(r(t))}var r=$t(t),i=$t(1/t);return n.invert=function(t){return i(e.invert(t))},n.domain=function(t){return arguments.length?(e.domain(t.map(r)),n):e.domain().map(i)},n.ticks=function(e){return It(n.domain(),e)},n.tickFormat=function(e){return qt(n.domain(),e)},n.nice=function(){return n.domain(Dt(n.domain(),jt))},n.exponent=function(e){if(!arguments.length){return t}var s=n.domain();return r=$t(t=e),i=$t(1/t),n.domain(s)},n.copy=function(){return Vt(e.copy(),t)},Bt(n,e)}function $t(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Jt(e,t){function n(t){return o[((s.get(t)||s.set(t,e.push(t)))-1)%o.length]}function i(t,n){return d3.range(e.length).map(function(e){return t+n*e})}var s,o,u;return n.domain=function(i){if(!arguments.length){return e}e=[],s=new r;var o=-1,u=i.length,a;while(++o<u){s.has(a=i[o])||s.set(a,e.push(a))}return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(o=e,u=0,t={t:"range",a:arguments},n):o},n.rangePoints=function(r,s){arguments.length<2&&(s=0);var a=r[0],f=r[1],l=(f-a)/(Math.max(1,e.length-1)+s);return o=i(e.length<2?(a+f)/2:a+l*s/2,l),u=0,t={t:"rangePoints",a:arguments},n},n.rangeBands=function(r,s,a){arguments.length<2&&(s=0),arguments.length<3&&(a=s);var f=r[1]<r[0],l=r[f-0],c=r[1-f],h=(c-l)/(e.length-s+2*a);return o=i(l+h*a,h),f&&o.reverse(),u=h*(1-s),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,s,a){arguments.length<2&&(s=0),arguments.length<3&&(a=s);var f=r[1]<r[0],l=r[f-0],c=r[1-f],h=Math.floor((c-l)/(e.length-s+2*a)),p=c-l-(e.length-s)*h;return o=i(l+Math.round(p/2),h),f&&o.reverse(),u=Math.round(h*(1-s)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return u},n.rangeExtent=function(){return Mt(t.a[0])},n.copy=function(){return Jt(e,t)},n.domain(e)}function Kt(e,t){function n(){var n=0,s=e.length,o=t.length;i=[];while(++n<o){i[n-1]=d3.quantile(e,n/o)}return r}function r(e){return isNaN(e=+e)?NaN:t[d3.bisect(i,e)]}var i;return r.domain=function(t){return arguments.length?(e=t.filter(function(e){return !isNaN(e)}).sort(d3.ascending),n()):e},r.range=function(e){return arguments.length?(t=e,n()):t},r.quantiles=function(){return i},r.copy=function(){return Kt(e,t)},n()}function Qt(e,t,n){function r(t){return n[Math.max(0,Math.min(o,Math.floor(s*(t-e))))]}function i(){return s=n.length/(t-e),o=n.length-1,r}var s,o;return r.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],i()):[e,t]},r.range=function(e){return arguments.length?(n=e,i()):n},r.copy=function(){return Qt(e,t,n)},i()}function Gt(e,t){function n(n){return t[d3.bisect(e,n)]}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return Gt(e,t)},n}function Yt(e){function t(e){return +e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return It(e,t)},t.tickFormat=function(t){return qt(e,t)},t.copy=function(){return Yt(e)},t}function Zt(e){return e.innerRadius}function en(e){return e.outerRadius}function tn(e){return e.startAngle}function nn(e){return e.endAngle}function rn(e){function t(t){function o(){a.push("M",s(e(l),f))}var a=[],l=[],c=-1,h=t.length,p,d=u(n),v=u(r);while(++c<h){i.call(this,p=t[c],c)?l.push([+d.call(this,p,c),+v.call(this,p,c)]):l.length&&(o(),l=[])}return l.length&&o(),a.length?a.join(""):null}var n=sn,r=on,i=o,s=un,a=s.key,f=0.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(i=e,t):i},t.interpolate=function(e){return arguments.length?(typeof e=="function"?a=s=e:a=(s=$s.get(e)||un).key,t):a},t.tension=function(e){return arguments.length?(f=e,t):f},t}function sn(e){return e[0]}function on(e){return e[1]}function un(e){return e.join("L")}function an(e){return un(e)+"Z"}function fn(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n){i.push("V",(r=e[t])[1],"H",r[0])}return i.join("")}function ln(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n){i.push("H",(r=e[t])[0],"V",r[1])}return i.join("")}function cn(e,t){return e.length<4?un(e):e[1]+dn(e.slice(1,e.length-1),vn(e,t))}function hn(e,t){return e.length<3?un(e):e[0]+dn((e.push(e[0]),e),vn([e[e.length-2]].concat(e,[e[1]]),t))}function pn(e,t,n){return e.length<3?un(e):e[0]+dn(e,vn(e,t))}function dn(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2){return un(e)}var n=e.length!=t.length,r="",i=e[0],s=e[1],o=t[0],u=o,a=1;n&&(r+="Q"+(s[0]-o[0]*2/3)+","+(s[1]-o[1]*2/3)+","+s[0]+","+s[1],i=e[1],a=2);if(t.length>1){u=t[1],s=e[a],a++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1];for(var f=2;f<t.length;f++,a++){s=e[a],u=t[f],r+="S"+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1]}}if(n){var l=e[a];r+="Q"+(s[0]+u[0]*2/3)+","+(s[1]+u[1]*2/3)+","+l[0]+","+l[1]}return r}function vn(e,t){var n=[],r=(1-t)/2,i,s=e[0],o=e[1],u=1,a=e.length;while(++u<a){i=s,s=o,o=e[u],n.push([r*(o[0]-i[0]),r*(o[1]-i[1])])}return n}function mn(e){if(e.length<3){return un(e)}var t=1,n=e.length,r=e[0],i=r[0],s=r[1],o=[i,i,i,(r=e[1])[0]],u=[s,s,s,r[1]],a=[i,",",s];En(a,o,u);while(++t<n){r=e[t],o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),En(a,o,u)}t=-1;while(++t<2){o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),En(a,o,u)}return a.join("")}function gn(e){if(e.length<4){return un(e)}var t=[],n=-1,r=e.length,i,s=[0],o=[0];while(++n<3){i=e[n],s.push(i[0]),o.push(i[1])}t.push(wn(Qs,s)+","+wn(Qs,o)),--n;while(++n<r){i=e[n],s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),En(t,s,o)}return t.join("")}function yn(e){var t,n=-1,r=e.length,i=r+4,s,o=[],u=[];while(++n<4){s=e[n%r],o.push(s[0]),u.push(s[1])}t=[wn(Qs,o),",",wn(Qs,u)],--n;while(++n<i){s=e[n%r],o.shift(),o.push(s[0]),u.shift(),u.push(s[1]),En(t,o,u)}return t.join("")}function bn(e,t){var n=e.length-1;if(n){var r=e[0][0],i=e[0][1],s=e[n][0]-r,o=e[n][1]-i,u=-1,a,f;while(++u<=n){a=e[u],f=u/n,a[0]=t*a[0]+(1-t)*(r+f*s),a[1]=t*a[1]+(1-t)*(i+f*o)}}return mn(e)}function wn(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function En(e,t,n){e.push("C",wn(Js,t),",",wn(Js,n),",",wn(Ks,t),",",wn(Ks,n),",",wn(Qs,t),",",wn(Qs,n))}function Sn(e,t){return(t[1]-e[1])/(t[0]-e[0])}function xn(e){var t=0,n=e.length-1,r=[],i=e[0],s=e[1],o=r[0]=Sn(i,s);while(++t<n){r[t]=(o+(o=Sn(i=s,s=e[t+1])))/2}return r[t]=o,r}function Tn(e){var t=[],n,r,i,s,o=xn(e),u=-1,a=e.length-1;while(++u<a){n=Sn(e[u],e[u+1]),Math.abs(n)<0.000001?o[u]=o[u+1]=0:(r=o[u]/n,i=o[u+1]/n,s=r*r+i*i,s>9&&(s=n*3/Math.sqrt(s),o[u]=s*r,o[u+1]=s*i))}u=-1;while(++u<=a){s=(e[Math.min(a,u+1)][0]-e[Math.max(0,u-1)][0])/(6*(1+o[u]*o[u])),t.push([s||0,o[u]*s||0])}return t}function Nn(e){return e.length<3?un(e):e[0]+dn(e,Tn(e))}function Cn(e){var t,n=-1,r=e.length,i,s;while(++n<r){t=e[n],i=t[0],s=t[1]+Xs,t[0]=i*Math.cos(s),t[1]=i*Math.sin(s)}return e}function kn(e){function t(t){function o(){l.push("M",f(e(v),p),h,c(e(d.reverse()),p),"Z")}var l=[],d=[],v=[],m=-1,g=t.length,y,b=u(n),w=u(i),E=n===r?function(){return x}:u(r),S=i===s?function(){return T}:u(s),x,T;while(++m<g){a.call(this,y=t[m],m)?(d.push([x=+b.call(this,y,m),T=+w.call(this,y,m)]),v.push([+E.call(this,y,m),+S.call(this,y,m)])):d.length&&(o(),d=[],v=[])}return d.length&&o(),l.length?l.join(""):null}var n=sn,r=sn,i=0,s=on,a=o,f=un,l=f.key,c=f,h="L",p=0.7;return t.x=function(e){return arguments.length?(n=r=e,t):r},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(i=s=e,t):s},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(s=e,t):s},t.defined=function(e){return arguments.length?(a=e,t):a},t.interpolate=function(e){return arguments.length?(typeof e=="function"?l=f=e:l=(f=$s.get(e)||un).key,c=f.reverse||f,h=f.closed?"M":"L",t):l},t.tension=function(e){return arguments.length?(p=e,t):p},t}function Ln(e){return e.source}function An(e){return e.target}function On(e){return e.radius}function Mn(e){return e.startAngle}function _n(e){return e.endAngle}function Dn(e){return[e.x,e.y]}function Pn(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]+Xs;return[n*Math.cos(r),n*Math.sin(r)]}}function Hn(){return 64}function Bn(){return"circle"}function jn(e){var t=Math.sqrt(e/Math.PI);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Fn(e,t){e.attr("transform",function(e){return"translate("+t(e)+",0)"})}function In(e,t){e.attr("transform",function(e){return"translate(0,"+t(e)+")"})}function qn(e,t,n){i=[];if(n&&t.length>1){var r=Mt(e.domain()),i,s=-1,o=t.length,u=(t[1]-t[0])/++n,a,f;while(++s<o){for(a=n;--a>0;){(f=+t[s]-a*u)>=r[0]&&i.push(f)}}for(--s,a=0;++a<n&&(f=+t[s]+a*u)<r[1];){i.push(f)}}return i}function Rn(){no||(no=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var e=d3.event,t;try{no.scrollTop=1000,no.dispatchEvent(e),t=1000-no.scrollTop}catch(n){t=e.wheelDelta||-e.detail*5}return t}function Un(e){var t=e.source,n=e.target,r=Wn(t,n),i=[t];while(t!==r){t=t.parent,i.push(t)}var s=i.length;while(n!==r){i.splice(s,0,n),n=n.parent}return i}function zn(e){var t=[],n=e.parent;while(n!=null){t.push(e),e=n,n=n.parent}return t.push(e),t}function Wn(e,t){if(e===t){return e}var n=zn(e),r=zn(t),i=n.pop(),s=r.pop(),o=null;while(i===s){o=i,i=n.pop(),s=r.pop()}return o}function Xn(e){e.fixed|=2}function Vn(e){e.fixed&=1}function $n(e){e.fixed|=4}function Jn(e){e.fixed&=3}function Kn(e,t,n){var r=0,i=0;e.charge=0;if(!e.leaf){var s=e.nodes,o=s.length,u=-1,a;while(++u<o){a=s[u];if(a==null){continue}Kn(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,i+=a.charge*a.cy}}if(e.point){e.leaf||(e.point.x+=Math.random()-0.5,e.point.y+=Math.random()-0.5);var f=t*n[e.point.index];e.charge+=e.pointCharge=f,r+=f*e.point.x,i+=f*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function Qn(e){return 20}function Gn(e){return 1}function Yn(e){return e.x}function Zn(e){return e.y}function er(e,t,n){e.y0=t,e.y=n}function tr(e){return d3.range(e.length)}function nr(e){var t=-1,n=e[0].length,r=[];while(++t<n){r[t]=0}return r}function rr(e){var t=1,n=0,r=e[0][1],i,s=e.length;for(;t<s;++t){(i=e[t][1])>r&&(n=t,r=i)}return n}function ir(e){return e.reduce(sr,0)}function sr(e,t){return e+t[1]}function or(e,t){return ur(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function ur(e,t){var n=-1,r=+e[0],i=(e[1]-r)/t,s=[];while(++n<=t){s[n]=i*n+r}return s}function ar(e){return[d3.min(e),d3.max(e)]}function fr(e,t){return d3.rebind(e,t,"sort","children","value"),e.links=pr,e.nodes=function(t){return uo=!0,(e.nodes=e)(t)},e}function lr(e){return e.children}function cr(e){return e.value}function hr(e,t){return t.value-e.value}function pr(e){return d3.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function dr(e,t){return e.value-t.value}function vr(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function mr(e,t){e._pack_next=t,t._pack_prev=e}function gr(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.r+t.r;return i*i-n*n-r*r>0.001}function yr(e){function t(e){r=Math.min(e.x-e.r,r),i=Math.max(e.x+e.r,i),s=Math.min(e.y-e.r,s),o=Math.max(e.y+e.r,o)}if(!(n=e.children)||!(p=n.length)){return}var n,r=Infinity,i=-Infinity,s=Infinity,o=-Infinity,u,a,f,l,c,h,p;n.forEach(br),u=n[0],u.x=-u.r,u.y=0,t(u);if(p>1){a=n[1],a.x=a.r,a.y=0,t(a);if(p>2){f=n[2],Sr(u,a,f),t(f),vr(u,f),u._pack_prev=f,vr(f,a),a=u._pack_next;for(l=3;l<p;l++){Sr(u,a,f=n[l]);var d=0,v=1,m=1;for(c=a._pack_next;c!==a;c=c._pack_next,v++){if(gr(c,f)){d=1;break}}if(d==1){for(h=u._pack_prev;h!==c._pack_prev;h=h._pack_prev,m++){if(gr(h,f)){break}}}d?(v<m||v==m&&a.r<u.r?mr(u,a=c):mr(u=h,a),l--):(vr(u,f),a=f,t(f))}}}var g=(r+i)/2,y=(s+o)/2,b=0;for(l=0;l<p;l++){f=n[l],f.x-=g,f.y-=y,b=Math.max(b,f.r+Math.sqrt(f.x*f.x+f.y*f.y))}e.r=b,n.forEach(wr)}function br(e){e._pack_next=e._pack_prev=e}function wr(e){delete e._pack_next,delete e._pack_prev}function Er(e,t,n,r){var i=e.children;e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r;if(i){var s=-1,o=i.length;while(++s<o){Er(i[s],t,n,r)}}}function Sr(e,t,n){var r=e.r+n.r,i=t.x-e.x,s=t.y-e.y;if(r&&(i||s)){var o=t.r+n.r,u=i*i+s*s;o*=o,r*=r;var a=0.5+(r-o)/(2*u),f=Math.sqrt(Math.max(0,2*o*(r+u)-(r-=u)*r-o*o))/(2*u);n.x=e.x+a*i+f*s,n.y=e.y+a*s-f*i}else{n.x=e.x+r,n.y=e.y}}function xr(e){return 1+d3.max(e,function(e){return e.y})}function Tr(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Nr(e){var t=e.children;return t&&t.length?Nr(t[0]):e}function Cr(e){var t=e.children,n;return t&&(n=t.length)?Cr(t[n-1]):e}function kr(e,t){return e.parent==t.parent?1:2}function Lr(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function Ar(e){var t=e.children,n;return t&&(n=t.length)?t[n-1]:e._tree.thread}function Or(e,t){var n=e.children;if(n&&(i=n.length)){var r,i,s=-1;while(++s<i){t(r=Or(n[s],t),e)>0&&(e=r)}}return e}function Mr(e,t){return e.x-t.x}function _r(e,t){return t.x-e.x}function Dr(e,t){return e.depth-t.depth}function Pr(e,t){function n(e,r){var i=e.children;if(i&&(a=i.length)){var s,o=null,u=-1,a;while(++u<a){s=i[u],n(s,o),o=s}}t(e,r)}n(e,null)}function Hr(e){var t=0,n=0,r=e.children,i=r.length,s;while(--i>=0){s=r[i]._tree,s.prelim+=t,s.mod+=t,t+=s.shift+(n+=s.change)}}function Br(e,t,n){e=e._tree,t=t._tree;var r=n/(t.number-e.number);e.change+=r,t.change-=r,t.shift+=n,t.prelim+=n,t.mod+=n}function jr(e,t,n){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:n}function Fr(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Ir(e,t){var n=e.x+t[3],r=e.y+t[0],i=e.dx-t[1]-t[3],s=e.dy-t[0]-t[2];return i<0&&(n+=i/2,i=0),s<0&&(r+=s/2,s=0),{x:n,y:r,dx:i,dy:s}}function qr(e,t){function n(e,r){d3.text(e,t,function(e){r(e&&n.parse(e))})}function r(t){return t.map(i).join(e)}function i(e){return o.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var s=new RegExp("\r\n|["+e+"\r\n]","g"),o=new RegExp('["'+e+"\n]"),u=e.charCodeAt(0);return n.parse=function(e){var t;return n.parseRows(e,function(e,n){if(n){var r={},i=-1,s=t.length;while(++i<s){r[t[i]]=e[i]}return r}return t=e,null})},n.parseRows=function(e,t){function n(){if(s.lastIndex>=e.length){return i}if(l){return l=!1,r}var t=s.lastIndex;if(e.charCodeAt(t)===34){var n=t;while(n++<e.length){if(e.charCodeAt(n)===34){if(e.charCodeAt(n+1)!==34){break}n++}}s.lastIndex=n+2;var o=e.charCodeAt(n+1);return o===13?(l=!0,e.charCodeAt(n+2)===10&&s.lastIndex++):o===10&&(l=!0),e.substring(t+1,n).replace(/""/g,'"')}var a=s.exec(e);return a?(l=a[0].charCodeAt(0)!==u,e.substring(t,a.index)):(s.lastIndex=e.length,e.substring(t))}var r={},i={},o=[],a=0,f,l;s.lastIndex=0;while((f=n())!==i){var c=[];while(f!==r&&f!==i){c.push(f),f=n()}if(t&&!(c=t(c,a++))){continue}o.push(c)}return o},n.format=function(e){return e.map(r).join("\n")},n}function Rr(e,t){return function(n){return n&&e.hasOwnProperty(n.type)?e[n.type](n):t}}function Ur(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function zr(e,t){fo.hasOwnProperty(e.type)&&fo[e.type](e,t)}function Wr(e,t){zr(e.geometry,t)}function Xr(e,t){for(var n=e.features,r=0,i=n.length;r<i;r++){zr(n[r].geometry,t)}}function Vr(e,t){for(var n=e.geometries,r=0,i=n.length;r<i;r++){zr(n[r],t)}}function $r(e,t){for(var n=e.coordinates,r=0,i=n.length;r<i;r++){t.apply(null,n[r])}}function Jr(e,t){for(var n=e.coordinates,r=0,i=n.length;r<i;r++){for(var s=n[r],o=0,u=s.length;o<u;o++){t.apply(null,s[o])}}}function Kr(e,t){for(var n=e.coordinates,r=0,i=n.length;r<i;r++){for(var s=n[r][0],o=0,u=s.length;o<u;o++){t.apply(null,s[o])}}}function Qr(e,t){t.apply(null,e.coordinates)}function Gr(e,t){for(var n=e.coordinates[0],r=0,i=n.length;r<i;r++){t.apply(null,n[r])}}function Yr(e){return e.source}function Zr(e){return e.target}function ei(){function e(e){var t=Math.sin(e*=p)*d,n=Math.sin(p-e)*d,r=n*s+t*c,u=n*o+t*h,a=n*i+t*l;return[Math.atan2(u,r)/ao,Math.atan2(a,Math.sqrt(r*r+u*u))/ao]}var t,n,r,i,s,o,u,a,f,l,c,h,p,d;return e.distance=function(){return p==null&&(d=1/Math.sin(p=Math.acos(Math.max(-1,Math.min(1,i*l+r*f*Math.cos(u-t)))))),p},e.source=function(u){var a=Math.cos(t=u[0]*ao),f=Math.sin(t);return r=Math.cos(n=u[1]*ao),i=Math.sin(n),s=r*a,o=r*f,p=null,e},e.target=function(t){var n=Math.cos(u=t[0]*ao),r=Math.sin(u);return f=Math.cos(a=t[1]*ao),l=Math.sin(a),c=f*n,h=f*r,p=null,e},e}function ti(e,t){var n=ei().source(e).target(t);return n.distance(),n}function ni(e){var t=0,n=0;for(;;){if(e(t,n)){return[t,n]}t===0?(t=n+1,n=0):(t-=1,n+=1)}}function ri(e,t,n,r){var i,s,o,u,a,f,l;return i=r[e],s=i[0],o=i[1],i=r[t],u=i[0],a=i[1],i=r[n],f=i[0],l=i[1],(l-o)*(u-s)-(a-o)*(f-s)>0}function ii(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function si(e,t,n,r){var i=e[0],s=t[0],o=n[0],u=r[0],a=e[1],f=t[1],l=n[1],c=r[1],h=i-o,p=s-i,d=u-o,v=a-l,m=f-a,g=c-l,y=(d*v-g*h)/(g*p-d*m);return[i+y*p,a+y*m]}function oi(e,t){var n={list:e.map(function(e,t){return{index:t,x:e[0],y:e[1]}}).sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}),bottomSite:null},r={list:[],leftEnd:null,rightEnd:null,init:function(){r.leftEnd=r.createHalfEdge(null,"l"),r.rightEnd=r.createHalfEdge(null,"l"),r.leftEnd.r=r.rightEnd,r.rightEnd.l=r.leftEnd,r.list.unshift(r.leftEnd,r.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound:function(e){var t=r.leftEnd;do{t=t.r}while(t!=r.rightEnd&&i.rightOf(t,e));return t=t.l,t},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[ho[e.side]]}},i={bisect:function(e,t){var n={region:{l:e,r:t},ep:{l:null,r:null}},r=t.x-e.x,i=t.y-e.y,s=r>0?r:-r,o=i>0?i:-i;return n.c=e.x*r+e.y*i+(r*r+i*i)*0.5,s>o?(n.a=1,n.b=i/r,n.c/=r):(n.b=1,n.a=r/i,n.c/=i),n},intersect:function(e,t){var n=e.edge,r=t.edge;if(!n||!r||n.region.r==r.region.r){return null}var i=n.a*r.b-n.b*r.a;if(Math.abs(i)<1e-10){return null}var s=(n.c*r.b-r.c*n.b)/i,o=(r.c*n.a-n.c*r.a)/i,u=n.region.r,a=r.region.r,f,l;u.y<a.y||u.y==a.y&&u.x<a.x?(f=e,l=n):(f=t,l=r);var c=s>=l.region.r.x;return c&&f.side==="l"||!c&&f.side==="r"?null:{x:s,y:o}},rightOf:function(e,t){var n=e.edge,r=n.region.r,i=t.x>r.x;if(i&&e.side==="l"){return 1}if(!i&&e.side==="r"){return 0}if(n.a===1){var s=t.y-r.y,o=t.x-r.x,u=0,a=0;!i&&n.b<0||i&&n.b>=0?a=u=s>=n.b*o:(a=t.x+t.y*n.b>n.c,n.b<0&&(a=!a),a||(u=1));if(!u){var f=r.x-n.region.l.x;a=n.b*(o*o-s*s)<f*s*(1+2*o/f+n.b*n.b),n.b<0&&(a=!a)}}else{var l=n.c-n.a*t.x,c=t.y-l,h=t.x-r.x,p=l-r.y;a=c*c>h*h+p*p}return e.side==="l"?a:!a},endPoint:function(e,n,r){e.ep[n]=r;if(!e.ep[ho[n]]){return}t(e)},distance:function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}},s={list:[],insert:function(e,t,n){e.vertex=t,e.ystar=t.y+n;for(var r=0,i=s.list,o=i.length;r<o;r++){var u=i[r];if(e.ystar>u.ystar||e.ystar==u.ystar&&t.x>u.vertex.x){continue}break}i.splice(r,0,e)},del:function(e){for(var t=0,n=s.list,r=n.length;t<r&&n[t]!=e;++t){}n.splice(t,1)},empty:function(){return s.list.length===0},nextEvent:function(e){for(var t=0,n=s.list,r=n.length;t<r;++t){if(n[t]==e){return n[t+1]}}return null},min:function(){var e=s.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return s.list.shift()}};r.init(),n.bottomSite=n.list.shift();var o=n.list.shift(),u,a,f,l,c,h,p,d,v,m,g,y,b;for(;;){s.empty()||(u=s.min());if(o&&(s.empty()||o.y<u.y||o.y==u.y&&o.x<u.x)){a=r.leftBound(o),f=r.right(a),p=r.rightRegion(a),y=i.bisect(p,o),h=r.createHalfEdge(y,"l"),r.insert(a,h),m=i.intersect(a,h),m&&(s.del(a),s.insert(a,m,i.distance(m,o))),a=h,h=r.createHalfEdge(y,"r"),r.insert(a,h),m=i.intersect(h,f),m&&s.insert(h,m,i.distance(m,o)),o=n.list.shift()}else{if(!!s.empty()){break}a=s.extractMin(),l=r.left(a),f=r.right(a),c=r.right(f),p=r.leftRegion(a),d=r.rightRegion(f),g=a.vertex,i.endPoint(a.edge,a.side,g),i.endPoint(f.edge,f.side,g),r.del(a),s.del(f),r.del(f),b="l",p.y>d.y&&(v=p,p=d,d=v,b="r"),y=i.bisect(p,d),h=r.createHalfEdge(y,b),r.insert(l,h),i.endPoint(y,ho[b],g),m=i.intersect(l,h),m&&(s.del(l),s.insert(l,m,i.distance(m,p))),m=i.intersect(h,c),m&&s.insert(h,m,i.distance(m,p))}}for(a=r.right(r.leftEnd);a!=r.rightEnd;a=r.right(a)){t(a.edge)}}function ui(){return{leaf:!0,nodes:[],point:null}}function ai(e,t,n,r,i,s){if(!e(t,n,r,i,s)){var o=(n+i)*0.5,u=(r+s)*0.5,a=t.nodes;a[0]&&ai(e,a[0],n,r,o,u),a[1]&&ai(e,a[1],o,r,i,u),a[2]&&ai(e,a[2],n,u,o,s),a[3]&&ai(e,a[3],o,u,i,s)}}function fi(e){return{x:e[0],y:e[1]}}function li(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function ci(e){return e.substring(0,3)}function hi(e,t,n,r){var i,s,o=0,u=t.length,a=n.length;while(o<u){if(r>=a){return -1}i=t.charCodeAt(o++);if(i==37){s=Ho[t.charAt(o++)];if(!s||(r=s(e,n,r))<0){return -1}}else{if(i!=n.charCodeAt(r++)){return -1}}}return r}function pi(e){return new RegExp("^(?:"+e.map(d3.requote).join("|")+")","i")}function di(e){var t=new r,n=-1,i=e.length;while(++n<i){t.set(e[n].toLowerCase(),n)}return t}function vi(e,t,n){Ao.lastIndex=0;var r=Ao.exec(t.substring(n));return r?n+=r[0].length:-1}function mi(e,t,n){Lo.lastIndex=0;var r=Lo.exec(t.substring(n));return r?n+=r[0].length:-1}function gi(e,t,n){_o.lastIndex=0;var r=_o.exec(t.substring(n));return r?(e.m=Do.get(r[0].toLowerCase()),n+=r[0].length):-1}function yi(e,t,n){Oo.lastIndex=0;var r=Oo.exec(t.substring(n));return r?(e.m=Mo.get(r[0].toLowerCase()),n+=r[0].length):-1}function bi(e,t,n){return hi(e,Po.c.toString(),t,n)}function wi(e,t,n){return hi(e,Po.x.toString(),t,n)}function Ei(e,t,n){return hi(e,Po.X.toString(),t,n)}function Si(e,t,n){Bo.lastIndex=0;var r=Bo.exec(t.substring(n,n+4));return r?(e.y=+r[0],n+=r[0].length):-1}function xi(e,t,n){Bo.lastIndex=0;var r=Bo.exec(t.substring(n,n+2));return r?(e.y=Ti(+r[0]),n+=r[0].length):-1}function Ti(e){return e+(e>68?1900:2000)}function Ni(e,t,n){Bo.lastIndex=0;var r=Bo.exec(t.substring(n,n+2));return r?(e.m=r[0]-1,n+=r[0].length):-1}function Ci(e,t,n){Bo.lastIndex=0;var r=Bo.exec(t.substring(n,n+2));return r?(e.d=+r[0],n+=r[0].length):-1}function ki(e,t,n){Bo.lastIndex=0;var r=Bo.exec(t.substring(n,n+2));return r?(e.H=+r[0],n+=r[0].length):-1}function Li(e,t,n){Bo.lastIndex=0;var r=Bo.exec(t.substring(n,n+2));return r?(e.M=+r[0],n+=r[0].length):-1}function Ai(e,t,n){Bo.lastIndex=0;var r=Bo.exec(t.substring(n,n+2));return r?(e.S=+r[0],n+=r[0].length):-1}function Oi(e,t,n){Bo.lastIndex=0;var r=Bo.exec(t.substring(n,n+3));return r?(e.L=+r[0],n+=r[0].length):-1}function Mi(e,t,n){var r=jo.get(t.substring(n,n+=2).toLowerCase());return r==null?-1:(e.p=r,n)}function _i(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=~~(Math.abs(t)/60),i=Math.abs(t)%60;return n+To(r)+To(i)}function Di(e){return e.toISOString()}function Pi(e,t,n){function r(t){var n=e(t),r=s(n,1);return t-n<r-t?n:r}function i(n){return t(n=e(new po(n-1)),1),n}function s(e,n){return t(e=new po(+e),n),e}function o(e,r,s){var o=i(e),u=[];if(s>1){while(o<r){n(o)%s||u.push(new Date(+o)),t(o,1)}}else{while(o<r){u.push(new Date(+o)),t(o,1)}}return u}function u(e,t,n){try{po=li;var r=new li;return r._=e,o(r,t,n)}finally{po=Date}}e.floor=e,e.round=r,e.ceil=i,e.offset=s,e.range=o;var a=e.utc=Hi(e);return a.floor=a,a.round=Hi(r),a.ceil=Hi(i),a.offset=Hi(s),a.range=u,e}function Hi(e){return function(t,n){try{po=li;var r=new li;return r._=t,e(r,n)._}finally{po=Date}}}function Bi(e,t,n){function r(t){return e(t)}return r.invert=function(t){return Fi(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain(t),r):e.domain().map(Fi)},r.nice=function(e){return r.domain(Dt(r.domain(),function(){return e}))},r.ticks=function(n,i){var s=ji(r.domain());if(typeof n!="function"){var o=s[1]-s[0],u=o/n,a=d3.bisect(Io,u);if(a==Io.length){return t.year(s,n)}if(!a){return e.ticks(n).map(Fi)}Math.log(u/Io[a-1])<Math.log(Io[a]/u)&&--a,n=t[a],i=n[1],n=n[0].range}return n(s[0],new Date(+s[1]+1),i)},r.tickFormat=function(){return n},r.copy=function(){return Bi(e.copy(),t,n)},d3.rebind(r,e,"range","rangeRound","interpolate","clamp")}function ji(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Fi(e){return new Date(e)}function Ii(e){return function(t){var n=e.length-1,r=e[n];while(!r[1](t)){r=e[--n]}return r[0](t)}}function qi(e){var t=new Date(e,0,1);return t.setFullYear(e),t}function Ri(e){var t=e.getFullYear(),n=qi(t),r=qi(t+1);return t+(e-n)/(r-n)}function Ui(e){var t=new Date(Date.UTC(e,0,1));return t.setUTCFullYear(e),t}function zi(e){var t=e.getUTCFullYear(),n=Ui(t),r=Ui(t+1);return t+(e-n)/(r-n)}Date.now||(Date.now=function(){return +(new Date)});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(Wi){var Xi=CSSStyleDeclaration.prototype,Vi=Xi.setProperty;Xi.setProperty=function(e,t,n){Vi.call(this,e,t+"",n)}}d3={version:"2.10.2"};var $i=n;try{$i(document.documentElement.childNodes)[0].nodeType}catch(Ji){$i=t}var Ki=[].__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t){e[n]=t[n]}};d3.map=function(e){var t=new r;for(var n in e){t.set(n,e[n])}return t},e(r,{has:function(e){return Qi+e in this},get:function(e){return this[Qi+e]},set:function(e,t){return this[Qi+e]=t},remove:function(e){return e=Qi+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},forEach:function(e){for(var t in this){t.charCodeAt(0)===Gi&&e.call(this,t.substring(1),this[t])}}});var Qi="\0",Gi=Qi.charCodeAt(0);d3.functor=u,d3.rebind=function(e,t){var n=1,r=arguments.length,i;while(++n<r){e[i=arguments[n]]=a(e,t,t[i])}return e},d3.ascending=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},d3.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},d3.mean=function(e,t){var n=e.length,r,i=0,s=-1,o=0;if(arguments.length===1){while(++s<n){f(r=e[s])&&(i+=(r-i)/++o)}}else{while(++s<n){f(r=t.call(e,e[s],s))&&(i+=(r-i)/++o)}}return o?i:undefined},d3.median=function(e,t){return arguments.length>1&&(e=e.map(t)),e=e.filter(f),e.length?d3.quantile(e.sort(d3.ascending),0.5):undefined},d3.min=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i)){i=undefined}while(++n<r){(s=e[n])!=null&&i>s&&(i=s)}}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i)){i=undefined}while(++n<r){(s=t.call(e,e[n],n))!=null&&i>s&&(i=s)}}return i},d3.max=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i)){i=undefined}while(++n<r){(s=e[n])!=null&&s>i&&(i=s)}}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i)){i=undefined}while(++n<r){(s=t.call(e,e[n],n))!=null&&s>i&&(i=s)}}return i},d3.extent=function(e,t){var n=-1,r=e.length,i,s,o;if(arguments.length===1){while(++n<r&&((i=o=e[n])==null||i!=i)){i=o=undefined}while(++n<r){(s=e[n])!=null&&(i>s&&(i=s),o<s&&(o=s))}}else{while(++n<r&&((i=o=t.call(e,e[n],n))==null||i!=i)){i=undefined}while(++n<r){(s=t.call(e,e[n],n))!=null&&(i>s&&(i=s),o<s&&(o=s))}}return[i,o]},d3.random={normal:function(e,t){var n=arguments.length;return n<2&&(t=1),n<1&&(e=0),function(){var n,r,i;do{n=Math.random()*2-1,r=Math.random()*2-1,i=n*n+r*r}while(!i||i>1);return e+t*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(e,t){var n=arguments.length;n<2&&(t=1),n<1&&(e=0);var r=d3.random.normal();return function(){return Math.exp(e+t*r())}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++){t+=Math.random()}return t/e}}},d3.sum=function(e,t){var n=0,r=e.length,i,s=-1;if(arguments.length===1){while(++s<r){isNaN(i=+e[s])||(n+=i)}}else{while(++s<r){isNaN(i=+t.call(e,e[s],s))||(n+=i)}}return n},d3.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),i=e[r-1],s=n-r;return s?i+s*(e[r]-i):i},d3.transpose=function(e){return d3.zip.apply(d3,e)},d3.zip=function(){if(!(i=arguments.length)){return[]}for(var e=-1,t=d3.min(arguments,l),n=new Array(t);++e<t;){for(var r=-1,i,s=n[e]=new Array(i);++r<i;){s[r]=arguments[r][e]}}return n},d3.bisector=function(e){return{left:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;e.call(t,t[s],s)<n?r=s+1:i=s}return r},right:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;n<e.call(t,t[s],s)?i=s:r=s+1}return r}}};var Yi=d3.bisector(function(e){return e});d3.bisectLeft=Yi.left,d3.bisect=d3.bisectRight=Yi.right,d3.first=function(e,t){var n=0,r=e.length,i=e[0],s;arguments.length===1&&(t=d3.ascending);while(++n<r){t.call(e,i,s=e[n])>0&&(i=s)}return i},d3.last=function(e,t){var n=0,r=e.length,i=e[0],s;arguments.length===1&&(t=d3.ascending);while(++n<r){t.call(e,i,s=e[n])<=0&&(i=s)}return i},d3.nest=function(){function e(t,s){if(s>=i.length){return u?u.call(n,t):o?t.sort(o):t}var a=-1,f=t.length,l=i[s++],c,h,p=new r,d,v={};while(++a<f){(d=p.get(c=l(h=t[a])))?d.push(h):p.set(c,[h])}return p.forEach(function(t,n){v[t]=e(n,s)}),v}function t(e,n){if(n>=i.length){return e}var r=[],o=s[n++],u;for(u in e){r.push({key:u,values:t(e[u],n)})}return o&&r.sort(function(e,t){return o(e.key,t.key)}),r}var n={},i=[],s=[],o,u;return n.map=function(t){return e(t,0)},n.entries=function(n){return t(e(n,0),0)},n.key=function(e){return i.push(e),n},n.sortKeys=function(e){return s[i.length-1]=e,n},n.sortValues=function(e){return o=e,n},n.rollup=function(e){return u=e,n},n},d3.keys=function(e){var t=[];for(var n in e){t.push(n)}return t},d3.values=function(e){var t=[];for(var n in e){t.push(e[n])}return t},d3.entries=function(e){var t=[];for(var n in e){t.push({key:n,value:e[n]})}return t},d3.permute=function(e,t){var n=[],r=-1,i=t.length;while(++r<i){n[r]=e[t[r]]}return n},d3.merge=function(e){return Array.prototype.concat.apply([],e)},d3.split=function(e,t){var n=[],r=[],i,s=-1,o=e.length;arguments.length<2&&(t=c);while(++s<o){t.call(r,i=e[s],s)?r=[]:(r.length||n.push(r),r.push(i))}return n},d3.range=function(e,t,n){arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0));if((t-e)/n===Infinity){throw new Error("infinite range")}var r=[],i=p(Math.abs(n)),s=-1,o;e*=i,t*=i,n*=i;if(n<0){while((o=e+n*++s)>t){r.push(o/i)}}else{while((o=e+n*++s)<t){r.push(o/i)}}return r},d3.requote=function(e){return e.replace(Zi,"\\$&")};var Zi=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},d3.xhr=function(e,t,n){var r=new XMLHttpRequest;arguments.length<3?(n=t,t=null):t&&r.overrideMimeType&&r.overrideMimeType(t),r.open("GET",e,!0),t&&r.setRequestHeader("Accept",t),r.onreadystatechange=function(){if(r.readyState===4){var e=r.status;n(!e&&r.response||e>=200&&e<300||e===304?r:null)}},r.send(null)},d3.text=function(e,t,n){function r(e){n(e&&e.responseText)}arguments.length<3&&(n=t,t=null),d3.xhr(e,t,r)},d3.json=function(e,t){d3.text(e,"application/json",function(e){t(e?JSON.parse(e):null)})},d3.html=function(e,t){d3.text(e,"text/html",function(e){if(e!=null){var n=document.createRange();n.selectNode(document.body),e=n.createContextualFragment(e)}t(e)})},d3.xml=function(e,t,n){function r(e){n(e&&e.responseXML)}arguments.length<3&&(n=t,t=null),d3.xhr(e,t,r)};var es={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:es,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.substring(0,t),e=e.substring(t+1)),es.hasOwnProperty(n)?{space:es[n],local:e}:e}},d3.dispatch=function(){var e=new d,t=-1,n=arguments.length;while(++t<n){e[arguments[t]]=v(e)}return e},d.prototype.on=function(e,t){var n=e.indexOf("."),r="";return n>0&&(r=e.substring(n+1),e=e.substring(0,n)),arguments.length<2?this[e].on(r):this[e].on(r,t)},d3.format=function(e){var t=ts.exec(e),n=t[1]||" ",r=t[3]||"",i=t[5],s=+t[6],o=t[7],u=t[8],a=t[9],f=1,l="",c=!1;u&&(u=+u.substring(1)),i&&(n="0",o&&(s-=Math.floor((s-1)/4)));switch(a){case"n":o=!0,a="g";break;case"%":f=100,l="%",a="f";break;case"p":f=100,l="%",a="r";break;case"d":c=!0,u=0;break;case"s":f=-1,a="r"}return a=="r"&&!u&&(a="g"),a=ns.get(a)||g,function(e){if(c&&e%1){return""}var t=e<0&&(e=-e)?"-":r;if(f<0){var h=d3.formatPrefix(e,u);e=h.scale(e),l=h.symbol}else{e*=f}e=a(e,u);if(i){var p=e.length+t.length;p<s&&(e=(new Array(s-p+1)).join(n)+e),o&&(e=y(e)),e=t+e}else{o&&(e=y(e)),e=t+e;var p=e.length;p<s&&(e=(new Array(s-p+1)).join(n)+e)}return e+l}};var ts=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,ns=d3.map({g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return d3.round(e,t=m(e,t)).toFixed(Math.max(0,Math.min(20,t)))}}),rs=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(b);d3.formatPrefix=function(e,t){var n=0;return e&&(e<0&&(e*=-1),t&&(e=d3.round(e,m(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,Math.floor((n<=0?n+1:n-1)/3)*3))),rs[8+n/3]};var is=T(2),ss=T(3),os=function(){return x},us=d3.map({linear:os,poly:T,quad:function(){return is},cubic:function(){return ss},sin:function(){return N},exp:function(){return C},circle:function(){return k},elastic:L,back:A,bounce:function(){return O}}),as=d3.map({"in":x,out:E,"in-out":S,"out-in":function(e){return S(E(e))}});d3.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,r=t>=0?e.substring(t+1):"in";return n=us.get(n)||os,r=as.get(r)||x,w(r(n.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.transform=function(e){var t=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate();return new P(n?n.matrix:ls)})(e)},P.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var fs=180/Math.PI,ls={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(e,t){var n=d3.interpolators.length,r;while(--n>=0&&!(r=d3.interpolators[n](e,t))){}return r},d3.interpolateNumber=function(e,t){return t-=e,function(n){return e+t*n}},d3.interpolateRound=function(e,t){return t-=e,function(n){return Math.round(e+t*n)}},d3.interpolateString=function(e,t){var n,r,i,s=0,o=0,u=[],a=[],f,l;cs.lastIndex=0;for(r=0;n=cs.exec(t);++r){n.index&&u.push(t.substring(s,o=n.index)),a.push({i:u.length,x:n[0]}),u.push(null),s=cs.lastIndex}s<t.length&&u.push(t.substring(s));for(r=0,f=a.length;(n=cs.exec(e))&&r<f;++r){l=a[r];if(l.x==n[0]){if(l.i){if(u[l.i+1]==null){u[l.i-1]+=l.x,u.splice(l.i,1);for(i=r+1;i<f;++i){a[i].i--}}else{u[l.i-1]+=l.x+u[l.i+1],u.splice(l.i,2);for(i=r+1;i<f;++i){a[i].i-=2}}}else{if(u[l.i+1]==null){u[l.i]=l.x}else{u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1);for(i=r+1;i<f;++i){a[i].i--}}}a.splice(r,1),f--,r--}else{l.x=d3.interpolateNumber(parseFloat(n[0]),parseFloat(l.x))}}while(r<f){l=a.pop(),u[l.i+1]==null?u[l.i]=l.x:(u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1)),f--}return u.length===1?u[0]==null?a[0].x:function(){return t}:function(e){for(r=0;r<f;++r){u[(l=a[r]).i]=l.x(e)}return u.join("")}},d3.interpolateTransform=function(e,t){var n=[],r=[],i,s=d3.transform(e),o=d3.transform(t),u=s.translate,a=o.translate,f=s.rotate,l=o.rotate,c=s.skew,h=o.skew,p=s.scale,d=o.scale;return u[0]!=a[0]||u[1]!=a[1]?(n.push("translate(",null,",",null,")"),r.push({i:1,x:d3.interpolateNumber(u[0],a[0])},{i:3,x:d3.interpolateNumber(u[1],a[1])})):a[0]||a[1]?n.push("translate("+a+")"):n.push(""),f!=l?(f-l>180?l+=360:l-f>180&&(f+=360),r.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(f,l)})):l&&n.push(n.pop()+"rotate("+l+")"),c!=h?r.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(c,h)}):h&&n.push(n.pop()+"skewX("+h+")"),p[0]!=d[0]||p[1]!=d[1]?(i=n.push(n.pop()+"scale(",null,",",null,")"),r.push({i:i-4,x:d3.interpolateNumber(p[0],d[0])},{i:i-2,x:d3.interpolateNumber(p[1],d[1])})):(d[0]!=1||d[1]!=1)&&n.push(n.pop()+"scale("+d+")"),i=r.length,function(e){var t=-1,s;while(++t<i){n[(s=r[t]).i]=s.x(e)}return n.join("")}},d3.interpolateRgb=function(e,t){e=d3.rgb(e),t=d3.rgb(t);var n=e.r,r=e.g,i=e.b,s=t.r-n,o=t.g-r,u=t.b-i;return function(e){return"#"+z(Math.round(n+s*e))+z(Math.round(r+o*e))+z(Math.round(i+u*e))}},d3.interpolateHsl=function(e,t){e=d3.hsl(e),t=d3.hsl(t);var n=e.h,r=e.s,i=e.l,s=t.h-n,o=t.s-r,u=t.l-i;return s>180?s-=360:s<-180&&(s+=360),function(e){return G(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateLab=function(e,t){e=d3.lab(e),t=d3.lab(t);var n=e.l,r=e.a,i=e.b,s=t.l-n,o=t.a-r,u=t.b-i;return function(e){return rt(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateHcl=function(e,t){e=d3.hcl(e),t=d3.hcl(t);var n=e.h,r=e.c,i=e.l,s=t.h-n,o=t.c-r,u=t.l-i;return s>180?s-=360:s<-180&&(s+=360),function(e){return et(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateArray=function(e,t){var n=[],r=[],i=e.length,s=t.length,o=Math.min(e.length,t.length),u;for(u=0;u<o;++u){n.push(d3.interpolate(e[u],t[u]))}for(;u<i;++u){r[u]=e[u]}for(;u<s;++u){r[u]=t[u]}return function(e){for(u=0;u<o;++u){r[u]=n[u](e)}return r}},d3.interpolateObject=function(e,t){var n={},r={},i;for(i in e){i in t?n[i]=F(i)(e[i],t[i]):r[i]=e[i]}for(i in t){i in e||(r[i]=t[i])}return function(e){for(i in n){r[i]=n[i](e)}return r}};var cs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(e,t){return t instanceof Array&&d3.interpolateArray(e,t)},function(e,t){return(typeof e=="string"||typeof t=="string")&&d3.interpolateString(e+"",t+"")},function(e,t){return(typeof t=="string"?hs.has(t)||/^(#|rgb\(|hsl\()/.test(t):t instanceof U||t instanceof Q)&&d3.interpolateRgb(e,t)},function(e,t){return !isNaN(e=+e)&&!isNaN(t=+t)&&d3.interpolateNumber(e,t)}],d3.rgb=function(e,t,n){return arguments.length===1?e instanceof U?R(e.r,e.g,e.b):W(""+e,R,G):R(~~e,~~t,~~n)},U.prototype.brighter=function(e){e=Math.pow(0.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,i=30;return !t&&!n&&!r?R(i,i,i):(t&&t<i&&(t=i),n&&n<i&&(n=i),r&&r<i&&(r=i),R(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(n/e)),Math.min(255,Math.floor(r/e))))},U.prototype.darker=function(e){return e=Math.pow(0.7,arguments.length?e:1),R(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))},U.prototype.hsl=function(){return X(this.r,this.g,this.b)},U.prototype.toString=function(){return"#"+z(this.r)+z(this.g)+z(this.b)};var hs=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});hs.forEach(function(e,t){hs.set(e,W(t,R,G))}),d3.hsl=function(e,t,n){return arguments.length===1?e instanceof Q?K(e.h,e.s,e.l):W(""+e,X,K):K(+e,+t,+n)},Q.prototype.brighter=function(e){return e=Math.pow(0.7,arguments.length?e:1),K(this.h,this.s,this.l/e)},Q.prototype.darker=function(e){return e=Math.pow(0.7,arguments.length?e:1),K(this.h,this.s,e*this.l)},Q.prototype.rgb=function(){return G(this.h,this.s,this.l)},Q.prototype.toString=function(){return this.rgb().toString()},d3.hcl=function(e,t,n){return arguments.length===1?e instanceof Z?Y(e.h,e.c,e.l):e instanceof nt?it(e.l,e.a,e.b):it((e=V((e=d3.rgb(e)).r,e.g,e.b)).l,e.a,e.b):Y(+e,+t,+n)},Z.prototype.brighter=function(e){return Y(this.h,this.c,Math.min(100,this.l+ps*(arguments.length?e:1)))},Z.prototype.darker=function(e){return Y(this.h,this.c,Math.max(0,this.l-ps*(arguments.length?e:1)))},Z.prototype.rgb=function(){return et(this.h,this.c,this.l).rgb()},Z.prototype.toString=function(){return this.rgb()+""},d3.lab=function(e,t,n){return arguments.length===1?e instanceof nt?tt(e.l,e.a,e.b):e instanceof Z?et(e.l,e.c,e.h):V((e=d3.rgb(e)).r,e.g,e.b):tt(+e,+t,+n)};var ps=18,ds=0.95047,vs=1,ms=1.08883;nt.prototype.brighter=function(e){return tt(Math.min(100,this.l+ps*(arguments.length?e:1)),this.a,this.b)},nt.prototype.darker=function(e){return tt(Math.max(0,this.l-ps*(arguments.length?e:1)),this.a,this.b)},nt.prototype.rgb=function(){return rt(this.l,this.a,this.b)},nt.prototype.toString=function(){return this.rgb()+""};var gs=function(e,t){return t.querySelector(e)},ys=function(e,t){return t.querySelectorAll(e)},bs=document.documentElement,ws=bs.matchesSelector||bs.webkitMatchesSelector||bs.mozMatchesSelector||bs.msMatchesSelector||bs.oMatchesSelector,Es=function(e,t){return ws.call(e,t)};typeof Sizzle=="function"&&(gs=function(e,t){return Sizzle(e,t)[0]||null},ys=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))},Es=Sizzle.matchesSelector);var Ss=[];d3.selection=function(){return xs},d3.selection.prototype=Ss,Ss.select=function(e){var t=[],n,r,i,s;typeof e!="function"&&(e=ft(e));for(var o=-1,u=this.length;++o<u;){t.push(n=[]),n.parentNode=(i=this[o]).parentNode;for(var a=-1,f=i.length;++a<f;){(s=i[a])?(n.push(r=e.call(s,s.__data__,a)),r&&"__data__" in s&&(r.__data__=s.__data__)):n.push(null)}}return at(t)},Ss.selectAll=function(e){var t=[],n,r;typeof e!="function"&&(e=lt(e));for(var i=-1,s=this.length;++i<s;){for(var o=this[i],u=-1,a=o.length;++u<a;){if(r=o[u]){t.push(n=$i(e.call(r,r.__data__,u))),n.parentNode=r}}}return at(t)},Ss.attr=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node();return e=d3.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e){this.each(ct(t,e[t]))}return this}return this.each(ct(e,t))},Ss.classed=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node(),r=(e=e.trim().split(/^|\s+/g)).length,i=-1;if(t=n.classList){while(++i<r){if(!t.contains(e[i])){return !1}}}else{t=n.className,t.baseVal!=null&&(t=t.baseVal);while(++i<r){if(!ht(e[i]).test(t)){return !1}}}return !0}for(t in e){this.each(pt(t,e[t]))}return this}return this.each(pt(e,t))},Ss.style=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t="");for(n in e){this.each(vt(n,e[n],t))}return this}if(r<2){return window.getComputedStyle(this.node(),null).getPropertyValue(e)}n=""}return this.each(vt(e,t,n))},Ss.property=function(e,t){if(arguments.length<2){if(typeof e=="string"){return this.node()[e]}for(t in e){this.each(mt(t,e[t]))}return this}return this.each(mt(e,t))},Ss.text=function(e){return arguments.length<1?this.node().textContent:this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e})},Ss.html=function(e){return arguments.length<1?this.node().innerHTML:this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e})},Ss.append=function(e){function t(){return this.appendChild(document.createElementNS(this.namespaceURI,e))}function n(){return this.appendChild(document.createElementNS(e.space,e.local))}return e=d3.ns.qualify(e),this.select(e.local?n:t)},Ss.insert=function(e,t){function n(){return this.insertBefore(document.createElementNS(this.namespaceURI,e),gs(t,this))}function r(){return this.insertBefore(document.createElementNS(e.space,e.local),gs(t,this))}return e=d3.ns.qualify(e),this.select(e.local?r:n)},Ss.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},Ss.data=function(e,t){function n(e,n){var i,s=e.length,o=n.length,u=Math.min(s,o),c=Math.max(s,o),h=[],p=[],d=[],v,m;if(t){var g=new r,y=[],b,w=n.length;for(i=-1;++i<s;){b=t.call(v=e[i],v.__data__,i),g.has(b)?d[w++]=v:g.set(b,v),y.push(b)}for(i=-1;++i<o;){b=t.call(n,m=n[i],i),g.has(b)?(h[i]=v=g.get(b),v.__data__=m,p[i]=d[i]=null):(p[i]=gt(m),h[i]=d[i]=null),g.remove(b)}for(i=-1;++i<s;){g.has(y[i])&&(d[i]=e[i])}}else{for(i=-1;++i<u;){v=e[i],m=n[i],v?(v.__data__=m,h[i]=v,p[i]=d[i]=null):(p[i]=gt(m),h[i]=d[i]=null)}for(;i<o;++i){p[i]=gt(n[i]),h[i]=d[i]=null}for(;i<c;++i){d[i]=e[i],p[i]=h[i]=null}}p.update=h,p.parentNode=h.parentNode=d.parentNode=e.parentNode,a.push(p),f.push(h),l.push(d)}var i=-1,s=this.length,o,u;if(!arguments.length){e=new Array(s=(o=this[0]).length);while(++i<s){if(u=o[i]){e[i]=u.__data__}}return e}var a=St([]),f=at([]),l=at([]);if(typeof e=="function"){while(++i<s){n(o=this[i],e.call(o,o.parentNode.__data__,i))}}else{while(++i<s){n(o=this[i],e)}}return f.enter=function(){return a},f.exit=function(){return l},f},Ss.datum=Ss.map=function(e){return arguments.length<1?this.property("__data__"):this.property("__data__",e)},Ss.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=yt(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]),n.parentNode=(r=this[s]).parentNode;for(var u=0,a=r.length;u<a;u++){(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}}return at(t)},Ss.order=function(){for(var e=-1,t=this.length;++e<t;){for(var n=this[e],r=n.length-1,i=n[r],s;--r>=0;){if(s=n[r]){i&&i!==s.nextSibling&&i.parentNode.insertBefore(s,i),i=s}}}return this},Ss.sort=function(e){e=bt.apply(this,arguments);for(var t=-1,n=this.length;++t<n;){this[t].sort(e)}return this.order()},Ss.on=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t=!1);for(n in e){this.each(wt(n,e[n],t))}return this}if(r<2){return(r=this.node()["__on"+e])&&r._}n=!1}return this.each(wt(e,t,n))},Ss.each=function(e){return Et(this,function(t,n,r){e.call(t,t.__data__,n,r)})},Ss.call=function(e){return e.apply(this,(arguments[0]=this,arguments)),this},Ss.empty=function(){return !this.node()},Ss.node=function(e){for(var t=0,n=this.length;t<n;t++){for(var r=this[t],i=0,s=r.length;i<s;i++){var o=r[i];if(o){return o}}}return null},Ss.transition=function(){var e=[],t,n;for(var r=-1,i=this.length;++r<i;){e.push(t=[]);for(var s=this[r],o=-1,u=s.length;++o<u;){t.push((n=s[o])?{node:n,delay:Ms,duration:_s}:null)}}return xt(e,ks||++Cs,Date.now())};var xs=at([[document]]);xs[0].parentNode=bs,d3.select=function(e){return typeof e=="string"?xs.select(e):at([[e]])},d3.selectAll=function(e){return typeof e=="string"?xs.selectAll(e):at([$i(e)])};var Ts=[];d3.selection.enter=St,d3.selection.enter.prototype=Ts,Ts.append=Ss.append,Ts.insert=Ss.insert,Ts.empty=Ss.empty,Ts.node=Ss.node,Ts.select=function(e){var t=[],n,r,i,s,o;for(var u=-1,a=this.length;++u<a;){i=(s=this[u]).update,t.push(n=[]),n.parentNode=s.parentNode;for(var f=-1,l=s.length;++f<l;){(o=s[f])?(n.push(i[f]=r=e.call(s.parentNode,o.__data__,f)),r.__data__=o.__data__):n.push(null)}}return at(t)};var Ns=[],Cs=0,ks=0,Ls=0,As=250,Os=d3.ease("cubic-in-out"),Ms=Ls,_s=As,Ds=Os;Ns.call=Ss.call,d3.transition=function(e){return arguments.length?ks?e.transition():e:xs.transition()},d3.transition.prototype=Ns,Ns.select=function(e){var t=[],n,r,i;typeof e!="function"&&(e=ft(e));for(var s=-1,o=this.length;++s<o;){t.push(n=[]);for(var u=this[s],a=-1,f=u.length;++a<f;){(i=u[a])&&(r=e.call(i.node,i.node.__data__,a))?("__data__" in i.node&&(r.__data__=i.node.__data__),n.push({node:r,delay:i.delay,duration:i.duration})):n.push(null)}}return xt(t,this.id,this.time).ease(this.ease())},Ns.selectAll=function(e){var t=[],n,r,i;typeof e!="function"&&(e=lt(e));for(var s=-1,o=this.length;++s<o;){for(var u=this[s],a=-1,f=u.length;++a<f;){if(i=u[a]){r=e.call(i.node,i.node.__data__,a),t.push(n=[]);for(var l=-1,c=r.length;++l<c;){n.push({node:r[l],delay:i.delay,duration:i.duration})}}}}return xt(t,this.id,this.time).ease(this.ease())},Ns.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=yt(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]);for(var r=this[s],u=0,a=r.length;u<a;u++){(i=r[u])&&e.call(i.node,i.node.__data__,u)&&n.push(i)}}return xt(t,this.id,this.time).ease(this.ease())},Ns.attr=function(e,t){if(arguments.length<2){for(t in e){this.attrTween(t,Ct(e[t],t))}return this}return this.attrTween(e,Ct(t,e))},Ns.attrTween=function(e,t){function n(e,n){var r=t.call(this,e,n,this.getAttribute(i));return r===Ps?(this.removeAttribute(i),null):r&&function(e){this.setAttribute(i,r(e))}}function r(e,n){var r=t.call(this,e,n,this.getAttributeNS(i.space,i.local));return r===Ps?(this.removeAttributeNS(i.space,i.local),null):r&&function(e){this.setAttributeNS(i.space,i.local,r(e))}}var i=d3.ns.qualify(e);return this.tween("attr."+e,i.local?r:n)},Ns.style=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t="");for(n in e){this.styleTween(n,Ct(e[n],n),t)}return this}n=""}return this.styleTween(e,Ct(t,e),n)},Ns.styleTween=function(e,t,n){return arguments.length<3&&(n=""),this.tween("style."+e,function(r,i){var s=t.call(this,r,i,window.getComputedStyle(this,null).getPropertyValue(e));return s===Ps?(this.style.removeProperty(e),null):s&&function(t){this.style.setProperty(e,s(t),n)}})},Ns.text=function(e){return this.tween("text",function(t,n){this.textContent=typeof e=="function"?e.call(this,t,n):e})},Ns.remove=function(){return this.each("end.transition",function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)})},Ns.delay=function(e){return Et(this,typeof e=="function"?function(t,n,r){t.delay=e.call(t=t.node,t.__data__,n,r)|0}:(e|=0,function(t){t.delay=e}))},Ns.duration=function(e){return Et(this,typeof e=="function"?function(t,n,r){t.duration=Math.max(1,e.call(t=t.node,t.__data__,n,r)|0)}:(e=Math.max(1,e|0),function(t){t.duration=e}))},Ns.transition=function(){return this.select(s)},d3.tween=function(e,t){function n(n,r,i){var s=e.call(this,n,r);return s==null?i!=""&&Ps:i!=s&&t(i,s)}function r(n,r,i){return i!=e&&t(i,e)}return typeof e=="function"?n:e==null?Nt:(e+="",r)};var Ps={},Hs=null,Bs,js;d3.timer=function(e,t,n){var r=!1,i,s=Hs;if(arguments.length<3){if(arguments.length<2){t=0}else{if(!isFinite(t)){return}}n=Date.now()}while(s){if(s.callback===e){s.then=n,s.delay=t,r=!0;break}i=s,s=s.next}r||(Hs={callback:e,then:n,delay:t,next:Hs}),Bs||(js=clearTimeout(js),Bs=1,Fs(kt))},d3.timer.flush=function(){var e,t=Date.now(),n=Hs;while(n){e=t-n.then,n.delay||(n.flush=n.callback(e)),n=n.next}Lt()};var Fs=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};d3.mouse=function(e){return At(e,_())};var Is=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(e,t){return arguments.length<2&&(t=_().touches),t?$i(t).map(function(t){var n=At(e,t);return n.identifier=t.identifier,n}):[]},d3.scale={},d3.scale.linear=function(){return Ht([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return zt(d3.scale.linear(),Wt)};var qs=d3.format(".0e");Wt.pow=function(e){return Math.pow(10,e)},Xt.pow=function(e){return -Math.pow(10,-e)},d3.scale.pow=function(){return Vt(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(0.5)},d3.scale.ordinal=function(){return Jt([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(Rs)},d3.scale.category20=function(){return d3.scale.ordinal().range(Us)},d3.scale.category20b=function(){return d3.scale.ordinal().range(zs)},d3.scale.category20c=function(){return d3.scale.ordinal().range(Ws)};var Rs=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Us=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],zs=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],Ws=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return Kt([],[])},d3.scale.quantize=function(){return Qt(0,1,[0,1])},d3.scale.threshold=function(){return Gt([0.5],[0,1])},d3.scale.identity=function(){return Yt([0,1])},d3.svg={},d3.svg.arc=function(){function e(){var e=t.apply(this,arguments),s=n.apply(this,arguments),o=r.apply(this,arguments)+Xs,u=i.apply(this,arguments)+Xs,a=(u<o&&(a=o,o=u,u=a),u-o),f=a<Math.PI?"0":"1",l=Math.cos(o),c=Math.sin(o),h=Math.cos(u),p=Math.sin(u);return a>=Vs?e?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+-s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+-e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+-s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":e?"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L"+e*h+","+e*p+"A"+e+","+e+" 0 "+f+",0 "+e*l+","+e*c+"Z":"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L0,0Z"}var t=Zt,n=en,r=tn,i=nn;return e.innerRadius=function(n){return arguments.length?(t=u(n),e):t},e.outerRadius=function(t){return arguments.length?(n=u(t),e):n},e.startAngle=function(t){return arguments.length?(r=u(t),e):r},e.endAngle=function(t){return arguments.length?(i=u(t),e):i},e.centroid=function(){var e=(t.apply(this,arguments)+n.apply(this,arguments))/2,s=(r.apply(this,arguments)+i.apply(this,arguments))/2+Xs;return[Math.cos(s)*e,Math.sin(s)*e]},e};var Xs=-Math.PI/2,Vs=2*Math.PI-0.000001;d3.svg.line=function(){return rn(i)};var $s=d3.map({linear:un,"linear-closed":an,"step-before":fn,"step-after":ln,basis:mn,"basis-open":gn,"basis-closed":yn,bundle:bn,cardinal:pn,"cardinal-open":cn,"cardinal-closed":hn,monotone:Nn});$s.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var Js=[0,2/3,1/3,0],Ks=[0,1/3,2/3,0],Qs=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var e=rn(Cn);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},fn.reverse=ln,ln.reverse=fn,d3.svg.area=function(){return kn(i)},d3.svg.area.radial=function(){var e=kn(Cn);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},d3.svg.chord=function(){function e(e,u){var a=t(this,s,e,u),f=t(this,o,e,u);return"M"+a.p0+r(a.r,a.p1,a.a1-a.a0)+(n(a,f)?i(a.r,a.p1,a.r,a.p0):i(a.r,a.p1,f.r,f.p0)+r(f.r,f.p1,f.a1-f.a0)+i(f.r,f.p1,a.r,a.p0))+"Z"}function t(e,t,n,r){var i=t.call(e,n,r),s=a.call(e,i,r),o=f.call(e,i,r)+Xs,u=l.call(e,i,r)+Xs;return{r:s,a0:o,a1:u,p0:[s*Math.cos(o),s*Math.sin(o)],p1:[s*Math.cos(u),s*Math.sin(u)]}}function n(e,t){return e.a0==t.a0&&e.a1==t.a1}function r(e,t,n){return"A"+e+","+e+" 0 "+ +(n>Math.PI)+",1 "+t}function i(e,t,n,r){return"Q 0,0 "+r}var s=Ln,o=An,a=On,f=tn,l=nn;return e.radius=function(t){return arguments.length?(a=u(t),e):a},e.source=function(t){return arguments.length?(s=u(t),e):s},e.target=function(t){return arguments.length?(o=u(t),e):o},e.startAngle=function(t){return arguments.length?(f=u(t),e):f},e.endAngle=function(t){return arguments.length?(l=u(t),e):l},e},d3.svg.diagonal=function(){function e(e,i){var s=t.call(this,e,i),o=n.call(this,e,i),u=(s.y+o.y)/2,a=[s,{x:s.x,y:u},{x:o.x,y:u},o];return a=a.map(r),"M"+a[0]+"C"+a[1]+" "+a[2]+" "+a[3]}var t=Ln,n=An,r=Dn;return e.source=function(n){return arguments.length?(t=u(n),e):t},e.target=function(t){return arguments.length?(n=u(t),e):n},e.projection=function(t){return arguments.length?(r=t,e):r},e},d3.svg.diagonal.radial=function(){var e=d3.svg.diagonal(),t=Dn,n=e.projection;return e.projection=function(e){return arguments.length?n(Pn(t=e)):t},e},d3.svg.mouse=d3.mouse,d3.svg.touches=d3.touches,d3.svg.symbol=function(){function e(e,r){return(Gs.get(t.call(this,e,r))||jn)(n.call(this,e,r))}var t=Bn,n=Hn;return e.type=function(n){return arguments.length?(t=u(n),e):t},e.size=function(t){return arguments.length?(n=u(t),e):n},e};var Gs=d3.map({circle:jn,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*Zs)),n=t*Zs;return"M0,"+-t+"L"+n+",0 0,"+t+" "+-n+",0Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Ys),n=t*Ys/2;return"M0,"+n+"L"+t+","+-n+" "+-t+","+-n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Ys),n=t*Ys/2;return"M0,"+-n+"L"+t+","+n+" "+-t+","+n+"Z"}});d3.svg.symbolTypes=Gs.keys();var Ys=Math.sqrt(3),Zs=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function e(e){e.each(function(){var e=d3.select(this),c=a==null?t.ticks?t.ticks.apply(t,u):t.domain():a,h=f==null?t.tickFormat?t.tickFormat.apply(t,u):String:f,p=qn(t,c,l),d=e.selectAll(".minor").data(p,String),v=d.enter().insert("line","g").attr("class","tick minor").style("opacity",0.000001),m=d3.transition(d.exit()).style("opacity",0.000001).remove(),g=d3.transition(d).style("opacity",1),y=e.selectAll("g").data(c,String),b=y.enter().insert("g","path").style("opacity",0.000001),w=d3.transition(y.exit()).style("opacity",0.000001).remove(),E=d3.transition(y).style("opacity",1),S,x=_t(t),T=e.selectAll(".domain").data([0]),N=T.enter().append("path").attr("class","domain"),C=d3.transition(T),k=t.copy(),L=this.__chart__||k;this.__chart__=k,b.append("line").attr("class","tick"),b.append("text");var A=b.select("line"),O=E.select("line"),M=y.select("text").text(h),_=b.select("text"),D=E.select("text");switch(n){case"bottom":S=Fn,v.attr("y2",i),g.attr("x2",0).attr("y2",i),A.attr("y2",r),_.attr("y",Math.max(r,0)+o),O.attr("x2",0).attr("y2",r),D.attr("x",0).attr("y",Math.max(r,0)+o),M.attr("dy",".71em").attr("text-anchor","middle"),C.attr("d","M"+x[0]+","+s+"V0H"+x[1]+"V"+s);break;case"top":S=Fn,v.attr("y2",-i),g.attr("x2",0).attr("y2",-i),A.attr("y2",-r),_.attr("y",-(Math.max(r,0)+o)),O.attr("x2",0).attr("y2",-r),D.attr("x",0).attr("y",-(Math.max(r,0)+o)),M.attr("dy","0em").attr("text-anchor","middle"),C.attr("d","M"+x[0]+","+-s+"V0H"+x[1]+"V"+-s);break;case"left":S=In,v.attr("x2",-i),g.attr("x2",-i).attr("y2",0),A.attr("x2",-r),_.attr("x",-(Math.max(r,0)+o)),O.attr("x2",-r).attr("y2",0),D.attr("x",-(Math.max(r,0)+o)).attr("y",0),M.attr("dy",".32em").attr("text-anchor","end"),C.attr("d","M"+-s+","+x[0]+"H0V"+x[1]+"H"+-s);break;case"right":S=In,v.attr("x2",i),g.attr("x2",i).attr("y2",0),A.attr("x2",r),_.attr("x",Math.max(r,0)+o),O.attr("x2",r).attr("y2",0),D.attr("x",Math.max(r,0)+o).attr("y",0),M.attr("dy",".32em").attr("text-anchor","start"),C.attr("d","M"+s+","+x[0]+"H0V"+x[1]+"H"+s)}if(t.ticks){b.call(S,L),E.call(S,k),w.call(S,k),v.call(S,L),g.call(S,k),m.call(S,k)}else{var P=k.rangeBand()/2,H=function(e){return k(e)+P};b.call(S,H),E.call(S,H)}})}var t=d3.scale.linear(),n="bottom",r=6,i=6,s=6,o=3,u=[10],a=null,f,l=0;return e.scale=function(n){return arguments.length?(t=n,e):t},e.orient=function(t){return arguments.length?(n=t,e):n},e.ticks=function(){return arguments.length?(u=arguments,e):u},e.tickValues=function(t){return arguments.length?(a=t,e):a},e.tickFormat=function(t){return arguments.length?(f=t,e):f},e.tickSize=function(t,n,o){if(!arguments.length){return r}var u=arguments.length-1;return r=+t,i=u>1?+n:r,s=u>0?+arguments[u]:r,e},e.tickPadding=function(t){return arguments.length?(o=+t,e):o},e.tickSubdivide=function(t){return arguments.length?(l=+t,e):l},e},d3.svg.brush=function(){function e(s){s.each(function(){var s=d3.select(this),f=s.selectAll(".background").data([0]),l=s.selectAll(".extent").data([0]),c=s.selectAll(".resize").data(a,String),h;s.style("pointer-events","all").on("mousedown.brush",i).on("touchstart.brush",i),f.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),l.enter().append("rect").attr("class","extent").style("cursor","move"),c.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return eo[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),c.style("display",e.empty()?"none":null),c.exit().remove(),o&&(h=_t(o),f.attr("x",h[0]).attr("width",h[1]-h[0]),n(s)),u&&(h=_t(u),f.attr("y",h[0]).attr("height",h[1]-h[0]),r(s)),t(s)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+f[+/e$/.test(e)][0]+","+f[+/^s/.test(e)][1]+")"})}function n(e){e.select(".extent").attr("x",f[0][0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",f[1][0]-f[0][0])}function r(e){e.select(".extent").attr("y",f[0][1]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",f[1][1]-f[0][1])}function i(){function i(){var e=d3.event.changedTouches;return e?d3.touches(v,e)[0]:d3.mouse(v)}function a(){d3.event.keyCode==32&&(S||(x=null,T[0]-=f[1][0],T[1]-=f[1][1],S=2),M())}function c(){d3.event.keyCode==32&&S==2&&(T[0]+=f[1][0],T[1]+=f[1][1],S=0,M())}function h(){var e=i(),s=!1;N&&(e[0]+=N[0],e[1]+=N[1]),S||(d3.event.altKey?(x||(x=[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2]),T[0]=f[+(e[0]<x[0])][0],T[1]=f[+(e[1]<x[1])][1]):x=null),w&&p(e,o,0)&&(n(y),s=!0),E&&p(e,u,1)&&(r(y),s=!0),s&&(t(y),g({type:"brush",mode:S?"move":"resize"}))}function p(e,t,n){var r=_t(t),i=r[0],s=r[1],o=T[n],u=f[1][n]-f[0][n],a,c;S&&(i-=o,s-=u+o),a=Math.max(i,Math.min(s,e[n])),S?c=(a+=o)+u:(x&&(o=Math.max(i,Math.min(s,2*x[n]-a))),o<a?(c=a,a=o):c=o);if(f[0][n]!==a||f[1][n]!==c){return l=null,f[0][n]=a,f[1][n]=c,!0}}function d(){h(),y.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),d3.select("body").style("cursor",null),C.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),g({type:"brushend"}),M()}var v=this,m=d3.select(d3.event.target),g=s.of(v,arguments),y=d3.select(v),b=m.datum(),w=!/^(n|s)$/.test(b)&&o,E=!/^(e|w)$/.test(b)&&u,S=m.classed("extent"),x,T=i(),N,C=d3.select(window).on("mousemove.brush",h).on("mouseup.brush",d).on("touchmove.brush",h).on("touchend.brush",d).on("keydown.brush",a).on("keyup.brush",c);if(S){T[0]=f[0][0]-T[0],T[1]=f[0][1]-T[1]}else{if(b){var k=+/w$/.test(b),L=+/^n/.test(b);N=[f[1-k][0]-T[0],f[1-L][1]-T[1]],T[0]=f[k][0],T[1]=f[L][1]}else{d3.event.altKey&&(x=T.slice())}}y.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",m.style("cursor")),g({type:"brushstart"}),h(),M()}var s=D(e,"brushstart","brush","brushend"),o=null,u=null,a=to[0],f=[[0,0],[0,0]],l;return e.x=function(t){return arguments.length?(o=t,a=to[!o<<1|!u],e):o},e.y=function(t){return arguments.length?(u=t,a=to[!o<<1|!u],e):u},e.extent=function(t){var n,r,i,s,a;return arguments.length?(l=[[0,0],[0,0]],o&&(n=t[0],r=t[1],u&&(n=n[0],r=r[0]),l[0][0]=n,l[1][0]=r,o.invert&&(n=o(n),r=o(r)),r<n&&(a=n,n=r,r=a),f[0][0]=n|0,f[1][0]=r|0),u&&(i=t[0],s=t[1],o&&(i=i[1],s=s[1]),l[0][1]=i,l[1][1]=s,u.invert&&(i=u(i),s=u(s)),s<i&&(a=i,i=s,s=a),f[0][1]=i|0,f[1][1]=s|0),e):(t=l||f,o&&(n=t[0][0],r=t[1][0],l||(n=f[0][0],r=f[1][0],o.invert&&(n=o.invert(n),r=o.invert(r)),r<n&&(a=n,n=r,r=a))),u&&(i=t[0][1],s=t[1][1],l||(i=f[0][1],s=f[1][1],u.invert&&(i=u.invert(i),s=u.invert(s)),s<i&&(a=i,i=s,s=a))),o&&u?[[n,i],[r,s]]:o?[n,r]:u&&[i,s])},e.clear=function(){return l=null,f[0][0]=f[0][1]=f[1][0]=f[1][1]=0,e},e.empty=function(){return o&&f[0][0]===f[1][0]||u&&f[0][1]===f[1][1]},d3.rebind(e,s,"on")};var eo={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},to=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={},d3.behavior.drag=function(){function e(){this.on("mousedown.drag",t).on("touchstart.drag",t)}function t(){function e(){var e=o.parentNode;return f?d3.touches(e).filter(function(e){return e.identifier===f})[0]:d3.mouse(e)}function t(){if(!o.parentNode){return i()}var t=e(),n=t[0]-c[0],r=t[1]-c[1];h|=n|r,c=t,M(),u({type:"drag",x:t[0]+l[0],y:t[1]+l[1],dx:n,dy:r})}function i(){u({type:"dragend"}),h&&(M(),d3.event.target===a&&p.on("click.drag",s,!0)),p.on(f?"touchmove.drag-"+f:"mousemove.drag",null).on(f?"touchend.drag-"+f:"mouseup.drag",null)}function s(){M(),p.on("click.drag",null)}var o=this,u=n.of(o,arguments),a=d3.event.target,f=d3.event.touches&&d3.event.changedTouches[0].identifier,l,c=e(),h=0,p=d3.select(window).on(f?"touchmove.drag-"+f:"mousemove.drag",t).on(f?"touchend.drag-"+f:"mouseup.drag",i,!0);r?(l=r.apply(o,arguments),l=[l.x-c[0],l.y-c[1]]):l=[0,0],f||M(),u({type:"dragstart"})}var n=D(e,"drag","dragstart","dragend"),r=null;return e.origin=function(t){return arguments.length?(r=t,e):r},d3.rebind(e,n,"on")},d3.behavior.zoom=function(){function e(){this.on("mousedown.zoom",o).on("mousewheel.zoom",u).on("mousemove.zoom",a).on("DOMMouseScroll.zoom",u).on("dblclick.zoom",f).on("touchstart.zoom",l).on("touchmove.zoom",c).on("touchend.zoom",l)}function t(e){return[(e[0]-h[0])/d,(e[1]-h[1])/d]}function n(e){return[e[0]*d+h[0],e[1]*d+h[1]]}function r(e){d=Math.max(m[0],Math.min(m[1],e))}function i(e,t){t=n(t),h[0]+=e[0]-t[0],h[1]+=e[1]-t[1]}function s(e){b&&b.domain(y.range().map(function(e){return(e-h[0])/d}).map(y.invert)),E&&E.domain(w.range().map(function(e){return(e-h[1])/d}).map(w.invert)),d3.event.preventDefault(),e({type:"zoom",scale:d,translate:h})}function o(){function e(){f=1,i(d3.mouse(o),c),s(u)}function n(){f&&M(),l.on("mousemove.zoom",null).on("mouseup.zoom",null),f&&d3.event.target===a&&l.on("click.zoom",r,!0)}function r(){M(),l.on("click.zoom",null)}var o=this,u=g.of(o,arguments),a=d3.event.target,f=0,l=d3.select(window).on("mousemove.zoom",e).on("mouseup.zoom",n),c=t(d3.mouse(o));window.focus(),M()}function u(){p||(p=t(d3.mouse(this))),r(Math.pow(2,Rn()*0.002)*d),i(d3.mouse(this),p),s(g.of(this,arguments))}function a(){p=null}function f(){var e=d3.mouse(this),n=t(e);r(d3.event.shiftKey?d/2:d*2),i(e,n),s(g.of(this,arguments))}function l(){var e=d3.touches(this),n=Date.now();v=d,p={},e.forEach(function(e){p[e.identifier]=t(e)}),M();if(e.length===1){if(n-S<500){var o=e[0],u=t(e[0]);r(d*2),i(o,u),s(g.of(this,arguments))}S=n}}function c(){var e=d3.touches(this),t=e[0],n=p[t.identifier];if(o=e[1]){var o,u=p[o.identifier];t=[(t[0]+o[0])/2,(t[1]+o[1])/2],n=[(n[0]+u[0])/2,(n[1]+u[1])/2],r(d3.event.scale*v)}i(t,n),S=null,s(g.of(this,arguments))}var h=[0,0],p,d=1,v,m=ro,g=D(e,"zoom"),y,b,w,E,S;return e.translate=function(t){return arguments.length?(h=t.map(Number),e):h},e.scale=function(t){return arguments.length?(d=+t,e):d},e.scaleExtent=function(t){return arguments.length?(m=t==null?ro:t.map(Number),e):m},e.x=function(t){return arguments.length?(b=t,y=t.copy(),e):b},e.y=function(t){return arguments.length?(E=t,w=t.copy(),e):E},d3.rebind(e,g,"on")};var no,ro=[0,Infinity];d3.layout={},d3.layout.bundle=function(){return function(e){var t=[],n=-1,r=e.length;while(++n<r){t.push(Un(e[n]))}return t}},d3.layout.chord=function(){function e(){var e={},n=[],c=d3.range(o),h=[],p,d,v,m,g;r=[],i=[],p=0,m=-1;while(++m<o){d=0,g=-1;while(++g<o){d+=s[m][g]}n.push(d),h.push(d3.range(o)),p+=d}a&&c.sort(function(e,t){return a(n[e],n[t])}),f&&h.forEach(function(e,t){e.sort(function(e,n){return f(s[t][e],s[t][n])})}),p=(2*Math.PI-u*o)/p,d=0,m=-1;while(++m<o){v=d,g=-1;while(++g<o){var y=c[m],b=h[y][g],w=s[y][b],E=d,S=d+=w*p;e[y+"-"+b]={index:y,subindex:b,startAngle:E,endAngle:S,value:w}}i[y]={index:y,startAngle:v,endAngle:d,value:(d-v)/p},d+=u}m=-1;while(++m<o){g=m-1;while(++g<o){var x=e[m+"-"+g],T=e[g+"-"+m];(x.value||T.value)&&r.push(x.value<T.value?{source:T,target:x}:{source:x,target:T})}}l&&t()}function t(){r.sort(function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n={},r,i,s,o,u=0,a,f,l;return n.matrix=function(e){return arguments.length?(o=(s=e)&&s.length,r=i=null,n):s},n.padding=function(e){return arguments.length?(u=e,r=i=null,n):u},n.sortGroups=function(e){return arguments.length?(a=e,r=i=null,n):a},n.sortSubgroups=function(e){return arguments.length?(f=e,r=null,n):f},n.sortChords=function(e){return arguments.length?(l=e,r&&t(),n):l},n.chords=function(){return r||e(),r},n.groups=function(){return i||e(),i},n},d3.layout.force=function(){function e(e){return function(t,n,r,i,s){if(t.point!==e){var o=t.cx-e.x,u=t.cy-e.y,a=1/Math.sqrt(o*o+u*u);if((i-n)*a<d){var f=t.charge*a*a;return e.px-=o*f,e.py-=u*f,!0}if(t.point&&isFinite(a)){var f=t.pointCharge*a*a;e.px-=o*f,e.py-=u*f}}return !t.charge}}function t(e){e.px=d3.event.x,e.py=d3.event.y,n.resume()}var n={},r=d3.dispatch("start","tick","end"),s=[1,1],o,a,f=0.9,l=Qn,c=Gn,h=-30,p=0.1,d=0.8,v,m=[],g=[],y,b,w;return n.tick=function(){if((a*=0.99)<0.005){return r.end({type:"end",alpha:a=0}),!0}var t=m.length,n=g.length,i,o,u,l,c,d,v,E,S;for(o=0;o<n;++o){u=g[o],l=u.source,c=u.target,E=c.x-l.x,S=c.y-l.y;if(d=E*E+S*S){d=a*b[o]*((d=Math.sqrt(d))-y[o])/d,E*=d,S*=d,c.x-=E*(v=l.weight/(c.weight+l.weight)),c.y-=S*v,l.x+=E*(v=1-v),l.y+=S*v}}if(v=a*p){E=s[0]/2,S=s[1]/2,o=-1;if(v){while(++o<t){u=m[o],u.x+=(E-u.x)*v,u.y+=(S-u.y)*v}}}if(h){Kn(i=d3.geom.quadtree(m),a,w),o=-1;while(++o<t){(u=m[o]).fixed||i.visit(e(u))}}o=-1;while(++o<t){u=m[o],u.fixed?(u.x=u.px,u.y=u.py):(u.x-=(u.px-(u.px=u.x))*f,u.y-=(u.py-(u.py=u.y))*f)}r.tick({type:"tick",alpha:a})},n.nodes=function(e){return arguments.length?(m=e,n):m},n.links=function(e){return arguments.length?(g=e,n):g},n.size=function(e){return arguments.length?(s=e,n):s},n.linkDistance=function(e){return arguments.length?(l=u(e),n):l},n.distance=n.linkDistance,n.linkStrength=function(e){return arguments.length?(c=u(e),n):c},n.friction=function(e){return arguments.length?(f=e,n):f},n.charge=function(e){return arguments.length?(h=typeof e=="function"?e:+e,n):h},n.gravity=function(e){return arguments.length?(p=e,n):p},n.theta=function(e){return arguments.length?(d=e,n):d},n.alpha=function(e){return arguments.length?(a?e>0?a=e:a=0:e>0&&(r.start({type:"start",alpha:a=e}),d3.timer(n.tick)),n):a},n.start=function(){function e(e,n){var i=t(r),s=-1,o=i.length,u;while(++s<o){if(!isNaN(u=i[s][e])){return u}}return Math.random()*n}function t(){if(!p){p=[];for(i=0;i<o;++i){p[i]=[]}for(i=0;i<u;++i){var e=g[i];p[e.source.index].push(e.target),p[e.target.index].push(e.source)}}return p[r]}var r,i,o=m.length,u=g.length,a=s[0],f=s[1],p,d;for(r=0;r<o;++r){(d=m[r]).index=r,d.weight=0}y=[],b=[];for(r=0;r<u;++r){d=g[r],typeof d.source=="number"&&(d.source=m[d.source]),typeof d.target=="number"&&(d.target=m[d.target]),y[r]=l.call(this,d,r),b[r]=c.call(this,d,r),++d.source.weight,++d.target.weight}for(r=0;r<o;++r){d=m[r],isNaN(d.x)&&(d.x=e("x",a)),isNaN(d.y)&&(d.y=e("y",f)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y)}w=[];if(typeof h=="function"){for(r=0;r<o;++r){w[r]=+h.call(this,m[r],r)}}else{for(r=0;r<o;++r){w[r]=h}}return n.resume()},n.resume=function(){return n.alpha(0.1)},n.stop=function(){return n.alpha(0)},n.drag=function(){o||(o=d3.behavior.drag().origin(i).on("dragstart",Xn).on("drag",t).on("dragend",Vn)),this.on("mouseover.force",$n).on("mouseout.force",Jn).call(o)},d3.rebind(n,r,"on")},d3.layout.partition=function(){function e(t,n,r,i){var s=t.children;t.x=n,t.y=t.depth*i,t.dx=r,t.dy=i;if(s&&(u=s.length)){var o=-1,u,a,f;r=t.value?r/t.value:0;while(++o<u){e(a=s[o],n,f=a.value*r,i),n+=f}}}function t(e){var n=e.children,r=0;if(n&&(s=n.length)){var i=-1,s;while(++i<s){r=Math.max(r,t(n[i]))}}return 1+r}function n(n,s){var o=r.call(this,n,s);return e(o[0],0,i[0],i[1]/t(o[0])),o}var r=d3.layout.hierarchy(),i=[1,1];return n.size=function(e){return arguments.length?(i=e,n):i},fr(n,r)},d3.layout.pie=function(){function e(s,o){var u=s.map(function(n,r){return +t.call(e,n,r)}),a=+(typeof r=="function"?r.apply(this,arguments):r),f=((typeof i=="function"?i.apply(this,arguments):i)-r)/d3.sum(u),l=d3.range(s.length);n!=null&&l.sort(n===io?function(e,t){return u[t]-u[e]}:function(e,t){return n(s[e],s[t])});var c=[];return l.forEach(function(e){var t;c[e]={data:s[e],value:t=u[e],startAngle:a,endAngle:a+=t*f}}),c}var t=Number,n=io,r=0,i=2*Math.PI;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(i=t,e):i},e};var io={};d3.layout.stack=function(){function e(i,a){var f=i.map(function(n,r){return t.call(e,n,r)}),l=f.map(function(t,n){return t.map(function(t,n){return[o.call(e,t,n),u.call(e,t,n)]})}),c=n.call(e,l,a);f=d3.permute(f,c),l=d3.permute(l,c);var h=r.call(e,l,a),p=f.length,d=f[0].length,v,m,g;for(m=0;m<d;++m){s.call(e,f[0][m],g=h[m],l[0][m][1]);for(v=1;v<p;++v){s.call(e,f[v][m],g+=l[v-1][m][1],l[v][m][1])}}return i}var t=i,n=tr,r=nr,s=er,o=Yn,u=Zn;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n=typeof t=="function"?t:so.get(t)||tr,e):n},e.offset=function(t){return arguments.length?(r=typeof t=="function"?t:oo.get(t)||nr,e):r},e.x=function(t){return arguments.length?(o=t,e):o},e.y=function(t){return arguments.length?(u=t,e):u},e.out=function(t){return arguments.length?(s=t,e):s},e};var so=d3.map({"inside-out":function(e){var t=e.length,n,r,i=e.map(rr),s=e.map(ir),o=d3.range(t).sort(function(e,t){return i[e]-i[t]}),u=0,a=0,f=[],l=[];for(n=0;n<t;++n){r=o[n],u<a?(u+=s[r],f.push(r)):(a+=s[r],l.push(r))}return l.reverse().concat(f)},reverse:function(e){return d3.range(e.length).reverse()},"default":tr}),oo=d3.map({silhouette:function(e){var t=e.length,n=e[0].length,r=[],i=0,s,o,u,a=[];for(o=0;o<n;++o){for(s=0,u=0;s<t;s++){u+=e[s][o][1]}u>i&&(i=u),r.push(u)}for(o=0;o<n;++o){a[o]=(i-r[o])/2}return a},wiggle:function(e){var t=e.length,n=e[0],r=n.length,i=0,s,o,u,a,f,l,c,h,p,d=[];d[0]=h=p=0;for(o=1;o<r;++o){for(s=0,a=0;s<t;++s){a+=e[s][o][1]}for(s=0,f=0,c=n[o][0]-n[o-1][0];s<t;++s){for(u=0,l=(e[s][o][1]-e[s][o-1][1])/(2*c);u<s;++u){l+=(e[u][o][1]-e[u][o-1][1])/c}f+=l*e[s][o][1]}d[o]=h-=a?f/a*c:0,h<p&&(p=h)}for(o=0;o<r;++o){d[o]-=p}return d},expand:function(e){var t=e.length,n=e[0].length,r=1/t,i,s,o,u=[];for(s=0;s<n;++s){for(i=0,o=0;i<t;i++){o+=e[i][s][1]}if(o){for(i=0;i<t;i++){e[i][s][1]/=o}}else{for(i=0;i<t;i++){e[i][s][1]=r}}}for(s=0;s<n;++s){u[s]=0}return u},zero:nr});d3.layout.histogram=function(){function e(e,s){var o=[],u=e.map(n,this),a=r.call(this,u,s),f=i.call(this,a,u,s),l,s=-1,c=u.length,h=f.length-1,p=t?1:1/c,d;while(++s<h){l=o[s]=[],l.dx=f[s+1]-(l.x=f[s]),l.y=0}if(h>0){s=-1;while(++s<c){d=u[s],d>=a[0]&&d<=a[1]&&(l=o[d3.bisect(f,d,1,h)-1],l.y+=p,l.push(e[s]))}}return o}var t=!0,n=Number,r=ar,i=or;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(r=u(t),e):r},e.bins=function(t){return arguments.length?(i=typeof t=="number"?function(e){return ur(e,t)}:u(t),e):i},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},d3.layout.hierarchy=function(){function e(t,o,u){var a=i.call(n,t,o),f=uo?t:{data:t};f.depth=o,u.push(f);if(a&&(c=a.length)){var l=-1,c,h=f.children=[],p=0,d=o+1,v;while(++l<c){v=e(a[l],d,u),v.parent=f,h.push(v),p+=v.value}r&&h.sort(r),s&&(f.value=p)}else{s&&(f.value=+s.call(n,t,o)||0)}return f}function t(e,r){var i=e.children,o=0;if(i&&(a=i.length)){var u=-1,a,f=r+1;while(++u<a){o+=t(i[u],f)}}else{s&&(o=+s.call(n,uo?e:e.data,r)||0)}return s&&(e.value=o),o}function n(t){var n=[];return e(t,0,n),n}var r=hr,i=lr,s=cr;return n.sort=function(e){return arguments.length?(r=e,n):r},n.children=function(e){return arguments.length?(i=e,n):i},n.value=function(e){return arguments.length?(s=e,n):s},n.revalue=function(e){return t(e,0),e},n};var uo=!1;d3.layout.pack=function(){function e(e,i){var s=t.call(this,e,i),o=s[0];o.x=0,o.y=0,Pr(o,function(e){e.r=Math.sqrt(e.value)}),Pr(o,yr);var u=r[0],a=r[1],f=Math.max(2*o.r/u,2*o.r/a);if(n>0){var l=n*f/2;Pr(o,function(e){e.r+=l}),Pr(o,yr),Pr(o,function(e){e.r-=l}),f=Math.max(2*o.r/u,2*o.r/a)}return Er(o,u/2,a/2,1/f),s}var t=d3.layout.hierarchy().sort(dr),n=0,r=[1,1];return e.size=function(t){return arguments.length?(r=t,e):r},e.padding=function(t){return arguments.length?(n=+t,e):n},fr(e,t)},d3.layout.cluster=function(){function e(e,i){var s=t.call(this,e,i),o=s[0],u,a=0,f,l;Pr(o,function(e){var t=e.children;t&&t.length?(e.x=Tr(t),e.y=xr(t)):(e.x=u?a+=n(e,u):0,e.y=0,u=e)});var c=Nr(o),h=Cr(o),p=c.x-n(c,h)/2,d=h.x+n(h,c)/2;return Pr(o,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=(1-(o.y?e.y/o.y:1))*r[1]}),s}var t=d3.layout.hierarchy().sort(null).value(null),n=kr,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},fr(e,t)},d3.layout.tree=function(){function e(e,i){function s(e,t){var r=e.children,i=e._tree;if(r&&(o=r.length)){var o,a=r[0],f,l=a,c,h=-1;while(++h<o){c=r[h],s(c,f),l=u(c,f,l),f=c}Hr(e);var p=0.5*(a._tree.prelim+c._tree.prelim);t?(i.prelim=t._tree.prelim+n(e,t),i.mod=i.prelim-p):i.prelim=p}else{t&&(i.prelim=t._tree.prelim+n(e,t))}}function o(e,t){e.x=e._tree.prelim+t;var n=e.children;if(n&&(i=n.length)){var r=-1,i;t+=e._tree.mod;while(++r<i){o(n[r],t)}}}function u(e,t,r){if(t){var i=e,s=e,o=t,u=e.parent.children[0],a=i._tree.mod,f=s._tree.mod,l=o._tree.mod,c=u._tree.mod,h;while(o=Ar(o),i=Lr(i),o&&i){u=Lr(u),s=Ar(s),s._tree.ancestor=e,h=o._tree.prelim+l-i._tree.prelim-a+n(o,i),h>0&&(Br(jr(o,e,r),e,h),a+=h,f+=h),l+=o._tree.mod,a+=i._tree.mod,c+=u._tree.mod,f+=s._tree.mod}o&&!Ar(s)&&(s._tree.thread=o,s._tree.mod+=l-f),i&&!Lr(u)&&(u._tree.thread=i,u._tree.mod+=a-c,r=e)}return r}var a=t.call(this,e,i),f=a[0];Pr(f,function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),s(f),o(f,-f._tree.prelim);var l=Or(f,_r),c=Or(f,Mr),h=Or(f,Dr),p=l.x-n(l,c)/2,d=c.x+n(c,l)/2,v=h.depth||1;return Pr(f,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=e.depth/v*r[1],delete e._tree}),a}var t=d3.layout.hierarchy().sort(null).value(null),n=kr,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},fr(e,t)},d3.layout.treemap=function(){function e(e,t){var n=-1,r=e.length,i,s;while(++n<r){s=(i=e[n]).value*(t<0?0:t),i.area=isNaN(s)||s<=0?0:s}}function t(n){var s=n.children;if(s&&s.length){var o=l(n),u=[],a=s.slice(),f,c=Infinity,h,p=Math.min(o.dx,o.dy),d;e(a,o.dx*o.dy/n.value),u.area=0;while((d=a.length)>0){u.push(f=a[d-1]),u.area+=f.area,(h=r(u,p))<=c?(a.pop(),c=h):(u.area-=u.pop().area,i(u,p,o,!1),p=Math.min(o.dx,o.dy),u.length=u.area=0,c=Infinity)}u.length&&(i(u,p,o,!0),u.length=u.area=0),s.forEach(t)}}function n(t){var r=t.children;if(r&&r.length){var s=l(t),o=r.slice(),u,a=[];e(o,s.dx*s.dy/t.value),a.area=0;while(u=o.pop()){a.push(u),a.area+=u.area,u.z!=null&&(i(a,u.z?s.dx:s.dy,s,!o.length),a.length=a.area=0)}r.forEach(n)}}function r(e,t){var n=e.area,r,i=0,s=Infinity,o=-1,u=e.length;while(++o<u){if(!(r=e[o].area)){continue}r<s&&(s=r),r>i&&(i=r)}return n*=n,t*=t,n?Math.max(t*i*p/n,n/(t*s*p)):Infinity}function i(e,t,n,r){var i=-1,s=e.length,o=n.x,a=n.y,f=t?u(e.area/t):0,l;if(t==n.dx){if(r||f>n.dy){f=n.dy}while(++i<s){l=e[i],l.x=o,l.y=a,l.dy=f,o+=l.dx=Math.min(n.x+n.dx-o,f?u(l.area/f):0)}l.z=!0,l.dx+=n.x+n.dx-o,n.y+=f,n.dy-=f}else{if(r||f>n.dx){f=n.dx}while(++i<s){l=e[i],l.x=o,l.y=a,l.dx=f,a+=l.dy=Math.min(n.y+n.dy-a,f?u(l.area/f):0)}l.z=!1,l.dy+=n.y+n.dy-a,n.x+=f,n.dx-=f}}function s(r){var i=h||o(r),s=i[0];return s.x=0,s.y=0,s.dx=a[0],s.dy=a[1],h&&o.revalue(s),e([s],s.dx*s.dy/s.value),(h?n:t)(s),c&&(h=i),i}var o=d3.layout.hierarchy(),u=Math.round,a=[1,1],f=null,l=Fr,c=!1,h,p=0.5*(1+Math.sqrt(5));return s.size=function(e){return arguments.length?(a=e,s):a},s.padding=function(e){function t(t){var n=e.call(s,t,t.depth);return n==null?Fr(t):Ir(t,typeof n=="number"?[n,n,n,n]:n)}function n(t){return Ir(t,e)}if(!arguments.length){return f}var r;return l=(f=e)==null?Fr:(r=typeof e)==="function"?t:r==="number"?(e=[e,e,e,e],n):n,s},s.round=function(e){return arguments.length?(u=e?Math.round:Number,s):u!=Number},s.sticky=function(e){return arguments.length?(c=e,h=null,s):c},s.ratio=function(e){return arguments.length?(p=e,s):p},fr(s,o)},d3.csv=qr(",","text/csv"),d3.tsv=qr("	","text/tab-separated-values"),d3.geo={};var ao=Math.PI/180;d3.geo.azimuthal=function(){function e(e){var n=e[0]*ao-s,o=e[1]*ao,f=Math.cos(n),l=Math.sin(n),c=Math.cos(o),h=Math.sin(o),p=t!=="orthographic"?a*h+u*c*f:null,d,v=t==="stereographic"?1/(1+p):t==="gnomonic"?1/p:t==="equidistant"?(d=Math.acos(p),d?d/Math.sin(d):0):t==="equalarea"?Math.sqrt(2/(1+p)):1,m=v*c*l,g=v*(a*c*f-u*h);return[r*m+i[0],r*g+i[1]]}var t="orthographic",n,r=200,i=[480,250],s,o,u,a;return e.invert=function(e){var n=(e[0]-i[0])/r,o=(e[1]-i[1])/r,f=Math.sqrt(n*n+o*o),l=t==="stereographic"?2*Math.atan(f):t==="gnomonic"?Math.atan(f):t==="equidistant"?f:t==="equalarea"?2*Math.asin(0.5*f):Math.asin(f),c=Math.sin(l),h=Math.cos(l);return[(s+Math.atan2(n*c,f*u*h+o*a*c))/ao,Math.asin(h*a-(f?o*c*u/f:0))/ao]},e.mode=function(n){return arguments.length?(t=n+"",e):t},e.origin=function(t){return arguments.length?(n=t,s=n[0]*ao,o=n[1]*ao,u=Math.cos(o),a=Math.sin(o),e):n},e.scale=function(t){return arguments.length?(r=+t,e):r},e.translate=function(t){return arguments.length?(i=[+t[0],+t[1]],e):i},e.origin([0,0])},d3.geo.albers=function(){function e(e){var t=u*(ao*e[0]-o),n=Math.sqrt(a-2*u*Math.sin(ao*e[1]))/u;return[i*n*Math.sin(t)+s[0],i*(n*Math.cos(t)-f)+s[1]]}function t(){var t=ao*r[0],i=ao*r[1],s=ao*n[1],l=Math.sin(t),c=Math.cos(t);return o=ao*n[0],u=0.5*(l+Math.sin(i)),a=c*c+2*u*l,f=Math.sqrt(a-2*u*Math.sin(s))/u,e}var n=[-98,38],r=[29.5,45.5],i=1000,s=[480,250],o,u,a,f;return e.invert=function(e){var t=(e[0]-s[0])/i,n=(e[1]-s[1])/i,r=f+n,l=Math.atan2(t,r),c=Math.sqrt(t*t+r*r);return[(o+l/u)/ao,Math.asin((a-c*c*u*u)/(2*u))/ao]},e.origin=function(e){return arguments.length?(n=[+e[0],+e[1]],t()):n},e.parallels=function(e){return arguments.length?(r=[+e[0],+e[1]],t()):r},e.scale=function(t){return arguments.length?(i=+t,e):i},e.translate=function(t){return arguments.length?(s=[+t[0],+t[1]],e):s},t()},d3.geo.albersUsa=function(){function e(e){var s=e[0],o=e[1];return(o>50?n:s<-140?r:o<21?i:t)(e)}var t=d3.geo.albers(),n=d3.geo.albers().origin([-160,60]).parallels([55,65]),r=d3.geo.albers().origin([-160,20]).parallels([8,18]),i=d3.geo.albers().origin([-60,10]).parallels([8,18]);return e.scale=function(s){return arguments.length?(t.scale(s),n.scale(s*0.6),r.scale(s),i.scale(s*1.5),e.translate(t.translate())):t.scale()},e.translate=function(s){if(!arguments.length){return t.translate()}var o=t.scale()/1000,u=s[0],a=s[1];return t.translate(s),n.translate([u-400*o,a+170*o]),r.translate([u-190*o,a+200*o]),i.translate([u+580*o,a+430*o]),e},e.scale(t.scale())},d3.geo.bonne=function(){function e(e){var u=e[0]*ao-r,a=e[1]*ao-i;if(s){var f=o+s-a,l=u*Math.cos(a)/f;u=f*Math.sin(l),a=f*Math.cos(l)-o}else{u*=Math.cos(a),a*=-1}return[t*u+n[0],t*a+n[1]]}var t=200,n=[480,250],r,i,s,o;return e.invert=function(e){var i=(e[0]-n[0])/t,u=(e[1]-n[1])/t;if(s){var a=o+u,f=Math.sqrt(i*i+a*a);u=o+s-f,i=r+f*Math.atan2(i,a)/Math.cos(u)}else{u*=-1,i/=Math.cos(u)}return[i/ao,u/ao]},e.parallel=function(t){return arguments.length?(o=1/Math.tan(s=t*ao),e):s/ao},e.origin=function(t){return arguments.length?(r=t[0]*ao,i=t[1]*ao,e):[r/ao,i/ao]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e.origin([0,0]).parallel(45)},d3.geo.equirectangular=function(){function e(e){var r=e[0]/360,i=-e[1]/360;return[t*r+n[0],t*i+n[1]]}var t=500,n=[480,250];return e.invert=function(e){var r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return[360*r,-360*i]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e},d3.geo.mercator=function(){function e(e){var r=e[0]/360,i=-(Math.log(Math.tan(Math.PI/4+e[1]*ao/2))/ao)/360;return[t*r+n[0],t*Math.max(-0.5,Math.min(0.5,i))+n[1]]}var t=500,n=[480,250];return e.invert=function(e){var r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return[360*r,2*Math.atan(Math.exp(-360*i*ao))/ao-90]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e},d3.geo.path=function(){function e(e,t){typeof s=="function"&&(o=Ur(s.apply(this,arguments))),f(e);var n=a.length?a.join(""):null;return a=[],n}function t(e){return u(e).join(",")}function n(e){var t=i(e[0]),n=0,r=e.length;while(++n<r){t-=i(e[n])}return t}function r(e){var t=d3.geom.polygon(e[0].map(u)),n=t.area(),r=t.centroid(n<0?(n*=-1,1):-1),i=r[0],s=r[1],o=n,a=0,f=e.length;while(++a<f){t=d3.geom.polygon(e[a].map(u)),n=t.area(),r=t.centroid(n<0?(n*=-1,1):-1),i-=r[0],s-=r[1],o-=n}return[i,s,6*o]}function i(e){return Math.abs(d3.geom.polygon(e.map(u)).area())}var s=4.5,o=Ur(s),u=d3.geo.albersUsa(),a=[],f=Rr({FeatureCollection:function(e){var t=e.features,n=-1,r=t.length;while(++n<r){a.push(f(t[n].geometry))}},Feature:function(e){f(e.geometry)},Point:function(e){a.push("M",t(e.coordinates),o)},MultiPoint:function(e){var n=e.coordinates,r=-1,i=n.length;while(++r<i){a.push("M",t(n[r]),o)}},LineString:function(e){var n=e.coordinates,r=-1,i=n.length;a.push("M");while(++r<i){a.push(t(n[r]),"L")}a.pop()},MultiLineString:function(e){var n=e.coordinates,r=-1,i=n.length,s,o,u;while(++r<i){s=n[r],o=-1,u=s.length,a.push("M");while(++o<u){a.push(t(s[o]),"L")}a.pop()}},Polygon:function(e){var n=e.coordinates,r=-1,i=n.length,s,o,u;while(++r<i){s=n[r],o=-1;if((u=s.length-1)>0){a.push("M");while(++o<u){a.push(t(s[o]),"L")}a[a.length-1]="Z"}}},MultiPolygon:function(e){var n=e.coordinates,r=-1,i=n.length,s,o,u,f,l,c;while(++r<i){s=n[r],o=-1,u=s.length;while(++o<u){f=s[o],l=-1;if((c=f.length-1)>0){a.push("M");while(++l<c){a.push(t(f[l]),"L")}a[a.length-1]="Z"}}}},GeometryCollection:function(e){var t=e.geometries,n=-1,r=t.length;while(++n<r){a.push(f(t[n]))}}}),l=e.area=Rr({FeatureCollection:function(e){var t=0,n=e.features,r=-1,i=n.length;while(++r<i){t+=l(n[r])}return t},Feature:function(e){return l(e.geometry)},Polygon:function(e){return n(e.coordinates)},MultiPolygon:function(e){var t=0,r=e.coordinates,i=-1,s=r.length;while(++i<s){t+=n(r[i])}return t},GeometryCollection:function(e){var t=0,n=e.geometries,r=-1,i=n.length;while(++r<i){t+=l(n[r])}return t}},0),c=e.centroid=Rr({Feature:function(e){return c(e.geometry)},Polygon:function(e){var t=r(e.coordinates);return[t[0]/t[2],t[1]/t[2]]},MultiPolygon:function(e){var t=0,n=e.coordinates,i,s=0,o=0,u=0,a=-1,f=n.length;while(++a<f){i=r(n[a]),s+=i[0],o+=i[1],u+=i[2]}return[s/u,o/u]}});return e.projection=function(t){return u=t,e},e.pointRadius=function(t){return typeof t=="function"?s=t:(s=+t,o=Ur(s)),e},e},d3.geo.bounds=function(e){var t=Infinity,n=Infinity,r=-Infinity,i=-Infinity;return zr(e,function(e,s){e<t&&(t=e),e>r&&(r=e),s<n&&(n=s),s>i&&(i=s)}),[[t,n],[r,i]]};var fo={Feature:Wr,FeatureCollection:Xr,GeometryCollection:Vr,LineString:$r,MultiLineString:Jr,MultiPoint:$r,MultiPolygon:Kr,Point:Qr,Polygon:Gr};d3.geo.circle=function(){function e(){}function t(e){return a.distance(e)<u}function n(e){var t=-1,n=e.length,i=[],s,o,f,l,c;while(++t<n){c=a.distance(f=e[t]),c<u?(o&&i.push(ti(o,f)((l-u)/(l-c))),i.push(f),s=o=null):(o=f,!s&&i.length&&(i.push(ti(i[i.length-1],o)((u-l)/(c-l))),s=o)),l=c}return s=e[0],o=i[0],o&&f[0]===s[0]&&f[1]===s[1]&&(f[0]!==o[0]||f[1]!==o[1])&&i.push(o),r(i)}function r(e){var t=0,n=e.length,r,i,s=n?[e[0]]:e,o,u=a.source();while(++t<n){o=a.source(e[t-1])(e[t]).coordinates;for(r=0,i=o.length;++r<i;){s.push(o[r])}}return a.source(u),s}var s=[0,0],o=89.99,u=o*ao,a=d3.geo.greatArc().source(s).target(i);e.clip=function(e){return typeof s=="function"&&a.source(s.apply(this,arguments)),f(e)||null};var f=Rr({FeatureCollection:function(e){var t=e.features.map(f).filter(i);return t&&(e=Object.create(e),e.features=t,e)},Feature:function(e){var t=f(e.geometry);return t&&(e=Object.create(e),e.geometry=t,e)},Point:function(e){return t(e.coordinates)&&e},MultiPoint:function(e){var n=e.coordinates.filter(t);return n.length&&{type:e.type,coordinates:n}},LineString:function(e){var t=n(e.coordinates);return t.length&&(e=Object.create(e),e.coordinates=t,e)},MultiLineString:function(e){var t=e.coordinates.map(n).filter(function(e){return e.length});return t.length&&(e=Object.create(e),e.coordinates=t,e)},Polygon:function(e){var t=e.coordinates.map(n);return t[0].length&&(e=Object.create(e),e.coordinates=t,e)},MultiPolygon:function(e){var t=e.coordinates.map(function(e){return e.map(n)}).filter(function(e){return e[0].length});return t.length&&(e=Object.create(e),e.coordinates=t,e)},GeometryCollection:function(e){var t=e.geometries.map(f).filter(i);return t.length&&(e=Object.create(e),e.geometries=t,e)}});return e.origin=function(t){return arguments.length?(s=t,typeof s!="function"&&a.source(s),e):s},e.angle=function(t){return arguments.length?(u=(o=+t)*ao,e):o},d3.rebind(e,a,"precision")},d3.geo.greatArc=function(){function e(){var t=e.distance.apply(this,arguments),r=0,u=s/t,a=[n];while((r+=u)<1){a.push(o(r))}return a.push(i),{type:"LineString",coordinates:a}}var t=Yr,n,r=Zr,i,s=6*ao,o=ei();return e.distance=function(){return typeof t=="function"&&o.source(n=t.apply(this,arguments)),typeof r=="function"&&o.target(i=r.apply(this,arguments)),o.distance()},e.source=function(r){return arguments.length?(t=r,typeof t!="function"&&o.source(n=t),e):t},e.target=function(t){return arguments.length?(r=t,typeof r!="function"&&o.target(i=r),e):r},e.precision=function(t){return arguments.length?(s=t*ao,e):s/ao},e},d3.geo.greatCircle=d3.geo.circle,d3.geom={},d3.geom.contour=function(e,t){var n=t||ni(e),r=[],i=n[0],s=n[1],o=0,u=0,a=NaN,f=NaN,l=0;do{l=0,e(i-1,s-1)&&(l+=1),e(i,s-1)&&(l+=2),e(i-1,s)&&(l+=4),e(i,s)&&(l+=8),l===6?(o=f===-1?-1:1,u=0):l===9?(o=0,u=a===1?-1:1):(o=lo[l],u=co[l]),o!=a&&u!=f&&(r.push([i,s]),a=o,f=u),i+=o,s+=u}while(n[0]!=i||n[1]!=s);return r};var lo=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],co=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(e){if(e.length<3){return[]}var t=e.length,n=t-1,r=[],i=[],s,o,u=0,a,f,l,c,h,p,d,v;for(s=1;s<t;++s){e[s][1]<e[u][1]?u=s:e[s][1]==e[u][1]&&(u=e[s][0]<e[u][0]?s:u)}for(s=0;s<t;++s){if(s===u){continue}f=e[s][1]-e[u][1],a=e[s][0]-e[u][0],r.push({angle:Math.atan2(f,a),index:s})}r.sort(function(e,t){return e.angle-t.angle}),d=r[0].angle,p=r[0].index,h=0;for(s=1;s<n;++s){o=r[s].index,d==r[s].angle?(a=e[p][0]-e[u][0],f=e[p][1]-e[u][1],l=e[o][0]-e[u][0],c=e[o][1]-e[u][1],a*a+f*f>=l*l+c*c?r[s].index=-1:(r[h].index=-1,d=r[s].angle,h=s,p=o)):(d=r[s].angle,h=s,p=o)}i.push(u);for(s=0,o=0;s<2;++o){r[o].index!==-1&&(i.push(r[o].index),s++)}v=i.length;for(;o<n;++o){if(r[o].index===-1){continue}while(!ri(i[v-2],i[v-1],r[o].index,e)){--v}i[v++]=r[o].index}var m=[];for(s=0;s<v;++s){m.push(e[i[s]])}return m},d3.geom.polygon=function(e){return e.area=function(){var t=0,n=e.length,r=e[n-1][0]*e[0][1],i=e[n-1][1]*e[0][0];while(++t<n){r+=e[t-1][0]*e[t][1],i+=e[t-1][1]*e[t][0]}return(i-r)*0.5},e.centroid=function(t){var n=-1,r=e.length,i=0,s=0,o,u=e[r-1],a;arguments.length||(t=-1/(6*e.area()));while(++n<r){o=u,u=e[n],a=o[0]*u[1]-u[0]*o[1],i+=(o[0]+u[0])*a,s+=(o[1]+u[1])*a}return[i*t,s*t]},e.clip=function(t){var n,r=-1,i=e.length,s,o,u=e[i-1],a,f,l;while(++r<i){n=t.slice(),t.length=0,a=e[r],f=n[(o=n.length)-1],s=-1;while(++s<o){l=n[s],ii(l,u,a)?(ii(f,u,a)||t.push(si(f,l,u,a)),t.push(l)):ii(f,u,a)&&t.push(si(f,l,u,a)),f=l}u=a}return t},e},d3.geom.voronoi=function(e){var t=e.map(function(){return[]});return oi(e,function(e){var n,r,i,s,o,u;e.a===1&&e.b>=0?(n=e.ep.r,r=e.ep.l):(n=e.ep.l,r=e.ep.r),e.a===1?(o=n?n.y:-1000000,i=e.c-e.b*o,u=r?r.y:1000000,s=e.c-e.b*u):(i=n?n.x:-1000000,o=e.c-e.a*i,s=r?r.x:1000000,u=e.c-e.a*s);var a=[i,o],f=[s,u];t[e.region.l.index].push(a,f),t[e.region.r.index].push(a,f)}),t.map(function(t,n){var r=e[n][0],i=e[n][1];return t.forEach(function(e){e.angle=Math.atan2(e[0]-r,e[1]-i)}),t.sort(function(e,t){return e.angle-t.angle}).filter(function(e,n){return !n||e.angle-t[n-1].angle>1e-10})})};var ho={l:"r",r:"l"};d3.geom.delaunay=function(e){var t=e.map(function(){return[]}),n=[];return oi(e,function(n){t[n.region.l.index].push(e[n.region.r.index])}),t.forEach(function(t,r){var i=e[r],s=i[0],o=i[1];t.forEach(function(e){e.angle=Math.atan2(e[0]-s,e[1]-o)}),t.sort(function(e,t){return e.angle-t.angle});for(var u=0,a=t.length-1;u<a;u++){n.push([i,t[u],t[u+1]])}}),n},d3.geom.quadtree=function(e,t,n,r,i){function s(e,t,n,r,i,s){if(isNaN(t.x)||isNaN(t.y)){return}if(e.leaf){var u=e.point;u?Math.abs(u.x-t.x)+Math.abs(u.y-t.y)<0.01?o(e,t,n,r,i,s):(e.point=null,o(e,u,n,r,i,s),o(e,t,n,r,i,s)):e.point=t}else{o(e,t,n,r,i,s)}}function o(e,t,n,r,i,o){var u=(n+i)*0.5,a=(r+o)*0.5,f=t.x>=u,l=t.y>=a,c=(l<<1)+f;e.leaf=!1,e=e.nodes[c]||(e.nodes[c]=ui()),f?n=u:i=u,l?r=a:o=a,s(e,t,n,r,i,o)}var u,a=-1,f=e.length;f&&isNaN(e[0].x)&&(e=e.map(fi));if(arguments.length<5){if(arguments.length===3){i=r=n,n=t}else{t=n=Infinity,r=i=-Infinity;while(++a<f){u=e[a],u.x<t&&(t=u.x),u.y<n&&(n=u.y),u.x>r&&(r=u.x),u.y>i&&(i=u.y)}var l=r-t,c=i-n;l>c?i=n+l:r=t+c}}var h=ui();return h.add=function(e){s(h,e,t,n,r,i)},h.visit=function(e){ai(e,h,t,n,r,i)},e.forEach(h.add),h},d3.time={};var po=Date,vo=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];li.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){mo.setUTCDate.apply(this._,arguments)},setDay:function(){mo.setUTCDay.apply(this._,arguments)},setFullYear:function(){mo.setUTCFullYear.apply(this._,arguments)},setHours:function(){mo.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){mo.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){mo.setUTCMinutes.apply(this._,arguments)},setMonth:function(){mo.setUTCMonth.apply(this._,arguments)},setSeconds:function(){mo.setUTCSeconds.apply(this._,arguments)},setTime:function(){mo.setTime.apply(this._,arguments)}};var mo=Date.prototype,go="%a %b %e %H:%M:%S %Y",yo="%m/%d/%y",bo="%H:%M:%S",wo=vo,Eo=wo.map(ci),So=["January","February","March","April","May","June","July","August","September","October","November","December"],xo=So.map(ci);d3.time.format=function(e){function t(t){var r=[],i=-1,s=0,o,u;while(++i<n){e.charCodeAt(i)==37&&(r.push(e.substring(s,i),(u=Po[o=e.charAt(++i)])?u(t):o),s=i+1)}return r.push(e.substring(s,i)),r.join("")}var n=e.length;return t.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},r=hi(n,e,t,0);if(r!=t.length){return null}"p" in n&&(n.H=n.H%12+n.p*12);var i=new po;return i.setFullYear(n.y,n.m,n.d),i.setHours(n.H,n.M,n.S,n.L),i},t.toString=function(){return e},t};var To=d3.format("02d"),No=d3.format("03d"),Co=d3.format("04d"),ko=d3.format("2d"),Lo=pi(wo),Ao=pi(Eo),Oo=pi(So),Mo=di(So),_o=pi(xo),Do=di(xo),Po={a:function(e){return Eo[e.getDay()]},A:function(e){return wo[e.getDay()]},b:function(e){return xo[e.getMonth()]},B:function(e){return So[e.getMonth()]},c:d3.time.format(go),d:function(e){return To(e.getDate())},e:function(e){return ko(e.getDate())},H:function(e){return To(e.getHours())},I:function(e){return To(e.getHours()%12||12)},j:function(e){return No(1+d3.time.dayOfYear(e))},L:function(e){return No(e.getMilliseconds())},m:function(e){return To(e.getMonth()+1)},M:function(e){return To(e.getMinutes())},p:function(e){return e.getHours()>=12?"PM":"AM"},S:function(e){return To(e.getSeconds())},U:function(e){return To(d3.time.sundayOfYear(e))},w:function(e){return e.getDay()},W:function(e){return To(d3.time.mondayOfYear(e))},x:d3.time.format(yo),X:d3.time.format(bo),y:function(e){return To(e.getFullYear()%100)},Y:function(e){return Co(e.getFullYear()%10000)},Z:_i,"%":function(e){return"%"}},Ho={a:vi,A:mi,b:gi,B:yi,c:bi,d:Ci,e:Ci,H:ki,I:ki,L:Oi,m:Ni,M:Li,p:Mi,S:Ai,x:wi,X:Ei,y:xi,Y:Si},Bo=/^\s*\d+/,jo=d3.map({am:0,pm:1});d3.time.format.utc=function(e){function t(e){try{po=li;var t=new po;return t._=e,n(t)}finally{po=Date}}var n=d3.time.format(e);return t.parse=function(e){try{po=li;var t=n.parse(e);return t&&t._}finally{po=Date}},t.toString=n.toString,t};var Fo=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?Di:Fo,Di.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},Di.toString=Fo.toString,d3.time.second=Pi(function(e){return new po(Math.floor(e/1000)*1000)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*1000)},function(e){return e.getSeconds()}),d3.time.seconds=d3.time.second.range,d3.time.seconds.utc=d3.time.second.utc.range,d3.time.minute=Pi(function(e){return new po(Math.floor(e/60000)*60000)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*60000)},function(e){return e.getMinutes()}),d3.time.minutes=d3.time.minute.range,d3.time.minutes.utc=d3.time.minute.utc.range,d3.time.hour=Pi(function(e){var t=e.getTimezoneOffset()/60;return new po((Math.floor(e/3600000-t)+t)*3600000)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*3600000)},function(e){return e.getHours()}),d3.time.hours=d3.time.hour.range,d3.time.hours.utc=d3.time.hour.utc.range,d3.time.day=Pi(function(e){var t=new po(1970,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),d3.time.days=d3.time.day.range,d3.time.days.utc=d3.time.day.utc.range,d3.time.dayOfYear=function(e){var t=d3.time.year(e);return Math.floor((e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*60000)/86400000)},vo.forEach(function(e,t){e=e.toLowerCase(),t=7-t;var n=d3.time[e]=Pi(function(e){return(e=d3.time.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+Math.floor(t)*7)},function(e){var n=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});d3.time[e+"s"]=n.range,d3.time[e+"s"].utc=n.utc.range,d3.time[e+"OfYear"]=function(e){var n=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(n+t)%7)/7)}}),d3.time.week=d3.time.sunday,d3.time.weeks=d3.time.sunday.range,d3.time.weeks.utc=d3.time.sunday.utc.range,d3.time.weekOfYear=d3.time.sundayOfYear,d3.time.month=Pi(function(e){return e=d3.time.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),d3.time.months=d3.time.month.range,d3.time.months.utc=d3.time.month.utc.range,d3.time.year=Pi(function(e){return e=d3.time.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),d3.time.years=d3.time.year.range,d3.time.years.utc=d3.time.year.utc.range;var Io=[1000,5000,15000,30000,60000,300000,900000,1800000,3600000,10800000,21600000,43200000,86400000,172800000,604800000,2592000000,7776000000,31536000000],qo=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],Ro=[[d3.time.format("%Y"),function(e){return !0}],[d3.time.format("%B"),function(e){return e.getMonth()}],[d3.time.format("%b %d"),function(e){return e.getDate()!=1}],[d3.time.format("%a %d"),function(e){return e.getDay()&&e.getDate()!=1}],[d3.time.format("%I %p"),function(e){return e.getHours()}],[d3.time.format("%I:%M"),function(e){return e.getMinutes()}],[d3.time.format(":%S"),function(e){return e.getSeconds()}],[d3.time.format(".%L"),function(e){return e.getMilliseconds()}]],Uo=d3.scale.linear(),zo=Ii(Ro);qo.year=function(e,t){return Uo.domain(e.map(Ri)).ticks(t).map(qi)},d3.time.scale=function(){return Bi(d3.scale.linear(),qo,zo)};var Wo=qo.map(function(e){return[e[0].utc,e[1]]}),Xo=[[d3.time.format.utc("%Y"),function(e){return !0}],[d3.time.format.utc("%B"),function(e){return e.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(e){return e.getUTCDate()!=1}],[d3.time.format.utc("%a %d"),function(e){return e.getUTCDay()&&e.getUTCDate()!=1}],[d3.time.format.utc("%I %p"),function(e){return e.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(e){return e.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(e){return e.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(e){return e.getUTCMilliseconds()}]],Vo=Ii(Xo);Wo.year=function(e,t){return Uo.domain(e.map(zi)).ticks(t).map(Ui)},d3.time.scale.utc=function(){return Bi(d3.scale.linear(),Wo,Vo)}})();d3=function(){var d3={version:"3.1.5"};if(!Date.now){Date.now=function(){return +new Date()}}var d3_document=document,d3_window=window;try{d3_document.createElement("div").style.setProperty("opacity",0,"")}catch(error){var d3_style_prototype=d3_window.CSSStyleDeclaration.prototype,d3_style_setProperty=d3_style_prototype.setProperty;d3_style_prototype.setProperty=function(name,value,priority){d3_style_setProperty.call(this,name,value+"",priority)}}d3.ascending=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN};d3.descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN};d3.min=function(array,f){var i=-1,n=array.length,a,b;if(arguments.length===1){while(++i<n&&((a=array[i])==null||a!=a)){a=undefined}while(++i<n){if((b=array[i])!=null&&a>b){a=b}}}else{while(++i<n&&((a=f.call(array,array[i],i))==null||a!=a)){a=undefined}while(++i<n){if((b=f.call(array,array[i],i))!=null&&a>b){a=b}}}return a};d3.max=function(array,f){var i=-1,n=array.length,a,b;if(arguments.length===1){while(++i<n&&((a=array[i])==null||a!=a)){a=undefined}while(++i<n){if((b=array[i])!=null&&b>a){a=b}}}else{while(++i<n&&((a=f.call(array,array[i],i))==null||a!=a)){a=undefined}while(++i<n){if((b=f.call(array,array[i],i))!=null&&b>a){a=b}}}return a};d3.extent=function(array,f){var i=-1,n=array.length,a,b,c;if(arguments.length===1){while(++i<n&&((a=c=array[i])==null||a!=a)){a=c=undefined}while(++i<n){if((b=array[i])!=null){if(a>b){a=b}if(c<b){c=b}}}}else{while(++i<n&&((a=c=f.call(array,array[i],i))==null||a!=a)){a=undefined}while(++i<n){if((b=f.call(array,array[i],i))!=null){if(a>b){a=b}if(c<b){c=b}}}}return[a,c]};d3.sum=function(array,f){var s=0,n=array.length,a,i=-1;if(arguments.length===1){while(++i<n){if(!isNaN(a=+array[i])){s+=a}}}else{while(++i<n){if(!isNaN(a=+f.call(array,array[i],i))){s+=a}}}return s};function d3_number(x){return x!=null&&!isNaN(x)}d3.mean=function(array,f){var n=array.length,a,m=0,i=-1,j=0;if(arguments.length===1){while(++i<n){if(d3_number(a=array[i])){m+=(a-m)/++j}}}else{while(++i<n){if(d3_number(a=f.call(array,array[i],i))){m+=(a-m)/++j}}}return j?m:undefined};d3.quantile=function(values,p){var H=(values.length-1)*p+1,h=Math.floor(H),v=+values[h-1],e=H-h;return e?v+e*(values[h]-v):v};d3.median=function(array,f){if(arguments.length>1){array=array.map(f)}array=array.filter(d3_number);return array.length?d3.quantile(array.sort(d3.ascending),0.5):undefined};d3.bisector=function(f){return{left:function(a,x,lo,hi){if(arguments.length<3){lo=0}if(arguments.length<4){hi=a.length}while(lo<hi){var mid=lo+hi>>>1;if(f.call(a,a[mid],mid)<x){lo=mid+1}else{hi=mid}}return lo},right:function(a,x,lo,hi){if(arguments.length<3){lo=0}if(arguments.length<4){hi=a.length}while(lo<hi){var mid=lo+hi>>>1;if(x<f.call(a,a[mid],mid)){hi=mid}else{lo=mid+1}}return lo}}};var d3_bisector=d3.bisector(function(d){return d});d3.bisectLeft=d3_bisector.left;d3.bisect=d3.bisectRight=d3_bisector.right;d3.shuffle=function(array){var m=array.length,t,i;while(m){i=Math.random()*m--|0;t=array[m],array[m]=array[i],array[i]=t}return array};d3.permute=function(array,indexes){var permutes=[],i=-1,n=indexes.length;while(++i<n){permutes[i]=array[indexes[i]]}return permutes};d3.zip=function(){if(!(n=arguments.length)){return[]}for(var i=-1,m=d3.min(arguments,d3_zipLength),zips=new Array(m);++i<m;){for(var j=-1,n,zip=zips[i]=new Array(n);++j<n;){zip[j]=arguments[j][i]}}return zips};function d3_zipLength(d){return d.length}d3.transpose=function(matrix){return d3.zip.apply(d3,matrix)};d3.keys=function(map){var keys=[];for(var key in map){keys.push(key)}return keys};d3.values=function(map){var values=[];for(var key in map){values.push(map[key])}return values};d3.entries=function(map){var entries=[];for(var key in map){entries.push({key:key,value:map[key]})}return entries};d3.merge=function(arrays){return Array.prototype.concat.apply([],arrays)};d3.range=function(start,stop,step){if(arguments.length<3){step=1;if(arguments.length<2){stop=start;start=0}}if((stop-start)/step===Infinity){throw new Error("infinite range")}var range=[],k=d3_range_integerScale(Math.abs(step)),i=-1,j;start*=k,stop*=k,step*=k;if(step<0){while((j=start+step*++i)>stop){range.push(j/k)}}else{while((j=start+step*++i)<stop){range.push(j/k)}}return range};function d3_range_integerScale(x){var k=1;while(x*k%1){k*=10}return k}function d3_class(ctor,properties){try{for(var key in properties){Object.defineProperty(ctor.prototype,key,{value:properties[key],enumerable:false})}}catch(e){ctor.prototype=properties}}d3.map=function(object){var map=new d3_Map();for(var key in object){map.set(key,object[key])}return map};function d3_Map(){}d3_class(d3_Map,{has:function(key){return d3_map_prefix+key in this},get:function(key){return this[d3_map_prefix+key]},set:function(key,value){return this[d3_map_prefix+key]=value},remove:function(key){key=d3_map_prefix+key;return key in this&&delete this[key]},keys:function(){var keys=[];this.forEach(function(key){keys.push(key)});return keys},values:function(){var values=[];this.forEach(function(key,value){values.push(value)});return values},entries:function(){var entries=[];this.forEach(function(key,value){entries.push({key:key,value:value})});return entries},forEach:function(f){for(var key in this){if(key.charCodeAt(0)===d3_map_prefixCode){f.call(this,key.substring(1),this[key])}}}});var d3_map_prefix="\0",d3_map_prefixCode=d3_map_prefix.charCodeAt(0);d3.nest=function(){var nest={},keys=[],sortKeys=[],sortValues,rollup;function map(mapType,array,depth){if(depth>=keys.length){return rollup?rollup.call(nest,array):sortValues?array.sort(sortValues):array}var i=-1,n=array.length,key=keys[depth++],keyValue,object,setter,valuesByKey=new d3_Map(),values;while(++i<n){if(values=valuesByKey.get(keyValue=key(object=array[i]))){values.push(object)}else{valuesByKey.set(keyValue,[object])}}if(mapType){object=mapType();setter=function(keyValue,values){object.set(keyValue,map(mapType,values,depth))}}else{object={};setter=function(keyValue,values){object[keyValue]=map(mapType,values,depth)}}valuesByKey.forEach(setter);return object}function entries(map,depth){if(depth>=keys.length){return map}var array=[],sortKey=sortKeys[depth++];map.forEach(function(key,keyMap){array.push({key:key,values:entries(keyMap,depth)})});return sortKey?array.sort(function(a,b){return sortKey(a.key,b.key)}):array}nest.map=function(array,mapType){return map(mapType,array,0)};nest.entries=function(array){return entries(map(d3.map,array,0),0)};nest.key=function(d){keys.push(d);return nest};nest.sortKeys=function(order){sortKeys[keys.length-1]=order;return nest};nest.sortValues=function(order){sortValues=order;return nest};nest.rollup=function(f){rollup=f;return nest};return nest};d3.set=function(array){var set=new d3_Set();if(array){for(var i=0;i<array.length;i++){set.add(array[i])}}return set};function d3_Set(){}d3_class(d3_Set,{has:function(value){return d3_map_prefix+value in this},add:function(value){this[d3_map_prefix+value]=true;return value},remove:function(value){value=d3_map_prefix+value;return value in this&&delete this[value]},values:function(){var values=[];this.forEach(function(value){values.push(value)});return values},forEach:function(f){for(var value in this){if(value.charCodeAt(0)===d3_map_prefixCode){f.call(this,value.substring(1))}}}});d3.behavior={};d3.rebind=function(target,source){var i=1,n=arguments.length,method;while(++i<n){target[method=arguments[i]]=d3_rebind(target,source,source[method])}return target};function d3_rebind(target,source,method){return function(){var value=method.apply(source,arguments);return value===source?target:value}}d3.dispatch=function(){var dispatch=new d3_dispatch(),i=-1,n=arguments.length;while(++i<n){dispatch[arguments[i]]=d3_dispatch_event(dispatch)}return dispatch};function d3_dispatch(){}d3_dispatch.prototype.on=function(type,listener){var i=type.indexOf("."),name="";if(i>=0){name=type.substring(i+1);type=type.substring(0,i)}if(type){return arguments.length<2?this[type].on(name):this[type].on(name,listener)}if(arguments.length===2){if(listener==null){for(type in this){if(this.hasOwnProperty(type)){this[type].on(name,null)}}}return this}};function d3_dispatch_event(dispatch){var listeners=[],listenerByName=new d3_Map();function event(){var z=listeners,i=-1,n=z.length,l;while(++i<n){if(l=z[i].on){l.apply(this,arguments)}}return dispatch}event.on=function(name,listener){var l=listenerByName.get(name),i;if(arguments.length<2){return l&&l.on}if(l){l.on=null;listeners=listeners.slice(0,i=listeners.indexOf(l)).concat(listeners.slice(i+1));listenerByName.remove(name)}if(listener){listeners.push(listenerByName.set(name,{on:listener}))}return dispatch};return event}d3.event=null;function d3_eventCancel(){d3.event.stopPropagation();d3.event.preventDefault()}function d3_eventSource(){var e=d3.event,s;while(s=e.sourceEvent){e=s}return e}function d3_eventSuppress(target,type){function off(){target.on(type,null)}target.on(type,function(){d3_eventCancel();off()},true);setTimeout(off,0)}function d3_eventDispatch(target){var dispatch=new d3_dispatch(),i=0,n=arguments.length;while(++i<n){dispatch[arguments[i]]=d3_dispatch_event(dispatch)}dispatch.of=function(thiz,argumentz){return function(e1){try{var e0=e1.sourceEvent=d3.event;e1.target=target;d3.event=e1;dispatch[e1.type].apply(thiz,argumentz)}finally{d3.event=e0}}};return dispatch}d3.mouse=function(container){return d3_mousePoint(container,d3_eventSource())};var d3_mouse_bug44083=/WebKit/.test(d3_window.navigator.userAgent)?-1:0;function d3_mousePoint(container,e){var svg=container.ownerSVGElement||container;if(svg.createSVGPoint){var point=svg.createSVGPoint();if(d3_mouse_bug44083<0&&(d3_window.scrollX||d3_window.scrollY)){svg=d3.select(d3_document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var ctm=svg[0][0].getScreenCTM();d3_mouse_bug44083=!(ctm.f||ctm.e);svg.remove()}if(d3_mouse_bug44083){point.x=e.pageX;point.y=e.pageY}else{point.x=e.clientX;point.y=e.clientY}point=point.matrixTransform(container.getScreenCTM().inverse());return[point.x,point.y]}var rect=container.getBoundingClientRect();return[e.clientX-rect.left-container.clientLeft,e.clientY-rect.top-container.clientTop]}var d3_array=d3_arraySlice;function d3_arrayCopy(pseudoarray){var i=-1,n=pseudoarray.length,array=[];while(++i<n){array.push(pseudoarray[i])}return array}function d3_arraySlice(pseudoarray){return Array.prototype.slice.call(pseudoarray)}try{d3_array(d3_document.documentElement.childNodes)[0].nodeType}catch(e){d3_array=d3_arrayCopy}var d3_arraySubclass=[].__proto__?function(array,prototype){array.__proto__=prototype}:function(array,prototype){for(var property in prototype){array[property]=prototype[property]}};d3.touches=function(container,touches){if(arguments.length<2){touches=d3_eventSource().touches}return touches?d3_array(touches).map(function(touch){var point=d3_mousePoint(container,touch);point.identifier=touch.identifier;return point}):[]};d3.behavior.drag=function(){var event=d3_eventDispatch(drag,"drag","dragstart","dragend"),origin=null;function drag(){this.on("mousedown.drag",mousedown).on("touchstart.drag",mousedown)}function mousedown(){var target=this,event_=event.of(target,arguments),eventTarget=d3.event.target,touchId=d3.event.touches?d3.event.changedTouches[0].identifier:null,offset,origin_=point(),moved=0;var w=d3.select(d3_window).on(touchId!=null?"touchmove.drag-"+touchId:"mousemove.drag",dragmove).on(touchId!=null?"touchend.drag-"+touchId:"mouseup.drag",dragend,true);if(origin){offset=origin.apply(target,arguments);offset=[offset.x-origin_[0],offset.y-origin_[1]]}else{offset=[0,0]}if(touchId==null){d3_eventCancel()}event_({type:"dragstart"});function point(){var p=target.parentNode;return touchId!=null?d3.touches(p).filter(function(p){return p.identifier===touchId})[0]:d3.mouse(p)}function dragmove(){if(!target.parentNode){return dragend()}var p=point(),dx=p[0]-origin_[0],dy=p[1]-origin_[1];moved|=dx|dy;origin_=p;d3_eventCancel();event_({type:"drag",x:p[0]+offset[0],y:p[1]+offset[1],dx:dx,dy:dy})}function dragend(){event_({type:"dragend"});if(moved){d3_eventCancel();if(d3.event.target===eventTarget){d3_eventSuppress(w,"click")}}w.on(touchId!=null?"touchmove.drag-"+touchId:"mousemove.drag",null).on(touchId!=null?"touchend.drag-"+touchId:"mouseup.drag",null)}}drag.origin=function(x){if(!arguments.length){return origin}origin=x;return drag};return d3.rebind(drag,event,"on")};function d3_selection(groups){d3_arraySubclass(groups,d3_selectionPrototype);return groups}var d3_select=function(s,n){return n.querySelector(s)},d3_selectAll=function(s,n){return n.querySelectorAll(s)},d3_selectRoot=d3_document.documentElement,d3_selectMatcher=d3_selectRoot.matchesSelector||d3_selectRoot.webkitMatchesSelector||d3_selectRoot.mozMatchesSelector||d3_selectRoot.msMatchesSelector||d3_selectRoot.oMatchesSelector,d3_selectMatches=function(n,s){return d3_selectMatcher.call(n,s)};if(typeof Sizzle==="function"){d3_select=function(s,n){return Sizzle(s,n)[0]||null};d3_selectAll=function(s,n){return Sizzle.uniqueSort(Sizzle(s,n))};d3_selectMatches=Sizzle.matchesSelector}var d3_selectionPrototype=[];d3.selection=function(){return d3_selectionRoot};d3.selection.prototype=d3_selectionPrototype;d3_selectionPrototype.select=function(selector){var subgroups=[],subgroup,subnode,group,node;if(typeof selector!=="function"){selector=d3_selection_selector(selector)}for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);subgroup.parentNode=(group=this[j]).parentNode;for(var i=-1,n=group.length;++i<n;){if(node=group[i]){subgroup.push(subnode=selector.call(node,node.__data__,i));if(subnode&&"__data__" in node){subnode.__data__=node.__data__}}else{subgroup.push(null)}}}return d3_selection(subgroups)};function d3_selection_selector(selector){return function(){return d3_select(selector,this)}}d3_selectionPrototype.selectAll=function(selector){var subgroups=[],subgroup,node;if(typeof selector!=="function"){selector=d3_selection_selectorAll(selector)}for(var j=-1,m=this.length;++j<m;){for(var group=this[j],i=-1,n=group.length;++i<n;){if(node=group[i]){subgroups.push(subgroup=d3_array(selector.call(node,node.__data__,i)));subgroup.parentNode=node}}}return d3_selection(subgroups)};function d3_selection_selectorAll(selector){return function(){return d3_selectAll(selector,this)}}var d3_nsPrefix={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:d3_nsPrefix,qualify:function(name){var i=name.indexOf(":"),prefix=name;if(i>=0){prefix=name.substring(0,i);name=name.substring(i+1)}return d3_nsPrefix.hasOwnProperty(prefix)?{space:d3_nsPrefix[prefix],local:name}:name}};d3_selectionPrototype.attr=function(name,value){if(arguments.length<2){if(typeof name==="string"){var node=this.node();name=d3.ns.qualify(name);return name.local?node.getAttributeNS(name.space,name.local):node.getAttribute(name)}for(value in name){this.each(d3_selection_attr(value,name[value]))}return this}return this.each(d3_selection_attr(name,value))};function d3_selection_attr(name,value){name=d3.ns.qualify(name);function attrNull(){this.removeAttribute(name)}function attrNullNS(){this.removeAttributeNS(name.space,name.local)}function attrConstant(){this.setAttribute(name,value)}function attrConstantNS(){this.setAttributeNS(name.space,name.local,value)}function attrFunction(){var x=value.apply(this,arguments);if(x==null){this.removeAttribute(name)}else{this.setAttribute(name,x)}}function attrFunctionNS(){var x=value.apply(this,arguments);if(x==null){this.removeAttributeNS(name.space,name.local)}else{this.setAttributeNS(name.space,name.local,x)}}return value==null?name.local?attrNullNS:attrNull:typeof value==="function"?name.local?attrFunctionNS:attrFunction:name.local?attrConstantNS:attrConstant}function d3_collapse(s){return s.trim().replace(/\s+/g," ")}d3.requote=function(s){return s.replace(d3_requote_re,"\\$&")};var d3_requote_re=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3_selectionPrototype.classed=function(name,value){if(arguments.length<2){if(typeof name==="string"){var node=this.node(),n=(name=name.trim().split(/^|\s+/g)).length,i=-1;if(value=node.classList){while(++i<n){if(!value.contains(name[i])){return false}}}else{value=node.getAttribute("class");while(++i<n){if(!d3_selection_classedRe(name[i]).test(value)){return false}}}return true}for(value in name){this.each(d3_selection_classed(value,name[value]))}return this}return this.each(d3_selection_classed(name,value))};function d3_selection_classedRe(name){return new RegExp("(?:^|\\s+)"+d3.requote(name)+"(?:\\s+|$)","g")}function d3_selection_classed(name,value){name=name.trim().split(/\s+/).map(d3_selection_classedName);var n=name.length;function classedConstant(){var i=-1;while(++i<n){name[i](this,value)}}function classedFunction(){var i=-1,x=value.apply(this,arguments);while(++i<n){name[i](this,x)}}return typeof value==="function"?classedFunction:classedConstant}function d3_selection_classedName(name){var re=d3_selection_classedRe(name);return function(node,value){if(c=node.classList){return value?c.add(name):c.remove(name)}var c=node.getAttribute("class")||"";if(value){re.lastIndex=0;if(!re.test(c)){node.setAttribute("class",d3_collapse(c+" "+name))}}else{node.setAttribute("class",d3_collapse(c.replace(re," ")))}}}d3_selectionPrototype.style=function(name,value,priority){var n=arguments.length;if(n<3){if(typeof name!=="string"){if(n<2){value=""}for(priority in name){this.each(d3_selection_style(priority,name[priority],value))}return this}if(n<2){return d3_window.getComputedStyle(this.node(),null).getPropertyValue(name)}priority=""}return this.each(d3_selection_style(name,value,priority))};function d3_selection_style(name,value,priority){function styleNull(){this.style.removeProperty(name)}function styleConstant(){this.style.setProperty(name,value,priority)}function styleFunction(){var x=value.apply(this,arguments);if(x==null){this.style.removeProperty(name)}else{this.style.setProperty(name,x,priority)}}return value==null?styleNull:typeof value==="function"?styleFunction:styleConstant}d3_selectionPrototype.property=function(name,value){if(arguments.length<2){if(typeof name==="string"){return this.node()[name]}for(value in name){this.each(d3_selection_property(value,name[value]))}return this}return this.each(d3_selection_property(name,value))};function d3_selection_property(name,value){function propertyNull(){delete this[name]}function propertyConstant(){this[name]=value}function propertyFunction(){var x=value.apply(this,arguments);if(x==null){delete this[name]}else{this[name]=x}}return value==null?propertyNull:typeof value==="function"?propertyFunction:propertyConstant}d3_selectionPrototype.text=function(value){return arguments.length?this.each(typeof value==="function"?function(){var v=value.apply(this,arguments);this.textContent=v==null?"":v}:value==null?function(){this.textContent=""}:function(){this.textContent=value}):this.node().textContent};d3_selectionPrototype.html=function(value){return arguments.length?this.each(typeof value==="function"?function(){var v=value.apply(this,arguments);this.innerHTML=v==null?"":v}:value==null?function(){this.innerHTML=""}:function(){this.innerHTML=value}):this.node().innerHTML};d3_selectionPrototype.append=function(name){name=d3.ns.qualify(name);function append(){return this.appendChild(d3_document.createElementNS(this.namespaceURI,name))}function appendNS(){return this.appendChild(d3_document.createElementNS(name.space,name.local))}return this.select(name.local?appendNS:append)};d3_selectionPrototype.insert=function(name,before){name=d3.ns.qualify(name);if(typeof before!=="function"){before=d3_selection_selector(before)}function insert(d,i){return this.insertBefore(d3_document.createElementNS(this.namespaceURI,name),before.call(this,d,i))}function insertNS(d,i){return this.insertBefore(d3_document.createElementNS(name.space,name.local),before.call(this,d,i))}return this.select(name.local?insertNS:insert)};d3_selectionPrototype.remove=function(){return this.each(function(){var parent=this.parentNode;if(parent){parent.removeChild(this)}})};d3_selectionPrototype.data=function(value,key){var i=-1,n=this.length,group,node;if(!arguments.length){value=new Array(n=(group=this[0]).length);while(++i<n){if(node=group[i]){value[i]=node.__data__}}return value}function bind(group,groupData){var i,n=group.length,m=groupData.length,n0=Math.min(n,m),updateNodes=new Array(m),enterNodes=new Array(m),exitNodes=new Array(n),node,nodeData;if(key){var nodeByKeyValue=new d3_Map(),dataByKeyValue=new d3_Map(),keyValues=[],keyValue;for(i=-1;++i<n;){keyValue=key.call(node=group[i],node.__data__,i);if(nodeByKeyValue.has(keyValue)){exitNodes[i]=node}else{nodeByKeyValue.set(keyValue,node)}keyValues.push(keyValue)}for(i=-1;++i<m;){keyValue=key.call(groupData,nodeData=groupData[i],i);if(node=nodeByKeyValue.get(keyValue)){updateNodes[i]=node;node.__data__=nodeData}else{if(!dataByKeyValue.has(keyValue)){enterNodes[i]=d3_selection_dataNode(nodeData)}}dataByKeyValue.set(keyValue,nodeData);nodeByKeyValue.remove(keyValue)}for(i=-1;++i<n;){if(nodeByKeyValue.has(keyValues[i])){exitNodes[i]=group[i]}}}else{for(i=-1;++i<n0;){node=group[i];nodeData=groupData[i];if(node){node.__data__=nodeData;updateNodes[i]=node}else{enterNodes[i]=d3_selection_dataNode(nodeData)}}for(;i<m;++i){enterNodes[i]=d3_selection_dataNode(groupData[i])}for(;i<n;++i){exitNodes[i]=group[i]}}enterNodes.update=updateNodes;enterNodes.parentNode=updateNodes.parentNode=exitNodes.parentNode=group.parentNode;enter.push(enterNodes);update.push(updateNodes);exit.push(exitNodes)}var enter=d3_selection_enter([]),update=d3_selection([]),exit=d3_selection([]);if(typeof value==="function"){while(++i<n){bind(group=this[i],value.call(group,group.parentNode.__data__,i))}}else{while(++i<n){bind(group=this[i],value)}}update.enter=function(){return enter};update.exit=function(){return exit};return update};function d3_selection_dataNode(data){return{__data__:data}}d3_selectionPrototype.datum=function(value){return arguments.length?this.property("__data__",value):this.property("__data__")};d3_selectionPrototype.filter=function(filter){var subgroups=[],subgroup,group,node;if(typeof filter!=="function"){filter=d3_selection_filter(filter)}for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);subgroup.parentNode=(group=this[j]).parentNode;for(var i=0,n=group.length;i<n;i++){if((node=group[i])&&filter.call(node,node.__data__,i)){subgroup.push(node)}}}return d3_selection(subgroups)};function d3_selection_filter(selector){return function(){return d3_selectMatches(this,selector)}}d3_selectionPrototype.order=function(){for(var j=-1,m=this.length;++j<m;){for(var group=this[j],i=group.length-1,next=group[i],node;--i>=0;){if(node=group[i]){if(next&&next!==node.nextSibling){next.parentNode.insertBefore(node,next)}next=node}}}return this};d3_selectionPrototype.sort=function(comparator){comparator=d3_selection_sortComparator.apply(this,arguments);for(var j=-1,m=this.length;++j<m;){this[j].sort(comparator)}return this.order()};function d3_selection_sortComparator(comparator){if(!arguments.length){comparator=d3.ascending}return function(a,b){return !a-!b||comparator(a.__data__,b.__data__)}}function d3_noop(){}d3_selectionPrototype.on=function(type,listener,capture){var n=arguments.length;if(n<3){if(typeof type!=="string"){if(n<2){listener=false}for(capture in type){this.each(d3_selection_on(capture,type[capture],listener))}return this}if(n<2){return(n=this.node()["__on"+type])&&n._}capture=false}return this.each(d3_selection_on(type,listener,capture))};function d3_selection_on(type,listener,capture){var name="__on"+type,i=type.indexOf("."),wrap=d3_selection_onListener;if(i>0){type=type.substring(0,i)}var filter=d3_selection_onFilters.get(type);if(filter){type=filter,wrap=d3_selection_onFilter}function onRemove(){var l=this[name];if(l){this.removeEventListener(type,l,l.$);delete this[name]}}function onAdd(){var l=wrap(listener,d3_array(arguments));onRemove.call(this);this.addEventListener(type,this[name]=l,l.$=capture);l._=listener}function removeAll(){var re=new RegExp("^__on([^.]+)"+d3.requote(type)+"$"),match;for(var name in this){if(match=name.match(re)){var l=this[name];this.removeEventListener(match[1],l,l.$);delete this[name]}}}return i?listener?onAdd:onRemove:listener?d3_noop:removeAll}var d3_selection_onFilters=d3.map({mouseenter:"mouseover",mouseleave:"mouseout"});d3_selection_onFilters.forEach(function(k){if("on"+k in d3_document){d3_selection_onFilters.remove(k)}});function d3_selection_onListener(listener,argumentz){return function(e){var o=d3.event;d3.event=e;argumentz[0]=this.__data__;try{listener.apply(this,argumentz)}finally{d3.event=o}}}function d3_selection_onFilter(listener,argumentz){var l=d3_selection_onListener(listener,argumentz);return function(e){var target=this,related=e.relatedTarget;if(!related||related!==target&&!(related.compareDocumentPosition(target)&8)){l.call(target,e)}}}d3_selectionPrototype.each=function(callback){return d3_selection_each(this,function(node,i,j){callback.call(node,node.__data__,i,j)})};function d3_selection_each(groups,callback){for(var j=0,m=groups.length;j<m;j++){for(var group=groups[j],i=0,n=group.length,node;i<n;i++){if(node=group[i]){callback(node,i,j)}}}return groups}d3_selectionPrototype.call=function(callback){var args=d3_array(arguments);callback.apply(args[0]=this,args);return this};d3_selectionPrototype.empty=function(){return !this.node()};d3_selectionPrototype.node=function(){for(var j=0,m=this.length;j<m;j++){for(var group=this[j],i=0,n=group.length;i<n;i++){var node=group[i];if(node){return node}}}return null};function d3_selection_enter(selection){d3_arraySubclass(selection,d3_selection_enterPrototype);return selection}var d3_selection_enterPrototype=[];d3.selection.enter=d3_selection_enter;d3.selection.enter.prototype=d3_selection_enterPrototype;d3_selection_enterPrototype.append=d3_selectionPrototype.append;d3_selection_enterPrototype.insert=d3_selectionPrototype.insert;d3_selection_enterPrototype.empty=d3_selectionPrototype.empty;d3_selection_enterPrototype.node=d3_selectionPrototype.node;d3_selection_enterPrototype.select=function(selector){var subgroups=[],subgroup,subnode,upgroup,group,node;for(var j=-1,m=this.length;++j<m;){upgroup=(group=this[j]).update;subgroups.push(subgroup=[]);subgroup.parentNode=group.parentNode;for(var i=-1,n=group.length;++i<n;){if(node=group[i]){subgroup.push(upgroup[i]=subnode=selector.call(group.parentNode,node.__data__,i));subnode.__data__=node.__data__}else{subgroup.push(null)}}}return d3_selection(subgroups)};d3_selectionPrototype.transition=function(){var id=d3_transitionInheritId||++d3_transitionId,subgroups=[],subgroup,node,transition=Object.create(d3_transitionInherit);transition.time=Date.now();for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;){if(node=group[i]){d3_transitionNode(node,i,id,transition)}subgroup.push(node)}}return d3_transition(subgroups,id)};var d3_selectionRoot=d3_selection([[d3_document]]);d3_selectionRoot[0].parentNode=d3_selectRoot;d3.select=function(selector){return typeof selector==="string"?d3_selectionRoot.select(selector):d3_selection([[selector]])};d3.selectAll=function(selector){return typeof selector==="string"?d3_selectionRoot.selectAll(selector):d3_selection([d3_array(selector)])};d3.behavior.zoom=function(){var translate=[0,0],translate0,scale=1,scale0,scaleExtent=d3_behavior_zoomInfinity,event=d3_eventDispatch(zoom,"zoom"),x0,x1,y0,y1,touchtime;function zoom(){this.on("mousedown.zoom",mousedown).on("mousemove.zoom",mousemove).on(d3_behavior_zoomWheel+".zoom",mousewheel).on("dblclick.zoom",dblclick).on("touchstart.zoom",touchstart).on("touchmove.zoom",touchmove).on("touchend.zoom",touchstart)}zoom.translate=function(x){if(!arguments.length){return translate}translate=x.map(Number);rescale();return zoom};zoom.scale=function(x){if(!arguments.length){return scale}scale=+x;rescale();return zoom};zoom.scaleExtent=function(x){if(!arguments.length){return scaleExtent}scaleExtent=x==null?d3_behavior_zoomInfinity:x.map(Number);return zoom};zoom.x=function(z){if(!arguments.length){return x1}x1=z;x0=z.copy();translate=[0,0];scale=1;return zoom};zoom.y=function(z){if(!arguments.length){return y1}y1=z;y0=z.copy();translate=[0,0];scale=1;return zoom};function location(p){return[(p[0]-translate[0])/scale,(p[1]-translate[1])/scale]}function point(l){return[l[0]*scale+translate[0],l[1]*scale+translate[1]]}function scaleTo(s){scale=Math.max(scaleExtent[0],Math.min(scaleExtent[1],s))}function translateTo(p,l){l=point(l);translate[0]+=p[0]-l[0];translate[1]+=p[1]-l[1]}function rescale(){if(x1){x1.domain(x0.range().map(function(x){return(x-translate[0])/scale}).map(x0.invert))}if(y1){y1.domain(y0.range().map(function(y){return(y-translate[1])/scale}).map(y0.invert))}}function dispatch(event){rescale();d3.event.preventDefault();event({type:"zoom",scale:scale,translate:translate})}function mousedown(){var target=this,event_=event.of(target,arguments),eventTarget=d3.event.target,moved=0,w=d3.select(d3_window).on("mousemove.zoom",mousemove).on("mouseup.zoom",mouseup),l=location(d3.mouse(target));d3_window.focus();d3_eventCancel();function mousemove(){moved=1;translateTo(d3.mouse(target),l);dispatch(event_)}function mouseup(){if(moved){d3_eventCancel()}w.on("mousemove.zoom",null).on("mouseup.zoom",null);if(moved&&d3.event.target===eventTarget){d3_eventSuppress(w,"click.zoom")}}}function mousewheel(){if(!translate0){translate0=location(d3.mouse(this))}scaleTo(Math.pow(2,d3_behavior_zoomDelta()*0.002)*scale);translateTo(d3.mouse(this),translate0);dispatch(event.of(this,arguments))}function mousemove(){translate0=null}function dblclick(){var p=d3.mouse(this),l=location(p),k=Math.log(scale)/Math.LN2;scaleTo(Math.pow(2,d3.event.shiftKey?Math.ceil(k)-1:Math.floor(k)+1));translateTo(p,l);dispatch(event.of(this,arguments))}function touchstart(){var touches=d3.touches(this),now=Date.now();scale0=scale;translate0={};touches.forEach(function(t){translate0[t.identifier]=location(t)});d3_eventCancel();if(touches.length===1){if(now-touchtime<500){var p=touches[0],l=location(touches[0]);scaleTo(scale*2);translateTo(p,l);dispatch(event.of(this,arguments))}touchtime=now}}function touchmove(){var touches=d3.touches(this),p0=touches[0],l0=translate0[p0.identifier];if(p1=touches[1]){var p1,l1=translate0[p1.identifier];p0=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2];l0=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2];scaleTo(d3.event.scale*scale0)}translateTo(p0,l0);touchtime=null;dispatch(event.of(this,arguments))}return d3.rebind(zoom,event,"on")};var d3_behavior_zoomInfinity=[0,Infinity];var d3_behavior_zoomDelta,d3_behavior_zoomWheel="onwheel" in d3_document?(d3_behavior_zoomDelta=function(){return -d3.event.deltaY*(d3.event.deltaMode?120:1)},"wheel"):"onmousewheel" in d3_document?(d3_behavior_zoomDelta=function(){return d3.event.wheelDelta},"mousewheel"):(d3_behavior_zoomDelta=function(){return -d3.event.detail},"MozMousePixelScroll");function d3_Color(){}d3_Color.prototype.toString=function(){return this.rgb()+""};d3.hsl=function(h,s,l){return arguments.length===1?h instanceof d3_Hsl?d3_hsl(h.h,h.s,h.l):d3_rgb_parse(""+h,d3_rgb_hsl,d3_hsl):d3_hsl(+h,+s,+l)};function d3_hsl(h,s,l){return new d3_Hsl(h,s,l)}function d3_Hsl(h,s,l){this.h=h;this.s=s;this.l=l}var d3_hslPrototype=d3_Hsl.prototype=new d3_Color();d3_hslPrototype.brighter=function(k){k=Math.pow(0.7,arguments.length?k:1);return d3_hsl(this.h,this.s,this.l/k)};d3_hslPrototype.darker=function(k){k=Math.pow(0.7,arguments.length?k:1);return d3_hsl(this.h,this.s,k*this.l)};d3_hslPrototype.rgb=function(){return d3_hsl_rgb(this.h,this.s,this.l)};function d3_hsl_rgb(h,s,l){var m1,m2;h=h%360;if(h<0){h+=360}s=s<0?0:s>1?1:s;l=l<0?0:l>1?1:l;m2=l<=0.5?l*(1+s):l+s-l*s;m1=2*l-m2;function v(h){if(h>360){h-=360}else{if(h<0){h+=360}}if(h<60){return m1+(m2-m1)*h/60}if(h<180){return m2}if(h<240){return m1+(m2-m1)*(240-h)/60}return m1}function vv(h){return Math.round(v(h)*255)}return d3_rgb(vv(h+120),vv(h),vv(h-120))}var π=Math.PI,ε=0.000001,d3_radians=π/180,d3_degrees=180/π;function d3_sgn(x){return x>0?1:x<0?-1:0}function d3_acos(x){return Math.acos(Math.max(-1,Math.min(1,x)))}function d3_asin(x){return x>1?π/2:x<-1?-π/2:Math.asin(x)}function d3_sinh(x){return(Math.exp(x)-Math.exp(-x))/2}function d3_cosh(x){return(Math.exp(x)+Math.exp(-x))/2}function d3_haversin(x){return(x=Math.sin(x/2))*x}d3.hcl=function(h,c,l){return arguments.length===1?h instanceof d3_Hcl?d3_hcl(h.h,h.c,h.l):h instanceof d3_Lab?d3_lab_hcl(h.l,h.a,h.b):d3_lab_hcl((h=d3_rgb_lab((h=d3.rgb(h)).r,h.g,h.b)).l,h.a,h.b):d3_hcl(+h,+c,+l)};function d3_hcl(h,c,l){return new d3_Hcl(h,c,l)}function d3_Hcl(h,c,l){this.h=h;this.c=c;this.l=l}var d3_hclPrototype=d3_Hcl.prototype=new d3_Color();d3_hclPrototype.brighter=function(k){return d3_hcl(this.h,this.c,Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)))};d3_hclPrototype.darker=function(k){return d3_hcl(this.h,this.c,Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)))};d3_hclPrototype.rgb=function(){return d3_hcl_lab(this.h,this.c,this.l).rgb()};function d3_hcl_lab(h,c,l){return d3_lab(l,Math.cos(h*=d3_radians)*c,Math.sin(h)*c)}d3.lab=function(l,a,b){return arguments.length===1?l instanceof d3_Lab?d3_lab(l.l,l.a,l.b):l instanceof d3_Hcl?d3_hcl_lab(l.l,l.c,l.h):d3_rgb_lab((l=d3.rgb(l)).r,l.g,l.b):d3_lab(+l,+a,+b)};function d3_lab(l,a,b){return new d3_Lab(l,a,b)}function d3_Lab(l,a,b){this.l=l;this.a=a;this.b=b}var d3_lab_K=18;var d3_lab_X=0.95047,d3_lab_Y=1,d3_lab_Z=1.08883;var d3_labPrototype=d3_Lab.prototype=new d3_Color();d3_labPrototype.brighter=function(k){return d3_lab(Math.min(100,this.l+d3_lab_K*(arguments.length?k:1)),this.a,this.b)};d3_labPrototype.darker=function(k){return d3_lab(Math.max(0,this.l-d3_lab_K*(arguments.length?k:1)),this.a,this.b)};d3_labPrototype.rgb=function(){return d3_lab_rgb(this.l,this.a,this.b)};function d3_lab_rgb(l,a,b){var y=(l+16)/116,x=y+a/500,z=y-b/200;x=d3_lab_xyz(x)*d3_lab_X;y=d3_lab_xyz(y)*d3_lab_Y;z=d3_lab_xyz(z)*d3_lab_Z;return d3_rgb(d3_xyz_rgb(3.2404542*x-1.5371385*y-0.4985314*z),d3_xyz_rgb(-0.969266*x+1.8760108*y+0.041556*z),d3_xyz_rgb(0.0556434*x-0.2040259*y+1.0572252*z))}function d3_lab_hcl(l,a,b){return d3_hcl(Math.atan2(b,a)*d3_degrees,Math.sqrt(a*a+b*b),l)}function d3_lab_xyz(x){return x>0.206893034?x*x*x:(x-4/29)/7.787037}function d3_xyz_lab(x){return x>0.008856?Math.pow(x,1/3):7.787037*x+4/29}function d3_xyz_rgb(r){return Math.round(255*(r<=0.00304?12.92*r:1.055*Math.pow(r,1/2.4)-0.055))}d3.rgb=function(r,g,b){return arguments.length===1?r instanceof d3_Rgb?d3_rgb(r.r,r.g,r.b):d3_rgb_parse(""+r,d3_rgb,d3_hsl_rgb):d3_rgb(~~r,~~g,~~b)};function d3_rgb(r,g,b){return new d3_Rgb(r,g,b)}function d3_Rgb(r,g,b){this.r=r;this.g=g;this.b=b}var d3_rgbPrototype=d3_Rgb.prototype=new d3_Color();d3_rgbPrototype.brighter=function(k){k=Math.pow(0.7,arguments.length?k:1);var r=this.r,g=this.g,b=this.b,i=30;if(!r&&!g&&!b){return d3_rgb(i,i,i)}if(r&&r<i){r=i}if(g&&g<i){g=i}if(b&&b<i){b=i}return d3_rgb(Math.min(255,Math.floor(r/k)),Math.min(255,Math.floor(g/k)),Math.min(255,Math.floor(b/k)))};d3_rgbPrototype.darker=function(k){k=Math.pow(0.7,arguments.length?k:1);return d3_rgb(Math.floor(k*this.r),Math.floor(k*this.g),Math.floor(k*this.b))};d3_rgbPrototype.hsl=function(){return d3_rgb_hsl(this.r,this.g,this.b)};d3_rgbPrototype.toString=function(){return"#"+d3_rgb_hex(this.r)+d3_rgb_hex(this.g)+d3_rgb_hex(this.b)};function d3_rgb_hex(v){return v<16?"0"+Math.max(0,v).toString(16):Math.min(255,v).toString(16)}function d3_rgb_parse(format,rgb,hsl){var r=0,g=0,b=0,m1,m2,name;m1=/([a-z]+)\((.*)\)/i.exec(format);if(m1){m2=m1[2].split(",");switch(m1[1]){case"hsl":return hsl(parseFloat(m2[0]),parseFloat(m2[1])/100,parseFloat(m2[2])/100);case"rgb":return rgb(d3_rgb_parseNumber(m2[0]),d3_rgb_parseNumber(m2[1]),d3_rgb_parseNumber(m2[2]))}}if(name=d3_rgb_names.get(format)){return rgb(name.r,name.g,name.b)}if(format!=null&&format.charAt(0)==="#"){if(format.length===4){r=format.charAt(1);r+=r;g=format.charAt(2);g+=g;b=format.charAt(3);b+=b}else{if(format.length===7){r=format.substring(1,3);g=format.substring(3,5);b=format.substring(5,7)}}r=parseInt(r,16);g=parseInt(g,16);b=parseInt(b,16)}return rgb(r,g,b)}function d3_rgb_hsl(r,g,b){var min=Math.min(r/=255,g/=255,b/=255),max=Math.max(r,g,b),d=max-min,h,s,l=(max+min)/2;if(d){s=l<0.5?d/(max+min):d/(2-max-min);if(r==max){h=(g-b)/d+(g<b?6:0)}else{if(g==max){h=(b-r)/d+2}else{h=(r-g)/d+4}}h*=60}else{s=h=0}return d3_hsl(h,s,l)}function d3_rgb_lab(r,g,b){r=d3_rgb_xyz(r);g=d3_rgb_xyz(g);b=d3_rgb_xyz(b);var x=d3_xyz_lab((0.4124564*r+0.3575761*g+0.1804375*b)/d3_lab_X),y=d3_xyz_lab((0.2126729*r+0.7151522*g+0.072175*b)/d3_lab_Y),z=d3_xyz_lab((0.0193339*r+0.119192*g+0.9503041*b)/d3_lab_Z);return d3_lab(116*y-16,500*(x-y),200*(y-z))}function d3_rgb_xyz(r){return(r/=255)<=0.04045?r/12.92:Math.pow((r+0.055)/1.055,2.4)}function d3_rgb_parseNumber(c){var f=parseFloat(c);return c.charAt(c.length-1)==="%"?Math.round(f*2.55):f}var d3_rgb_names=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});d3_rgb_names.forEach(function(key,value){d3_rgb_names.set(key,d3_rgb_parse(value,d3_rgb,d3_hsl_rgb))});function d3_functor(v){return typeof v==="function"?v:function(){return v}}d3.functor=d3_functor;function d3_identity(d){return d}d3.xhr=function(url,mimeType,callback){var xhr={},dispatch=d3.dispatch("progress","load","error"),headers={},response=d3_identity,request=new (d3_window.XDomainRequest&&/^(http(s)?:)?\/\//.test(url)?XDomainRequest:XMLHttpRequest)();"onload" in request?request.onload=request.onerror=respond:request.onreadystatechange=function(){request.readyState>3&&respond()};function respond(){var s=request.status;!s&&request.responseText||s>=200&&s<300||s===304?dispatch.load.call(xhr,response.call(xhr,request)):dispatch.error.call(xhr,request)}request.onprogress=function(event){var o=d3.event;d3.event=event;try{dispatch.progress.call(xhr,request)}finally{d3.event=o}};xhr.header=function(name,value){name=(name+"").toLowerCase();if(arguments.length<2){return headers[name]}if(value==null){delete headers[name]}else{headers[name]=value+""}return xhr};xhr.mimeType=function(value){if(!arguments.length){return mimeType}mimeType=value==null?null:value+"";return xhr};xhr.response=function(value){response=value;return xhr};["get","post"].forEach(function(method){xhr[method]=function(){return xhr.send.apply(xhr,[method].concat(d3_array(arguments)))}});xhr.send=function(method,data,callback){if(arguments.length===2&&typeof data==="function"){callback=data,data=null}request.open(method,url,true);if(mimeType!=null&&!("accept" in headers)){headers.accept=mimeType+",*/*"}if(request.setRequestHeader){for(var name in headers){request.setRequestHeader(name,headers[name])}}if(mimeType!=null&&request.overrideMimeType){request.overrideMimeType(mimeType)}if(callback!=null){xhr.on("error",callback).on("load",function(request){callback(null,request)})}request.send(data==null?null:data);return xhr};xhr.abort=function(){request.abort();return xhr};d3.rebind(xhr,dispatch,"on");if(arguments.length===2&&typeof mimeType==="function"){callback=mimeType,mimeType=null}return callback==null?xhr:xhr.get(d3_xhr_fixCallback(callback))};function d3_xhr_fixCallback(callback){return callback.length===1?function(error,request){callback(error==null?request:null)}:callback}function d3_dsv(delimiter,mimeType){var reFormat=new RegExp('["'+delimiter+"\n]"),delimiterCode=delimiter.charCodeAt(0);function dsv(url,row,callback){if(arguments.length<3){callback=row,row=null}var xhr=d3.xhr(url,mimeType,callback);xhr.row=function(_){return arguments.length?xhr.response((row=_)==null?response:typedResponse(_)):row};return xhr.row(row)}function response(request){return dsv.parse(request.responseText)}function typedResponse(f){return function(request){return dsv.parse(request.responseText,f)}}dsv.parse=function(text,f){var o;return dsv.parseRows(text,function(row,i){if(o){return o(row,i-1)}var a=new Function("d","return {"+row.map(function(name,i){return JSON.stringify(name)+": d["+i+"]"}).join(",")+"}");o=f?function(row,i){return f(a(row),i)}:a})};dsv.parseRows=function(text,f){var EOL={},EOF={},rows=[],N=text.length,I=0,n=0,t,eol;function token(){if(I>=N){return EOF}if(eol){return eol=false,EOL}var j=I;if(text.charCodeAt(j)===34){var i=j;while(i++<N){if(text.charCodeAt(i)===34){if(text.charCodeAt(i+1)!==34){break}++i}}I=i+2;var c=text.charCodeAt(i+1);if(c===13){eol=true;if(text.charCodeAt(i+2)===10){++I}}else{if(c===10){eol=true}}return text.substring(j+1,i).replace(/""/g,'"')}while(I<N){var c=text.charCodeAt(I++),k=1;if(c===10){eol=true}else{if(c===13){eol=true;if(text.charCodeAt(I)===10){++I,++k}}else{if(c!==delimiterCode){continue}}}return text.substring(j,I-k)}return text.substring(j)}while((t=token())!==EOF){var a=[];while(t!==EOL&&t!==EOF){a.push(t);t=token()}if(f&&!(a=f(a,n++))){continue}rows.push(a)}return rows};dsv.format=function(rows){if(Array.isArray(rows[0])){return dsv.formatRows(rows)}var fieldSet=new d3_Set(),fields=[];rows.forEach(function(row){for(var field in row){if(!fieldSet.has(field)){fields.push(fieldSet.add(field))}}});return[fields.map(formatValue).join(delimiter)].concat(rows.map(function(row){return fields.map(function(field){return formatValue(row[field])}).join(delimiter)})).join("\n")};dsv.formatRows=function(rows){return rows.map(formatRow).join("\n")};function formatRow(row){return row.map(formatValue).join(delimiter)}function formatValue(text){return reFormat.test(text)?'"'+text.replace(/\"/g,'""')+'"':text}return dsv}d3.csv=d3_dsv(",","text/csv");d3.tsv=d3_dsv("	","text/tab-separated-values");var d3_timer_id=0,d3_timer_byId={},d3_timer_queue=null,d3_timer_interval,d3_timer_timeout;d3.timer=function(callback,delay,then){if(arguments.length<3){if(arguments.length<2){delay=0}else{if(!isFinite(delay)){return}}then=Date.now()}var timer=d3_timer_byId[callback.id];if(timer&&timer.callback===callback){timer.then=then;timer.delay=delay}else{d3_timer_byId[callback.id=++d3_timer_id]=d3_timer_queue={callback:callback,then:then,delay:delay,next:d3_timer_queue}}if(!d3_timer_interval){d3_timer_timeout=clearTimeout(d3_timer_timeout);d3_timer_interval=1;d3_timer_frame(d3_timer_step)}};function d3_timer_step(){var elapsed,now=Date.now(),t1=d3_timer_queue;while(t1){elapsed=now-t1.then;if(elapsed>=t1.delay){t1.flush=t1.callback(elapsed)}t1=t1.next}var delay=d3_timer_flush()-now;if(delay>24){if(isFinite(delay)){clearTimeout(d3_timer_timeout);d3_timer_timeout=setTimeout(d3_timer_step,delay)}d3_timer_interval=0}else{d3_timer_interval=1;d3_timer_frame(d3_timer_step)}}d3.timer.flush=function(){var elapsed,now=Date.now(),t1=d3_timer_queue;while(t1){elapsed=now-t1.then;if(!t1.delay){t1.flush=t1.callback(elapsed)}t1=t1.next}d3_timer_flush()};function d3_timer_flush(){var t0=null,t1=d3_timer_queue,then=Infinity;while(t1){if(t1.flush){delete d3_timer_byId[t1.callback.id];t1=t0?t0.next=t1.next:d3_timer_queue=t1.next}else{then=Math.min(then,t1.then+t1.delay);t1=(t0=t1).next}}return then}var d3_timer_frame=d3_window.requestAnimationFrame||d3_window.webkitRequestAnimationFrame||d3_window.mozRequestAnimationFrame||d3_window.oRequestAnimationFrame||d3_window.msRequestAnimationFrame||function(callback){setTimeout(callback,17)};var d3_format_decimalPoint=".",d3_format_thousandsSeparator=",",d3_format_grouping=[3,3];var d3_formatPrefixes=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(d3_formatPrefix);d3.formatPrefix=function(value,precision){var i=0;if(value){if(value<0){value*=-1}if(precision){value=d3.round(value,d3_format_precision(value,precision))}i=1+Math.floor(1e-12+Math.log(value)/Math.LN10);i=Math.max(-24,Math.min(24,Math.floor((i<=0?i+1:i-1)/3)*3))}return d3_formatPrefixes[8+i/3]};function d3_formatPrefix(d,i){var k=Math.pow(10,Math.abs(8-i)*3);return{scale:i>8?function(d){return d/k}:function(d){return d*k},symbol:d}}d3.round=function(x,n){return n?Math.round(x*(n=Math.pow(10,n)))/n:Math.round(x)};d3.format=function(specifier){var match=d3_format_re.exec(specifier),fill=match[1]||" ",align=match[2]||">",sign=match[3]||"",basePrefix=match[4]||"",zfill=match[5],width=+match[6],comma=match[7],precision=match[8],type=match[9],scale=1,suffix="",integer=false;if(precision){precision=+precision.substring(1)}if(zfill||fill==="0"&&align==="="){zfill=fill="0";align="=";if(comma){width-=Math.floor((width-1)/4)}}switch(type){case"n":comma=true;type="g";break;case"%":scale=100;suffix="%";type="f";break;case"p":scale=100;suffix="%";type="r";break;case"b":case"o":case"x":case"X":if(basePrefix){basePrefix="0"+type.toLowerCase()}case"c":case"d":integer=true;precision=0;break;case"s":scale=-1;type="r";break}if(basePrefix==="#"){basePrefix=""}if(type=="r"&&!precision){type="g"}if(precision!=null){if(type=="g"){precision=Math.max(1,Math.min(21,precision))}else{if(type=="e"||type=="f"){precision=Math.max(0,Math.min(20,precision))}}}type=d3_format_types.get(type)||d3_format_typeDefault;var zcomma=zfill&&comma;return function(value){if(integer&&value%1){return""}var negative=value<0||value===0&&1/value<0?(value=-value,"-"):sign;if(scale<0){var prefix=d3.formatPrefix(value,precision);value=prefix.scale(value);suffix=prefix.symbol}else{value*=scale}value=type(value,precision);if(!zfill&&comma){value=d3_format_group(value)}var length=basePrefix.length+value.length+(zcomma?0:negative.length),padding=length<width?new Array(length=width-length+1).join(fill):"";if(zcomma){value=d3_format_group(padding+value)}if(d3_format_decimalPoint){value.replace(".",d3_format_decimalPoint)}negative+=basePrefix;return(align==="<"?negative+value+padding:align===">"?padding+negative+value:align==="^"?padding.substring(0,length>>=1)+negative+value+padding.substring(length):negative+(zcomma?value:padding+value))+suffix}};var d3_format_re=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;var d3_format_types=d3.map({b:function(x){return x.toString(2)},c:function(x){return String.fromCharCode(x)},o:function(x){return x.toString(8)},x:function(x){return x.toString(16)},X:function(x){return x.toString(16).toUpperCase()},g:function(x,p){return x.toPrecision(p)},e:function(x,p){return x.toExponential(p)},f:function(x,p){return x.toFixed(p)},r:function(x,p){return(x=d3.round(x,d3_format_precision(x,p))).toFixed(Math.max(0,Math.min(20,d3_format_precision(x*(1+1e-15),p))))}});function d3_format_precision(x,p){return p-(x?Math.ceil(Math.log(x)/Math.LN10):1)}function d3_format_typeDefault(x){return x+""}var d3_format_group=d3_identity;if(d3_format_grouping){var d3_format_groupingLength=d3_format_grouping.length;d3_format_group=function(value){var i=value.lastIndexOf("."),f=i>=0?"."+value.substring(i+1):(i=value.length,""),t=[],j=0,g=d3_format_grouping[0];while(i>0&&g>0){t.push(value.substring(i-=g,i+g));g=d3_format_grouping[j=(j+1)%d3_format_groupingLength]}return t.reverse().join(d3_format_thousandsSeparator||"")+f}}d3.geo={};d3.geo.stream=function(object,listener){if(object&&d3_geo_streamObjectType.hasOwnProperty(object.type)){d3_geo_streamObjectType[object.type](object,listener)}else{d3_geo_streamGeometry(object,listener)}};function d3_geo_streamGeometry(geometry,listener){if(geometry&&d3_geo_streamGeometryType.hasOwnProperty(geometry.type)){d3_geo_streamGeometryType[geometry.type](geometry,listener)}}var d3_geo_streamObjectType={Feature:function(feature,listener){d3_geo_streamGeometry(feature.geometry,listener)},FeatureCollection:function(object,listener){var features=object.features,i=-1,n=features.length;while(++i<n){d3_geo_streamGeometry(features[i].geometry,listener)}}};var d3_geo_streamGeometryType={Sphere:function(object,listener){listener.sphere()},Point:function(object,listener){var coordinate=object.coordinates;listener.point(coordinate[0],coordinate[1])},MultiPoint:function(object,listener){var coordinates=object.coordinates,i=-1,n=coordinates.length,coordinate;while(++i<n){coordinate=coordinates[i],listener.point(coordinate[0],coordinate[1])}},LineString:function(object,listener){d3_geo_streamLine(object.coordinates,listener,0)},MultiLineString:function(object,listener){var coordinates=object.coordinates,i=-1,n=coordinates.length;while(++i<n){d3_geo_streamLine(coordinates[i],listener,0)}},Polygon:function(object,listener){d3_geo_streamPolygon(object.coordinates,listener)},MultiPolygon:function(object,listener){var coordinates=object.coordinates,i=-1,n=coordinates.length;while(++i<n){d3_geo_streamPolygon(coordinates[i],listener)}},GeometryCollection:function(object,listener){var geometries=object.geometries,i=-1,n=geometries.length;while(++i<n){d3_geo_streamGeometry(geometries[i],listener)}}};function d3_geo_streamLine(coordinates,listener,closed){var i=-1,n=coordinates.length-closed,coordinate;listener.lineStart();while(++i<n){coordinate=coordinates[i],listener.point(coordinate[0],coordinate[1])}listener.lineEnd()}function d3_geo_streamPolygon(coordinates,listener){var i=-1,n=coordinates.length;listener.polygonStart();while(++i<n){d3_geo_streamLine(coordinates[i],listener,1)}listener.polygonEnd()}d3.geo.area=function(object){d3_geo_areaSum=0;d3.geo.stream(object,d3_geo_area);return d3_geo_areaSum};var d3_geo_areaSum,d3_geo_areaRingU,d3_geo_areaRingV;var d3_geo_area={sphere:function(){d3_geo_areaSum+=4*π},point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){d3_geo_areaRingU=1,d3_geo_areaRingV=0;d3_geo_area.lineStart=d3_geo_areaRingStart},polygonEnd:function(){var area=2*Math.atan2(d3_geo_areaRingV,d3_geo_areaRingU);d3_geo_areaSum+=area<0?4*π+area:area;d3_geo_area.lineStart=d3_geo_area.lineEnd=d3_geo_area.point=d3_noop}};function d3_geo_areaRingStart(){var λ00,φ00,λ0,cosφ0,sinφ0;d3_geo_area.point=function(λ,φ){d3_geo_area.point=nextPoint;λ0=(λ00=λ)*d3_radians,cosφ0=Math.cos(φ=(φ00=φ)*d3_radians/2+π/4),sinφ0=Math.sin(φ)};function nextPoint(λ,φ){λ*=d3_radians;φ=φ*d3_radians/2+π/4;var dλ=λ-λ0,cosφ=Math.cos(φ),sinφ=Math.sin(φ),k=sinφ0*sinφ,u0=d3_geo_areaRingU,v0=d3_geo_areaRingV,u=cosφ0*cosφ+k*Math.cos(dλ),v=k*Math.sin(dλ);d3_geo_areaRingU=u0*u-v0*v;d3_geo_areaRingV=v0*u+u0*v;λ0=λ,cosφ0=cosφ,sinφ0=sinφ}d3_geo_area.lineEnd=function(){nextPoint(λ00,φ00)}}d3.geo.bounds=d3_geo_bounds(d3_identity);function d3_geo_bounds(projectStream){var x0,y0,x1,y1;var bound={point:boundPoint,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){bound.lineEnd=boundPolygonLineEnd},polygonEnd:function(){bound.point=boundPoint}};function boundPoint(x,y){if(x<x0){x0=x}if(x>x1){x1=x}if(y<y0){y0=y}if(y>y1){y1=y}}function boundPolygonLineEnd(){bound.point=bound.lineEnd=d3_noop}return function(feature){y1=x1=-(x0=y0=Infinity);d3.geo.stream(feature,projectStream(bound));return[[x0,y0],[x1,y1]]}}d3.geo.centroid=function(object){d3_geo_centroidDimension=d3_geo_centroidW=d3_geo_centroidX=d3_geo_centroidY=d3_geo_centroidZ=0;d3.geo.stream(object,d3_geo_centroid);var m;if(d3_geo_centroidW&&Math.abs(m=Math.sqrt(d3_geo_centroidX*d3_geo_centroidX+d3_geo_centroidY*d3_geo_centroidY+d3_geo_centroidZ*d3_geo_centroidZ))>ε){return[Math.atan2(d3_geo_centroidY,d3_geo_centroidX)*d3_degrees,Math.asin(Math.max(-1,Math.min(1,d3_geo_centroidZ/m)))*d3_degrees]}};var d3_geo_centroidDimension,d3_geo_centroidW,d3_geo_centroidX,d3_geo_centroidY,d3_geo_centroidZ;var d3_geo_centroid={sphere:function(){if(d3_geo_centroidDimension<2){d3_geo_centroidDimension=2;d3_geo_centroidW=d3_geo_centroidX=d3_geo_centroidY=d3_geo_centroidZ=0}},point:d3_geo_centroidPoint,lineStart:d3_geo_centroidLineStart,lineEnd:d3_geo_centroidLineEnd,polygonStart:function(){if(d3_geo_centroidDimension<2){d3_geo_centroidDimension=2;d3_geo_centroidW=d3_geo_centroidX=d3_geo_centroidY=d3_geo_centroidZ=0}d3_geo_centroid.lineStart=d3_geo_centroidRingStart},polygonEnd:function(){d3_geo_centroid.lineStart=d3_geo_centroidLineStart}};function d3_geo_centroidPoint(λ,φ){if(d3_geo_centroidDimension){return}++d3_geo_centroidW;λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);d3_geo_centroidX+=(cosφ*Math.cos(λ)-d3_geo_centroidX)/d3_geo_centroidW;d3_geo_centroidY+=(cosφ*Math.sin(λ)-d3_geo_centroidY)/d3_geo_centroidW;d3_geo_centroidZ+=(Math.sin(φ)-d3_geo_centroidZ)/d3_geo_centroidW}function d3_geo_centroidRingStart(){var λ00,φ00;d3_geo_centroidDimension=1;d3_geo_centroidLineStart();d3_geo_centroidDimension=2;var linePoint=d3_geo_centroid.point;d3_geo_centroid.point=function(λ,φ){linePoint(λ00=λ,φ00=φ)};d3_geo_centroid.lineEnd=function(){d3_geo_centroid.point(λ00,φ00);d3_geo_centroidLineEnd();d3_geo_centroid.lineEnd=d3_geo_centroidLineEnd}}function d3_geo_centroidLineStart(){var x0,y0,z0;if(d3_geo_centroidDimension>1){return}if(d3_geo_centroidDimension<1){d3_geo_centroidDimension=1;d3_geo_centroidW=d3_geo_centroidX=d3_geo_centroidY=d3_geo_centroidZ=0}d3_geo_centroid.point=function(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians);x0=cosφ*Math.cos(λ);y0=cosφ*Math.sin(λ);z0=Math.sin(φ);d3_geo_centroid.point=nextPoint};function nextPoint(λ,φ){λ*=d3_radians;var cosφ=Math.cos(φ*=d3_radians),x=cosφ*Math.cos(λ),y=cosφ*Math.sin(λ),z=Math.sin(φ),w=Math.atan2(Math.sqrt((w=y0*z-z0*y)*w+(w=z0*x-x0*z)*w+(w=x0*y-y0*x)*w),x0*x+y0*y+z0*z);d3_geo_centroidW+=w;d3_geo_centroidX+=w*(x0+(x0=x));d3_geo_centroidY+=w*(y0+(y0=y));d3_geo_centroidZ+=w*(z0+(z0=z))}}function d3_geo_centroidLineEnd(){d3_geo_centroid.point=d3_geo_centroidPoint}function d3_geo_cartesian(spherical){var λ=spherical[0],φ=spherical[1],cosφ=Math.cos(φ);return[cosφ*Math.cos(λ),cosφ*Math.sin(λ),Math.sin(φ)]}function d3_geo_cartesianDot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function d3_geo_cartesianCross(a,b){return[a[1]*b[2]-a[2]*b[1],a[2]*b[0]-a[0]*b[2],a[0]*b[1]-a[1]*b[0]]}function d3_geo_cartesianAdd(a,b){a[0]+=b[0];a[1]+=b[1];a[2]+=b[2]}function d3_geo_cartesianScale(vector,k){return[vector[0]*k,vector[1]*k,vector[2]*k]}function d3_geo_cartesianNormalize(d){var l=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2]);d[0]/=l;d[1]/=l;d[2]/=l}function d3_true(){return true}function d3_geo_spherical(cartesian){return[Math.atan2(cartesian[1],cartesian[0]),Math.asin(Math.max(-1,Math.min(1,cartesian[2])))]}function d3_geo_sphericalEqual(a,b){return Math.abs(a[0]-b[0])<ε&&Math.abs(a[1]-b[1])<ε}function d3_geo_clipPolygon(segments,compare,inside,interpolate,listener){var subject=[],clip=[];segments.forEach(function(segment){if((n=segment.length-1)<=0){return}var n,p0=segment[0],p1=segment[n];if(d3_geo_sphericalEqual(p0,p1)){listener.lineStart();for(var i=0;i<n;++i){listener.point((p0=segment[i])[0],p0[1])}listener.lineEnd();return}var a={point:p0,points:segment,other:null,visited:false,entry:true,subject:true},b={point:p0,points:[p0],other:a,visited:false,entry:false,subject:false};a.other=b;subject.push(a);clip.push(b);a={point:p1,points:[p1],other:null,visited:false,entry:false,subject:true};b={point:p1,points:[p1],other:a,visited:false,entry:true,subject:false};a.other=b;subject.push(a);clip.push(b)});clip.sort(compare);d3_geo_clipPolygonLinkCircular(subject);d3_geo_clipPolygonLinkCircular(clip);if(!subject.length){return}if(inside){for(var i=1,e=!inside(clip[0].point),n=clip.length;i<n;++i){clip[i].entry=e=!e}}var start=subject[0],current,points,point;while(1){current=start;while(current.visited){if((current=current.next)===start){return}}points=current.points;listener.lineStart();do{current.visited=current.other.visited=true;if(current.entry){if(current.subject){for(var i=0;i<points.length;i++){listener.point((point=points[i])[0],point[1])}}else{interpolate(current.point,current.next.point,1,listener)}current=current.next}else{if(current.subject){points=current.prev.points;for(var i=points.length;--i>=0;){listener.point((point=points[i])[0],point[1])}}else{interpolate(current.point,current.prev.point,-1,listener)}current=current.prev}current=current.other;points=current.points}while(!current.visited);listener.lineEnd()}}function d3_geo_clipPolygonLinkCircular(array){if(!(n=array.length)){return}var n,i=0,a=array[0],b;while(++i<n){a.next=b=array[i];b.prev=a;a=b}a.next=b=array[0];b.prev=a}function d3_geo_clip(pointVisible,clipLine,interpolate){return function(listener){var line=clipLine(listener);var clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){clip.point=pointRing;clip.lineStart=ringStart;clip.lineEnd=ringEnd;invisible=false;invisibleArea=visibleArea=0;segments=[];listener.polygonStart()},polygonEnd:function(){clip.point=point;clip.lineStart=lineStart;clip.lineEnd=lineEnd;segments=d3.merge(segments);if(segments.length){d3_geo_clipPolygon(segments,d3_geo_clipSort,null,interpolate,listener)}else{if(visibleArea<-ε||invisible&&invisibleArea<-ε){listener.lineStart();interpolate(null,null,1,listener);listener.lineEnd()}}listener.polygonEnd();segments=null},sphere:function(){listener.polygonStart();listener.lineStart();interpolate(null,null,1,listener);listener.lineEnd();listener.polygonEnd()}};function point(λ,φ){if(pointVisible(λ,φ)){listener.point(λ,φ)}}function pointLine(λ,φ){line.point(λ,φ)}function lineStart(){clip.point=pointLine;line.lineStart()}function lineEnd(){clip.point=point;line.lineEnd()}var segments,visibleArea,invisibleArea,invisible;var buffer=d3_geo_clipBufferListener(),ringListener=clipLine(buffer),ring;function pointRing(λ,φ){ringListener.point(λ,φ);ring.push([λ,φ])}function ringStart(){ringListener.lineStart();ring=[]}function ringEnd(){pointRing(ring[0][0],ring[0][1]);ringListener.lineEnd();var clean=ringListener.clean(),ringSegments=buffer.buffer(),segment,n=ringSegments.length;if(!n){invisible=true;invisibleArea+=d3_geo_clipAreaRing(ring,-1);ring=null;return}ring=null;if(clean&1){segment=ringSegments[0];visibleArea+=d3_geo_clipAreaRing(segment,1);var n=segment.length-1,i=-1,point;listener.lineStart();while(++i<n){listener.point((point=segment[i])[0],point[1])}listener.lineEnd();return}if(n>1&&clean&2){ringSegments.push(ringSegments.pop().concat(ringSegments.shift()))}segments.push(ringSegments.filter(d3_geo_clipSegmentLength1))}return clip}}function d3_geo_clipSegmentLength1(segment){return segment.length>1}function d3_geo_clipBufferListener(){var lines=[],line;return{lineStart:function(){lines.push(line=[])},point:function(λ,φ){line.push([λ,φ])},lineEnd:d3_noop,buffer:function(){var buffer=lines;lines=[];line=null;return buffer},rejoin:function(){if(lines.length>1){lines.push(lines.pop().concat(lines.shift()))}}}}function d3_geo_clipAreaRing(ring,invisible){if(!(n=ring.length)){return 0}var n,i=0,area=0,p=ring[0],λ=p[0],φ=p[1],cosφ=Math.cos(φ),x0=Math.atan2(invisible*Math.sin(λ)*cosφ,Math.sin(φ)),y0=1-invisible*Math.cos(λ)*cosφ,x1=x0,x,y;while(++i<n){p=ring[i];cosφ=Math.cos(φ=p[1]);x=Math.atan2(invisible*Math.sin(λ=p[0])*cosφ,Math.sin(φ));y=1-invisible*Math.cos(λ)*cosφ;if(Math.abs(y0-2)<ε&&Math.abs(y-2)<ε){continue}if(Math.abs(y)<ε||Math.abs(y0)<ε){}else{if(Math.abs(Math.abs(x-x0)-π)<ε){if(y+y0>2){area+=4*(x-x0)}}else{if(Math.abs(y0-2)<ε){area+=4*(x-x1)}else{area+=((3*π+x-x0)%(2*π)-π)*(y0+y)}}}x1=x0,x0=x,y0=y}return area}function d3_geo_clipSort(a,b){return((a=a.point)[0]<0?a[1]-π/2-ε:π/2-a[1])-((b=b.point)[0]<0?b[1]-π/2-ε:π/2-b[1])}var d3_geo_clipAntimeridian=d3_geo_clip(d3_true,d3_geo_clipAntimeridianLine,d3_geo_clipAntimeridianInterpolate);function d3_geo_clipAntimeridianLine(listener){var λ0=NaN,φ0=NaN,sλ0=NaN,clean;return{lineStart:function(){listener.lineStart();clean=1},point:function(λ1,φ1){var sλ1=λ1>0?π:-π,dλ=Math.abs(λ1-λ0);if(Math.abs(dλ-π)<ε){listener.point(λ0,φ0=(φ0+φ1)/2>0?π/2:-π/2);listener.point(sλ0,φ0);listener.lineEnd();listener.lineStart();listener.point(sλ1,φ0);listener.point(λ1,φ0);clean=0}else{if(sλ0!==sλ1&&dλ>=π){if(Math.abs(λ0-sλ0)<ε){λ0-=sλ0*ε}if(Math.abs(λ1-sλ1)<ε){λ1-=sλ1*ε}φ0=d3_geo_clipAntimeridianIntersect(λ0,φ0,λ1,φ1);listener.point(sλ0,φ0);listener.lineEnd();listener.lineStart();listener.point(sλ1,φ0);clean=0}}listener.point(λ0=λ1,φ0=φ1);sλ0=sλ1},lineEnd:function(){listener.lineEnd();λ0=φ0=NaN},clean:function(){return 2-clean}}}function d3_geo_clipAntimeridianIntersect(λ0,φ0,λ1,φ1){var cosφ0,cosφ1,sinλ0_λ1=Math.sin(λ0-λ1);return Math.abs(sinλ0_λ1)>ε?Math.atan((Math.sin(φ0)*(cosφ1=Math.cos(φ1))*Math.sin(λ1)-Math.sin(φ1)*(cosφ0=Math.cos(φ0))*Math.sin(λ0))/(cosφ0*cosφ1*sinλ0_λ1)):(φ0+φ1)/2}function d3_geo_clipAntimeridianInterpolate(from,to,direction,listener){var φ;if(from==null){φ=direction*π/2;listener.point(-π,φ);listener.point(0,φ);listener.point(π,φ);listener.point(π,0);listener.point(π,-φ);listener.point(0,-φ);listener.point(-π,-φ);listener.point(-π,0);listener.point(-π,φ)}else{if(Math.abs(from[0]-to[0])>ε){var s=(from[0]<to[0]?1:-1)*π;φ=direction*s/2;listener.point(-s,φ);listener.point(0,φ);listener.point(s,φ)}else{listener.point(to[0],to[1])}}}function d3_geo_clipCircle(radius){var cr=Math.cos(radius),smallRadius=cr>0,notHemisphere=Math.abs(cr)>ε,interpolate=d3_geo_circleInterpolate(radius,6*d3_radians);return d3_geo_clip(visible,clipLine,interpolate);function visible(λ,φ){return Math.cos(λ)*Math.cos(φ)>cr}function clipLine(listener){var point0,c0,v0,v00,clean;return{lineStart:function(){v00=v0=false;clean=1},point:function(λ,φ){var point1=[λ,φ],point2,v=visible(λ,φ),c=smallRadius?v?0:code(λ,φ):v?code(λ+(λ<0?π:-π),φ):0;if(!point0&&(v00=v0=v)){listener.lineStart()}if(v!==v0){point2=intersect(point0,point1);if(d3_geo_sphericalEqual(point0,point2)||d3_geo_sphericalEqual(point1,point2)){point1[0]+=ε;point1[1]+=ε;v=visible(point1[0],point1[1])}}if(v!==v0){clean=0;if(v){listener.lineStart();point2=intersect(point1,point0);listener.point(point2[0],point2[1])}else{point2=intersect(point0,point1);listener.point(point2[0],point2[1]);listener.lineEnd()}point0=point2}else{if(notHemisphere&&point0&&smallRadius^v){var t;if(!(c&c0)&&(t=intersect(point1,point0,true))){clean=0;if(smallRadius){listener.lineStart();listener.point(t[0][0],t[0][1]);listener.point(t[1][0],t[1][1]);listener.lineEnd()}else{listener.point(t[1][0],t[1][1]);listener.lineEnd();listener.lineStart();listener.point(t[0][0],t[0][1])}}}}if(v&&(!point0||!d3_geo_sphericalEqual(point0,point1))){listener.point(point1[0],point1[1])}point0=point1,v0=v,c0=c},lineEnd:function(){if(v0){listener.lineEnd()}point0=null},clean:function(){return clean|(v00&&v0)<<1}}}function intersect(a,b,two){var pa=d3_geo_cartesian(a),pb=d3_geo_cartesian(b);var n1=[1,0,0],n2=d3_geo_cartesianCross(pa,pb),n2n2=d3_geo_cartesianDot(n2,n2),n1n2=n2[0],determinant=n2n2-n1n2*n1n2;if(!determinant){return !two&&a}var c1=cr*n2n2/determinant,c2=-cr*n1n2/determinant,n1xn2=d3_geo_cartesianCross(n1,n2),A=d3_geo_cartesianScale(n1,c1),B=d3_geo_cartesianScale(n2,c2);d3_geo_cartesianAdd(A,B);var u=n1xn2,w=d3_geo_cartesianDot(A,u),uu=d3_geo_cartesianDot(u,u),t2=w*w-uu*(d3_geo_cartesianDot(A,A)-1);if(t2<0){return}var t=Math.sqrt(t2),q=d3_geo_cartesianScale(u,(-w-t)/uu);d3_geo_cartesianAdd(q,A);q=d3_geo_spherical(q);if(!two){return q}var λ0=a[0],λ1=b[0],φ0=a[1],φ1=b[1],z;if(λ1<λ0){z=λ0,λ0=λ1,λ1=z}var δλ=λ1-λ0,polar=Math.abs(δλ-π)<ε,meridian=polar||δλ<ε;if(!polar&&φ1<φ0){z=φ0,φ0=φ1,φ1=z}if(meridian?polar?φ0+φ1>0^q[1]<(Math.abs(q[0]-λ0)<ε?φ0:φ1):φ0<=q[1]&&q[1]<=φ1:δλ>π^(λ0<=q[0]&&q[0]<=λ1)){var q1=d3_geo_cartesianScale(u,(-w+t)/uu);d3_geo_cartesianAdd(q1,A);return[q,d3_geo_spherical(q1)]}}function code(λ,φ){var r=smallRadius?radius:π-radius,code=0;if(λ<-r){code|=1}else{if(λ>r){code|=2}}if(φ<-r){code|=4}else{if(φ>r){code|=8}}return code}}var d3_geo_clipViewMAX=1000000000;function d3_geo_clipView(x0,y0,x1,y1){return function(listener){var listener_=listener,bufferListener=d3_geo_clipBufferListener(),segments,polygon,ring;var clip={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){listener=bufferListener;segments=[];polygon=[]},polygonEnd:function(){listener=listener_;if((segments=d3.merge(segments)).length){listener.polygonStart();d3_geo_clipPolygon(segments,compare,inside,interpolate,listener);listener.polygonEnd()}else{if(insidePolygon([x0,y0])){listener.polygonStart(),listener.lineStart();interpolate(null,null,1,listener);listener.lineEnd(),listener.polygonEnd()}}segments=polygon=ring=null}};function inside(point){var a=corner(point,-1),i=insidePolygon([a===0||a===3?x0:x1,a>1?y1:y0]);return i}function insidePolygon(p){var wn=0,n=polygon.length,y=p[1];for(var i=0;i<n;++i){for(var j=1,v=polygon[i],m=v.length,a=v[0];j<m;++j){b=v[j];if(a[1]<=y){if(b[1]>y&&isLeft(a,b,p)>0){++wn}}else{if(b[1]<=y&&isLeft(a,b,p)<0){--wn}}a=b}}return wn!==0}function isLeft(a,b,c){return(b[0]-a[0])*(c[1]-a[1])-(c[0]-a[0])*(b[1]-a[1])}function interpolate(from,to,direction,listener){var a=0,a1=0;if(from==null||(a=corner(from,direction))!==(a1=corner(to,direction))||comparePoints(from,to)<0^direction>0){do{listener.point(a===0||a===3?x0:x1,a>1?y1:y0)}while((a=(a+direction+4)%4)!==a1)}else{listener.point(to[0],to[1])}}function visible(x,y){return x0<=x&&x<=x1&&y0<=y&&y<=y1}function point(x,y){if(visible(x,y)){listener.point(x,y)}}var x__,y__,v__,x_,y_,v_,first;function lineStart(){clip.point=linePoint;if(polygon){polygon.push(ring=[])}first=true;v_=false;x_=y_=NaN}function lineEnd(){if(segments){linePoint(x__,y__);if(v__&&v_){bufferListener.rejoin()}segments.push(bufferListener.buffer())}clip.point=point;if(v_){listener.lineEnd()}}function linePoint(x,y){x=Math.max(-d3_geo_clipViewMAX,Math.min(d3_geo_clipViewMAX,x));y=Math.max(-d3_geo_clipViewMAX,Math.min(d3_geo_clipViewMAX,y));var v=visible(x,y);if(polygon){ring.push([x,y])}if(first){x__=x,y__=y,v__=v;first=false;if(v){listener.lineStart();listener.point(x,y)}}else{if(v&&v_){listener.point(x,y)}else{var a=[x_,y_],b=[x,y];if(clipLine(a,b)){if(!v_){listener.lineStart();listener.point(a[0],a[1])}listener.point(b[0],b[1]);if(!v){listener.lineEnd()}}else{listener.lineStart();listener.point(x,y)}}}x_=x,y_=y,v_=v}return clip};function corner(p,direction){return Math.abs(p[0]-x0)<ε?direction>0?0:3:Math.abs(p[0]-x1)<ε?direction>0?2:1:Math.abs(p[1]-y0)<ε?direction>0?1:0:direction>0?3:2}function compare(a,b){return comparePoints(a.point,b.point)}function comparePoints(a,b){var ca=corner(a,1),cb=corner(b,1);return ca!==cb?ca-cb:ca===0?b[1]-a[1]:ca===1?a[0]-b[0]:ca===2?a[1]-b[1]:b[0]-a[0]}function clipLine(a,b){var dx=b[0]-a[0],dy=b[1]-a[1],t=[0,1];if(Math.abs(dx)<ε&&Math.abs(dy)<ε){return x0<=a[0]&&a[0]<=x1&&y0<=a[1]&&a[1]<=y1}if(d3_geo_clipViewT(x0-a[0],dx,t)&&d3_geo_clipViewT(a[0]-x1,-dx,t)&&d3_geo_clipViewT(y0-a[1],dy,t)&&d3_geo_clipViewT(a[1]-y1,-dy,t)){if(t[1]<1){b[0]=a[0]+t[1]*dx;b[1]=a[1]+t[1]*dy}if(t[0]>0){a[0]+=t[0]*dx;a[1]+=t[0]*dy}return true}return false}}function d3_geo_clipViewT(num,denominator,t){if(Math.abs(denominator)<ε){return num<=0}var u=num/denominator;if(denominator>0){if(u>t[1]){return false}if(u>t[0]){t[0]=u}}else{if(u<t[0]){return false}if(u<t[1]){t[1]=u}}return true}function d3_geo_compose(a,b){function compose(x,y){return x=a(x,y),b(x[0],x[1])}if(a.invert&&b.invert){compose.invert=function(x,y){return x=b.invert(x,y),x&&a.invert(x[0],x[1])}}return compose}function d3_geo_resample(project){var δ2=0.5,maxDepth=16;function resample(stream){var λ0,x0,y0,a0,b0,c0;var resample={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){stream.polygonStart();resample.lineStart=polygonLineStart},polygonEnd:function(){stream.polygonEnd();resample.lineStart=lineStart}};function point(x,y){x=project(x,y);stream.point(x[0],x[1])}function lineStart(){x0=NaN;resample.point=linePoint;stream.lineStart()}function linePoint(λ,φ){var c=d3_geo_cartesian([λ,φ]),p=project(λ,φ);resampleLineTo(x0,y0,λ0,a0,b0,c0,x0=p[0],y0=p[1],λ0=λ,a0=c[0],b0=c[1],c0=c[2],maxDepth,stream);stream.point(x0,y0)}function lineEnd(){resample.point=point;stream.lineEnd()}function polygonLineStart(){var λ00,φ00,x00,y00,a00,b00,c00;lineStart();resample.point=function(λ,φ){linePoint(λ00=λ,φ00=φ),x00=x0,y00=y0,a00=a0,b00=b0,c00=c0;resample.point=linePoint};resample.lineEnd=function(){resampleLineTo(x0,y0,λ0,a0,b0,c0,x00,y00,λ00,a00,b00,c00,maxDepth,stream);resample.lineEnd=lineEnd;lineEnd()}}return resample}function resampleLineTo(x0,y0,λ0,a0,b0,c0,x1,y1,λ1,a1,b1,c1,depth,stream){var dx=x1-x0,dy=y1-y0,d2=dx*dx+dy*dy;if(d2>4*δ2&&depth--){var a=a0+a1,b=b0+b1,c=c0+c1,m=Math.sqrt(a*a+b*b+c*c),φ2=Math.asin(c/=m),λ2=Math.abs(Math.abs(c)-1)<ε?(λ0+λ1)/2:Math.atan2(b,a),p=project(λ2,φ2),x2=p[0],y2=p[1],dx2=x2-x0,dy2=y2-y0,dz=dy*dx2-dx*dy2;if(dz*dz/d2>δ2||Math.abs((dx*dx2+dy*dy2)/d2-0.5)>0.3){resampleLineTo(x0,y0,λ0,a0,b0,c0,x2,y2,λ2,a/=m,b/=m,c,depth,stream);stream.point(x2,y2);resampleLineTo(x2,y2,λ2,a,b,c,x1,y1,λ1,a1,b1,c1,depth,stream)}}}resample.precision=function(_){if(!arguments.length){return Math.sqrt(δ2)}maxDepth=(δ2=_*_)>0&&16;return resample};return resample}d3.geo.projection=d3_geo_projection;d3.geo.projectionMutator=d3_geo_projectionMutator;function d3_geo_projection(project){return d3_geo_projectionMutator(function(){return project})()}function d3_geo_projectionMutator(projectAt){var project,rotate,projectRotate,projectResample=d3_geo_resample(function(x,y){x=project(x,y);return[x[0]*k+δx,δy-x[1]*k]}),k=150,x=480,y=250,λ=0,φ=0,δλ=0,δφ=0,δγ=0,δx,δy,preclip=d3_geo_clipAntimeridian,postclip=d3_identity,clipAngle=null,clipExtent=null;function projection(point){point=projectRotate(point[0]*d3_radians,point[1]*d3_radians);return[point[0]*k+δx,δy-point[1]*k]}function invert(point){point=projectRotate.invert((point[0]-δx)/k,(δy-point[1])/k);return point&&[point[0]*d3_degrees,point[1]*d3_degrees]}projection.stream=function(stream){return d3_geo_projectionRadiansRotate(rotate,preclip(projectResample(postclip(stream))))};projection.clipAngle=function(_){if(!arguments.length){return clipAngle}preclip=_==null?(clipAngle=_,d3_geo_clipAntimeridian):d3_geo_clipCircle((clipAngle=+_)*d3_radians);return projection};projection.clipExtent=function(_){if(!arguments.length){return clipExtent}clipExtent=_;postclip=_==null?d3_identity:d3_geo_clipView(_[0][0],_[0][1],_[1][0],_[1][1]);return projection};projection.scale=function(_){if(!arguments.length){return k}k=+_;return reset()};projection.translate=function(_){if(!arguments.length){return[x,y]}x=+_[0];y=+_[1];return reset()};projection.center=function(_){if(!arguments.length){return[λ*d3_degrees,φ*d3_degrees]}λ=_[0]%360*d3_radians;φ=_[1]%360*d3_radians;return reset()};projection.rotate=function(_){if(!arguments.length){return[δλ*d3_degrees,δφ*d3_degrees,δγ*d3_degrees]}δλ=_[0]%360*d3_radians;δφ=_[1]%360*d3_radians;δγ=_.length>2?_[2]%360*d3_radians:0;return reset()};d3.rebind(projection,projectResample,"precision");function reset(){projectRotate=d3_geo_compose(rotate=d3_geo_rotation(δλ,δφ,δγ),project);var center=project(λ,φ);δx=x-center[0]*k;δy=y+center[1]*k;return projection}return function(){project=projectAt.apply(this,arguments);projection.invert=project.invert&&invert;return reset()}}function d3_geo_projectionRadiansRotate(rotate,stream){return{point:function(x,y){y=rotate(x*d3_radians,y*d3_radians),x=y[0];stream.point(x>π?x-2*π:x<-π?x+2*π:x,y[1])},sphere:function(){stream.sphere()},lineStart:function(){stream.lineStart()},lineEnd:function(){stream.lineEnd()},polygonStart:function(){stream.polygonStart()},polygonEnd:function(){stream.polygonEnd()}}}function d3_geo_equirectangular(λ,φ){return[λ,φ]}(d3.geo.equirectangular=function(){return d3_geo_projection(d3_geo_equirectangular)}).raw=d3_geo_equirectangular.invert=d3_geo_equirectangular;d3.geo.rotation=function(rotate){rotate=d3_geo_rotation(rotate[0]%360*d3_radians,rotate[1]*d3_radians,rotate.length>2?rotate[2]*d3_radians:0);function forward(coordinates){coordinates=rotate(coordinates[0]*d3_radians,coordinates[1]*d3_radians);return coordinates[0]*=d3_degrees,coordinates[1]*=d3_degrees,coordinates}forward.invert=function(coordinates){coordinates=rotate.invert(coordinates[0]*d3_radians,coordinates[1]*d3_radians);return coordinates[0]*=d3_degrees,coordinates[1]*=d3_degrees,coordinates};return forward};function d3_geo_rotation(δλ,δφ,δγ){return δλ?δφ||δγ?d3_geo_compose(d3_geo_rotationλ(δλ),d3_geo_rotationφγ(δφ,δγ)):d3_geo_rotationλ(δλ):δφ||δγ?d3_geo_rotationφγ(δφ,δγ):d3_geo_equirectangular}function d3_geo_forwardRotationλ(δλ){return function(λ,φ){return λ+=δλ,[λ>π?λ-2*π:λ<-π?λ+2*π:λ,φ]}}function d3_geo_rotationλ(δλ){var rotation=d3_geo_forwardRotationλ(δλ);rotation.invert=d3_geo_forwardRotationλ(-δλ);return rotation}function d3_geo_rotationφγ(δφ,δγ){var cosδφ=Math.cos(δφ),sinδφ=Math.sin(δφ),cosδγ=Math.cos(δγ),sinδγ=Math.sin(δγ);function rotation(λ,φ){var cosφ=Math.cos(φ),x=Math.cos(λ)*cosφ,y=Math.sin(λ)*cosφ,z=Math.sin(φ),k=z*cosδφ+x*sinδφ;return[Math.atan2(y*cosδγ-k*sinδγ,x*cosδφ-z*sinδφ),Math.asin(Math.max(-1,Math.min(1,k*cosδγ+y*sinδγ)))]}rotation.invert=function(λ,φ){var cosφ=Math.cos(φ),x=Math.cos(λ)*cosφ,y=Math.sin(λ)*cosφ,z=Math.sin(φ),k=z*cosδγ-y*sinδγ;return[Math.atan2(y*cosδγ+z*sinδγ,x*cosδφ+k*sinδφ),Math.asin(Math.max(-1,Math.min(1,k*cosδφ-x*sinδφ)))]};return rotation}d3.geo.circle=function(){var origin=[0,0],angle,precision=6,interpolate;function circle(){var center=typeof origin==="function"?origin.apply(this,arguments):origin,rotate=d3_geo_rotation(-center[0]*d3_radians,-center[1]*d3_radians,0).invert,ring=[];interpolate(null,null,1,{point:function(x,y){ring.push(x=rotate(x,y));x[0]*=d3_degrees,x[1]*=d3_degrees}});return{type:"Polygon",coordinates:[ring]}}circle.origin=function(x){if(!arguments.length){return origin}origin=x;return circle};circle.angle=function(x){if(!arguments.length){return angle}interpolate=d3_geo_circleInterpolate((angle=+x)*d3_radians,precision*d3_radians);return circle};circle.precision=function(_){if(!arguments.length){return precision}interpolate=d3_geo_circleInterpolate(angle*d3_radians,(precision=+_)*d3_radians);return circle};return circle.angle(90)};function d3_geo_circleInterpolate(radius,precision){var cr=Math.cos(radius),sr=Math.sin(radius);return function(from,to,direction,listener){if(from!=null){from=d3_geo_circleAngle(cr,from);to=d3_geo_circleAngle(cr,to);if(direction>0?from<to:from>to){from+=direction*2*π}}else{from=radius+direction*2*π;to=radius}var point;for(var step=direction*precision,t=from;direction>0?t>to:t<to;t-=step){listener.point((point=d3_geo_spherical([cr,-sr*Math.cos(t),-sr*Math.sin(t)]))[0],point[1])}}}function d3_geo_circleAngle(cr,point){var a=d3_geo_cartesian(point);a[0]-=cr;d3_geo_cartesianNormalize(a);var angle=d3_acos(-a[1]);return((-a[2]<0?-angle:angle)+2*Math.PI-ε)%(2*Math.PI)}d3.geo.distance=function(a,b){var Δλ=(b[0]-a[0])*d3_radians,φ0=a[1]*d3_radians,φ1=b[1]*d3_radians,sinΔλ=Math.sin(Δλ),cosΔλ=Math.cos(Δλ),sinφ0=Math.sin(φ0),cosφ0=Math.cos(φ0),sinφ1=Math.sin(φ1),cosφ1=Math.cos(φ1),t;return Math.atan2(Math.sqrt((t=cosφ1*sinΔλ)*t+(t=cosφ0*sinφ1-sinφ0*cosφ1*cosΔλ)*t),sinφ0*sinφ1+cosφ0*cosφ1*cosΔλ)};d3.geo.graticule=function(){var x1,x0,X1,X0,y1,y0,Y1,Y0,dx=10,dy=dx,DX=90,DY=360,x,y,X,Y,precision=2.5;function graticule(){return{type:"MultiLineString",coordinates:lines()}}function lines(){return d3.range(Math.ceil(X0/DX)*DX,X1,DX).map(X).concat(d3.range(Math.ceil(Y0/DY)*DY,Y1,DY).map(Y)).concat(d3.range(Math.ceil(x0/dx)*dx,x1,dx).filter(function(x){return Math.abs(x%DX)>ε}).map(x)).concat(d3.range(Math.ceil(y0/dy)*dy,y1,dy).filter(function(y){return Math.abs(y%DY)>ε}).map(y))}graticule.lines=function(){return lines().map(function(coordinates){return{type:"LineString",coordinates:coordinates}})};graticule.outline=function(){return{type:"Polygon",coordinates:[X(X0).concat(Y(Y1).slice(1),X(X1).reverse().slice(1),Y(Y0).reverse().slice(1))]}};graticule.extent=function(_){if(!arguments.length){return graticule.minorExtent()}return graticule.majorExtent(_).minorExtent(_)};graticule.majorExtent=function(_){if(!arguments.length){return[[X0,Y0],[X1,Y1]]}X0=+_[0][0],X1=+_[1][0];Y0=+_[0][1],Y1=+_[1][1];if(X0>X1){_=X0,X0=X1,X1=_}if(Y0>Y1){_=Y0,Y0=Y1,Y1=_}return graticule.precision(precision)};graticule.minorExtent=function(_){if(!arguments.length){return[[x0,y0],[x1,y1]]}x0=+_[0][0],x1=+_[1][0];y0=+_[0][1],y1=+_[1][1];if(x0>x1){_=x0,x0=x1,x1=_}if(y0>y1){_=y0,y0=y1,y1=_}return graticule.precision(precision)};graticule.step=function(_){if(!arguments.length){return graticule.minorStep()}return graticule.majorStep(_).minorStep(_)};graticule.majorStep=function(_){if(!arguments.length){return[DX,DY]}DX=+_[0],DY=+_[1];return graticule};graticule.minorStep=function(_){if(!arguments.length){return[dx,dy]}dx=+_[0],dy=+_[1];return graticule};graticule.precision=function(_){if(!arguments.length){return precision}precision=+_;x=d3_geo_graticuleX(y0,y1,90);y=d3_geo_graticuleY(x0,x1,precision);X=d3_geo_graticuleX(Y0,Y1,90);Y=d3_geo_graticuleY(X0,X1,precision);return graticule};return graticule.majorExtent([[-180,-90+ε],[180,90-ε]]).minorExtent([[-180,-80-ε],[180,80+ε]])};function d3_geo_graticuleX(y0,y1,dy){var y=d3.range(y0,y1-ε,dy).concat(y1);return function(x){return y.map(function(y){return[x,y]})}}function d3_geo_graticuleY(x0,x1,dx){var x=d3.range(x0,x1-ε,dx).concat(x1);return function(y){return x.map(function(x){return[x,y]})}}function d3_source(d){return d.source}function d3_target(d){return d.target}d3.geo.greatArc=function(){var source=d3_source,source_,target=d3_target,target_;function greatArc(){return{type:"LineString",coordinates:[source_||source.apply(this,arguments),target_||target.apply(this,arguments)]}}greatArc.distance=function(){return d3.geo.distance(source_||source.apply(this,arguments),target_||target.apply(this,arguments))};greatArc.source=function(_){if(!arguments.length){return source}source=_,source_=typeof _==="function"?null:_;return greatArc};greatArc.target=function(_){if(!arguments.length){return target}target=_,target_=typeof _==="function"?null:_;return greatArc};greatArc.precision=function(){return arguments.length?greatArc:0};return greatArc};d3.geo.interpolate=function(source,target){return d3_geo_interpolate(source[0]*d3_radians,source[1]*d3_radians,target[0]*d3_radians,target[1]*d3_radians)};function d3_geo_interpolate(x0,y0,x1,y1){var cy0=Math.cos(y0),sy0=Math.sin(y0),cy1=Math.cos(y1),sy1=Math.sin(y1),kx0=cy0*Math.cos(x0),ky0=cy0*Math.sin(x0),kx1=cy1*Math.cos(x1),ky1=cy1*Math.sin(x1),d=2*Math.asin(Math.sqrt(d3_haversin(y1-y0)+cy0*cy1*d3_haversin(x1-x0))),k=1/Math.sin(d);var interpolate=d?function(t){var B=Math.sin(t*=d)*k,A=Math.sin(d-t)*k,x=A*kx0+B*kx1,y=A*ky0+B*ky1,z=A*sy0+B*sy1;return[Math.atan2(y,x)*d3_degrees,Math.atan2(z,Math.sqrt(x*x+y*y))*d3_degrees]}:function(){return[x0*d3_degrees,y0*d3_degrees]};interpolate.distance=d;return interpolate}d3.geo.length=function(object){d3_geo_lengthSum=0;d3.geo.stream(object,d3_geo_length);return d3_geo_lengthSum};var d3_geo_lengthSum;var d3_geo_length={sphere:d3_noop,point:d3_noop,lineStart:d3_geo_lengthLineStart,lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop};function d3_geo_lengthLineStart(){var λ0,sinφ0,cosφ0;d3_geo_length.point=function(λ,φ){λ0=λ*d3_radians,sinφ0=Math.sin(φ*=d3_radians),cosφ0=Math.cos(φ);d3_geo_length.point=nextPoint};d3_geo_length.lineEnd=function(){d3_geo_length.point=d3_geo_length.lineEnd=d3_noop};function nextPoint(λ,φ){var sinφ=Math.sin(φ*=d3_radians),cosφ=Math.cos(φ),t=Math.abs((λ*=d3_radians)-λ0),cosΔλ=Math.cos(t);d3_geo_lengthSum+=Math.atan2(Math.sqrt((t=cosφ*Math.sin(t))*t+(t=cosφ0*sinφ-sinφ0*cosφ*cosΔλ)*t),sinφ0*sinφ+cosφ0*cosφ*cosΔλ);λ0=λ,sinφ0=sinφ,cosφ0=cosφ}}function d3_geo_conic(projectAt){var φ0=0,φ1=π/3,m=d3_geo_projectionMutator(projectAt),p=m(φ0,φ1);p.parallels=function(_){if(!arguments.length){return[φ0/π*180,φ1/π*180]}return m(φ0=_[0]*π/180,φ1=_[1]*π/180)};return p}function d3_geo_conicEqualArea(φ0,φ1){var sinφ0=Math.sin(φ0),n=(sinφ0+Math.sin(φ1))/2,C=1+sinφ0*(2*n-sinφ0),ρ0=Math.sqrt(C)/n;function forward(λ,φ){var ρ=Math.sqrt(C-2*n*Math.sin(φ))/n;return[ρ*Math.sin(λ*=n),ρ0-ρ*Math.cos(λ)]}forward.invert=function(x,y){var ρ0_y=ρ0-y;return[Math.atan2(x,ρ0_y)/n,Math.asin((C-(x*x+ρ0_y*ρ0_y)*n*n)/(2*n))]};return forward}(d3.geo.conicEqualArea=function(){return d3_geo_conic(d3_geo_conicEqualArea)}).raw=d3_geo_conicEqualArea;d3.geo.albersUsa=function(){var lower48=d3.geo.conicEqualArea().rotate([98,0]).center([0,38]).parallels([29.5,45.5]);var alaska=d3.geo.conicEqualArea().rotate([160,0]).center([0,60]).parallels([55,65]);var hawaii=d3.geo.conicEqualArea().rotate([160,0]).center([0,20]).parallels([8,18]);var puertoRico=d3.geo.conicEqualArea().rotate([60,0]).center([0,10]).parallels([8,18]);var alaskaInvert,hawaiiInvert,puertoRicoInvert;function albersUsa(coordinates){return projection(coordinates)(coordinates)}function projection(point){var lon=point[0],lat=point[1];return lat>50?alaska:lon<-140?hawaii:lat<21?puertoRico:lower48}albersUsa.invert=function(coordinates){return alaskaInvert(coordinates)||hawaiiInvert(coordinates)||puertoRicoInvert(coordinates)||lower48.invert(coordinates)};albersUsa.scale=function(x){if(!arguments.length){return lower48.scale()}lower48.scale(x);alaska.scale(x*0.6);hawaii.scale(x);puertoRico.scale(x*1.5);return albersUsa.translate(lower48.translate())};albersUsa.translate=function(x){if(!arguments.length){return lower48.translate()}var dz=lower48.scale(),dx=x[0],dy=x[1];lower48.translate(x);alaska.translate([dx-0.4*dz,dy+0.17*dz]);hawaii.translate([dx-0.19*dz,dy+0.2*dz]);puertoRico.translate([dx+0.58*dz,dy+0.43*dz]);alaskaInvert=d3_geo_albersUsaInvert(alaska,[[-180,50],[-130,72]]);hawaiiInvert=d3_geo_albersUsaInvert(hawaii,[[-164,18],[-154,24]]);puertoRicoInvert=d3_geo_albersUsaInvert(puertoRico,[[-67.5,17.5],[-65,19]]);return albersUsa};return albersUsa.scale(1000)};function d3_geo_albersUsaInvert(projection,extent){var a=projection(extent[0]),b=projection([0.5*(extent[0][0]+extent[1][0]),extent[0][1]]),c=projection([extent[1][0],extent[0][1]]),d=projection(extent[1]);var dya=b[1]-a[1],dxa=b[0]-a[0],dyb=c[1]-b[1],dxb=c[0]-b[0];var ma=dya/dxa,mb=dyb/dxb;var cx=0.5*(ma*mb*(a[1]-c[1])+mb*(a[0]+b[0])-ma*(b[0]+c[0]))/(mb-ma),cy=(0.5*(a[0]+b[0])-cx)/ma+0.5*(a[1]+b[1]);var dx0=d[0]-cx,dy0=d[1]-cy,dx1=a[0]-cx,dy1=a[1]-cy,r0=dx0*dx0+dy0*dy0,r1=dx1*dx1+dy1*dy1;var a0=Math.atan2(dy0,dx0),a1=Math.atan2(dy1,dx1);return function(coordinates){var dx=coordinates[0]-cx,dy=coordinates[1]-cy,r=dx*dx+dy*dy,a=Math.atan2(dy,dx);if(r0<r&&r<r1&&a0<a&&a<a1){return projection.invert(coordinates)}}}var d3_geo_pathAreaSum,d3_geo_pathAreaPolygon,d3_geo_pathArea={point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){d3_geo_pathAreaPolygon=0;d3_geo_pathArea.lineStart=d3_geo_pathAreaRingStart},polygonEnd:function(){d3_geo_pathArea.lineStart=d3_geo_pathArea.lineEnd=d3_geo_pathArea.point=d3_noop;d3_geo_pathAreaSum+=Math.abs(d3_geo_pathAreaPolygon/2)}};function d3_geo_pathAreaRingStart(){var x00,y00,x0,y0;d3_geo_pathArea.point=function(x,y){d3_geo_pathArea.point=nextPoint;x00=x0=x,y00=y0=y};function nextPoint(x,y){d3_geo_pathAreaPolygon+=y0*x-x0*y;x0=x,y0=y}d3_geo_pathArea.lineEnd=function(){nextPoint(x00,y00)}}function d3_geo_pathBuffer(){var pointCircle=d3_geo_pathCircle(4.5),buffer=[];var stream={point:point,lineStart:function(){stream.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){stream.lineEnd=lineEndPolygon},polygonEnd:function(){stream.lineEnd=lineEnd;stream.point=point},pointRadius:function(_){pointCircle=d3_geo_pathCircle(_);return stream},result:function(){if(buffer.length){var result=buffer.join("");buffer=[];return result}}};function point(x,y){buffer.push("M",x,",",y,pointCircle)}function pointLineStart(x,y){buffer.push("M",x,",",y);stream.point=pointLine}function pointLine(x,y){buffer.push("L",x,",",y)}function lineEnd(){stream.point=point}function lineEndPolygon(){buffer.push("Z")}return stream}var d3_geo_pathCentroid={point:d3_geo_pathCentroidPoint,lineStart:d3_geo_pathCentroidLineStart,lineEnd:d3_geo_pathCentroidLineEnd,polygonStart:function(){d3_geo_pathCentroid.lineStart=d3_geo_pathCentroidRingStart},polygonEnd:function(){d3_geo_pathCentroid.point=d3_geo_pathCentroidPoint;d3_geo_pathCentroid.lineStart=d3_geo_pathCentroidLineStart;d3_geo_pathCentroid.lineEnd=d3_geo_pathCentroidLineEnd}};function d3_geo_pathCentroidPoint(x,y){if(d3_geo_centroidDimension){return}d3_geo_centroidX+=x;d3_geo_centroidY+=y;++d3_geo_centroidZ}function d3_geo_pathCentroidLineStart(){var x0,y0;if(d3_geo_centroidDimension!==1){if(d3_geo_centroidDimension<1){d3_geo_centroidDimension=1;d3_geo_centroidX=d3_geo_centroidY=d3_geo_centroidZ=0}else{return}}d3_geo_pathCentroid.point=function(x,y){d3_geo_pathCentroid.point=nextPoint;x0=x,y0=y};function nextPoint(x,y){var dx=x-x0,dy=y-y0,z=Math.sqrt(dx*dx+dy*dy);d3_geo_centroidX+=z*(x0+x)/2;d3_geo_centroidY+=z*(y0+y)/2;d3_geo_centroidZ+=z;x0=x,y0=y}}function d3_geo_pathCentroidLineEnd(){d3_geo_pathCentroid.point=d3_geo_pathCentroidPoint}function d3_geo_pathCentroidRingStart(){var x00,y00,x0,y0;if(d3_geo_centroidDimension<2){d3_geo_centroidDimension=2;d3_geo_centroidX=d3_geo_centroidY=d3_geo_centroidZ=0}d3_geo_pathCentroid.point=function(x,y){d3_geo_pathCentroid.point=nextPoint;x00=x0=x,y00=y0=y};function nextPoint(x,y){var z=y0*x-x0*y;d3_geo_centroidX+=z*(x0+x);d3_geo_centroidY+=z*(y0+y);d3_geo_centroidZ+=z*3;x0=x,y0=y}d3_geo_pathCentroid.lineEnd=function(){nextPoint(x00,y00)}}function d3_geo_pathContext(context){var pointRadius=4.5;var stream={point:point,lineStart:function(){stream.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){stream.lineEnd=lineEndPolygon},polygonEnd:function(){stream.lineEnd=lineEnd;stream.point=point},pointRadius:function(_){pointRadius=_;return stream},result:d3_noop};function point(x,y){context.moveTo(x,y);context.arc(x,y,pointRadius,0,2*π)}function pointLineStart(x,y){context.moveTo(x,y);stream.point=pointLine}function pointLine(x,y){context.lineTo(x,y)}function lineEnd(){stream.point=point}function lineEndPolygon(){context.closePath()}return stream}d3.geo.path=function(){var pointRadius=4.5,projection,context,projectStream,contextStream;function path(object){if(object){d3.geo.stream(object,projectStream(contextStream.pointRadius(typeof pointRadius==="function"?+pointRadius.apply(this,arguments):pointRadius)))}return contextStream.result()}path.area=function(object){d3_geo_pathAreaSum=0;d3.geo.stream(object,projectStream(d3_geo_pathArea));return d3_geo_pathAreaSum};path.centroid=function(object){d3_geo_centroidDimension=d3_geo_centroidX=d3_geo_centroidY=d3_geo_centroidZ=0;d3.geo.stream(object,projectStream(d3_geo_pathCentroid));return d3_geo_centroidZ?[d3_geo_centroidX/d3_geo_centroidZ,d3_geo_centroidY/d3_geo_centroidZ]:undefined};path.bounds=function(object){return d3_geo_bounds(projectStream)(object)};path.projection=function(_){if(!arguments.length){return projection}projectStream=(projection=_)?_.stream||d3_geo_pathProjectStream(_):d3_identity;return path};path.context=function(_){if(!arguments.length){return context}contextStream=(context=_)==null?new d3_geo_pathBuffer():new d3_geo_pathContext(_);return path};path.pointRadius=function(_){if(!arguments.length){return pointRadius}pointRadius=typeof _==="function"?_:+_;return path};return path.projection(d3.geo.albersUsa()).context(null)};function d3_geo_pathCircle(radius){return"m0,"+radius+"a"+radius+","+radius+" 0 1,1 0,"+-2*radius+"a"+radius+","+radius+" 0 1,1 0,"+ +2*radius+"z"}function d3_geo_pathProjectStream(project){var resample=d3_geo_resample(function(λ,φ){return project([λ*d3_degrees,φ*d3_degrees])});return function(stream){stream=resample(stream);return{point:function(λ,φ){stream.point(λ*d3_radians,φ*d3_radians)},sphere:function(){stream.sphere()},lineStart:function(){stream.lineStart()},lineEnd:function(){stream.lineEnd()},polygonStart:function(){stream.polygonStart()},polygonEnd:function(){stream.polygonEnd()}}}}d3.geo.albers=function(){return d3.geo.conicEqualArea().parallels([29.5,45.5]).rotate([98,0]).center([0,38]).scale(1000)};function d3_geo_azimuthal(scale,angle){function azimuthal(λ,φ){var cosλ=Math.cos(λ),cosφ=Math.cos(φ),k=scale(cosλ*cosφ);return[k*cosφ*Math.sin(λ),k*Math.sin(φ)]}azimuthal.invert=function(x,y){var ρ=Math.sqrt(x*x+y*y),c=angle(ρ),sinc=Math.sin(c),cosc=Math.cos(c);return[Math.atan2(x*sinc,ρ*cosc),Math.asin(ρ&&y*sinc/ρ)]};return azimuthal}var d3_geo_azimuthalEqualArea=d3_geo_azimuthal(function(cosλcosφ){return Math.sqrt(2/(1+cosλcosφ))},function(ρ){return 2*Math.asin(ρ/2)});(d3.geo.azimuthalEqualArea=function(){return d3_geo_projection(d3_geo_azimuthalEqualArea)}).raw=d3_geo_azimuthalEqualArea;var d3_geo_azimuthalEquidistant=d3_geo_azimuthal(function(cosλcosφ){var c=Math.acos(cosλcosφ);return c&&c/Math.sin(c)},d3_identity);(d3.geo.azimuthalEquidistant=function(){return d3_geo_projection(d3_geo_azimuthalEquidistant)}).raw=d3_geo_azimuthalEquidistant;function d3_geo_conicConformal(φ0,φ1){var cosφ0=Math.cos(φ0),t=function(φ){return Math.tan(π/4+φ/2)},n=φ0===φ1?Math.sin(φ0):Math.log(cosφ0/Math.cos(φ1))/Math.log(t(φ1)/t(φ0)),F=cosφ0*Math.pow(t(φ0),n)/n;if(!n){return d3_geo_mercator}function forward(λ,φ){var ρ=Math.abs(Math.abs(φ)-π/2)<ε?0:F/Math.pow(t(φ),n);return[ρ*Math.sin(n*λ),F-ρ*Math.cos(n*λ)]}forward.invert=function(x,y){var ρ0_y=F-y,ρ=d3_sgn(n)*Math.sqrt(x*x+ρ0_y*ρ0_y);return[Math.atan2(x,ρ0_y)/n,2*Math.atan(Math.pow(F/ρ,1/n))-π/2]};return forward}(d3.geo.conicConformal=function(){return d3_geo_conic(d3_geo_conicConformal)}).raw=d3_geo_conicConformal;function d3_geo_conicEquidistant(φ0,φ1){var cosφ0=Math.cos(φ0),n=φ0===φ1?Math.sin(φ0):(cosφ0-Math.cos(φ1))/(φ1-φ0),G=cosφ0/n+φ0;if(Math.abs(n)<ε){return d3_geo_equirectangular}function forward(λ,φ){var ρ=G-φ;return[ρ*Math.sin(n*λ),G-ρ*Math.cos(n*λ)]}forward.invert=function(x,y){var ρ0_y=G-y;return[Math.atan2(x,ρ0_y)/n,G-d3_sgn(n)*Math.sqrt(x*x+ρ0_y*ρ0_y)]};return forward}(d3.geo.conicEquidistant=function(){return d3_geo_conic(d3_geo_conicEquidistant)}).raw=d3_geo_conicEquidistant;var d3_geo_gnomonic=d3_geo_azimuthal(function(cosλcosφ){return 1/cosλcosφ},Math.atan);(d3.geo.gnomonic=function(){return d3_geo_projection(d3_geo_gnomonic)}).raw=d3_geo_gnomonic;function d3_geo_mercator(λ,φ){return[λ,Math.log(Math.tan(π/4+φ/2))]}d3_geo_mercator.invert=function(x,y){return[x,2*Math.atan(Math.exp(y))-π/2]};function d3_geo_mercatorProjection(project){var m=d3_geo_projection(project),scale=m.scale,translate=m.translate,clipExtent=m.clipExtent,clipAuto;m.scale=function(){var v=scale.apply(m,arguments);return v===m?clipAuto?m.clipExtent(null):m:v};m.translate=function(){var v=translate.apply(m,arguments);return v===m?clipAuto?m.clipExtent(null):m:v};m.clipExtent=function(_){var v=clipExtent.apply(m,arguments);if(v===m){if(clipAuto=_==null){var k=π*scale(),t=translate();clipExtent([[t[0]-k,t[1]-k],[t[0]+k,t[1]+k]])}}else{if(clipAuto){v=null}}return v};return m.clipExtent(null)}(d3.geo.mercator=function(){return d3_geo_mercatorProjection(d3_geo_mercator)}).raw=d3_geo_mercator;var d3_geo_orthographic=d3_geo_azimuthal(function(){return 1},Math.asin);(d3.geo.orthographic=function(){return d3_geo_projection(d3_geo_orthographic)}).raw=d3_geo_orthographic;var d3_geo_stereographic=d3_geo_azimuthal(function(cosλcosφ){return 1/(1+cosλcosφ)},function(ρ){return 2*Math.atan(ρ)});(d3.geo.stereographic=function(){return d3_geo_projection(d3_geo_stereographic)}).raw=d3_geo_stereographic;function d3_geo_transverseMercator(λ,φ){var B=Math.cos(φ)*Math.sin(λ);return[Math.log((1+B)/(1-B))/2,Math.atan2(Math.tan(φ),Math.cos(λ))]}d3_geo_transverseMercator.invert=function(x,y){return[Math.atan2(d3_sinh(x),Math.cos(y)),d3_asin(Math.sin(y)/d3_cosh(x))]};(d3.geo.transverseMercator=function(){return d3_geo_mercatorProjection(d3_geo_transverseMercator)}).raw=d3_geo_transverseMercator;d3.geom={};d3.svg={};function d3_svg_line(projection){var x=d3_svg_lineX,y=d3_svg_lineY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,tension=0.7;function line(data){var segments=[],points=[],i=-1,n=data.length,d,fx=d3_functor(x),fy=d3_functor(y);function segment(){segments.push("M",interpolate(projection(points),tension))}while(++i<n){if(defined.call(this,d=data[i],i)){points.push([+fx.call(this,d,i),+fy.call(this,d,i)])}else{if(points.length){segment();points=[]}}}if(points.length){segment()}return segments.length?segments.join(""):null}line.x=function(_){if(!arguments.length){return x}x=_;return line};line.y=function(_){if(!arguments.length){return y}y=_;return line};line.defined=function(_){if(!arguments.length){return defined}defined=_;return line};line.interpolate=function(_){if(!arguments.length){return interpolateKey}if(typeof _==="function"){interpolateKey=interpolate=_}else{interpolateKey=(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key}return line};line.tension=function(_){if(!arguments.length){return tension}tension=_;return line};return line}d3.svg.line=function(){return d3_svg_line(d3_identity)};function d3_svg_lineX(d){return d[0]}function d3_svg_lineY(d){return d[1]}var d3_svg_lineInterpolators=d3.map({linear:d3_svg_lineLinear,"linear-closed":d3_svg_lineLinearClosed,"step-before":d3_svg_lineStepBefore,"step-after":d3_svg_lineStepAfter,basis:d3_svg_lineBasis,"basis-open":d3_svg_lineBasisOpen,"basis-closed":d3_svg_lineBasisClosed,bundle:d3_svg_lineBundle,cardinal:d3_svg_lineCardinal,"cardinal-open":d3_svg_lineCardinalOpen,"cardinal-closed":d3_svg_lineCardinalClosed,monotone:d3_svg_lineMonotone});d3_svg_lineInterpolators.forEach(function(key,value){value.key=key;value.closed=/-closed$/.test(key)});function d3_svg_lineLinear(points){return points.join("L")}function d3_svg_lineLinearClosed(points){return d3_svg_lineLinear(points)+"Z"}function d3_svg_lineStepBefore(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];while(++i<n){path.push("V",(p=points[i])[1],"H",p[0])}return path.join("")}function d3_svg_lineStepAfter(points){var i=0,n=points.length,p=points[0],path=[p[0],",",p[1]];while(++i<n){path.push("H",(p=points[i])[0],"V",p[1])}return path.join("")}function d3_svg_lineCardinalOpen(points,tension){return points.length<4?d3_svg_lineLinear(points):points[1]+d3_svg_lineHermite(points.slice(1,points.length-1),d3_svg_lineCardinalTangents(points,tension))}function d3_svg_lineCardinalClosed(points,tension){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite((points.push(points[0]),points),d3_svg_lineCardinalTangents([points[points.length-2]].concat(points,[points[1]]),tension))}function d3_svg_lineCardinal(points,tension){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineCardinalTangents(points,tension))}function d3_svg_lineHermite(points,tangents){if(tangents.length<1||points.length!=tangents.length&&points.length!=tangents.length+2){return d3_svg_lineLinear(points)}var quad=points.length!=tangents.length,path="",p0=points[0],p=points[1],t0=tangents[0],t=t0,pi=1;if(quad){path+="Q"+(p[0]-t0[0]*2/3)+","+(p[1]-t0[1]*2/3)+","+p[0]+","+p[1];p0=points[1];pi=2}if(tangents.length>1){t=tangents[1];p=points[pi];pi++;path+="C"+(p0[0]+t0[0])+","+(p0[1]+t0[1])+","+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1];for(var i=2;i<tangents.length;i++,pi++){p=points[pi];t=tangents[i];path+="S"+(p[0]-t[0])+","+(p[1]-t[1])+","+p[0]+","+p[1]}}if(quad){var lp=points[pi];path+="Q"+(p[0]+t[0]*2/3)+","+(p[1]+t[1]*2/3)+","+lp[0]+","+lp[1]}return path}function d3_svg_lineCardinalTangents(points,tension){var tangents=[],a=(1-tension)/2,p0,p1=points[0],p2=points[1],i=1,n=points.length;while(++i<n){p0=p1;p1=p2;p2=points[i];tangents.push([a*(p2[0]-p0[0]),a*(p2[1]-p0[1])])}return tangents}function d3_svg_lineBasis(points){if(points.length<3){return d3_svg_lineLinear(points)}var i=1,n=points.length,pi=points[0],x0=pi[0],y0=pi[1],px=[x0,x0,x0,(pi=points[1])[0]],py=[y0,y0,y0,pi[1]],path=[x0,",",y0];d3_svg_lineBasisBezier(path,px,py);while(++i<n){pi=points[i];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}i=-1;while(++i<2){px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}return path.join("")}function d3_svg_lineBasisOpen(points){if(points.length<4){return d3_svg_lineLinear(points)}var path=[],i=-1,n=points.length,pi,px=[0],py=[0];while(++i<3){pi=points[i];px.push(pi[0]);py.push(pi[1])}path.push(d3_svg_lineDot4(d3_svg_lineBasisBezier3,px)+","+d3_svg_lineDot4(d3_svg_lineBasisBezier3,py));--i;while(++i<n){pi=points[i];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}return path.join("")}function d3_svg_lineBasisClosed(points){var path,i=-1,n=points.length,m=n+4,pi,px=[],py=[];while(++i<4){pi=points[i%n];px.push(pi[0]);py.push(pi[1])}path=[d3_svg_lineDot4(d3_svg_lineBasisBezier3,px),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,py)];--i;while(++i<m){pi=points[i%n];px.shift();px.push(pi[0]);py.shift();py.push(pi[1]);d3_svg_lineBasisBezier(path,px,py)}return path.join("")}function d3_svg_lineBundle(points,tension){var n=points.length-1;if(n){var x0=points[0][0],y0=points[0][1],dx=points[n][0]-x0,dy=points[n][1]-y0,i=-1,p,t;while(++i<=n){p=points[i];t=i/n;p[0]=tension*p[0]+(1-tension)*(x0+t*dx);p[1]=tension*p[1]+(1-tension)*(y0+t*dy)}}return d3_svg_lineBasis(points)}function d3_svg_lineDot4(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]}var d3_svg_lineBasisBezier1=[0,2/3,1/3,0],d3_svg_lineBasisBezier2=[0,1/3,2/3,0],d3_svg_lineBasisBezier3=[0,1/6,2/3,1/6];function d3_svg_lineBasisBezier(path,x,y){path.push("C",d3_svg_lineDot4(d3_svg_lineBasisBezier1,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier1,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier2,y),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,x),",",d3_svg_lineDot4(d3_svg_lineBasisBezier3,y))}function d3_svg_lineSlope(p0,p1){return(p1[1]-p0[1])/(p1[0]-p0[0])}function d3_svg_lineFiniteDifferences(points){var i=0,j=points.length-1,m=[],p0=points[0],p1=points[1],d=m[0]=d3_svg_lineSlope(p0,p1);while(++i<j){m[i]=(d+(d=d3_svg_lineSlope(p0=p1,p1=points[i+1])))/2}m[i]=d;return m}function d3_svg_lineMonotoneTangents(points){var tangents=[],d,a,b,s,m=d3_svg_lineFiniteDifferences(points),i=-1,j=points.length-1;while(++i<j){d=d3_svg_lineSlope(points[i],points[i+1]);if(Math.abs(d)<0.000001){m[i]=m[i+1]=0}else{a=m[i]/d;b=m[i+1]/d;s=a*a+b*b;if(s>9){s=d*3/Math.sqrt(s);m[i]=s*a;m[i+1]=s*b}}}i=-1;while(++i<=j){s=(points[Math.min(j,i+1)][0]-points[Math.max(0,i-1)][0])/(6*(1+m[i]*m[i]));tangents.push([s||0,m[i]*s||0])}return tangents}function d3_svg_lineMonotone(points){return points.length<3?d3_svg_lineLinear(points):points[0]+d3_svg_lineHermite(points,d3_svg_lineMonotoneTangents(points))}d3.geom.hull=function(vertices){var x=d3_svg_lineX,y=d3_svg_lineY;if(arguments.length){return hull(vertices)}function hull(data){if(data.length<3){return[]}var fx=d3_functor(x),fy=d3_functor(y),n=data.length,vertices,plen=n-1,points=[],stack=[],d,i,j,h=0,x1,y1,x2,y2,u,v,a,sp;if(fx===d3_svg_lineX&&y===d3_svg_lineY){vertices=data}else{for(i=0,vertices=[];i<n;++i){vertices.push([+fx.call(this,d=data[i],i),+fy.call(this,d,i)])}}for(i=1;i<n;++i){if(vertices[i][1]<vertices[h][1]){h=i}else{if(vertices[i][1]==vertices[h][1]){h=vertices[i][0]<vertices[h][0]?i:h}}}for(i=0;i<n;++i){if(i===h){continue}y1=vertices[i][1]-vertices[h][1];x1=vertices[i][0]-vertices[h][0];points.push({angle:Math.atan2(y1,x1),index:i})}points.sort(function(a,b){return a.angle-b.angle});a=points[0].angle;v=points[0].index;u=0;for(i=1;i<plen;++i){j=points[i].index;if(a==points[i].angle){x1=vertices[v][0]-vertices[h][0];y1=vertices[v][1]-vertices[h][1];x2=vertices[j][0]-vertices[h][0];y2=vertices[j][1]-vertices[h][1];if(x1*x1+y1*y1>=x2*x2+y2*y2){points[i].index=-1}else{points[u].index=-1;a=points[i].angle;u=i;v=j}}else{a=points[i].angle;u=i;v=j}}stack.push(h);for(i=0,j=0;i<2;++j){if(points[j].index!==-1){stack.push(points[j].index);i++}}sp=stack.length;for(;j<plen;++j){if(points[j].index===-1){continue}while(!d3_geom_hullCCW(stack[sp-2],stack[sp-1],points[j].index,vertices)){--sp}stack[sp++]=points[j].index}var poly=[];for(i=0;i<sp;++i){poly.push(data[stack[i]])}return poly}hull.x=function(_){return arguments.length?(x=_,hull):x};hull.y=function(_){return arguments.length?(y=_,hull):y};return hull};function d3_geom_hullCCW(i1,i2,i3,v){var t,a,b,c,d,e,f;t=v[i1];a=t[0];b=t[1];t=v[i2];c=t[0];d=t[1];t=v[i3];e=t[0];f=t[1];return(f-b)*(c-a)-(d-b)*(e-a)>0}d3.geom.polygon=function(coordinates){coordinates.area=function(){var i=0,n=coordinates.length,area=coordinates[n-1][1]*coordinates[0][0]-coordinates[n-1][0]*coordinates[0][1];while(++i<n){area+=coordinates[i-1][1]*coordinates[i][0]-coordinates[i-1][0]*coordinates[i][1]}return area*0.5};coordinates.centroid=function(k){var i=-1,n=coordinates.length,x=0,y=0,a,b=coordinates[n-1],c;if(!arguments.length){k=-1/(6*coordinates.area())}while(++i<n){a=b;b=coordinates[i];c=a[0]*b[1]-b[0]*a[1];x+=(a[0]+b[0])*c;y+=(a[1]+b[1])*c}return[x*k,y*k]};coordinates.clip=function(subject){var input,i=-1,n=coordinates.length,j,m,a=coordinates[n-1],b,c,d;while(++i<n){input=subject.slice();subject.length=0;b=coordinates[i];c=input[(m=input.length)-1];j=-1;while(++j<m){d=input[j];if(d3_geom_polygonInside(d,a,b)){if(!d3_geom_polygonInside(c,a,b)){subject.push(d3_geom_polygonIntersect(c,d,a,b))}subject.push(d)}else{if(d3_geom_polygonInside(c,a,b)){subject.push(d3_geom_polygonIntersect(c,d,a,b))}}c=d}a=b}return subject};return coordinates};function d3_geom_polygonInside(p,a,b){return(b[0]-a[0])*(p[1]-a[1])<(b[1]-a[1])*(p[0]-a[0])}function d3_geom_polygonIntersect(c,d,a,b){var x1=c[0],x3=a[0],x21=d[0]-x1,x43=b[0]-x3,y1=c[1],y3=a[1],y21=d[1]-y1,y43=b[1]-y3,ua=(x43*(y1-y3)-y43*(x1-x3))/(y43*x21-x43*y21);return[x1+ua*x21,y1+ua*y21]}d3.geom.delaunay=function(vertices){var edges=vertices.map(function(){return[]}),triangles=[];d3_geom_voronoiTessellate(vertices,function(e){edges[e.region.l.index].push(vertices[e.region.r.index])});edges.forEach(function(edge,i){var v=vertices[i],cx=v[0],cy=v[1];edge.forEach(function(v){v.angle=Math.atan2(v[0]-cx,v[1]-cy)});edge.sort(function(a,b){return a.angle-b.angle});for(var j=0,m=edge.length-1;j<m;j++){triangles.push([v,edge[j],edge[j+1]])}});return triangles};d3.geom.voronoi=function(points){var size=null,x=d3_svg_lineX,y=d3_svg_lineY,clip;if(arguments.length){return voronoi(points)}function voronoi(data){var points,polygons=data.map(function(){return[]}),fx=d3_functor(x),fy=d3_functor(y),d,i,n=data.length,Z=1000000;if(fx===d3_svg_lineX&&fy===d3_svg_lineY){points=data}else{for(points=[],i=0;i<n;++i){points.push([+fx.call(this,d=data[i],i),+fy.call(this,d,i)])}}d3_geom_voronoiTessellate(points,function(e){var s1,s2,x1,x2,y1,y2;if(e.a===1&&e.b>=0){s1=e.ep.r;s2=e.ep.l}else{s1=e.ep.l;s2=e.ep.r}if(e.a===1){y1=s1?s1.y:-Z;x1=e.c-e.b*y1;y2=s2?s2.y:Z;x2=e.c-e.b*y2}else{x1=s1?s1.x:-Z;y1=e.c-e.a*x1;x2=s2?s2.x:Z;y2=e.c-e.a*x2}var v1=[x1,y1],v2=[x2,y2];polygons[e.region.l.index].push(v1,v2);polygons[e.region.r.index].push(v1,v2)});polygons=polygons.map(function(polygon,i){var cx=points[i][0],cy=points[i][1],angle=polygon.map(function(v){return Math.atan2(v[0]-cx,v[1]-cy)}),order=d3.range(polygon.length).sort(function(a,b){return angle[a]-angle[b]});return order.filter(function(d,i){return !i||angle[d]-angle[order[i-1]]>ε}).map(function(d){return polygon[d]})});polygons.forEach(function(polygon,i){var n=polygon.length;if(!n){return polygon.push([-Z,-Z],[-Z,Z],[Z,Z],[Z,-Z])}if(n>2){return}var p0=points[i],p1=polygon[0],p2=polygon[1],x0=p0[0],y0=p0[1],x1=p1[0],y1=p1[1],x2=p2[0],y2=p2[1],dx=Math.abs(x2-x1),dy=y2-y1;if(Math.abs(dy)<ε){var y=y0<y1?-Z:Z;polygon.push([-Z,y],[Z,y])}else{if(dx<ε){var x=x0<x1?-Z:Z;polygon.push([x,-Z],[x,Z])}else{var y=(x2-x1)*(y1-y0)<(x1-x0)*(y2-y1)?Z:-Z,z=Math.abs(dy)-dx;if(Math.abs(z)<ε){polygon.push([dy<0?y:-y,y])}else{if(z>0){y*=-1}polygon.push([-Z,y],[Z,y])}}}});if(clip){for(i=0;i<n;++i){clip(polygons[i])}}for(i=0;i<n;++i){polygons[i].point=data[i]}return polygons}voronoi.x=function(_){return arguments.length?(x=_,voronoi):x};voronoi.y=function(_){return arguments.length?(y=_,voronoi):y};voronoi.size=function(_){if(!arguments.length){return size}if(_==null){clip=null}else{size=[+_[0],+_[1]];clip=d3.geom.polygon([[0,0],[0,size[1]],size,[size[0],0]]).clip}return voronoi};voronoi.links=function(data){var points,graph=data.map(function(){return[]}),links=[],fx=d3_functor(x),fy=d3_functor(y),d,i,n=data.length;if(fx===d3_svg_lineX&&fy===d3_svg_lineY){points=data}else{for(i=0;i<n;++i){points.push([+fx.call(this,d=data[i],i),+fy.call(this,d,i)])}}d3_geom_voronoiTessellate(points,function(e){var l=e.region.l.index,r=e.region.r.index;if(graph[l][r]){return}graph[l][r]=graph[r][l]=true;links.push({source:data[l],target:data[r]})});return links};voronoi.triangles=function(data){if(x===d3_svg_lineX&&y===d3_svg_lineY){return d3.geom.delaunay(data)}var points,point,fx=d3_functor(x),fy=d3_functor(y),d,i,n;for(i=0,points=[],n=data.length;i<n;++i){point=[+fx.call(this,d=data[i],i),+fy.call(this,d,i)];point.data=d;points.push(point)}return d3.geom.delaunay(points).map(function(triangle){return triangle.map(function(point){return point.data})})};return voronoi};var d3_geom_voronoiOpposite={l:"r",r:"l"};function d3_geom_voronoiTessellate(points,callback){var Sites={list:points.map(function(v,i){return{index:i,x:v[0],y:v[1]}}).sort(function(a,b){return a.y<b.y?-1:a.y>b.y?1:a.x<b.x?-1:a.x>b.x?1:0}),bottomSite:null};var EdgeList={list:[],leftEnd:null,rightEnd:null,init:function(){EdgeList.leftEnd=EdgeList.createHalfEdge(null,"l");EdgeList.rightEnd=EdgeList.createHalfEdge(null,"l");EdgeList.leftEnd.r=EdgeList.rightEnd;EdgeList.rightEnd.l=EdgeList.leftEnd;EdgeList.list.unshift(EdgeList.leftEnd,EdgeList.rightEnd)},createHalfEdge:function(edge,side){return{edge:edge,side:side,vertex:null,l:null,r:null}},insert:function(lb,he){he.l=lb;he.r=lb.r;lb.r.l=he;lb.r=he},leftBound:function(p){var he=EdgeList.leftEnd;do{he=he.r}while(he!=EdgeList.rightEnd&&Geom.rightOf(he,p));he=he.l;return he},del:function(he){he.l.r=he.r;he.r.l=he.l;he.edge=null},right:function(he){return he.r},left:function(he){return he.l},leftRegion:function(he){return he.edge==null?Sites.bottomSite:he.edge.region[he.side]},rightRegion:function(he){return he.edge==null?Sites.bottomSite:he.edge.region[d3_geom_voronoiOpposite[he.side]]}};var Geom={bisect:function(s1,s2){var newEdge={region:{l:s1,r:s2},ep:{l:null,r:null}};var dx=s2.x-s1.x,dy=s2.y-s1.y,adx=dx>0?dx:-dx,ady=dy>0?dy:-dy;newEdge.c=s1.x*dx+s1.y*dy+(dx*dx+dy*dy)*0.5;if(adx>ady){newEdge.a=1;newEdge.b=dy/dx;newEdge.c/=dx}else{newEdge.b=1;newEdge.a=dx/dy;newEdge.c/=dy}return newEdge},intersect:function(el1,el2){var e1=el1.edge,e2=el2.edge;if(!e1||!e2||e1.region.r==e2.region.r){return null}var d=e1.a*e2.b-e1.b*e2.a;if(Math.abs(d)<1e-10){return null}var xint=(e1.c*e2.b-e2.c*e1.b)/d,yint=(e2.c*e1.a-e1.c*e2.a)/d,e1r=e1.region.r,e2r=e2.region.r,el,e;if(e1r.y<e2r.y||e1r.y==e2r.y&&e1r.x<e2r.x){el=el1;e=e1}else{el=el2;e=e2}var rightOfSite=xint>=e.region.r.x;if(rightOfSite&&el.side==="l"||!rightOfSite&&el.side==="r"){return null}return{x:xint,y:yint}},rightOf:function(he,p){var e=he.edge,topsite=e.region.r,rightOfSite=p.x>topsite.x;if(rightOfSite&&he.side==="l"){return 1}if(!rightOfSite&&he.side==="r"){return 0}if(e.a===1){var dyp=p.y-topsite.y,dxp=p.x-topsite.x,fast=0,above=0;if(!rightOfSite&&e.b<0||rightOfSite&&e.b>=0){above=fast=dyp>=e.b*dxp}else{above=p.x+p.y*e.b>e.c;if(e.b<0){above=!above}if(!above){fast=1}}if(!fast){var dxs=topsite.x-e.region.l.x;above=e.b*(dxp*dxp-dyp*dyp)<dxs*dyp*(1+2*dxp/dxs+e.b*e.b);if(e.b<0){above=!above}}}else{var yl=e.c-e.a*p.x,t1=p.y-yl,t2=p.x-topsite.x,t3=yl-topsite.y;above=t1*t1>t2*t2+t3*t3}return he.side==="l"?above:!above},endPoint:function(edge,side,site){edge.ep[side]=site;if(!edge.ep[d3_geom_voronoiOpposite[side]]){return}callback(edge)},distance:function(s,t){var dx=s.x-t.x,dy=s.y-t.y;return Math.sqrt(dx*dx+dy*dy)}};var EventQueue={list:[],insert:function(he,site,offset){he.vertex=site;he.ystar=site.y+offset;for(var i=0,list=EventQueue.list,l=list.length;i<l;i++){var next=list[i];if(he.ystar>next.ystar||he.ystar==next.ystar&&site.x>next.vertex.x){continue}else{break}}list.splice(i,0,he)},del:function(he){for(var i=0,ls=EventQueue.list,l=ls.length;i<l&&ls[i]!=he;++i){}ls.splice(i,1)},empty:function(){return EventQueue.list.length===0},nextEvent:function(he){for(var i=0,ls=EventQueue.list,l=ls.length;i<l;++i){if(ls[i]==he){return ls[i+1]}}return null},min:function(){var elem=EventQueue.list[0];return{x:elem.vertex.x,y:elem.ystar}},extractMin:function(){return EventQueue.list.shift()}};EdgeList.init();Sites.bottomSite=Sites.list.shift();var newSite=Sites.list.shift(),newIntStar;var lbnd,rbnd,llbnd,rrbnd,bisector;var bot,top,temp,p,v;var e,pm;while(true){if(!EventQueue.empty()){newIntStar=EventQueue.min()}if(newSite&&(EventQueue.empty()||newSite.y<newIntStar.y||newSite.y==newIntStar.y&&newSite.x<newIntStar.x)){lbnd=EdgeList.leftBound(newSite);rbnd=EdgeList.right(lbnd);bot=EdgeList.rightRegion(lbnd);e=Geom.bisect(bot,newSite);bisector=EdgeList.createHalfEdge(e,"l");EdgeList.insert(lbnd,bisector);p=Geom.intersect(lbnd,bisector);if(p){EventQueue.del(lbnd);EventQueue.insert(lbnd,p,Geom.distance(p,newSite))}lbnd=bisector;bisector=EdgeList.createHalfEdge(e,"r");EdgeList.insert(lbnd,bisector);p=Geom.intersect(bisector,rbnd);if(p){EventQueue.insert(bisector,p,Geom.distance(p,newSite))}newSite=Sites.list.shift()}else{if(!EventQueue.empty()){lbnd=EventQueue.extractMin();llbnd=EdgeList.left(lbnd);rbnd=EdgeList.right(lbnd);rrbnd=EdgeList.right(rbnd);bot=EdgeList.leftRegion(lbnd);top=EdgeList.rightRegion(rbnd);v=lbnd.vertex;Geom.endPoint(lbnd.edge,lbnd.side,v);Geom.endPoint(rbnd.edge,rbnd.side,v);EdgeList.del(lbnd);EventQueue.del(rbnd);EdgeList.del(rbnd);pm="l";if(bot.y>top.y){temp=bot;bot=top;top=temp;pm="r"}e=Geom.bisect(bot,top);bisector=EdgeList.createHalfEdge(e,pm);EdgeList.insert(llbnd,bisector);Geom.endPoint(e,d3_geom_voronoiOpposite[pm],v);p=Geom.intersect(llbnd,bisector);if(p){EventQueue.del(llbnd);EventQueue.insert(llbnd,p,Geom.distance(p,bot))}p=Geom.intersect(bisector,rrbnd);if(p){EventQueue.insert(bisector,p,Geom.distance(p,bot))}}else{break}}}for(lbnd=EdgeList.right(EdgeList.leftEnd);lbnd!=EdgeList.rightEnd;lbnd=EdgeList.right(lbnd)){callback(lbnd.edge)}}d3.geom.quadtree=function(points,x1,y1,x2,y2){var x=d3_svg_lineX,y=d3_svg_lineY,compat;if(compat=arguments.length){x=d3_geom_quadtreeCompatX;y=d3_geom_quadtreeCompatY;if(compat===3){y2=y1;x2=x1;y1=x1=0}return quadtree(points)}function quadtree(data){var d,fx=d3_functor(x),fy=d3_functor(y),xs,ys,i,n,x1_,y1_,x2_,y2_;if(x1!=null){x1_=x1,y1_=y1,x2_=x2,y2_=y2}else{x2_=y2_=-(x1_=y1_=Infinity);xs=[],ys=[];n=data.length;if(compat){for(i=0;i<n;++i){d=data[i];if(d.x<x1_){x1_=d.x}if(d.y<y1_){y1_=d.y}if(d.x>x2_){x2_=d.x}if(d.y>y2_){y2_=d.y}xs.push(d.x);ys.push(d.y)}}else{for(i=0;i<n;++i){var x_=+fx(d=data[i],i),y_=+fy(d,i);if(x_<x1_){x1_=x_}if(y_<y1_){y1_=y_}if(x_>x2_){x2_=x_}if(y_>y2_){y2_=y_}xs.push(x_);ys.push(y_)}}}var dx=x2_-x1_,dy=y2_-y1_;if(dx>dy){y2_=y1_+dx}else{x2_=x1_+dy}function insert(n,d,x,y,x1,y1,x2,y2){if(isNaN(x)||isNaN(y)){return}if(n.leaf){var nx=n.x,ny=n.y;if(nx!=null){if(Math.abs(nx-x)+Math.abs(ny-y)<0.01){insertChild(n,d,x,y,x1,y1,x2,y2)}else{var nPoint=n.point;n.x=n.y=n.point=null;insertChild(n,nPoint,nx,ny,x1,y1,x2,y2);insertChild(n,d,x,y,x1,y1,x2,y2)}}else{n.x=x,n.y=y,n.point=d}}else{insertChild(n,d,x,y,x1,y1,x2,y2)}}function insertChild(n,d,x,y,x1,y1,x2,y2){var sx=(x1+x2)*0.5,sy=(y1+y2)*0.5,right=x>=sx,bottom=y>=sy,i=(bottom<<1)+right;n.leaf=false;n=n.nodes[i]||(n.nodes[i]=d3_geom_quadtreeNode());if(right){x1=sx}else{x2=sx}if(bottom){y1=sy}else{y2=sy}insert(n,d,x,y,x1,y1,x2,y2)}var root=d3_geom_quadtreeNode();root.add=function(d){insert(root,d,+fx(d,++i),+fy(d,i),x1_,y1_,x2_,y2_)};root.visit=function(f){d3_geom_quadtreeVisit(f,root,x1_,y1_,x2_,y2_)};i=-1;if(x1==null){while(++i<n){insert(root,data[i],xs[i],ys[i],x1_,y1_,x2_,y2_)}--i}else{data.forEach(root.add)}xs=ys=data=d=null;return root}quadtree.x=function(_){return arguments.length?(x=_,quadtree):x};quadtree.y=function(_){return arguments.length?(y=_,quadtree):y};quadtree.size=function(_){if(!arguments.length){return x1==null?null:[x2,y2]}if(_==null){x1=y1=x2=y2=null}else{x1=y1=0;x2=+_[0],y2=+_[1]}return quadtree};return quadtree};function d3_geom_quadtreeCompatX(d){return d.x}function d3_geom_quadtreeCompatY(d){return d.y}function d3_geom_quadtreeNode(){return{leaf:true,nodes:[],point:null,x:null,y:null}}function d3_geom_quadtreeVisit(f,node,x1,y1,x2,y2){if(!f(node,x1,y1,x2,y2)){var sx=(x1+x2)*0.5,sy=(y1+y2)*0.5,children=node.nodes;if(children[0]){d3_geom_quadtreeVisit(f,children[0],x1,y1,sx,sy)}if(children[1]){d3_geom_quadtreeVisit(f,children[1],sx,y1,x2,sy)}if(children[2]){d3_geom_quadtreeVisit(f,children[2],x1,sy,sx,y2)}if(children[3]){d3_geom_quadtreeVisit(f,children[3],sx,sy,x2,y2)}}}d3.interpolateRgb=d3_interpolateRgb;function d3_interpolateRgb(a,b){a=d3.rgb(a);b=d3.rgb(b);var ar=a.r,ag=a.g,ab=a.b,br=b.r-ar,bg=b.g-ag,bb=b.b-ab;return function(t){return"#"+d3_rgb_hex(Math.round(ar+br*t))+d3_rgb_hex(Math.round(ag+bg*t))+d3_rgb_hex(Math.round(ab+bb*t))}}d3.transform=function(string){var g=d3_document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(string){g.setAttribute("transform",string);var t=g.transform.baseVal.consolidate();return new d3_transform(t?t.matrix:d3_transformIdentity)})(string)};function d3_transform(m){var r0=[m.a,m.b],r1=[m.c,m.d],kx=d3_transformNormalize(r0),kz=d3_transformDot(r0,r1),ky=d3_transformNormalize(d3_transformCombine(r1,r0,-kz))||0;if(r0[0]*r1[1]<r1[0]*r0[1]){r0[0]*=-1;r0[1]*=-1;kx*=-1;kz*=-1}this.rotate=(kx?Math.atan2(r0[1],r0[0]):Math.atan2(-r1[0],r1[1]))*d3_degrees;this.translate=[m.e,m.f];this.scale=[kx,ky];this.skew=ky?Math.atan2(kz,ky)*d3_degrees:0}d3_transform.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function d3_transformDot(a,b){return a[0]*b[0]+a[1]*b[1]}function d3_transformNormalize(a){var k=Math.sqrt(d3_transformDot(a,a));if(k){a[0]/=k;a[1]/=k}return k}function d3_transformCombine(a,b,k){a[0]+=k*b[0];a[1]+=k*b[1];return a}var d3_transformIdentity={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolateNumber=d3_interpolateNumber;function d3_interpolateNumber(a,b){b-=a=+a;return function(t){return a+b*t}}d3.interpolateTransform=d3_interpolateTransform;function d3_interpolateTransform(a,b){var s=[],q=[],n,A=d3.transform(a),B=d3.transform(b),ta=A.translate,tb=B.translate,ra=A.rotate,rb=B.rotate,wa=A.skew,wb=B.skew,ka=A.scale,kb=B.scale;if(ta[0]!=tb[0]||ta[1]!=tb[1]){s.push("translate(",null,",",null,")");q.push({i:1,x:d3_interpolateNumber(ta[0],tb[0])},{i:3,x:d3_interpolateNumber(ta[1],tb[1])})}else{if(tb[0]||tb[1]){s.push("translate("+tb+")")}else{s.push("")}}if(ra!=rb){if(ra-rb>180){rb+=360}else{if(rb-ra>180){ra+=360}}q.push({i:s.push(s.pop()+"rotate(",null,")")-2,x:d3_interpolateNumber(ra,rb)})}else{if(rb){s.push(s.pop()+"rotate("+rb+")")}}if(wa!=wb){q.push({i:s.push(s.pop()+"skewX(",null,")")-2,x:d3_interpolateNumber(wa,wb)})}else{if(wb){s.push(s.pop()+"skewX("+wb+")")}}if(ka[0]!=kb[0]||ka[1]!=kb[1]){n=s.push(s.pop()+"scale(",null,",",null,")");q.push({i:n-4,x:d3_interpolateNumber(ka[0],kb[0])},{i:n-2,x:d3_interpolateNumber(ka[1],kb[1])})}else{if(kb[0]!=1||kb[1]!=1){s.push(s.pop()+"scale("+kb+")")}}n=q.length;return function(t){var i=-1,o;while(++i<n){s[(o=q[i]).i]=o.x(t)}return s.join("")}}d3.interpolateObject=d3_interpolateObject;function d3_interpolateObject(a,b){var i={},c={},k;for(k in a){if(k in b){i[k]=d3_interpolateByName(k)(a[k],b[k])}else{c[k]=a[k]}}for(k in b){if(!(k in a)){c[k]=b[k]}}return function(t){for(k in i){c[k]=i[k](t)}return c}}d3.interpolateString=d3_interpolateString;function d3_interpolateString(a,b){var m,i,j,s0=0,s1=0,s=[],q=[],n,o;a=a+"",b=b+"";d3_interpolate_number.lastIndex=0;for(i=0;m=d3_interpolate_number.exec(b);++i){if(m.index){s.push(b.substring(s0,s1=m.index))}q.push({i:s.length,x:m[0]});s.push(null);s0=d3_interpolate_number.lastIndex}if(s0<b.length){s.push(b.substring(s0))}for(i=0,n=q.length;(m=d3_interpolate_number.exec(a))&&i<n;++i){o=q[i];if(o.x==m[0]){if(o.i){if(s[o.i+1]==null){s[o.i-1]+=o.x;s.splice(o.i,1);for(j=i+1;j<n;++j){q[j].i--}}else{s[o.i-1]+=o.x+s[o.i+1];s.splice(o.i,2);for(j=i+1;j<n;++j){q[j].i-=2}}}else{if(s[o.i+1]==null){s[o.i]=o.x}else{s[o.i]=o.x+s[o.i+1];s.splice(o.i+1,1);for(j=i+1;j<n;++j){q[j].i--}}}q.splice(i,1);n--;i--}else{o.x=d3_interpolateNumber(parseFloat(m[0]),parseFloat(o.x))}}while(i<n){o=q.pop();if(s[o.i+1]==null){s[o.i]=o.x}else{s[o.i]=o.x+s[o.i+1];s.splice(o.i+1,1)}n--}if(s.length===1){return s[0]==null?q[0].x:function(){return b}}return function(t){for(i=0;i<n;++i){s[(o=q[i]).i]=o.x(t)}return s.join("")}}var d3_interpolate_number=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolate=d3_interpolate;function d3_interpolate(a,b){var i=d3.interpolators.length,f;while(--i>=0&&!(f=d3.interpolators[i](a,b))){}return f}function d3_interpolateByName(name){return name=="transform"?d3_interpolateTransform:d3_interpolate}d3.interpolators=[function(a,b){var t=typeof b;return(t==="string"||t!==typeof a?d3_rgb_names.has(b)||/^(#|rgb\(|hsl\()/.test(b)?d3_interpolateRgb:d3_interpolateString:b instanceof d3_Color?d3_interpolateRgb:t==="object"?Array.isArray(b)?d3_interpolateArray:d3_interpolateObject:d3_interpolateNumber)(a,b)}];d3.interpolateArray=d3_interpolateArray;function d3_interpolateArray(a,b){var x=[],c=[],na=a.length,nb=b.length,n0=Math.min(a.length,b.length),i;for(i=0;i<n0;++i){x.push(d3_interpolate(a[i],b[i]))}for(;i<na;++i){c[i]=a[i]}for(;i<nb;++i){c[i]=b[i]}return function(t){for(i=0;i<n0;++i){c[i]=x[i](t)}return c}}var d3_ease_default=function(){return d3_identity};var d3_ease=d3.map({linear:d3_ease_default,poly:d3_ease_poly,quad:function(){return d3_ease_quad},cubic:function(){return d3_ease_cubic},sin:function(){return d3_ease_sin},exp:function(){return d3_ease_exp},circle:function(){return d3_ease_circle},elastic:d3_ease_elastic,back:d3_ease_back,bounce:function(){return d3_ease_bounce}});var d3_ease_mode=d3.map({"in":d3_identity,out:d3_ease_reverse,"in-out":d3_ease_reflect,"out-in":function(f){return d3_ease_reflect(d3_ease_reverse(f))}});d3.ease=function(name){var i=name.indexOf("-"),t=i>=0?name.substring(0,i):name,m=i>=0?name.substring(i+1):"in";t=d3_ease.get(t)||d3_ease_default;m=d3_ease_mode.get(m)||d3_identity;return d3_ease_clamp(m(t.apply(null,Array.prototype.slice.call(arguments,1))))};function d3_ease_clamp(f){return function(t){return t<=0?0:t>=1?1:f(t)}}function d3_ease_reverse(f){return function(t){return 1-f(1-t)}}function d3_ease_reflect(f){return function(t){return 0.5*(t<0.5?f(2*t):2-f(2-2*t))}}function d3_ease_quad(t){return t*t}function d3_ease_cubic(t){return t*t*t}function d3_ease_cubicInOut(t){if(t<=0){return 0}if(t>=1){return 1}var t2=t*t,t3=t2*t;return 4*(t<0.5?t3:3*(t-t2)+t3-0.75)}function d3_ease_poly(e){return function(t){return Math.pow(t,e)}}function d3_ease_sin(t){return 1-Math.cos(t*π/2)}function d3_ease_exp(t){return Math.pow(2,10*(t-1))}function d3_ease_circle(t){return 1-Math.sqrt(1-t*t)}function d3_ease_elastic(a,p){var s;if(arguments.length<2){p=0.45}if(arguments.length){s=p/(2*π)*Math.asin(1/a)}else{a=1,s=p/4}return function(t){return 1+a*Math.pow(2,10*-t)*Math.sin((t-s)*2*π/p)}}function d3_ease_back(s){if(!s){s=1.70158}return function(t){return t*t*((s+1)*t-s)}}function d3_ease_bounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+0.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+0.9375:7.5625*(t-=2.625/2.75)*t+0.984375}d3.interpolateHcl=d3_interpolateHcl;function d3_interpolateHcl(a,b){a=d3.hcl(a);b=d3.hcl(b);var ah=a.h,ac=a.c,al=a.l,bh=b.h-ah,bc=b.c-ac,bl=b.l-al;if(bh>180){bh-=360}else{if(bh<-180){bh+=360}}return function(t){return d3_hcl_lab(ah+bh*t,ac+bc*t,al+bl*t)+""}}d3.interpolateHsl=d3_interpolateHsl;function d3_interpolateHsl(a,b){a=d3.hsl(a);b=d3.hsl(b);var h0=a.h,s0=a.s,l0=a.l,h1=b.h-h0,s1=b.s-s0,l1=b.l-l0;if(h1>180){h1-=360}else{if(h1<-180){h1+=360}}return function(t){return d3_hsl_rgb(h0+h1*t,s0+s1*t,l0+l1*t)+""}}d3.interpolateLab=d3_interpolateLab;function d3_interpolateLab(a,b){a=d3.lab(a);b=d3.lab(b);var al=a.l,aa=a.a,ab=a.b,bl=b.l-al,ba=b.a-aa,bb=b.b-ab;return function(t){return d3_lab_rgb(al+bl*t,aa+ba*t,ab+bb*t)+""}}d3.interpolateRound=d3_interpolateRound;function d3_interpolateRound(a,b){b-=a;return function(t){return Math.round(a+b*t)}}function d3_uninterpolateNumber(a,b){b=b-(a=+a)?1/(b-a):0;return function(x){return(x-a)*b}}function d3_uninterpolateClamp(a,b){b=b-(a=+a)?1/(b-a):0;return function(x){return Math.max(0,Math.min(1,(x-a)*b))}}d3.layout={};d3.layout.bundle=function(){return function(links){var paths=[],i=-1,n=links.length;while(++i<n){paths.push(d3_layout_bundlePath(links[i]))}return paths}};function d3_layout_bundlePath(link){var start=link.source,end=link.target,lca=d3_layout_bundleLeastCommonAncestor(start,end),points=[start];while(start!==lca){start=start.parent;points.push(start)}var k=points.length;while(end!==lca){points.splice(k,0,end);end=end.parent}return points}function d3_layout_bundleAncestors(node){var ancestors=[],parent=node.parent;while(parent!=null){ancestors.push(node);node=parent;parent=parent.parent}ancestors.push(node);return ancestors}function d3_layout_bundleLeastCommonAncestor(a,b){if(a===b){return a}var aNodes=d3_layout_bundleAncestors(a),bNodes=d3_layout_bundleAncestors(b),aNode=aNodes.pop(),bNode=bNodes.pop(),sharedNode=null;while(aNode===bNode){sharedNode=aNode;aNode=aNodes.pop();bNode=bNodes.pop()}return sharedNode}d3.layout.chord=function(){var chord={},chords,groups,matrix,n,padding=0,sortGroups,sortSubgroups,sortChords;function relayout(){var subgroups={},groupSums=[],groupIndex=d3.range(n),subgroupIndex=[],k,x,x0,i,j;chords=[];groups=[];k=0,i=-1;while(++i<n){x=0,j=-1;while(++j<n){x+=matrix[i][j]}groupSums.push(x);subgroupIndex.push(d3.range(n));k+=x}if(sortGroups){groupIndex.sort(function(a,b){return sortGroups(groupSums[a],groupSums[b])})}if(sortSubgroups){subgroupIndex.forEach(function(d,i){d.sort(function(a,b){return sortSubgroups(matrix[i][a],matrix[i][b])})})}k=(2*π-padding*n)/k;x=0,i=-1;while(++i<n){x0=x,j=-1;while(++j<n){var di=groupIndex[i],dj=subgroupIndex[di][j],v=matrix[di][dj],a0=x,a1=x+=v*k;subgroups[di+"-"+dj]={index:di,subindex:dj,startAngle:a0,endAngle:a1,value:v}}groups[di]={index:di,startAngle:x0,endAngle:x,value:(x-x0)/k};x+=padding}i=-1;while(++i<n){j=i-1;while(++j<n){var source=subgroups[i+"-"+j],target=subgroups[j+"-"+i];if(source.value||target.value){chords.push(source.value<target.value?{source:target,target:source}:{source:source,target:target})}}}if(sortChords){resort()}}function resort(){chords.sort(function(a,b){return sortChords((a.source.value+a.target.value)/2,(b.source.value+b.target.value)/2)})}chord.matrix=function(x){if(!arguments.length){return matrix}n=(matrix=x)&&matrix.length;chords=groups=null;return chord};chord.padding=function(x){if(!arguments.length){return padding}padding=x;chords=groups=null;return chord};chord.sortGroups=function(x){if(!arguments.length){return sortGroups}sortGroups=x;chords=groups=null;return chord};chord.sortSubgroups=function(x){if(!arguments.length){return sortSubgroups}sortSubgroups=x;chords=null;return chord};chord.sortChords=function(x){if(!arguments.length){return sortChords}sortChords=x;if(chords){resort()}return chord};chord.chords=function(){if(!chords){relayout()}return chords};chord.groups=function(){if(!groups){relayout()}return groups};return chord};d3.layout.force=function(){var force={},event=d3.dispatch("start","tick","end"),size=[1,1],drag,alpha,friction=0.9,linkDistance=d3_layout_forceLinkDistance,linkStrength=d3_layout_forceLinkStrength,charge=-30,gravity=0.1,theta=0.8,nodes=[],links=[],distances,strengths,charges;function repulse(node){return function(quad,x1,_,x2){if(quad.point!==node){var dx=quad.cx-node.x,dy=quad.cy-node.y,dn=1/Math.sqrt(dx*dx+dy*dy);if((x2-x1)*dn<theta){var k=quad.charge*dn*dn;node.px-=dx*k;node.py-=dy*k;return true}if(quad.point&&isFinite(dn)){var k=quad.pointCharge*dn*dn;node.px-=dx*k;node.py-=dy*k}}return !quad.charge}}force.tick=function(){if((alpha*=0.99)<0.005){event.end({type:"end",alpha:alpha=0});return true}var n=nodes.length,m=links.length,q,i,o,s,t,l,k,x,y;for(i=0;i<m;++i){o=links[i];s=o.source;t=o.target;x=t.x-s.x;y=t.y-s.y;if(l=x*x+y*y){l=alpha*strengths[i]*((l=Math.sqrt(l))-distances[i])/l;x*=l;y*=l;t.x-=x*(k=s.weight/(t.weight+s.weight));t.y-=y*k;s.x+=x*(k=1-k);s.y+=y*k}}if(k=alpha*gravity){x=size[0]/2;y=size[1]/2;i=-1;if(k){while(++i<n){o=nodes[i];o.x+=(x-o.x)*k;o.y+=(y-o.y)*k}}}if(charge){d3_layout_forceAccumulate(q=d3.geom.quadtree(nodes),alpha,charges);i=-1;while(++i<n){if(!(o=nodes[i]).fixed){q.visit(repulse(o))}}}i=-1;while(++i<n){o=nodes[i];if(o.fixed){o.x=o.px;o.y=o.py}else{o.x-=(o.px-(o.px=o.x))*friction;o.y-=(o.py-(o.py=o.y))*friction}}event.tick({type:"tick",alpha:alpha})};force.nodes=function(x){if(!arguments.length){return nodes}nodes=x;return force};force.links=function(x){if(!arguments.length){return links}links=x;return force};force.size=function(x){if(!arguments.length){return size}size=x;return force};force.linkDistance=function(x){if(!arguments.length){return linkDistance}linkDistance=typeof x==="function"?x:+x;return force};force.distance=force.linkDistance;force.linkStrength=function(x){if(!arguments.length){return linkStrength}linkStrength=typeof x==="function"?x:+x;return force};force.friction=function(x){if(!arguments.length){return friction}friction=+x;return force};force.charge=function(x){if(!arguments.length){return charge}charge=typeof x==="function"?x:+x;return force};force.gravity=function(x){if(!arguments.length){return gravity}gravity=+x;return force};force.theta=function(x){if(!arguments.length){return theta}theta=+x;return force};force.alpha=function(x){if(!arguments.length){return alpha}x=+x;if(alpha){if(x>0){alpha=x}else{alpha=0}}else{if(x>0){event.start({type:"start",alpha:alpha=x});d3.timer(force.tick)}}return force};force.start=function(){var i,j,n=nodes.length,m=links.length,w=size[0],h=size[1],neighbors,o;for(i=0;i<n;++i){(o=nodes[i]).index=i;o.weight=0}for(i=0;i<m;++i){o=links[i];if(typeof o.source=="number"){o.source=nodes[o.source]}if(typeof o.target=="number"){o.target=nodes[o.target]}++o.source.weight;++o.target.weight}for(i=0;i<n;++i){o=nodes[i];if(isNaN(o.x)){o.x=position("x",w)}if(isNaN(o.y)){o.y=position("y",h)}if(isNaN(o.px)){o.px=o.x}if(isNaN(o.py)){o.py=o.y}}distances=[];if(typeof linkDistance==="function"){for(i=0;i<m;++i){distances[i]=+linkDistance.call(this,links[i],i)}}else{for(i=0;i<m;++i){distances[i]=linkDistance}}strengths=[];if(typeof linkStrength==="function"){for(i=0;i<m;++i){strengths[i]=+linkStrength.call(this,links[i],i)}}else{for(i=0;i<m;++i){strengths[i]=linkStrength}}charges=[];if(typeof charge==="function"){for(i=0;i<n;++i){charges[i]=+charge.call(this,nodes[i],i)}}else{for(i=0;i<n;++i){charges[i]=charge}}function position(dimension,size){var neighbors=neighbor(i),j=-1,m=neighbors.length,x;while(++j<m){if(!isNaN(x=neighbors[j][dimension])){return x}}return Math.random()*size}function neighbor(){if(!neighbors){neighbors=[];for(j=0;j<n;++j){neighbors[j]=[]}for(j=0;j<m;++j){var o=links[j];neighbors[o.source.index].push(o.target);neighbors[o.target.index].push(o.source)}}return neighbors[i]}return force.resume()};force.resume=function(){return force.alpha(0.1)};force.stop=function(){return force.alpha(0)};force.drag=function(){if(!drag){drag=d3.behavior.drag().origin(d3_identity).on("dragstart.force",d3_layout_forceDragstart).on("drag.force",dragmove).on("dragend.force",d3_layout_forceDragend)}if(!arguments.length){return drag}this.on("mouseover.force",d3_layout_forceMouseover).on("mouseout.force",d3_layout_forceMouseout).call(drag)};function dragmove(d){d.px=d3.event.x,d.py=d3.event.y;force.resume()}return d3.rebind(force,event,"on")};function d3_layout_forceDragstart(d){d.fixed|=2}function d3_layout_forceDragend(d){d.fixed&=~6}function d3_layout_forceMouseover(d){d.fixed|=4;d.px=d.x,d.py=d.y}function d3_layout_forceMouseout(d){d.fixed&=~4}function d3_layout_forceAccumulate(quad,alpha,charges){var cx=0,cy=0;quad.charge=0;if(!quad.leaf){var nodes=quad.nodes,n=nodes.length,i=-1,c;while(++i<n){c=nodes[i];if(c==null){continue}d3_layout_forceAccumulate(c,alpha,charges);quad.charge+=c.charge;cx+=c.charge*c.cx;cy+=c.charge*c.cy}}if(quad.point){if(!quad.leaf){quad.point.x+=Math.random()-0.5;quad.point.y+=Math.random()-0.5}var k=alpha*charges[quad.point.index];quad.charge+=quad.pointCharge=k;cx+=k*quad.point.x;cy+=k*quad.point.y}quad.cx=cx/quad.charge;quad.cy=cy/quad.charge}var d3_layout_forceLinkDistance=20,d3_layout_forceLinkStrength=1;d3.layout.hierarchy=function(){var sort=d3_layout_hierarchySort,children=d3_layout_hierarchyChildren,value=d3_layout_hierarchyValue;function recurse(node,depth,nodes){var childs=children.call(hierarchy,node,depth);node.depth=depth;nodes.push(node);if(childs&&(n=childs.length)){var i=-1,n,c=node.children=[],v=0,j=depth+1,d;while(++i<n){d=recurse(childs[i],j,nodes);d.parent=node;c.push(d);v+=d.value}if(sort){c.sort(sort)}if(value){node.value=v}}else{if(value){node.value=+value.call(hierarchy,node,depth)||0}}return node}function revalue(node,depth){var children=node.children,v=0;if(children&&(n=children.length)){var i=-1,n,j=depth+1;while(++i<n){v+=revalue(children[i],j)}}else{if(value){v=+value.call(hierarchy,node,depth)||0}}if(value){node.value=v}return v}function hierarchy(d){var nodes=[];recurse(d,0,nodes);return nodes}hierarchy.sort=function(x){if(!arguments.length){return sort}sort=x;return hierarchy};hierarchy.children=function(x){if(!arguments.length){return children}children=x;return hierarchy};hierarchy.value=function(x){if(!arguments.length){return value}value=x;return hierarchy};hierarchy.revalue=function(root){revalue(root,0);return root};return hierarchy};function d3_layout_hierarchyRebind(object,hierarchy){d3.rebind(object,hierarchy,"sort","children","value");object.nodes=object;object.links=d3_layout_hierarchyLinks;return object}function d3_layout_hierarchyChildren(d){return d.children}function d3_layout_hierarchyValue(d){return d.value}function d3_layout_hierarchySort(a,b){return b.value-a.value}function d3_layout_hierarchyLinks(nodes){return d3.merge(nodes.map(function(parent){return(parent.children||[]).map(function(child){return{source:parent,target:child}})}))}d3.layout.partition=function(){var hierarchy=d3.layout.hierarchy(),size=[1,1];function position(node,x,dx,dy){var children=node.children;node.x=x;node.y=node.depth*dy;node.dx=dx;node.dy=dy;if(children&&(n=children.length)){var i=-1,n,c,d;dx=node.value?dx/node.value:0;while(++i<n){position(c=children[i],x,d=c.value*dx,dy);x+=d}}}function depth(node){var children=node.children,d=0;if(children&&(n=children.length)){var i=-1,n;while(++i<n){d=Math.max(d,depth(children[i]))}}return 1+d}function partition(d,i){var nodes=hierarchy.call(this,d,i);position(nodes[0],0,size[0],size[1]/depth(nodes[0]));return nodes}partition.size=function(x){if(!arguments.length){return size}size=x;return partition};return d3_layout_hierarchyRebind(partition,hierarchy)};d3.layout.pie=function(){var value=Number,sort=d3_layout_pieSortByValue,startAngle=0,endAngle=2*π;function pie(data){var values=data.map(function(d,i){return +value.call(pie,d,i)});var a=+(typeof startAngle==="function"?startAngle.apply(this,arguments):startAngle);var k=((typeof endAngle==="function"?endAngle.apply(this,arguments):endAngle)-a)/d3.sum(values);var index=d3.range(data.length);if(sort!=null){index.sort(sort===d3_layout_pieSortByValue?function(i,j){return values[j]-values[i]}:function(i,j){return sort(data[i],data[j])})}var arcs=[];index.forEach(function(i){var d;arcs[i]={data:data[i],value:d=values[i],startAngle:a,endAngle:a+=d*k}});return arcs}pie.value=function(x){if(!arguments.length){return value}value=x;return pie};pie.sort=function(x){if(!arguments.length){return sort}sort=x;return pie};pie.startAngle=function(x){if(!arguments.length){return startAngle}startAngle=x;return pie};pie.endAngle=function(x){if(!arguments.length){return endAngle}endAngle=x;return pie};return pie};var d3_layout_pieSortByValue={};d3.layout.stack=function(){var values=d3_identity,order=d3_layout_stackOrderDefault,offset=d3_layout_stackOffsetZero,out=d3_layout_stackOut,x=d3_layout_stackX,y=d3_layout_stackY;function stack(data,index){var series=data.map(function(d,i){return values.call(stack,d,i)});var points=series.map(function(d){return d.map(function(v,i){return[x.call(stack,v,i),y.call(stack,v,i)]})});var orders=order.call(stack,points,index);series=d3.permute(series,orders);points=d3.permute(points,orders);var offsets=offset.call(stack,points,index);var n=series.length,m=series[0].length,i,j,o;for(j=0;j<m;++j){out.call(stack,series[0][j],o=offsets[j],points[0][j][1]);for(i=1;i<n;++i){out.call(stack,series[i][j],o+=points[i-1][j][1],points[i][j][1])}}return data}stack.values=function(x){if(!arguments.length){return values}values=x;return stack};stack.order=function(x){if(!arguments.length){return order}order=typeof x==="function"?x:d3_layout_stackOrders.get(x)||d3_layout_stackOrderDefault;return stack};stack.offset=function(x){if(!arguments.length){return offset}offset=typeof x==="function"?x:d3_layout_stackOffsets.get(x)||d3_layout_stackOffsetZero;return stack};stack.x=function(z){if(!arguments.length){return x}x=z;return stack};stack.y=function(z){if(!arguments.length){return y}y=z;return stack};stack.out=function(z){if(!arguments.length){return out}out=z;return stack};return stack};function d3_layout_stackX(d){return d.x}function d3_layout_stackY(d){return d.y}function d3_layout_stackOut(d,y0,y){d.y0=y0;d.y=y}var d3_layout_stackOrders=d3.map({"inside-out":function(data){var n=data.length,i,j,max=data.map(d3_layout_stackMaxIndex),sums=data.map(d3_layout_stackReduceSum),index=d3.range(n).sort(function(a,b){return max[a]-max[b]}),top=0,bottom=0,tops=[],bottoms=[];for(i=0;i<n;++i){j=index[i];if(top<bottom){top+=sums[j];tops.push(j)}else{bottom+=sums[j];bottoms.push(j)}}return bottoms.reverse().concat(tops)},reverse:function(data){return d3.range(data.length).reverse()},"default":d3_layout_stackOrderDefault});var d3_layout_stackOffsets=d3.map({silhouette:function(data){var n=data.length,m=data[0].length,sums=[],max=0,i,j,o,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<n;i++){o+=data[i][j][1]}if(o>max){max=o}sums.push(o)}for(j=0;j<m;++j){y0[j]=(max-sums[j])/2}return y0},wiggle:function(data){var n=data.length,x=data[0],m=x.length,i,j,k,s1,s2,s3,dx,o,o0,y0=[];y0[0]=o=o0=0;for(j=1;j<m;++j){for(i=0,s1=0;i<n;++i){s1+=data[i][j][1]}for(i=0,s2=0,dx=x[j][0]-x[j-1][0];i<n;++i){for(k=0,s3=(data[i][j][1]-data[i][j-1][1])/(2*dx);k<i;++k){s3+=(data[k][j][1]-data[k][j-1][1])/dx}s2+=s3*data[i][j][1]}y0[j]=o-=s1?s2/s1*dx:0;if(o<o0){o0=o}}for(j=0;j<m;++j){y0[j]-=o0}return y0},expand:function(data){var n=data.length,m=data[0].length,k=1/n,i,j,o,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<n;i++){o+=data[i][j][1]}if(o){for(i=0;i<n;i++){data[i][j][1]/=o}}else{for(i=0;i<n;i++){data[i][j][1]=k}}}for(j=0;j<m;++j){y0[j]=0}return y0},zero:d3_layout_stackOffsetZero});function d3_layout_stackOrderDefault(data){return d3.range(data.length)}function d3_layout_stackOffsetZero(data){var j=-1,m=data[0].length,y0=[];while(++j<m){y0[j]=0}return y0}function d3_layout_stackMaxIndex(array){var i=1,j=0,v=array[0][1],k,n=array.length;for(;i<n;++i){if((k=array[i][1])>v){j=i;v=k}}return j}function d3_layout_stackReduceSum(d){return d.reduce(d3_layout_stackSum,0)}function d3_layout_stackSum(p,d){return p+d[1]}d3.layout.histogram=function(){var frequency=true,valuer=Number,ranger=d3_layout_histogramRange,binner=d3_layout_histogramBinSturges;function histogram(data,i){var bins=[],values=data.map(valuer,this),range=ranger.call(this,values,i),thresholds=binner.call(this,range,values,i),bin,i=-1,n=values.length,m=thresholds.length-1,k=frequency?1:1/n,x;while(++i<m){bin=bins[i]=[];bin.dx=thresholds[i+1]-(bin.x=thresholds[i]);bin.y=0}if(m>0){i=-1;while(++i<n){x=values[i];if(x>=range[0]&&x<=range[1]){bin=bins[d3.bisect(thresholds,x,1,m)-1];bin.y+=k;bin.push(data[i])}}}return bins}histogram.value=function(x){if(!arguments.length){return valuer}valuer=x;return histogram};histogram.range=function(x){if(!arguments.length){return ranger}ranger=d3_functor(x);return histogram};histogram.bins=function(x){if(!arguments.length){return binner}binner=typeof x==="number"?function(range){return d3_layout_histogramBinFixed(range,x)}:d3_functor(x);return histogram};histogram.frequency=function(x){if(!arguments.length){return frequency}frequency=!!x;return histogram};return histogram};function d3_layout_histogramBinSturges(range,values){return d3_layout_histogramBinFixed(range,Math.ceil(Math.log(values.length)/Math.LN2+1))}function d3_layout_histogramBinFixed(range,n){var x=-1,b=+range[0],m=(range[1]-b)/n,f=[];while(++x<=n){f[x]=m*x+b}return f}function d3_layout_histogramRange(values){return[d3.min(values),d3.max(values)]}d3.layout.tree=function(){var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1];function tree(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0];function firstWalk(node,previousSibling){var children=node.children,layout=node._tree;if(children&&(n=children.length)){var n,firstChild=children[0],previousChild,ancestor=firstChild,child,i=-1;while(++i<n){child=children[i];firstWalk(child,previousChild);ancestor=apportion(child,previousChild,ancestor);previousChild=child}d3_layout_treeShift(node);var midpoint=0.5*(firstChild._tree.prelim+child._tree.prelim);if(previousSibling){layout.prelim=previousSibling._tree.prelim+separation(node,previousSibling);layout.mod=layout.prelim-midpoint}else{layout.prelim=midpoint}}else{if(previousSibling){layout.prelim=previousSibling._tree.prelim+separation(node,previousSibling)}}}function secondWalk(node,x){node.x=node._tree.prelim+x;var children=node.children;if(children&&(n=children.length)){var i=-1,n;x+=node._tree.mod;while(++i<n){secondWalk(children[i],x)}}}function apportion(node,previousSibling,ancestor){if(previousSibling){var vip=node,vop=node,vim=previousSibling,vom=node.parent.children[0],sip=vip._tree.mod,sop=vop._tree.mod,sim=vim._tree.mod,som=vom._tree.mod,shift;while(vim=d3_layout_treeRight(vim),vip=d3_layout_treeLeft(vip),vim&&vip){vom=d3_layout_treeLeft(vom);vop=d3_layout_treeRight(vop);vop._tree.ancestor=node;shift=vim._tree.prelim+sim-vip._tree.prelim-sip+separation(vim,vip);if(shift>0){d3_layout_treeMove(d3_layout_treeAncestor(vim,node,ancestor),node,shift);sip+=shift;sop+=shift}sim+=vim._tree.mod;sip+=vip._tree.mod;som+=vom._tree.mod;sop+=vop._tree.mod}if(vim&&!d3_layout_treeRight(vop)){vop._tree.thread=vim;vop._tree.mod+=sim-sop}if(vip&&!d3_layout_treeLeft(vom)){vom._tree.thread=vip;vom._tree.mod+=sip-som;ancestor=node}}return ancestor}d3_layout_treeVisitAfter(root,function(node,previousSibling){node._tree={ancestor:node,prelim:0,mod:0,change:0,shift:0,number:previousSibling?previousSibling._tree.number+1:0}});firstWalk(root);secondWalk(root,-root._tree.prelim);var left=d3_layout_treeSearch(root,d3_layout_treeLeftmost),right=d3_layout_treeSearch(root,d3_layout_treeRightmost),deep=d3_layout_treeSearch(root,d3_layout_treeDeepest),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2,y1=deep.depth||1;d3_layout_treeVisitAfter(root,function(node){node.x=(node.x-x0)/(x1-x0)*size[0];node.y=node.depth/y1*size[1];delete node._tree});return nodes}tree.separation=function(x){if(!arguments.length){return separation}separation=x;return tree};tree.size=function(x){if(!arguments.length){return size}size=x;return tree};return d3_layout_hierarchyRebind(tree,hierarchy)};function d3_layout_treeSeparation(a,b){return a.parent==b.parent?1:2}function d3_layout_treeLeft(node){var children=node.children;return children&&children.length?children[0]:node._tree.thread}function d3_layout_treeRight(node){var children=node.children,n;return children&&(n=children.length)?children[n-1]:node._tree.thread}function d3_layout_treeSearch(node,compare){var children=node.children;if(children&&(n=children.length)){var child,n,i=-1;while(++i<n){if(compare(child=d3_layout_treeSearch(children[i],compare),node)>0){node=child}}}return node}function d3_layout_treeRightmost(a,b){return a.x-b.x}function d3_layout_treeLeftmost(a,b){return b.x-a.x}function d3_layout_treeDeepest(a,b){return a.depth-b.depth}function d3_layout_treeVisitAfter(node,callback){function visit(node,previousSibling){var children=node.children;if(children&&(n=children.length)){var child,previousChild=null,i=-1,n;while(++i<n){child=children[i];visit(child,previousChild);previousChild=child}}callback(node,previousSibling)}visit(node,null)}function d3_layout_treeShift(node){var shift=0,change=0,children=node.children,i=children.length,child;while(--i>=0){child=children[i]._tree;child.prelim+=shift;child.mod+=shift;shift+=child.shift+(change+=child.change)}}function d3_layout_treeMove(ancestor,node,shift){ancestor=ancestor._tree;node=node._tree;var change=shift/(node.number-ancestor.number);ancestor.change+=change;node.change-=change;node.shift+=shift;node.prelim+=shift;node.mod+=shift}function d3_layout_treeAncestor(vim,node,ancestor){return vim._tree.ancestor.parent==node.parent?vim._tree.ancestor:ancestor}d3.layout.pack=function(){var hierarchy=d3.layout.hierarchy().sort(d3_layout_packSort),padding=0,size=[1,1];function pack(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0];root.x=0;root.y=0;d3_layout_treeVisitAfter(root,function(d){d.r=Math.sqrt(d.value)});d3_layout_treeVisitAfter(root,d3_layout_packSiblings);var w=size[0],h=size[1],k=Math.max(2*root.r/w,2*root.r/h);if(padding>0){var dr=padding*k/2;d3_layout_treeVisitAfter(root,function(d){d.r+=dr});d3_layout_treeVisitAfter(root,d3_layout_packSiblings);d3_layout_treeVisitAfter(root,function(d){d.r-=dr});k=Math.max(2*root.r/w,2*root.r/h)}d3_layout_packTransform(root,w/2,h/2,1/k);return nodes}pack.size=function(x){if(!arguments.length){return size}size=x;return pack};pack.padding=function(_){if(!arguments.length){return padding}padding=+_;return pack};return d3_layout_hierarchyRebind(pack,hierarchy)};function d3_layout_packSort(a,b){return a.value-b.value}function d3_layout_packInsert(a,b){var c=a._pack_next;a._pack_next=b;b._pack_prev=a;b._pack_next=c;c._pack_prev=b}function d3_layout_packSplice(a,b){a._pack_next=b;b._pack_prev=a}function d3_layout_packIntersects(a,b){var dx=b.x-a.x,dy=b.y-a.y,dr=a.r+b.r;return dr*dr-dx*dx-dy*dy>0.001}function d3_layout_packSiblings(node){if(!(nodes=node.children)||!(n=nodes.length)){return}var nodes,xMin=Infinity,xMax=-Infinity,yMin=Infinity,yMax=-Infinity,a,b,c,i,j,k,n;function bound(node){xMin=Math.min(node.x-node.r,xMin);xMax=Math.max(node.x+node.r,xMax);yMin=Math.min(node.y-node.r,yMin);yMax=Math.max(node.y+node.r,yMax)}nodes.forEach(d3_layout_packLink);a=nodes[0];a.x=-a.r;a.y=0;bound(a);if(n>1){b=nodes[1];b.x=b.r;b.y=0;bound(b);if(n>2){c=nodes[2];d3_layout_packPlace(a,b,c);bound(c);d3_layout_packInsert(a,c);a._pack_prev=c;d3_layout_packInsert(c,b);b=a._pack_next;for(i=3;i<n;i++){d3_layout_packPlace(a,b,c=nodes[i]);var isect=0,s1=1,s2=1;for(j=b._pack_next;j!==b;j=j._pack_next,s1++){if(d3_layout_packIntersects(j,c)){isect=1;break}}if(isect==1){for(k=a._pack_prev;k!==j._pack_prev;k=k._pack_prev,s2++){if(d3_layout_packIntersects(k,c)){break}}}if(isect){if(s1<s2||s1==s2&&b.r<a.r){d3_layout_packSplice(a,b=j)}else{d3_layout_packSplice(a=k,b)}i--}else{d3_layout_packInsert(a,c);b=c;bound(c)}}}}var cx=(xMin+xMax)/2,cy=(yMin+yMax)/2,cr=0;for(i=0;i<n;i++){c=nodes[i];c.x-=cx;c.y-=cy;cr=Math.max(cr,c.r+Math.sqrt(c.x*c.x+c.y*c.y))}node.r=cr;nodes.forEach(d3_layout_packUnlink)}function d3_layout_packLink(node){node._pack_next=node._pack_prev=node}function d3_layout_packUnlink(node){delete node._pack_next;delete node._pack_prev}function d3_layout_packTransform(node,x,y,k){var children=node.children;node.x=x+=k*node.x;node.y=y+=k*node.y;node.r*=k;if(children){var i=-1,n=children.length;while(++i<n){d3_layout_packTransform(children[i],x,y,k)}}}function d3_layout_packPlace(a,b,c){var db=a.r+c.r,dx=b.x-a.x,dy=b.y-a.y;if(db&&(dx||dy)){var da=b.r+c.r,dc=dx*dx+dy*dy;da*=da;db*=db;var x=0.5+(db-da)/(2*dc),y=Math.sqrt(Math.max(0,2*da*(db+dc)-(db-=dc)*db-da*da))/(2*dc);c.x=a.x+x*dx+y*dy;c.y=a.y+x*dy-y*dx}else{c.x=a.x+db;c.y=a.y}}d3.layout.cluster=function(){var hierarchy=d3.layout.hierarchy().sort(null).value(null),separation=d3_layout_treeSeparation,size=[1,1];function cluster(d,i){var nodes=hierarchy.call(this,d,i),root=nodes[0],previousNode,x=0;d3_layout_treeVisitAfter(root,function(node){var children=node.children;if(children&&children.length){node.x=d3_layout_clusterX(children);node.y=d3_layout_clusterY(children)}else{node.x=previousNode?x+=separation(node,previousNode):0;node.y=0;previousNode=node}});var left=d3_layout_clusterLeft(root),right=d3_layout_clusterRight(root),x0=left.x-separation(left,right)/2,x1=right.x+separation(right,left)/2;d3_layout_treeVisitAfter(root,function(node){node.x=(node.x-x0)/(x1-x0)*size[0];node.y=(1-(root.y?node.y/root.y:1))*size[1]});return nodes}cluster.separation=function(x){if(!arguments.length){return separation}separation=x;return cluster};cluster.size=function(x){if(!arguments.length){return size}size=x;return cluster};return d3_layout_hierarchyRebind(cluster,hierarchy)};function d3_layout_clusterY(children){return 1+d3.max(children,function(child){return child.y})}function d3_layout_clusterX(children){return children.reduce(function(x,child){return x+child.x},0)/children.length}function d3_layout_clusterLeft(node){var children=node.children;return children&&children.length?d3_layout_clusterLeft(children[0]):node}function d3_layout_clusterRight(node){var children=node.children,n;return children&&(n=children.length)?d3_layout_clusterRight(children[n-1]):node}d3.layout.treemap=function(){var hierarchy=d3.layout.hierarchy(),round=Math.round,size=[1,1],padding=null,pad=d3_layout_treemapPadNull,sticky=false,stickies,mode="squarify",ratio=0.5*(1+Math.sqrt(5));function scale(children,k){var i=-1,n=children.length,child,area;while(++i<n){area=(child=children[i]).value*(k<0?0:k);child.area=isNaN(area)||area<=0?0:area}}function squarify(node){var children=node.children;if(children&&children.length){var rect=pad(node),row=[],remaining=children.slice(),child,best=Infinity,score,u=mode==="slice"?rect.dx:mode==="dice"?rect.dy:mode==="slice-dice"?node.depth&1?rect.dy:rect.dx:Math.min(rect.dx,rect.dy),n;scale(remaining,rect.dx*rect.dy/node.value);row.area=0;while((n=remaining.length)>0){row.push(child=remaining[n-1]);row.area+=child.area;if(mode!=="squarify"||(score=worst(row,u))<=best){remaining.pop();best=score}else{row.area-=row.pop().area;position(row,u,rect,false);u=Math.min(rect.dx,rect.dy);row.length=row.area=0;best=Infinity}}if(row.length){position(row,u,rect,true);row.length=row.area=0}children.forEach(squarify)}}function stickify(node){var children=node.children;if(children&&children.length){var rect=pad(node),remaining=children.slice(),child,row=[];scale(remaining,rect.dx*rect.dy/node.value);row.area=0;while(child=remaining.pop()){row.push(child);row.area+=child.area;if(child.z!=null){position(row,child.z?rect.dx:rect.dy,rect,!remaining.length);row.length=row.area=0}}children.forEach(stickify)}}function worst(row,u){var s=row.area,r,rmax=0,rmin=Infinity,i=-1,n=row.length;while(++i<n){if(!(r=row[i].area)){continue}if(r<rmin){rmin=r}if(r>rmax){rmax=r}}s*=s;u*=u;return s?Math.max(u*rmax*ratio/s,s/(u*rmin*ratio)):Infinity}function position(row,u,rect,flush){var i=-1,n=row.length,x=rect.x,y=rect.y,v=u?round(row.area/u):0,o;if(u==rect.dx){if(flush||v>rect.dy){v=rect.dy}while(++i<n){o=row[i];o.x=x;o.y=y;o.dy=v;x+=o.dx=Math.min(rect.x+rect.dx-x,v?round(o.area/v):0)}o.z=true;o.dx+=rect.x+rect.dx-x;rect.y+=v;rect.dy-=v}else{if(flush||v>rect.dx){v=rect.dx}while(++i<n){o=row[i];o.x=x;o.y=y;o.dx=v;y+=o.dy=Math.min(rect.y+rect.dy-y,v?round(o.area/v):0)}o.z=false;o.dy+=rect.y+rect.dy-y;rect.x+=v;rect.dx-=v}}function treemap(d){var nodes=stickies||hierarchy(d),root=nodes[0];root.x=0;root.y=0;root.dx=size[0];root.dy=size[1];if(stickies){hierarchy.revalue(root)}scale([root],root.dx*root.dy/root.value);(stickies?stickify:squarify)(root);if(sticky){stickies=nodes}return nodes}treemap.size=function(x){if(!arguments.length){return size}size=x;return treemap};treemap.padding=function(x){if(!arguments.length){return padding}function padFunction(node){var p=x.call(treemap,node,node.depth);return p==null?d3_layout_treemapPadNull(node):d3_layout_treemapPad(node,typeof p==="number"?[p,p,p,p]:p)}function padConstant(node){return d3_layout_treemapPad(node,x)}var type;pad=(padding=x)==null?d3_layout_treemapPadNull:(type=typeof x)==="function"?padFunction:type==="number"?(x=[x,x,x,x],padConstant):padConstant;return treemap};treemap.round=function(x){if(!arguments.length){return round!=Number}round=x?Math.round:Number;return treemap};treemap.sticky=function(x){if(!arguments.length){return sticky}sticky=x;stickies=null;return treemap};treemap.ratio=function(x){if(!arguments.length){return ratio}ratio=x;return treemap};treemap.mode=function(x){if(!arguments.length){return mode}mode=x+"";return treemap};return d3_layout_hierarchyRebind(treemap,hierarchy)};function d3_layout_treemapPadNull(node){return{x:node.x,y:node.y,dx:node.dx,dy:node.dy}}function d3_layout_treemapPad(node,padding){var x=node.x+padding[3],y=node.y+padding[0],dx=node.dx-padding[1]-padding[3],dy=node.dy-padding[0]-padding[2];if(dx<0){x+=dx/2;dx=0}if(dy<0){y+=dy/2;dy=0}return{x:x,y:y,dx:dx,dy:dy}}d3.random={normal:function(µ,σ){var n=arguments.length;if(n<2){σ=1}if(n<1){µ=0}return function(){var x,y,r;do{x=Math.random()*2-1;y=Math.random()*2-1;r=x*x+y*y}while(!r||r>1);return µ+σ*x*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var random=d3.random.normal.apply(d3,arguments);return function(){return Math.exp(random())}},irwinHall:function(m){return function(){for(var s=0,j=0;j<m;j++){s+=Math.random()}return s/m}}};d3.scale={};function d3_scaleExtent(domain){var start=domain[0],stop=domain[domain.length-1];return start<stop?[start,stop]:[stop,start]}function d3_scaleRange(scale){return scale.rangeExtent?scale.rangeExtent():d3_scaleExtent(scale.range())}function d3_scale_bilinear(domain,range,uninterpolate,interpolate){var u=uninterpolate(domain[0],domain[1]),i=interpolate(range[0],range[1]);return function(x){return i(u(x))}}function d3_scale_nice(domain,nice){var i0=0,i1=domain.length-1,x0=domain[i0],x1=domain[i1],dx;if(x1<x0){dx=i0,i0=i1,i1=dx;dx=x0,x0=x1,x1=dx}if(nice=nice(x1-x0)){domain[i0]=nice.floor(x0);domain[i1]=nice.ceil(x1)}return domain}function d3_scale_polylinear(domain,range,uninterpolate,interpolate){var u=[],i=[],j=0,k=Math.min(domain.length,range.length)-1;if(domain[k]<domain[0]){domain=domain.slice().reverse();range=range.slice().reverse()}while(++j<=k){u.push(uninterpolate(domain[j-1],domain[j]));i.push(interpolate(range[j-1],range[j]))}return function(x){var j=d3.bisect(domain,x,1,k)-1;return i[j](u[j](x))}}d3.scale.linear=function(){return d3_scale_linear([0,1],[0,1],d3_interpolate,false)};function d3_scale_linear(domain,range,interpolate,clamp){var output,input;function rescale(){var linear=Math.min(domain.length,range.length)>2?d3_scale_polylinear:d3_scale_bilinear,uninterpolate=clamp?d3_uninterpolateClamp:d3_uninterpolateNumber;output=linear(domain,range,uninterpolate,interpolate);input=linear(range,domain,uninterpolate,d3_interpolate);return scale}function scale(x){return output(x)}scale.invert=function(y){return input(y)};scale.domain=function(x){if(!arguments.length){return domain}domain=x.map(Number);return rescale()};scale.range=function(x){if(!arguments.length){return range}range=x;return rescale()};scale.rangeRound=function(x){return scale.range(x).interpolate(d3_interpolateRound)};scale.clamp=function(x){if(!arguments.length){return clamp}clamp=x;return rescale()};scale.interpolate=function(x){if(!arguments.length){return interpolate}interpolate=x;return rescale()};scale.ticks=function(m){return d3_scale_linearTicks(domain,m)};scale.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};scale.nice=function(){d3_scale_nice(domain,d3_scale_linearNice);return rescale()};scale.copy=function(){return d3_scale_linear(domain,range,interpolate,clamp)};return rescale()}function d3_scale_linearRebind(scale,linear){return d3.rebind(scale,linear,"range","rangeRound","interpolate","clamp")}function d3_scale_linearNice(dx){dx=Math.pow(10,Math.round(Math.log(dx)/Math.LN10)-1);return dx&&{floor:function(x){return Math.floor(x/dx)*dx},ceil:function(x){return Math.ceil(x/dx)*dx}}}function d3_scale_linearTickRange(domain,m){var extent=d3_scaleExtent(domain),span=extent[1]-extent[0],step=Math.pow(10,Math.floor(Math.log(span/m)/Math.LN10)),err=m/span*step;if(err<=0.15){step*=10}else{if(err<=0.35){step*=5}else{if(err<=0.75){step*=2}}}extent[0]=Math.ceil(extent[0]/step)*step;extent[1]=Math.floor(extent[1]/step)*step+step*0.5;extent[2]=step;return extent}function d3_scale_linearTicks(domain,m){return d3.range.apply(d3,d3_scale_linearTickRange(domain,m))}function d3_scale_linearTickFormat(domain,m,format){var precision=-Math.floor(Math.log(d3_scale_linearTickRange(domain,m)[2])/Math.LN10+0.01);return d3.format(format?format.replace(d3_format_re,function(a,b,c,d,e,f,g,h,i,j){return[b,c,d,e,f,g,h,i||"."+(precision-(j==="%")*2),j].join("")}):",."+precision+"f")}d3.scale.log=function(){return d3_scale_log(d3.scale.linear().domain([0,Math.LN10]),10,d3_scale_logp,d3_scale_powp)};function d3_scale_log(linear,base,log,pow){function scale(x){return linear(log(x))}scale.invert=function(x){return pow(linear.invert(x))};scale.domain=function(x){if(!arguments.length){return linear.domain().map(pow)}if(x[0]<0){log=d3_scale_logn,pow=d3_scale_pown}else{log=d3_scale_logp,pow=d3_scale_powp}linear.domain(x.map(log));return scale};scale.base=function(_){if(!arguments.length){return base}base=+_;return scale};scale.nice=function(){linear.domain(d3_scale_nice(linear.domain(),d3_scale_logNice(base)));return scale};scale.ticks=function(){var extent=d3_scaleExtent(linear.domain()),ticks=[];if(extent.every(isFinite)){var b=Math.log(base),i=Math.floor(extent[0]/b),j=Math.ceil(extent[1]/b),u=pow(extent[0]),v=pow(extent[1]),n=base%1?2:base;if(log===d3_scale_logn){ticks.push(-Math.pow(base,-i));for(;i++<j;){for(var k=n-1;k>0;k--){ticks.push(-Math.pow(base,-i)*k)}}}else{for(;i<j;i++){for(var k=1;k<n;k++){ticks.push(Math.pow(base,i)*k)}}ticks.push(Math.pow(base,i))}for(i=0;ticks[i]<u;i++){}for(j=ticks.length;ticks[j-1]>v;j--){}ticks=ticks.slice(i,j)}return ticks};scale.tickFormat=function(n,format){if(arguments.length<2){format=d3_scale_logFormat}if(!arguments.length){return format}var b=Math.log(base),k=Math.max(0.1,n/scale.ticks().length),f=log===d3_scale_logn?(e=-1e-12,Math.floor):(e=1e-12,Math.ceil),e;return function(d){return d/pow(b*f(log(d)/b+e))<=k?format(d):""}};scale.copy=function(){return d3_scale_log(linear.copy(),base,log,pow)};return d3_scale_linearRebind(scale,linear)}var d3_scale_logFormat=d3.format(".0e");function d3_scale_logp(x){return Math.log(x<0?0:x)}function d3_scale_powp(x){return Math.exp(x)}function d3_scale_logn(x){return -Math.log(x>0?0:-x)}function d3_scale_pown(x){return -Math.exp(-x)}function d3_scale_logNice(base){base=Math.log(base);var nice={floor:function(x){return Math.floor(x/base)*base},ceil:function(x){return Math.ceil(x/base)*base}};return function(){return nice}}d3.scale.pow=function(){return d3_scale_pow(d3.scale.linear(),1)};function d3_scale_pow(linear,exponent){var powp=d3_scale_powPow(exponent),powb=d3_scale_powPow(1/exponent);function scale(x){return linear(powp(x))}scale.invert=function(x){return powb(linear.invert(x))};scale.domain=function(x){if(!arguments.length){return linear.domain().map(powb)}linear.domain(x.map(powp));return scale};scale.ticks=function(m){return d3_scale_linearTicks(scale.domain(),m)};scale.tickFormat=function(m,format){return d3_scale_linearTickFormat(scale.domain(),m,format)};scale.nice=function(){return scale.domain(d3_scale_nice(scale.domain(),d3_scale_linearNice))};scale.exponent=function(x){if(!arguments.length){return exponent}var domain=scale.domain();powp=d3_scale_powPow(exponent=x);powb=d3_scale_powPow(1/exponent);return scale.domain(domain)};scale.copy=function(){return d3_scale_pow(linear.copy(),exponent)};return d3_scale_linearRebind(scale,linear)}function d3_scale_powPow(e){return function(x){return x<0?-Math.pow(-x,e):Math.pow(x,e)}}d3.scale.sqrt=function(){return d3.scale.pow().exponent(0.5)};d3.scale.ordinal=function(){return d3_scale_ordinal([],{t:"range",a:[[]]})};function d3_scale_ordinal(domain,ranger){var index,range,rangeBand;function scale(x){return range[((index.get(x)||index.set(x,domain.push(x)))-1)%range.length]}function steps(start,step){return d3.range(domain.length).map(function(i){return start+step*i})}scale.domain=function(x){if(!arguments.length){return domain}domain=[];index=new d3_Map();var i=-1,n=x.length,xi;while(++i<n){if(!index.has(xi=x[i])){index.set(xi,domain.push(xi))}}return scale[ranger.t].apply(scale,ranger.a)};scale.range=function(x){if(!arguments.length){return range}range=x;rangeBand=0;ranger={t:"range",a:arguments};return scale};scale.rangePoints=function(x,padding){if(arguments.length<2){padding=0}var start=x[0],stop=x[1],step=(stop-start)/(Math.max(1,domain.length-1)+padding);range=steps(domain.length<2?(start+stop)/2:start+step*padding/2,step);rangeBand=0;ranger={t:"rangePoints",a:arguments};return scale};scale.rangeBands=function(x,padding,outerPadding){if(arguments.length<2){padding=0}if(arguments.length<3){outerPadding=padding}var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=(stop-start)/(domain.length-padding+2*outerPadding);range=steps(start+step*outerPadding,step);if(reverse){range.reverse()}rangeBand=step*(1-padding);ranger={t:"rangeBands",a:arguments};return scale};scale.rangeRoundBands=function(x,padding,outerPadding){if(arguments.length<2){padding=0}if(arguments.length<3){outerPadding=padding}var reverse=x[1]<x[0],start=x[reverse-0],stop=x[1-reverse],step=Math.floor((stop-start)/(domain.length-padding+2*outerPadding)),error=stop-start-(domain.length-padding)*step;range=steps(start+Math.round(error/2),step);if(reverse){range.reverse()}rangeBand=Math.round(step*(1-padding));ranger={t:"rangeRoundBands",a:arguments};return scale};scale.rangeBand=function(){return rangeBand};scale.rangeExtent=function(){return d3_scaleExtent(ranger.a[0])};scale.copy=function(){return d3_scale_ordinal(domain,ranger)};return scale.domain(domain)}d3.scale.category10=function(){return d3.scale.ordinal().range(d3_category10)};d3.scale.category20=function(){return d3.scale.ordinal().range(d3_category20)};d3.scale.category20b=function(){return d3.scale.ordinal().range(d3_category20b)};d3.scale.category20c=function(){return d3.scale.ordinal().range(d3_category20c)};var d3_category10=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];var d3_category20=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"];var d3_category20b=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"];var d3_category20c=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return d3_scale_quantile([],[])};function d3_scale_quantile(domain,range){var thresholds;function rescale(){var k=0,q=range.length;thresholds=[];while(++k<q){thresholds[k-1]=d3.quantile(domain,k/q)}return scale}function scale(x){if(isNaN(x=+x)){return NaN}return range[d3.bisect(thresholds,x)]}scale.domain=function(x){if(!arguments.length){return domain}domain=x.filter(function(d){return !isNaN(d)}).sort(d3.ascending);return rescale()};scale.range=function(x){if(!arguments.length){return range}range=x;return rescale()};scale.quantiles=function(){return thresholds};scale.copy=function(){return d3_scale_quantile(domain,range)};return rescale()}d3.scale.quantize=function(){return d3_scale_quantize(0,1,[0,1])};function d3_scale_quantize(x0,x1,range){var kx,i;function scale(x){return range[Math.max(0,Math.min(i,Math.floor(kx*(x-x0))))]}function rescale(){kx=range.length/(x1-x0);i=range.length-1;return scale}scale.domain=function(x){if(!arguments.length){return[x0,x1]}x0=+x[0];x1=+x[x.length-1];return rescale()};scale.range=function(x){if(!arguments.length){return range}range=x;return rescale()};scale.copy=function(){return d3_scale_quantize(x0,x1,range)};return rescale()}d3.scale.threshold=function(){return d3_scale_threshold([0.5],[0,1])};function d3_scale_threshold(domain,range){function scale(x){return range[d3.bisect(domain,x)]}scale.domain=function(_){if(!arguments.length){return domain}domain=_;return scale};scale.range=function(_){if(!arguments.length){return range}range=_;return scale};scale.copy=function(){return d3_scale_threshold(domain,range)};return scale}d3.scale.identity=function(){return d3_scale_identity([0,1])};function d3_scale_identity(domain){function identity(x){return +x}identity.invert=identity;identity.domain=identity.range=function(x){if(!arguments.length){return domain}domain=x.map(identity);return identity};identity.ticks=function(m){return d3_scale_linearTicks(domain,m)};identity.tickFormat=function(m,format){return d3_scale_linearTickFormat(domain,m,format)};identity.copy=function(){return d3_scale_identity(domain)};return identity}d3.svg.arc=function(){var innerRadius=d3_svg_arcInnerRadius,outerRadius=d3_svg_arcOuterRadius,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle;function arc(){var r0=innerRadius.apply(this,arguments),r1=outerRadius.apply(this,arguments),a0=startAngle.apply(this,arguments)+d3_svg_arcOffset,a1=endAngle.apply(this,arguments)+d3_svg_arcOffset,da=(a1<a0&&(da=a0,a0=a1,a1=da),a1-a0),df=da<π?"0":"1",c0=Math.cos(a0),s0=Math.sin(a0),c1=Math.cos(a1),s1=Math.sin(a1);return da>=d3_svg_arcMax?r0?"M0,"+r1+"A"+r1+","+r1+" 0 1,1 0,"+-r1+"A"+r1+","+r1+" 0 1,1 0,"+r1+"M0,"+r0+"A"+r0+","+r0+" 0 1,0 0,"+-r0+"A"+r0+","+r0+" 0 1,0 0,"+r0+"Z":"M0,"+r1+"A"+r1+","+r1+" 0 1,1 0,"+-r1+"A"+r1+","+r1+" 0 1,1 0,"+r1+"Z":r0?"M"+r1*c0+","+r1*s0+"A"+r1+","+r1+" 0 "+df+",1 "+r1*c1+","+r1*s1+"L"+r0*c1+","+r0*s1+"A"+r0+","+r0+" 0 "+df+",0 "+r0*c0+","+r0*s0+"Z":"M"+r1*c0+","+r1*s0+"A"+r1+","+r1+" 0 "+df+",1 "+r1*c1+","+r1*s1+"L0,0Z"}arc.innerRadius=function(v){if(!arguments.length){return innerRadius}innerRadius=d3_functor(v);return arc};arc.outerRadius=function(v){if(!arguments.length){return outerRadius}outerRadius=d3_functor(v);return arc};arc.startAngle=function(v){if(!arguments.length){return startAngle}startAngle=d3_functor(v);return arc};arc.endAngle=function(v){if(!arguments.length){return endAngle}endAngle=d3_functor(v);return arc};arc.centroid=function(){var r=(innerRadius.apply(this,arguments)+outerRadius.apply(this,arguments))/2,a=(startAngle.apply(this,arguments)+endAngle.apply(this,arguments))/2+d3_svg_arcOffset;return[Math.cos(a)*r,Math.sin(a)*r]};return arc};var d3_svg_arcOffset=-π/2,d3_svg_arcMax=2*π-0.000001;function d3_svg_arcInnerRadius(d){return d.innerRadius}function d3_svg_arcOuterRadius(d){return d.outerRadius}function d3_svg_arcStartAngle(d){return d.startAngle}function d3_svg_arcEndAngle(d){return d.endAngle}d3.svg.line.radial=function(){var line=d3_svg_line(d3_svg_lineRadial);line.radius=line.x,delete line.x;line.angle=line.y,delete line.y;return line};function d3_svg_lineRadial(points){var point,i=-1,n=points.length,r,a;while(++i<n){point=points[i];r=point[0];a=point[1]+d3_svg_arcOffset;point[0]=r*Math.cos(a);point[1]=r*Math.sin(a)}return points}function d3_svg_area(projection){var x0=d3_svg_lineX,x1=d3_svg_lineX,y0=0,y1=d3_svg_lineY,defined=d3_true,interpolate=d3_svg_lineLinear,interpolateKey=interpolate.key,interpolateReverse=interpolate,L="L",tension=0.7;function area(data){var segments=[],points0=[],points1=[],i=-1,n=data.length,d,fx0=d3_functor(x0),fy0=d3_functor(y0),fx1=x0===x1?function(){return x}:d3_functor(x1),fy1=y0===y1?function(){return y}:d3_functor(y1),x,y;function segment(){segments.push("M",interpolate(projection(points1),tension),L,interpolateReverse(projection(points0.reverse()),tension),"Z")}while(++i<n){if(defined.call(this,d=data[i],i)){points0.push([x=+fx0.call(this,d,i),y=+fy0.call(this,d,i)]);points1.push([+fx1.call(this,d,i),+fy1.call(this,d,i)])}else{if(points0.length){segment();points0=[];points1=[]}}}if(points0.length){segment()}return segments.length?segments.join(""):null}area.x=function(_){if(!arguments.length){return x1}x0=x1=_;return area};area.x0=function(_){if(!arguments.length){return x0}x0=_;return area};area.x1=function(_){if(!arguments.length){return x1}x1=_;return area};area.y=function(_){if(!arguments.length){return y1}y0=y1=_;return area};area.y0=function(_){if(!arguments.length){return y0}y0=_;return area};area.y1=function(_){if(!arguments.length){return y1}y1=_;return area};area.defined=function(_){if(!arguments.length){return defined}defined=_;return area};area.interpolate=function(_){if(!arguments.length){return interpolateKey}if(typeof _==="function"){interpolateKey=interpolate=_}else{interpolateKey=(interpolate=d3_svg_lineInterpolators.get(_)||d3_svg_lineLinear).key}interpolateReverse=interpolate.reverse||interpolate;L=interpolate.closed?"M":"L";return area};area.tension=function(_){if(!arguments.length){return tension}tension=_;return area};return area}d3_svg_lineStepBefore.reverse=d3_svg_lineStepAfter;d3_svg_lineStepAfter.reverse=d3_svg_lineStepBefore;d3.svg.area=function(){return d3_svg_area(d3_identity)};d3.svg.area.radial=function(){var area=d3_svg_area(d3_svg_lineRadial);area.radius=area.x,delete area.x;area.innerRadius=area.x0,delete area.x0;area.outerRadius=area.x1,delete area.x1;area.angle=area.y,delete area.y;area.startAngle=area.y0,delete area.y0;area.endAngle=area.y1,delete area.y1;return area};d3.svg.chord=function(){var source=d3_source,target=d3_target,radius=d3_svg_chordRadius,startAngle=d3_svg_arcStartAngle,endAngle=d3_svg_arcEndAngle;function chord(d,i){var s=subgroup(this,source,d,i),t=subgroup(this,target,d,i);return"M"+s.p0+arc(s.r,s.p1,s.a1-s.a0)+(equals(s,t)?curve(s.r,s.p1,s.r,s.p0):curve(s.r,s.p1,t.r,t.p0)+arc(t.r,t.p1,t.a1-t.a0)+curve(t.r,t.p1,s.r,s.p0))+"Z"}function subgroup(self,f,d,i){var subgroup=f.call(self,d,i),r=radius.call(self,subgroup,i),a0=startAngle.call(self,subgroup,i)+d3_svg_arcOffset,a1=endAngle.call(self,subgroup,i)+d3_svg_arcOffset;return{r:r,a0:a0,a1:a1,p0:[r*Math.cos(a0),r*Math.sin(a0)],p1:[r*Math.cos(a1),r*Math.sin(a1)]}}function equals(a,b){return a.a0==b.a0&&a.a1==b.a1}function arc(r,p,a){return"A"+r+","+r+" 0 "+ +(a>π)+",1 "+p}function curve(r0,p0,r1,p1){return"Q 0,0 "+p1}chord.radius=function(v){if(!arguments.length){return radius}radius=d3_functor(v);return chord};chord.source=function(v){if(!arguments.length){return source}source=d3_functor(v);return chord};chord.target=function(v){if(!arguments.length){return target}target=d3_functor(v);return chord};chord.startAngle=function(v){if(!arguments.length){return startAngle}startAngle=d3_functor(v);return chord};chord.endAngle=function(v){if(!arguments.length){return endAngle}endAngle=d3_functor(v);return chord};return chord};function d3_svg_chordRadius(d){return d.radius}d3.svg.diagonal=function(){var source=d3_source,target=d3_target,projection=d3_svg_diagonalProjection;function diagonal(d,i){var p0=source.call(this,d,i),p3=target.call(this,d,i),m=(p0.y+p3.y)/2,p=[p0,{x:p0.x,y:m},{x:p3.x,y:m},p3];p=p.map(projection);return"M"+p[0]+"C"+p[1]+" "+p[2]+" "+p[3]}diagonal.source=function(x){if(!arguments.length){return source}source=d3_functor(x);return diagonal};diagonal.target=function(x){if(!arguments.length){return target}target=d3_functor(x);return diagonal};diagonal.projection=function(x){if(!arguments.length){return projection}projection=x;return diagonal};return diagonal};function d3_svg_diagonalProjection(d){return[d.x,d.y]}d3.svg.diagonal.radial=function(){var diagonal=d3.svg.diagonal(),projection=d3_svg_diagonalProjection,projection_=diagonal.projection;diagonal.projection=function(x){return arguments.length?projection_(d3_svg_diagonalRadialProjection(projection=x)):projection};return diagonal};function d3_svg_diagonalRadialProjection(projection){return function(){var d=projection.apply(this,arguments),r=d[0],a=d[1]+d3_svg_arcOffset;return[r*Math.cos(a),r*Math.sin(a)]}}d3.svg.symbol=function(){var type=d3_svg_symbolType,size=d3_svg_symbolSize;function symbol(d,i){return(d3_svg_symbols.get(type.call(this,d,i))||d3_svg_symbolCircle)(size.call(this,d,i))}symbol.type=function(x){if(!arguments.length){return type}type=d3_functor(x);return symbol};symbol.size=function(x){if(!arguments.length){return size}size=d3_functor(x);return symbol};return symbol};function d3_svg_symbolSize(){return 64}function d3_svg_symbolType(){return"circle"}function d3_svg_symbolCircle(size){var r=Math.sqrt(size/π);return"M0,"+r+"A"+r+","+r+" 0 1,1 0,"+-r+"A"+r+","+r+" 0 1,1 0,"+r+"Z"}var d3_svg_symbols=d3.map({circle:d3_svg_symbolCircle,cross:function(size){var r=Math.sqrt(size/5)/2;return"M"+-3*r+","+-r+"H"+-r+"V"+-3*r+"H"+r+"V"+-r+"H"+3*r+"V"+r+"H"+r+"V"+3*r+"H"+-r+"V"+r+"H"+-3*r+"Z"},diamond:function(size){var ry=Math.sqrt(size/(2*d3_svg_symbolTan30)),rx=ry*d3_svg_symbolTan30;return"M0,"+-ry+"L"+rx+",0 0,"+ry+" "+-rx+",0Z"},square:function(size){var r=Math.sqrt(size)/2;return"M"+-r+","+-r+"L"+r+","+-r+" "+r+","+r+" "+-r+","+r+"Z"},"triangle-down":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+ry+"L"+rx+","+-ry+" "+-rx+","+-ry+"Z"},"triangle-up":function(size){var rx=Math.sqrt(size/d3_svg_symbolSqrt3),ry=rx*d3_svg_symbolSqrt3/2;return"M0,"+-ry+"L"+rx+","+ry+" "+-rx+","+ry+"Z"}});d3.svg.symbolTypes=d3_svg_symbols.keys();var d3_svg_symbolSqrt3=Math.sqrt(3),d3_svg_symbolTan30=Math.tan(30*d3_radians);function d3_transition(groups,id){d3_arraySubclass(groups,d3_transitionPrototype);groups.id=id;return groups}var d3_transitionPrototype=[],d3_transitionId=0,d3_transitionInheritId,d3_transitionInherit={ease:d3_ease_cubicInOut,delay:0,duration:250};d3_transitionPrototype.call=d3_selectionPrototype.call;d3_transitionPrototype.empty=d3_selectionPrototype.empty;d3_transitionPrototype.node=d3_selectionPrototype.node;d3.transition=function(selection){return arguments.length?d3_transitionInheritId?selection.transition():selection:d3_selectionRoot.transition()};d3.transition.prototype=d3_transitionPrototype;d3_transitionPrototype.select=function(selector){var id=this.id,subgroups=[],subgroup,subnode,node;if(typeof selector!=="function"){selector=d3_selection_selector(selector)}for(var j=-1,m=this.length;++j<m;){subgroups.push(subgroup=[]);for(var group=this[j],i=-1,n=group.length;++i<n;){if((node=group[i])&&(subnode=selector.call(node,node.__data__,i))){if("__data__" in node){subnode.__data__=node.__data__}d3_transitionNode(subnode,i,id,node.__transition__[id]);subgroup.push(subnode)}else{subgroup.push(null)}}}return d3_transition(subgroups,id)};d3_transitionPrototype.selectAll=function(selector){var id=this.id,subgroups=[],subgroup,subnodes,node,subnode,transition;if(typeof selector!=="function"){selector=d3_selection_selectorAll(selector)}for(var j=-1,m=this.length;++j<m;){for(var group=this[j],i=-1,n=group.length;++i<n;){if(node=group[i]){transition=node.__transition__[id];subnodes=selector.call(node,node.__data__,i);subgroups.push(subgroup=[]);for(var k=-1,o=subnodes.length;++k<o;){d3_transitionNode(subnode=subnodes[k],k,id,transition);subgroup.push(subnode)}}}}return d3_transition(subgroups,id)};d3_transitionPrototype.filter=function(filter){var subgroups=[],subgroup,group,node;if(typeof filter!=="function"){filter=d3_selection_filter(filter)}for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);for(var group=this[j],i=0,n=group.length;i<n;i++){if((node=group[i])&&filter.call(node,node.__data__,i)){subgroup.push(node)}}}return d3_transition(subgroups,this.id,this.time).ease(this.ease())};d3_transitionPrototype.tween=function(name,tween){var id=this.id;if(arguments.length<2){return this.node().__transition__[id].tween.get(name)}return d3_selection_each(this,tween==null?function(node){node.__transition__[id].tween.remove(name)}:function(node){node.__transition__[id].tween.set(name,tween)})};function d3_transition_tween(groups,name,value,tween){var id=groups.id;return d3_selection_each(groups,typeof value==="function"?function(node,i,j){node.__transition__[id].tween.set(name,tween(value.call(node,node.__data__,i,j)))}:(value=tween(value),function(node){node.__transition__[id].tween.set(name,value)}))}d3_transitionPrototype.attr=function(nameNS,value){if(arguments.length<2){for(value in nameNS){this.attr(value,nameNS[value])}return this}var interpolate=d3_interpolateByName(nameNS),name=d3.ns.qualify(nameNS);function attrNull(){this.removeAttribute(name)}function attrNullNS(){this.removeAttributeNS(name.space,name.local)}return d3_transition_tween(this,"attr."+nameNS,value,function(b){function attrString(){var a=this.getAttribute(name),i;return a!==b&&(i=interpolate(a,b),function(t){this.setAttribute(name,i(t))})}function attrStringNS(){var a=this.getAttributeNS(name.space,name.local),i;return a!==b&&(i=interpolate(a,b),function(t){this.setAttributeNS(name.space,name.local,i(t))})}return b==null?name.local?attrNullNS:attrNull:(b+="",name.local?attrStringNS:attrString)})};d3_transitionPrototype.attrTween=function(nameNS,tween){var name=d3.ns.qualify(nameNS);function attrTween(d,i){var f=tween.call(this,d,i,this.getAttribute(name));return f&&function(t){this.setAttribute(name,f(t))}}function attrTweenNS(d,i){var f=tween.call(this,d,i,this.getAttributeNS(name.space,name.local));return f&&function(t){this.setAttributeNS(name.space,name.local,f(t))}}return this.tween("attr."+nameNS,name.local?attrTweenNS:attrTween)};d3_transitionPrototype.style=function(name,value,priority){var n=arguments.length;if(n<3){if(typeof name!=="string"){if(n<2){value=""}for(priority in name){this.style(priority,name[priority],value)}return this}priority=""}var interpolate=d3_interpolateByName(name);function styleNull(){this.style.removeProperty(name)}return d3_transition_tween(this,"style."+name,value,function(b){function styleString(){var a=d3_window.getComputedStyle(this,null).getPropertyValue(name),i;return a!==b&&(i=interpolate(a,b),function(t){this.style.setProperty(name,i(t),priority)})}return b==null?styleNull:(b+="",styleString)})};d3_transitionPrototype.styleTween=function(name,tween,priority){if(arguments.length<3){priority=""}return this.tween("style."+name,function(d,i){var f=tween.call(this,d,i,d3_window.getComputedStyle(this,null).getPropertyValue(name));return f&&function(t){this.style.setProperty(name,f(t),priority)}})};d3_transitionPrototype.text=function(value){return d3_transition_tween(this,"text",value,d3_transition_text)};function d3_transition_text(b){if(b==null){b=""}return function(){this.textContent=b}}d3_transitionPrototype.remove=function(){return this.each("end.transition",function(){var p;if(!this.__transition__&&(p=this.parentNode)){p.removeChild(this)}})};d3_transitionPrototype.ease=function(value){var id=this.id;if(arguments.length<1){return this.node().__transition__[id].ease}if(typeof value!=="function"){value=d3.ease.apply(d3,arguments)}return d3_selection_each(this,function(node){node.__transition__[id].ease=value})};d3_transitionPrototype.delay=function(value){var id=this.id;return d3_selection_each(this,typeof value==="function"?function(node,i,j){node.__transition__[id].delay=value.call(node,node.__data__,i,j)|0}:(value|=0,function(node){node.__transition__[id].delay=value}))};d3_transitionPrototype.duration=function(value){var id=this.id;return d3_selection_each(this,typeof value==="function"?function(node,i,j){node.__transition__[id].duration=Math.max(1,value.call(node,node.__data__,i,j)|0)}:(value=Math.max(1,value|0),function(node){node.__transition__[id].duration=value}))};d3_transitionPrototype.each=function(type,listener){var id=this.id;if(arguments.length<2){var inherit=d3_transitionInherit,inheritId=d3_transitionInheritId;d3_transitionInheritId=id;d3_selection_each(this,function(node,i,j){d3_transitionInherit=node.__transition__[id];type.call(node,node.__data__,i,j)});d3_transitionInherit=inherit;d3_transitionInheritId=inheritId}else{d3_selection_each(this,function(node){node.__transition__[id].event.on(type,listener)})}return this};d3_transitionPrototype.transition=function(){var id0=this.id,id1=++d3_transitionId,subgroups=[],subgroup,group,node,transition;for(var j=0,m=this.length;j<m;j++){subgroups.push(subgroup=[]);for(var group=this[j],i=0,n=group.length;i<n;i++){if(node=group[i]){transition=Object.create(node.__transition__[id0]);transition.delay+=transition.duration;d3_transitionNode(node,i,id1,transition)}subgroup.push(node)}}return d3_transition(subgroups,id1)};function d3_transitionNode(node,i,id,inherit){var lock=node.__transition__||(node.__transition__={active:0,count:0}),transition=lock[id];if(!transition){var time=inherit.time;transition=lock[id]={tween:new d3_Map(),event:d3.dispatch("start","end"),time:time,ease:inherit.ease,delay:inherit.delay,duration:inherit.duration};++lock.count;d3.timer(function(elapsed){var d=node.__data__,ease=transition.ease,event=transition.event,delay=transition.delay,duration=transition.duration,tweened=[];return delay<=elapsed?start(elapsed):d3.timer(start,delay,time),1;function start(elapsed){if(lock.active>id){return stop()}lock.active=id;event.start.call(node,d,i);transition.tween.forEach(function(key,value){if(value=value.call(node,d,i)){tweened.push(value)}});if(!tick(elapsed)){d3.timer(tick,0,time)}return 1}function tick(elapsed){if(lock.active!==id){return stop()}var t=(elapsed-delay)/duration,e=ease(t),n=tweened.length;while(n>0){tweened[--n].call(node,e)}if(t>=1){stop();event.end.call(node,d,i);return 1}}function stop(){if(--lock.count){delete lock[id]}else{delete node.__transition__}return 1}},0,time);return transition}}d3.svg.axis=function(){var scale=d3.scale.linear(),orient=d3_svg_axisDefaultOrient,tickMajorSize=6,tickMinorSize=6,tickEndSize=6,tickPadding=3,tickArguments_=[10],tickValues=null,tickFormat_,tickSubdivide=0;function axis(g){g.each(function(){var g=d3.select(this);var ticks=tickValues==null?scale.ticks?scale.ticks.apply(scale,tickArguments_):scale.domain():tickValues,tickFormat=tickFormat_==null?scale.tickFormat?scale.tickFormat.apply(scale,tickArguments_):String:tickFormat_;var subticks=d3_svg_axisSubdivide(scale,ticks,tickSubdivide),subtick=g.selectAll(".tick.minor").data(subticks,String),subtickEnter=subtick.enter().insert("line",".tick").attr("class","tick minor").style("opacity",0.000001),subtickExit=d3.transition(subtick.exit()).style("opacity",0.000001).remove(),subtickUpdate=d3.transition(subtick).style("opacity",1);var tick=g.selectAll(".tick.major").data(ticks,String),tickEnter=tick.enter().insert("g","path").attr("class","tick major").style("opacity",0.000001),tickExit=d3.transition(tick.exit()).style("opacity",0.000001).remove(),tickUpdate=d3.transition(tick).style("opacity",1),tickTransform;var range=d3_scaleRange(scale),path=g.selectAll(".domain").data([0]),pathUpdate=(path.enter().append("path").attr("class","domain"),d3.transition(path));var scale1=scale.copy(),scale0=this.__chart__||scale1;this.__chart__=scale1;tickEnter.append("line");tickEnter.append("text");var lineEnter=tickEnter.select("line"),lineUpdate=tickUpdate.select("line"),text=tick.select("text").text(tickFormat),textEnter=tickEnter.select("text"),textUpdate=tickUpdate.select("text");switch(orient){case"bottom":tickTransform=d3_svg_axisX;subtickEnter.attr("y2",tickMinorSize);subtickUpdate.attr("x2",0).attr("y2",tickMinorSize);lineEnter.attr("y2",tickMajorSize);textEnter.attr("y",Math.max(tickMajorSize,0)+tickPadding);lineUpdate.attr("x2",0).attr("y2",tickMajorSize);textUpdate.attr("x",0).attr("y",Math.max(tickMajorSize,0)+tickPadding);text.attr("dy",".71em").style("text-anchor","middle");pathUpdate.attr("d","M"+range[0]+","+tickEndSize+"V0H"+range[1]+"V"+tickEndSize);break;case"top":tickTransform=d3_svg_axisX;subtickEnter.attr("y2",-tickMinorSize);subtickUpdate.attr("x2",0).attr("y2",-tickMinorSize);lineEnter.attr("y2",-tickMajorSize);textEnter.attr("y",-(Math.max(tickMajorSize,0)+tickPadding));lineUpdate.attr("x2",0).attr("y2",-tickMajorSize);textUpdate.attr("x",0).attr("y",-(Math.max(tickMajorSize,0)+tickPadding));text.attr("dy","0em").style("text-anchor","middle");pathUpdate.attr("d","M"+range[0]+","+-tickEndSize+"V0H"+range[1]+"V"+-tickEndSize);break;case"left":tickTransform=d3_svg_axisY;subtickEnter.attr("x2",-tickMinorSize);subtickUpdate.attr("x2",-tickMinorSize).attr("y2",0);lineEnter.attr("x2",-tickMajorSize);textEnter.attr("x",-(Math.max(tickMajorSize,0)+tickPadding));lineUpdate.attr("x2",-tickMajorSize).attr("y2",0);textUpdate.attr("x",-(Math.max(tickMajorSize,0)+tickPadding)).attr("y",0);text.attr("dy",".32em").style("text-anchor","end");pathUpdate.attr("d","M"+-tickEndSize+","+range[0]+"H0V"+range[1]+"H"+-tickEndSize);break;case"right":tickTransform=d3_svg_axisY;subtickEnter.attr("x2",tickMinorSize);subtickUpdate.attr("x2",tickMinorSize).attr("y2",0);lineEnter.attr("x2",tickMajorSize);textEnter.attr("x",Math.max(tickMajorSize,0)+tickPadding);lineUpdate.attr("x2",tickMajorSize).attr("y2",0);textUpdate.attr("x",Math.max(tickMajorSize,0)+tickPadding).attr("y",0);text.attr("dy",".32em").style("text-anchor","start");pathUpdate.attr("d","M"+tickEndSize+","+range[0]+"H0V"+range[1]+"H"+tickEndSize);break}if(scale.ticks){tickEnter.call(tickTransform,scale0);tickUpdate.call(tickTransform,scale1);tickExit.call(tickTransform,scale1);subtickEnter.call(tickTransform,scale0);subtickUpdate.call(tickTransform,scale1);subtickExit.call(tickTransform,scale1)}else{var dx=scale1.rangeBand()/2,x=function(d){return scale1(d)+dx};tickEnter.call(tickTransform,x);tickUpdate.call(tickTransform,x)}})}axis.scale=function(x){if(!arguments.length){return scale}scale=x;return axis};axis.orient=function(x){if(!arguments.length){return orient}orient=x in d3_svg_axisOrients?x+"":d3_svg_axisDefaultOrient;return axis};axis.ticks=function(){if(!arguments.length){return tickArguments_}tickArguments_=arguments;return axis};axis.tickValues=function(x){if(!arguments.length){return tickValues}tickValues=x;return axis};axis.tickFormat=function(x){if(!arguments.length){return tickFormat_}tickFormat_=x;return axis};axis.tickSize=function(x,y){if(!arguments.length){return tickMajorSize}var n=arguments.length-1;tickMajorSize=+x;tickMinorSize=n>1?+y:tickMajorSize;tickEndSize=n>0?+arguments[n]:tickMajorSize;return axis};axis.tickPadding=function(x){if(!arguments.length){return tickPadding}tickPadding=+x;return axis};axis.tickSubdivide=function(x){if(!arguments.length){return tickSubdivide}tickSubdivide=+x;return axis};return axis};var d3_svg_axisDefaultOrient="bottom",d3_svg_axisOrients={top:1,right:1,bottom:1,left:1};function d3_svg_axisX(selection,x){selection.attr("transform",function(d){return"translate("+x(d)+",0)"})}function d3_svg_axisY(selection,y){selection.attr("transform",function(d){return"translate(0,"+y(d)+")"})}function d3_svg_axisSubdivide(scale,ticks,m){subticks=[];if(m&&ticks.length>1){var extent=d3_scaleExtent(scale.domain()),subticks,i=-1,n=ticks.length,d=(ticks[1]-ticks[0])/++m,j,v;while(++i<n){for(j=m;--j>0;){if((v=+ticks[i]-j*d)>=extent[0]){subticks.push(v)}}}for(--i,j=0;++j<m&&(v=+ticks[i]+j*d)<extent[1];){subticks.push(v)}}return subticks}d3.svg.brush=function(){var event=d3_eventDispatch(brush,"brushstart","brush","brushend"),x=null,y=null,resizes=d3_svg_brushResizes[0],extent=[[0,0],[0,0]],extentDomain;function brush(g){g.each(function(){var g=d3.select(this),bg=g.selectAll(".background").data([0]),fg=g.selectAll(".extent").data([0]),tz=g.selectAll(".resize").data(resizes,String),e;g.style("pointer-events","all").on("mousedown.brush",brushstart).on("touchstart.brush",brushstart);bg.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");fg.enter().append("rect").attr("class","extent").style("cursor","move");tz.enter().append("g").attr("class",function(d){return"resize "+d}).style("cursor",function(d){return d3_svg_brushCursor[d]}).append("rect").attr("x",function(d){return/[ew]$/.test(d)?-3:null}).attr("y",function(d){return/^[ns]/.test(d)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");tz.style("display",brush.empty()?"none":null);tz.exit().remove();if(x){e=d3_scaleRange(x);bg.attr("x",e[0]).attr("width",e[1]-e[0]);redrawX(g)}if(y){e=d3_scaleRange(y);bg.attr("y",e[0]).attr("height",e[1]-e[0]);redrawY(g)}redraw(g)})}function redraw(g){g.selectAll(".resize").attr("transform",function(d){return"translate("+extent[+/e$/.test(d)][0]+","+extent[+/^s/.test(d)][1]+")"})}function redrawX(g){g.select(".extent").attr("x",extent[0][0]);g.selectAll(".extent,.n>rect,.s>rect").attr("width",extent[1][0]-extent[0][0])}function redrawY(g){g.select(".extent").attr("y",extent[0][1]);g.selectAll(".extent,.e>rect,.w>rect").attr("height",extent[1][1]-extent[0][1])}function brushstart(){var target=this,eventTarget=d3.select(d3.event.target),event_=event.of(target,arguments),g=d3.select(target),resizing=eventTarget.datum(),resizingX=!/^(n|s)$/.test(resizing)&&x,resizingY=!/^(e|w)$/.test(resizing)&&y,dragging=eventTarget.classed("extent"),center,origin=mouse(),offset;var w=d3.select(d3_window).on("mousemove.brush",brushmove).on("mouseup.brush",brushend).on("touchmove.brush",brushmove).on("touchend.brush",brushend).on("keydown.brush",keydown).on("keyup.brush",keyup);if(dragging){origin[0]=extent[0][0]-origin[0];origin[1]=extent[0][1]-origin[1]}else{if(resizing){var ex=+/w$/.test(resizing),ey=+/^n/.test(resizing);offset=[extent[1-ex][0]-origin[0],extent[1-ey][1]-origin[1]];origin[0]=extent[ex][0];origin[1]=extent[ey][1]}else{if(d3.event.altKey){center=origin.slice()}}}g.style("pointer-events","none").selectAll(".resize").style("display",null);d3.select("body").style("cursor",eventTarget.style("cursor"));event_({type:"brushstart"});brushmove();d3_eventCancel();function mouse(){var touches=d3.event.changedTouches;return touches?d3.touches(target,touches)[0]:d3.mouse(target)}function keydown(){if(d3.event.keyCode==32){if(!dragging){center=null;origin[0]-=extent[1][0];origin[1]-=extent[1][1];dragging=2}d3_eventCancel()}}function keyup(){if(d3.event.keyCode==32&&dragging==2){origin[0]+=extent[1][0];origin[1]+=extent[1][1];dragging=0;d3_eventCancel()}}function brushmove(){var point=mouse(),moved=false;if(offset){point[0]+=offset[0];point[1]+=offset[1]}if(!dragging){if(d3.event.altKey){if(!center){center=[(extent[0][0]+extent[1][0])/2,(extent[0][1]+extent[1][1])/2]}origin[0]=extent[+(point[0]<center[0])][0];origin[1]=extent[+(point[1]<center[1])][1]}else{center=null}}if(resizingX&&move1(point,x,0)){redrawX(g);moved=true}if(resizingY&&move1(point,y,1)){redrawY(g);moved=true}if(moved){redraw(g);event_({type:"brush",mode:dragging?"move":"resize"})}}function move1(point,scale,i){var range=d3_scaleRange(scale),r0=range[0],r1=range[1],position=origin[i],size=extent[1][i]-extent[0][i],min,max;if(dragging){r0-=position;r1-=size+position}min=Math.max(r0,Math.min(r1,point[i]));if(dragging){max=(min+=position)+size}else{if(center){position=Math.max(r0,Math.min(r1,2*center[i]-min))}if(position<min){max=min;min=position}else{max=position}}if(extent[0][i]!==min||extent[1][i]!==max){extentDomain=null;extent[0][i]=min;extent[1][i]=max;return true}}function brushend(){brushmove();g.style("pointer-events","all").selectAll(".resize").style("display",brush.empty()?"none":null);d3.select("body").style("cursor",null);w.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);event_({type:"brushend"});d3_eventCancel()}}brush.x=function(z){if(!arguments.length){return x}x=z;resizes=d3_svg_brushResizes[!x<<1|!y];return brush};brush.y=function(z){if(!arguments.length){return y}y=z;resizes=d3_svg_brushResizes[!x<<1|!y];return brush};brush.extent=function(z){var x0,x1,y0,y1,t;if(!arguments.length){z=extentDomain||extent;if(x){x0=z[0][0],x1=z[1][0];if(!extentDomain){x0=extent[0][0],x1=extent[1][0];if(x.invert){x0=x.invert(x0),x1=x.invert(x1)}if(x1<x0){t=x0,x0=x1,x1=t}}}if(y){y0=z[0][1],y1=z[1][1];if(!extentDomain){y0=extent[0][1],y1=extent[1][1];if(y.invert){y0=y.invert(y0),y1=y.invert(y1)}if(y1<y0){t=y0,y0=y1,y1=t}}}return x&&y?[[x0,y0],[x1,y1]]:x?[x0,x1]:y&&[y0,y1]}extentDomain=[[0,0],[0,0]];if(x){x0=z[0],x1=z[1];if(y){x0=x0[0],x1=x1[0]}extentDomain[0][0]=x0,extentDomain[1][0]=x1;if(x.invert){x0=x(x0),x1=x(x1)}if(x1<x0){t=x0,x0=x1,x1=t}extent[0][0]=x0|0,extent[1][0]=x1|0}if(y){y0=z[0],y1=z[1];if(x){y0=y0[1],y1=y1[1]}extentDomain[0][1]=y0,extentDomain[1][1]=y1;if(y.invert){y0=y(y0),y1=y(y1)}if(y1<y0){t=y0,y0=y1,y1=t}extent[0][1]=y0|0,extent[1][1]=y1|0}return brush};brush.clear=function(){extentDomain=null;extent[0][0]=extent[0][1]=extent[1][0]=extent[1][1]=0;return brush};brush.empty=function(){return x&&extent[0][0]===extent[1][0]||y&&extent[0][1]===extent[1][1]};return d3.rebind(brush,event,"on")};var d3_svg_brushCursor={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};var d3_svg_brushResizes=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.time={};var d3_time=Date,d3_time_daySymbols=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function d3_time_utc(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}d3_time_utc.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){d3_time_prototype.setUTCDate.apply(this._,arguments)},setDay:function(){d3_time_prototype.setUTCDay.apply(this._,arguments)},setFullYear:function(){d3_time_prototype.setUTCFullYear.apply(this._,arguments)},setHours:function(){d3_time_prototype.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){d3_time_prototype.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){d3_time_prototype.setUTCMinutes.apply(this._,arguments)},setMonth:function(){d3_time_prototype.setUTCMonth.apply(this._,arguments)},setSeconds:function(){d3_time_prototype.setUTCSeconds.apply(this._,arguments)},setTime:function(){d3_time_prototype.setTime.apply(this._,arguments)}};var d3_time_prototype=Date.prototype;var d3_time_formatDateTime="%a %b %e %X %Y",d3_time_formatDate="%m/%d/%Y",d3_time_formatTime="%H:%M:%S";var d3_time_days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d3_time_dayAbbreviations=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d3_time_months=["January","February","March","April","May","June","July","August","September","October","November","December"],d3_time_monthAbbreviations=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function d3_time_interval(local,step,number){function round(date){var d0=local(date),d1=offset(d0,1);return date-d0<d1-date?d0:d1}function ceil(date){step(date=local(new d3_time(date-1)),1);return date}function offset(date,k){step(date=new d3_time(+date),k);return date}function range(t0,t1,dt){var time=ceil(t0),times=[];if(dt>1){while(time<t1){if(!(number(time)%dt)){times.push(new Date(+time))}step(time,1)}}else{while(time<t1){times.push(new Date(+time)),step(time,1)}}return times}function range_utc(t0,t1,dt){try{d3_time=d3_time_utc;var utc=new d3_time_utc();utc._=t0;return range(utc,t1,dt)}finally{d3_time=Date}}local.floor=local;local.round=round;local.ceil=ceil;local.offset=offset;local.range=range;var utc=local.utc=d3_time_interval_utc(local);utc.floor=utc;utc.round=d3_time_interval_utc(round);utc.ceil=d3_time_interval_utc(ceil);utc.offset=d3_time_interval_utc(offset);utc.range=range_utc;return local}function d3_time_interval_utc(method){return function(date,k){try{d3_time=d3_time_utc;var utc=new d3_time_utc();utc._=date;return method(utc,k)._}finally{d3_time=Date}}}d3.time.year=d3_time_interval(function(date){date=d3.time.day(date);date.setMonth(0,1);return date},function(date,offset){date.setFullYear(date.getFullYear()+offset)},function(date){return date.getFullYear()});d3.time.years=d3.time.year.range;d3.time.years.utc=d3.time.year.utc.range;d3.time.day=d3_time_interval(function(date){var day=new d3_time(1970,0);day.setFullYear(date.getFullYear(),date.getMonth(),date.getDate());return day},function(date,offset){date.setDate(date.getDate()+offset)},function(date){return date.getDate()-1});d3.time.days=d3.time.day.range;d3.time.days.utc=d3.time.day.utc.range;d3.time.dayOfYear=function(date){var year=d3.time.year(date);return Math.floor((date-year-(date.getTimezoneOffset()-year.getTimezoneOffset())*60000)/86400000)};d3_time_daySymbols.forEach(function(day,i){day=day.toLowerCase();i=7-i;var interval=d3.time[day]=d3_time_interval(function(date){(date=d3.time.day(date)).setDate(date.getDate()-(date.getDay()+i)%7);return date},function(date,offset){date.setDate(date.getDate()+Math.floor(offset)*7)},function(date){var day=d3.time.year(date).getDay();return Math.floor((d3.time.dayOfYear(date)+(day+i)%7)/7)-(day!==i)});d3.time[day+"s"]=interval.range;d3.time[day+"s"].utc=interval.utc.range;d3.time[day+"OfYear"]=function(date){var day=d3.time.year(date).getDay();return Math.floor((d3.time.dayOfYear(date)+(day+i)%7)/7)}});d3.time.week=d3.time.sunday;d3.time.weeks=d3.time.sunday.range;d3.time.weeks.utc=d3.time.sunday.utc.range;d3.time.weekOfYear=d3.time.sundayOfYear;d3.time.format=function(template){var n=template.length;function format(date){var string=[],i=-1,j=0,c,p,f;while(++i<n){if(template.charCodeAt(i)===37){string.push(template.substring(j,i));if((p=d3_time_formatPads[c=template.charAt(++i)])!=null){c=template.charAt(++i)}if(f=d3_time_formats[c]){c=f(date,p==null?c==="e"?" ":"0":p)}string.push(c);j=i+1}}string.push(template.substring(j,i));return string.join("")}format.parse=function(string){var d={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},i=d3_time_parse(d,template,string,0);if(i!=string.length){return null}if("p" in d){d.H=d.H%12+d.p*12}var date=new d3_time();date.setFullYear(d.y,d.m,d.d);date.setHours(d.H,d.M,d.S,d.L);return date};format.toString=function(){return template};return format};function d3_time_parse(date,template,string,j){var c,p,i=0,n=template.length,m=string.length;while(i<n){if(j>=m){return -1}c=template.charCodeAt(i++);if(c===37){p=d3_time_parsers[template.charAt(i++)];if(!p||(j=p(date,string,j))<0){return -1}}else{if(c!=string.charCodeAt(j++)){return -1}}}return j}function d3_time_formatRe(names){return new RegExp("^(?:"+names.map(d3.requote).join("|")+")","i")}function d3_time_formatLookup(names){var map=new d3_Map(),i=-1,n=names.length;while(++i<n){map.set(names[i].toLowerCase(),i)}return map}function d3_time_formatPad(value,fill,width){value+="";var length=value.length;return length<width?new Array(width-length+1).join(fill)+value:value}var d3_time_dayRe=d3_time_formatRe(d3_time_days),d3_time_dayAbbrevRe=d3_time_formatRe(d3_time_dayAbbreviations),d3_time_monthRe=d3_time_formatRe(d3_time_months),d3_time_monthLookup=d3_time_formatLookup(d3_time_months),d3_time_monthAbbrevRe=d3_time_formatRe(d3_time_monthAbbreviations),d3_time_monthAbbrevLookup=d3_time_formatLookup(d3_time_monthAbbreviations);var d3_time_formatPads={"-":"",_:" ","0":"0"};var d3_time_formats={a:function(d){return d3_time_dayAbbreviations[d.getDay()]},A:function(d){return d3_time_days[d.getDay()]},b:function(d){return d3_time_monthAbbreviations[d.getMonth()]},B:function(d){return d3_time_months[d.getMonth()]},c:d3.time.format(d3_time_formatDateTime),d:function(d,p){return d3_time_formatPad(d.getDate(),p,2)},e:function(d,p){return d3_time_formatPad(d.getDate(),p,2)},H:function(d,p){return d3_time_formatPad(d.getHours(),p,2)},I:function(d,p){return d3_time_formatPad(d.getHours()%12||12,p,2)},j:function(d,p){return d3_time_formatPad(1+d3.time.dayOfYear(d),p,3)},L:function(d,p){return d3_time_formatPad(d.getMilliseconds(),p,3)},m:function(d,p){return d3_time_formatPad(d.getMonth()+1,p,2)},M:function(d,p){return d3_time_formatPad(d.getMinutes(),p,2)},p:function(d){return d.getHours()>=12?"PM":"AM"},S:function(d,p){return d3_time_formatPad(d.getSeconds(),p,2)},U:function(d,p){return d3_time_formatPad(d3.time.sundayOfYear(d),p,2)},w:function(d){return d.getDay()},W:function(d,p){return d3_time_formatPad(d3.time.mondayOfYear(d),p,2)},x:d3.time.format(d3_time_formatDate),X:d3.time.format(d3_time_formatTime),y:function(d,p){return d3_time_formatPad(d.getFullYear()%100,p,2)},Y:function(d,p){return d3_time_formatPad(d.getFullYear()%10000,p,4)},Z:d3_time_zone,"%":function(){return"%"}};var d3_time_parsers={a:d3_time_parseWeekdayAbbrev,A:d3_time_parseWeekday,b:d3_time_parseMonthAbbrev,B:d3_time_parseMonth,c:d3_time_parseLocaleFull,d:d3_time_parseDay,e:d3_time_parseDay,H:d3_time_parseHour24,I:d3_time_parseHour24,L:d3_time_parseMilliseconds,m:d3_time_parseMonthNumber,M:d3_time_parseMinutes,p:d3_time_parseAmPm,S:d3_time_parseSeconds,x:d3_time_parseLocaleDate,X:d3_time_parseLocaleTime,y:d3_time_parseYear,Y:d3_time_parseFullYear};function d3_time_parseWeekdayAbbrev(date,string,i){d3_time_dayAbbrevRe.lastIndex=0;var n=d3_time_dayAbbrevRe.exec(string.substring(i));return n?i+=n[0].length:-1}function d3_time_parseWeekday(date,string,i){d3_time_dayRe.lastIndex=0;var n=d3_time_dayRe.exec(string.substring(i));return n?i+=n[0].length:-1}function d3_time_parseMonthAbbrev(date,string,i){d3_time_monthAbbrevRe.lastIndex=0;var n=d3_time_monthAbbrevRe.exec(string.substring(i));return n?(date.m=d3_time_monthAbbrevLookup.get(n[0].toLowerCase()),i+=n[0].length):-1}function d3_time_parseMonth(date,string,i){d3_time_monthRe.lastIndex=0;var n=d3_time_monthRe.exec(string.substring(i));return n?(date.m=d3_time_monthLookup.get(n[0].toLowerCase()),i+=n[0].length):-1}function d3_time_parseLocaleFull(date,string,i){return d3_time_parse(date,d3_time_formats.c.toString(),string,i)}function d3_time_parseLocaleDate(date,string,i){return d3_time_parse(date,d3_time_formats.x.toString(),string,i)}function d3_time_parseLocaleTime(date,string,i){return d3_time_parse(date,d3_time_formats.X.toString(),string,i)}function d3_time_parseFullYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+4));return n?(date.y=+n[0],i+=n[0].length):-1}function d3_time_parseYear(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.y=d3_time_expandYear(+n[0]),i+=n[0].length):-1}function d3_time_expandYear(d){return d+(d>68?1900:2000)}function d3_time_parseMonthNumber(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.m=n[0]-1,i+=n[0].length):-1}function d3_time_parseDay(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.d=+n[0],i+=n[0].length):-1}function d3_time_parseHour24(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.H=+n[0],i+=n[0].length):-1}function d3_time_parseMinutes(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.M=+n[0],i+=n[0].length):-1}function d3_time_parseSeconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+2));return n?(date.S=+n[0],i+=n[0].length):-1}function d3_time_parseMilliseconds(date,string,i){d3_time_numberRe.lastIndex=0;var n=d3_time_numberRe.exec(string.substring(i,i+3));return n?(date.L=+n[0],i+=n[0].length):-1}var d3_time_numberRe=/^\s*\d+/;function d3_time_parseAmPm(date,string,i){var n=d3_time_amPmLookup.get(string.substring(i,i+=2).toLowerCase());return n==null?-1:(date.p=n,i)}var d3_time_amPmLookup=d3.map({am:0,pm:1});function d3_time_zone(d){var z=d.getTimezoneOffset(),zs=z>0?"-":"+",zh=~~(Math.abs(z)/60),zm=Math.abs(z)%60;return zs+d3_time_formatPad(zh,"0",2)+d3_time_formatPad(zm,"0",2)}d3.time.format.utc=function(template){var local=d3.time.format(template);function format(date){try{d3_time=d3_time_utc;var utc=new d3_time();utc._=date;return local(utc)}finally{d3_time=Date}}format.parse=function(string){try{d3_time=d3_time_utc;var date=local.parse(string);return date&&date._}finally{d3_time=Date}};format.toString=local.toString;return format};var d3_time_formatIso=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?d3_time_formatIsoNative:d3_time_formatIso;function d3_time_formatIsoNative(date){return date.toISOString()}d3_time_formatIsoNative.parse=function(string){var date=new Date(string);return isNaN(date)?null:date};d3_time_formatIsoNative.toString=d3_time_formatIso.toString;d3.time.second=d3_time_interval(function(date){return new d3_time(Math.floor(date/1000)*1000)},function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*1000)},function(date){return date.getSeconds()});d3.time.seconds=d3.time.second.range;d3.time.seconds.utc=d3.time.second.utc.range;d3.time.minute=d3_time_interval(function(date){return new d3_time(Math.floor(date/60000)*60000)},function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*60000)},function(date){return date.getMinutes()});d3.time.minutes=d3.time.minute.range;d3.time.minutes.utc=d3.time.minute.utc.range;d3.time.hour=d3_time_interval(function(date){var timezone=date.getTimezoneOffset()/60;return new d3_time((Math.floor(date/3600000-timezone)+timezone)*3600000)},function(date,offset){date.setTime(date.getTime()+Math.floor(offset)*3600000)},function(date){return date.getHours()});d3.time.hours=d3.time.hour.range;d3.time.hours.utc=d3.time.hour.utc.range;d3.time.month=d3_time_interval(function(date){date=d3.time.day(date);date.setDate(1);return date},function(date,offset){date.setMonth(date.getMonth()+offset)},function(date){return date.getMonth()});d3.time.months=d3.time.month.range;d3.time.months.utc=d3.time.month.utc.range;function d3_time_scale(linear,methods,format){function scale(x){return linear(x)}scale.invert=function(x){return d3_time_scaleDate(linear.invert(x))};scale.domain=function(x){if(!arguments.length){return linear.domain().map(d3_time_scaleDate)}linear.domain(x);return scale};scale.nice=function(m){return scale.domain(d3_scale_nice(scale.domain(),function(){return m}))};scale.ticks=function(m,k){var extent=d3_time_scaleExtent(scale.domain());if(typeof m!=="function"){var span=extent[1]-extent[0],target=span/m,i=d3.bisect(d3_time_scaleSteps,target);if(i==d3_time_scaleSteps.length){return methods.year(extent,m)}if(!i){return linear.ticks(m).map(d3_time_scaleDate)}if(Math.log(target/d3_time_scaleSteps[i-1])<Math.log(d3_time_scaleSteps[i]/target)){--i}m=methods[i];k=m[1];m=m[0].range}return m(extent[0],new Date(+extent[1]+1),k)};scale.tickFormat=function(){return format};scale.copy=function(){return d3_time_scale(linear.copy(),methods,format)};return d3.rebind(scale,linear,"range","rangeRound","interpolate","clamp")}function d3_time_scaleExtent(domain){var start=domain[0],stop=domain[domain.length-1];return start<stop?[start,stop]:[stop,start]}function d3_time_scaleDate(t){return new Date(t)}function d3_time_scaleFormat(formats){return function(date){var i=formats.length-1,f=formats[i];while(!f[1](date)){f=formats[--i]}return f[0](date)}}function d3_time_scaleSetYear(y){var d=new Date(y,0,1);d.setFullYear(y);return d}function d3_time_scaleGetYear(d){var y=d.getFullYear(),d0=d3_time_scaleSetYear(y),d1=d3_time_scaleSetYear(y+1);return y+(d-d0)/(d1-d0)}var d3_time_scaleSteps=[1000,5000,15000,30000,60000,300000,900000,1800000,3600000,10800000,21600000,43200000,86400000,172800000,604800000,2592000000,7776000000,31536000000];var d3_time_scaleLocalMethods=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]];var d3_time_scaleLocalFormats=[[d3.time.format("%Y"),d3_true],[d3.time.format("%B"),function(d){return d.getMonth()}],[d3.time.format("%b %d"),function(d){return d.getDate()!=1}],[d3.time.format("%a %d"),function(d){return d.getDay()&&d.getDate()!=1}],[d3.time.format("%I %p"),function(d){return d.getHours()}],[d3.time.format("%I:%M"),function(d){return d.getMinutes()}],[d3.time.format(":%S"),function(d){return d.getSeconds()}],[d3.time.format(".%L"),function(d){return d.getMilliseconds()}]];var d3_time_scaleLinear=d3.scale.linear(),d3_time_scaleLocalFormat=d3_time_scaleFormat(d3_time_scaleLocalFormats);d3_time_scaleLocalMethods.year=function(extent,m){return d3_time_scaleLinear.domain(extent.map(d3_time_scaleGetYear)).ticks(m).map(d3_time_scaleSetYear)};d3.time.scale=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleLocalMethods,d3_time_scaleLocalFormat)};var d3_time_scaleUTCMethods=d3_time_scaleLocalMethods.map(function(m){return[m[0].utc,m[1]]});var d3_time_scaleUTCFormats=[[d3.time.format.utc("%Y"),d3_true],[d3.time.format.utc("%B"),function(d){return d.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(d){return d.getUTCDate()!=1}],[d3.time.format.utc("%a %d"),function(d){return d.getUTCDay()&&d.getUTCDate()!=1}],[d3.time.format.utc("%I %p"),function(d){return d.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(d){return d.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(d){return d.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(d){return d.getUTCMilliseconds()}]];var d3_time_scaleUTCFormat=d3_time_scaleFormat(d3_time_scaleUTCFormats);function d3_time_scaleUTCSetYear(y){var d=new Date(Date.UTC(y,0,1));d.setUTCFullYear(y);return d}function d3_time_scaleUTCGetYear(d){var y=d.getUTCFullYear(),d0=d3_time_scaleUTCSetYear(y),d1=d3_time_scaleUTCSetYear(y+1);return y+(d-d0)/(d1-d0)}d3_time_scaleUTCMethods.year=function(extent,m){return d3_time_scaleLinear.domain(extent.map(d3_time_scaleUTCGetYear)).ticks(m).map(d3_time_scaleUTCSetYear)};d3.time.scale.utc=function(){return d3_time_scale(d3.scale.linear(),d3_time_scaleUTCMethods,d3_time_scaleUTCFormat)};d3.text=function(){return d3.xhr.apply(d3,arguments).response(d3_text)};function d3_text(request){return request.responseText}d3.json=function(url,callback){return d3.xhr(url,"application/json",callback).response(d3_json)};function d3_json(request){return JSON.parse(request.responseText)}d3.html=function(url,callback){return d3.xhr(url,"text/html",callback).response(d3_html)};function d3_html(request){var range=d3_document.createRange();range.selectNode(d3_document.body);return range.createContextualFragment(request.responseText)}d3.xml=function(){return d3.xhr.apply(d3,arguments).response(d3_xml)};function d3_xml(request){return request.responseXML}return d3}();(function(){d3.fisheye={scale:function(scaleType){return d3_fisheye_scale(scaleType(),3,0)},circular:function(){var radius=200,distortion=2,k0,k1,focus=[0,0];function fisheye(d){var dx=d.x-focus[0],dy=d.y-focus[1],dd=Math.sqrt(dx*dx+dy*dy);if(!dd||dd>=radius){return{x:d.x,y:d.y,z:1}}var k=k0*(1-Math.exp(-dd*k1))/dd*0.75+0.25;return{x:focus[0]+dx*k,y:focus[1]+dy*k,z:Math.min(k,10)}}function rescale(){k0=Math.exp(distortion);k0=k0/(k0-1)*radius;k1=distortion/radius;return fisheye}fisheye.radius=function(_){if(!arguments.length){return radius}radius=+_;return rescale()};fisheye.distortion=function(_){if(!arguments.length){return distortion}distortion=+_;return rescale()};fisheye.focus=function(_){if(!arguments.length){return focus}focus=_;return fisheye};return rescale()}};function d3_fisheye_scale(scale,d,a){function fisheye(_){var x=scale(_),left=x<a,v,range=d3.extent(scale.range()),min=range[0],max=range[1],m=left?a-min:max-a;if(m==0){m=max-min}return(left?-1:1)*m*(d+1)/(d+(m/Math.abs(x-a)))+a}fisheye.distortion=function(_){if(!arguments.length){return d}d=+_;return fisheye};fisheye.focus=function(_){if(!arguments.length){return a}a=+_;return fisheye};fisheye.copy=function(){return d3_fisheye_scale(scale.copy(),d,a)};fisheye.nice=scale.nice;fisheye.ticks=scale.ticks;fisheye.tickFormat=scale.tickFormat;return d3.rebind(fisheye,scale,"domain","range")}})();d3.hive={};d3.hive.link=function(){var source=function(d){return d.source},target=function(d){return d.target},angle=function(d){return d.angle},startRadius=function(d){return d.radius},endRadius=startRadius,arcOffset=-Math.PI/2;function link(d,i){var s=node(source,this,d,i),t=node(target,this,d,i),x;if(t.a<s.a){x=t,t=s,s=x}if(t.a-s.a>Math.PI){s.a+=2*Math.PI}var a1=s.a+(t.a-s.a)/3,a2=t.a-(t.a-s.a)/3;return s.r0-s.r1||t.r0-t.r1?"M"+Math.cos(s.a)*s.r0+","+Math.sin(s.a)*s.r0+"L"+Math.cos(s.a)*s.r1+","+Math.sin(s.a)*s.r1+"C"+Math.cos(a1)*s.r1+","+Math.sin(a1)*s.r1+" "+Math.cos(a2)*t.r1+","+Math.sin(a2)*t.r1+" "+Math.cos(t.a)*t.r1+","+Math.sin(t.a)*t.r1+"L"+Math.cos(t.a)*t.r0+","+Math.sin(t.a)*t.r0+"C"+Math.cos(a2)*t.r0+","+Math.sin(a2)*t.r0+" "+Math.cos(a1)*s.r0+","+Math.sin(a1)*s.r0+" "+Math.cos(s.a)*s.r0+","+Math.sin(s.a)*s.r0:"M"+Math.cos(s.a)*s.r0+","+Math.sin(s.a)*s.r0+"C"+Math.cos(a1)*s.r1+","+Math.sin(a1)*s.r1+" "+Math.cos(a2)*t.r1+","+Math.sin(a2)*t.r1+" "+Math.cos(t.a)*t.r1+","+Math.sin(t.a)*t.r1}function node(method,thiz,d,i){var node=method.call(thiz,d,i),a=+(typeof angle==="function"?angle.call(thiz,node,i):angle)+arcOffset,r0=+(typeof startRadius==="function"?startRadius.call(thiz,node,i):startRadius),r1=(startRadius===endRadius?r0:+(typeof endRadius==="function"?endRadius.call(thiz,node,i):endRadius));return{r0:r0,r1:r1,a:a}}link.source=function(_){if(!arguments.length){return source}source=_;return link};link.target=function(_){if(!arguments.length){return target}target=_;return link};link.angle=function(_){if(!arguments.length){return angle}angle=_;return link};link.radius=function(_){if(!arguments.length){return startRadius}startRadius=endRadius=_;return link};link.startRadius=function(_){if(!arguments.length){return startRadius}startRadius=_;return link};link.endRadius=function(_){if(!arguments.length){return endRadius}endRadius=_;return link};return link};(function(){d3.horizon=function(){var bands=1,mode="offset",interpolate="linear",x=d3_horizonX,y=d3_horizonY,w=960,h=40,duration=0;var color=d3.scale.linear().domain([-1,0,1]).range(["#d62728","#fff","#1f77b4"]);function horizon(g){g.each(function(d,i){var g=d3.select(this),n=2*bands+1,xMin=Infinity,xMax=-Infinity,yMax=-Infinity,x0,y0,id;var data=d.map(function(d,i){var xv=x.call(this,d,i),yv=y.call(this,d,i);if(xv<xMin){xMin=xv}if(xv>xMax){xMax=xv}if(-yv>yMax){yMax=-yv}if(yv>yMax){yMax=yv}return[xv,yv]});var x1=d3.scale.linear().domain([xMin,xMax]).range([0,w]),y1=d3.scale.linear().domain([0,yMax]).range([0,h*bands]),t1=d3_horizonTransform(bands,h,mode);if(this.__chart__){x0=this.__chart__.x;y0=this.__chart__.y;t0=this.__chart__.t;id=this.__chart__.id}else{x0=x1.copy();y0=y1.copy();t0=t1;id=++d3_horizonId}var defs=g.selectAll("defs").data([null]);defs.enter().append("defs").append("clipPath").attr("id","d3_horizon_clip"+id).append("rect").attr("width",w).attr("height",h);defs.select("rect").transition().duration(duration).attr("width",w).attr("height",h);g.selectAll("g").data([null]).enter().append("g").attr("clip-path","url(#d3_horizon_clip"+id+")");var path=g.select("g").selectAll("path").data(d3.range(-1,-bands-1,-1).concat(d3.range(1,bands+1)),Number);var d0=d3_horizonArea.interpolate(interpolate).x(function(d){return x0(d[0])}).y0(h*bands).y1(function(d){return h*bands-y0(d[1])})(data);var d1=d3_horizonArea.x(function(d){return x1(d[0])}).y1(function(d){return h*bands-y1(d[1])})(data);path.enter().append("path").style("fill",color).attr("transform",t0).attr("d",d0);path.transition().duration(duration).style("fill",color).attr("transform",t1).attr("d",d1);path.exit().transition().duration(duration).attr("transform",t1).attr("d",d1).remove();this.__chart__={x:x1,y:y1,t:t1,id:id}});d3.timer.flush()}horizon.duration=function(x){if(!arguments.length){return duration}duration=+x;return horizon};horizon.bands=function(x){if(!arguments.length){return bands}bands=+x;color.domain([-bands,0,bands]);return horizon};horizon.mode=function(x){if(!arguments.length){return mode}mode=x+"";return horizon};horizon.colors=function(x){if(!arguments.length){return color.range()}color.range(x);return horizon};horizon.interpolate=function(x){if(!arguments.length){return interpolate}interpolate=x+"";return horizon};horizon.x=function(z){if(!arguments.length){return x}x=z;return horizon};horizon.y=function(z){if(!arguments.length){return y}y=z;return horizon};horizon.width=function(x){if(!arguments.length){return w}w=+x;return horizon};horizon.height=function(x){if(!arguments.length){return h}h=+x;return horizon};return horizon};var d3_horizonArea=d3.svg.area(),d3_horizonId=0;function d3_horizonX(d){return d[0]}function d3_horizonY(d){return d[1]}function d3_horizonTransform(bands,h,mode){return mode=="offset"?function(d){return"translate(0,"+(d+(d<0)-bands)*h+")"}:function(d){return(d<0?"scale(1,-1)":"")+"translate(0,"+(d-bands)*h+")"}}})();d3.sankey=function(){var sankey={},nodeWidth=24,nodePadding=8,size=[1,1],nodes=[],links=[];sankey.nodeWidth=function(_){if(!arguments.length){return nodeWidth}nodeWidth=+_;return sankey};sankey.nodePadding=function(_){if(!arguments.length){return nodePadding}nodePadding=+_;return sankey};sankey.nodes=function(_){if(!arguments.length){return nodes}nodes=_;return sankey};sankey.links=function(_){if(!arguments.length){return links}links=_;return sankey};sankey.size=function(_){if(!arguments.length){return size}size=_;return sankey};sankey.layout=function(iterations){computeNodeLinks();computeNodeValues();computeNodeBreadths();computeNodeDepths(iterations);computeLinkDepths();return sankey};sankey.relayout=function(){computeLinkDepths();return sankey};sankey.link=function(){var curvature=0.5;function link(d){var x0=d.source.x+d.source.dx,x1=d.target.x,xi=d3.interpolateNumber(x0,x1),x2=xi(curvature),x3=xi(1-curvature),y0=d.source.y+d.sy+d.dy/2,y1=d.target.y+d.ty+d.dy/2;return"M"+x0+","+y0+"C"+x2+","+y0+" "+x3+","+y1+" "+x1+","+y1}link.curvature=function(_){if(!arguments.length){return curvature}curvature=+_;return link};return link};function computeNodeLinks(){nodes.forEach(function(node){node.sourceLinks=[];node.targetLinks=[]});links.forEach(function(link){var source=link.source,target=link.target;if(typeof source==="number"){source=link.source=nodes[link.source]}if(typeof target==="number"){target=link.target=nodes[link.target]}source.sourceLinks.push(link);target.targetLinks.push(link)})}function computeNodeValues(){nodes.forEach(function(node){node.value=Math.max(d3.sum(node.sourceLinks,value),d3.sum(node.targetLinks,value))})}function computeNodeBreadths(){var remainingNodes=nodes,nextNodes,x=0;while(remainingNodes.length){nextNodes=[];remainingNodes.forEach(function(node){node.x=x;node.dx=nodeWidth;node.sourceLinks.forEach(function(link){nextNodes.push(link.target)})});remainingNodes=nextNodes;++x}moveSinksRight(x);scaleNodeBreadths((size[0]-nodeWidth)/(x-1))}function moveSourcesRight(){nodes.forEach(function(node){if(!node.targetLinks.length){node.x=d3.min(node.sourceLinks,function(d){return d.target.x})-1}})}function moveSinksRight(x){nodes.forEach(function(node){if(!node.sourceLinks.length){node.x=x-1}})}function scaleNodeBreadths(kx){nodes.forEach(function(node){node.x*=kx})}function computeNodeDepths(iterations){var nodesByBreadth=d3.nest().key(function(d){return d.x}).sortKeys(d3.ascending).entries(nodes).map(function(d){return d.values});initializeNodeDepth();resolveCollisions();for(var alpha=1;iterations>0;--iterations){relaxRightToLeft(alpha*=0.99);resolveCollisions();relaxLeftToRight(alpha);resolveCollisions()}function initializeNodeDepth(){var ky=d3.min(nodesByBreadth,function(nodes){return(size[1]-(nodes.length-1)*nodePadding)/d3.sum(nodes,value)});nodesByBreadth.forEach(function(nodes){nodes.forEach(function(node,i){node.y=i;node.dy=node.value*ky})});links.forEach(function(link){link.dy=link.value*ky})}function relaxLeftToRight(alpha){nodesByBreadth.forEach(function(nodes,breadth){nodes.forEach(function(node){if(node.targetLinks.length){var y=d3.sum(node.targetLinks,weightedSource)/d3.sum(node.targetLinks,value);node.y+=(y-center(node))*alpha}})});function weightedSource(link){return center(link.source)*link.value}}function relaxRightToLeft(alpha){nodesByBreadth.slice().reverse().forEach(function(nodes){nodes.forEach(function(node){if(node.sourceLinks.length){var y=d3.sum(node.sourceLinks,weightedTarget)/d3.sum(node.sourceLinks,value);node.y+=(y-center(node))*alpha}})});function weightedTarget(link){return center(link.target)*link.value}}function resolveCollisions(){nodesByBreadth.forEach(function(nodes){var node,dy,y0=0,n=nodes.length,i;nodes.sort(ascendingDepth);for(i=0;i<n;++i){node=nodes[i];dy=y0-node.y;if(dy>0){node.y+=dy}y0=node.y+node.dy+nodePadding}dy=y0-nodePadding-size[1];if(dy>0){y0=node.y-=dy;for(i=n-2;i>=0;--i){node=nodes[i];dy=node.y+node.dy+nodePadding-y0;if(dy>0){node.y-=dy}y0=node.y}}})}function ascendingDepth(a,b){return a.y-b.y}}function computeLinkDepths(){nodes.forEach(function(node){node.sourceLinks.sort(ascendingTargetDepth);node.targetLinks.sort(ascendingSourceDepth)});nodes.forEach(function(node){var sy=0,ty=0;node.sourceLinks.forEach(function(link){link.sy=sy;sy+=link.dy});node.targetLinks.forEach(function(link){link.ty=ty;ty+=link.dy})});function ascendingSourceDepth(a,b){return a.source.y-b.source.y}function ascendingTargetDepth(a,b){return a.target.y-b.target.y}}function center(node){return node.y+node.dy/2}function value(link){return link.value}return sankey};(function(){var nv=window.nv||{};nv.version="1.1.13b";nv.dev=true;window.nv=nv;nv.tooltip={};nv.utils=nv.utils||{};nv.models={};nv.charts={};nv.graphs=[];nv.logs={};nv.dispatch=d3.dispatch("render_start","render_end");if(nv.dev){nv.dispatch.on("render_start",function(e){nv.logs.startTime=+new Date()});nv.dispatch.on("render_end",function(e){nv.logs.endTime=+new Date();nv.logs.totalTime=nv.logs.endTime-nv.logs.startTime;nv.log("total",nv.logs.totalTime)})}nv.log=function(){if(nv.dev&&console.log&&console.log.apply){console.log.apply(console,arguments)}else{if(nv.dev&&typeof console.log=="function"&&Function.prototype.bind){var log=Function.prototype.bind.call(console.log,console);log.apply(console,arguments)}}return arguments[arguments.length-1]};nv.render=function render(step){step=step||1;nv.render.active=true;nv.dispatch.render_start();setTimeout(function(){var chart,graph;for(var i=0;i<step&&(graph=nv.render.queue[i]);i++){chart=graph.generate();if(typeof graph.callback==typeof(Function)){graph.callback(chart)}nv.graphs.push(chart)}nv.render.queue.splice(0,i);if(nv.render.queue.length){setTimeout(arguments.callee,0)}else{nv.render.active=false;nv.dispatch.render_end()}},0)};nv.render.active=false;nv.render.queue=[];nv.addGraph=function(obj){if(typeof arguments[0]===typeof(Function)){obj={generate:arguments[0],callback:arguments[1]}}nv.render.queue.push(obj);if(!nv.render.active){nv.render()}};nv.identity=function(d){return d};nv.strip=function(s){return s.replace(/(\s|&)/g,"")};function daysInMonth(month,year){return(new Date(year,month+1,0)).getDate()}function d3_time_range(floor,step,number){return function(t0,t1,dt){var time=floor(t0),times=[];if(time<t0){step(time)}if(dt>1){while(time<t1){var date=new Date(+time);if((number(date)%dt===0)){times.push(date)}step(time)}}else{while(time<t1){times.push(new Date(+time));step(time)}}return times}}d3.time.monthEnd=function(date){return new Date(date.getFullYear(),date.getMonth(),0)};d3.time.monthEnds=d3_time_range(d3.time.monthEnd,function(date){date.setUTCDate(date.getUTCDate()+1);date.setDate(daysInMonth(date.getMonth()+1,date.getFullYear()))},function(date){return date.getMonth()});nv.interactiveGuideline=function(){var tooltip=nv.models.tooltip();var width=null,height=null,margin={left:0,top:0},xScale=d3.scale.linear(),yScale=d3.scale.linear(),dispatch=d3.dispatch("elementMousemove","elementMouseout","elementDblclick"),showGuideLine=true,svgContainer=null;var isMSIE=navigator.userAgent.indexOf("MSIE")!==-1;function layer(selection){selection.each(function(data){var container=d3.select(this);var availableWidth=(width||960),availableHeight=(height||400);var wrap=container.selectAll("g.nv-wrap.nv-interactiveLineLayer").data([data]);var wrapEnter=wrap.enter().append("g").attr("class"," nv-wrap nv-interactiveLineLayer");wrapEnter.append("g").attr("class","nv-interactiveGuideLine");if(!svgContainer){return}function mouseHandler(){var d3mouse=d3.mouse(this);var mouseX=d3mouse[0];var mouseY=d3mouse[1];var subtractMargin=true;var mouseOutAnyReason=false;if(isMSIE){mouseX=d3.event.offsetX;mouseY=d3.event.offsetY;if(d3.event.target.tagName!=="svg"){subtractMargin=false}if(d3.event.target.className.baseVal.match("nv-legend")){mouseOutAnyReason=true}}if(subtractMargin){mouseX-=margin.left;mouseY-=margin.top}if(mouseX<0||mouseY<0||mouseX>availableWidth||mouseY>availableHeight||(d3.event.relatedTarget&&d3.event.relatedTarget.ownerSVGElement===undefined)||mouseOutAnyReason){if(isMSIE){if(d3.event.relatedTarget&&d3.event.relatedTarget.ownerSVGElement===undefined&&d3.event.relatedTarget.className.match(tooltip.nvPointerEventsClass)){return}}dispatch.elementMouseout({mouseX:mouseX,mouseY:mouseY});layer.renderGuideLine(null);return}var pointXValue=xScale.invert(mouseX);dispatch.elementMousemove({mouseX:mouseX,mouseY:mouseY,pointXValue:pointXValue});if(d3.event.type==="dblclick"){dispatch.elementDblclick({mouseX:mouseX,mouseY:mouseY,pointXValue:pointXValue})}}svgContainer.on("mousemove",mouseHandler,true).on("mouseout",mouseHandler,true).on("dblclick",mouseHandler);layer.renderGuideLine=function(x){if(!showGuideLine){return}var line=wrap.select(".nv-interactiveGuideLine").selectAll("line").data((x!=null)?[nv.utils.NaNtoZero(x)]:[],String);line.enter().append("line").attr("class","nv-guideline").attr("x1",function(d){return d}).attr("x2",function(d){return d}).attr("y1",availableHeight).attr("y2",0);line.exit().remove()}})}layer.dispatch=dispatch;layer.tooltip=tooltip;layer.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.left=typeof _.left!="undefined"?_.left:margin.left;return layer};layer.width=function(_){if(!arguments.length){return width}width=_;return layer};layer.height=function(_){if(!arguments.length){return height}height=_;return layer};layer.xScale=function(_){if(!arguments.length){return xScale}xScale=_;return layer};layer.showGuideLine=function(_){if(!arguments.length){return showGuideLine}showGuideLine=_;return layer};layer.svgContainer=function(_){if(!arguments.length){return svgContainer}svgContainer=_;return layer};return layer};nv.interactiveBisect=function(values,searchVal,xAccessor){if(!values instanceof Array){return null}if(typeof xAccessor!=="function"){xAccessor=function(d,i){return d.x}}var bisect=d3.bisector(xAccessor).left;var index=d3.max([0,bisect(values,searchVal)-1]);var currentValue=xAccessor(values[index],index);if(typeof currentValue==="undefined"){currentValue=index}if(currentValue===searchVal){return index}var nextIndex=d3.min([index+1,values.length-1]);var nextValue=xAccessor(values[nextIndex],nextIndex);if(typeof nextValue==="undefined"){nextValue=nextIndex}if(Math.abs(nextValue-searchVal)>=Math.abs(currentValue-searchVal)){return index}else{return nextIndex}};nv.nearestValueIndex=function(values,searchVal,threshold){var yDistMax=Infinity,indexToHighlight=null;values.forEach(function(d,i){var delta=Math.abs(searchVal-d);if(delta<=yDistMax&&delta<threshold){yDistMax=delta;indexToHighlight=i}});return indexToHighlight};(function(){window.nv.tooltip={};window.nv.models.tooltip=function(){var content=null,data=null,gravity="w",distance=50,snapDistance=25,fixedTop=null,classes=null,chartContainer=null,tooltipElem=null,position={left:null,top:null},enabled=true,id="nvtooltip-"+Math.floor(Math.random()*100000);var nvPointerEventsClass="nv-pointer-events-none";var valueFormatter=function(d,i){return d};var headerFormatter=function(d){return d};var contentGenerator=function(d){if(content!=null){return content}if(d==null){return""}var table=d3.select(document.createElement("table"));var theadEnter=table.selectAll("thead").data([d]).enter().append("thead");theadEnter.append("tr").append("td").attr("colspan",3).append("strong").classed("x-value",true).html(headerFormatter(d.value));var tbodyEnter=table.selectAll("tbody").data([d]).enter().append("tbody");var trowEnter=tbodyEnter.selectAll("tr").data(function(p){return p.series}).enter().append("tr").classed("highlight",function(p){return p.highlight});trowEnter.append("td").classed("legend-color-guide",true).append("div").style("background-color",function(p){return p.color});trowEnter.append("td").classed("key",true).html(function(p){return p.key});trowEnter.append("td").classed("value",true).html(function(p,i){return valueFormatter(p.value,i)});trowEnter.selectAll("td").each(function(p){if(p.highlight){var opacityScale=d3.scale.linear().domain([0,1]).range(["#fff",p.color]);var opacity=0.6;d3.select(this).style("border-bottom-color",opacityScale(opacity)).style("border-top-color",opacityScale(opacity))}});var html=table.node().outerHTML;if(d.footer!==undefined){html+="<div class='footer'>"+d.footer+"</div>"}return html};var dataSeriesExists=function(d){if(d&&d.series&&d.series.length>0){return true}return false};function convertViewBoxRatio(){if(chartContainer){var svg=d3.select(chartContainer);if(svg.node().tagName!=="svg"){svg=svg.select("svg")}var viewBox=(svg.node())?svg.attr("viewBox"):null;if(viewBox){viewBox=viewBox.split(" ");var ratio=parseInt(svg.style("width"))/viewBox[2];position.left=position.left*ratio;position.top=position.top*ratio}}}function getTooltipContainer(newContent){var body;if(chartContainer){body=d3.select(chartContainer)}else{body=d3.select("body")}var container=body.select(".nvtooltip");if(container.node()===null){container=body.append("div").attr("class","nvtooltip "+(classes?classes:"xy-tooltip")).attr("id",id)}container.node().innerHTML=newContent;container.style("top",0).style("left",0).style("opacity",0);container.selectAll("div, table, td, tr").classed(nvPointerEventsClass,true);container.classed(nvPointerEventsClass,true);return container.node()}function nvtooltip(){if(!enabled){return}if(!dataSeriesExists(data)){return}convertViewBoxRatio();var left=position.left;var top=(fixedTop!=null)?fixedTop:position.top;var container=getTooltipContainer(contentGenerator(data));tooltipElem=container;if(chartContainer){var svgComp=chartContainer.getElementsByTagName("svg")[0];var boundRect=(svgComp)?svgComp.getBoundingClientRect():chartContainer.getBoundingClientRect();var svgOffset={left:0,top:0};if(svgComp){var svgBound=svgComp.getBoundingClientRect();var chartBound=chartContainer.getBoundingClientRect();var svgBoundTop=svgBound.top;if(svgBoundTop<0){var containerBound=chartContainer.getBoundingClientRect();svgBoundTop=(Math.abs(svgBoundTop)>containerBound.height)?0:svgBoundTop}svgOffset.top=Math.abs(svgBoundTop-chartBound.top);svgOffset.left=Math.abs(svgBound.left-chartBound.left)}left+=chartContainer.offsetLeft+svgOffset.left-2*chartContainer.scrollLeft;top+=chartContainer.offsetTop+svgOffset.top-2*chartContainer.scrollTop}if(snapDistance&&snapDistance>0){top=Math.floor(top/snapDistance)*snapDistance}nv.tooltip.calcTooltipPosition([left,top],gravity,distance,container);return nvtooltip}nvtooltip.nvPointerEventsClass=nvPointerEventsClass;nvtooltip.content=function(_){if(!arguments.length){return content}content=_;return nvtooltip};nvtooltip.tooltipElem=function(){return tooltipElem};nvtooltip.contentGenerator=function(_){if(!arguments.length){return contentGenerator}if(typeof _==="function"){contentGenerator=_}return nvtooltip};nvtooltip.data=function(_){if(!arguments.length){return data}data=_;return nvtooltip};nvtooltip.gravity=function(_){if(!arguments.length){return gravity}gravity=_;return nvtooltip};nvtooltip.distance=function(_){if(!arguments.length){return distance}distance=_;return nvtooltip};nvtooltip.snapDistance=function(_){if(!arguments.length){return snapDistance}snapDistance=_;return nvtooltip};nvtooltip.classes=function(_){if(!arguments.length){return classes}classes=_;return nvtooltip};nvtooltip.chartContainer=function(_){if(!arguments.length){return chartContainer}chartContainer=_;return nvtooltip};nvtooltip.position=function(_){if(!arguments.length){return position}position.left=(typeof _.left!=="undefined")?_.left:position.left;position.top=(typeof _.top!=="undefined")?_.top:position.top;return nvtooltip};nvtooltip.fixedTop=function(_){if(!arguments.length){return fixedTop}fixedTop=_;return nvtooltip};nvtooltip.enabled=function(_){if(!arguments.length){return enabled}enabled=_;return nvtooltip};nvtooltip.valueFormatter=function(_){if(!arguments.length){return valueFormatter}if(typeof _==="function"){valueFormatter=_}return nvtooltip};nvtooltip.headerFormatter=function(_){if(!arguments.length){return headerFormatter}if(typeof _==="function"){headerFormatter=_}return nvtooltip};nvtooltip.id=function(){return id};return nvtooltip};nv.tooltip.show=function(pos,content,gravity,dist,parentContainer,classes){var container=document.createElement("div");container.className="nvtooltip "+(classes?classes:"xy-tooltip");var body=parentContainer;if(!parentContainer||parentContainer.tagName.match(/g|svg/i)){body=document.getElementsByTagName("body")[0]}container.style.left=0;container.style.top=0;container.style.opacity=0;container.innerHTML=content;body.appendChild(container);if(parentContainer){pos[0]=pos[0]-parentContainer.scrollLeft;pos[1]=pos[1]-parentContainer.scrollTop}nv.tooltip.calcTooltipPosition(pos,gravity,dist,container)};nv.tooltip.findFirstNonSVGParent=function(Elem){while(Elem.tagName.match(/^g|svg$/i)!==null){Elem=Elem.parentNode}return Elem};nv.tooltip.findTotalOffsetTop=function(Elem,initialTop){var offsetTop=initialTop;do{if(!isNaN(Elem.offsetTop)){offsetTop+=(Elem.offsetTop)}}while(Elem=Elem.offsetParent);return offsetTop};nv.tooltip.findTotalOffsetLeft=function(Elem,initialLeft){var offsetLeft=initialLeft;do{if(!isNaN(Elem.offsetLeft)){offsetLeft+=(Elem.offsetLeft)}}while(Elem=Elem.offsetParent);return offsetLeft};nv.tooltip.calcTooltipPosition=function(pos,gravity,dist,container){var height=parseInt(container.offsetHeight),width=parseInt(container.offsetWidth),windowWidth=nv.utils.windowSize().width,windowHeight=nv.utils.windowSize().height,scrollTop=window.pageYOffset,scrollLeft=window.pageXOffset,left,top;windowHeight=window.innerWidth>=document.body.scrollWidth?windowHeight:windowHeight-16;windowWidth=window.innerHeight>=document.body.scrollHeight?windowWidth:windowWidth-16;gravity=gravity||"s";dist=dist||20;var tooltipTop=function(Elem){return nv.tooltip.findTotalOffsetTop(Elem,top)};var tooltipLeft=function(Elem){return nv.tooltip.findTotalOffsetLeft(Elem,left)};switch(gravity){case"e":left=pos[0]-width-dist;top=pos[1]-(height/2);var tLeft=tooltipLeft(container);var tTop=tooltipTop(container);if(tLeft<scrollLeft){left=pos[0]+dist>scrollLeft?pos[0]+dist:scrollLeft-tLeft+left}if(tTop<scrollTop){top=scrollTop-tTop+top}if(tTop+height>scrollTop+windowHeight){top=scrollTop+windowHeight-tTop+top-height}break;case"w":left=pos[0]+dist;top=pos[1]-(height/2);var tLeft=tooltipLeft(container);var tTop=tooltipTop(container);if(tLeft+width>windowWidth){left=pos[0]-width-dist}if(tTop<scrollTop){top=scrollTop+5}if(tTop+height>scrollTop+windowHeight){top=scrollTop+windowHeight-tTop+top-height}break;case"n":left=pos[0]-(width/2)-5;top=pos[1]+dist;var tLeft=tooltipLeft(container);var tTop=tooltipTop(container);if(tLeft<scrollLeft){left=scrollLeft+5}if(tLeft+width>windowWidth){left=left-width/2+5}if(tTop+height>scrollTop+windowHeight){top=scrollTop+windowHeight-tTop+top-height}break;case"s":left=pos[0]-(width/2);top=pos[1]-height-dist;var tLeft=tooltipLeft(container);var tTop=tooltipTop(container);if(tLeft<scrollLeft){left=scrollLeft+5}if(tLeft+width>windowWidth){left=left-width/2+5}if(scrollTop>tTop){top=scrollTop}break;case"none":left=pos[0];top=pos[1]-dist;var tLeft=tooltipLeft(container);var tTop=tooltipTop(container);break}container.style.left=left+"px";container.style.top=top+"px";container.style.opacity=1;container.style.position="absolute";return container};nv.tooltip.cleanup=function(){var tooltips=document.getElementsByClassName("nvtooltip");var purging=[];while(tooltips.length){purging.push(tooltips[0]);tooltips[0].style.transitionDelay="0 !important";tooltips[0].style.opacity=0;tooltips[0].className="nvtooltip-pending-removal"}setTimeout(function(){while(purging.length){var removeMe=purging.pop();removeMe.parentNode.removeChild(removeMe)}},500)}})();nv.utils.windowSize=function(){var size={width:640,height:480};if(document.body&&document.body.offsetWidth){size.width=document.body.offsetWidth;size.height=document.body.offsetHeight}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){size.width=document.documentElement.offsetWidth;size.height=document.documentElement.offsetHeight}if(window.innerWidth&&window.innerHeight){size.width=window.innerWidth;size.height=window.innerHeight}return(size)};nv.utils.windowResize=function(fun){if(fun===undefined){return}var oldresize=window.onresize;window.onresize=function(e){if(typeof oldresize=="function"){oldresize(e)}fun(e)}};nv.utils.getColor=function(color){if(!arguments.length){return nv.utils.defaultColor()}if(Object.prototype.toString.call(color)==="[object Array]"){return function(d,i){return d.color||color[i%color.length]}}else{return color}};nv.utils.defaultColor=function(){var colors=d3.scale.category20().range();return function(d,i){return d.color||colors[i%colors.length]}};nv.utils.customTheme=function(dictionary,getKey,defaultColors){getKey=getKey||function(series){return series.key};defaultColors=defaultColors||d3.scale.category20().range();var defIndex=defaultColors.length;return function(series,index){var key=getKey(series);if(!defIndex){defIndex=defaultColors.length}if(typeof dictionary[key]!=="undefined"){return(typeof dictionary[key]==="function")?dictionary[key]():dictionary[key]}else{return defaultColors[--defIndex]}}};nv.utils.pjax=function(links,content){d3.selectAll(links).on("click",function(){history.pushState(this.href,this.textContent,this.href);load(this.href);d3.event.preventDefault()});function load(href){d3.html(href,function(fragment){var target=d3.select(content).node();target.parentNode.replaceChild(d3.select(fragment).select(content).node(),target);nv.utils.pjax(links,content)})}d3.select(window).on("popstate",function(){if(d3.event.state){load(d3.event.state)}})};nv.utils.calcApproxTextWidth=function(svgTextElem){if(svgTextElem instanceof d3.selection){var fontSize=parseInt(svgTextElem.style("font-size").replace("px",""));var textLength=svgTextElem.text().length;return textLength*fontSize*0.5}return 0};nv.utils.NaNtoZero=function(n){if(typeof n!=="number"||isNaN(n)||n===null||n===Infinity){return 0}return n};nv.utils.optionsFunc=function(args){if(args){d3.map(args).forEach((function(key,value){if(typeof this[key]==="function"){this[key](value)}}).bind(this))}return this};nv.models.axis=function(){var axis=d3.svg.axis();var margin={top:0,right:0,bottom:0,left:0},width=75,height=60,scale=d3.scale.linear(),axisLabelText=null,showMaxMin=true,highlightZero=true,rotateLabels=0,rotateYLabel=true,staggerLabels=false,isOrdinal=false,ticks=null,axisLabelDistance=12;axis.scale(scale).orient("bottom").tickFormat(function(d){return d});var scale0;function chart(selection){selection.each(function(data){var container=d3.select(this);var wrap=container.selectAll("g.nv-wrap.nv-axis").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-axis");var gEnter=wrapEnter.append("g");var g=wrap.select("g");if(ticks!==null){axis.ticks(ticks)}else{if(axis.orient()=="top"||axis.orient()=="bottom"){axis.ticks(Math.abs(scale.range()[1]-scale.range()[0])/100)}}g.transition().call(axis);scale0=scale0||axis.scale();var fmt=axis.tickFormat();if(fmt==null){fmt=scale0.tickFormat()}var axisLabel=g.selectAll("text.nv-axislabel").data([axisLabelText||null]);axisLabel.exit().remove();switch(axis.orient()){case"top":axisLabel.enter().append("text").attr("class","nv-axislabel");var w=(scale.range().length==2)?scale.range()[1]:(scale.range()[scale.range().length-1]+(scale.range()[1]-scale.range()[0]));axisLabel.attr("text-anchor","middle").attr("y",0).attr("x",w/2);if(showMaxMin){var axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data(scale.domain());axisMaxMin.enter().append("g").attr("class","nv-axisMaxMin").append("text");axisMaxMin.exit().remove();axisMaxMin.attr("transform",function(d,i){return"translate("+scale(d)+",0)"}).select("text").attr("dy","0em").attr("y",-axis.tickPadding()).attr("text-anchor","middle").text(function(d,i){var v=fmt(d);return(""+v).match("NaN")?"":v});axisMaxMin.transition().attr("transform",function(d,i){return"translate("+scale.range()[i]+",0)"})}break;case"bottom":var xLabelMargin=36;var maxTextWidth=30;var xTicks=g.selectAll("g").select("text");if(rotateLabels%360){xTicks.each(function(d,i){var width=this.getBBox().width;if(width>maxTextWidth){maxTextWidth=width}});var sin=Math.abs(Math.sin(rotateLabels*Math.PI/180));var xLabelMargin=(sin?sin*maxTextWidth:maxTextWidth)+30;xTicks.attr("transform",function(d,i,j){return"rotate("+rotateLabels+" 0,0)"}).style("text-anchor",rotateLabels%360>0?"start":"end")}axisLabel.enter().append("text").attr("class","nv-axislabel");var w=(scale.range().length==2)?scale.range()[1]:(scale.range()[scale.range().length-1]+(scale.range()[1]-scale.range()[0]));axisLabel.attr("text-anchor","middle").attr("y",xLabelMargin).attr("x",w/2);if(showMaxMin){var axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data([scale.domain()[0],scale.domain()[scale.domain().length-1]]);axisMaxMin.enter().append("g").attr("class","nv-axisMaxMin").append("text");axisMaxMin.exit().remove();axisMaxMin.attr("transform",function(d,i){return"translate("+(scale(d)+(isOrdinal?scale.rangeBand()/2:0))+",0)"}).select("text").attr("dy",".71em").attr("y",axis.tickPadding()).attr("transform",function(d,i,j){return"rotate("+rotateLabels+" 0,0)"}).style("text-anchor",rotateLabels?(rotateLabels%360>0?"start":"end"):"middle").text(function(d,i){var v=fmt(d);return(""+v).match("NaN")?"":v});axisMaxMin.transition().attr("transform",function(d,i){return"translate("+(scale(d)+(isOrdinal?scale.rangeBand()/2:0))+",0)"})}if(staggerLabels){xTicks.attr("transform",function(d,i){return"translate(0,"+(i%2==0?"0":"12")+")"})}break;case"right":axisLabel.enter().append("text").attr("class","nv-axislabel");axisLabel.style("text-anchor",rotateYLabel?"middle":"begin").attr("transform",rotateYLabel?"rotate(90)":"").attr("y",rotateYLabel?(-Math.max(margin.right,width)+12):-10).attr("x",rotateYLabel?(scale.range()[0]/2):axis.tickPadding());if(showMaxMin){var axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data(scale.domain());axisMaxMin.enter().append("g").attr("class","nv-axisMaxMin").append("text").style("opacity",0);axisMaxMin.exit().remove();axisMaxMin.attr("transform",function(d,i){return"translate(0,"+scale(d)+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",axis.tickPadding()).style("text-anchor","start").text(function(d,i){var v=fmt(d);return(""+v).match("NaN")?"":v});axisMaxMin.transition().attr("transform",function(d,i){return"translate(0,"+scale.range()[i]+")"}).select("text").style("opacity",1)}break;case"left":axisLabel.enter().append("text").attr("class","nv-axislabel");axisLabel.style("text-anchor",rotateYLabel?"middle":"end").attr("transform",rotateYLabel?"rotate(-90)":"").attr("y",rotateYLabel?(-Math.max(margin.left,width)+axisLabelDistance):-10).attr("x",rotateYLabel?(-scale.range()[0]/2):-axis.tickPadding());if(showMaxMin){var axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data(scale.domain());axisMaxMin.enter().append("g").attr("class","nv-axisMaxMin").append("text").style("opacity",0);axisMaxMin.exit().remove();axisMaxMin.attr("transform",function(d,i){return"translate(0,"+scale0(d)+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",-axis.tickPadding()).attr("text-anchor","end").text(function(d,i){var v=fmt(d);return(""+v).match("NaN")?"":v});axisMaxMin.transition().attr("transform",function(d,i){return"translate(0,"+scale.range()[i]+")"}).select("text").style("opacity",1)}break}axisLabel.text(function(d){return d});if(showMaxMin&&(axis.orient()==="left"||axis.orient()==="right")){g.selectAll("g").each(function(d,i){d3.select(this).select("text").attr("opacity",1);if(scale(d)<scale.range()[1]+10||scale(d)>scale.range()[0]-10){if(d>1e-10||d<-1e-10){d3.select(this).attr("opacity",0)}d3.select(this).select("text").attr("opacity",0)}});if(scale.domain()[0]==scale.domain()[1]&&scale.domain()[0]==0){wrap.selectAll("g.nv-axisMaxMin").style("opacity",function(d,i){return !i?1:0})}}if(showMaxMin&&(axis.orient()==="top"||axis.orient()==="bottom")){var maxMinRange=[];wrap.selectAll("g.nv-axisMaxMin").each(function(d,i){try{if(i){maxMinRange.push(scale(d)-this.getBBox().width-4)}else{maxMinRange.push(scale(d)+this.getBBox().width+4)}}catch(err){if(i){maxMinRange.push(scale(d)-4)}else{maxMinRange.push(scale(d)+4)}}});g.selectAll("g").each(function(d,i){if(scale(d)<maxMinRange[0]||scale(d)>maxMinRange[1]){if(d>1e-10||d<-1e-10){d3.select(this).remove()}else{d3.select(this).select("text").remove()}}})}if(highlightZero){g.selectAll(".tick").filter(function(d){return !parseFloat(Math.round(d.__data__*100000)/1000000)&&(d.__data__!==undefined)}).classed("zero",true)}scale0=scale.copy()});return chart}chart.axis=axis;d3.rebind(chart,axis,"orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat");d3.rebind(chart,scale,"domain","range","rangeBand","rangeBands");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.ticks=function(_){if(!arguments.length){return ticks}ticks=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.axisLabel=function(_){if(!arguments.length){return axisLabelText}axisLabelText=_;return chart};chart.showMaxMin=function(_){if(!arguments.length){return showMaxMin}showMaxMin=_;return chart};chart.highlightZero=function(_){if(!arguments.length){return highlightZero}highlightZero=_;return chart};chart.scale=function(_){if(!arguments.length){return scale}scale=_;axis.scale(scale);isOrdinal=typeof scale.rangeBands==="function";d3.rebind(chart,scale,"domain","range","rangeBand","rangeBands");return chart};chart.rotateYLabel=function(_){if(!arguments.length){return rotateYLabel}rotateYLabel=_;return chart};chart.rotateLabels=function(_){if(!arguments.length){return rotateLabels}rotateLabels=_;return chart};chart.staggerLabels=function(_){if(!arguments.length){return staggerLabels}staggerLabels=_;return chart};chart.axisLabelDistance=function(_){if(!arguments.length){return axisLabelDistance}axisLabelDistance=_;return chart};return chart};nv.models.bullet=function(){var margin={top:0,right:0,bottom:0,left:0},orient="left",reverse=false,ranges=function(d){return d.ranges},markers=function(d){return d.markers},measures=function(d){return d.measures},rangeLabels=function(d){return d.rangeLabels?d.rangeLabels:[]},markerLabels=function(d){return d.markerLabels?d.markerLabels:[]},measureLabels=function(d){return d.measureLabels?d.measureLabels:[]},forceX=[0],width=380,height=30,tickFormat=null,color=nv.utils.getColor(["#1f77b4"]),dispatch=d3.dispatch("elementMouseover","elementMouseout");function chart(selection){selection.each(function(d,i){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);var rangez=ranges.call(this,d,i).slice().sort(d3.descending),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i).slice().sort(d3.descending),rangeLabelz=rangeLabels.call(this,d,i).slice(),markerLabelz=markerLabels.call(this,d,i).slice(),measureLabelz=measureLabels.call(this,d,i).slice();var x1=d3.scale.linear().domain(d3.extent(d3.merge([forceX,rangez]))).range(reverse?[availableWidth,0]:[0,availableWidth]);var x0=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(x1.range());this.__chart__=x1;var rangeMin=d3.min(rangez),rangeMax=d3.max(rangez),rangeAvg=rangez[1];var wrap=container.selectAll("g.nv-wrap.nv-bullet").data([d]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bullet");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("rect").attr("class","nv-range nv-rangeMax");gEnter.append("rect").attr("class","nv-range nv-rangeAvg");gEnter.append("rect").attr("class","nv-range nv-rangeMin");gEnter.append("rect").attr("class","nv-measure");gEnter.append("path").attr("class","nv-markerTriangle");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var w0=function(d){return Math.abs(x0(d)-x0(0))},w1=function(d){return Math.abs(x1(d)-x1(0))};var xp0=function(d){return d<0?x0(d):x0(0)},xp1=function(d){return d<0?x1(d):x1(0)};g.select("rect.nv-rangeMax").attr("height",availableHeight).attr("width",w1(rangeMax>0?rangeMax:rangeMin)).attr("x",xp1(rangeMax>0?rangeMax:rangeMin)).datum(rangeMax>0?rangeMax:rangeMin);g.select("rect.nv-rangeAvg").attr("height",availableHeight).attr("width",w1(rangeAvg)).attr("x",xp1(rangeAvg)).datum(rangeAvg);g.select("rect.nv-rangeMin").attr("height",availableHeight).attr("width",w1(rangeMax)).attr("x",xp1(rangeMax)).attr("width",w1(rangeMax>0?rangeMin:rangeMax)).attr("x",xp1(rangeMax>0?rangeMin:rangeMax)).datum(rangeMax>0?rangeMin:rangeMax);g.select("rect.nv-measure").style("fill",color).attr("height",availableHeight/3).attr("y",availableHeight/3).attr("width",measurez<0?x1(0)-x1(measurez[0]):x1(measurez[0])-x1(0)).attr("x",xp1(measurez)).on("mouseover",function(){dispatch.elementMouseover({value:measurez[0],label:measureLabelz[0]||"Current",pos:[x1(measurez[0]),availableHeight/2]})}).on("mouseout",function(){dispatch.elementMouseout({value:measurez[0],label:measureLabelz[0]||"Current"})});var h3=availableHeight/6;if(markerz[0]){g.selectAll("path.nv-markerTriangle").attr("transform",function(d){return"translate("+x1(markerz[0])+","+(availableHeight/2)+")"}).attr("d","M0,"+h3+"L"+h3+","+(-h3)+" "+(-h3)+","+(-h3)+"Z").on("mouseover",function(){dispatch.elementMouseover({value:markerz[0],label:markerLabelz[0]||"Previous",pos:[x1(markerz[0]),availableHeight/2]})}).on("mouseout",function(){dispatch.elementMouseout({value:markerz[0],label:markerLabelz[0]||"Previous"})})}else{g.selectAll("path.nv-markerTriangle").remove()}wrap.selectAll(".nv-range").on("mouseover",function(d,i){var label=rangeLabelz[i]||(!i?"Maximum":i==1?"Mean":"Minimum");dispatch.elementMouseover({value:d,label:label,pos:[x1(d),availableHeight/2]})}).on("mouseout",function(d,i){var label=rangeLabelz[i]||(!i?"Maximum":i==1?"Mean":"Minimum");dispatch.elementMouseout({value:d,label:label})})});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.orient=function(_){if(!arguments.length){return orient}orient=_;reverse=orient=="right"||orient=="bottom";return chart};chart.ranges=function(_){if(!arguments.length){return ranges}ranges=_;return chart};chart.markers=function(_){if(!arguments.length){return markers}markers=_;return chart};chart.measures=function(_){if(!arguments.length){return measures}measures=_;return chart};chart.forceX=function(_){if(!arguments.length){return forceX}forceX=_;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.tickFormat=function(_){if(!arguments.length){return tickFormat}tickFormat=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};return chart};nv.models.bulletChart=function(){var bullet=nv.models.bullet();var orient="left",reverse=false,margin={top:5,right:40,bottom:20,left:120},ranges=function(d){return d.ranges},markers=function(d){return d.markers},measures=function(d){return d.measures},width=null,height=55,tickFormat=null,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+x+"</h3><p>"+y+"</p>"},noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0)+margin.left,top=e.pos[1]+(offsetElement.offsetTop||0)+margin.top,content=tooltip(e.key,e.label,e.value,e,chart);nv.tooltip.show([left,top],content,e.value<0?"e":"w",null,offsetElement)};function chart(selection){selection.each(function(d,i){var container=d3.select(this);var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,that=this;chart.update=function(){chart(selection)};chart.container=this;if(!d||!ranges.call(this,d,i)){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",18+margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var rangez=ranges.call(this,d,i).slice().sort(d3.descending),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i).slice().sort(d3.descending);var wrap=container.selectAll("g.nv-wrap.nv-bulletChart").data([d]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bulletChart");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-bulletWrap");gEnter.append("g").attr("class","nv-titles");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var x1=d3.scale.linear().domain([0,Math.max(rangez[0],markerz[0],measurez[0])]).range(reverse?[availableWidth,0]:[0,availableWidth]);var x0=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(x1.range());this.__chart__=x1;var w0=function(d){return Math.abs(x0(d)-x0(0))},w1=function(d){return Math.abs(x1(d)-x1(0))};var title=gEnter.select(".nv-titles").append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(height-margin.top-margin.bottom)/2+")");title.append("text").attr("class","nv-title").text(function(d){return d.title});title.append("text").attr("class","nv-subtitle").attr("dy","1em").text(function(d){return d.subtitle});bullet.width(availableWidth).height(availableHeight);var bulletWrap=g.select(".nv-bulletWrap");d3.transition(bulletWrap).call(bullet);var format=tickFormat||x1.tickFormat(availableWidth/100);var tick=g.selectAll("g.nv-tick").data(x1.ticks(availableWidth/50),function(d){return this.textContent||format(d)});var tickEnter=tick.enter().append("g").attr("class","nv-tick").attr("transform",function(d){return"translate("+x0(d)+",0)"}).style("opacity",0.000001);tickEnter.append("line").attr("y1",availableHeight).attr("y2",availableHeight*7/6);tickEnter.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",availableHeight*7/6).text(format);var tickUpdate=d3.transition(tick).attr("transform",function(d){return"translate("+x1(d)+",0)"}).style("opacity",1);tickUpdate.select("line").attr("y1",availableHeight).attr("y2",availableHeight*7/6);tickUpdate.select("text").attr("y",availableHeight*7/6);d3.transition(tick.exit()).attr("transform",function(d){return"translate("+x1(d)+",0)"}).style("opacity",0.000001).remove();dispatch.on("tooltipShow",function(e){e.key=d.title;if(tooltips){showTooltip(e,that.parentNode)}})});d3.timer.flush();return chart}bullet.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});bullet.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.bullet=bullet;d3.rebind(chart,bullet,"color");chart.options=nv.utils.optionsFunc.bind(chart);chart.orient=function(x){if(!arguments.length){return orient}orient=x;reverse=orient=="right"||orient=="bottom";return chart};chart.ranges=function(x){if(!arguments.length){return ranges}ranges=x;return chart};chart.markers=function(x){if(!arguments.length){return markers}markers=x;return chart};chart.measures=function(x){if(!arguments.length){return measures}measures=x;return chart};chart.width=function(x){if(!arguments.length){return width}width=x;return chart};chart.height=function(x){if(!arguments.length){return height}height=x;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.tickFormat=function(x){if(!arguments.length){return tickFormat}tickFormat=x;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.cumulativeLineChart=function(){var lines=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),interactiveLayer=nv.interactiveGuideline();var margin={top:30,right:30,bottom:50,left:60},color=nv.utils.defaultColor(),width=null,height=null,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,tooltips=true,showControls=true,useInteractiveGuideline=false,rescaleY=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,y,id=lines.id(),state={index:0,rescaleY:rescaleY},defaultState=null,noData="No Data Available.",average=function(d){return d.average},dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),transitionDuration=250;xAxis.orient("bottom").tickPadding(7);yAxis.orient((rightAlignYAxis)?"right":"left");controls.updateState(false);var dx=d3.scale.linear(),index={i:0,x:0};var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this).classed("nv-chart-"+id,true),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}var indexDrag=d3.behavior.drag().on("dragstart",dragStart).on("drag",dragMove).on("dragend",dragEnd);function dragStart(d,i){d3.select(chart.container).style("cursor","ew-resize")}function dragMove(d,i){index.x=d3.event.x;index.i=Math.round(dx.invert(index.x));updateZero()}function dragEnd(d,i){d3.select(chart.container).style("cursor","auto");state.index=index.i;dispatch.stateChange(state)}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=lines.xScale();y=lines.yScale();if(!rescaleY){var seriesDomains=data.filter(function(series){return !series.disabled}).map(function(series,i){var initialDomain=d3.extent(series.values,lines.y());if(initialDomain[0]<-0.95){initialDomain[0]=-0.95}return[(initialDomain[0]-initialDomain[1])/(1+initialDomain[1]),(initialDomain[1]-initialDomain[0])/(1+initialDomain[0])]});var completeDomain=[d3.min(seriesDomains,function(d){return d[0]}),d3.max(seriesDomains,function(d){return d[1]})];lines.yDomain(completeDomain)}else{lines.yDomain(null)}dx.domain([0,data[0].values.length-1]).range([0,availableWidth]).clamp(true);var data=indexify(index.i,data);var interactivePointerEvents=(useInteractiveGuideline)?"none":"all";var wrap=container.selectAll("g.nv-wrap.nv-cumulativeLine").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-cumulativeLine").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-interactive");gEnter.append("g").attr("class","nv-x nv-axis").style("pointer-events","none");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-background");gEnter.append("g").attr("class","nv-linesWrap").style("pointer-events",interactivePointerEvents);gEnter.append("g").attr("class","nv-avgLinesWrap").style("pointer-events","none");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");if(showLegend){legend.width(availableWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}if(showControls){var controlsData=[{key:"Re-scale y-axis",disabled:!rescaleY}];controls.width(140).color(["#444","#444","#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}var tempDisabled=data.filter(function(d){return d.tempDisabled});wrap.select(".tempDisabled").remove();if(tempDisabled.length){wrap.append("text").attr("class","tempDisabled").attr("x",availableWidth/2).attr("y","-.71em").style("text-anchor","end").text(tempDisabled.map(function(d){return d.key}).join(", ")+" values cannot be calculated for this time period.")}if(useInteractiveGuideline){interactiveLayer.width(availableWidth).height(availableHeight).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x);wrap.select(".nv-interactive").call(interactiveLayer)}gEnter.select(".nv-background").append("rect");g.select(".nv-background rect").attr("width",availableWidth).attr("height",availableHeight);lines.y(function(d){return d.display.y}).width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&!data[i].tempDisabled}));var linesWrap=g.select(".nv-linesWrap").datum(data.filter(function(d){return !d.disabled&&!d.tempDisabled}));linesWrap.call(lines);data.forEach(function(d,i){d.seriesIndex=i});var avgLineData=data.filter(function(d){return !d.disabled&&!!average(d)});var avgLines=g.select(".nv-avgLinesWrap").selectAll("line").data(avgLineData,function(d){return d.key});var getAvgLineY=function(d){var yVal=y(average(d));if(yVal<0){return 0}if(yVal>availableHeight){return availableHeight}return yVal};avgLines.enter().append("line").style("stroke-width",2).style("stroke-dasharray","10,10").style("stroke",function(d,i){return lines.color()(d,d.seriesIndex)}).attr("x1",0).attr("x2",availableWidth).attr("y1",getAvgLineY).attr("y2",getAvgLineY);avgLines.style("stroke-opacity",function(d){var yVal=y(average(d));if(yVal<0||yVal>availableHeight){return 0}return 1}).attr("x1",0).attr("x2",availableWidth).attr("y1",getAvgLineY).attr("y2",getAvgLineY);avgLines.exit().remove();var indexLine=linesWrap.selectAll(".nv-indexLine").data([index]);indexLine.enter().append("rect").attr("class","nv-indexLine").attr("width",3).attr("x",-2).attr("fill","red").attr("fill-opacity",0.5).style("pointer-events","all").call(indexDrag);indexLine.attr("transform",function(d){return"translate("+dx(d.i)+",0)"}).attr("height",availableHeight);if(showXAxis){xAxis.scale(x).ticks(Math.min(data[0].values.length,availableWidth/70)).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")");d3.transition(g.select(".nv-x.nv-axis")).call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);d3.transition(g.select(".nv-y.nv-axis")).call(yAxis)}function updateZero(){indexLine.data([index]);var oldDuration=chart.transitionDuration();chart.transitionDuration(0);chart.update();chart.transitionDuration(oldDuration)}g.select(".nv-background rect").on("click",function(){index.x=d3.mouse(this)[0];index.i=Math.round(dx.invert(index.x));state.index=index.i;dispatch.stateChange(state);updateZero()});lines.dispatch.on("elementClick",function(e){index.i=e.pointIndex;index.x=dx(index.i);state.index=index.i;dispatch.stateChange(state);updateZero()});controls.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;rescaleY=!d.disabled;state.rescaleY=rescaleY;dispatch.stateChange(state);chart.update()});legend.dispatch.on("stateChange",function(newState){state.disabled=newState.disabled;dispatch.stateChange(state);chart.update()});interactiveLayer.dispatch.on("elementMousemove",function(e){lines.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];data.filter(function(series,i){series.seriesIndex=i;return !series.disabled}).forEach(function(series,i){pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x());lines.highlightPoint(i,pointIndex,true);var point=series.values[pointIndex];if(typeof point==="undefined"){return}if(typeof singlePoint==="undefined"){singlePoint=point}if(typeof pointXLocation==="undefined"){pointXLocation=chart.xScale()(chart.x()(point,pointIndex))}allData.push({key:series.key,value:chart.y()(point,pointIndex),color:color(series,series.seriesIndex)})});if(allData.length>2){var yValue=chart.yScale().invert(e.mouseY);var domainExtent=Math.abs(chart.yScale().domain()[0]-chart.yScale().domain()[1]);var threshold=0.03*domainExtent;var indexToHighlight=nv.nearestValueIndex(allData.map(function(d){return d.value}),yValue,threshold);if(indexToHighlight!==null){allData[indexToHighlight].highlight=true}}var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex),pointIndex);interactiveLayer.tooltip.position({left:pointXLocation+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).enabled(tooltips).valueFormatter(function(d,i){return yAxis.tickFormat()(d)}).data({value:xValue,series:allData})();interactiveLayer.renderGuideLine(pointXLocation)});interactiveLayer.dispatch.on("elementMouseout",function(e){dispatch.tooltipHide();lines.clearHighlights()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}if(typeof e.index!=="undefined"){index.i=e.index;index.x=dx(index.i);state.index=e.index;indexLine.data([index])}if(typeof e.rescaleY!=="undefined"){rescaleY=e.rescaleY}chart.update()})});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.lines=lines;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.interactiveLayer=interactiveLayer;d3.rebind(chart,lines,"defined","isArea","x","y","xScale","yScale","size","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","useVoronoi","id");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.rescaleY=function(_){if(!arguments.length){return rescaleY}rescaleY=_;return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.useInteractiveGuideline=function(_){if(!arguments.length){return useInteractiveGuideline}useInteractiveGuideline=_;if(_===true){chart.interactive(false);chart.useVoronoi(false)}return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.average=function(_){if(!arguments.length){return average}average=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};function indexify(idx,data){return data.map(function(line,i){if(!line.values){return line}var v=lines.y()(line.values[idx],idx);if(v<-0.95){line.tempDisabled=true;return line}line.tempDisabled=false;line.values=line.values.map(function(point,pointIndex){point.display={y:(lines.y()(point,pointIndex)-v)/(1+v)};return point});return line})}return chart};nv.models.discreteBar=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(Math.random()*10000),x=d3.scale.ordinal(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],color=nv.utils.defaultColor(),showValues=false,valueFormat=d3.format(",.2f"),xDomain,yDomain,xRange,yRange,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),rectClass="discreteBar";var x0,y0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);data=data.map(function(series,i){series.values=series.values.map(function(point){point.series=i;return point});return series});var seriesData=(xDomain&&yDomain)?[]:data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0}})});x.domain(xDomain||d3.merge(seriesData).map(function(d){return d.x})).rangeBands(xRange||[0,availableWidth],0.1);y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){return d.y}).concat(forceY)));if(showValues){y.range(yRange||[availableHeight-(y.domain()[0]<0?12:0),y.domain()[1]>0?12:0])}else{y.range(yRange||[availableHeight,0])}x0=x0||x;y0=y0||y.copy().range([y(0),y(0)]);var wrap=container.selectAll("g.nv-wrap.nv-discretebar").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-discretebar");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);groups.exit().transition().style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover});groups.transition().style("stroke-opacity",1).style("fill-opacity",0.75);var bars=groups.selectAll("g.nv-bar").data(function(d){return d.values});bars.exit().remove();var barsEnter=bars.enter().append("g").attr("transform",function(d,i,j){return"translate("+(x(getX(d,i))+x.rangeBand()*0.05)+", "+y(0)+")"}).on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(d.series+0.5)/data.length),y(getY(d,i))],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({value:getY(d,i),point:d,series:data[d.series],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("click",function(d,i){dispatch.elementClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(d.series+0.5)/data.length),y(getY(d,i))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(d.series+0.5)/data.length),y(getY(d,i))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()});barsEnter.append("rect").attr("height",0).attr("width",x.rangeBand()*0.9/data.length);if(showValues){barsEnter.append("text").attr("text-anchor","middle");bars.select("text").text(function(d,i){return valueFormat(getY(d,i))}).transition().attr("x",x.rangeBand()*0.9/2).attr("y",function(d,i){return getY(d,i)<0?y(getY(d,i))-y(0)+12:-4})}else{bars.selectAll("text").remove()}bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).style("fill",function(d,i){return d.color||color(d,i)}).style("stroke",function(d,i){return d.color||color(d,i)}).select("rect").attr("class",rectClass).transition().attr("width",x.rangeBand()*0.9/data.length);bars.transition().attr("transform",function(d,i){var left=x(getX(d,i))+x.rangeBand()*0.05,top=getY(d,i)<0?y(0):y(0)-y(getY(d,i))<1?y(0)-1:y(getY(d,i));return"translate("+left+", "+top+")"}).select("rect").attr("height",function(d,i){return Math.max(Math.abs(y(getY(d,i))-y((yDomain&&yDomain[0])||0))||1)});x0=x.copy();y0=y.copy()});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.showValues=function(_){if(!arguments.length){return showValues}showValues=_;return chart};chart.valueFormat=function(_){if(!arguments.length){return valueFormat}valueFormat=_;return chart};chart.rectClass=function(_){if(!arguments.length){return rectClass}rectClass=_;return chart};return chart};nv.models.discreteBarChart=function(){var discretebar=nv.models.discreteBar(),xAxis=nv.models.axis(),yAxis=nv.models.axis();var margin={top:15,right:10,bottom:50,left:60},width=null,height=null,color=nv.utils.getColor(),showXAxis=true,showYAxis=true,rightAlignYAxis=false,staggerLabels=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+x+"</h3><p>"+y+"</p>"},x,y,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","beforeUpdate"),transitionDuration=250;xAxis.orient("bottom").highlightZero(false).showMaxMin(false).tickFormat(function(d){return d});yAxis.orient((rightAlignYAxis)?"right":"left").tickFormat(d3.format(",.1f"));var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(discretebar.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(discretebar.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){dispatch.beforeUpdate();container.transition().duration(transitionDuration).call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=discretebar.xScale();y=discretebar.yScale().clamp(true);var wrap=container.selectAll("g.nv-wrap.nv-discreteBarWithAxes").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-discreteBarWithAxes").append("g");var defsEnter=gEnter.append("defs");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-barsWrap");g.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}discretebar.width(availableWidth).height(availableHeight);var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return !d.disabled}));barsWrap.transition().call(discretebar);defsEnter.append("clipPath").attr("id","nv-x-label-clip-"+discretebar.id()).append("rect");g.select("#nv-x-label-clip-"+discretebar.id()+" rect").attr("width",x.rangeBand()*(staggerLabels?2:1)).attr("height",16).attr("x",-x.rangeBand()/(staggerLabels?1:2));if(showXAxis){xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+(y.range()[0]+((discretebar.showValues()&&y.domain()[0]<0)?16:0))+")");g.select(".nv-x.nv-axis").transition().call(xAxis);var xTicks=g.select(".nv-x.nv-axis").selectAll("g");if(staggerLabels){xTicks.selectAll("text").attr("transform",function(d,i,j){return"translate(0,"+(j%2==0?"5":"17")+")"})}}if(showYAxis){yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").transition().call(yAxis)}dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}})});return chart}discretebar.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});discretebar.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.discretebar=discretebar;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,discretebar,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","id","showValues","valueFormat");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);discretebar.color(color);return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.staggerLabels=function(_){if(!arguments.length){return staggerLabels}staggerLabels=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.distribution=function(){var margin={top:0,right:0,bottom:0,left:0},width=400,size=8,axis="x",getData=function(d){return d[axis]},color=nv.utils.defaultColor(),scale=d3.scale.linear(),domain;var scale0;function chart(selection){selection.each(function(data){var availableLength=width-(axis==="x"?margin.left+margin.right:margin.top+margin.bottom),naxis=axis=="x"?"y":"x",container=d3.select(this);scale0=scale0||scale;var wrap=container.selectAll("g.nv-distribution").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-distribution");var gEnter=wrapEnter.append("g");var g=wrap.select("g");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var distWrap=g.selectAll("g.nv-dist").data(function(d){return d},function(d){return d.key});distWrap.enter().append("g");distWrap.attr("class",function(d,i){return"nv-dist nv-series-"+i}).style("stroke",function(d,i){return color(d,i)});var dist=distWrap.selectAll("line.nv-dist"+axis).data(function(d){return d.values});dist.enter().append("line").attr(axis+"1",function(d,i){return scale0(getData(d,i))}).attr(axis+"2",function(d,i){return scale0(getData(d,i))});distWrap.exit().selectAll("line.nv-dist"+axis).transition().attr(axis+"1",function(d,i){return scale(getData(d,i))}).attr(axis+"2",function(d,i){return scale(getData(d,i))}).style("stroke-opacity",0).remove();dist.attr("class",function(d,i){return"nv-dist"+axis+" nv-dist"+axis+"-"+i}).attr(naxis+"1",0).attr(naxis+"2",size);dist.transition().attr(axis+"1",function(d,i){return scale(getData(d,i))}).attr(axis+"2",function(d,i){return scale(getData(d,i))});scale0=scale.copy()});return chart}chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.axis=function(_){if(!arguments.length){return axis}axis=_;return chart};chart.size=function(_){if(!arguments.length){return size}size=_;return chart};chart.getData=function(_){if(!arguments.length){return getData}getData=d3.functor(_);return chart};chart.scale=function(_){if(!arguments.length){return scale}scale=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};return chart};nv.models.historicalBar=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(Math.random()*10000),x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},forceX=[],forceY=[0],padData=false,clipEdge=true,color=nv.utils.defaultColor(),xDomain,yDomain,xRange,yRange,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),interactive=true;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x.domain(xDomain||d3.extent(data[0].values.map(getX).concat(forceX)));if(padData){x.range(xRange||[availableWidth*0.5/data[0].values.length,availableWidth*(data[0].values.length-0.5)/data[0].values.length])}else{x.range(xRange||[0,availableWidth])}y.domain(yDomain||d3.extent(data[0].values.map(getY).concat(forceY))).range(yRange||[availableHeight,0]);if(x.domain()[0]===x.domain()[1]){x.domain()[0]?x.domain([x.domain()[0]-x.domain()[0]*0.01,x.domain()[1]+x.domain()[1]*0.01]):x.domain([-1,1])}if(y.domain()[0]===y.domain()[1]){y.domain()[0]?y.domain([y.domain()[0]+y.domain()[0]*0.01,y.domain()[1]-y.domain()[1]*0.01]):y.domain([-1,1])}var wrap=container.selectAll("g.nv-wrap.nv-historicalBar-"+id).data([data[0].values]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBar-"+id);var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-bars");wrap.attr("transform","translate("+margin.left+","+margin.top+")");container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})});defsEnter.append("clipPath").attr("id","nv-chart-clip-path-"+id).append("rect");wrap.select("#nv-chart-clip-path-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-chart-clip-path-"+id+")":"");var bars=wrap.select(".nv-bars").selectAll(".nv-bar").data(function(d){return d},function(d,i){return getX(d,i)});bars.exit().remove();var barsEnter=bars.enter().append("rect").attr("x",0).attr("y",function(d,i){return nv.utils.NaNtoZero(y(Math.max(0,getY(d,i))))}).attr("height",function(d,i){return nv.utils.NaNtoZero(Math.abs(y(getY(d,i))-y(0)))}).attr("transform",function(d,i){return"translate("+(x(getX(d,i))-availableWidth/data[0].values.length*0.45)+",0)"}).on("mouseover",function(d,i){if(!interactive){return}d3.select(this).classed("hover",true);dispatch.elementMouseover({point:d,series:data[0],pos:[x(getX(d,i)),y(getY(d,i))],pointIndex:i,seriesIndex:0,e:d3.event})}).on("mouseout",function(d,i){if(!interactive){return}d3.select(this).classed("hover",false);dispatch.elementMouseout({point:d,series:data[0],pointIndex:i,seriesIndex:0,e:d3.event})}).on("click",function(d,i){if(!interactive){return}dispatch.elementClick({value:getY(d,i),data:d,index:i,pos:[x(getX(d,i)),y(getY(d,i))],e:d3.event,id:id});d3.event.stopPropagation()}).on("dblclick",function(d,i){if(!interactive){return}dispatch.elementDblClick({value:getY(d,i),data:d,index:i,pos:[x(getX(d,i)),y(getY(d,i))],e:d3.event,id:id});d3.event.stopPropagation()});bars.attr("fill",function(d,i){return color(d,i)}).attr("class",function(d,i,j){return(getY(d,i)<0?"nv-bar negative":"nv-bar positive")+" nv-bar-"+j+"-"+i}).transition().attr("transform",function(d,i){return"translate("+(x(getX(d,i))-availableWidth/data[0].values.length*0.45)+",0)"}).attr("width",(availableWidth/data[0].values.length)*0.9);bars.transition().attr("y",function(d,i){var rval=getY(d,i)<0?y(0):y(0)-y(getY(d,i))<1?y(0)-1:y(getY(d,i));return nv.utils.NaNtoZero(rval)}).attr("height",function(d,i){return nv.utils.NaNtoZero(Math.max(Math.abs(y(getY(d,i))-y(0)),1))})});return chart}chart.highlightPoint=function(pointIndex,isHoverOver){d3.select(".nv-historicalBar-"+id).select(".nv-bars .nv-bar-0-"+pointIndex).classed("hover",isHoverOver)};chart.clearHighlights=function(){d3.select(".nv-historicalBar-"+id).select(".nv-bars .nv-bar.hover").classed("hover",false)};chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceX=function(_){if(!arguments.length){return forceX}forceX=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.padData=function(_){if(!arguments.length){return padData}padData=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.interactive=function(_){if(!arguments.length){return interactive}interactive=false;return chart};return chart};nv.models.historicalBarChart=function(){var bars=nv.models.historicalBar(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend();var margin={top:30,right:90,bottom:50,left:90},color=nv.utils.defaultColor(),width=null,height=null,showLegend=false,showXAxis=true,showYAxis=true,rightAlignYAxis=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,y,state={},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),transitionDuration=250;xAxis.orient("bottom").tickPadding(7);yAxis.orient((rightAlignYAxis)?"right":"left");var showTooltip=function(e,offsetElement){if(offsetElement){var svg=d3.select(offsetElement).select("svg");var viewBox=(svg.node())?svg.attr("viewBox"):null;if(viewBox){viewBox=viewBox.split(" ");var ratio=parseInt(svg.style("width"))/viewBox[2];e.pos[0]=e.pos[0]*ratio;e.pos[1]=e.pos[1]*ratio}}var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(bars.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(bars.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=bars.xScale();y=bars.yScale();var wrap=container.selectAll("g.nv-wrap.nv-historicalBarChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBarChart").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-barsWrap");gEnter.append("g").attr("class","nv-legendWrap");if(showLegend){legend.width(availableWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}wrap.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}bars.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return !d.disabled}));barsWrap.transition().call(bars);if(showXAxis){xAxis.scale(x).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")");g.select(".nv-x.nv-axis").transition().call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").transition().call(yAxis)}legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(!data.filter(function(d){return !d.disabled}).length){data.map(function(d){d.disabled=false;wrap.selectAll(".nv-series").classed("disabled",false);return d})}state.disabled=data.map(function(d){return !!d.disabled});dispatch.stateChange(state);selection.transition().call(chart)});legend.dispatch.on("legendDblclick",function(d){data.forEach(function(d){d.disabled=true});d.disabled=false;state.disabled=data.map(function(d){return !!d.disabled});dispatch.stateChange(state);chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}selection.call(chart)})});return chart}bars.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});bars.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.bars=bars;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,bars,"defined","isArea","x","y","size","xScale","yScale","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","id","interpolate","highlightPoint","clearHighlights","interactive");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.indentedTree=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=nv.utils.defaultColor(),id=Math.floor(Math.random()*10000),header=true,filterZero=false,noData="No Data Available.",childIndent=20,columns=[{key:"key",label:"Name",type:"text"}],tableClass=null,iconOpen="images/grey-plus.png",iconClose="images/grey-minus.png",dispatch=d3.dispatch("elementClick","elementDblclick","elementMouseover","elementMouseout"),getUrl=function(d){return d.url};var idx=0;function chart(selection){selection.each(function(data){var depth=1,container=d3.select(this);var tree=d3.layout.tree().children(function(d){return d.values}).size([height,childIndent]);chart.update=function(){container.transition().duration(600).call(chart)};if(!data[0]){data[0]={key:noData}}var nodes=tree.nodes(data[0]);var wrap=d3.select(this).selectAll("div").data([[nodes]]);var wrapEnter=wrap.enter().append("div").attr("class","nvd3 nv-wrap nv-indentedtree");var tableEnter=wrapEnter.append("table");var table=wrap.select("table").attr("width","100%").attr("class",tableClass);if(header){var thead=tableEnter.append("thead");var theadRow1=thead.append("tr");columns.forEach(function(column){theadRow1.append("th").attr("width",column.width?column.width:"10%").style("text-align",column.type=="numeric"?"right":"left").append("span").text(column.label)})}var tbody=table.selectAll("tbody").data(function(d){return d});tbody.enter().append("tbody");depth=d3.max(nodes,function(node){return node.depth});tree.size([height,depth*childIndent]);var node=tbody.selectAll("tr").data(function(d){return d.filter(function(d){return(filterZero&&!d.children)?filterZero(d):true})},function(d,i){return d.id||(d.id||++idx)});node.exit().remove();node.select("img.nv-treeicon").attr("src",icon).classed("folded",folded);var nodeEnter=node.enter().append("tr");columns.forEach(function(column,index){var nodeName=nodeEnter.append("td").style("padding-left",function(d){return(index?0:d.depth*childIndent+12+(icon(d)?0:16))+"px"},"important").style("text-align",column.type=="numeric"?"right":"left");if(index==0){nodeName.append("img").classed("nv-treeicon",true).classed("nv-folded",folded).attr("src",icon).style("width","14px").style("height","14px").style("padding","0 1px").style("display",function(d){return icon(d)?"inline-block":"none"}).on("click",click)}nodeName.each(function(d){if(!index&&getUrl(d)){d3.select(this).append("a").attr("href",getUrl).attr("class",d3.functor(column.classes)).append("span")}else{d3.select(this).append("span")}d3.select(this).select("span").attr("class",d3.functor(column.classes)).text(function(d){return column.format?column.format(d):(d[column.key]||"-")})});if(column.showCount){nodeName.append("span").attr("class","nv-childrenCount");node.selectAll("span.nv-childrenCount").text(function(d){return((d.values&&d.values.length)||(d._values&&d._values.length))?"("+((d.values&&(d.values.filter(function(d){return filterZero?filterZero(d):true}).length))||(d._values&&d._values.filter(function(d){return filterZero?filterZero(d):true}).length)||0)+")":""})}});node.order().on("click",function(d){dispatch.elementClick({row:this,data:d,pos:[d.x,d.y]})}).on("dblclick",function(d){dispatch.elementDblclick({row:this,data:d,pos:[d.x,d.y]})}).on("mouseover",function(d){dispatch.elementMouseover({row:this,data:d,pos:[d.x,d.y]})}).on("mouseout",function(d){dispatch.elementMouseout({row:this,data:d,pos:[d.x,d.y]})});function click(d,_,unshift){d3.event.stopPropagation();if(d3.event.shiftKey&&!unshift){d3.event.shiftKey=false;d.values&&d.values.forEach(function(node){if(node.values||node._values){click(node,0,true)}});return true}if(!hasChildren(d)){return true}if(d.values){d._values=d.values;d.values=null}else{d.values=d._values;d._values=null}chart.update()}function icon(d){return(d._values&&d._values.length)?iconOpen:(d.values&&d.values.length)?iconClose:""}function folded(d){return(d._values&&d._values.length)}function hasChildren(d){var values=d.values||d._values;return(values&&values.length)}});return chart}chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);scatter.color(color);return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.header=function(_){if(!arguments.length){return header}header=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.filterZero=function(_){if(!arguments.length){return filterZero}filterZero=_;return chart};chart.columns=function(_){if(!arguments.length){return columns}columns=_;return chart};chart.tableClass=function(_){if(!arguments.length){return tableClass}tableClass=_;return chart};chart.iconOpen=function(_){if(!arguments.length){return iconOpen}iconOpen=_;return chart};chart.iconClose=function(_){if(!arguments.length){return iconClose}iconClose=_;return chart};chart.getUrl=function(_){if(!arguments.length){return getUrl}getUrl=_;return chart};return chart};nv.models.legend=function(){var margin={top:5,right:0,bottom:5,left:0},width=400,height=20,getKey=function(d){return d.key},color=nv.utils.defaultColor(),align=true,rightAlign=true,updateState=true,radioButtonMode=false,dispatch=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout","stateChange");function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,container=d3.select(this);var wrap=container.selectAll("g.nv-legend").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-legend").append("g");var g=wrap.select("g");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var series=g.selectAll(".nv-series").data(function(d){return d});var seriesEnter=series.enter().append("g").attr("class","nv-series").on("mouseover",function(d,i){dispatch.legendMouseover(d,i)}).on("mouseout",function(d,i){dispatch.legendMouseout(d,i)}).on("click",function(d,i){dispatch.legendClick(d,i);if(updateState){if(radioButtonMode){data.forEach(function(series){series.disabled=true});d.disabled=false}else{d.disabled=!d.disabled;if(data.every(function(series){return series.disabled})){data.forEach(function(series){series.disabled=false})}}dispatch.stateChange({disabled:data.map(function(d){return !!d.disabled})})}}).on("dblclick",function(d,i){dispatch.legendDblclick(d,i);if(updateState){data.forEach(function(series){series.disabled=true});d.disabled=false;dispatch.stateChange({disabled:data.map(function(d){return !!d.disabled})})}});seriesEnter.append("circle").style("stroke-width",2).attr("class","nv-legend-symbol").attr("r",5);seriesEnter.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dy",".32em").attr("dx","8");series.classed("disabled",function(d){return d.disabled});series.exit().remove();series.select("circle").style("fill",function(d,i){return d.color||color(d,i)}).style("stroke",function(d,i){return d.color||color(d,i)});series.select("text").text(getKey);if(align){var seriesWidths=[];series.each(function(d,i){var legendText=d3.select(this).select("text");var nodeTextLength;try{nodeTextLength=legendText.node().getComputedTextLength()}catch(e){nodeTextLength=nv.utils.calcApproxTextWidth(legendText)}seriesWidths.push(nodeTextLength+28)});var seriesPerRow=0;var legendWidth=0;var columnWidths=[];while(legendWidth<availableWidth&&seriesPerRow<seriesWidths.length){columnWidths[seriesPerRow]=seriesWidths[seriesPerRow];legendWidth+=seriesWidths[seriesPerRow++]}if(seriesPerRow===0){seriesPerRow=1}while(legendWidth>availableWidth&&seriesPerRow>1){columnWidths=[];seriesPerRow--;for(var k=0;k<seriesWidths.length;k++){if(seriesWidths[k]>(columnWidths[k%seriesPerRow]||0)){columnWidths[k%seriesPerRow]=seriesWidths[k]}}legendWidth=columnWidths.reduce(function(prev,cur,index,array){return prev+cur})}var xPositions=[];for(var i=0,curX=0;i<seriesPerRow;i++){xPositions[i]=curX;curX+=columnWidths[i]}series.attr("transform",function(d,i){return"translate("+xPositions[i%seriesPerRow]+","+(5+Math.floor(i/seriesPerRow)*20)+")"});if(rightAlign){g.attr("transform","translate("+(width-margin.right-legendWidth)+","+margin.top+")")}else{g.attr("transform","translate(0,"+margin.top+")")}height=margin.top+margin.bottom+(Math.ceil(seriesWidths.length/seriesPerRow)*20)}else{var ypos=5,newxpos=5,maxwidth=0,xpos;series.attr("transform",function(d,i){var length=d3.select(this).select("text").node().getComputedTextLength()+28;xpos=newxpos;if(width<margin.left+margin.right+xpos+length){newxpos=xpos=5;ypos+=20}newxpos+=length;if(newxpos>maxwidth){maxwidth=newxpos}return"translate("+xpos+","+ypos+")"});g.attr("transform","translate("+(width-margin.right-maxwidth)+","+margin.top+")");height=margin.top+margin.bottom+ypos+15}});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.key=function(_){if(!arguments.length){return getKey}getKey=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.align=function(_){if(!arguments.length){return align}align=_;return chart};chart.rightAlign=function(_){if(!arguments.length){return rightAlign}rightAlign=_;return chart};chart.updateState=function(_){if(!arguments.length){return updateState}updateState=_;return chart};chart.radioButtonMode=function(_){if(!arguments.length){return radioButtonMode}radioButtonMode=_;return chart};return chart};nv.models.line=function(){var scatter=nv.models.scatter();var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=nv.utils.defaultColor(),getX=function(d){return d.x},getY=function(d){return d.y},defined=function(d,i){return !isNaN(getY(d,i))&&getY(d,i)!==null},isArea=function(d){return d.area},clipEdge=false,x,y,interpolate="linear";scatter.size(16).sizeDomain([16,256]);var x0,y0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x=scatter.xScale();y=scatter.yScale();x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-line").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-line");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");gEnter.append("g").attr("class","nv-scatterWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");scatter.width(availableWidth).height(availableHeight);var scatterWrap=wrap.select(".nv-scatterWrap");scatterWrap.transition().call(scatter);defsEnter.append("clipPath").attr("id","nv-edge-clip-"+scatter.id()).append("rect");wrap.select("#nv-edge-clip-"+scatter.id()+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+scatter.id()+")":"");scatterWrap.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+scatter.id()+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);groups.exit().transition().style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)});groups.transition().style("stroke-opacity",1).style("fill-opacity",0.5);var areaPaths=groups.selectAll("path.nv-area").data(function(d){return isArea(d)?[d]:[]});areaPaths.enter().append("path").attr("class","nv-area").attr("d",function(d){return d3.svg.area().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x0(getX(d,i)))}).y0(function(d,i){return nv.utils.NaNtoZero(y0(getY(d,i)))}).y1(function(d,i){return y0(y.domain()[0]<=0?y.domain()[1]>=0?0:y.domain()[1]:y.domain()[0])}).apply(this,[d.values])});groups.exit().selectAll("path.nv-area").remove();areaPaths.transition().attr("d",function(d){return d3.svg.area().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).y0(function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}).y1(function(d,i){return y(y.domain()[0]<=0?y.domain()[1]>=0?0:y.domain()[1]:y.domain()[0])}).apply(this,[d.values])});var linePaths=groups.selectAll("path.nv-line").data(function(d){return[d.values]});linePaths.enter().append("path").attr("class","nv-line").attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x0(getX(d,i)))}).y(function(d,i){return nv.utils.NaNtoZero(y0(getY(d,i)))}));groups.exit().selectAll("path.nv-line").transition().attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).y(function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}));linePaths.transition().attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).y(function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}));x0=x.copy();y0=y.copy()});return chart}chart.dispatch=scatter.dispatch;chart.scatter=scatter;d3.rebind(chart,scatter,"id","interactive","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","forceX","forceY","forceSize","clipVoronoi","useVoronoi","clipRadius","padData","highlightPoint","clearHighlights");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;scatter.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;scatter.y(_);return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);scatter.color(color);return chart};chart.interpolate=function(_){if(!arguments.length){return interpolate}interpolate=_;return chart};chart.defined=function(_){if(!arguments.length){return defined}defined=_;return chart};chart.isArea=function(_){if(!arguments.length){return isArea}isArea=d3.functor(_);return chart};return chart};nv.models.lineChart=function(){var lines=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),interactiveLayer=nv.interactiveGuideline();var margin={top:30,right:20,bottom:50,left:60},color=nv.utils.defaultColor(),width=null,height=null,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,useInteractiveGuideline=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,y,state={},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),transitionDuration=250;xAxis.orient("bottom").tickPadding(7);yAxis.orient((rightAlignYAxis)?"right":"left");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=lines.xScale();y=lines.yScale();var wrap=container.selectAll("g.nv-wrap.nv-lineChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-lineChart").append("g");var g=wrap.select("g");gEnter.append("rect").style("opacity",0);gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-linesWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-interactive");g.select("rect").attr("width",availableWidth).attr("height",availableHeight);if(showLegend){legend.width(availableWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}wrap.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}if(useInteractiveGuideline){interactiveLayer.width(availableWidth).height(availableHeight).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x);wrap.select(".nv-interactive").call(interactiveLayer)}lines.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));var linesWrap=g.select(".nv-linesWrap").datum(data.filter(function(d){return !d.disabled}));linesWrap.transition().call(lines);if(showXAxis){xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")");g.select(".nv-x.nv-axis").transition().call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").transition().call(yAxis)}legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});interactiveLayer.dispatch.on("elementMousemove",function(e){lines.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];data.filter(function(series,i){series.seriesIndex=i;return !series.disabled}).forEach(function(series,i){pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x());lines.highlightPoint(i,pointIndex,true);var point=series.values[pointIndex];if(typeof point==="undefined"){return}if(typeof singlePoint==="undefined"){singlePoint=point}if(typeof pointXLocation==="undefined"){pointXLocation=chart.xScale()(chart.x()(point,pointIndex))}allData.push({key:series.key,value:chart.y()(point,pointIndex),color:color(series,series.seriesIndex)})});if(allData.length>2){var yValue=chart.yScale().invert(e.mouseY);var domainExtent=Math.abs(chart.yScale().domain()[0]-chart.yScale().domain()[1]);var threshold=0.03*domainExtent;var indexToHighlight=nv.nearestValueIndex(allData.map(function(d){return d.value}),yValue,threshold);if(indexToHighlight!==null){allData[indexToHighlight].highlight=true}}var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex));interactiveLayer.tooltip.position({left:pointXLocation+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).enabled(tooltips).valueFormatter(function(d,i){return yAxis.tickFormat()(d)}).data({value:xValue,series:allData})();interactiveLayer.renderGuideLine(pointXLocation)});interactiveLayer.dispatch.on("elementMouseout",function(e){dispatch.tooltipHide();lines.clearHighlights()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}chart.update()})});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.lines=lines;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.interactiveLayer=interactiveLayer;d3.rebind(chart,lines,"defined","isArea","x","y","size","xScale","yScale","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","useVoronoi","id","interpolate");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.useInteractiveGuideline=function(_){if(!arguments.length){return useInteractiveGuideline}useInteractiveGuideline=_;if(_===true){chart.interactive(false);chart.useVoronoi(false)}return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.linePlusBarChart=function(){var lines=nv.models.line(),bars=nv.models.historicalBar(),xAxis=nv.models.axis(),y1Axis=nv.models.axis(),y2Axis=nv.models.axis(),legend=nv.models.legend();var margin={top:30,right:60,bottom:50,left:60},width=null,height=null,getX=function(d){return d.x},getY=function(d){return d.y},color=nv.utils.defaultColor(),showLegend=true,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,y1,y2,state={},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState");bars.padData(true);lines.clipEdge(false).padData(true);xAxis.orient("bottom").tickPadding(7).highlightZero(false);y1Axis.orient("left");y2Axis.orient("right");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=(e.series.bar?y1Axis:y2Axis).tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().call(chart)};state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var dataBars=data.filter(function(d){return !d.disabled&&d.bar});var dataLines=data.filter(function(d){return !d.bar});x=dataLines.filter(function(d){return !d.disabled}).length&&dataLines.filter(function(d){return !d.disabled})[0].values.length?lines.xScale():bars.xScale();y1=bars.yScale();y2=lines.yScale();var wrap=d3.select(this).selectAll("g.nv-wrap.nv-linePlusBar").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-linePlusBar").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y1 nv-axis");gEnter.append("g").attr("class","nv-y2 nv-axis");gEnter.append("g").attr("class","nv-barsWrap");gEnter.append("g").attr("class","nv-linesWrap");gEnter.append("g").attr("class","nv-legendWrap");if(showLegend){legend.width(availableWidth/2);g.select(".nv-legendWrap").datum(data.map(function(series){series.originalKey=series.originalKey===undefined?series.key:series.originalKey;series.key=series.originalKey+(series.bar?" (left axis)":" (right axis)");return series})).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate("+(availableWidth/2)+","+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");lines.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&!data[i].bar}));bars.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&data[i].bar}));var barsWrap=g.select(".nv-barsWrap").datum(dataBars.length?dataBars:[{values:[]}]);var linesWrap=g.select(".nv-linesWrap").datum(dataLines[0]&&!dataLines[0].disabled?dataLines:[{values:[]}]);d3.transition(barsWrap).call(bars);d3.transition(linesWrap).call(lines);xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y1.range()[0]+")");d3.transition(g.select(".nv-x.nv-axis")).call(xAxis);y1Axis.scale(y1).ticks(availableHeight/36).tickSize(-availableWidth,0);d3.transition(g.select(".nv-y1.nv-axis")).style("opacity",dataBars.length?1:0).call(y1Axis);y2Axis.scale(y2).ticks(availableHeight/36).tickSize(dataBars.length?0:-availableWidth,0);g.select(".nv-y2.nv-axis").style("opacity",dataLines.length?1:0).attr("transform","translate("+availableWidth+",0)");d3.transition(g.select(".nv-y2.nv-axis")).call(y2Axis);legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}chart.update()})});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});bars.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});bars.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.legend=legend;chart.lines=lines;chart.bars=bars;chart.xAxis=xAxis;chart.y1Axis=y1Axis;chart.y2Axis=y2Axis;d3.rebind(chart,lines,"defined","size","clipVoronoi","interpolate");chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;lines.x(_);bars.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;lines.y(_);bars.y(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.lineWithFocusChart=function(){var lines=nv.models.line(),lines2=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),x2Axis=nv.models.axis(),y2Axis=nv.models.axis(),legend=nv.models.legend(),brush=d3.svg.brush();var margin={top:30,right:30,bottom:30,left:60},margin2={top:0,right:30,bottom:20,left:60},color=nv.utils.defaultColor(),width=null,height=null,height2=100,x,y,x2,y2,showLegend=true,brushExtent=null,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","brush"),transitionDuration=250;lines.clipEdge(true);lines2.interactive(false);xAxis.orient("bottom").tickPadding(5);yAxis.orient("left");x2Axis.orient("bottom").tickPadding(5);y2Axis.orient("left");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight1=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom-height2,availableHeight2=height2-margin2.top-margin2.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight1/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=lines.xScale();y=lines.yScale();x2=lines2.xScale();y2=lines2.yScale();var wrap=container.selectAll("g.nv-wrap.nv-lineWithFocusChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-lineWithFocusChart").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-legendWrap");var focusEnter=gEnter.append("g").attr("class","nv-focus");focusEnter.append("g").attr("class","nv-x nv-axis");focusEnter.append("g").attr("class","nv-y nv-axis");focusEnter.append("g").attr("class","nv-linesWrap");var contextEnter=gEnter.append("g").attr("class","nv-context");contextEnter.append("g").attr("class","nv-x nv-axis");contextEnter.append("g").attr("class","nv-y nv-axis");contextEnter.append("g").attr("class","nv-linesWrap");contextEnter.append("g").attr("class","nv-brushBackground");contextEnter.append("g").attr("class","nv-x nv-brush");if(showLegend){legend.width(availableWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight1=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom-height2}g.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");lines.width(availableWidth).height(availableHeight1).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));lines2.defined(lines.defined()).width(availableWidth).height(availableHeight2).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));g.select(".nv-context").attr("transform","translate(0,"+(availableHeight1+margin.bottom+margin2.top)+")");var contextLinesWrap=g.select(".nv-context .nv-linesWrap").datum(data.filter(function(d){return !d.disabled}));d3.transition(contextLinesWrap).call(lines2);xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight1,0);yAxis.scale(y).ticks(availableHeight1/36).tickSize(-availableWidth,0);g.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+availableHeight1+")");brush.x(x2).on("brush",function(){var oldTransition=chart.transitionDuration();chart.transitionDuration(0);onBrush();chart.transitionDuration(oldTransition)});if(brushExtent){brush.extent(brushExtent)}var brushBG=g.select(".nv-brushBackground").selectAll("g").data([brushExtent||brush.extent()]);var brushBGenter=brushBG.enter().append("g");brushBGenter.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",availableHeight2);brushBGenter.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",availableHeight2);var gBrush=g.select(".nv-x.nv-brush").call(brush);gBrush.selectAll("rect").attr("height",availableHeight2);gBrush.selectAll(".resize").append("path").attr("d",resizePath);onBrush();x2Axis.scale(x2).ticks(availableWidth/100).tickSize(-availableHeight2,0);g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y2.range()[0]+")");d3.transition(g.select(".nv-context .nv-x.nv-axis")).call(x2Axis);y2Axis.scale(y2).ticks(availableHeight2/36).tickSize(-availableWidth,0);d3.transition(g.select(".nv-context .nv-y.nv-axis")).call(y2Axis);g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y2.range()[0]+")");legend.dispatch.on("stateChange",function(newState){chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});function resizePath(d){var e=+(d=="e"),x=e?1:-1,y=availableHeight2/3;return"M"+(0.5*x)+","+y+"A6,6 0 0 "+e+" "+(6.5*x)+","+(y+6)+"V"+(2*y-6)+"A6,6 0 0 "+e+" "+(0.5*x)+","+(2*y)+"ZM"+(2.5*x)+","+(y+8)+"V"+(2*y-8)+"M"+(4.5*x)+","+(y+8)+"V"+(2*y-8)}function updateBrushBG(){if(!brush.empty()){brush.extent(brushExtent)}brushBG.data([brush.empty()?x2.domain():brushExtent]).each(function(d,i){var leftWidth=x2(d[0])-x.range()[0],rightWidth=x.range()[1]-x2(d[1]);d3.select(this).select(".left").attr("width",leftWidth<0?0:leftWidth);d3.select(this).select(".right").attr("x",x2(d[1])).attr("width",rightWidth<0?0:rightWidth)})}function onBrush(){brushExtent=brush.empty()?null:brush.extent();var extent=brush.empty()?x2.domain():brush.extent();if(Math.abs(extent[0]-extent[1])<=1){return}dispatch.brush({extent:extent,brush:brush});updateBrushBG();var focusLinesWrap=g.select(".nv-focus .nv-linesWrap").datum(data.filter(function(d){return !d.disabled}).map(function(d,i){return{key:d.key,values:d.values.filter(function(d,i){return lines.x()(d,i)>=extent[0]&&lines.x()(d,i)<=extent[1]})}}));focusLinesWrap.transition().duration(transitionDuration).call(lines);g.select(".nv-focus .nv-x.nv-axis").transition().duration(transitionDuration).call(xAxis);g.select(".nv-focus .nv-y.nv-axis").transition().duration(transitionDuration).call(yAxis)}});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.legend=legend;chart.lines=lines;chart.lines2=lines2;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.x2Axis=x2Axis;chart.y2Axis=y2Axis;d3.rebind(chart,lines,"defined","isArea","size","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","id");chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return lines.x}lines.x(_);lines2.x(_);return chart};chart.y=function(_){if(!arguments.length){return lines.y}lines.y(_);lines2.y(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.margin2=function(_){if(!arguments.length){return margin2}margin2=_;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.height2=function(_){if(!arguments.length){return height2}height2=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.interpolate=function(_){if(!arguments.length){return lines.interpolate()}lines.interpolate(_);lines2.interpolate(_);return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.xTickFormat=function(_){if(!arguments.length){return xAxis.tickFormat()}xAxis.tickFormat(_);x2Axis.tickFormat(_);return chart};chart.yTickFormat=function(_){if(!arguments.length){return yAxis.tickFormat()}yAxis.tickFormat(_);y2Axis.tickFormat(_);return chart};chart.brushExtent=function(_){if(!arguments.length){return brushExtent}brushExtent=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.linePlusBarWithFocusChart=function(){var lines=nv.models.line(),lines2=nv.models.line(),bars=nv.models.historicalBar(),bars2=nv.models.historicalBar(),xAxis=nv.models.axis(),x2Axis=nv.models.axis(),y1Axis=nv.models.axis(),y2Axis=nv.models.axis(),y3Axis=nv.models.axis(),y4Axis=nv.models.axis(),legend=nv.models.legend(),brush=d3.svg.brush();var margin={top:30,right:30,bottom:30,left:60},margin2={top:0,right:30,bottom:20,left:60},width=null,height=null,height2=100,getX=function(d){return d.x},getY=function(d){return d.y},color=nv.utils.defaultColor(),showLegend=true,extent,brushExtent=null,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,x2,y1,y2,y3,y4,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","brush"),transitionDuration=0;lines.clipEdge(true);lines2.interactive(false);xAxis.orient("bottom").tickPadding(5);y1Axis.orient("left");y2Axis.orient("right");x2Axis.orient("bottom").tickPadding(5);y3Axis.orient("left");y4Axis.orient("right");var showTooltip=function(e,offsetElement){if(extent){e.pointIndex+=Math.ceil(extent[0])}var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=(e.series.bar?y1Axis:y2Axis).tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight1=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom-height2,availableHeight2=height2-margin2.top-margin2.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight1/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var dataBars=data.filter(function(d){return !d.disabled&&d.bar});var dataLines=data.filter(function(d){return !d.bar});x=bars.xScale();x2=x2Axis.scale();y1=bars.yScale();y2=lines.yScale();y3=bars2.yScale();y4=lines2.yScale();var series1=data.filter(function(d){return !d.disabled&&d.bar}).map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i)}})});var series2=data.filter(function(d){return !d.disabled&&!d.bar}).map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i)}})});x.range([0,availableWidth]);x2.domain(d3.extent(d3.merge(series1.concat(series2)),function(d){return d.x})).range([0,availableWidth]);var wrap=container.selectAll("g.nv-wrap.nv-linePlusBar").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-linePlusBar").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-legendWrap");var focusEnter=gEnter.append("g").attr("class","nv-focus");focusEnter.append("g").attr("class","nv-x nv-axis");focusEnter.append("g").attr("class","nv-y1 nv-axis");focusEnter.append("g").attr("class","nv-y2 nv-axis");focusEnter.append("g").attr("class","nv-barsWrap");focusEnter.append("g").attr("class","nv-linesWrap");var contextEnter=gEnter.append("g").attr("class","nv-context");contextEnter.append("g").attr("class","nv-x nv-axis");contextEnter.append("g").attr("class","nv-y1 nv-axis");contextEnter.append("g").attr("class","nv-y2 nv-axis");contextEnter.append("g").attr("class","nv-barsWrap");contextEnter.append("g").attr("class","nv-linesWrap");contextEnter.append("g").attr("class","nv-brushBackground");contextEnter.append("g").attr("class","nv-x nv-brush");if(showLegend){legend.width(availableWidth/2);g.select(".nv-legendWrap").datum(data.map(function(series){series.originalKey=series.originalKey===undefined?series.key:series.originalKey;series.key=series.originalKey+(series.bar?" (left axis)":" (right axis)");return series})).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight1=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom-height2}g.select(".nv-legendWrap").attr("transform","translate("+(availableWidth/2)+","+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");bars2.width(availableWidth).height(availableHeight2).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&data[i].bar}));lines2.width(availableWidth).height(availableHeight2).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&!data[i].bar}));var bars2Wrap=g.select(".nv-context .nv-barsWrap").datum(dataBars.length?dataBars:[{values:[]}]);var lines2Wrap=g.select(".nv-context .nv-linesWrap").datum(!dataLines[0].disabled?dataLines:[{values:[]}]);g.select(".nv-context").attr("transform","translate(0,"+(availableHeight1+margin.bottom+margin2.top)+")");bars2Wrap.transition().call(bars2);lines2Wrap.transition().call(lines2);brush.x(x2).on("brush",onBrush);if(brushExtent){brush.extent(brushExtent)}var brushBG=g.select(".nv-brushBackground").selectAll("g").data([brushExtent||brush.extent()]);var brushBGenter=brushBG.enter().append("g");brushBGenter.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",availableHeight2);brushBGenter.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",availableHeight2);var gBrush=g.select(".nv-x.nv-brush").call(brush);gBrush.selectAll("rect").attr("height",availableHeight2);gBrush.selectAll(".resize").append("path").attr("d",resizePath);x2Axis.ticks(availableWidth/100).tickSize(-availableHeight2,0);g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y3.range()[0]+")");g.select(".nv-context .nv-x.nv-axis").transition().call(x2Axis);y3Axis.scale(y3).ticks(availableHeight2/36).tickSize(-availableWidth,0);g.select(".nv-context .nv-y1.nv-axis").style("opacity",dataBars.length?1:0).attr("transform","translate(0,"+x2.range()[0]+")");g.select(".nv-context .nv-y1.nv-axis").transition().call(y3Axis);y4Axis.scale(y4).ticks(availableHeight2/36).tickSize(dataBars.length?0:-availableWidth,0);g.select(".nv-context .nv-y2.nv-axis").style("opacity",dataLines.length?1:0).attr("transform","translate("+x2.range()[1]+",0)");g.select(".nv-context .nv-y2.nv-axis").transition().call(y4Axis);legend.dispatch.on("stateChange",function(newState){chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});function resizePath(d){var e=+(d=="e"),x=e?1:-1,y=availableHeight2/3;return"M"+(0.5*x)+","+y+"A6,6 0 0 "+e+" "+(6.5*x)+","+(y+6)+"V"+(2*y-6)+"A6,6 0 0 "+e+" "+(0.5*x)+","+(2*y)+"ZM"+(2.5*x)+","+(y+8)+"V"+(2*y-8)+"M"+(4.5*x)+","+(y+8)+"V"+(2*y-8)}function updateBrushBG(){if(!brush.empty()){brush.extent(brushExtent)}brushBG.data([brush.empty()?x2.domain():brushExtent]).each(function(d,i){var leftWidth=x2(d[0])-x2.range()[0],rightWidth=x2.range()[1]-x2(d[1]);d3.select(this).select(".left").attr("width",leftWidth<0?0:leftWidth);d3.select(this).select(".right").attr("x",x2(d[1])).attr("width",rightWidth<0?0:rightWidth)})}function onBrush(){brushExtent=brush.empty()?null:brush.extent();extent=brush.empty()?x2.domain():brush.extent();dispatch.brush({extent:extent,brush:brush});updateBrushBG();bars.width(availableWidth).height(availableHeight1).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&data[i].bar}));lines.width(availableWidth).height(availableHeight1).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&!data[i].bar}));var focusBarsWrap=g.select(".nv-focus .nv-barsWrap").datum(!dataBars.length?[{values:[]}]:dataBars.map(function(d,i){return{key:d.key,values:d.values.filter(function(d,i){return bars.x()(d,i)>=extent[0]&&bars.x()(d,i)<=extent[1]})}}));var focusLinesWrap=g.select(".nv-focus .nv-linesWrap").datum(dataLines[0].disabled?[{values:[]}]:dataLines.map(function(d,i){return{key:d.key,values:d.values.filter(function(d,i){return lines.x()(d,i)>=extent[0]&&lines.x()(d,i)<=extent[1]})}}));if(dataBars.length){x=bars.xScale()}else{x=lines.xScale()}xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight1,0);xAxis.domain([Math.ceil(extent[0]),Math.floor(extent[1])]);g.select(".nv-x.nv-axis").transition().duration(transitionDuration).call(xAxis);focusBarsWrap.transition().duration(transitionDuration).call(bars);focusLinesWrap.transition().duration(transitionDuration).call(lines);g.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+y1.range()[0]+")");y1Axis.scale(y1).ticks(availableHeight1/36).tickSize(-availableWidth,0);g.select(".nv-focus .nv-y1.nv-axis").style("opacity",dataBars.length?1:0);y2Axis.scale(y2).ticks(availableHeight1/36).tickSize(dataBars.length?0:-availableWidth,0);g.select(".nv-focus .nv-y2.nv-axis").style("opacity",dataLines.length?1:0).attr("transform","translate("+x.range()[1]+",0)");g.select(".nv-focus .nv-y1.nv-axis").transition().duration(transitionDuration).call(y1Axis);g.select(".nv-focus .nv-y2.nv-axis").transition().duration(transitionDuration).call(y2Axis)}onBrush()});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});bars.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});bars.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.legend=legend;chart.lines=lines;chart.lines2=lines2;chart.bars=bars;chart.bars2=bars2;chart.xAxis=xAxis;chart.x2Axis=x2Axis;chart.y1Axis=y1Axis;chart.y2Axis=y2Axis;chart.y3Axis=y3Axis;chart.y4Axis=y4Axis;d3.rebind(chart,lines,"defined","size","clipVoronoi","interpolate");chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;lines.x(_);bars.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;lines.y(_);bars.y(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.brushExtent=function(_){if(!arguments.length){return brushExtent}brushExtent=_;return chart};return chart};nv.models.multiBar=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,x=d3.scale.ordinal(),y=d3.scale.linear(),id=Math.floor(Math.random()*10000),getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],clipEdge=true,stacked=false,stackOffset="zero",color=nv.utils.defaultColor(),hideable=false,barColor=null,disabled,delay=1200,xDomain,yDomain,xRange,yRange,groupSpacing=0.1,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");var x0,y0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);if(hideable&&data.length){hideable=[{values:data[0].values.map(function(d){return{x:d.x,y:0,series:d.series,size:0.01}})}]}if(stacked){data=d3.layout.stack().offset(stackOffset).values(function(d){return d.values}).y(getY)(!data.length&&hideable?hideable:data)}data=data.map(function(series,i){series.values=series.values.map(function(point){point.series=i;return point});return series});if(stacked){data[0].values.map(function(d,i){var posBase=0,negBase=0;data.map(function(d){var f=d.values[i];f.size=Math.abs(f.y);if(f.y<0){f.y1=negBase;negBase=negBase-f.size}else{f.y1=f.size+posBase;posBase=posBase+f.size}})})}var seriesData=(xDomain&&yDomain)?[]:data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0,y1:d.y1}})});x.domain(xDomain||d3.merge(seriesData).map(function(d){return d.x})).rangeBands(xRange||[0,availableWidth],groupSpacing);y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){return stacked?(d.y>0?d.y1:d.y1+d.y):d.y}).concat(forceY))).range(yRange||[availableHeight,0]);if(x.domain()[0]===x.domain()[1]){x.domain()[0]?x.domain([x.domain()[0]-x.domain()[0]*0.01,x.domain()[1]+x.domain()[1]*0.01]):x.domain([-1,1])}if(y.domain()[0]===y.domain()[1]){y.domain()[0]?y.domain([y.domain()[0]+y.domain()[0]*0.01,y.domain()[1]-y.domain()[1]*0.01]):y.domain([-1,1])}x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-multibar").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multibar");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");wrap.attr("transform","translate("+margin.left+","+margin.top+")");defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d,i){return i});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);groups.exit().transition().selectAll("rect.nv-bar").delay(function(d,i){return i*delay/data[0].values.length}).attr("y",function(d){return stacked?y0(d.y0):y0(0)}).attr("height",0).remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)});groups.transition().style("stroke-opacity",1).style("fill-opacity",0.75);var bars=groups.selectAll("rect.nv-bar").data(function(d){return(hideable&&!data.length)?hideable.values:d.values});bars.exit().remove();var barsEnter=bars.enter().append("rect").attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).attr("x",function(d,i,j){return stacked?0:(j*x.rangeBand()/data.length)}).attr("y",function(d){return y0(stacked?d.y0:0)}).attr("height",0).attr("width",x.rangeBand()/(stacked?1:data.length)).attr("transform",function(d,i){return"translate("+x(getX(d,i))+",0)"});bars.style("fill",function(d,i,j){return color(d,j,i)}).style("stroke",function(d,i,j){return color(d,j,i)}).on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({value:getY(d,i),point:d,series:data[d.series],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("click",function(d,i){dispatch.elementClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()});bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).transition().attr("transform",function(d,i){return"translate("+x(getX(d,i))+",0)"});if(barColor){if(!disabled){disabled=data.map(function(){return true})}bars.style("fill",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return !disabled[i]})[j]).toString()}).style("stroke",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return !disabled[i]})[j]).toString()})}if(stacked){bars.transition().delay(function(d,i){return i*delay/data[0].values.length}).attr("y",function(d,i){return y((stacked?d.y1:0))}).attr("height",function(d,i){return Math.max(Math.abs(y(d.y+(stacked?d.y0:0))-y((stacked?d.y0:0))),1)}).attr("x",function(d,i){return stacked?0:(d.series*x.rangeBand()/data.length)}).attr("width",x.rangeBand()/(stacked?1:data.length))}else{bars.transition().delay(function(d,i){return i*delay/data[0].values.length}).attr("x",function(d,i){return d.series*x.rangeBand()/data.length}).attr("width",x.rangeBand()/data.length).attr("y",function(d,i){return getY(d,i)<0?y(0):y(0)-y(getY(d,i))<1?y(0)-1:y(getY(d,i))||0}).attr("height",function(d,i){return Math.max(Math.abs(y(getY(d,i))-y(0)),1)||0})}x0=x.copy();y0=y.copy()});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.stacked=function(_){if(!arguments.length){return stacked}stacked=_;return chart};chart.stackOffset=function(_){if(!arguments.length){return stackOffset}stackOffset=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.barColor=function(_){if(!arguments.length){return barColor}barColor=nv.utils.getColor(_);return chart};chart.disabled=function(_){if(!arguments.length){return disabled}disabled=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.hideable=function(_){if(!arguments.length){return hideable}hideable=_;return chart};chart.delay=function(_){if(!arguments.length){return delay}delay=_;return chart};chart.groupSpacing=function(_){if(!arguments.length){return groupSpacing}groupSpacing=_;return chart};return chart};nv.models.multiBarChart=function(){var multibar=nv.models.multiBar(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend();var margin={top:30,right:20,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=true,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,reduceXTicks=true,staggerLabels=false,rotateLabels=0,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" on "+x+"</p>"},x,y,state={stacked:false},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),controlWidth=function(){return showControls?180:0},transitionDuration=250;multibar.stacked(false);xAxis.orient("bottom").tickPadding(7).highlightZero(true).showMaxMin(false).tickFormat(function(d){return d});yAxis.orient((rightAlignYAxis)?"right":"left").tickFormat(d3.format(",.1f"));controls.updateState(false);var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(multibar.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(multibar.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=multibar.xScale();y=multibar.yScale();var wrap=container.selectAll("g.nv-wrap.nv-multiBarWithLegend").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarWithLegend").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-barsWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");if(showLegend){legend.width(availableWidth-controlWidth());if(multibar.barColor()){data.forEach(function(series,i){series.color=d3.rgb("#ccc").darker(i*1.5).toString()})}g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate("+controlWidth()+","+(-margin.top)+")")}if(showControls){var controlsData=[{key:"Grouped",disabled:multibar.stacked()},{key:"Stacked",disabled:!multibar.stacked()}];controls.width(controlWidth()).color(["#444","#444","#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}multibar.disabled(data.map(function(series){return series.disabled})).width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return !d.disabled}));barsWrap.transition().call(multibar);if(showXAxis){xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")");g.select(".nv-x.nv-axis").transition().call(xAxis);var xTicks=g.select(".nv-x.nv-axis > g").selectAll("g");xTicks.selectAll("line, text").style("opacity",1);if(staggerLabels){var getTranslate=function(x,y){return"translate("+x+","+y+")"};var staggerUp=5,staggerDown=17;xTicks.selectAll("text").attr("transform",function(d,i,j){return getTranslate(0,(j%2==0?staggerUp:staggerDown))});var totalInBetweenTicks=d3.selectAll(".nv-x.nv-axis .nv-wrap g g text")[0].length;g.selectAll(".nv-x.nv-axis .nv-axisMaxMin text").attr("transform",function(d,i){return getTranslate(0,(i===0||totalInBetweenTicks%2!==0)?staggerDown:staggerUp)})}if(reduceXTicks){xTicks.filter(function(d,i){return i%Math.ceil(data[0].values.length/(availableWidth/100))!==0}).selectAll("text, line").style("opacity",0)}if(rotateLabels){xTicks.selectAll(".tick text").attr("transform","rotate("+rotateLabels+" 0,0)").style("text-anchor",rotateLabels>0?"start":"end")}g.select(".nv-x.nv-axis").selectAll("g.nv-axisMaxMin text").style("opacity",1)}if(showYAxis){yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").transition().call(yAxis)}legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});controls.dispatch.on("legendClick",function(d,i){if(!d.disabled){return}controlsData=controlsData.map(function(s){s.disabled=true;return s});d.disabled=false;switch(d.key){case"Grouped":multibar.stacked(false);break;case"Stacked":multibar.stacked(true);break}state.stacked=multibar.stacked();dispatch.stateChange(state);chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}if(typeof e.stacked!=="undefined"){multibar.stacked(e.stacked);state.stacked=e.stacked}chart.update()})});return chart}multibar.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});multibar.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.multibar=multibar;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,multibar,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","clipEdge","id","stacked","stackOffset","delay","barColor","groupSpacing");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.reduceXTicks=function(_){if(!arguments.length){return reduceXTicks}reduceXTicks=_;return chart};chart.rotateLabels=function(_){if(!arguments.length){return rotateLabels}rotateLabels=_;return chart};chart.staggerLabels=function(_){if(!arguments.length){return staggerLabels}staggerLabels=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.multiBarHorizontal=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(Math.random()*10000),x=d3.scale.ordinal(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],color=nv.utils.defaultColor(),barColor=null,disabled,stacked=false,showValues=false,valuePadding=60,valueFormat=d3.format(",.2f"),delay=1200,xDomain,yDomain,xRange,yRange,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");var x0,y0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);if(stacked){data=d3.layout.stack().offset("zero").values(function(d){return d.values}).y(getY)(data)}data=data.map(function(series,i){series.values=series.values.map(function(point){point.series=i;return point});return series});if(stacked){data[0].values.map(function(d,i){var posBase=0,negBase=0;data.map(function(d){var f=d.values[i];f.size=Math.abs(f.y);if(f.y<0){f.y1=negBase-f.size;negBase=negBase-f.size}else{f.y1=posBase;posBase=posBase+f.size}})})}var seriesData=(xDomain&&yDomain)?[]:data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0,y1:d.y1}})});x.domain(xDomain||d3.merge(seriesData).map(function(d){return d.x})).rangeBands(xRange||[0,availableHeight],0.1);y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){return stacked?(d.y>0?d.y1+d.y:d.y1):d.y}).concat(forceY)));if(showValues&&!stacked){y.range(yRange||[(y.domain()[0]<0?valuePadding:0),availableWidth-(y.domain()[1]>0?valuePadding:0)])}else{y.range(yRange||[0,availableWidth])}x0=x0||x;y0=y0||d3.scale.linear().domain(y.domain()).range([y(0),y(0)]);var wrap=d3.select(this).selectAll("g.nv-wrap.nv-multibarHorizontal").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multibarHorizontal");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d,i){return i});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);groups.exit().transition().style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)});groups.transition().style("stroke-opacity",1).style("fill-opacity",0.75);var bars=groups.selectAll("g.nv-bar").data(function(d){return d.values});bars.exit().remove();var barsEnter=bars.enter().append("g").attr("transform",function(d,i,j){return"translate("+y0(stacked?d.y0:0)+","+(stacked?0:(j*x.rangeBand()/data.length)+x(getX(d,i)))+")"});barsEnter.append("rect").attr("width",0).attr("height",x.rangeBand()/(stacked?1:data.length));bars.on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({value:getY(d,i),point:d,series:data[d.series],pos:[y(getY(d,i)+(stacked?d.y0:0)),x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length)],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({value:getY(d,i),point:d,series:data[d.series],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("click",function(d,i){dispatch.elementClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()});barsEnter.append("text");if(showValues&&!stacked){bars.select("text").attr("text-anchor",function(d,i){return getY(d,i)<0?"end":"start"}).attr("y",x.rangeBand()/(data.length*2)).attr("dy",".32em").text(function(d,i){return valueFormat(getY(d,i))});bars.transition().select("text").attr("x",function(d,i){return getY(d,i)<0?-4:y(getY(d,i))-y(0)+4})}else{bars.selectAll("text").text("")}bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"});if(barColor){if(!disabled){disabled=data.map(function(){return true})}bars.style("fill",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return !disabled[i]})[j]).toString()}).style("stroke",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return !disabled[i]})[j]).toString()})}if(stacked){bars.transition().attr("transform",function(d,i){return"translate("+y(d.y1)+","+x(getX(d,i))+")"}).select("rect").attr("width",function(d,i){return Math.abs(y(getY(d,i)+d.y0)-y(d.y0))}).attr("height",x.rangeBand())}else{bars.transition().attr("transform",function(d,i){return"translate("+(getY(d,i)<0?y(getY(d,i)):y(0))+","+(d.series*x.rangeBand()/data.length+x(getX(d,i)))+")"}).select("rect").attr("height",x.rangeBand()/data.length).attr("width",function(d,i){return Math.max(Math.abs(y(getY(d,i))-y(0)),1)})}x0=x.copy();y0=y.copy()});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.stacked=function(_){if(!arguments.length){return stacked}stacked=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.barColor=function(_){if(!arguments.length){return barColor}barColor=nv.utils.getColor(_);return chart};chart.disabled=function(_){if(!arguments.length){return disabled}disabled=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.delay=function(_){if(!arguments.length){return delay}delay=_;return chart};chart.showValues=function(_){if(!arguments.length){return showValues}showValues=_;return chart};chart.valueFormat=function(_){if(!arguments.length){return valueFormat}valueFormat=_;return chart};chart.valuePadding=function(_){if(!arguments.length){return valuePadding}valuePadding=_;return chart};return chart};nv.models.multiBarHorizontalChart=function(){var multibar=nv.models.multiBarHorizontal(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend().height(30),controls=nv.models.legend().height(30);var margin={top:30,right:20,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=true,showLegend=true,stacked=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+" - "+x+"</h3><p>"+y+"</p>"},x,y,state={stacked:stacked},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),controlWidth=function(){return showControls?180:0},transitionDuration=250;multibar.stacked(stacked);xAxis.orient("left").tickPadding(5).highlightZero(false).showMaxMin(false).tickFormat(function(d){return d});yAxis.orient("bottom").tickFormat(d3.format(",.1f"));controls.updateState(false);var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(multibar.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(multibar.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"e":"w",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=multibar.xScale();y=multibar.yScale();var wrap=container.selectAll("g.nv-wrap.nv-multiBarHorizontalChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarHorizontalChart").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-barsWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");if(showLegend){legend.width(availableWidth-controlWidth());if(multibar.barColor()){data.forEach(function(series,i){series.color=d3.rgb("#ccc").darker(i*1.5).toString()})}g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate("+controlWidth()+","+(-margin.top)+")")}if(showControls){var controlsData=[{key:"Grouped",disabled:multibar.stacked()},{key:"Stacked",disabled:!multibar.stacked()}];controls.width(controlWidth()).color(["#444","#444","#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")");multibar.disabled(data.map(function(series){return series.disabled})).width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return !d.disabled}));barsWrap.transition().call(multibar);xAxis.scale(x).ticks(availableHeight/24).tickSize(-availableWidth,0);g.select(".nv-x.nv-axis").transition().call(xAxis);var xTicks=g.select(".nv-x.nv-axis").selectAll("g");xTicks.selectAll("line, text").style("opacity",1);yAxis.scale(y).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-y.nv-axis").attr("transform","translate(0,"+availableHeight+")");g.select(".nv-y.nv-axis").transition().call(yAxis);legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});controls.dispatch.on("legendClick",function(d,i){if(!d.disabled){return}controlsData=controlsData.map(function(s){s.disabled=true;return s});d.disabled=false;switch(d.key){case"Grouped":multibar.stacked(false);break;case"Stacked":multibar.stacked(true);break}state.stacked=multibar.stacked();dispatch.stateChange(state);chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}if(typeof e.stacked!=="undefined"){multibar.stacked(e.stacked);state.stacked=e.stacked}selection.call(chart)})});return chart}multibar.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});multibar.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.multibar=multibar;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,multibar,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","clipEdge","id","delay","showValues","valueFormat","stacked","barColor");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.multiChart=function(){var margin={top:30,right:20,bottom:50,left:60},color=d3.scale.category20().range(),width=null,height=null,showLegend=true,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,y,yDomain1,yDomain2;var x=d3.scale.linear(),yScale1=d3.scale.linear(),yScale2=d3.scale.linear(),lines1=nv.models.line().yScale(yScale1),lines2=nv.models.line().yScale(yScale2),bars1=nv.models.multiBar().stacked(false).yScale(yScale1),bars2=nv.models.multiBar().stacked(false).yScale(yScale2),stack1=nv.models.stackedArea().yScale(yScale1),stack2=nv.models.stackedArea().yScale(yScale2),xAxis=nv.models.axis().scale(x).orient("bottom").tickPadding(5),yAxis1=nv.models.axis().scale(yScale1).orient("left"),yAxis2=nv.models.axis().scale(yScale2).orient("right"),legend=nv.models.legend().height(30),dispatch=d3.dispatch("tooltipShow","tooltipHide");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines1.x()(e.point,e.pointIndex)),y=((e.series.yAxis==2)?yAxis2:yAxis1).tickFormat()(lines1.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,undefined,undefined,offsetElement.offsetParent)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;chart.update=function(){container.transition().call(chart)};chart.container=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;var dataLines1=data.filter(function(d){return !d.disabled&&d.type=="line"&&d.yAxis==1});var dataLines2=data.filter(function(d){return !d.disabled&&d.type=="line"&&d.yAxis==2});var dataBars1=data.filter(function(d){return !d.disabled&&d.type=="bar"&&d.yAxis==1});var dataBars2=data.filter(function(d){return !d.disabled&&d.type=="bar"&&d.yAxis==2});var dataStack1=data.filter(function(d){return !d.disabled&&d.type=="area"&&d.yAxis==1});var dataStack2=data.filter(function(d){return !d.disabled&&d.type=="area"&&d.yAxis==2});var series1=data.filter(function(d){return !d.disabled&&d.yAxis==1}).map(function(d){return d.values.map(function(d,i){return{x:d.x,y:d.y}})});var series2=data.filter(function(d){return !d.disabled&&d.yAxis==2}).map(function(d){return d.values.map(function(d,i){return{x:d.x,y:d.y}})});x.domain(d3.extent(d3.merge(series1.concat(series2)),function(d){return d.x})).range([0,availableWidth]);var wrap=container.selectAll("g.wrap.multiChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","wrap nvd3 multiChart").append("g");gEnter.append("g").attr("class","x axis");gEnter.append("g").attr("class","y1 axis");gEnter.append("g").attr("class","y2 axis");gEnter.append("g").attr("class","lines1Wrap");gEnter.append("g").attr("class","lines2Wrap");gEnter.append("g").attr("class","bars1Wrap");gEnter.append("g").attr("class","bars2Wrap");gEnter.append("g").attr("class","stack1Wrap");gEnter.append("g").attr("class","stack2Wrap");gEnter.append("g").attr("class","legendWrap");var g=wrap.select("g");if(showLegend){legend.width(availableWidth/2);g.select(".legendWrap").datum(data.map(function(series){series.originalKey=series.originalKey===undefined?series.key:series.originalKey;series.key=series.originalKey+(series.yAxis==1?"":" (right axis)");return series})).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".legendWrap").attr("transform","translate("+(availableWidth/2)+","+(-margin.top)+")")}lines1.width(availableWidth).height(availableHeight).interpolate("monotone").color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==1&&data[i].type=="line"}));lines2.width(availableWidth).height(availableHeight).interpolate("monotone").color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==2&&data[i].type=="line"}));bars1.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==1&&data[i].type=="bar"}));bars2.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==2&&data[i].type=="bar"}));stack1.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==1&&data[i].type=="area"}));stack2.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==2&&data[i].type=="area"}));g.attr("transform","translate("+margin.left+","+margin.top+")");var lines1Wrap=g.select(".lines1Wrap").datum(dataLines1);var bars1Wrap=g.select(".bars1Wrap").datum(dataBars1);var stack1Wrap=g.select(".stack1Wrap").datum(dataStack1);var lines2Wrap=g.select(".lines2Wrap").datum(dataLines2);var bars2Wrap=g.select(".bars2Wrap").datum(dataBars2);var stack2Wrap=g.select(".stack2Wrap").datum(dataStack2);var extraValue1=dataStack1.length?dataStack1.map(function(a){return a.values}).reduce(function(a,b){return a.map(function(aVal,i){return{x:aVal.x,y:aVal.y+b[i].y}})}).concat([{x:0,y:0}]):[];var extraValue2=dataStack2.length?dataStack2.map(function(a){return a.values}).reduce(function(a,b){return a.map(function(aVal,i){return{x:aVal.x,y:aVal.y+b[i].y}})}).concat([{x:0,y:0}]):[];yScale1.domain(yDomain1||d3.extent(d3.merge(series1).concat(extraValue1),function(d){return d.y})).range([0,availableHeight]);yScale2.domain(yDomain2||d3.extent(d3.merge(series2).concat(extraValue2),function(d){return d.y})).range([0,availableHeight]);lines1.yDomain(yScale1.domain());bars1.yDomain(yScale1.domain());stack1.yDomain(yScale1.domain());lines2.yDomain(yScale2.domain());bars2.yDomain(yScale2.domain());stack2.yDomain(yScale2.domain());if(dataStack1.length){d3.transition(stack1Wrap).call(stack1)}if(dataStack2.length){d3.transition(stack2Wrap).call(stack2)}if(dataBars1.length){d3.transition(bars1Wrap).call(bars1)}if(dataBars2.length){d3.transition(bars2Wrap).call(bars2)}if(dataLines1.length){d3.transition(lines1Wrap).call(lines1)}if(dataLines2.length){d3.transition(lines2Wrap).call(lines2)}xAxis.ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".x.axis").attr("transform","translate(0,"+availableHeight+")");d3.transition(g.select(".x.axis")).call(xAxis);yAxis1.ticks(availableHeight/36).tickSize(-availableWidth,0);d3.transition(g.select(".y1.axis")).call(yAxis1);yAxis2.ticks(availableHeight/36).tickSize(-availableWidth,0);d3.transition(g.select(".y2.axis")).call(yAxis2);g.select(".y2.axis").style("opacity",series2.length?1:0).attr("transform","translate("+x.range()[1]+",0)");legend.dispatch.on("stateChange",function(newState){chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}})});return chart}lines1.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines1.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});lines2.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines2.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});bars1.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});bars1.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});bars2.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});bars2.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});stack1.dispatch.on("tooltipShow",function(e){if(!Math.round(stack1.y()(e.point)*100)){setTimeout(function(){d3.selectAll(".point.hover").classed("hover",false)},0);return false}e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top],dispatch.tooltipShow(e)});stack1.dispatch.on("tooltipHide",function(e){dispatch.tooltipHide(e)});stack2.dispatch.on("tooltipShow",function(e){if(!Math.round(stack2.y()(e.point)*100)){setTimeout(function(){d3.selectAll(".point.hover").classed("hover",false)},0);return false}e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top],dispatch.tooltipShow(e)});stack2.dispatch.on("tooltipHide",function(e){dispatch.tooltipHide(e)});lines1.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines1.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});lines2.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines2.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.lines1=lines1;chart.lines2=lines2;chart.bars1=bars1;chart.bars2=bars2;chart.stack1=stack1;chart.stack2=stack2;chart.xAxis=xAxis;chart.yAxis1=yAxis1;chart.yAxis2=yAxis2;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;lines1.x(_);bars1.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;lines1.y(_);bars1.y(_);return chart};chart.yDomain1=function(_){if(!arguments.length){return yDomain1}yDomain1=_;return chart};chart.yDomain2=function(_){if(!arguments.length){return yDomain2}yDomain2=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin=_;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=_;legend.color(_);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};return chart};nv.models.ohlcBar=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(Math.random()*10000),x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},getOpen=function(d){return d.open},getClose=function(d){return d.close},getHigh=function(d){return d.high},getLow=function(d){return d.low},forceX=[],forceY=[],padData=false,clipEdge=true,color=nv.utils.defaultColor(),xDomain,yDomain,xRange,yRange,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x.domain(xDomain||d3.extent(data[0].values.map(getX).concat(forceX)));if(padData){x.range(xRange||[availableWidth*0.5/data[0].values.length,availableWidth*(data[0].values.length-0.5)/data[0].values.length])}else{x.range(xRange||[0,availableWidth])}y.domain(yDomain||[d3.min(data[0].values.map(getLow).concat(forceY)),d3.max(data[0].values.map(getHigh).concat(forceY))]).range(yRange||[availableHeight,0]);if(x.domain()[0]===x.domain()[1]){x.domain()[0]?x.domain([x.domain()[0]-x.domain()[0]*0.01,x.domain()[1]+x.domain()[1]*0.01]):x.domain([-1,1])}if(y.domain()[0]===y.domain()[1]){y.domain()[0]?y.domain([y.domain()[0]+y.domain()[0]*0.01,y.domain()[1]-y.domain()[1]*0.01]):y.domain([-1,1])}var wrap=d3.select(this).selectAll("g.nv-wrap.nv-ohlcBar").data([data[0].values]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-ohlcBar");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-ticks");wrap.attr("transform","translate("+margin.left+","+margin.top+")");container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})});defsEnter.append("clipPath").attr("id","nv-chart-clip-path-"+id).append("rect");wrap.select("#nv-chart-clip-path-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-chart-clip-path-"+id+")":"");var ticks=wrap.select(".nv-ticks").selectAll(".nv-tick").data(function(d){return d});ticks.exit().remove();var ticksEnter=ticks.enter().append("path").attr("class",function(d,i,j){return(getOpen(d,i)>getClose(d,i)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+j+"-"+i}).attr("d",function(d,i){var w=(availableWidth/data[0].values.length)*0.9;return"m0,0l0,"+(y(getOpen(d,i))-y(getHigh(d,i)))+"l"+(-w/2)+",0l"+(w/2)+",0l0,"+(y(getLow(d,i))-y(getOpen(d,i)))+"l0,"+(y(getClose(d,i))-y(getLow(d,i)))+"l"+(w/2)+",0l"+(-w/2)+",0z"}).attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getHigh(d,i))+")"}).on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({point:d,series:data[0],pos:[x(getX(d,i)),y(getY(d,i))],pointIndex:i,seriesIndex:0,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({point:d,series:data[0],pointIndex:i,seriesIndex:0,e:d3.event})}).on("click",function(d,i){dispatch.elementClick({value:getY(d,i),data:d,index:i,pos:[x(getX(d,i)),y(getY(d,i))],e:d3.event,id:id});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({value:getY(d,i),data:d,index:i,pos:[x(getX(d,i)),y(getY(d,i))],e:d3.event,id:id});d3.event.stopPropagation()});ticks.attr("class",function(d,i,j){return(getOpen(d,i)>getClose(d,i)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+j+"-"+i});d3.transition(ticks).attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getHigh(d,i))+")"}).attr("d",function(d,i){var w=(availableWidth/data[0].values.length)*0.9;return"m0,0l0,"+(y(getOpen(d,i))-y(getHigh(d,i)))+"l"+(-w/2)+",0l"+(w/2)+",0l0,"+(y(getLow(d,i))-y(getOpen(d,i)))+"l0,"+(y(getClose(d,i))-y(getLow(d,i)))+"l"+(w/2)+",0l"+(-w/2)+",0z"})});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.open=function(_){if(!arguments.length){return getOpen}getOpen=_;return chart};chart.close=function(_){if(!arguments.length){return getClose}getClose=_;return chart};chart.high=function(_){if(!arguments.length){return getHigh}getHigh=_;return chart};chart.low=function(_){if(!arguments.length){return getLow}getLow=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceX=function(_){if(!arguments.length){return forceX}forceX=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.padData=function(_){if(!arguments.length){return padData}padData=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};return chart};nv.models.pie=function(){var margin={top:0,right:0,bottom:0,left:0},width=500,height=500,getX=function(d){return d.x},getY=function(d){return d.y},getDescription=function(d){return d.description},id=Math.floor(Math.random()*10000),color=nv.utils.defaultColor(),valueFormat=d3.format(",.2f"),showLabels=true,pieLabelsOutside=true,donutLabelsOutside=false,labelType="key",labelThreshold=0.02,donut=false,labelSunbeamLayout=false,startAngle=false,endAngle=false,donutRatio=0.5,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,radius=Math.min(availableWidth,availableHeight)/2,arcRadius=radius-(radius/5),container=d3.select(this);var wrap=container.selectAll(".nv-wrap.nv-pie").data(data);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-pie nv-chart-"+id);var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-pie");wrap.attr("transform","translate("+margin.left+","+margin.top+")");g.select(".nv-pie").attr("transform","translate("+availableWidth/2+","+availableHeight/2+")");container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})});var arc=d3.svg.arc().outerRadius(arcRadius);if(startAngle){arc.startAngle(startAngle)}if(endAngle){arc.endAngle(endAngle)}if(donut){arc.innerRadius(radius*donutRatio)}var pie=d3.layout.pie().sort(null).value(function(d){return d.disabled?0:getY(d)});var slices=wrap.select(".nv-pie").selectAll(".nv-slice").data(pie);slices.exit().remove();var ae=slices.enter().append("g").attr("class","nv-slice").on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({label:getX(d.data),value:getY(d.data),point:d.data,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({label:getX(d.data),value:getY(d.data),point:d.data,index:i,id:id})}).on("click",function(d,i){dispatch.elementClick({label:getX(d.data),value:getY(d.data),point:d.data,index:i,pos:d3.event,id:id});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({label:getX(d.data),value:getY(d.data),point:d.data,index:i,pos:d3.event,id:id});d3.event.stopPropagation()});slices.attr("fill",function(d,i){return color(d,i)}).attr("stroke",function(d,i){return color(d,i)});var paths=ae.append("path").each(function(d){this._current=d});d3.transition(slices.select("path")).attr("d",arc).attrTween("d",arcTween);if(showLabels){var labelsArc=d3.svg.arc().innerRadius(0);if(pieLabelsOutside){labelsArc=arc}if(donutLabelsOutside){labelsArc=d3.svg.arc().outerRadius(arc.outerRadius())}ae.append("g").classed("nv-label",true).each(function(d,i){var group=d3.select(this);group.attr("transform",function(d){if(labelSunbeamLayout){d.outerRadius=arcRadius+10;d.innerRadius=arcRadius+15;var rotateAngle=(d.startAngle+d.endAngle)/2*(180/Math.PI);if((d.startAngle+d.endAngle)/2<Math.PI){rotateAngle-=90}else{rotateAngle+=90}return"translate("+labelsArc.centroid(d)+") rotate("+rotateAngle+")"}else{d.outerRadius=radius+10;d.innerRadius=radius+15;return"translate("+labelsArc.centroid(d)+")"}});group.append("rect").style("stroke","#fff").style("fill","#fff").attr("rx",3).attr("ry",3);group.append("text").style("text-anchor",labelSunbeamLayout?((d.startAngle+d.endAngle)/2<Math.PI?"start":"end"):"middle").style("fill","#000")});slices.select(".nv-label").transition().attr("transform",function(d){if(labelSunbeamLayout){d.outerRadius=arcRadius+10;d.innerRadius=arcRadius+15;var rotateAngle=(d.startAngle+d.endAngle)/2*(180/Math.PI);if((d.startAngle+d.endAngle)/2<Math.PI){rotateAngle-=90}else{rotateAngle+=90}return"translate("+labelsArc.centroid(d)+") rotate("+rotateAngle+")"}else{d.outerRadius=radius+10;d.innerRadius=radius+15;return"translate("+labelsArc.centroid(d)+")"}});slices.each(function(d,i){var slice=d3.select(this);slice.select(".nv-label text").style("text-anchor",labelSunbeamLayout?((d.startAngle+d.endAngle)/2<Math.PI?"start":"end"):"middle").text(function(d,i){var percent=(d.endAngle-d.startAngle)/(2*Math.PI);var labelTypes={key:getX(d.data),value:getY(d.data),percent:d3.format("%")(percent)};return(d.value&&percent>labelThreshold)?labelTypes[labelType]:""});var textBox=slice.select("text").node().getBBox();slice.select(".nv-label rect").attr("width",textBox.width+10).attr("height",textBox.height+10).attr("transform",function(){return"translate("+[textBox.x-5,textBox.y-5]+")"})})}function angle(d){var a=(d.startAngle+d.endAngle)*90/Math.PI-90;return a>90?a-180:a}function arcTween(a){a.endAngle=isNaN(a.endAngle)?0:a.endAngle;a.startAngle=isNaN(a.startAngle)?0:a.startAngle;if(!donut){a.innerRadius=0}var i=d3.interpolate(this._current,a);this._current=i(0);return function(t){return arc(i(t))}}function tweenPie(b){b.innerRadius=0;var i=d3.interpolate({startAngle:0,endAngle:0},b);return function(t){return arc(i(t))}}});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.values=function(_){nv.log("pie.values() is no longer supported.");return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=d3.functor(_);return chart};chart.description=function(_){if(!arguments.length){return getDescription}getDescription=_;return chart};chart.showLabels=function(_){if(!arguments.length){return showLabels}showLabels=_;return chart};chart.labelSunbeamLayout=function(_){if(!arguments.length){return labelSunbeamLayout}labelSunbeamLayout=_;return chart};chart.donutLabelsOutside=function(_){if(!arguments.length){return donutLabelsOutside}donutLabelsOutside=_;return chart};chart.pieLabelsOutside=function(_){if(!arguments.length){return pieLabelsOutside}pieLabelsOutside=_;return chart};chart.labelType=function(_){if(!arguments.length){return labelType}labelType=_;labelType=labelType||"key";return chart};chart.donut=function(_){if(!arguments.length){return donut}donut=_;return chart};chart.donutRatio=function(_){if(!arguments.length){return donutRatio}donutRatio=_;return chart};chart.startAngle=function(_){if(!arguments.length){return startAngle}startAngle=_;return chart};chart.endAngle=function(_){if(!arguments.length){return endAngle}endAngle=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.valueFormat=function(_){if(!arguments.length){return valueFormat}valueFormat=_;return chart};chart.labelThreshold=function(_){if(!arguments.length){return labelThreshold}labelThreshold=_;return chart};return chart};nv.models.pieChart=function(){var pie=nv.models.pie(),legend=nv.models.legend();var margin={top:30,right:20,bottom:20,left:20},width=null,height=null,showLegend=true,color=nv.utils.defaultColor(),tooltips=true,tooltip=function(key,y,e,graph){return"<h3>"+key+"</h3><p>"+y+"</p>"},state={},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState");var showTooltip=function(e,offsetElement){var tooltipLabel=pie.description()(e.point)||pie.x()(e.point);var left=e.pos[0]+((offsetElement&&offsetElement.offsetLeft)||0),top=e.pos[1]+((offsetElement&&offsetElement.offsetTop)||0),y=pie.valueFormat()(pie.y()(e.point)),content=tooltip(tooltipLabel,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var wrap=container.selectAll("g.nv-wrap.nv-pieChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-pieChart").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-pieWrap");gEnter.append("g").attr("class","nv-legendWrap");if(showLegend){legend.width(availableWidth).key(pie.x());wrap.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}wrap.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");pie.width(availableWidth).height(availableHeight);var pieWrap=g.select(".nv-pieWrap").datum([data]);d3.transition(pieWrap).call(pie);legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});pie.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}chart.update()})});return chart}pie.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e)}});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.legend=legend;chart.dispatch=dispatch;chart.pie=pie;d3.rebind(chart,pie,"valueFormat","values","x","y","description","id","showLabels","donutLabelsOutside","pieLabelsOutside","labelType","donut","donutRatio","labelThreshold");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);pie.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.scatter=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=nv.utils.defaultColor(),id=Math.floor(Math.random()*100000),x=d3.scale.linear(),y=d3.scale.linear(),z=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},getSize=function(d){return d.size||1},getShape=function(d){return d.shape||"circle"},onlyCircles=true,forceX=[],forceY=[],forceSize=[],interactive=true,pointKey=null,pointActive=function(d){return !d.notActive},padData=false,padDataOuter=0.1,clipEdge=false,clipVoronoi=true,clipRadius=function(){return 25},xDomain=null,yDomain=null,xRange=null,yRange=null,sizeDomain=null,sizeRange=null,singlePoint=false,dispatch=d3.dispatch("elementClick","elementMouseover","elementMouseout"),useVoronoi=true;var x0,y0,z0,timeoutID,needsUpdate=false;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);data.forEach(function(series,i){series.values.forEach(function(point){point.series=i})});var seriesData=(xDomain&&yDomain&&sizeDomain)?[]:d3.merge(data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),size:getSize(d,i)}})}));x.domain(xDomain||d3.extent(seriesData.map(function(d){return d.x}).concat(forceX)));if(padData&&data[0]){x.range(xRange||[(availableWidth*padDataOuter+availableWidth)/(2*data[0].values.length),availableWidth-availableWidth*(1+padDataOuter)/(2*data[0].values.length)])}else{x.range(xRange||[0,availableWidth])}y.domain(yDomain||d3.extent(seriesData.map(function(d){return d.y}).concat(forceY))).range(yRange||[availableHeight,0]);z.domain(sizeDomain||d3.extent(seriesData.map(function(d){return d.size}).concat(forceSize))).range(sizeRange||[16,256]);if(x.domain()[0]===x.domain()[1]||y.domain()[0]===y.domain()[1]){singlePoint=true}if(x.domain()[0]===x.domain()[1]){x.domain()[0]?x.domain([x.domain()[0]-x.domain()[0]*0.01,x.domain()[1]+x.domain()[1]*0.01]):x.domain([-1,1])}if(y.domain()[0]===y.domain()[1]){y.domain()[0]?y.domain([y.domain()[0]-y.domain()[0]*0.01,y.domain()[1]+y.domain()[1]*0.01]):y.domain([-1,1])}if(isNaN(x.domain()[0])){x.domain([-1,1])}if(isNaN(y.domain()[0])){y.domain([-1,1])}x0=x0||x;y0=y0||y;z0=z0||z;var wrap=container.selectAll("g.nv-wrap.nv-scatter").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-scatter nv-chart-"+id+(singlePoint?" nv-single-point":""));var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");gEnter.append("g").attr("class","nv-point-paths");wrap.attr("transform","translate("+margin.left+","+margin.top+")");defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");function updateInteractiveLayer(){if(!interactive){return false}var eventElements;var vertices=d3.merge(data.map(function(group,groupIndex){return group.values.map(function(point,pointIndex){var pX=getX(point,pointIndex);var pY=getY(point,pointIndex);return[x(pX)+Math.random()*1e-7,y(pY)+Math.random()*1e-7,groupIndex,pointIndex,point]}).filter(function(pointArray,pointIndex){return pointActive(pointArray[4],pointIndex)})}));if(useVoronoi===true){if(clipVoronoi){var pointClipsEnter=wrap.select("defs").selectAll(".nv-point-clips").data([id]).enter();pointClipsEnter.append("clipPath").attr("class","nv-point-clips").attr("id","nv-points-clip-"+id);var pointClips=wrap.select("#nv-points-clip-"+id).selectAll("circle").data(vertices);pointClips.enter().append("circle").attr("r",clipRadius);pointClips.exit().remove();pointClips.attr("cx",function(d){return d[0]}).attr("cy",function(d){return d[1]});wrap.select(".nv-point-paths").attr("clip-path","url(#nv-points-clip-"+id+")")}if(vertices.length){vertices.push([x.range()[0]-20,y.range()[0]-20,null,null]);vertices.push([x.range()[1]+20,y.range()[1]+20,null,null]);vertices.push([x.range()[0]-20,y.range()[0]+20,null,null]);vertices.push([x.range()[1]+20,y.range()[1]-20,null,null])}var bounds=d3.geom.polygon([[-10,-10],[-10,height+10],[width+10,height+10],[width+10,-10]]);var voronoi=d3.geom.voronoi(vertices).map(function(d,i){return{data:bounds.clip(d),series:vertices[i][2],point:vertices[i][3]}});var pointPaths=wrap.select(".nv-point-paths").selectAll("path").data(voronoi);pointPaths.enter().append("path").attr("class",function(d,i){return"nv-path-"+i});pointPaths.exit().remove();pointPaths.attr("d",function(d){if(d.data.length===0){return"M 0 0"}else{return"M"+d.data.join("L")+"Z"}});var mouseEventCallback=function(d,mDispatch){if(needsUpdate){return 0}var series=data[d.series];if(typeof series==="undefined"){return}var point=series.values[d.point];mDispatch({point:point,series:series,pos:[x(getX(point,d.point))+margin.left,y(getY(point,d.point))+margin.top],seriesIndex:d.series,pointIndex:d.point})};pointPaths.on("click",function(d){mouseEventCallback(d,dispatch.elementClick)}).on("mouseover",function(d){mouseEventCallback(d,dispatch.elementMouseover)}).on("mouseout",function(d,i){mouseEventCallback(d,dispatch.elementMouseout)})}else{wrap.select(".nv-groups").selectAll(".nv-group").selectAll(".nv-point").on("click",function(d,i){if(needsUpdate||!data[d.series]){return 0}var series=data[d.series],point=series.values[i];dispatch.elementClick({point:point,series:series,pos:[x(getX(point,i))+margin.left,y(getY(point,i))+margin.top],seriesIndex:d.series,pointIndex:i})}).on("mouseover",function(d,i){if(needsUpdate||!data[d.series]){return 0}var series=data[d.series],point=series.values[i];dispatch.elementMouseover({point:point,series:series,pos:[x(getX(point,i))+margin.left,y(getY(point,i))+margin.top],seriesIndex:d.series,pointIndex:i})}).on("mouseout",function(d,i){if(needsUpdate||!data[d.series]){return 0}var series=data[d.series],point=series.values[i];dispatch.elementMouseout({point:point,series:series,seriesIndex:d.series,pointIndex:i})})}needsUpdate=false}needsUpdate=true;var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);groups.exit().remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover});groups.transition().style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)}).style("stroke-opacity",1).style("fill-opacity",0.5);if(onlyCircles){var points=groups.selectAll("circle.nv-point").data(function(d){return d.values},pointKey);points.enter().append("circle").style("fill",function(d,i){return d.color}).style("stroke",function(d,i){return d.color}).attr("cx",function(d,i){return nv.utils.NaNtoZero(x0(getX(d,i)))}).attr("cy",function(d,i){return nv.utils.NaNtoZero(y0(getY(d,i)))}).attr("r",function(d,i){return Math.sqrt(z(getSize(d,i))/Math.PI)});points.exit().remove();groups.exit().selectAll("path.nv-point").transition().attr("cx",function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).attr("cy",function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}).remove();points.each(function(d,i){d3.select(this).classed("nv-point",true).classed("nv-point-"+i,true).classed("hover",false)});points.transition().attr("cx",function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).attr("cy",function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}).attr("r",function(d,i){return Math.sqrt(z(getSize(d,i))/Math.PI)})}else{var points=groups.selectAll("path.nv-point").data(function(d){return d.values});points.enter().append("path").style("fill",function(d,i){return d.color}).style("stroke",function(d,i){return d.color}).attr("transform",function(d,i){return"translate("+x0(getX(d,i))+","+y0(getY(d,i))+")"}).attr("d",d3.svg.symbol().type(getShape).size(function(d,i){return z(getSize(d,i))}));points.exit().remove();groups.exit().selectAll("path.nv-point").transition().attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getY(d,i))+")"}).remove();points.each(function(d,i){d3.select(this).classed("nv-point",true).classed("nv-point-"+i,true).classed("hover",false)});points.transition().attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getY(d,i))+")"}).attr("d",d3.svg.symbol().type(getShape).size(function(d,i){return z(getSize(d,i))}))}clearTimeout(timeoutID);timeoutID=setTimeout(updateInteractiveLayer,300);x0=x.copy();y0=y.copy();z0=z.copy()});return chart}chart.clearHighlights=function(){d3.selectAll(".nv-chart-"+id+" .nv-point.hover").classed("hover",false)};chart.highlightPoint=function(seriesIndex,pointIndex,isHoverOver){d3.select(".nv-chart-"+id+" .nv-series-"+seriesIndex+" .nv-point-"+pointIndex).classed("hover",isHoverOver)};dispatch.on("elementMouseover.point",function(d){if(interactive){chart.highlightPoint(d.seriesIndex,d.pointIndex,true)}});dispatch.on("elementMouseout.point",function(d){if(interactive){chart.highlightPoint(d.seriesIndex,d.pointIndex,false)}});chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=d3.functor(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=d3.functor(_);return chart};chart.size=function(_){if(!arguments.length){return getSize}getSize=d3.functor(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.zScale=function(_){if(!arguments.length){return z}z=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.sizeDomain=function(_){if(!arguments.length){return sizeDomain}sizeDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.sizeRange=function(_){if(!arguments.length){return sizeRange}sizeRange=_;return chart};chart.forceX=function(_){if(!arguments.length){return forceX}forceX=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.forceSize=function(_){if(!arguments.length){return forceSize}forceSize=_;return chart};chart.interactive=function(_){if(!arguments.length){return interactive}interactive=_;return chart};chart.pointKey=function(_){if(!arguments.length){return pointKey}pointKey=_;return chart};chart.pointActive=function(_){if(!arguments.length){return pointActive}pointActive=_;return chart};chart.padData=function(_){if(!arguments.length){return padData}padData=_;return chart};chart.padDataOuter=function(_){if(!arguments.length){return padDataOuter}padDataOuter=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.clipVoronoi=function(_){if(!arguments.length){return clipVoronoi}clipVoronoi=_;return chart};chart.useVoronoi=function(_){if(!arguments.length){return useVoronoi}useVoronoi=_;if(useVoronoi===false){clipVoronoi=false}return chart};chart.clipRadius=function(_){if(!arguments.length){return clipRadius}clipRadius=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.shape=function(_){if(!arguments.length){return getShape}getShape=_;return chart};chart.onlyCircles=function(_){if(!arguments.length){return onlyCircles}onlyCircles=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.singlePoint=function(_){if(!arguments.length){return singlePoint}singlePoint=_;return chart};return chart};nv.models.scatterChart=function(){var scatter=nv.models.scatter(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),distX=nv.models.distribution(),distY=nv.models.distribution();var margin={top:30,right:20,bottom:50,left:75},width=null,height=null,color=nv.utils.defaultColor(),x=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):scatter.xScale(),y=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):scatter.yScale(),xPadding=0,yPadding=0,showDistX=false,showDistY=false,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,showControls=!!d3.fisheye,fisheye=0,pauseFisheye=false,tooltips=true,tooltipX=function(key,x,y){return"<strong>"+x+"</strong>"},tooltipY=function(key,x,y){return"<strong>"+y+"</strong>"},tooltip=null,state={},defaultState=null,dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),noData="No Data Available.",transitionDuration=250;scatter.xScale(x).yScale(y);xAxis.orient("bottom").tickPadding(10);yAxis.orient((rightAlignYAxis)?"right":"left").tickPadding(10);distX.axis("x");distY.axis("y");controls.updateState(false);var x0,y0;var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),leftX=e.pos[0]+(offsetElement.offsetLeft||0),topX=y.range()[0]+margin.top+(offsetElement.offsetTop||0),leftY=x.range()[0]+margin.left+(offsetElement.offsetLeft||0),topY=e.pos[1]+(offsetElement.offsetTop||0),xVal=xAxis.tickFormat()(scatter.x()(e.point,e.pointIndex)),yVal=yAxis.tickFormat()(scatter.y()(e.point,e.pointIndex));if(tooltipX!=null){nv.tooltip.show([leftX,topX],tooltipX(e.series.key,xVal,yVal,e,chart),"n",1,offsetElement,"x-nvtooltip")}if(tooltipY!=null){nv.tooltip.show([leftY,topY],tooltipY(e.series.key,xVal,yVal,e,chart),"e",1,offsetElement,"y-nvtooltip")}if(tooltip!=null){nv.tooltip.show([left,top],tooltip(e.series.key,xVal,yVal,e,chart),e.value<0?"n":"s",null,offsetElement)}};var controlsData=[{key:"Magnify",disabled:true}];function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-scatterChart").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-scatterChart nv-chart-"+scatter.id());var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("rect").attr("class","nvd3 nv-background");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-scatterWrap");gEnter.append("g").attr("class","nv-distWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");if(showLegend){var legendWidth=(showControls)?availableWidth/2:availableWidth;legend.width(legendWidth);wrap.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}wrap.select(".nv-legendWrap").attr("transform","translate("+(availableWidth-legendWidth)+","+(-margin.top)+")")}if(showControls){controls.width(180).color(["#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}scatter.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));if(xPadding!==0){scatter.xDomain(null)}if(yPadding!==0){scatter.yDomain(null)}wrap.select(".nv-scatterWrap").datum(data.filter(function(d){return !d.disabled})).call(scatter);if(xPadding!==0){var xRange=x.domain()[1]-x.domain()[0];scatter.xDomain([x.domain()[0]-(xPadding*xRange),x.domain()[1]+(xPadding*xRange)])}if(yPadding!==0){var yRange=y.domain()[1]-y.domain()[0];scatter.yDomain([y.domain()[0]-(yPadding*yRange),y.domain()[1]+(yPadding*yRange)])}if(yPadding!==0||xPadding!==0){wrap.select(".nv-scatterWrap").datum(data.filter(function(d){return !d.disabled})).call(scatter)}if(showXAxis){xAxis.scale(x).ticks(xAxis.ticks()&&xAxis.ticks().length?xAxis.ticks():availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")").call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(yAxis.ticks()&&yAxis.ticks().length?yAxis.ticks():availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").call(yAxis)}if(showDistX){distX.getData(scatter.x()).scale(x).width(availableWidth).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));gEnter.select(".nv-distWrap").append("g").attr("class","nv-distributionX");g.select(".nv-distributionX").attr("transform","translate(0,"+y.range()[0]+")").datum(data.filter(function(d){return !d.disabled})).call(distX)}if(showDistY){distY.getData(scatter.y()).scale(y).width(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));gEnter.select(".nv-distWrap").append("g").attr("class","nv-distributionY");g.select(".nv-distributionY").attr("transform","translate("+(rightAlignYAxis?availableWidth:-distY.size())+",0)").datum(data.filter(function(d){return !d.disabled})).call(distY)}if(d3.fisheye){g.select(".nv-background").attr("width",availableWidth).attr("height",availableHeight);g.select(".nv-background").on("mousemove",updateFisheye);g.select(".nv-background").on("click",function(){pauseFisheye=!pauseFisheye});scatter.dispatch.on("elementClick.freezeFisheye",function(){pauseFisheye=!pauseFisheye})}function updateFisheye(){if(pauseFisheye){g.select(".nv-point-paths").style("pointer-events","all");return false}g.select(".nv-point-paths").style("pointer-events","none");var mouse=d3.mouse(this);x.distortion(fisheye).focus(mouse[0]);y.distortion(fisheye).focus(mouse[1]);g.select(".nv-scatterWrap").call(scatter);if(showXAxis){g.select(".nv-x.nv-axis").call(xAxis)}if(showYAxis){g.select(".nv-y.nv-axis").call(yAxis)}g.select(".nv-distributionX").datum(data.filter(function(d){return !d.disabled})).call(distX);g.select(".nv-distributionY").datum(data.filter(function(d){return !d.disabled})).call(distY)}controls.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;fisheye=d.disabled?0:2.5;g.select(".nv-background").style("pointer-events",d.disabled?"none":"all");g.select(".nv-point-paths").style("pointer-events",d.disabled?"all":"none");if(d.disabled){x.distortion(fisheye).focus(0);y.distortion(fisheye).focus(0);g.select(".nv-scatterWrap").call(scatter);g.select(".nv-x.nv-axis").call(xAxis);g.select(".nv-y.nv-axis").call(yAxis)}else{pauseFisheye=false}chart.update()});legend.dispatch.on("stateChange",function(newState){state.disabled=newState.disabled;dispatch.stateChange(state);chart.update()});scatter.dispatch.on("elementMouseover.tooltip",function(e){d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",function(d,i){return e.pos[1]-availableHeight});d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",e.pos[0]+distX.size());e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}chart.update()});x0=x.copy();y0=y.copy()});return chart}scatter.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e);d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",0);d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",distY.size())});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.scatter=scatter;chart.legend=legend;chart.controls=controls;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.distX=distX;chart.distY=distY;d3.rebind(chart,scatter,"id","interactive","pointActive","x","y","shape","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","sizeRange","forceX","forceY","forceSize","clipVoronoi","clipRadius","useVoronoi");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);distX.color(color);distY.color(color);return chart};chart.showDistX=function(_){if(!arguments.length){return showDistX}showDistX=_;return chart};chart.showDistY=function(_){if(!arguments.length){return showDistY}showDistY=_;return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.fisheye=function(_){if(!arguments.length){return fisheye}fisheye=_;return chart};chart.xPadding=function(_){if(!arguments.length){return xPadding}xPadding=_;return chart};chart.yPadding=function(_){if(!arguments.length){return yPadding}yPadding=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltipXContent=function(_){if(!arguments.length){return tooltipX}tooltipX=_;return chart};chart.tooltipYContent=function(_){if(!arguments.length){return tooltipY}tooltipY=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.scatterPlusLineChart=function(){var scatter=nv.models.scatter(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),distX=nv.models.distribution(),distY=nv.models.distribution();var margin={top:30,right:20,bottom:50,left:75},width=null,height=null,color=nv.utils.defaultColor(),x=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):scatter.xScale(),y=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):scatter.yScale(),showDistX=false,showDistY=false,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,showControls=!!d3.fisheye,fisheye=0,pauseFisheye=false,tooltips=true,tooltipX=function(key,x,y){return"<strong>"+x+"</strong>"},tooltipY=function(key,x,y){return"<strong>"+y+"</strong>"},tooltip=function(key,x,y,date){return"<h3>"+key+"</h3><p>"+date+"</p>"},state={},defaultState=null,dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),noData="No Data Available.",transitionDuration=250;scatter.xScale(x).yScale(y);xAxis.orient("bottom").tickPadding(10);yAxis.orient((rightAlignYAxis)?"right":"left").tickPadding(10);distX.axis("x");distY.axis("y");controls.updateState(false);var x0,y0;var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),leftX=e.pos[0]+(offsetElement.offsetLeft||0),topX=y.range()[0]+margin.top+(offsetElement.offsetTop||0),leftY=x.range()[0]+margin.left+(offsetElement.offsetLeft||0),topY=e.pos[1]+(offsetElement.offsetTop||0),xVal=xAxis.tickFormat()(scatter.x()(e.point,e.pointIndex)),yVal=yAxis.tickFormat()(scatter.y()(e.point,e.pointIndex));if(tooltipX!=null){nv.tooltip.show([leftX,topX],tooltipX(e.series.key,xVal,yVal,e,chart),"n",1,offsetElement,"x-nvtooltip")}if(tooltipY!=null){nv.tooltip.show([leftY,topY],tooltipY(e.series.key,xVal,yVal,e,chart),"e",1,offsetElement,"y-nvtooltip")}if(tooltip!=null){nv.tooltip.show([left,top],tooltip(e.series.key,xVal,yVal,e.point.tooltip,e,chart),e.value<0?"n":"s",null,offsetElement)}};var controlsData=[{key:"Magnify",disabled:true}];function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=scatter.xScale();y=scatter.yScale();x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-scatterChart").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-scatterChart nv-chart-"+scatter.id());var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("rect").attr("class","nvd3 nv-background").style("pointer-events","none");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-scatterWrap");gEnter.append("g").attr("class","nv-regressionLinesWrap");gEnter.append("g").attr("class","nv-distWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}if(showLegend){legend.width(availableWidth/2);wrap.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}wrap.select(".nv-legendWrap").attr("transform","translate("+(availableWidth/2)+","+(-margin.top)+")")}if(showControls){controls.width(180).color(["#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}scatter.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));wrap.select(".nv-scatterWrap").datum(data.filter(function(d){return !d.disabled})).call(scatter);wrap.select(".nv-regressionLinesWrap").attr("clip-path","url(#nv-edge-clip-"+scatter.id()+")");var regWrap=wrap.select(".nv-regressionLinesWrap").selectAll(".nv-regLines").data(function(d){return d});regWrap.enter().append("g").attr("class","nv-regLines");var regLine=regWrap.selectAll(".nv-regLine").data(function(d){return[d]});var regLineEnter=regLine.enter().append("line").attr("class","nv-regLine").style("stroke-opacity",0);regLine.transition().attr("x1",x.range()[0]).attr("x2",x.range()[1]).attr("y1",function(d,i){return y(x.domain()[0]*d.slope+d.intercept)}).attr("y2",function(d,i){return y(x.domain()[1]*d.slope+d.intercept)}).style("stroke",function(d,i,j){return color(d,j)}).style("stroke-opacity",function(d,i){return(d.disabled||typeof d.slope==="undefined"||typeof d.intercept==="undefined")?0:1});if(showXAxis){xAxis.scale(x).ticks(xAxis.ticks()?xAxis.ticks():availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")").call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(yAxis.ticks()?yAxis.ticks():availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").call(yAxis)}if(showDistX){distX.getData(scatter.x()).scale(x).width(availableWidth).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));gEnter.select(".nv-distWrap").append("g").attr("class","nv-distributionX");g.select(".nv-distributionX").attr("transform","translate(0,"+y.range()[0]+")").datum(data.filter(function(d){return !d.disabled})).call(distX)}if(showDistY){distY.getData(scatter.y()).scale(y).width(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));gEnter.select(".nv-distWrap").append("g").attr("class","nv-distributionY");g.select(".nv-distributionY").attr("transform","translate("+(rightAlignYAxis?availableWidth:-distY.size())+",0)").datum(data.filter(function(d){return !d.disabled})).call(distY)}if(d3.fisheye){g.select(".nv-background").attr("width",availableWidth).attr("height",availableHeight);g.select(".nv-background").on("mousemove",updateFisheye);g.select(".nv-background").on("click",function(){pauseFisheye=!pauseFisheye});scatter.dispatch.on("elementClick.freezeFisheye",function(){pauseFisheye=!pauseFisheye})}function updateFisheye(){if(pauseFisheye){g.select(".nv-point-paths").style("pointer-events","all");return false}g.select(".nv-point-paths").style("pointer-events","none");var mouse=d3.mouse(this);x.distortion(fisheye).focus(mouse[0]);y.distortion(fisheye).focus(mouse[1]);g.select(".nv-scatterWrap").datum(data.filter(function(d){return !d.disabled})).call(scatter);if(showXAxis){g.select(".nv-x.nv-axis").call(xAxis)}if(showYAxis){g.select(".nv-y.nv-axis").call(yAxis)}g.select(".nv-distributionX").datum(data.filter(function(d){return !d.disabled})).call(distX);g.select(".nv-distributionY").datum(data.filter(function(d){return !d.disabled})).call(distY)}controls.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;fisheye=d.disabled?0:2.5;g.select(".nv-background").style("pointer-events",d.disabled?"none":"all");g.select(".nv-point-paths").style("pointer-events",d.disabled?"all":"none");if(d.disabled){x.distortion(fisheye).focus(0);y.distortion(fisheye).focus(0);g.select(".nv-scatterWrap").call(scatter);g.select(".nv-x.nv-axis").call(xAxis);g.select(".nv-y.nv-axis").call(yAxis)}else{pauseFisheye=false}chart.update()});legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});scatter.dispatch.on("elementMouseover.tooltip",function(e){d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",e.pos[1]-availableHeight);d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",e.pos[0]+distX.size());e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}chart.update()});x0=x.copy();y0=y.copy()});return chart}scatter.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e);d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",0);d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",distY.size())});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.scatter=scatter;chart.legend=legend;chart.controls=controls;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.distX=distX;chart.distY=distY;d3.rebind(chart,scatter,"id","interactive","pointActive","x","y","shape","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","sizeRange","forceX","forceY","forceSize","clipVoronoi","clipRadius","useVoronoi");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);distX.color(color);distY.color(color);return chart};chart.showDistX=function(_){if(!arguments.length){return showDistX}showDistX=_;return chart};chart.showDistY=function(_){if(!arguments.length){return showDistY}showDistY=_;return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.fisheye=function(_){if(!arguments.length){return fisheye}fisheye=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltipXContent=function(_){if(!arguments.length){return tooltipX}tooltipX=_;return chart};chart.tooltipYContent=function(_){if(!arguments.length){return tooltipY}tooltipY=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.sparkline=function(){var margin={top:2,right:0,bottom:2,left:0},width=400,height=32,animate=true,x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},color=nv.utils.getColor(["#000"]),xDomain,yDomain,xRange,yRange;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x.domain(xDomain||d3.extent(data,getX)).range(xRange||[0,availableWidth]);y.domain(yDomain||d3.extent(data,getY)).range(yRange||[availableHeight,0]);var wrap=container.selectAll("g.nv-wrap.nv-sparkline").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-sparkline");var gEnter=wrapEnter.append("g");var g=wrap.select("g");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var paths=wrap.selectAll("path").data(function(d){return[d]});paths.enter().append("path");paths.exit().remove();paths.style("stroke",function(d,i){return d.color||color(d,i)}).attr("d",d3.svg.line().x(function(d,i){return x(getX(d,i))}).y(function(d,i){return y(getY(d,i))}));var points=wrap.selectAll("circle.nv-point").data(function(data){var yValues=data.map(function(d,i){return getY(d,i)});function pointIndex(index){if(index!=-1){var result=data[index];result.pointIndex=index;return result}else{return null}}var maxPoint=pointIndex(yValues.lastIndexOf(y.domain()[1])),minPoint=pointIndex(yValues.indexOf(y.domain()[0])),currentPoint=pointIndex(yValues.length-1);return[minPoint,maxPoint,currentPoint].filter(function(d){return d!=null})});points.enter().append("circle");points.exit().remove();points.attr("cx",function(d,i){return x(getX(d,d.pointIndex))}).attr("cy",function(d,i){return y(getY(d,d.pointIndex))}).attr("r",2).attr("class",function(d,i){return getX(d,d.pointIndex)==x.domain()[1]?"nv-point nv-currentValue":getY(d,d.pointIndex)==y.domain()[0]?"nv-point nv-minValue":"nv-point nv-maxValue"})});return chart}chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.x=function(_){if(!arguments.length){return getX}getX=d3.functor(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=d3.functor(_);return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.animate=function(_){if(!arguments.length){return animate}animate=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};return chart};nv.models.sparklinePlus=function(){var sparkline=nv.models.sparkline();var margin={top:15,right:100,bottom:10,left:50},width=null,height=null,x,y,index=[],paused=false,xTickFormat=d3.format(",r"),yTickFormat=d3.format(",.2f"),showValue=true,alignValue=true,rightAlignValue=false,noData="No Data Available.";function chart(selection){selection.each(function(data){var container=d3.select(this);var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){chart(selection)};chart.container=this;if(!data||!data.length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var currentValue=sparkline.y()(data[data.length-1],data.length-1);x=sparkline.xScale();y=sparkline.yScale();var wrap=container.selectAll("g.nv-wrap.nv-sparklineplus").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-sparklineplus");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-sparklineWrap");gEnter.append("g").attr("class","nv-valueWrap");gEnter.append("g").attr("class","nv-hoverArea");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var sparklineWrap=g.select(".nv-sparklineWrap");sparkline.width(availableWidth).height(availableHeight);sparklineWrap.call(sparkline);var valueWrap=g.select(".nv-valueWrap");var value=valueWrap.selectAll(".nv-currentValue").data([currentValue]);value.enter().append("text").attr("class","nv-currentValue").attr("dx",rightAlignValue?-8:8).attr("dy",".9em").style("text-anchor",rightAlignValue?"end":"start");value.attr("x",availableWidth+(rightAlignValue?margin.right:0)).attr("y",alignValue?function(d){return y(d)}:0).style("fill",sparkline.color()(data[data.length-1],data.length-1)).text(yTickFormat(currentValue));gEnter.select(".nv-hoverArea").append("rect").on("mousemove",sparklineHover).on("click",function(){paused=!paused}).on("mouseout",function(){index=[];updateValueLine()});g.select(".nv-hoverArea rect").attr("transform",function(d){return"translate("+-margin.left+","+-margin.top+")"}).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top);function updateValueLine(){if(paused){return}var hoverValue=g.selectAll(".nv-hoverValue").data(index);var hoverEnter=hoverValue.enter().append("g").attr("class","nv-hoverValue").style("stroke-opacity",0).style("fill-opacity",0);hoverValue.exit().transition().duration(250).style("stroke-opacity",0).style("fill-opacity",0).remove();hoverValue.attr("transform",function(d){return"translate("+x(sparkline.x()(data[d],d))+",0)"}).transition().duration(250).style("stroke-opacity",1).style("fill-opacity",1);if(!index.length){return}hoverEnter.append("line").attr("x1",0).attr("y1",-margin.top).attr("x2",0).attr("y2",availableHeight);hoverEnter.append("text").attr("class","nv-xValue").attr("x",-6).attr("y",-margin.top).attr("text-anchor","end").attr("dy",".9em");g.select(".nv-hoverValue .nv-xValue").text(xTickFormat(sparkline.x()(data[index[0]],index[0])));hoverEnter.append("text").attr("class","nv-yValue").attr("x",6).attr("y",-margin.top).attr("text-anchor","start").attr("dy",".9em");g.select(".nv-hoverValue .nv-yValue").text(yTickFormat(sparkline.y()(data[index[0]],index[0])))}function sparklineHover(){if(paused){return}var pos=d3.mouse(this)[0]-margin.left;function getClosestIndex(data,x){var distance=Math.abs(sparkline.x()(data[0],0)-x);var closestIndex=0;for(var i=0;i<data.length;i++){if(Math.abs(sparkline.x()(data[i],i)-x)<distance){distance=Math.abs(sparkline.x()(data[i],i)-x);closestIndex=i}}return closestIndex}index=[getClosestIndex(data,Math.round(x.invert(pos)))];updateValueLine()}});return chart}chart.sparkline=sparkline;d3.rebind(chart,sparkline,"x","y","xScale","yScale","color");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xTickFormat=function(_){if(!arguments.length){return xTickFormat}xTickFormat=_;return chart};chart.yTickFormat=function(_){if(!arguments.length){return yTickFormat}yTickFormat=_;return chart};chart.showValue=function(_){if(!arguments.length){return showValue}showValue=_;return chart};chart.alignValue=function(_){if(!arguments.length){return alignValue}alignValue=_;return chart};chart.rightAlignValue=function(_){if(!arguments.length){return rightAlignValue}rightAlignValue=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.stackedArea=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=nv.utils.defaultColor(),id=Math.floor(Math.random()*100000),getX=function(d){return d.x},getY=function(d){return d.y},style="stack",offset="zero",order="default",interpolate="linear",clipEdge=false,x,y,scatter=nv.models.scatter(),dispatch=d3.dispatch("tooltipShow","tooltipHide","areaClick","areaMouseover","areaMouseout");scatter.size(2.2).sizeDomain([2.2,2.2]);function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x=scatter.xScale();y=scatter.yScale();var dataRaw=data;data=data.map(function(aseries,i){aseries.seriesIndex=i;aseries.values=aseries.values.map(function(d,j){d.index=j;d.seriesIndex=i;return d});return aseries});var dataFiltered=data.filter(function(series){return !series.disabled});data=d3.layout.stack().order(order).offset(offset).values(function(d){return d.values}).x(getX).y(getY).out(function(d,y0,y){var yHeight=(getY(d)===0)?0:y;d.display={y:yHeight,y0:y0}})(dataFiltered);var wrap=container.selectAll("g.nv-wrap.nv-stackedarea").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedarea");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-areaWrap");gEnter.append("g").attr("class","nv-scatterWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");scatter.width(availableWidth).height(availableHeight).x(getX).y(function(d){return d.display.y+d.display.y0}).forceY([0]).color(data.map(function(d,i){return d.color||color(d,d.seriesIndex)}));var scatterWrap=g.select(".nv-scatterWrap").datum(data);scatterWrap.call(scatter);defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var area=d3.svg.area().x(function(d,i){return x(getX(d,i))}).y0(function(d){return y(d.display.y0)}).y1(function(d){return y(d.display.y+d.display.y0)}).interpolate(interpolate);var zeroArea=d3.svg.area().x(function(d,i){return x(getX(d,i))}).y0(function(d){return y(d.display.y0)}).y1(function(d){return y(d.display.y0)});var path=g.select(".nv-areaWrap").selectAll("path.nv-area").data(function(d){return d});path.enter().append("path").attr("class",function(d,i){return"nv-area nv-area-"+i}).attr("d",function(d,i){return zeroArea(d.values,d.seriesIndex)}).on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.areaMouseover({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:i})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.areaMouseout({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:i})}).on("click",function(d,i){d3.select(this).classed("hover",false);dispatch.areaClick({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:i})});path.exit().transition().attr("d",function(d,i){return zeroArea(d.values,i)}).remove();path.style("fill",function(d,i){return d.color||color(d,d.seriesIndex)}).style("stroke",function(d,i){return d.color||color(d,d.seriesIndex)});path.transition().attr("d",function(d,i){return area(d.values,i)});scatter.dispatch.on("elementMouseover.area",function(e){g.select(".nv-chart-"+id+" .nv-area-"+e.seriesIndex).classed("hover",true)});scatter.dispatch.on("elementMouseout.area",function(e){g.select(".nv-chart-"+id+" .nv-area-"+e.seriesIndex).classed("hover",false)});chart.d3_stackedOffset_stackPercent=function(stackData){var n=stackData.length,m=stackData[0].length,k=1/n,i,j,o,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<dataRaw.length;i++){o+=getY(dataRaw[i].values[j])}if(o){for(i=0;i<n;i++){stackData[i][j][1]/=o}}else{for(i=0;i<n;i++){stackData[i][j][1]=k}}}for(j=0;j<m;++j){y0[j]=0}return y0}});return chart}scatter.dispatch.on("elementClick.area",function(e){dispatch.areaClick(e)});scatter.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top],dispatch.tooltipShow(e)});scatter.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});chart.dispatch=dispatch;chart.scatter=scatter;d3.rebind(chart,scatter,"interactive","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","forceX","forceY","forceSize","clipVoronoi","useVoronoi","clipRadius","highlightPoint","clearHighlights");chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=d3.functor(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=d3.functor(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.offset=function(_){if(!arguments.length){return offset}offset=_;return chart};chart.order=function(_){if(!arguments.length){return order}order=_;return chart};chart.style=function(_){if(!arguments.length){return style}style=_;switch(style){case"stack":chart.offset("zero");chart.order("default");break;case"stream":chart.offset("wiggle");chart.order("inside-out");break;case"stream-center":chart.offset("silhouette");chart.order("inside-out");break;case"expand":chart.offset("expand");chart.order("default");break;case"stack_percent":chart.offset(chart.d3_stackedOffset_stackPercent);chart.order("default");break}return chart};chart.interpolate=function(_){if(!arguments.length){return interpolate}interpolate=_;return chart};return chart};nv.models.stackedAreaChart=function(){var stacked=nv.models.stackedArea(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),interactiveLayer=nv.interactiveGuideline();var margin={top:30,right:25,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=true,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,useInteractiveGuideline=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" on "+x+"</p>"},x,y,yAxisTickFormat=d3.format(",.2f"),state={style:stacked.style()},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),controlWidth=250,cData=["Stacked","Stream","Expanded"],controlLabels={},transitionDuration=250;xAxis.orient("bottom").tickPadding(7);yAxis.orient((rightAlignYAxis)?"right":"left");controls.updateState(false);var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(stacked.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(stacked.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=stacked.xScale();y=stacked.yScale();var wrap=container.selectAll("g.nv-wrap.nv-stackedAreaChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedAreaChart").append("g");var g=wrap.select("g");gEnter.append("rect").style("opacity",0);gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-stackedWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");gEnter.append("g").attr("class","nv-interactive");g.select("rect").attr("width",availableWidth).attr("height",availableHeight);if(showLegend){var legendWidth=(showControls)?availableWidth-controlWidth:availableWidth;legend.width(legendWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate("+(availableWidth-legendWidth)+","+(-margin.top)+")")}if(showControls){var controlsData=[{key:controlLabels.stacked||"Stacked",metaKey:"Stacked",disabled:stacked.style()!="stack",style:"stack"},{key:controlLabels.stream||"Stream",metaKey:"Stream",disabled:stacked.style()!="stream",style:"stream"},{key:controlLabels.expanded||"Expanded",metaKey:"Expanded",disabled:stacked.style()!="expand",style:"expand"},{key:controlLabels.stack_percent||"Stack %",metaKey:"Stack_Percent",disabled:stacked.style()!="stack_percent",style:"stack_percent"}];controlWidth=(cData.length/3)*260;controlsData=controlsData.filter(function(d){return cData.indexOf(d.metaKey)!==-1});controls.width(controlWidth).color(["#444","#444","#444"]);g.select(".nv-controlsWrap").datum(controlsData).call(controls);if(margin.top!=Math.max(controls.height(),legend.height())){margin.top=Math.max(controls.height(),legend.height());availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-controlsWrap").attr("transform","translate(0,"+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}if(useInteractiveGuideline){interactiveLayer.width(availableWidth).height(availableHeight).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x);wrap.select(".nv-interactive").call(interactiveLayer)}stacked.width(availableWidth).height(availableHeight);var stackedWrap=g.select(".nv-stackedWrap").datum(data);stackedWrap.transition().call(stacked);if(showXAxis){xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+availableHeight+")");g.select(".nv-x.nv-axis").transition().duration(0).call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(stacked.offset()=="wiggle"?0:availableHeight/36).tickSize(-availableWidth,0).setTickFormat((stacked.style()=="expand"||stacked.style()=="stack_percent")?d3.format("%"):yAxisTickFormat);g.select(".nv-y.nv-axis").transition().duration(0).call(yAxis)}stacked.dispatch.on("areaClick.toggle",function(e){if(data.filter(function(d){return !d.disabled}).length===1){data=data.map(function(d){d.disabled=false;return d})}else{data=data.map(function(d,i){d.disabled=(i!=e.seriesIndex);return d})}state.disabled=data.map(function(d){return !!d.disabled});dispatch.stateChange(state);chart.update()});legend.dispatch.on("stateChange",function(newState){state.disabled=newState.disabled;dispatch.stateChange(state);chart.update()});controls.dispatch.on("legendClick",function(d,i){if(!d.disabled){return}controlsData=controlsData.map(function(s){s.disabled=true;return s});d.disabled=false;stacked.style(d.style);state.style=stacked.style();dispatch.stateChange(state);chart.update()});interactiveLayer.dispatch.on("elementMousemove",function(e){stacked.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];data.filter(function(series,i){series.seriesIndex=i;return !series.disabled}).forEach(function(series,i){pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x());stacked.highlightPoint(i,pointIndex,true);var point=series.values[pointIndex];if(typeof point==="undefined"){return}if(typeof singlePoint==="undefined"){singlePoint=point}if(typeof pointXLocation==="undefined"){pointXLocation=chart.xScale()(chart.x()(point,pointIndex))}var tooltipValue=(stacked.style()=="expand")?point.display.y:chart.y()(point,pointIndex);allData.push({key:series.key,value:tooltipValue,color:color(series,series.seriesIndex),stackedValue:point.display})});allData.reverse();if(allData.length>2){var yValue=chart.yScale().invert(e.mouseY);var yDistMax=Infinity,indexToHighlight=null;allData.forEach(function(series,i){if(yValue>=series.stackedValue.y0&&yValue<=(series.stackedValue.y0+series.stackedValue.y)){indexToHighlight=i;return}});if(indexToHighlight!=null){allData[indexToHighlight].highlight=true}}var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex));var valueFormatter=(stacked.style()=="expand")?function(d,i){return d3.format(".1%")(d)}:function(d,i){return yAxis.tickFormat()(d)};interactiveLayer.tooltip.position({left:pointXLocation+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).enabled(tooltips).valueFormatter(valueFormatter).data({value:xValue,series:allData})();interactiveLayer.renderGuideLine(pointXLocation)});interactiveLayer.dispatch.on("elementMouseout",function(e){dispatch.tooltipHide();stacked.clearHighlights()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}if(typeof e.style!=="undefined"){stacked.style(e.style)}chart.update()})});return chart}stacked.dispatch.on("tooltipShow",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top],dispatch.tooltipShow(e)});stacked.dispatch.on("tooltipHide",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.stacked=stacked;chart.legend=legend;chart.controls=controls;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.interactiveLayer=interactiveLayer;d3.rebind(chart,stacked,"x","y","size","xScale","yScale","xDomain","yDomain","xRange","yRange","sizeDomain","interactive","useVoronoi","offset","order","style","clipEdge","forceX","forceY","forceSize","interpolate");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);stacked.color(color);return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.useInteractiveGuideline=function(_){if(!arguments.length){return useInteractiveGuideline}useInteractiveGuideline=_;if(_===true){chart.interactive(false);chart.useVoronoi(false)}return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};chart.controlsData=function(_){if(!arguments.length){return cData}cData=_;return chart};chart.controlLabels=function(_){if(!arguments.length){return controlLabels}if(typeof _!=="object"){return controlLabels}controlLabels=_;return chart};yAxis.setTickFormat=yAxis.tickFormat;yAxis.tickFormat=function(_){if(!arguments.length){return yAxisTickFormat}yAxisTickFormat=_;return yAxis};return chart}})();(function(){function t(e,t){return(new Date(t,e+1,0)).getDate()}function n(e,t,n){return function(r,i,s){var o=e(r),u=[];o<r&&t(o);if(s>1){while(o<i){var a=new Date(+o);n(a)%s===0&&u.push(a),t(o)}}else{while(o<i){u.push(new Date(+o)),t(o)}}return u}}var e=window.nv||{};e.version="1.1.13b",e.dev=!0,window.nv=e,e.tooltip={},e.utils=e.utils||{},e.models={},e.charts={},e.graphs=[],e.logs={},e.dispatch=d3.dispatch("render_start","render_end"),e.dev&&(e.dispatch.on("render_start",function(t){e.logs.startTime=+(new Date)}),e.dispatch.on("render_end",function(t){e.logs.endTime=+(new Date),e.logs.totalTime=e.logs.endTime-e.logs.startTime,e.log("total",e.logs.totalTime)})),e.log=function(){if(e.dev&&console.log&&console.log.apply){console.log.apply(console,arguments)}else{if(e.dev&&typeof console.log=="function"&&Function.prototype.bind){var t=Function.prototype.bind.call(console.log,console);t.apply(console,arguments)}}return arguments[arguments.length-1]},e.render=function(n){n=n||1,e.render.active=!0,e.dispatch.render_start(),setTimeout(function(){var t,r;for(var i=0;i<n&&(r=e.render.queue[i]);i++){t=r.generate(),typeof r.callback==typeof Function&&r.callback(t),e.graphs.push(t)}e.render.queue.splice(0,i),e.render.queue.length?setTimeout(arguments.callee,0):(e.render.active=!1,e.dispatch.render_end())},0)},e.render.active=!1,e.render.queue=[],e.addGraph=function(t){typeof arguments[0]==typeof Function&&(t={generate:arguments[0],callback:arguments[1]}),e.render.queue.push(t),e.render.active||e.render()},e.identity=function(e){return e},e.strip=function(e){return e.replace(/(\s|&)/g,"")},d3.time.monthEnd=function(e){return new Date(e.getFullYear(),e.getMonth(),0)},d3.time.monthEnds=n(d3.time.monthEnd,function(e){e.setUTCDate(e.getUTCDate()+1),e.setDate(t(e.getMonth()+1,e.getFullYear()))},function(e){return e.getMonth()}),e.interactiveGuideline=function(){function c(o){o.each(function(o){function g(){var e=d3.mouse(this),n=e[0],r=e[1],o=!0,a=!1;l&&(n=d3.event.offsetX,r=d3.event.offsetY,d3.event.target.tagName!=="svg"&&(o=!1),d3.event.target.className.baseVal.match("nv-legend")&&(a=!0)),o&&(n-=i.left,r-=i.top);if(n<0||r<0||n>p||r>d||d3.event.relatedTarget&&d3.event.relatedTarget.ownerSVGElement===undefined||a){if(l&&d3.event.relatedTarget&&d3.event.relatedTarget.ownerSVGElement===undefined&&d3.event.relatedTarget.className.match(t.nvPointerEventsClass)){return}u.elementMouseout({mouseX:n,mouseY:r}),c.renderGuideLine(null);return}var f=s.invert(n);u.elementMousemove({mouseX:n,mouseY:r,pointXValue:f}),d3.event.type==="dblclick"&&u.elementDblclick({mouseX:n,mouseY:r,pointXValue:f})}var h=d3.select(this),p=n||960,d=r||400,v=h.selectAll("g.nv-wrap.nv-interactiveLineLayer").data([o]),m=v.enter().append("g").attr("class"," nv-wrap nv-interactiveLineLayer");m.append("g").attr("class","nv-interactiveGuideLine");if(!f){return}f.on("mousemove",g,!0).on("mouseout",g,!0).on("dblclick",g),c.renderGuideLine=function(t){if(!a){return}var n=v.select(".nv-interactiveGuideLine").selectAll("line").data(t!=null?[e.utils.NaNtoZero(t)]:[],String);n.enter().append("line").attr("class","nv-guideline").attr("x1",function(e){return e}).attr("x2",function(e){return e}).attr("y1",d).attr("y2",0),n.exit().remove()}})}var t=e.models.tooltip(),n=null,r=null,i={left:0,top:0},s=d3.scale.linear(),o=d3.scale.linear(),u=d3.dispatch("elementMousemove","elementMouseout","elementDblclick"),a=!0,f=null,l=navigator.userAgent.indexOf("MSIE")!==-1;return c.dispatch=u,c.tooltip=t,c.margin=function(e){return arguments.length?(i.top=typeof e.top!="undefined"?e.top:i.top,i.left=typeof e.left!="undefined"?e.left:i.left,c):i},c.width=function(e){return arguments.length?(n=e,c):n},c.height=function(e){return arguments.length?(r=e,c):r},c.xScale=function(e){return arguments.length?(s=e,c):s},c.showGuideLine=function(e){return arguments.length?(a=e,c):a},c.svgContainer=function(e){return arguments.length?(f=e,c):f},c},e.interactiveBisect=function(e,t,n){if(!e instanceof Array){return null}typeof n!="function"&&(n=function(e,t){return e.x});var r=d3.bisector(n).left,i=d3.max([0,r(e,t)-1]),s=n(e[i],i);typeof s=="undefined"&&(s=i);if(s===t){return i}var o=d3.min([i+1,e.length-1]),u=n(e[o],o);return typeof u=="undefined"&&(u=o),Math.abs(u-t)>=Math.abs(s-t)?i:o},e.nearestValueIndex=function(e,t,n){var r=Infinity,i=null;return e.forEach(function(e,s){var o=Math.abs(t-e);o<=r&&o<n&&(r=o,i=s)}),i},function(){window.nv.tooltip={},window.nv.models.tooltip=function(){function y(){if(a){var e=d3.select(a);e.node().tagName!=="svg"&&(e=e.select("svg"));var t=e.node()?e.attr("viewBox"):null;if(t){t=t.split(" ");var n=parseInt(e.style("width"))/t[2];l.left=l.left*n,l.top=l.top*n}}}function b(e){var t;a?t=d3.select(a):t=d3.select("body");var n=t.select(".nvtooltip");return n.node()===null&&(n=t.append("div").attr("class","nvtooltip "+(u?u:"xy-tooltip")).attr("id",h)),n.node().innerHTML=e,n.style("top",0).style("left",0).style("opacity",0),n.selectAll("div, table, td, tr").classed(p,!0),n.classed(p,!0),n.node()}function w(){if(!c){return}if(!g(n)){return}y();var t=l.left,u=o!=null?o:l.top,h=b(m(n));f=h;if(a){var p=a.getElementsByTagName("svg")[0],d=p?p.getBoundingClientRect():a.getBoundingClientRect(),v={left:0,top:0};if(p){var E=p.getBoundingClientRect(),S=a.getBoundingClientRect(),x=E.top;if(x<0){var T=a.getBoundingClientRect();x=Math.abs(x)>T.height?0:x}v.top=Math.abs(x-S.top),v.left=Math.abs(E.left-S.left)}t+=a.offsetLeft+v.left-2*a.scrollLeft,u+=a.offsetTop+v.top-2*a.scrollTop}return s&&s>0&&(u=Math.floor(u/s)*s),e.tooltip.calcTooltipPosition([t,u],r,i,h),w}var t=null,n=null,r="w",i=50,s=25,o=null,u=null,a=null,f=null,l={left:null,top:null},c=!0,h="nvtooltip-"+Math.floor(Math.random()*100000),p="nv-pointer-events-none",d=function(e,t){return e},v=function(e){return e},m=function(e){if(t!=null){return t}if(e==null){return""}var n=d3.select(document.createElement("table")),r=n.selectAll("thead").data([e]).enter().append("thead");r.append("tr").append("td").attr("colspan",3).append("strong").classed("x-value",!0).html(v(e.value));var i=n.selectAll("tbody").data([e]).enter().append("tbody"),s=i.selectAll("tr").data(function(e){return e.series}).enter().append("tr").classed("highlight",function(e){return e.highlight});s.append("td").classed("legend-color-guide",!0).append("div").style("background-color",function(e){return e.color}),s.append("td").classed("key",!0).html(function(e){return e.key}),s.append("td").classed("value",!0).html(function(e,t){return d(e.value,t)}),s.selectAll("td").each(function(e){if(e.highlight){var t=d3.scale.linear().domain([0,1]).range(["#fff",e.color]),n=0.6;d3.select(this).style("border-bottom-color",t(n)).style("border-top-color",t(n))}});var o=n.node().outerHTML;return e.footer!==undefined&&(o+="<div class='footer'>"+e.footer+"</div>"),o},g=function(e){return e&&e.series&&e.series.length>0?!0:!1};return w.nvPointerEventsClass=p,w.content=function(e){return arguments.length?(t=e,w):t},w.tooltipElem=function(){return f},w.contentGenerator=function(e){return arguments.length?(typeof e=="function"&&(m=e),w):m},w.data=function(e){return arguments.length?(n=e,w):n},w.gravity=function(e){return arguments.length?(r=e,w):r},w.distance=function(e){return arguments.length?(i=e,w):i},w.snapDistance=function(e){return arguments.length?(s=e,w):s},w.classes=function(e){return arguments.length?(u=e,w):u},w.chartContainer=function(e){return arguments.length?(a=e,w):a},w.position=function(e){return arguments.length?(l.left=typeof e.left!="undefined"?e.left:l.left,l.top=typeof e.top!="undefined"?e.top:l.top,w):l},w.fixedTop=function(e){return arguments.length?(o=e,w):o},w.enabled=function(e){return arguments.length?(c=e,w):c},w.valueFormatter=function(e){return arguments.length?(typeof e=="function"&&(d=e),w):d},w.headerFormatter=function(e){return arguments.length?(typeof e=="function"&&(v=e),w):v},w.id=function(){return h},w},e.tooltip.show=function(t,n,r,i,s,o){var u=document.createElement("div");u.className="nvtooltip "+(o?o:"xy-tooltip");var a=s;if(!s||s.tagName.match(/g|svg/i)){a=document.getElementsByTagName("body")[0]}u.style.left=0,u.style.top=0,u.style.opacity=0,u.innerHTML=n,a.appendChild(u),s&&(t[0]=t[0]-s.scrollLeft,t[1]=t[1]-s.scrollTop),e.tooltip.calcTooltipPosition(t,r,i,u)},e.tooltip.findFirstNonSVGParent=function(e){while(e.tagName.match(/^g|svg$/i)!==null){e=e.parentNode}return e},e.tooltip.findTotalOffsetTop=function(e,t){var n=t;do{isNaN(e.offsetTop)||(n+=e.offsetTop)}while(e=e.offsetParent);return n},e.tooltip.findTotalOffsetLeft=function(e,t){var n=t;do{isNaN(e.offsetLeft)||(n+=e.offsetLeft)}while(e=e.offsetParent);return n},e.tooltip.calcTooltipPosition=function(t,n,r,i){var s=parseInt(i.offsetHeight),o=parseInt(i.offsetWidth),u=e.utils.windowSize().width,a=e.utils.windowSize().height,f=window.pageYOffset,l=window.pageXOffset,c,h;a=window.innerWidth>=document.body.scrollWidth?a:a-16,u=window.innerHeight>=document.body.scrollHeight?u:u-16,n=n||"s",r=r||20;var p=function(t){return e.tooltip.findTotalOffsetTop(t,h)},d=function(t){return e.tooltip.findTotalOffsetLeft(t,c)};switch(n){case"e":c=t[0]-o-r,h=t[1]-s/2;var v=d(i),m=p(i);v<l&&(c=t[0]+r>l?t[0]+r:l-v+c),m<f&&(h=f-m+h),m+s>f+a&&(h=f+a-m+h-s);break;case"w":c=t[0]+r,h=t[1]-s/2;var v=d(i),m=p(i);v+o>u&&(c=t[0]-o-r),m<f&&(h=f+5),m+s>f+a&&(h=f+a-m+h-s);break;case"n":c=t[0]-o/2-5,h=t[1]+r;var v=d(i),m=p(i);v<l&&(c=l+5),v+o>u&&(c=c-o/2+5),m+s>f+a&&(h=f+a-m+h-s);break;case"s":c=t[0]-o/2,h=t[1]-s-r;var v=d(i),m=p(i);v<l&&(c=l+5),v+o>u&&(c=c-o/2+5),f>m&&(h=f);break;case"none":c=t[0],h=t[1]-r;var v=d(i),m=p(i)}return i.style.left=c+"px",i.style.top=h+"px",i.style.opacity=1,i.style.position="absolute",i},e.tooltip.cleanup=function(){var e=document.getElementsByClassName("nvtooltip"),t=[];while(e.length){t.push(e[0]),e[0].style.transitionDelay="0 !important",e[0].style.opacity=0,e[0].className="nvtooltip-pending-removal"}setTimeout(function(){while(t.length){var e=t.pop();e.parentNode.removeChild(e)}},500)}}(),e.utils.windowSize=function(){var e={width:640,height:480};return document.body&&document.body.offsetWidth&&(e.width=document.body.offsetWidth,e.height=document.body.offsetHeight),document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth&&(e.width=document.documentElement.offsetWidth,e.height=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(e.width=window.innerWidth,e.height=window.innerHeight),e},e.utils.windowResize=function(e){if(e===undefined){return}var t=window.onresize;window.onresize=function(n){typeof t=="function"&&t(n),e(n)}},e.utils.getColor=function(t){return arguments.length?Object.prototype.toString.call(t)==="[object Array]"?function(e,n){return e.color||t[n%t.length]}:t:e.utils.defaultColor()},e.utils.defaultColor=function(){var e=d3.scale.category20().range();return function(t,n){return t.color||e[n%e.length]}},e.utils.customTheme=function(e,t,n){t=t||function(e){return e.key},n=n||d3.scale.category20().range();var r=n.length;return function(i,s){var o=t(i);return r||(r=n.length),typeof e[o]!="undefined"?typeof e[o]=="function"?e[o]():e[o]:n[--r]}},e.utils.pjax=function(t,n){function r(r){d3.html(r,function(r){var i=d3.select(n).node();i.parentNode.replaceChild(d3.select(r).select(n).node(),i),e.utils.pjax(t,n)})}d3.selectAll(t).on("click",function(){history.pushState(this.href,this.textContent,this.href),r(this.href),d3.event.preventDefault()}),d3.select(window).on("popstate",function(){d3.event.state&&r(d3.event.state)})},e.utils.calcApproxTextWidth=function(e){if(e instanceof d3.selection){var t=parseInt(e.style("font-size").replace("px","")),n=e.text().length;return n*t*0.5}return 0},e.utils.NaNtoZero=function(e){return typeof e!="number"||isNaN(e)||e===null||e===Infinity?0:e},e.utils.optionsFunc=function(e){return e&&d3.map(e).forEach(function(e,t){typeof this[e]=="function"&&this[e](t)}.bind(this)),this},e.models.axis=function(){function m(e){return e.each(function(e){var i=d3.select(this),m=i.selectAll("g.nv-wrap.nv-axis").data([e]),g=m.enter().append("g").attr("class","nvd3 nv-wrap nv-axis"),y=g.append("g"),b=m.select("g");p!==null?t.ticks(p):(t.orient()=="top"||t.orient()=="bottom")&&t.ticks(Math.abs(s.range()[1]-s.range()[0])/100),b.transition().call(t),v=v||t.scale();var w=t.tickFormat();w==null&&(w=v.tickFormat());var E=b.selectAll("text.nv-axislabel").data([o||null]);E.exit().remove();switch(t.orient()){case"top":E.enter().append("text").attr("class","nv-axislabel");var S=s.range().length==2?s.range()[1]:s.range()[s.range().length-1]+(s.range()[1]-s.range()[0]);E.attr("text-anchor","middle").attr("y",0).attr("x",S/2);if(u){var x=m.selectAll("g.nv-axisMaxMin").data(s.domain());x.enter().append("g").attr("class","nv-axisMaxMin").append("text"),x.exit().remove(),x.attr("transform",function(e,t){return"translate("+s(e)+",0)"}).select("text").attr("dy","0em").attr("y",-t.tickPadding()).attr("text-anchor","middle").text(function(e,t){var n=w(e);return(""+n).match("NaN")?"":n}),x.transition().attr("transform",function(e,t){return"translate("+s.range()[t]+",0)"})}break;case"bottom":var T=36,N=30,C=b.selectAll("g").select("text");if(f%360){C.each(function(e,t){var n=this.getBBox().width;n>N&&(N=n)});var k=Math.abs(Math.sin(f*Math.PI/180)),T=(k?k*N:N)+30;C.attr("transform",function(e,t,n){return"rotate("+f+" 0,0)"}).style("text-anchor",f%360>0?"start":"end")}E.enter().append("text").attr("class","nv-axislabel");var S=s.range().length==2?s.range()[1]:s.range()[s.range().length-1]+(s.range()[1]-s.range()[0]);E.attr("text-anchor","middle").attr("y",T).attr("x",S/2);if(u){var x=m.selectAll("g.nv-axisMaxMin").data([s.domain()[0],s.domain()[s.domain().length-1]]);x.enter().append("g").attr("class","nv-axisMaxMin").append("text"),x.exit().remove(),x.attr("transform",function(e,t){return"translate("+(s(e)+(h?s.rangeBand()/2:0))+",0)"}).select("text").attr("dy",".71em").attr("y",t.tickPadding()).attr("transform",function(e,t,n){return"rotate("+f+" 0,0)"}).style("text-anchor",f?f%360>0?"start":"end":"middle").text(function(e,t){var n=w(e);return(""+n).match("NaN")?"":n}),x.transition().attr("transform",function(e,t){return"translate("+(s(e)+(h?s.rangeBand()/2:0))+",0)"})}c&&C.attr("transform",function(e,t){return"translate(0,"+(t%2==0?"0":"12")+")"});break;case"right":E.enter().append("text").attr("class","nv-axislabel"),E.style("text-anchor",l?"middle":"begin").attr("transform",l?"rotate(90)":"").attr("y",l?-Math.max(n.right,r)+12:-10).attr("x",l?s.range()[0]/2:t.tickPadding());if(u){var x=m.selectAll("g.nv-axisMaxMin").data(s.domain());x.enter().append("g").attr("class","nv-axisMaxMin").append("text").style("opacity",0),x.exit().remove(),x.attr("transform",function(e,t){return"translate(0,"+s(e)+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",t.tickPadding()).style("text-anchor","start").text(function(e,t){var n=w(e);return(""+n).match("NaN")?"":n}),x.transition().attr("transform",function(e,t){return"translate(0,"+s.range()[t]+")"}).select("text").style("opacity",1)}break;case"left":E.enter().append("text").attr("class","nv-axislabel"),E.style("text-anchor",l?"middle":"end").attr("transform",l?"rotate(-90)":"").attr("y",l?-Math.max(n.left,r)+d:-10).attr("x",l?-s.range()[0]/2:-t.tickPadding());if(u){var x=m.selectAll("g.nv-axisMaxMin").data(s.domain());x.enter().append("g").attr("class","nv-axisMaxMin").append("text").style("opacity",0),x.exit().remove(),x.attr("transform",function(e,t){return"translate(0,"+v(e)+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",-t.tickPadding()).attr("text-anchor","end").text(function(e,t){var n=w(e);return(""+n).match("NaN")?"":n}),x.transition().attr("transform",function(e,t){return"translate(0,"+s.range()[t]+")"}).select("text").style("opacity",1)}}E.text(function(e){return e}),u&&(t.orient()==="left"||t.orient()==="right")&&(b.selectAll("g").each(function(e,t){d3.select(this).select("text").attr("opacity",1);if(s(e)<s.range()[1]+10||s(e)>s.range()[0]-10){(e>1e-10||e<-1e-10)&&d3.select(this).attr("opacity",0),d3.select(this).select("text").attr("opacity",0)}}),s.domain()[0]==s.domain()[1]&&s.domain()[0]==0&&m.selectAll("g.nv-axisMaxMin").style("opacity",function(e,t){return t?0:1}));if(u&&(t.orient()==="top"||t.orient()==="bottom")){var L=[];m.selectAll("g.nv-axisMaxMin").each(function(e,t){try{t?L.push(s(e)-this.getBBox().width-4):L.push(s(e)+this.getBBox().width+4)}catch(n){t?L.push(s(e)-4):L.push(s(e)+4)}}),b.selectAll("g").each(function(e,t){if(s(e)<L[0]||s(e)>L[1]){e>1e-10||e<-1e-10?d3.select(this).remove():d3.select(this).select("text").remove()}})}a&&b.selectAll(".tick").filter(function(e){return !parseFloat(Math.round(e.__data__*100000)/1000000)&&e.__data__!==undefined}).classed("zero",!0),v=s.copy()}),m}var t=d3.svg.axis(),n={top:0,right:0,bottom:0,left:0},r=75,i=60,s=d3.scale.linear(),o=null,u=!0,a=!0,f=0,l=!0,c=!1,h=!1,p=null,d=12;t.scale(s).orient("bottom").tickFormat(function(e){return e});var v;return m.axis=t,d3.rebind(m,t,"orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat"),d3.rebind(m,s,"domain","range","rangeBand","rangeBands"),m.options=e.utils.optionsFunc.bind(m),m.margin=function(e){return arguments.length?(n.top=typeof e.top!="undefined"?e.top:n.top,n.right=typeof e.right!="undefined"?e.right:n.right,n.bottom=typeof e.bottom!="undefined"?e.bottom:n.bottom,n.left=typeof e.left!="undefined"?e.left:n.left,m):n},m.width=function(e){return arguments.length?(r=e,m):r},m.ticks=function(e){return arguments.length?(p=e,m):p},m.height=function(e){return arguments.length?(i=e,m):i},m.axisLabel=function(e){return arguments.length?(o=e,m):o},m.showMaxMin=function(e){return arguments.length?(u=e,m):u},m.highlightZero=function(e){return arguments.length?(a=e,m):a},m.scale=function(e){return arguments.length?(s=e,t.scale(s),h=typeof s.rangeBands=="function",d3.rebind(m,s,"domain","range","rangeBand","rangeBands"),m):s},m.rotateYLabel=function(e){return arguments.length?(l=e,m):l},m.rotateLabels=function(e){return arguments.length?(f=e,m):f},m.staggerLabels=function(e){return arguments.length?(c=e,m):c},m.axisLabelDistance=function(e){return arguments.length?(d=e,m):d},m},e.models.bullet=function(){function m(e){return e.each(function(e,n){var p=c-t.left-t.right,m=h-t.top-t.bottom,g=d3.select(this),y=i.call(this,e,n).slice().sort(d3.descending),b=s.call(this,e,n).slice().sort(d3.descending),w=o.call(this,e,n).slice().sort(d3.descending),E=u.call(this,e,n).slice(),S=a.call(this,e,n).slice(),x=f.call(this,e,n).slice(),T=d3.scale.linear().domain(d3.extent(d3.merge([l,y]))).range(r?[p,0]:[0,p]),N=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(T.range());this.__chart__=T;var C=d3.min(y),k=d3.max(y),L=y[1],A=g.selectAll("g.nv-wrap.nv-bullet").data([e]),O=A.enter().append("g").attr("class","nvd3 nv-wrap nv-bullet"),M=O.append("g"),_=A.select("g");M.append("rect").attr("class","nv-range nv-rangeMax"),M.append("rect").attr("class","nv-range nv-rangeAvg"),M.append("rect").attr("class","nv-range nv-rangeMin"),M.append("rect").attr("class","nv-measure"),M.append("path").attr("class","nv-markerTriangle"),A.attr("transform","translate("+t.left+","+t.top+")");var D=function(e){return Math.abs(N(e)-N(0))},P=function(e){return Math.abs(T(e)-T(0))},H=function(e){return e<0?N(e):N(0)},B=function(e){return e<0?T(e):T(0)};_.select("rect.nv-rangeMax").attr("height",m).attr("width",P(k>0?k:C)).attr("x",B(k>0?k:C)).datum(k>0?k:C),_.select("rect.nv-rangeAvg").attr("height",m).attr("width",P(L)).attr("x",B(L)).datum(L),_.select("rect.nv-rangeMin").attr("height",m).attr("width",P(k)).attr("x",B(k)).attr("width",P(k>0?C:k)).attr("x",B(k>0?C:k)).datum(k>0?C:k),_.select("rect.nv-measure").style("fill",d).attr("height",m/3).attr("y",m/3).attr("width",w<0?T(0)-T(w[0]):T(w[0])-T(0)).attr("x",B(w)).on("mouseover",function(){v.elementMouseover({value:w[0],label:x[0]||"Current",pos:[T(w[0]),m/2]})}).on("mouseout",function(){v.elementMouseout({value:w[0],label:x[0]||"Current"})});var j=m/6;b[0]?_.selectAll("path.nv-markerTriangle").attr("transform",function(e){return"translate("+T(b[0])+","+m/2+")"}).attr("d","M0,"+j+"L"+j+","+-j+" "+-j+","+-j+"Z").on("mouseover",function(){v.elementMouseover({value:b[0],label:S[0]||"Previous",pos:[T(b[0]),m/2]})}).on("mouseout",function(){v.elementMouseout({value:b[0],label:S[0]||"Previous"})}):_.selectAll("path.nv-markerTriangle").remove(),A.selectAll(".nv-range").on("mouseover",function(e,t){var n=E[t]||(t?t==1?"Mean":"Minimum":"Maximum");v.elementMouseover({value:e,label:n,pos:[T(e),m/2]})}).on("mouseout",function(e,t){var n=E[t]||(t?t==1?"Mean":"Minimum":"Maximum");v.elementMouseout({value:e,label:n})})}),m}var t={top:0,right:0,bottom:0,left:0},n="left",r=!1,i=function(e){return e.ranges},s=function(e){return e.markers},o=function(e){return e.measures},u=function(e){return e.rangeLabels?e.rangeLabels:[]},a=function(e){return e.markerLabels?e.markerLabels:[]},f=function(e){return e.measureLabels?e.measureLabels:[]},l=[0],c=380,h=30,p=null,d=e.utils.getColor(["#1f77b4"]),v=d3.dispatch("elementMouseover","elementMouseout");return m.dispatch=v,m.options=e.utils.optionsFunc.bind(m),m.orient=function(e){return arguments.length?(n=e,r=n=="right"||n=="bottom",m):n},m.ranges=function(e){return arguments.length?(i=e,m):i},m.markers=function(e){return arguments.length?(s=e,m):s},m.measures=function(e){return arguments.length?(o=e,m):o},m.forceX=function(e){return arguments.length?(l=e,m):l},m.width=function(e){return arguments.length?(c=e,m):c},m.height=function(e){return arguments.length?(h=e,m):h},m.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,m):t},m.tickFormat=function(e){return arguments.length?(p=e,m):p},m.color=function(t){return arguments.length?(d=e.utils.getColor(t),m):d},m},e.models.bulletChart=function(){function m(e){return e.each(function(n,h){var g=d3.select(this),y=(a||parseInt(g.style("width"))||960)-i.left-i.right,b=f-i.top-i.bottom,w=this;m.update=function(){m(e)},m.container=this;if(!n||!s.call(this,n,h)){var E=g.selectAll(".nv-noData").data([p]);return E.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),E.attr("x",i.left+y/2).attr("y",18+i.top+b/2).text(function(e){return e}),m}g.selectAll(".nv-noData").remove();var S=s.call(this,n,h).slice().sort(d3.descending),x=o.call(this,n,h).slice().sort(d3.descending),T=u.call(this,n,h).slice().sort(d3.descending),N=g.selectAll("g.nv-wrap.nv-bulletChart").data([n]),C=N.enter().append("g").attr("class","nvd3 nv-wrap nv-bulletChart"),k=C.append("g"),L=N.select("g");k.append("g").attr("class","nv-bulletWrap"),k.append("g").attr("class","nv-titles"),N.attr("transform","translate("+i.left+","+i.top+")");var A=d3.scale.linear().domain([0,Math.max(S[0],x[0],T[0])]).range(r?[y,0]:[0,y]),O=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(A.range());this.__chart__=A;var M=function(e){return Math.abs(O(e)-O(0))},_=function(e){return Math.abs(A(e)-A(0))},D=k.select(".nv-titles").append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(f-i.top-i.bottom)/2+")");D.append("text").attr("class","nv-title").text(function(e){return e.title}),D.append("text").attr("class","nv-subtitle").attr("dy","1em").text(function(e){return e.subtitle}),t.width(y).height(b);var P=L.select(".nv-bulletWrap");d3.transition(P).call(t);var H=l||A.tickFormat(y/100),B=L.selectAll("g.nv-tick").data(A.ticks(y/50),function(e){return this.textContent||H(e)}),j=B.enter().append("g").attr("class","nv-tick").attr("transform",function(e){return"translate("+O(e)+",0)"}).style("opacity",0.000001);j.append("line").attr("y1",b).attr("y2",b*7/6),j.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",b*7/6).text(H);var F=d3.transition(B).attr("transform",function(e){return"translate("+A(e)+",0)"}).style("opacity",1);F.select("line").attr("y1",b).attr("y2",b*7/6),F.select("text").attr("y",b*7/6),d3.transition(B.exit()).attr("transform",function(e){return"translate("+A(e)+",0)"}).style("opacity",0.000001).remove(),d.on("tooltipShow",function(e){e.key=n.title,c&&v(e,w.parentNode)})}),d3.timer.flush(),m}var t=e.models.bullet(),n="left",r=!1,i={top:5,right:40,bottom:20,left:120},s=function(e){return e.ranges},o=function(e){return e.markers},u=function(e){return e.measures},a=null,f=55,l=null,c=!0,h=function(e,t,n,r,i){return"<h3>"+t+"</h3><p>"+n+"</p>"},p="No Data Available.",d=d3.dispatch("tooltipShow","tooltipHide"),v=function(t,n){var r=t.pos[0]+(n.offsetLeft||0)+i.left,s=t.pos[1]+(n.offsetTop||0)+i.top,o=h(t.key,t.label,t.value,t,m);e.tooltip.show([r,s],o,t.value<0?"e":"w",null,n)};return t.dispatch.on("elementMouseover.tooltip",function(e){d.tooltipShow(e)}),t.dispatch.on("elementMouseout.tooltip",function(e){d.tooltipHide(e)}),d.on("tooltipHide",function(){c&&e.tooltip.cleanup()}),m.dispatch=d,m.bullet=t,d3.rebind(m,t,"color"),m.options=e.utils.optionsFunc.bind(m),m.orient=function(e){return arguments.length?(n=e,r=n=="right"||n=="bottom",m):n},m.ranges=function(e){return arguments.length?(s=e,m):s},m.markers=function(e){return arguments.length?(o=e,m):o},m.measures=function(e){return arguments.length?(u=e,m):u},m.width=function(e){return arguments.length?(a=e,m):a},m.height=function(e){return arguments.length?(f=e,m):f},m.margin=function(e){return arguments.length?(i.top=typeof e.top!="undefined"?e.top:i.top,i.right=typeof e.right!="undefined"?e.right:i.right,i.bottom=typeof e.bottom!="undefined"?e.bottom:i.bottom,i.left=typeof e.left!="undefined"?e.left:i.left,m):i},m.tickFormat=function(e){return arguments.length?(l=e,m):l},m.tooltips=function(e){return arguments.length?(c=e,m):c},m.tooltipContent=function(e){return arguments.length?(h=e,m):h},m.noData=function(e){return arguments.length?(p=e,m):p},m},e.models.cumulativeLineChart=function(){function _(b){return b.each(function(b){function q(e,t){d3.select(_.container).style("cursor","ew-resize")}function R(e,t){O.x=d3.event.x,O.i=Math.round(A.invert(O.x)),rt()}function U(e,t){d3.select(_.container).style("cursor","auto"),x.index=O.i,k.stateChange(x)}function rt(){nt.data([O]);var e=_.transitionDuration();_.transitionDuration(0),_.update(),_.transitionDuration(e)}var P=d3.select(this).classed("nv-chart-"+S,!0),H=this,B=(f||parseInt(P.style("width"))||960)-u.left-u.right,j=(l||parseInt(P.style("height"))||400)-u.top-u.bottom;_.update=function(){P.transition().duration(L).call(_)},_.container=this,x.disabled=b.map(function(e){return !!e.disabled});if(!T){var F;T={};for(F in x){x[F] instanceof Array?T[F]=x[F].slice(0):T[F]=x[F]}}var I=d3.behavior.drag().on("dragstart",q).on("drag",R).on("dragend",U);if(!b||!b.length||!b.filter(function(e){return e.values.length}).length){var z=P.selectAll(".nv-noData").data([N]);return z.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),z.attr("x",u.left+B/2).attr("y",u.top+j/2).text(function(e){return e}),_}P.selectAll(".nv-noData").remove(),w=t.xScale(),E=t.yScale();if(!y){var W=b.filter(function(e){return !e.disabled}).map(function(e,n){var r=d3.extent(e.values,t.y());return r[0]<-0.95&&(r[0]=-0.95),[(r[0]-r[1])/(1+r[1]),(r[1]-r[0])/(1+r[0])]}),X=[d3.min(W,function(e){return e[0]}),d3.max(W,function(e){return e[1]})];t.yDomain(X)}else{t.yDomain(null)}A.domain([0,b[0].values.length-1]).range([0,B]).clamp(!0);var b=D(O.i,b),V=g?"none":"all",$=P.selectAll("g.nv-wrap.nv-cumulativeLine").data([b]),J=$.enter().append("g").attr("class","nvd3 nv-wrap nv-cumulativeLine").append("g"),K=$.select("g");J.append("g").attr("class","nv-interactive"),J.append("g").attr("class","nv-x nv-axis").style("pointer-events","none"),J.append("g").attr("class","nv-y nv-axis"),J.append("g").attr("class","nv-background"),J.append("g").attr("class","nv-linesWrap").style("pointer-events",V),J.append("g").attr("class","nv-avgLinesWrap").style("pointer-events","none"),J.append("g").attr("class","nv-legendWrap"),J.append("g").attr("class","nv-controlsWrap"),c&&(i.width(B),K.select(".nv-legendWrap").datum(b).call(i),u.top!=i.height()&&(u.top=i.height(),j=(l||parseInt(P.style("height"))||400)-u.top-u.bottom),K.select(".nv-legendWrap").attr("transform","translate(0,"+-u.top+")"));if(m){var Q=[{key:"Re-scale y-axis",disabled:!y}];s.width(140).color(["#444","#444","#444"]),K.select(".nv-controlsWrap").datum(Q).attr("transform","translate(0,"+-u.top+")").call(s)}$.attr("transform","translate("+u.left+","+u.top+")"),d&&K.select(".nv-y.nv-axis").attr("transform","translate("+B+",0)");var G=b.filter(function(e){return e.tempDisabled});$.select(".tempDisabled").remove(),G.length&&$.append("text").attr("class","tempDisabled").attr("x",B/2).attr("y","-.71em").style("text-anchor","end").text(G.map(function(e){return e.key}).join(", ")+" values cannot be calculated for this time period."),g&&(o.width(B).height(j).margin({left:u.left,top:u.top}).svgContainer(P).xScale(w),$.select(".nv-interactive").call(o)),J.select(".nv-background").append("rect"),K.select(".nv-background rect").attr("width",B).attr("height",j),t.y(function(e){return e.display.y}).width(B).height(j).color(b.map(function(e,t){return e.color||a(e,t)}).filter(function(e,t){return !b[t].disabled&&!b[t].tempDisabled}));var Y=K.select(".nv-linesWrap").datum(b.filter(function(e){return !e.disabled&&!e.tempDisabled}));Y.call(t),b.forEach(function(e,t){e.seriesIndex=t});var Z=b.filter(function(e){return !e.disabled&&!!C(e)}),et=K.select(".nv-avgLinesWrap").selectAll("line").data(Z,function(e){return e.key}),tt=function(e){var t=E(C(e));return t<0?0:t>j?j:t};et.enter().append("line").style("stroke-width",2).style("stroke-dasharray","10,10").style("stroke",function(e,n){return t.color()(e,e.seriesIndex)}).attr("x1",0).attr("x2",B).attr("y1",tt).attr("y2",tt),et.style("stroke-opacity",function(e){var t=E(C(e));return t<0||t>j?0:1}).attr("x1",0).attr("x2",B).attr("y1",tt).attr("y2",tt),et.exit().remove();var nt=Y.selectAll(".nv-indexLine").data([O]);nt.enter().append("rect").attr("class","nv-indexLine").attr("width",3).attr("x",-2).attr("fill","red").attr("fill-opacity",0.5).style("pointer-events","all").call(I),nt.attr("transform",function(e){return"translate("+A(e.i)+",0)"}).attr("height",j),h&&(n.scale(w).ticks(Math.min(b[0].values.length,B/70)).tickSize(-j,0),K.select(".nv-x.nv-axis").attr("transform","translate(0,"+E.range()[0]+")"),d3.transition(K.select(".nv-x.nv-axis")).call(n)),p&&(r.scale(E).ticks(j/36).tickSize(-B,0),d3.transition(K.select(".nv-y.nv-axis")).call(r)),K.select(".nv-background rect").on("click",function(){O.x=d3.mouse(this)[0],O.i=Math.round(A.invert(O.x)),x.index=O.i,k.stateChange(x),rt()}),t.dispatch.on("elementClick",function(e){O.i=e.pointIndex,O.x=A(O.i),x.index=O.i,k.stateChange(x),rt()}),s.dispatch.on("legendClick",function(e,t){e.disabled=!e.disabled,y=!e.disabled,x.rescaleY=y,k.stateChange(x),_.update()}),i.dispatch.on("stateChange",function(e){x.disabled=e.disabled,k.stateChange(x),_.update()}),o.dispatch.on("elementMousemove",function(i){t.clearHighlights();var s,f,l,c=[];b.filter(function(e,t){return e.seriesIndex=t,!e.disabled}).forEach(function(n,r){f=e.interactiveBisect(n.values,i.pointXValue,_.x()),t.highlightPoint(r,f,!0);var o=n.values[f];if(typeof o=="undefined"){return}typeof s=="undefined"&&(s=o),typeof l=="undefined"&&(l=_.xScale()(_.x()(o,f))),c.push({key:n.key,value:_.y()(o,f),color:a(n,n.seriesIndex)})});if(c.length>2){var h=_.yScale().invert(i.mouseY),p=Math.abs(_.yScale().domain()[0]-_.yScale().domain()[1]),d=0.03*p,m=e.nearestValueIndex(c.map(function(e){return e.value}),h,d);m!==null&&(c[m].highlight=!0)}var g=n.tickFormat()(_.x()(s,f),f);o.tooltip.position({left:l+u.left,top:i.mouseY+u.top}).chartContainer(H.parentNode).enabled(v).valueFormatter(function(e,t){return r.tickFormat()(e)}).data({value:g,series:c})(),o.renderGuideLine(l)}),o.dispatch.on("elementMouseout",function(e){k.tooltipHide(),t.clearHighlights()}),k.on("tooltipShow",function(e){v&&M(e,H.parentNode)}),k.on("changeState",function(e){typeof e.disabled!="undefined"&&(b.forEach(function(t,n){t.disabled=e.disabled[n]}),x.disabled=e.disabled),typeof e.index!="undefined"&&(O.i=e.index,O.x=A(O.i),x.index=e.index,nt.data([O])),typeof e.rescaleY!="undefined"&&(y=e.rescaleY),_.update()})}),_}function D(e,n){return n.map(function(n,r){if(!n.values){return n}var i=t.y()(n.values[e],e);return i<-0.95?(n.tempDisabled=!0,n):(n.tempDisabled=!1,n.values=n.values.map(function(e,n){return e.display={y:(t.y()(e,n)-i)/(1+i)},e}),n)})}var t=e.models.line(),n=e.models.axis(),r=e.models.axis(),i=e.models.legend(),s=e.models.legend(),o=e.interactiveGuideline(),u={top:30,right:30,bottom:50,left:60},a=e.utils.defaultColor(),f=null,l=null,c=!0,h=!0,p=!0,d=!1,v=!0,m=!0,g=!1,y=!0,b=function(e,t,n,r,i){return"<h3>"+e+"</h3><p>"+n+" at "+t+"</p>"},w,E,S=t.id(),x={index:0,rescaleY:y},T=null,N="No Data Available.",C=function(e){return e.average},k=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),L=250;n.orient("bottom").tickPadding(7),r.orient(d?"right":"left"),s.updateState(!1);var A=d3.scale.linear(),O={i:0,x:0},M=function(i,s){var o=i.pos[0]+(s.offsetLeft||0),u=i.pos[1]+(s.offsetTop||0),a=n.tickFormat()(t.x()(i.point,i.pointIndex)),f=r.tickFormat()(t.y()(i.point,i.pointIndex)),l=b(i.series.key,a,f,i,_);e.tooltip.show([o,u],l,null,null,s)};return t.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+u.left,e.pos[1]+u.top],k.tooltipShow(e)}),t.dispatch.on("elementMouseout.tooltip",function(e){k.tooltipHide(e)}),k.on("tooltipHide",function(){v&&e.tooltip.cleanup()}),_.dispatch=k,_.lines=t,_.legend=i,_.xAxis=n,_.yAxis=r,_.interactiveLayer=o,d3.rebind(_,t,"defined","isArea","x","y","xScale","yScale","size","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","useVoronoi","id"),_.options=e.utils.optionsFunc.bind(_),_.margin=function(e){return arguments.length?(u.top=typeof e.top!="undefined"?e.top:u.top,u.right=typeof e.right!="undefined"?e.right:u.right,u.bottom=typeof e.bottom!="undefined"?e.bottom:u.bottom,u.left=typeof e.left!="undefined"?e.left:u.left,_):u},_.width=function(e){return arguments.length?(f=e,_):f},_.height=function(e){return arguments.length?(l=e,_):l},_.color=function(t){return arguments.length?(a=e.utils.getColor(t),i.color(a),_):a},_.rescaleY=function(e){return arguments.length?(y=e,_):y},_.showControls=function(e){return arguments.length?(m=e,_):m},_.useInteractiveGuideline=function(e){return arguments.length?(g=e,e===!0&&(_.interactive(!1),_.useVoronoi(!1)),_):g},_.showLegend=function(e){return arguments.length?(c=e,_):c},_.showXAxis=function(e){return arguments.length?(h=e,_):h},_.showYAxis=function(e){return arguments.length?(p=e,_):p},_.rightAlignYAxis=function(e){return arguments.length?(d=e,r.orient(e?"right":"left"),_):d},_.tooltips=function(e){return arguments.length?(v=e,_):v},_.tooltipContent=function(e){return arguments.length?(b=e,_):b},_.state=function(e){return arguments.length?(x=e,_):x},_.defaultState=function(e){return arguments.length?(T=e,_):T},_.noData=function(e){return arguments.length?(N=e,_):N},_.average=function(e){return arguments.length?(C=e,_):C},_.transitionDuration=function(e){return arguments.length?(L=e,_):L},_},e.models.discreteBar=function(){function E(e){return e.each(function(e){var i=n-t.left-t.right,E=r-t.top-t.bottom,S=d3.select(this);e=e.map(function(e,t){return e.values=e.values.map(function(e){return e.series=t,e}),e});var T=p&&d?[]:e.map(function(e){return e.values.map(function(e,t){return{x:u(e,t),y:a(e,t),y0:e.y0}})});s.domain(p||d3.merge(T).map(function(e){return e.x})).rangeBands(v||[0,i],0.1),o.domain(d||d3.extent(d3.merge(T).map(function(e){return e.y}).concat(f))),c?o.range(m||[E-(o.domain()[0]<0?12:0),o.domain()[1]>0?12:0]):o.range(m||[E,0]),b=b||s,w=w||o.copy().range([o(0),o(0)]);var N=S.selectAll("g.nv-wrap.nv-discretebar").data([e]),C=N.enter().append("g").attr("class","nvd3 nv-wrap nv-discretebar"),k=C.append("g"),L=N.select("g");k.append("g").attr("class","nv-groups"),N.attr("transform","translate("+t.left+","+t.top+")");var A=N.select(".nv-groups").selectAll(".nv-group").data(function(e){return e},function(e){return e.key});A.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001),A.exit().transition().style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove(),A.attr("class",function(e,t){return"nv-group nv-series-"+t}).classed("hover",function(e){return e.hover}),A.transition().style("stroke-opacity",1).style("fill-opacity",0.75);var O=A.selectAll("g.nv-bar").data(function(e){return e.values});O.exit().remove();var M=O.enter().append("g").attr("transform",function(e,t,n){return"translate("+(s(u(e,t))+s.rangeBand()*0.05)+", "+o(0)+")"}).on("mouseover",function(t,n){d3.select(this).classed("hover",!0),g.elementMouseover({value:a(t,n),point:t,series:e[t.series],pos:[s(u(t,n))+s.rangeBand()*(t.series+0.5)/e.length,o(a(t,n))],pointIndex:n,seriesIndex:t.series,e:d3.event})}).on("mouseout",function(t,n){d3.select(this).classed("hover",!1),g.elementMouseout({value:a(t,n),point:t,series:e[t.series],pointIndex:n,seriesIndex:t.series,e:d3.event})}).on("click",function(t,n){g.elementClick({value:a(t,n),point:t,series:e[t.series],pos:[s(u(t,n))+s.rangeBand()*(t.series+0.5)/e.length,o(a(t,n))],pointIndex:n,seriesIndex:t.series,e:d3.event}),d3.event.stopPropagation()}).on("dblclick",function(t,n){g.elementDblClick({value:a(t,n),point:t,series:e[t.series],pos:[s(u(t,n))+s.rangeBand()*(t.series+0.5)/e.length,o(a(t,n))],pointIndex:n,seriesIndex:t.series,e:d3.event}),d3.event.stopPropagation()});M.append("rect").attr("height",0).attr("width",s.rangeBand()*0.9/e.length),c?(M.append("text").attr("text-anchor","middle"),O.select("text").text(function(e,t){return h(a(e,t))}).transition().attr("x",s.rangeBand()*0.9/2).attr("y",function(e,t){return a(e,t)<0?o(a(e,t))-o(0)+12:-4})):O.selectAll("text").remove(),O.attr("class",function(e,t){return a(e,t)<0?"nv-bar negative":"nv-bar positive"}).style("fill",function(e,t){return e.color||l(e,t)}).style("stroke",function(e,t){return e.color||l(e,t)}).select("rect").attr("class",y).transition().attr("width",s.rangeBand()*0.9/e.length),O.transition().attr("transform",function(e,t){var n=s(u(e,t))+s.rangeBand()*0.05,r=a(e,t)<0?o(0):o(0)-o(a(e,t))<1?o(0)-1:o(a(e,t));return"translate("+n+", "+r+")"}).select("rect").attr("height",function(e,t){return Math.max(Math.abs(o(a(e,t))-o(d&&d[0]||0))||1)}),b=s.copy(),w=o.copy()}),E}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=Math.floor(Math.random()*10000),s=d3.scale.ordinal(),o=d3.scale.linear(),u=function(e){return e.x},a=function(e){return e.y},f=[0],l=e.utils.defaultColor(),c=!1,h=d3.format(",.2f"),p,d,v,m,g=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),y="discreteBar",b,w;return E.dispatch=g,E.options=e.utils.optionsFunc.bind(E),E.x=function(e){return arguments.length?(u=e,E):u},E.y=function(e){return arguments.length?(a=e,E):a},E.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,E):t},E.width=function(e){return arguments.length?(n=e,E):n},E.height=function(e){return arguments.length?(r=e,E):r},E.xScale=function(e){return arguments.length?(s=e,E):s},E.yScale=function(e){return arguments.length?(o=e,E):o},E.xDomain=function(e){return arguments.length?(p=e,E):p},E.yDomain=function(e){return arguments.length?(d=e,E):d},E.xRange=function(e){return arguments.length?(v=e,E):v},E.yRange=function(e){return arguments.length?(m=e,E):m},E.forceY=function(e){return arguments.length?(f=e,E):f},E.color=function(t){return arguments.length?(l=e.utils.getColor(t),E):l},E.id=function(e){return arguments.length?(i=e,E):i},E.showValues=function(e){return arguments.length?(c=e,E):c},E.valueFormat=function(e){return arguments.length?(h=e,E):h},E.rectClass=function(e){return arguments.length?(y=e,E):y},E},e.models.discreteBarChart=function(){function w(e){return e.each(function(e){var u=d3.select(this),p=this,E=(s||parseInt(u.style("width"))||960)-i.left-i.right,S=(o||parseInt(u.style("height"))||400)-i.top-i.bottom;w.update=function(){g.beforeUpdate(),u.transition().duration(y).call(w)},w.container=this;if(!e||!e.length||!e.filter(function(e){return e.values.length}).length){var T=u.selectAll(".nv-noData").data([m]);return T.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),T.attr("x",i.left+E/2).attr("y",i.top+S/2).text(function(e){return e}),w}u.selectAll(".nv-noData").remove(),d=t.xScale(),v=t.yScale().clamp(!0);var N=u.selectAll("g.nv-wrap.nv-discreteBarWithAxes").data([e]),C=N.enter().append("g").attr("class","nvd3 nv-wrap nv-discreteBarWithAxes").append("g"),k=C.append("defs"),L=N.select("g");C.append("g").attr("class","nv-x nv-axis"),C.append("g").attr("class","nv-y nv-axis"),C.append("g").attr("class","nv-barsWrap"),L.attr("transform","translate("+i.left+","+i.top+")"),l&&L.select(".nv-y.nv-axis").attr("transform","translate("+E+",0)"),t.width(E).height(S);var A=L.select(".nv-barsWrap").datum(e.filter(function(e){return !e.disabled}));A.transition().call(t),k.append("clipPath").attr("id","nv-x-label-clip-"+t.id()).append("rect"),L.select("#nv-x-label-clip-"+t.id()+" rect").attr("width",d.rangeBand()*(c?2:1)).attr("height",16).attr("x",-d.rangeBand()/(c?1:2));if(a){n.scale(d).ticks(E/100).tickSize(-S,0),L.select(".nv-x.nv-axis").attr("transform","translate(0,"+(v.range()[0]+(t.showValues()&&v.domain()[0]<0?16:0))+")"),L.select(".nv-x.nv-axis").transition().call(n);var O=L.select(".nv-x.nv-axis").selectAll("g");c&&O.selectAll("text").attr("transform",function(e,t,n){return"translate(0,"+(n%2==0?"5":"17")+")"})}f&&(r.scale(v).ticks(S/36).tickSize(-E,0),L.select(".nv-y.nv-axis").transition().call(r)),g.on("tooltipShow",function(e){h&&b(e,p.parentNode)})}),w}var t=e.models.discreteBar(),n=e.models.axis(),r=e.models.axis(),i={top:15,right:10,bottom:50,left:60},s=null,o=null,u=e.utils.getColor(),a=!0,f=!0,l=!1,c=!1,h=!0,p=function(e,t,n,r,i){return"<h3>"+t+"</h3><p>"+n+"</p>"},d,v,m="No Data Available.",g=d3.dispatch("tooltipShow","tooltipHide","beforeUpdate"),y=250;n.orient("bottom").highlightZero(!1).showMaxMin(!1).tickFormat(function(e){return e}),r.orient(l?"right":"left").tickFormat(d3.format(",.1f"));var b=function(i,s){var o=i.pos[0]+(s.offsetLeft||0),u=i.pos[1]+(s.offsetTop||0),a=n.tickFormat()(t.x()(i.point,i.pointIndex)),f=r.tickFormat()(t.y()(i.point,i.pointIndex)),l=p(i.series.key,a,f,i,w);e.tooltip.show([o,u],l,i.value<0?"n":"s",null,s)};return t.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+i.left,e.pos[1]+i.top],g.tooltipShow(e)}),t.dispatch.on("elementMouseout.tooltip",function(e){g.tooltipHide(e)}),g.on("tooltipHide",function(){h&&e.tooltip.cleanup()}),w.dispatch=g,w.discretebar=t,w.xAxis=n,w.yAxis=r,d3.rebind(w,t,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","id","showValues","valueFormat"),w.options=e.utils.optionsFunc.bind(w),w.margin=function(e){return arguments.length?(i.top=typeof e.top!="undefined"?e.top:i.top,i.right=typeof e.right!="undefined"?e.right:i.right,i.bottom=typeof e.bottom!="undefined"?e.bottom:i.bottom,i.left=typeof e.left!="undefined"?e.left:i.left,w):i},w.width=function(e){return arguments.length?(s=e,w):s},w.height=function(e){return arguments.length?(o=e,w):o},w.color=function(n){return arguments.length?(u=e.utils.getColor(n),t.color(u),w):u},w.showXAxis=function(e){return arguments.length?(a=e,w):a},w.showYAxis=function(e){return arguments.length?(f=e,w):f},w.rightAlignYAxis=function(e){return arguments.length?(l=e,r.orient(e?"right":"left"),w):l},w.staggerLabels=function(e){return arguments.length?(c=e,w):c},w.tooltips=function(e){return arguments.length?(h=e,w):h},w.tooltipContent=function(e){return arguments.length?(p=e,w):p},w.noData=function(e){return arguments.length?(m=e,w):m},w.transitionDuration=function(e){return arguments.length?(y=e,w):y},w},e.models.distribution=function(){function l(e){return e.each(function(e){var a=n-(i==="x"?t.left+t.right:t.top+t.bottom),l=i=="x"?"y":"x",c=d3.select(this);f=f||u;var h=c.selectAll("g.nv-distribution").data([e]),p=h.enter().append("g").attr("class","nvd3 nv-distribution"),d=p.append("g"),v=h.select("g");h.attr("transform","translate("+t.left+","+t.top+")");var m=v.selectAll("g.nv-dist").data(function(e){return e},function(e){return e.key});m.enter().append("g"),m.attr("class",function(e,t){return"nv-dist nv-series-"+t}).style("stroke",function(e,t){return o(e,t)});var g=m.selectAll("line.nv-dist"+i).data(function(e){return e.values});g.enter().append("line").attr(i+"1",function(e,t){return f(s(e,t))}).attr(i+"2",function(e,t){return f(s(e,t))}),m.exit().selectAll("line.nv-dist"+i).transition().attr(i+"1",function(e,t){return u(s(e,t))}).attr(i+"2",function(e,t){return u(s(e,t))}).style("stroke-opacity",0).remove(),g.attr("class",function(e,t){return"nv-dist"+i+" nv-dist"+i+"-"+t}).attr(l+"1",0).attr(l+"2",r),g.transition().attr(i+"1",function(e,t){return u(s(e,t))}).attr(i+"2",function(e,t){return u(s(e,t))}),f=u.copy()}),l}var t={top:0,right:0,bottom:0,left:0},n=400,r=8,i="x",s=function(e){return e[i]},o=e.utils.defaultColor(),u=d3.scale.linear(),a,f;return l.options=e.utils.optionsFunc.bind(l),l.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,l):t},l.width=function(e){return arguments.length?(n=e,l):n},l.axis=function(e){return arguments.length?(i=e,l):i},l.size=function(e){return arguments.length?(r=e,l):r},l.getData=function(e){return arguments.length?(s=d3.functor(e),l):s},l.scale=function(e){return arguments.length?(u=e,l):u},l.color=function(t){return arguments.length?(o=e.utils.getColor(t),l):o},l},e.models.historicalBar=function(){function w(E){return E.each(function(w){var E=n-t.left-t.right,S=r-t.top-t.bottom,T=d3.select(this);s.domain(d||d3.extent(w[0].values.map(u).concat(f))),c?s.range(m||[E*0.5/w[0].values.length,E*(w[0].values.length-0.5)/w[0].values.length]):s.range(m||[0,E]),o.domain(v||d3.extent(w[0].values.map(a).concat(l))).range(g||[S,0]),s.domain()[0]===s.domain()[1]&&(s.domain()[0]?s.domain([s.domain()[0]-s.domain()[0]*0.01,s.domain()[1]+s.domain()[1]*0.01]):s.domain([-1,1])),o.domain()[0]===o.domain()[1]&&(o.domain()[0]?o.domain([o.domain()[0]+o.domain()[0]*0.01,o.domain()[1]-o.domain()[1]*0.01]):o.domain([-1,1]));var N=T.selectAll("g.nv-wrap.nv-historicalBar-"+i).data([w[0].values]),C=N.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBar-"+i),k=C.append("defs"),L=C.append("g"),A=N.select("g");L.append("g").attr("class","nv-bars"),N.attr("transform","translate("+t.left+","+t.top+")"),T.on("click",function(e,t){y.chartClick({data:e,index:t,pos:d3.event,id:i})}),k.append("clipPath").attr("id","nv-chart-clip-path-"+i).append("rect"),N.select("#nv-chart-clip-path-"+i+" rect").attr("width",E).attr("height",S),A.attr("clip-path",h?"url(#nv-chart-clip-path-"+i+")":"");var O=N.select(".nv-bars").selectAll(".nv-bar").data(function(e){return e},function(e,t){return u(e,t)});O.exit().remove();var M=O.enter().append("rect").attr("x",0).attr("y",function(t,n){return e.utils.NaNtoZero(o(Math.max(0,a(t,n))))}).attr("height",function(t,n){return e.utils.NaNtoZero(Math.abs(o(a(t,n))-o(0)))}).attr("transform",function(e,t){return"translate("+(s(u(e,t))-E/w[0].values.length*0.45)+",0)"}).on("mouseover",function(e,t){if(!b){return}d3.select(this).classed("hover",!0),y.elementMouseover({point:e,series:w[0],pos:[s(u(e,t)),o(a(e,t))],pointIndex:t,seriesIndex:0,e:d3.event})}).on("mouseout",function(e,t){if(!b){return}d3.select(this).classed("hover",!1),y.elementMouseout({point:e,series:w[0],pointIndex:t,seriesIndex:0,e:d3.event})}).on("click",function(e,t){if(!b){return}y.elementClick({value:a(e,t),data:e,index:t,pos:[s(u(e,t)),o(a(e,t))],e:d3.event,id:i}),d3.event.stopPropagation()}).on("dblclick",function(e,t){if(!b){return}y.elementDblClick({value:a(e,t),data:e,index:t,pos:[s(u(e,t)),o(a(e,t))],e:d3.event,id:i}),d3.event.stopPropagation()});O.attr("fill",function(e,t){return p(e,t)}).attr("class",function(e,t,n){return(a(e,t)<0?"nv-bar negative":"nv-bar positive")+" nv-bar-"+n+"-"+t}).transition().attr("transform",function(e,t){return"translate("+(s(u(e,t))-E/w[0].values.length*0.45)+",0)"}).attr("width",E/w[0].values.length*0.9),O.transition().attr("y",function(t,n){var r=a(t,n)<0?o(0):o(0)-o(a(t,n))<1?o(0)-1:o(a(t,n));return e.utils.NaNtoZero(r)}).attr("height",function(t,n){return e.utils.NaNtoZero(Math.max(Math.abs(o(a(t,n))-o(0)),1))})}),w}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=Math.floor(Math.random()*10000),s=d3.scale.linear(),o=d3.scale.linear(),u=function(e){return e.x},a=function(e){return e.y},f=[],l=[0],c=!1,h=!0,p=e.utils.defaultColor(),d,v,m,g,y=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),b=!0;return w.highlightPoint=function(e,t){d3.select(".nv-historicalBar-"+i).select(".nv-bars .nv-bar-0-"+e).classed("hover",t)},w.clearHighlights=function(){d3.select(".nv-historicalBar-"+i).select(".nv-bars .nv-bar.hover").classed("hover",!1)},w.dispatch=y,w.options=e.utils.optionsFunc.bind(w),w.x=function(e){return arguments.length?(u=e,w):u},w.y=function(e){return arguments.length?(a=e,w):a},w.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,w):t},w.width=function(e){return arguments.length?(n=e,w):n},w.height=function(e){return arguments.length?(r=e,w):r},w.xScale=function(e){return arguments.length?(s=e,w):s},w.yScale=function(e){return arguments.length?(o=e,w):o},w.xDomain=function(e){return arguments.length?(d=e,w):d},w.yDomain=function(e){return arguments.length?(v=e,w):v},w.xRange=function(e){return arguments.length?(m=e,w):m},w.yRange=function(e){return arguments.length?(g=e,w):g},w.forceX=function(e){return arguments.length?(f=e,w):f},w.forceY=function(e){return arguments.length?(l=e,w):l},w.padData=function(e){return arguments.length?(c=e,w):c},w.clipEdge=function(e){return arguments.length?(h=e,w):h},w.color=function(t){return arguments.length?(p=e.utils.getColor(t),w):p},w.id=function(e){return arguments.length?(i=e,w):i},w.interactive=function(e){return arguments.length?(b=!1,w):b},w},e.models.historicalBarChart=function(){function x(e){return e.each(function(d){var T=d3.select(this),N=this,C=(u||parseInt(T.style("width"))||960)-s.left-s.right,k=(a||parseInt(T.style("height"))||400)-s.top-s.bottom;x.update=function(){T.transition().duration(E).call(x)},x.container=this,g.disabled=d.map(function(e){return !!e.disabled});if(!y){var L;y={};for(L in g){g[L] instanceof Array?y[L]=g[L].slice(0):y[L]=g[L]}}if(!d||!d.length||!d.filter(function(e){return e.values.length}).length){var A=T.selectAll(".nv-noData").data([b]);return A.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),A.attr("x",s.left+C/2).attr("y",s.top+k/2).text(function(e){return e}),x}T.selectAll(".nv-noData").remove(),v=t.xScale(),m=t.yScale();var O=T.selectAll("g.nv-wrap.nv-historicalBarChart").data([d]),M=O.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBarChart").append("g"),_=O.select("g");M.append("g").attr("class","nv-x nv-axis"),M.append("g").attr("class","nv-y nv-axis"),M.append("g").attr("class","nv-barsWrap"),M.append("g").attr("class","nv-legendWrap"),f&&(i.width(C),_.select(".nv-legendWrap").datum(d).call(i),s.top!=i.height()&&(s.top=i.height(),k=(a||parseInt(T.style("height"))||400)-s.top-s.bottom),O.select(".nv-legendWrap").attr("transform","translate(0,"+-s.top+")")),O.attr("transform","translate("+s.left+","+s.top+")"),h&&_.select(".nv-y.nv-axis").attr("transform","translate("+C+",0)"),t.width(C).height(k).color(d.map(function(e,t){return e.color||o(e,t)}).filter(function(e,t){return !d[t].disabled}));var D=_.select(".nv-barsWrap").datum(d.filter(function(e){return !e.disabled}));D.transition().call(t),l&&(n.scale(v).tickSize(-k,0),_.select(".nv-x.nv-axis").attr("transform","translate(0,"+m.range()[0]+")"),_.select(".nv-x.nv-axis").transition().call(n)),c&&(r.scale(m).ticks(k/36).tickSize(-C,0),_.select(".nv-y.nv-axis").transition().call(r)),i.dispatch.on("legendClick",function(t,n){t.disabled=!t.disabled,d.filter(function(e){return !e.disabled}).length||d.map(function(e){return e.disabled=!1,O.selectAll(".nv-series").classed("disabled",!1),e}),g.disabled=d.map(function(e){return !!e.disabled}),w.stateChange(g),e.transition().call(x)}),i.dispatch.on("legendDblclick",function(e){d.forEach(function(e){e.disabled=!0}),e.disabled=!1,g.disabled=d.map(function(e){return !!e.disabled}),w.stateChange(g),x.update()}),w.on("tooltipShow",function(e){p&&S(e,N.parentNode)}),w.on("changeState",function(t){typeof t.disabled!="undefined"&&(d.forEach(function(e,n){e.disabled=t.disabled[n]}),g.disabled=t.disabled),e.call(x)})}),x}var t=e.models.historicalBar(),n=e.models.axis(),r=e.models.axis(),i=e.models.legend(),s={top:30,right:90,bottom:50,left:90},o=e.utils.defaultColor(),u=null,a=null,f=!1,l=!0,c=!0,h=!1,p=!0,d=function(e,t,n,r,i){return"<h3>"+e+"</h3><p>"+n+" at "+t+"</p>"},v,m,g={},y=null,b="No Data Available.",w=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),E=250;n.orient("bottom").tickPadding(7),r.orient(h?"right":"left");var S=function(i,s){if(s){var o=d3.select(s).select("svg"),u=o.node()?o.attr("viewBox"):null;if(u){u=u.split(" ");var a=parseInt(o.style("width"))/u[2];i.pos[0]=i.pos[0]*a,i.pos[1]=i.pos[1]*a}}var f=i.pos[0]+(s.offsetLeft||0),l=i.pos[1]+(s.offsetTop||0),c=n.tickFormat()(t.x()(i.point,i.pointIndex)),h=r.tickFormat()(t.y()(i.point,i.pointIndex)),p=d(i.series.key,c,h,i,x);e.tooltip.show([f,l],p,null,null,s)};return t.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+s.left,e.pos[1]+s.top],w.tooltipShow(e)}),t.dispatch.on("elementMouseout.tooltip",function(e){w.tooltipHide(e)}),w.on("tooltipHide",function(){p&&e.tooltip.cleanup()}),x.dispatch=w,x.bars=t,x.legend=i,x.xAxis=n,x.yAxis=r,d3.rebind(x,t,"defined","isArea","x","y","size","xScale","yScale","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","id","interpolate","highlightPoint","clearHighlights","interactive"),x.options=e.utils.optionsFunc.bind(x),x.margin=function(e){return arguments.length?(s.top=typeof e.top!="undefined"?e.top:s.top,s.right=typeof e.right!="undefined"?e.right:s.right,s.bottom=typeof e.bottom!="undefined"?e.bottom:s.bottom,s.left=typeof e.left!="undefined"?e.left:s.left,x):s},x.width=function(e){return arguments.length?(u=e,x):u},x.height=function(e){return arguments.length?(a=e,x):a},x.color=function(t){return arguments.length?(o=e.utils.getColor(t),i.color(o),x):o},x.showLegend=function(e){return arguments.length?(f=e,x):f},x.showXAxis=function(e){return arguments.length?(l=e,x):l},x.showYAxis=function(e){return arguments.length?(c=e,x):c},x.rightAlignYAxis=function(e){return arguments.length?(h=e,r.orient(e?"right":"left"),x):h},x.tooltips=function(e){return arguments.length?(p=e,x):p},x.tooltipContent=function(e){return arguments.length?(d=e,x):d},x.state=function(e){return arguments.length?(g=e,x):g},x.defaultState=function(e){return arguments.length?(y=e,x):y},x.noData=function(e){return arguments.length?(b=e,x):b},x.transitionDuration=function(e){return arguments.length?(E=e,x):E},x},e.models.indentedTree=function(){function g(e){return e.each(function(e){function k(e,t,n){d3.event.stopPropagation();if(d3.event.shiftKey&&!n){return d3.event.shiftKey=!1,e.values&&e.values.forEach(function(e){(e.values||e._values)&&k(e,0,!0)}),!0}if(!O(e)){return !0}e.values?(e._values=e.values,e.values=null):(e.values=e._values,e._values=null),g.update()}function L(e){return e._values&&e._values.length?h:e.values&&e.values.length?p:""}function A(e){return e._values&&e._values.length}function O(e){var t=e.values||e._values;return t&&t.length}var t=1,n=d3.select(this),i=d3.layout.tree().children(function(e){return e.values}).size([r,f]);g.update=function(){n.transition().duration(600).call(g)},e[0]||(e[0]={key:a});var s=i.nodes(e[0]),y=d3.select(this).selectAll("div").data([[s]]),b=y.enter().append("div").attr("class","nvd3 nv-wrap nv-indentedtree"),w=b.append("table"),E=y.select("table").attr("width","100%").attr("class",c);if(o){var S=w.append("thead"),x=S.append("tr");l.forEach(function(e){x.append("th").attr("width",e.width?e.width:"10%").style("text-align",e.type=="numeric"?"right":"left").append("span").text(e.label)})}var T=E.selectAll("tbody").data(function(e){return e});T.enter().append("tbody"),t=d3.max(s,function(e){return e.depth}),i.size([r,t*f]);var N=T.selectAll("tr").data(function(e){return e.filter(function(e){return u&&!e.children?u(e):!0})},function(e,t){return e.id||e.id||++m});N.exit().remove(),N.select("img.nv-treeicon").attr("src",L).classed("folded",A);var C=N.enter().append("tr");l.forEach(function(e,t){var n=C.append("td").style("padding-left",function(e){return(t?0:e.depth*f+12+(L(e)?0:16))+"px"},"important").style("text-align",e.type=="numeric"?"right":"left");t==0&&n.append("img").classed("nv-treeicon",!0).classed("nv-folded",A).attr("src",L).style("width","14px").style("height","14px").style("padding","0 1px").style("display",function(e){return L(e)?"inline-block":"none"}).on("click",k),n.each(function(n){!t&&v(n)?d3.select(this).append("a").attr("href",v).attr("class",d3.functor(e.classes)).append("span"):d3.select(this).append("span"),d3.select(this).select("span").attr("class",d3.functor(e.classes)).text(function(t){return e.format?e.format(t):t[e.key]||"-"})}),e.showCount&&(n.append("span").attr("class","nv-childrenCount"),N.selectAll("span.nv-childrenCount").text(function(e){return e.values&&e.values.length||e._values&&e._values.length?"("+(e.values&&e.values.filter(function(e){return u?u(e):!0}).length||e._values&&e._values.filter(function(e){return u?u(e):!0}).length||0)+")":""}))}),N.order().on("click",function(e){d.elementClick({row:this,data:e,pos:[e.x,e.y]})}).on("dblclick",function(e){d.elementDblclick({row:this,data:e,pos:[e.x,e.y]})}).on("mouseover",function(e){d.elementMouseover({row:this,data:e,pos:[e.x,e.y]})}).on("mouseout",function(e){d.elementMouseout({row:this,data:e,pos:[e.x,e.y]})})}),g}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=e.utils.defaultColor(),s=Math.floor(Math.random()*10000),o=!0,u=!1,a="No Data Available.",f=20,l=[{key:"key",label:"Name",type:"text"}],c=null,h="images/grey-plus.png",p="images/grey-minus.png",d=d3.dispatch("elementClick","elementDblclick","elementMouseover","elementMouseout"),v=function(e){return e.url},m=0;return g.options=e.utils.optionsFunc.bind(g),g.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,g):t},g.width=function(e){return arguments.length?(n=e,g):n},g.height=function(e){return arguments.length?(r=e,g):r},g.color=function(t){return arguments.length?(i=e.utils.getColor(t),scatter.color(i),g):i},g.id=function(e){return arguments.length?(s=e,g):s},g.header=function(e){return arguments.length?(o=e,g):o},g.noData=function(e){return arguments.length?(a=e,g):a},g.filterZero=function(e){return arguments.length?(u=e,g):u},g.columns=function(e){return arguments.length?(l=e,g):l},g.tableClass=function(e){return arguments.length?(c=e,g):c},g.iconOpen=function(e){return arguments.length?(h=e,g):h},g.iconClose=function(e){return arguments.length?(p=e,g):p},g.getUrl=function(e){return arguments.length?(v=e,g):v},g},e.models.legend=function(){function c(h){return h.each(function(c){var h=n-t.left-t.right,p=d3.select(this),d=p.selectAll("g.nv-legend").data([c]),v=d.enter().append("g").attr("class","nvd3 nv-legend").append("g"),m=d.select("g");d.attr("transform","translate("+t.left+","+t.top+")");var g=m.selectAll(".nv-series").data(function(e){return e}),y=g.enter().append("g").attr("class","nv-series").on("mouseover",function(e,t){l.legendMouseover(e,t)}).on("mouseout",function(e,t){l.legendMouseout(e,t)}).on("click",function(e,t){l.legendClick(e,t),a&&(f?(c.forEach(function(e){e.disabled=!0}),e.disabled=!1):(e.disabled=!e.disabled,c.every(function(e){return e.disabled})&&c.forEach(function(e){e.disabled=!1})),l.stateChange({disabled:c.map(function(e){return !!e.disabled})}))}).on("dblclick",function(e,t){l.legendDblclick(e,t),a&&(c.forEach(function(e){e.disabled=!0}),e.disabled=!1,l.stateChange({disabled:c.map(function(e){return !!e.disabled})}))});y.append("circle").style("stroke-width",2).attr("class","nv-legend-symbol").attr("r",5),y.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dy",".32em").attr("dx","8"),g.classed("disabled",function(e){return e.disabled}),g.exit().remove(),g.select("circle").style("fill",function(e,t){return e.color||s(e,t)}).style("stroke",function(e,t){return e.color||s(e,t)}),g.select("text").text(i);if(o){var b=[];g.each(function(t,n){var r=d3.select(this).select("text"),i;try{i=r.node().getComputedTextLength()}catch(s){i=e.utils.calcApproxTextWidth(r)}b.push(i+28)});var w=0,E=0,S=[];while(E<h&&w<b.length){S[w]=b[w],E+=b[w++]}w===0&&(w=1);while(E>h&&w>1){S=[],w--;for(var x=0;x<b.length;x++){b[x]>(S[x%w]||0)&&(S[x%w]=b[x])}E=S.reduce(function(e,t,n,r){return e+t})}var T=[];for(var N=0,C=0;N<w;N++){T[N]=C,C+=S[N]}g.attr("transform",function(e,t){return"translate("+T[t%w]+","+(5+Math.floor(t/w)*20)+")"}),u?m.attr("transform","translate("+(n-t.right-E)+","+t.top+")"):m.attr("transform","translate(0,"+t.top+")"),r=t.top+t.bottom+Math.ceil(b.length/w)*20}else{var k=5,L=5,A=0,O;g.attr("transform",function(e,r){var i=d3.select(this).select("text").node().getComputedTextLength()+28;return O=L,n<t.left+t.right+O+i&&(L=O=5,k+=20),L+=i,L>A&&(A=L),"translate("+O+","+k+")"}),m.attr("transform","translate("+(n-t.right-A)+","+t.top+")"),r=t.top+t.bottom+k+15}}),c}var t={top:5,right:0,bottom:5,left:0},n=400,r=20,i=function(e){return e.key},s=e.utils.defaultColor(),o=!0,u=!0,a=!0,f=!1,l=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout","stateChange");return c.dispatch=l,c.options=e.utils.optionsFunc.bind(c),c.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,c):t},c.width=function(e){return arguments.length?(n=e,c):n},c.height=function(e){return arguments.length?(r=e,c):r},c.key=function(e){return arguments.length?(i=e,c):i},c.color=function(t){return arguments.length?(s=e.utils.getColor(t),c):s},c.align=function(e){return arguments.length?(o=e,c):o},c.rightAlign=function(e){return arguments.length?(u=e,c):u},c.updateState=function(e){return arguments.length?(a=e,c):a},c.radioButtonMode=function(e){return arguments.length?(f=e,c):f},c},e.models.line=function(){function m(g){return g.each(function(m){var g=r-n.left-n.right,b=i-n.top-n.bottom,w=d3.select(this);c=t.xScale(),h=t.yScale(),d=d||c,v=v||h;var E=w.selectAll("g.nv-wrap.nv-line").data([m]),S=E.enter().append("g").attr("class","nvd3 nv-wrap nv-line"),T=S.append("defs"),N=S.append("g"),C=E.select("g");N.append("g").attr("class","nv-groups"),N.append("g").attr("class","nv-scatterWrap"),E.attr("transform","translate("+n.left+","+n.top+")"),t.width(g).height(b);var k=E.select(".nv-scatterWrap");k.transition().call(t),T.append("clipPath").attr("id","nv-edge-clip-"+t.id()).append("rect"),E.select("#nv-edge-clip-"+t.id()+" rect").attr("width",g).attr("height",b),C.attr("clip-path",l?"url(#nv-edge-clip-"+t.id()+")":""),k.attr("clip-path",l?"url(#nv-edge-clip-"+t.id()+")":"");var L=E.select(".nv-groups").selectAll(".nv-group").data(function(e){return e},function(e){return e.key});L.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001),L.exit().transition().style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove(),L.attr("class",function(e,t){return"nv-group nv-series-"+t}).classed("hover",function(e){return e.hover}).style("fill",function(e,t){return s(e,t)}).style("stroke",function(e,t){return s(e,t)}),L.transition().style("stroke-opacity",1).style("fill-opacity",0.5);var A=L.selectAll("path.nv-area").data(function(e){return f(e)?[e]:[]});A.enter().append("path").attr("class","nv-area").attr("d",function(t){return d3.svg.area().interpolate(p).defined(a).x(function(t,n){return e.utils.NaNtoZero(d(o(t,n)))}).y0(function(t,n){return e.utils.NaNtoZero(v(u(t,n)))}).y1(function(e,t){return v(h.domain()[0]<=0?h.domain()[1]>=0?0:h.domain()[1]:h.domain()[0])}).apply(this,[t.values])}),L.exit().selectAll("path.nv-area").remove(),A.transition().attr("d",function(t){return d3.svg.area().interpolate(p).defined(a).x(function(t,n){return e.utils.NaNtoZero(c(o(t,n)))}).y0(function(t,n){return e.utils.NaNtoZero(h(u(t,n)))}).y1(function(e,t){return h(h.domain()[0]<=0?h.domain()[1]>=0?0:h.domain()[1]:h.domain()[0])}).apply(this,[t.values])});var O=L.selectAll("path.nv-line").data(function(e){return[e.values]});O.enter().append("path").attr("class","nv-line").attr("d",d3.svg.line().interpolate(p).defined(a).x(function(t,n){return e.utils.NaNtoZero(d(o(t,n)))}).y(function(t,n){return e.utils.NaNtoZero(v(u(t,n)))})),L.exit().selectAll("path.nv-line").transition().attr("d",d3.svg.line().interpolate(p).defined(a).x(function(t,n){return e.utils.NaNtoZero(c(o(t,n)))}).y(function(t,n){return e.utils.NaNtoZero(h(u(t,n)))})),O.transition().attr("d",d3.svg.line().interpolate(p).defined(a).x(function(t,n){return e.utils.NaNtoZero(c(o(t,n)))}).y(function(t,n){return e.utils.NaNtoZero(h(u(t,n)))})),d=c.copy(),v=h.copy()}),m}var t=e.models.scatter(),n={top:0,right:0,bottom:0,left:0},r=960,i=500,s=e.utils.defaultColor(),o=function(e){return e.x},u=function(e){return e.y},a=function(e,t){return !isNaN(u(e,t))&&u(e,t)!==null},f=function(e){return e.area},l=!1,c,h,p="linear";t.size(16).sizeDomain([16,256]);var d,v;return m.dispatch=t.dispatch,m.scatter=t,d3.rebind(m,t,"id","interactive","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","forceX","forceY","forceSize","clipVoronoi","useVoronoi","clipRadius","padData","highlightPoint","clearHighlights"),m.options=e.utils.optionsFunc.bind(m),m.margin=function(e){return arguments.length?(n.top=typeof e.top!="undefined"?e.top:n.top,n.right=typeof e.right!="undefined"?e.right:n.right,n.bottom=typeof e.bottom!="undefined"?e.bottom:n.bottom,n.left=typeof e.left!="undefined"?e.left:n.left,m):n},m.width=function(e){return arguments.length?(r=e,m):r},m.height=function(e){return arguments.length?(i=e,m):i},m.x=function(e){return arguments.length?(o=e,t.x(e),m):o},m.y=function(e){return arguments.length?(u=e,t.y(e),m):u},m.clipEdge=function(e){return arguments.length?(l=e,m):l},m.color=function(n){return arguments.length?(s=e.utils.getColor(n),t.color(s),m):s},m.interpolate=function(e){return arguments.length?(p=e,m):p},m.defined=function(e){return arguments.length?(a=e,m):a},m.isArea=function(e){return arguments.length?(f=d3.functor(e),m):f},m},e.models.lineChart=function(){function N(m){return m.each(function(m){var C=d3.select(this),k=this,L=(a||parseInt(C.style("width"))||960)-o.left-o.right,A=(f||parseInt(C.style("height"))||400)-o.top-o.bottom;N.update=function(){C.transition().duration(x).call(N)},N.container=this,b.disabled=m.map(function(e){return !!e.disabled});if(!w){var O;w={};for(O in b){b[O] instanceof Array?w[O]=b[O].slice(0):w[O]=b[O]}}if(!m||!m.length||!m.filter(function(e){return e.values.length}).length){var M=C.selectAll(".nv-noData").data([E]);return M.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),M.attr("x",o.left+L/2).attr("y",o.top+A/2).text(function(e){return e}),N}C.selectAll(".nv-noData").remove(),g=t.xScale(),y=t.yScale();var _=C.selectAll("g.nv-wrap.nv-lineChart").data([m]),D=_.enter().append("g").attr("class","nvd3 nv-wrap nv-lineChart").append("g"),P=_.select("g");D.append("rect").style("opacity",0),D.append("g").attr("class","nv-x nv-axis"),D.append("g").attr("class","nv-y nv-axis"),D.append("g").attr("class","nv-linesWrap"),D.append("g").attr("class","nv-legendWrap"),D.append("g").attr("class","nv-interactive"),P.select("rect").attr("width",L).attr("height",A),l&&(i.width(L),P.select(".nv-legendWrap").datum(m).call(i),o.top!=i.height()&&(o.top=i.height(),A=(f||parseInt(C.style("height"))||400)-o.top-o.bottom),_.select(".nv-legendWrap").attr("transform","translate(0,"+-o.top+")")),_.attr("transform","translate("+o.left+","+o.top+")"),p&&P.select(".nv-y.nv-axis").attr("transform","translate("+L+",0)"),d&&(s.width(L).height(A).margin({left:o.left,top:o.top}).svgContainer(C).xScale(g),_.select(".nv-interactive").call(s)),t.width(L).height(A).color(m.map(function(e,t){return e.color||u(e,t)}).filter(function(e,t){return !m[t].disabled}));var H=P.select(".nv-linesWrap").datum(m.filter(function(e){return !e.disabled}));H.transition().call(t),c&&(n.scale(g).ticks(L/100).tickSize(-A,0),P.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")"),P.select(".nv-x.nv-axis").transition().call(n)),h&&(r.scale(y).ticks(A/36).tickSize(-L,0),P.select(".nv-y.nv-axis").transition().call(r)),i.dispatch.on("stateChange",function(e){b=e,S.stateChange(b),N.update()}),s.dispatch.on("elementMousemove",function(i){t.clearHighlights();var a,f,l,c=[];m.filter(function(e,t){return e.seriesIndex=t,!e.disabled}).forEach(function(n,r){f=e.interactiveBisect(n.values,i.pointXValue,N.x()),t.highlightPoint(r,f,!0);var s=n.values[f];if(typeof s=="undefined"){return}typeof a=="undefined"&&(a=s),typeof l=="undefined"&&(l=N.xScale()(N.x()(s,f))),c.push({key:n.key,value:N.y()(s,f),color:u(n,n.seriesIndex)})});if(c.length>2){var h=N.yScale().invert(i.mouseY),p=Math.abs(N.yScale().domain()[0]-N.yScale().domain()[1]),d=0.03*p,g=e.nearestValueIndex(c.map(function(e){return e.value}),h,d);g!==null&&(c[g].highlight=!0)}var y=n.tickFormat()(N.x()(a,f));s.tooltip.position({left:l+o.left,top:i.mouseY+o.top}).chartContainer(k.parentNode).enabled(v).valueFormatter(function(e,t){return r.tickFormat()(e)}).data({value:y,series:c})(),s.renderGuideLine(l)}),s.dispatch.on("elementMouseout",function(e){S.tooltipHide(),t.clearHighlights()}),S.on("tooltipShow",function(e){v&&T(e,k.parentNode)}),S.on("changeState",function(e){typeof e.disabled!="undefined"&&(m.forEach(function(t,n){t.disabled=e.disabled[n]}),b.disabled=e.disabled),N.update()})}),N}var t=e.models.line(),n=e.models.axis(),r=e.models.axis(),i=e.models.legend(),s=e.interactiveGuideline(),o={top:30,right:20,bottom:50,left:60},u=e.utils.defaultColor(),a=null,f=null,l=!0,c=!0,h=!0,p=!1,d=!1,v=!0,m=function(e,t,n,r,i){return"<h3>"+e+"</h3><p>"+n+" at "+t+"</p>"},g,y,b={},w=null,E="No Data Available.",S=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),x=250;n.orient("bottom").tickPadding(7),r.orient(p?"right":"left");var T=function(i,s){var o=i.pos[0]+(s.offsetLeft||0),u=i.pos[1]+(s.offsetTop||0),a=n.tickFormat()(t.x()(i.point,i.pointIndex)),f=r.tickFormat()(t.y()(i.point,i.pointIndex)),l=m(i.series.key,a,f,i,N);e.tooltip.show([o,u],l,null,null,s)};return t.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+o.left,e.pos[1]+o.top],S.tooltipShow(e)}),t.dispatch.on("elementMouseout.tooltip",function(e){S.tooltipHide(e)}),S.on("tooltipHide",function(){v&&e.tooltip.cleanup()}),N.dispatch=S,N.lines=t,N.legend=i,N.xAxis=n,N.yAxis=r,N.interactiveLayer=s,d3.rebind(N,t,"defined","isArea","x","y","size","xScale","yScale","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","useVoronoi","id","interpolate"),N.options=e.utils.optionsFunc.bind(N),N.margin=function(e){return arguments.length?(o.top=typeof e.top!="undefined"?e.top:o.top,o.right=typeof e.right!="undefined"?e.right:o.right,o.bottom=typeof e.bottom!="undefined"?e.bottom:o.bottom,o.left=typeof e.left!="undefined"?e.left:o.left,N):o},N.width=function(e){return arguments.length?(a=e,N):a},N.height=function(e){return arguments.length?(f=e,N):f},N.color=function(t){return arguments.length?(u=e.utils.getColor(t),i.color(u),N):u},N.showLegend=function(e){return arguments.length?(l=e,N):l},N.showXAxis=function(e){return arguments.length?(c=e,N):c},N.showYAxis=function(e){return arguments.length?(h=e,N):h},N.rightAlignYAxis=function(e){return arguments.length?(p=e,r.orient(e?"right":"left"),N):p},N.useInteractiveGuideline=function(e){return arguments.length?(d=e,e===!0&&(N.interactive(!1),N.useVoronoi(!1)),N):d},N.tooltips=function(e){return arguments.length?(v=e,N):v},N.tooltipContent=function(e){return arguments.length?(m=e,N):m},N.state=function(e){return arguments.length?(b=e,N):b},N.defaultState=function(e){return arguments.length?(w=e,N):w},N.noData=function(e){return arguments.length?(E=e,N):E},N.transitionDuration=function(e){return arguments.length?(x=e,N):x},N},e.models.linePlusBarChart=function(){function T(e){return e.each(function(e){var l=d3.select(this),c=this,v=(a||parseInt(l.style("width"))||960)-u.left-u.right,N=(f||parseInt(l.style("height"))||400)-u.top-u.bottom;T.update=function(){l.transition().call(T)},b.disabled=e.map(function(e){return !!e.disabled});if(!w){var C;w={};for(C in b){b[C] instanceof Array?w[C]=b[C].slice(0):w[C]=b[C]}}if(!e||!e.length||!e.filter(function(e){return e.values.length}).length){var k=l.selectAll(".nv-noData").data([E]);return k.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),k.attr("x",u.left+v/2).attr("y",u.top+N/2).text(function(e){return e}),T}l.selectAll(".nv-noData").remove();var L=e.filter(function(e){return !e.disabled&&e.bar}),A=e.filter(function(e){return !e.bar});m=A.filter(function(e){return !e.disabled}).length&&A.filter(function(e){return !e.disabled})[0].values.length?t.xScale():n.xScale(),g=n.yScale(),y=t.yScale();var O=d3.select(this).selectAll("g.nv-wrap.nv-linePlusBar").data([e]),M=O.enter().append("g").attr("class","nvd3 nv-wrap nv-linePlusBar").append("g"),_=O.select("g");M.append("g").attr("class","nv-x nv-axis"),M.append("g").attr("class","nv-y1 nv-axis"),M.append("g").attr("class","nv-y2 nv-axis"),M.append("g").attr("class","nv-barsWrap"),M.append("g").attr("class","nv-linesWrap"),M.append("g").attr("class","nv-legendWrap"),p&&(o.width(v/2),_.select(".nv-legendWrap").datum(e.map(function(e){return e.originalKey=e.originalKey===undefined?e.key:e.originalKey,e.key=e.originalKey+(e.bar?" (left axis)":" (right axis)"),e})).call(o),u.top!=o.height()&&(u.top=o.height(),N=(f||parseInt(l.style("height"))||400)-u.top-u.bottom),_.select(".nv-legendWrap").attr("transform","translate("+v/2+","+-u.top+")")),O.attr("transform","translate("+u.left+","+u.top+")"),t.width(v).height(N).color(e.map(function(e,t){return e.color||h(e,t)}).filter(function(t,n){return !e[n].disabled&&!e[n].bar})),n.width(v).height(N).color(e.map(function(e,t){return e.color||h(e,t)}).filter(function(t,n){return !e[n].disabled&&e[n].bar}));var D=_.select(".nv-barsWrap").datum(L.length?L:[{values:[]}]),P=_.select(".nv-linesWrap").datum(A[0]&&!A[0].disabled?A:[{values:[]}]);d3.transition(D).call(n),d3.transition(P).call(t),r.scale(m).ticks(v/100).tickSize(-N,0),_.select(".nv-x.nv-axis").attr("transform","translate(0,"+g.range()[0]+")"),d3.transition(_.select(".nv-x.nv-axis")).call(r),i.scale(g).ticks(N/36).tickSize(-v,0),d3.transition(_.select(".nv-y1.nv-axis")).style("opacity",L.length?1:0).call(i),s.scale(y).ticks(N/36).tickSize(L.length?0:-v,0),_.select(".nv-y2.nv-axis").style("opacity",A.length?1:0).attr("transform","translate("+v+",0)"),d3.transition(_.select(".nv-y2.nv-axis")).call(s),o.dispatch.on("stateChange",function(e){b=e,S.stateChange(b),T.update()}),S.on("tooltipShow",function(e){d&&x(e,c.parentNode)}),S.on("changeState",function(t){typeof t.disabled!="undefined"&&(e.forEach(function(e,n){e.disabled=t.disabled[n]}),b.disabled=t.disabled),T.update()})}),T}var t=e.models.line(),n=e.models.historicalBar(),r=e.models.axis(),i=e.models.axis(),s=e.models.axis(),o=e.models.legend(),u={top:30,right:60,bottom:50,left:60},a=null,f=null,l=function(e){return e.x},c=function(e){return e.y},h=e.utils.defaultColor(),p=!0,d=!0,v=function(e,t,n,r,i){return"<h3>"+e+"</h3><p>"+n+" at "+t+"</p>"},m,g,y,b={},w=null,E="No Data Available.",S=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState");n.padData(!0),t.clipEdge(!1).padData(!0),r.orient("bottom").tickPadding(7).highlightZero(!1),i.orient("left"),s.orient("right");var x=function(n,o){var u=n.pos[0]+(o.offsetLeft||0),a=n.pos[1]+(o.offsetTop||0),f=r.tickFormat()(t.x()(n.point,n.pointIndex)),l=(n.series.bar?i:s).tickFormat()(t.y()(n.point,n.pointIndex)),c=v(n.series.key,f,l,n,T);e.tooltip.show([u,a],c,n.value<0?"n":"s",null,o)};return t.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+u.left,e.pos[1]+u.top],S.tooltipShow(e)}),t.dispatch.on("elementMouseout.tooltip",function(e){S.tooltipHide(e)}),n.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+u.left,e.pos[1]+u.top],S.tooltipShow(e)}),n.dispatch.on("elementMouseout.tooltip",function(e){S.tooltipHide(e)}),S.on("tooltipHide",function(){d&&e.tooltip.cleanup()}),T.dispatch=S,T.legend=o,T.lines=t,T.bars=n,T.xAxis=r,T.y1Axis=i,T.y2Axis=s,d3.rebind(T,t,"defined","size","clipVoronoi","interpolate"),T.options=e.utils.optionsFunc.bind(T),T.x=function(e){return arguments.length?(l=e,t.x(e),n.x(e),T):l},T.y=function(e){return arguments.length?(c=e,t.y(e),n.y(e),T):c},T.margin=function(e){return arguments.length?(u.top=typeof e.top!="undefined"?e.top:u.top,u.right=typeof e.right!="undefined"?e.right:u.right,u.bottom=typeof e.bottom!="undefined"?e.bottom:u.bottom,u.left=typeof e.left!="undefined"?e.left:u.left,T):u},T.width=function(e){return arguments.length?(a=e,T):a},T.height=function(e){return arguments.length?(f=e,T):f},T.color=function(t){return arguments.length?(h=e.utils.getColor(t),o.color(h),T):h},T.showLegend=function(e){return arguments.length?(p=e,T):p},T.tooltips=function(e){return arguments.length?(d=e,T):d},T.tooltipContent=function(e){return arguments.length?(v=e,T):v},T.state=function(e){return arguments.length?(b=e,T):b},T.defaultState=function(e){return arguments.length?(w=e,T):w},T.noData=function(e){return arguments.length?(E=e,T):E},T},e.models.lineWithFocusChart=function(){function k(e){return e.each(function(e){function U(e){var t=+(e=="e"),n=t?1:-1,r=M/3;return"M"+0.5*n+","+r+"A6,6 0 0 "+t+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+t+" "+0.5*n+","+2*r+"ZM"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)}function z(){a.empty()||a.extent(w),I.data([a.empty()?g.domain():w]).each(function(e,t){var n=g(e[0])-v.range()[0],r=v.range()[1]-g(e[1]);d3.select(this).select(".left").attr("width",n<0?0:n),d3.select(this).select(".right").attr("x",g(e[1])).attr("width",r<0?0:r)})}function W(){w=a.empty()?null:a.extent();var n=a.empty()?g.domain():a.extent();if(Math.abs(n[0]-n[1])<=1){return}T.brush({extent:n,brush:a}),z();var s=H.select(".nv-focus .nv-linesWrap").datum(e.filter(function(e){return !e.disabled}).map(function(e,r){return{key:e.key,values:e.values.filter(function(e,r){return t.x()(e,r)>=n[0]&&t.x()(e,r)<=n[1]})}}));s.transition().duration(N).call(t),H.select(".nv-focus .nv-x.nv-axis").transition().duration(N).call(r),H.select(".nv-focus .nv-y.nv-axis").transition().duration(N).call(i)}var S=d3.select(this),L=this,A=(h||parseInt(S.style("width"))||960)-f.left-f.right,O=(p||parseInt(S.style("height"))||400)-f.top-f.bottom-d,M=d-l.top-l.bottom;k.update=function(){S.transition().duration(N).call(k)},k.container=this;if(!e||!e.length||!e.filter(function(e){return e.values.length}).length){var _=S.selectAll(".nv-noData").data([x]);return _.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),_.attr("x",f.left+A/2).attr("y",f.top+O/2).text(function(e){return e}),k}S.selectAll(".nv-noData").remove(),v=t.xScale(),m=t.yScale(),g=n.xScale(),y=n.yScale();var D=S.selectAll("g.nv-wrap.nv-lineWithFocusChart").data([e]),P=D.enter().append("g").attr("class","nvd3 nv-wrap nv-lineWithFocusChart").append("g"),H=D.select("g");P.append("g").attr("class","nv-legendWrap");var B=P.append("g").attr("class","nv-focus");B.append("g").attr("class","nv-x nv-axis"),B.append("g").attr("class","nv-y nv-axis"),B.append("g").attr("class","nv-linesWrap");var j=P.append("g").attr("class","nv-context");j.append("g").attr("class","nv-x nv-axis"),j.append("g").attr("class","nv-y nv-axis"),j.append("g").attr("class","nv-linesWrap"),j.append("g").attr("class","nv-brushBackground"),j.append("g").attr("class","nv-x nv-brush"),b&&(u.width(A),H.select(".nv-legendWrap").datum(e).call(u),f.top!=u.height()&&(f.top=u.height(),O=(p||parseInt(S.style("height"))||400)-f.top-f.bottom-d),H.select(".nv-legendWrap").attr("transform","translate(0,"+-f.top+")")),D.attr("transform","translate("+f.left+","+f.top+")"),t.width(A).height(O).color(e.map(function(e,t){return e.color||c(e,t)}).filter(function(t,n){return !e[n].disabled})),n.defined(t.defined()).width(A).height(M).color(e.map(function(e,t){return e.color||c(e,t)}).filter(function(t,n){return !e[n].disabled})),H.select(".nv-context").attr("transform","translate(0,"+(O+f.bottom+l.top)+")");var F=H.select(".nv-context .nv-linesWrap").datum(e.filter(function(e){return !e.disabled}));d3.transition(F).call(n),r.scale(v).ticks(A/100).tickSize(-O,0),i.scale(m).ticks(O/36).tickSize(-A,0),H.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+O+")"),a.x(g).on("brush",function(){var e=k.transitionDuration();k.transitionDuration(0),W(),k.transitionDuration(e)}),w&&a.extent(w);var I=H.select(".nv-brushBackground").selectAll("g").data([w||a.extent()]),q=I.enter().append("g");q.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",M),q.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",M);var R=H.select(".nv-x.nv-brush").call(a);R.selectAll("rect").attr("height",M),R.selectAll(".resize").append("path").attr("d",U),W(),s.scale(g).ticks(A/100).tickSize(-M,0),H.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")"),d3.transition(H.select(".nv-context .nv-x.nv-axis")).call(s),o.scale(y).ticks(M/36).tickSize(-A,0),d3.transition(H.select(".nv-context .nv-y.nv-axis")).call(o),H.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")"),u.dispatch.on("stateChange",function(e){k.update()}),T.on("tooltipShow",function(e){E&&C(e,L.parentNode)})}),k}var t=e.models.line(),n=e.models.line(),r=e.models.axis(),i=e.models.axis(),s=e.models.axis(),o=e.models.axis(),u=e.models.legend(),a=d3.svg.brush(),f={top:30,right:30,bottom:30,left:60},l={top:0,right:30,bottom:20,left:60},c=e.utils.defaultColor(),h=null,p=null,d=100,v,m,g,y,b=!0,w=null,E=!0,S=function(e,t,n,r,i){return"<h3>"+e+"</h3><p>"+n+" at "+t+"</p>"},x="No Data Available.",T=d3.dispatch("tooltipShow","tooltipHide","brush"),N=250;t.clipEdge(!0),n.interactive(!1),r.orient("bottom").tickPadding(5),i.orient("left"),s.orient("bottom").tickPadding(5),o.orient("left");var C=function(n,s){var o=n.pos[0]+(s.offsetLeft||0),u=n.pos[1]+(s.offsetTop||0),a=r.tickFormat()(t.x()(n.point,n.pointIndex)),f=i.tickFormat()(t.y()(n.point,n.pointIndex)),l=S(n.series.key,a,f,n,k);e.tooltip.show([o,u],l,null,null,s)};return t.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+f.left,e.pos[1]+f.top],T.tooltipShow(e)}),t.dispatch.on("elementMouseout.tooltip",function(e){T.tooltipHide(e)}),T.on("tooltipHide",function(){E&&e.tooltip.cleanup()}),k.dispatch=T,k.legend=u,k.lines=t,k.lines2=n,k.xAxis=r,k.yAxis=i,k.x2Axis=s,k.y2Axis=o,d3.rebind(k,t,"defined","isArea","size","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","id"),k.options=e.utils.optionsFunc.bind(k),k.x=function(e){return arguments.length?(t.x(e),n.x(e),k):t.x},k.y=function(e){return arguments.length?(t.y(e),n.y(e),k):t.y},k.margin=function(e){return arguments.length?(f.top=typeof e.top!="undefined"?e.top:f.top,f.right=typeof e.right!="undefined"?e.right:f.right,f.bottom=typeof e.bottom!="undefined"?e.bottom:f.bottom,f.left=typeof e.left!="undefined"?e.left:f.left,k):f},k.margin2=function(e){return arguments.length?(l=e,k):l},k.width=function(e){return arguments.length?(h=e,k):h},k.height=function(e){return arguments.length?(p=e,k):p},k.height2=function(e){return arguments.length?(d=e,k):d},k.color=function(t){return arguments.length?(c=e.utils.getColor(t),u.color(c),k):c},k.showLegend=function(e){return arguments.length?(b=e,k):b},k.tooltips=function(e){return arguments.length?(E=e,k):E},k.tooltipContent=function(e){return arguments.length?(S=e,k):S},k.interpolate=function(e){return arguments.length?(t.interpolate(e),n.interpolate(e),k):t.interpolate()},k.noData=function(e){return arguments.length?(x=e,k):x},k.xTickFormat=function(e){return arguments.length?(r.tickFormat(e),s.tickFormat(e),k):r.tickFormat()},k.yTickFormat=function(e){return arguments.length?(i.tickFormat(e),o.tickFormat(e),k):i.tickFormat()},k.brushExtent=function(e){return arguments.length?(w=e,k):w},k.transitionDuration=function(e){return arguments.length?(N=e,k):N},k},e.models.linePlusBarWithFocusChart=function(){function B(e){return e.each(function(e){function nt(e){var t=+(e=="e"),n=t?1:-1,r=q/3;return"M"+0.5*n+","+r+"A6,6 0 0 "+t+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+t+" "+0.5*n+","+2*r+"ZM"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)}function rt(){h.empty()||h.extent(x),Z.data([h.empty()?k.domain():x]).each(function(e,t){var n=k(e[0])-k.range()[0],r=k.range()[1]-k(e[1]);d3.select(this).select(".left").attr("width",n<0?0:n),d3.select(this).select(".right").attr("x",k(e[1])).attr("width",r<0?0:r)})}function it(){x=h.empty()?null:h.extent(),S=h.empty()?k.domain():h.extent(),D.brush({extent:S,brush:h}),rt(),r.width(F).height(I).color(e.map(function(e,t){return e.color||w(e,t)}).filter(function(t,n){return !e[n].disabled&&e[n].bar})),t.width(F).height(I).color(e.map(function(e,t){return e.color||w(e,t)}).filter(function(t,n){return !e[n].disabled&&!e[n].bar}));var n=J.select(".nv-focus .nv-barsWrap").datum(U.length?U.map(function(e,t){return{key:e.key,values:e.values.filter(function(e,t){return r.x()(e,t)>=S[0]&&r.x()(e,t)<=S[1]})}}):[{values:[]}]),i=J.select(".nv-focus .nv-linesWrap").datum(z[0].disabled?[{values:[]}]:z.map(function(e,n){return{key:e.key,values:e.values.filter(function(e,n){return t.x()(e,n)>=S[0]&&t.x()(e,n)<=S[1]})}}));U.length?C=r.xScale():C=t.xScale(),s.scale(C).ticks(F/100).tickSize(-I,0),s.domain([Math.ceil(S[0]),Math.floor(S[1])]),J.select(".nv-x.nv-axis").transition().duration(P).call(s),n.transition().duration(P).call(r),i.transition().duration(P).call(t),J.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+L.range()[0]+")"),u.scale(L).ticks(I/36).tickSize(-F,0),J.select(".nv-focus .nv-y1.nv-axis").style("opacity",U.length?1:0),a.scale(A).ticks(I/36).tickSize(U.length?0:-F,0),J.select(".nv-focus .nv-y2.nv-axis").style("opacity",z.length?1:0).attr("transform","translate("+C.range()[1]+",0)"),J.select(".nv-focus .nv-y1.nv-axis").transition().duration(P).call(u),J.select(".nv-focus .nv-y2.nv-axis").transition().duration(P).call(a)}var N=d3.select(this),j=this,F=(v||parseInt(N.style("width"))||960)-p.left-p.right,I=(m||parseInt(N.style("height"))||400)-p.top-p.bottom-g,q=g-d.top-d.bottom;B.update=function(){N.transition().duration(P).call(B)},B.container=this;if(!e||!e.length||!e.filter(function(e){return e.values.length}).length){var R=N.selectAll(".nv-noData").data([_]);return R.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),R.attr("x",p.left+F/2).attr("y",p.top+I/2).text(function(e){return e}),B}N.selectAll(".nv-noData").remove();var U=e.filter(function(e){return !e.disabled&&e.bar}),z=e.filter(function(e){return !e.bar});C=r.xScale(),k=o.scale(),L=r.yScale(),A=t.yScale(),O=i.yScale(),M=n.yScale();var W=e.filter(function(e){return !e.disabled&&e.bar}).map(function(e){return e.values.map(function(e,t){return{x:y(e,t),y:b(e,t)}})}),X=e.filter(function(e){return !e.disabled&&!e.bar}).map(function(e){return e.values.map(function(e,t){return{x:y(e,t),y:b(e,t)}})});C.range([0,F]),k.domain(d3.extent(d3.merge(W.concat(X)),function(e){return e.x})).range([0,F]);var V=N.selectAll("g.nv-wrap.nv-linePlusBar").data([e]),$=V.enter().append("g").attr("class","nvd3 nv-wrap nv-linePlusBar").append("g"),J=V.select("g");$.append("g").attr("class","nv-legendWrap");var K=$.append("g").attr("class","nv-focus");K.append("g").attr("class","nv-x nv-axis"),K.append("g").attr("class","nv-y1 nv-axis"),K.append("g").attr("class","nv-y2 nv-axis"),K.append("g").attr("class","nv-barsWrap"),K.append("g").attr("class","nv-linesWrap");var Q=$.append("g").attr("class","nv-context");Q.append("g").attr("class","nv-x nv-axis"),Q.append("g").attr("class","nv-y1 nv-axis"),Q.append("g").attr("class","nv-y2 nv-axis"),Q.append("g").attr("class","nv-barsWrap"),Q.append("g").attr("class","nv-linesWrap"),Q.append("g").attr("class","nv-brushBackground"),Q.append("g").attr("class","nv-x nv-brush"),E&&(c.width(F/2),J.select(".nv-legendWrap").datum(e.map(function(e){return e.originalKey=e.originalKey===undefined?e.key:e.originalKey,e.key=e.originalKey+(e.bar?" (left axis)":" (right axis)"),e})).call(c),p.top!=c.height()&&(p.top=c.height(),I=(m||parseInt(N.style("height"))||400)-p.top-p.bottom-g),J.select(".nv-legendWrap").attr("transform","translate("+F/2+","+-p.top+")")),V.attr("transform","translate("+p.left+","+p.top+")"),i.width(F).height(q).color(e.map(function(e,t){return e.color||w(e,t)}).filter(function(t,n){return !e[n].disabled&&e[n].bar})),n.width(F).height(q).color(e.map(function(e,t){return e.color||w(e,t)}).filter(function(t,n){return !e[n].disabled&&!e[n].bar}));var G=J.select(".nv-context .nv-barsWrap").datum(U.length?U:[{values:[]}]),Y=J.select(".nv-context .nv-linesWrap").datum(z[0].disabled?[{values:[]}]:z);J.select(".nv-context").attr("transform","translate(0,"+(I+p.bottom+d.top)+")"),G.transition().call(i),Y.transition().call(n),h.x(k).on("brush",it),x&&h.extent(x);var Z=J.select(".nv-brushBackground").selectAll("g").data([x||h.extent()]),et=Z.enter().append("g");et.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",q),et.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",q);var tt=J.select(".nv-x.nv-brush").call(h);tt.selectAll("rect").attr("height",q),tt.selectAll(".resize").append("path").attr("d",nt),o.ticks(F/100).tickSize(-q,0),J.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+O.range()[0]+")"),J.select(".nv-context .nv-x.nv-axis").transition().call(o),f.scale(O).ticks(q/36).tickSize(-F,0),J.select(".nv-context .nv-y1.nv-axis").style("opacity",U.length?1:0).attr("transform","translate(0,"+k.range()[0]+")"),J.select(".nv-context .nv-y1.nv-axis").transition().call(f),l.scale(M).ticks(q/36).tickSize(U.length?0:-F,0),J.select(".nv-context .nv-y2.nv-axis").style("opacity",z.length?1:0).attr("transform","translate("+k.range()[1]+",0)"),J.select(".nv-context .nv-y2.nv-axis").transition().call(l),c.dispatch.on("stateChange",function(e){B.update()}),D.on("tooltipShow",function(e){T&&H(e,j.parentNode)}),it()}),B}var t=e.models.line(),n=e.models.line(),r=e.models.historicalBar(),i=e.models.historicalBar(),s=e.models.axis(),o=e.models.axis(),u=e.models.axis(),a=e.models.axis(),f=e.models.axis(),l=e.models.axis(),c=e.models.legend(),h=d3.svg.brush(),p={top:30,right:30,bottom:30,left:60},d={top:0,right:30,bottom:20,left:60},v=null,m=null,g=100,y=function(e){return e.x},b=function(e){return e.y},w=e.utils.defaultColor(),E=!0,S,x=null,T=!0,N=function(e,t,n,r,i){return"<h3>"+e+"</h3><p>"+n+" at "+t+"</p>"},C,k,L,A,O,M,_="No Data Available.",D=d3.dispatch("tooltipShow","tooltipHide","brush"),P=0;t.clipEdge(!0),n.interactive(!1),s.orient("bottom").tickPadding(5),u.orient("left"),a.orient("right"),o.orient("bottom").tickPadding(5),f.orient("left"),l.orient("right");var H=function(n,r){S&&(n.pointIndex+=Math.ceil(S[0]));var i=n.pos[0]+(r.offsetLeft||0),o=n.pos[1]+(r.offsetTop||0),f=s.tickFormat()(t.x()(n.point,n.pointIndex)),l=(n.series.bar?u:a).tickFormat()(t.y()(n.point,n.pointIndex)),c=N(n.series.key,f,l,n,B);e.tooltip.show([i,o],c,n.value<0?"n":"s",null,r)};return t.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+p.left,e.pos[1]+p.top],D.tooltipShow(e)}),t.dispatch.on("elementMouseout.tooltip",function(e){D.tooltipHide(e)}),r.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+p.left,e.pos[1]+p.top],D.tooltipShow(e)}),r.dispatch.on("elementMouseout.tooltip",function(e){D.tooltipHide(e)}),D.on("tooltipHide",function(){T&&e.tooltip.cleanup()}),B.dispatch=D,B.legend=c,B.lines=t,B.lines2=n,B.bars=r,B.bars2=i,B.xAxis=s,B.x2Axis=o,B.y1Axis=u,B.y2Axis=a,B.y3Axis=f,B.y4Axis=l,d3.rebind(B,t,"defined","size","clipVoronoi","interpolate"),B.options=e.utils.optionsFunc.bind(B),B.x=function(e){return arguments.length?(y=e,t.x(e),r.x(e),B):y},B.y=function(e){return arguments.length?(b=e,t.y(e),r.y(e),B):b},B.margin=function(e){return arguments.length?(p.top=typeof e.top!="undefined"?e.top:p.top,p.right=typeof e.right!="undefined"?e.right:p.right,p.bottom=typeof e.bottom!="undefined"?e.bottom:p.bottom,p.left=typeof e.left!="undefined"?e.left:p.left,B):p},B.width=function(e){return arguments.length?(v=e,B):v},B.height=function(e){return arguments.length?(m=e,B):m},B.color=function(t){return arguments.length?(w=e.utils.getColor(t),c.color(w),B):w},B.showLegend=function(e){return arguments.length?(E=e,B):E},B.tooltips=function(e){return arguments.length?(T=e,B):T},B.tooltipContent=function(e){return arguments.length?(N=e,B):N},B.noData=function(e){return arguments.length?(_=e,B):_},B.brushExtent=function(e){return arguments.length?(x=e,B):x},B},e.models.multiBar=function(){function C(e){return e.each(function(e){var C=n-t.left-t.right,k=r-t.top-t.bottom,L=d3.select(this);d&&e.length&&(d=[{values:e[0].values.map(function(e){return{x:e.x,y:0,series:e.series,size:0.01}})}]),c&&(e=d3.layout.stack().offset(h).values(function(e){return e.values}).y(a)(!e.length&&d?d:e)),e=e.map(function(e,t){return e.values=e.values.map(function(e){return e.series=t,e}),e}),c&&e[0].values.map(function(t,n){var r=0,i=0;e.map(function(e){var t=e.values[n];t.size=Math.abs(t.y),t.y<0?(t.y1=i,i-=t.size):(t.y1=t.size+r,r+=t.size)})});var A=y&&b?[]:e.map(function(e){return e.values.map(function(e,t){return{x:u(e,t),y:a(e,t),y0:e.y0,y1:e.y1}})});i.domain(y||d3.merge(A).map(function(e){return e.x})).rangeBands(w||[0,C],S),s.domain(b||d3.extent(d3.merge(A).map(function(e){return c?e.y>0?e.y1:e.y1+e.y:e.y}).concat(f))).range(E||[k,0]),i.domain()[0]===i.domain()[1]&&(i.domain()[0]?i.domain([i.domain()[0]-i.domain()[0]*0.01,i.domain()[1]+i.domain()[1]*0.01]):i.domain([-1,1])),s.domain()[0]===s.domain()[1]&&(s.domain()[0]?s.domain([s.domain()[0]+s.domain()[0]*0.01,s.domain()[1]-s.domain()[1]*0.01]):s.domain([-1,1])),T=T||i,N=N||s;var O=L.selectAll("g.nv-wrap.nv-multibar").data([e]),M=O.enter().append("g").attr("class","nvd3 nv-wrap nv-multibar"),_=M.append("defs"),D=M.append("g"),P=O.select("g");D.append("g").attr("class","nv-groups"),O.attr("transform","translate("+t.left+","+t.top+")"),_.append("clipPath").attr("id","nv-edge-clip-"+o).append("rect"),O.select("#nv-edge-clip-"+o+" rect").attr("width",C).attr("height",k),P.attr("clip-path",l?"url(#nv-edge-clip-"+o+")":"");var H=O.select(".nv-groups").selectAll(".nv-group").data(function(e){return e},function(e,t){return t});H.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001),H.exit().transition().selectAll("rect.nv-bar").delay(function(t,n){return n*g/e[0].values.length}).attr("y",function(e){return c?N(e.y0):N(0)}).attr("height",0).remove(),H.attr("class",function(e,t){return"nv-group nv-series-"+t}).classed("hover",function(e){return e.hover}).style("fill",function(e,t){return p(e,t)}).style("stroke",function(e,t){return p(e,t)}),H.transition().style("stroke-opacity",1).style("fill-opacity",0.75);var B=H.selectAll("rect.nv-bar").data(function(t){return d&&!e.length?d.values:t.values});B.exit().remove();var j=B.enter().append("rect").attr("class",function(e,t){return a(e,t)<0?"nv-bar negative":"nv-bar positive"}).attr("x",function(t,n,r){return c?0:r*i.rangeBand()/e.length}).attr("y",function(e){return N(c?e.y0:0)}).attr("height",0).attr("width",i.rangeBand()/(c?1:e.length)).attr("transform",function(e,t){return"translate("+i(u(e,t))+",0)"});B.style("fill",function(e,t,n){return p(e,n,t)}).style("stroke",function(e,t,n){return p(e,n,t)}).on("mouseover",function(t,n){d3.select(this).classed("hover",!0),x.elementMouseover({value:a(t,n),point:t,series:e[t.series],pos:[i(u(t,n))+i.rangeBand()*(c?e.length/2:t.series+0.5)/e.length,s(a(t,n)+(c?t.y0:0))],pointIndex:n,seriesIndex:t.series,e:d3.event})}).on("mouseout",function(t,n){d3.select(this).classed("hover",!1),x.elementMouseout({value:a(t,n),point:t,series:e[t.series],pointIndex:n,seriesIndex:t.series,e:d3.event})}).on("click",function(t,n){x.elementClick({value:a(t,n),point:t,series:e[t.series],pos:[i(u(t,n))+i.rangeBand()*(c?e.length/2:t.series+0.5)/e.length,s(a(t,n)+(c?t.y0:0))],pointIndex:n,seriesIndex:t.series,e:d3.event}),d3.event.stopPropagation()}).on("dblclick",function(t,n){x.elementDblClick({value:a(t,n),point:t,series:e[t.series],pos:[i(u(t,n))+i.rangeBand()*(c?e.length/2:t.series+0.5)/e.length,s(a(t,n)+(c?t.y0:0))],pointIndex:n,seriesIndex:t.series,e:d3.event}),d3.event.stopPropagation()}),B.attr("class",function(e,t){return a(e,t)<0?"nv-bar negative":"nv-bar positive"}).transition().attr("transform",function(e,t){return"translate("+i(u(e,t))+",0)"}),v&&(m||(m=e.map(function(){return !0})),B.style("fill",function(e,t,n){return d3.rgb(v(e,t)).darker(m.map(function(e,t){return t}).filter(function(e,t){return !m[t]})[n]).toString()}).style("stroke",function(e,t,n){return d3.rgb(v(e,t)).darker(m.map(function(e,t){return t}).filter(function(e,t){return !m[t]})[n]).toString()})),c?B.transition().delay(function(t,n){return n*g/e[0].values.length}).attr("y",function(e,t){return s(c?e.y1:0)}).attr("height",function(e,t){return Math.max(Math.abs(s(e.y+(c?e.y0:0))-s(c?e.y0:0)),1)}).attr("x",function(t,n){return c?0:t.series*i.rangeBand()/e.length}).attr("width",i.rangeBand()/(c?1:e.length)):B.transition().delay(function(t,n){return n*g/e[0].values.length}).attr("x",function(t,n){return t.series*i.rangeBand()/e.length}).attr("width",i.rangeBand()/e.length).attr("y",function(e,t){return a(e,t)<0?s(0):s(0)-s(a(e,t))<1?s(0)-1:s(a(e,t))||0}).attr("height",function(e,t){return Math.max(Math.abs(s(a(e,t))-s(0)),1)||0}),T=i.copy(),N=s.copy()}),C}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=d3.scale.ordinal(),s=d3.scale.linear(),o=Math.floor(Math.random()*10000),u=function(e){return e.x},a=function(e){return e.y},f=[0],l=!0,c=!1,h="zero",p=e.utils.defaultColor(),d=!1,v=null,m,g=1200,y,b,w,E,S=0.1,x=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),T,N;return C.dispatch=x,C.options=e.utils.optionsFunc.bind(C),C.x=function(e){return arguments.length?(u=e,C):u},C.y=function(e){return arguments.length?(a=e,C):a},C.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,C):t},C.width=function(e){return arguments.length?(n=e,C):n},C.height=function(e){return arguments.length?(r=e,C):r},C.xScale=function(e){return arguments.length?(i=e,C):i},C.yScale=function(e){return arguments.length?(s=e,C):s},C.xDomain=function(e){return arguments.length?(y=e,C):y},C.yDomain=function(e){return arguments.length?(b=e,C):b},C.xRange=function(e){return arguments.length?(w=e,C):w},C.yRange=function(e){return arguments.length?(E=e,C):E},C.forceY=function(e){return arguments.length?(f=e,C):f},C.stacked=function(e){return arguments.length?(c=e,C):c},C.stackOffset=function(e){return arguments.length?(h=e,C):h},C.clipEdge=function(e){return arguments.length?(l=e,C):l},C.color=function(t){return arguments.length?(p=e.utils.getColor(t),C):p},C.barColor=function(t){return arguments.length?(v=e.utils.getColor(t),C):v},C.disabled=function(e){return arguments.length?(m=e,C):m},C.id=function(e){return arguments.length?(o=e,C):o},C.hideable=function(e){return arguments.length?(d=e,C):d},C.delay=function(e){return arguments.length?(g=e,C):g},C.groupSpacing=function(e){return arguments.length?(S=e,C):S},C},e.models.multiBarChart=function(){function A(e){return e.each(function(e){var b=d3.select(this),O=this,M=(u||parseInt(b.style("width"))||960)-o.left-o.right,_=(a||parseInt(b.style("height"))||400)-o.top-o.bottom;A.update=function(){b.transition().duration(k).call(A)},A.container=this,S.disabled=e.map(function(e){return !!e.disabled});if(!x){var D;x={};for(D in S){S[D] instanceof Array?x[D]=S[D].slice(0):x[D]=S[D]}}if(!e||!e.length||!e.filter(function(e){return e.values.length}).length){var P=b.selectAll(".nv-noData").data([T]);return P.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),P.attr("x",o.left+M/2).attr("y",o.top+_/2).text(function(e){return e}),A}b.selectAll(".nv-noData").remove(),w=t.xScale(),E=t.yScale();var H=b.selectAll("g.nv-wrap.nv-multiBarWithLegend").data([e]),B=H.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarWithLegend").append("g"),j=H.select("g");B.append("g").attr("class","nv-x nv-axis"),B.append("g").attr("class","nv-y nv-axis"),B.append("g").attr("class","nv-barsWrap"),B.append("g").attr("class","nv-legendWrap"),B.append("g").attr("class","nv-controlsWrap"),c&&(i.width(M-C()),t.barColor()&&e.forEach(function(e,t){e.color=d3.rgb("#ccc").darker(t*1.5).toString()}),j.select(".nv-legendWrap").datum(e).call(i),o.top!=i.height()&&(o.top=i.height(),_=(a||parseInt(b.style("height"))||400)-o.top-o.bottom),j.select(".nv-legendWrap").attr("transform","translate("+C()+","+-o.top+")"));if(l){var F=[{key:"Grouped",disabled:t.stacked()},{key:"Stacked",disabled:!t.stacked()}];s.width(C()).color(["#444","#444","#444"]),j.select(".nv-controlsWrap").datum(F).attr("transform","translate(0,"+-o.top+")").call(s)}H.attr("transform","translate("+o.left+","+o.top+")"),d&&j.select(".nv-y.nv-axis").attr("transform","translate("+M+",0)"),t.disabled(e.map(function(e){return e.disabled})).width(M).height(_).color(e.map(function(e,t){return e.color||f(e,t)}).filter(function(t,n){return !e[n].disabled}));var I=j.select(".nv-barsWrap").datum(e.filter(function(e){return !e.disabled}));I.transition().call(t);if(h){n.scale(w).ticks(M/100).tickSize(-_,0),j.select(".nv-x.nv-axis").attr("transform","translate(0,"+E.range()[0]+")"),j.select(".nv-x.nv-axis").transition().call(n);var q=j.select(".nv-x.nv-axis > g").selectAll("g");q.selectAll("line, text").style("opacity",1);if(m){var R=function(e,t){return"translate("+e+","+t+")"},U=5,z=17;q.selectAll("text").attr("transform",function(e,t,n){return R(0,n%2==0?U:z)});var W=d3.selectAll(".nv-x.nv-axis .nv-wrap g g text")[0].length;j.selectAll(".nv-x.nv-axis .nv-axisMaxMin text").attr("transform",function(e,t){return R(0,t===0||W%2!==0?z:U)})}v&&q.filter(function(t,n){return n%Math.ceil(e[0].values.length/(M/100))!==0}).selectAll("text, line").style("opacity",0),g&&q.selectAll(".tick text").attr("transform","rotate("+g+" 0,0)").style("text-anchor",g>0?"start":"end"),j.select(".nv-x.nv-axis").selectAll("g.nv-axisMaxMin text").style("opacity",1)}p&&(r.scale(E).ticks(_/36).tickSize(-M,0),j.select(".nv-y.nv-axis").transition().call(r)),i.dispatch.on("stateChange",function(e){S=e,N.stateChange(S),A.update()}),s.dispatch.on("legendClick",function(e,n){if(!e.disabled){return}F=F.map(function(e){return e.disabled=!0,e}),e.disabled=!1;switch(e.key){case"Grouped":t.stacked(!1);break;case"Stacked":t.stacked(!0)}S.stacked=t.stacked(),N.stateChange(S),A.update()}),N.on("tooltipShow",function(e){y&&L(e,O.parentNode)}),N.on("changeState",function(n){typeof n.disabled!="undefined"&&(e.forEach(function(e,t){e.disabled=n.disabled[t]}),S.disabled=n.disabled),typeof n.stacked!="undefined"&&(t.stacked(n.stacked),S.stacked=n.stacked),A.update()})}),A}var t=e.models.multiBar(),n=e.models.axis(),r=e.models.axis(),i=e.models.legend(),s=e.models.legend(),o={top:30,right:20,bottom:50,left:60},u=null,a=null,f=e.utils.defaultColor(),l=!0,c=!0,h=!0,p=!0,d=!1,v=!0,m=!1,g=0,y=!0,b=function(e,t,n,r,i){return"<h3>"+e+"</h3><p>"+n+" on "+t+"</p>"},w,E,S={stacked:!1},x=null,T="No Data Available.",N=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),C=function(){return l?180:0},k=250;t.stacked(!1),n.orient("bottom").tickPadding(7).highlightZero(!0).showMaxMin(!1).tickFormat(function(e){return e}),r.orient(d?"right":"left").tickFormat(d3.format(",.1f")),s.updateState(!1);var L=function(i,s){var o=i.pos[0]+(s.offsetLeft||0),u=i.pos[1]+(s.offsetTop||0),a=n.tickFormat()(t.x()(i.point,i.pointIndex)),f=r.tickFormat()(t.y()(i.point,i.pointIndex)),l=b(i.series.key,a,f,i,A);e.tooltip.show([o,u],l,i.value<0?"n":"s",null,s)};return t.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+o.left,e.pos[1]+o.top],N.tooltipShow(e)}),t.dispatch.on("elementMouseout.tooltip",function(e){N.tooltipHide(e)}),N.on("tooltipHide",function(){y&&e.tooltip.cleanup()}),A.dispatch=N,A.multibar=t,A.legend=i,A.xAxis=n,A.yAxis=r,d3.rebind(A,t,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","clipEdge","id","stacked","stackOffset","delay","barColor","groupSpacing"),A.options=e.utils.optionsFunc.bind(A),A.margin=function(e){return arguments.length?(o.top=typeof e.top!="undefined"?e.top:o.top,o.right=typeof e.right!="undefined"?e.right:o.right,o.bottom=typeof e.bottom!="undefined"?e.bottom:o.bottom,o.left=typeof e.left!="undefined"?e.left:o.left,A):o},A.width=function(e){return arguments.length?(u=e,A):u},A.height=function(e){return arguments.length?(a=e,A):a},A.color=function(t){return arguments.length?(f=e.utils.getColor(t),i.color(f),A):f},A.showControls=function(e){return arguments.length?(l=e,A):l},A.showLegend=function(e){return arguments.length?(c=e,A):c},A.showXAxis=function(e){return arguments.length?(h=e,A):h},A.showYAxis=function(e){return arguments.length?(p=e,A):p},A.rightAlignYAxis=function(e){return arguments.length?(d=e,r.orient(e?"right":"left"),A):d},A.reduceXTicks=function(e){return arguments.length?(v=e,A):v},A.rotateLabels=function(e){return arguments.length?(g=e,A):g},A.staggerLabels=function(e){return arguments.length?(m=e,A):m},A.tooltip=function(e){return arguments.length?(b=e,A):b},A.tooltips=function(e){return arguments.length?(y=e,A):y},A.tooltipContent=function(e){return arguments.length?(b=e,A):b},A.state=function(e){return arguments.length?(S=e,A):S},A.defaultState=function(e){return arguments.length?(x=e,A):x},A.noData=function(e){return arguments.length?(T=e,A):T},A.transitionDuration=function(e){return arguments.length?(k=e,A):k},A},e.models.multiBarHorizontal=function(){function N(e){return e.each(function(e){var i=n-t.left-t.right,g=r-t.top-t.bottom,N=d3.select(this);p&&(e=d3.layout.stack().offset("zero").values(function(e){return e.values}).y(a)(e)),e=e.map(function(e,t){return e.values=e.values.map(function(e){return e.series=t,e}),e}),p&&e[0].values.map(function(t,n){var r=0,i=0;e.map(function(e){var t=e.values[n];t.size=Math.abs(t.y),t.y<0?(t.y1=i-t.size,i-=t.size):(t.y1=r,r+=t.size)})});var C=y&&b?[]:e.map(function(e){return e.values.map(function(e,t){return{x:u(e,t),y:a(e,t),y0:e.y0,y1:e.y1}})});s.domain(y||d3.merge(C).map(function(e){return e.x})).rangeBands(w||[0,g],0.1),o.domain(b||d3.extent(d3.merge(C).map(function(e){return p?e.y>0?e.y1+e.y:e.y1:e.y}).concat(f))),d&&!p?o.range(E||[o.domain()[0]<0?v:0,i-(o.domain()[1]>0?v:0)]):o.range(E||[0,i]),x=x||s,T=T||d3.scale.linear().domain(o.domain()).range([o(0),o(0)]);var k=d3.select(this).selectAll("g.nv-wrap.nv-multibarHorizontal").data([e]),L=k.enter().append("g").attr("class","nvd3 nv-wrap nv-multibarHorizontal"),A=L.append("defs"),O=L.append("g"),M=k.select("g");O.append("g").attr("class","nv-groups"),k.attr("transform","translate("+t.left+","+t.top+")");var _=k.select(".nv-groups").selectAll(".nv-group").data(function(e){return e},function(e,t){return t});_.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001),_.exit().transition().style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove(),_.attr("class",function(e,t){return"nv-group nv-series-"+t}).classed("hover",function(e){return e.hover}).style("fill",function(e,t){return l(e,t)}).style("stroke",function(e,t){return l(e,t)}),_.transition().style("stroke-opacity",1).style("fill-opacity",0.75);var D=_.selectAll("g.nv-bar").data(function(e){return e.values});D.exit().remove();var P=D.enter().append("g").attr("transform",function(t,n,r){return"translate("+T(p?t.y0:0)+","+(p?0:r*s.rangeBand()/e.length+s(u(t,n)))+")"});P.append("rect").attr("width",0).attr("height",s.rangeBand()/(p?1:e.length)),D.on("mouseover",function(t,n){d3.select(this).classed("hover",!0),S.elementMouseover({value:a(t,n),point:t,series:e[t.series],pos:[o(a(t,n)+(p?t.y0:0)),s(u(t,n))+s.rangeBand()*(p?e.length/2:t.series+0.5)/e.length],pointIndex:n,seriesIndex:t.series,e:d3.event})}).on("mouseout",function(t,n){d3.select(this).classed("hover",!1),S.elementMouseout({value:a(t,n),point:t,series:e[t.series],pointIndex:n,seriesIndex:t.series,e:d3.event})}).on("click",function(t,n){S.elementClick({value:a(t,n),point:t,series:e[t.series],pos:[s(u(t,n))+s.rangeBand()*(p?e.length/2:t.series+0.5)/e.length,o(a(t,n)+(p?t.y0:0))],pointIndex:n,seriesIndex:t.series,e:d3.event}),d3.event.stopPropagation()}).on("dblclick",function(t,n){S.elementDblClick({value:a(t,n),point:t,series:e[t.series],pos:[s(u(t,n))+s.rangeBand()*(p?e.length/2:t.series+0.5)/e.length,o(a(t,n)+(p?t.y0:0))],pointIndex:n,seriesIndex:t.series,e:d3.event}),d3.event.stopPropagation()}),P.append("text"),d&&!p?(D.select("text").attr("text-anchor",function(e,t){return a(e,t)<0?"end":"start"}).attr("y",s.rangeBand()/(e.length*2)).attr("dy",".32em").text(function(e,t){return m(a(e,t))}),D.transition().select("text").attr("x",function(e,t){return a(e,t)<0?-4:o(a(e,t))-o(0)+4})):D.selectAll("text").text(""),D.attr("class",function(e,t){return a(e,t)<0?"nv-bar negative":"nv-bar positive"}),c&&(h||(h=e.map(function(){return !0})),D.style("fill",function(e,t,n){return d3.rgb(c(e,t)).darker(h.map(function(e,t){return t}).filter(function(e,t){return !h[t]})[n]).toString()}).style("stroke",function(e,t,n){return d3.rgb(c(e,t)).darker(h.map(function(e,t){return t}).filter(function(e,t){return !h[t]})[n]).toString()})),p?D.transition().attr("transform",function(e,t){return"translate("+o(e.y1)+","+s(u(e,t))+")"}).select("rect").attr("width",function(e,t){return Math.abs(o(a(e,t)+e.y0)-o(e.y0))}).attr("height",s.rangeBand()):D.transition().attr("transform",function(t,n){return"translate("+(a(t,n)<0?o(a(t,n)):o(0))+","+(t.series*s.rangeBand()/e.length+s(u(t,n)))+")"}).select("rect").attr("height",s.rangeBand()/e.length).attr("width",function(e,t){return Math.max(Math.abs(o(a(e,t))-o(0)),1)}),x=s.copy(),T=o.copy()}),N}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=Math.floor(Math.random()*10000),s=d3.scale.ordinal(),o=d3.scale.linear(),u=function(e){return e.x},a=function(e){return e.y},f=[0],l=e.utils.defaultColor(),c=null,h,p=!1,d=!1,v=60,m=d3.format(",.2f"),g=1200,y,b,w,E,S=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),x,T;return N.dispatch=S,N.options=e.utils.optionsFunc.bind(N),N.x=function(e){return arguments.length?(u=e,N):u},N.y=function(e){return arguments.length?(a=e,N):a},N.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,N):t},N.width=function(e){return arguments.length?(n=e,N):n},N.height=function(e){return arguments.length?(r=e,N):r},N.xScale=function(e){return arguments.length?(s=e,N):s},N.yScale=function(e){return arguments.length?(o=e,N):o},N.xDomain=function(e){return arguments.length?(y=e,N):y},N.yDomain=function(e){return arguments.length?(b=e,N):b},N.xRange=function(e){return arguments.length?(w=e,N):w},N.yRange=function(e){return arguments.length?(E=e,N):E},N.forceY=function(e){return arguments.length?(f=e,N):f},N.stacked=function(e){return arguments.length?(p=e,N):p},N.color=function(t){return arguments.length?(l=e.utils.getColor(t),N):l},N.barColor=function(t){return arguments.length?(c=e.utils.getColor(t),N):c},N.disabled=function(e){return arguments.length?(h=e,N):h},N.id=function(e){return arguments.length?(i=e,N):i},N.delay=function(e){return arguments.length?(g=e,N):g},N.showValues=function(e){return arguments.length?(d=e,N):d},N.valueFormat=function(e){return arguments.length?(m=e,N):m},N.valuePadding=function(e){return arguments.length?(v=e,N):v},N},e.models.multiBarHorizontalChart=function(){function T(e){return e.each(function(h){var d=d3.select(this),N=this,C=(u||parseInt(d.style("width"))||960)-o.left-o.right,k=(a||parseInt(d.style("height"))||400)-o.top-o.bottom;T.update=function(){d.transition().duration(S).call(T)},T.container=this,g.disabled=h.map(function(e){return !!e.disabled});if(!y){var L;y={};for(L in g){g[L] instanceof Array?y[L]=g[L].slice(0):y[L]=g[L]}}if(!h||!h.length||!h.filter(function(e){return e.values.length}).length){var A=d.selectAll(".nv-noData").data([b]);return A.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),A.attr("x",o.left+C/2).attr("y",o.top+k/2).text(function(e){return e}),T}d.selectAll(".nv-noData").remove(),v=t.xScale(),m=t.yScale();var O=d.selectAll("g.nv-wrap.nv-multiBarHorizontalChart").data([h]),M=O.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarHorizontalChart").append("g"),_=O.select("g");M.append("g").attr("class","nv-x nv-axis"),M.append("g").attr("class","nv-y nv-axis"),M.append("g").attr("class","nv-barsWrap"),M.append("g").attr("class","nv-legendWrap"),M.append("g").attr("class","nv-controlsWrap"),c&&(i.width(C-E()),t.barColor()&&h.forEach(function(e,t){e.color=d3.rgb("#ccc").darker(t*1.5).toString()}),_.select(".nv-legendWrap").datum(h).call(i),o.top!=i.height()&&(o.top=i.height(),k=(a||parseInt(d.style("height"))||400)-o.top-o.bottom),_.select(".nv-legendWrap").attr("transform","translate("+E()+","+-o.top+")"));if(l){var D=[{key:"Grouped",disabled:t.stacked()},{key:"Stacked",disabled:!t.stacked()}];s.width(E()).color(["#444","#444","#444"]),_.select(".nv-controlsWrap").datum(D).attr("transform","translate(0,"+-o.top+")").call(s)}O.attr("transform","translate("+o.left+","+o.top+")"),t.disabled(h.map(function(e){return e.disabled})).width(C).height(k).color(h.map(function(e,t){return e.color||f(e,t)}).filter(function(e,t){return !h[t].disabled}));var P=_.select(".nv-barsWrap").datum(h.filter(function(e){return !e.disabled}));P.transition().call(t),n.scale(v).ticks(k/24).tickSize(-C,0),_.select(".nv-x.nv-axis").transition().call(n);var H=_.select(".nv-x.nv-axis").selectAll("g");H.selectAll("line, text").style("opacity",1),r.scale(m).ticks(C/100).tickSize(-k,0),_.select(".nv-y.nv-axis").attr("transform","translate(0,"+k+")"),_.select(".nv-y.nv-axis").transition().call(r),i.dispatch.on("stateChange",function(e){g=e,w.stateChange(g),T.update()}),s.dispatch.on("legendClick",function(e,n){if(!e.disabled){return}D=D.map(function(e){return e.disabled=!0,e}),e.disabled=!1;switch(e.key){case"Grouped":t.stacked(!1);break;case"Stacked":t.stacked(!0)}g.stacked=t.stacked(),w.stateChange(g),T.update()}),w.on("tooltipShow",function(e){p&&x(e,N.parentNode)}),w.on("changeState",function(n){typeof n.disabled!="undefined"&&(h.forEach(function(e,t){e.disabled=n.disabled[t]}),g.disabled=n.disabled),typeof n.stacked!="undefined"&&(t.stacked(n.stacked),g.stacked=n.stacked),e.call(T)})}),T}var t=e.models.multiBarHorizontal(),n=e.models.axis(),r=e.models.axis(),i=e.models.legend().height(30),s=e.models.legend().height(30),o={top:30,right:20,bottom:50,left:60},u=null,a=null,f=e.utils.defaultColor(),l=!0,c=!0,h=!1,p=!0,d=function(e,t,n,r,i){return"<h3>"+e+" - "+t+"</h3><p>"+n+"</p>"},v,m,g={stacked:h},y=null,b="No Data Available.",w=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),E=function(){return l?180:0},S=250;t.stacked(h),n.orient("left").tickPadding(5).highlightZero(!1).showMaxMin(!1).tickFormat(function(e){return e}),r.orient("bottom").tickFormat(d3.format(",.1f")),s.updateState(!1);var x=function(i,s){var o=i.pos[0]+(s.offsetLeft||0),u=i.pos[1]+(s.offsetTop||0),a=n.tickFormat()(t.x()(i.point,i.pointIndex)),f=r.tickFormat()(t.y()(i.point,i.pointIndex)),l=d(i.series.key,a,f,i,T);e.tooltip.show([o,u],l,i.value<0?"e":"w",null,s)};return t.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+o.left,e.pos[1]+o.top],w.tooltipShow(e)}),t.dispatch.on("elementMouseout.tooltip",function(e){w.tooltipHide(e)}),w.on("tooltipHide",function(){p&&e.tooltip.cleanup()}),T.dispatch=w,T.multibar=t,T.legend=i,T.xAxis=n,T.yAxis=r,d3.rebind(T,t,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","clipEdge","id","delay","showValues","valueFormat","stacked","barColor"),T.options=e.utils.optionsFunc.bind(T),T.margin=function(e){return arguments.length?(o.top=typeof e.top!="undefined"?e.top:o.top,o.right=typeof e.right!="undefined"?e.right:o.right,o.bottom=typeof e.bottom!="undefined"?e.bottom:o.bottom,o.left=typeof e.left!="undefined"?e.left:o.left,T):o},T.width=function(e){return arguments.length?(u=e,T):u},T.height=function(e){return arguments.length?(a=e,T):a},T.color=function(t){return arguments.length?(f=e.utils.getColor(t),i.color(f),T):f},T.showControls=function(e){return arguments.length?(l=e,T):l},T.showLegend=function(e){return arguments.length?(c=e,T):c},T.tooltip=function(e){return arguments.length?(d=e,T):d},T.tooltips=function(e){return arguments.length?(p=e,T):p},T.tooltipContent=function(e){return arguments.length?(d=e,T):d},T.state=function(e){return arguments.length?(g=e,T):g},T.defaultState=function(e){return arguments.length?(y=e,T):y},T.noData=function(e){return arguments.length?(b=e,T):b},T.transitionDuration=function(e){return arguments.length?(S=e,T):S},T},e.models.multiChart=function(){function C(e){return e.each(function(e){var u=d3.select(this),f=this;C.update=function(){u.transition().call(C)},C.container=this;var k=(r||parseInt(u.style("width"))||960)-t.left-t.right,L=(i||parseInt(u.style("height"))||400)-t.top-t.bottom,A=e.filter(function(e){return !e.disabled&&e.type=="line"&&e.yAxis==1}),O=e.filter(function(e){return !e.disabled&&e.type=="line"&&e.yAxis==2}),M=e.filter(function(e){return !e.disabled&&e.type=="bar"&&e.yAxis==1}),_=e.filter(function(e){return !e.disabled&&e.type=="bar"&&e.yAxis==2}),D=e.filter(function(e){return !e.disabled&&e.type=="area"&&e.yAxis==1}),P=e.filter(function(e){return !e.disabled&&e.type=="area"&&e.yAxis==2}),H=e.filter(function(e){return !e.disabled&&e.yAxis==1}).map(function(e){return e.values.map(function(e,t){return{x:e.x,y:e.y}})}),B=e.filter(function(e){return !e.disabled&&e.yAxis==2}).map(function(e){return e.values.map(function(e,t){return{x:e.x,y:e.y}})});a.domain(d3.extent(d3.merge(H.concat(B)),function(e){return e.x})).range([0,k]);var j=u.selectAll("g.wrap.multiChart").data([e]),F=j.enter().append("g").attr("class","wrap nvd3 multiChart").append("g");F.append("g").attr("class","x axis"),F.append("g").attr("class","y1 axis"),F.append("g").attr("class","y2 axis"),F.append("g").attr("class","lines1Wrap"),F.append("g").attr("class","lines2Wrap"),F.append("g").attr("class","bars1Wrap"),F.append("g").attr("class","bars2Wrap"),F.append("g").attr("class","stack1Wrap"),F.append("g").attr("class","stack2Wrap"),F.append("g").attr("class","legendWrap");var I=j.select("g");s&&(x.width(k/2),I.select(".legendWrap").datum(e.map(function(e){return e.originalKey=e.originalKey===undefined?e.key:e.originalKey,e.key=e.originalKey+(e.yAxis==1?"":" (right axis)"),e})).call(x),t.top!=x.height()&&(t.top=x.height(),L=(i||parseInt(u.style("height"))||400)-t.top-t.bottom),I.select(".legendWrap").attr("transform","translate("+k/2+","+-t.top+")")),d.width(k).height(L).interpolate("monotone").color(e.map(function(e,t){return e.color||n[t%n.length]}).filter(function(t,n){return !e[n].disabled&&e[n].yAxis==1&&e[n].type=="line"})),v.width(k).height(L).interpolate("monotone").color(e.map(function(e,t){return e.color||n[t%n.length]}).filter(function(t,n){return !e[n].disabled&&e[n].yAxis==2&&e[n].type=="line"})),m.width(k).height(L).color(e.map(function(e,t){return e.color||n[t%n.length]}).filter(function(t,n){return !e[n].disabled&&e[n].yAxis==1&&e[n].type=="bar"})),g.width(k).height(L).color(e.map(function(e,t){return e.color||n[t%n.length]}).filter(function(t,n){return !e[n].disabled&&e[n].yAxis==2&&e[n].type=="bar"})),y.width(k).height(L).color(e.map(function(e,t){return e.color||n[t%n.length]}).filter(function(t,n){return !e[n].disabled&&e[n].yAxis==1&&e[n].type=="area"})),b.width(k).height(L).color(e.map(function(e,t){return e.color||n[t%n.length]}).filter(function(t,n){return !e[n].disabled&&e[n].yAxis==2&&e[n].type=="area"})),I.attr("transform","translate("+t.left+","+t.top+")");var q=I.select(".lines1Wrap").datum(A),R=I.select(".bars1Wrap").datum(M),U=I.select(".stack1Wrap").datum(D),z=I.select(".lines2Wrap").datum(O),W=I.select(".bars2Wrap").datum(_),X=I.select(".stack2Wrap").datum(P),V=D.length?D.map(function(e){return e.values}).reduce(function(e,t){return e.map(function(e,n){return{x:e.x,y:e.y+t[n].y}})}).concat([{x:0,y:0}]):[],$=P.length?P.map(function(e){return e.values}).reduce(function(e,t){return e.map(function(e,n){return{x:e.x,y:e.y+t[n].y}})}).concat([{x:0,y:0}]):[];h.domain(l||d3.extent(d3.merge(H).concat(V),function(e){return e.y})).range([0,L]),p.domain(c||d3.extent(d3.merge(B).concat($),function(e){return e.y})).range([0,L]),d.yDomain(h.domain()),m.yDomain(h.domain()),y.yDomain(h.domain()),v.yDomain(p.domain()),g.yDomain(p.domain()),b.yDomain(p.domain()),D.length&&d3.transition(U).call(y),P.length&&d3.transition(X).call(b),M.length&&d3.transition(R).call(m),_.length&&d3.transition(W).call(g),A.length&&d3.transition(q).call(d),O.length&&d3.transition(z).call(v),w.ticks(k/100).tickSize(-L,0),I.select(".x.axis").attr("transform","translate(0,"+L+")"),d3.transition(I.select(".x.axis")).call(w),E.ticks(L/36).tickSize(-k,0),d3.transition(I.select(".y1.axis")).call(E),S.ticks(L/36).tickSize(-k,0),d3.transition(I.select(".y2.axis")).call(S),I.select(".y2.axis").style("opacity",B.length?1:0).attr("transform","translate("+a.range()[1]+",0)"),x.dispatch.on("stateChange",function(e){C.update()}),T.on("tooltipShow",function(e){o&&N(e,f.parentNode)})}),C}var t={top:30,right:20,bottom:50,left:60},n=d3.scale.category20().range(),r=null,i=null,s=!0,o=!0,u=function(e,t,n,r,i){return"<h3>"+e+"</h3><p>"+n+" at "+t+"</p>"},a,f,l,c,a=d3.scale.linear(),h=d3.scale.linear(),p=d3.scale.linear(),d=e.models.line().yScale(h),v=e.models.line().yScale(p),m=e.models.multiBar().stacked(!1).yScale(h),g=e.models.multiBar().stacked(!1).yScale(p),y=e.models.stackedArea().yScale(h),b=e.models.stackedArea().yScale(p),w=e.models.axis().scale(a).orient("bottom").tickPadding(5),E=e.models.axis().scale(h).orient("left"),S=e.models.axis().scale(p).orient("right"),x=e.models.legend().height(30),T=d3.dispatch("tooltipShow","tooltipHide"),N=function(t,n){var r=t.pos[0]+(n.offsetLeft||0),i=t.pos[1]+(n.offsetTop||0),s=w.tickFormat()(d.x()(t.point,t.pointIndex)),o=(t.series.yAxis==2?S:E).tickFormat()(d.y()(t.point,t.pointIndex)),a=u(t.series.key,s,o,t,C);e.tooltip.show([r,i],a,undefined,undefined,n.offsetParent)};return d.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],T.tooltipShow(e)}),d.dispatch.on("elementMouseout.tooltip",function(e){T.tooltipHide(e)}),v.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],T.tooltipShow(e)}),v.dispatch.on("elementMouseout.tooltip",function(e){T.tooltipHide(e)}),m.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],T.tooltipShow(e)}),m.dispatch.on("elementMouseout.tooltip",function(e){T.tooltipHide(e)}),g.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],T.tooltipShow(e)}),g.dispatch.on("elementMouseout.tooltip",function(e){T.tooltipHide(e)}),y.dispatch.on("tooltipShow",function(e){if(!Math.round(y.y()(e.point)*100)){return setTimeout(function(){d3.selectAll(".point.hover").classed("hover",!1)},0),!1}e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],T.tooltipShow(e)}),y.dispatch.on("tooltipHide",function(e){T.tooltipHide(e)}),b.dispatch.on("tooltipShow",function(e){if(!Math.round(b.y()(e.point)*100)){return setTimeout(function(){d3.selectAll(".point.hover").classed("hover",!1)},0),!1}e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],T.tooltipShow(e)}),b.dispatch.on("tooltipHide",function(e){T.tooltipHide(e)}),d.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],T.tooltipShow(e)}),d.dispatch.on("elementMouseout.tooltip",function(e){T.tooltipHide(e)}),v.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],T.tooltipShow(e)}),v.dispatch.on("elementMouseout.tooltip",function(e){T.tooltipHide(e)}),T.on("tooltipHide",function(){o&&e.tooltip.cleanup()}),C.dispatch=T,C.lines1=d,C.lines2=v,C.bars1=m,C.bars2=g,C.stack1=y,C.stack2=b,C.xAxis=w,C.yAxis1=E,C.yAxis2=S,C.options=e.utils.optionsFunc.bind(C),C.x=function(e){return arguments.length?(getX=e,d.x(e),m.x(e),C):getX},C.y=function(e){return arguments.length?(getY=e,d.y(e),m.y(e),C):getY},C.yDomain1=function(e){return arguments.length?(l=e,C):l},C.yDomain2=function(e){return arguments.length?(c=e,C):c},C.margin=function(e){return arguments.length?(t=e,C):t},C.width=function(e){return arguments.length?(r=e,C):r},C.height=function(e){return arguments.length?(i=e,C):i},C.color=function(e){return arguments.length?(n=e,x.color(e),C):n},C.showLegend=function(e){return arguments.length?(s=e,C):s},C.tooltips=function(e){return arguments.length?(o=e,C):o},C.tooltipContent=function(e){return arguments.length?(u=e,C):u},C},e.models.ohlcBar=function(){function x(e){return e.each(function(e){var g=n-t.left-t.right,x=r-t.top-t.bottom,T=d3.select(this);s.domain(y||d3.extent(e[0].values.map(u).concat(p))),v?s.range(w||[g*0.5/e[0].values.length,g*(e[0].values.length-0.5)/e[0].values.length]):s.range(w||[0,g]),o.domain(b||[d3.min(e[0].values.map(h).concat(d)),d3.max(e[0].values.map(c).concat(d))]).range(E||[x,0]),s.domain()[0]===s.domain()[1]&&(s.domain()[0]?s.domain([s.domain()[0]-s.domain()[0]*0.01,s.domain()[1]+s.domain()[1]*0.01]):s.domain([-1,1])),o.domain()[0]===o.domain()[1]&&(o.domain()[0]?o.domain([o.domain()[0]+o.domain()[0]*0.01,o.domain()[1]-o.domain()[1]*0.01]):o.domain([-1,1]));var N=d3.select(this).selectAll("g.nv-wrap.nv-ohlcBar").data([e[0].values]),C=N.enter().append("g").attr("class","nvd3 nv-wrap nv-ohlcBar"),k=C.append("defs"),L=C.append("g"),A=N.select("g");L.append("g").attr("class","nv-ticks"),N.attr("transform","translate("+t.left+","+t.top+")"),T.on("click",function(e,t){S.chartClick({data:e,index:t,pos:d3.event,id:i})}),k.append("clipPath").attr("id","nv-chart-clip-path-"+i).append("rect"),N.select("#nv-chart-clip-path-"+i+" rect").attr("width",g).attr("height",x),A.attr("clip-path",m?"url(#nv-chart-clip-path-"+i+")":"");var O=N.select(".nv-ticks").selectAll(".nv-tick").data(function(e){return e});O.exit().remove();var M=O.enter().append("path").attr("class",function(e,t,n){return(f(e,t)>l(e,t)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+n+"-"+t}).attr("d",function(t,n){var r=g/e[0].values.length*0.9;return"m0,0l0,"+(o(f(t,n))-o(c(t,n)))+"l"+-r/2+",0l"+r/2+",0l0,"+(o(h(t,n))-o(f(t,n)))+"l0,"+(o(l(t,n))-o(h(t,n)))+"l"+r/2+",0l"+-r/2+",0z"}).attr("transform",function(e,t){return"translate("+s(u(e,t))+","+o(c(e,t))+")"}).on("mouseover",function(t,n){d3.select(this).classed("hover",!0),S.elementMouseover({point:t,series:e[0],pos:[s(u(t,n)),o(a(t,n))],pointIndex:n,seriesIndex:0,e:d3.event})}).on("mouseout",function(t,n){d3.select(this).classed("hover",!1),S.elementMouseout({point:t,series:e[0],pointIndex:n,seriesIndex:0,e:d3.event})}).on("click",function(e,t){S.elementClick({value:a(e,t),data:e,index:t,pos:[s(u(e,t)),o(a(e,t))],e:d3.event,id:i}),d3.event.stopPropagation()}).on("dblclick",function(e,t){S.elementDblClick({value:a(e,t),data:e,index:t,pos:[s(u(e,t)),o(a(e,t))],e:d3.event,id:i}),d3.event.stopPropagation()});O.attr("class",function(e,t,n){return(f(e,t)>l(e,t)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+n+"-"+t}),d3.transition(O).attr("transform",function(e,t){return"translate("+s(u(e,t))+","+o(c(e,t))+")"}).attr("d",function(t,n){var r=g/e[0].values.length*0.9;return"m0,0l0,"+(o(f(t,n))-o(c(t,n)))+"l"+-r/2+",0l"+r/2+",0l0,"+(o(h(t,n))-o(f(t,n)))+"l0,"+(o(l(t,n))-o(h(t,n)))+"l"+r/2+",0l"+-r/2+",0z"})}),x}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=Math.floor(Math.random()*10000),s=d3.scale.linear(),o=d3.scale.linear(),u=function(e){return e.x},a=function(e){return e.y},f=function(e){return e.open},l=function(e){return e.close},c=function(e){return e.high},h=function(e){return e.low},p=[],d=[],v=!1,m=!0,g=e.utils.defaultColor(),y,b,w,E,S=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");return x.dispatch=S,x.options=e.utils.optionsFunc.bind(x),x.x=function(e){return arguments.length?(u=e,x):u},x.y=function(e){return arguments.length?(a=e,x):a},x.open=function(e){return arguments.length?(f=e,x):f},x.close=function(e){return arguments.length?(l=e,x):l},x.high=function(e){return arguments.length?(c=e,x):c},x.low=function(e){return arguments.length?(h=e,x):h},x.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,x):t},x.width=function(e){return arguments.length?(n=e,x):n},x.height=function(e){return arguments.length?(r=e,x):r},x.xScale=function(e){return arguments.length?(s=e,x):s},x.yScale=function(e){return arguments.length?(o=e,x):o},x.xDomain=function(e){return arguments.length?(y=e,x):y},x.yDomain=function(e){return arguments.length?(b=e,x):b},x.xRange=function(e){return arguments.length?(w=e,x):w},x.yRange=function(e){return arguments.length?(E=e,x):E},x.forceX=function(e){return arguments.length?(p=e,x):p},x.forceY=function(e){return arguments.length?(d=e,x):d},x.padData=function(e){return arguments.length?(v=e,x):v},x.clipEdge=function(e){return arguments.length?(m=e,x):m},x.color=function(t){return arguments.length?(g=e.utils.getColor(t),x):g},x.id=function(e){return arguments.length?(i=e,x):i},x},e.models.pie=function(){function E(e){return e.each(function(e){function P(e){var t=(e.startAngle+e.endAngle)*90/Math.PI-90;return t>90?t-180:t}function H(e){e.endAngle=isNaN(e.endAngle)?0:e.endAngle,e.startAngle=isNaN(e.startAngle)?0:e.startAngle,v||(e.innerRadius=0);var t=d3.interpolate(this._current,e);return this._current=t(0),function(e){return L(t(e))}}function B(e){e.innerRadius=0;var t=d3.interpolate({startAngle:0,endAngle:0},e);return function(e){return L(t(e))}}var o=n-t.left-t.right,f=r-t.top-t.bottom,E=Math.min(o,f)/2,S=E-E/5,x=d3.select(this),T=x.selectAll(".nv-wrap.nv-pie").data(e),N=T.enter().append("g").attr("class","nvd3 nv-wrap nv-pie nv-chart-"+u),C=N.append("g"),k=T.select("g");C.append("g").attr("class","nv-pie"),T.attr("transform","translate("+t.left+","+t.top+")"),k.select(".nv-pie").attr("transform","translate("+o/2+","+f/2+")"),x.on("click",function(e,t){w.chartClick({data:e,index:t,pos:d3.event,id:u})});var L=d3.svg.arc().outerRadius(S);g&&L.startAngle(g),y&&L.endAngle(y),v&&L.innerRadius(E*b);var A=d3.layout.pie().sort(null).value(function(e){return e.disabled?0:s(e)}),O=T.select(".nv-pie").selectAll(".nv-slice").data(A);O.exit().remove();var M=O.enter().append("g").attr("class","nv-slice").on("mouseover",function(e,t){d3.select(this).classed("hover",!0),w.elementMouseover({label:i(e.data),value:s(e.data),point:e.data,pointIndex:t,pos:[d3.event.pageX,d3.event.pageY],id:u})}).on("mouseout",function(e,t){d3.select(this).classed("hover",!1),w.elementMouseout({label:i(e.data),value:s(e.data),point:e.data,index:t,id:u})}).on("click",function(e,t){w.elementClick({label:i(e.data),value:s(e.data),point:e.data,index:t,pos:d3.event,id:u}),d3.event.stopPropagation()}).on("dblclick",function(e,t){w.elementDblClick({label:i(e.data),value:s(e.data),point:e.data,index:t,pos:d3.event,id:u}),d3.event.stopPropagation()});O.attr("fill",function(e,t){return a(e,t)}).attr("stroke",function(e,t){return a(e,t)});var _=M.append("path").each(function(e){this._current=e});d3.transition(O.select("path")).attr("d",L).attrTween("d",H);if(l){var D=d3.svg.arc().innerRadius(0);c&&(D=L),h&&(D=d3.svg.arc().outerRadius(L.outerRadius())),M.append("g").classed("nv-label",!0).each(function(e,t){var n=d3.select(this);n.attr("transform",function(e){if(m){e.outerRadius=S+10,e.innerRadius=S+15;var t=(e.startAngle+e.endAngle)/2*(180/Math.PI);return(e.startAngle+e.endAngle)/2<Math.PI?t-=90:t+=90,"translate("+D.centroid(e)+") rotate("+t+")"}return e.outerRadius=E+10,e.innerRadius=E+15,"translate("+D.centroid(e)+")"}),n.append("rect").style("stroke","#fff").style("fill","#fff").attr("rx",3).attr("ry",3),n.append("text").style("text-anchor",m?(e.startAngle+e.endAngle)/2<Math.PI?"start":"end":"middle").style("fill","#000")}),O.select(".nv-label").transition().attr("transform",function(e){if(m){e.outerRadius=S+10,e.innerRadius=S+15;var t=(e.startAngle+e.endAngle)/2*(180/Math.PI);return(e.startAngle+e.endAngle)/2<Math.PI?t-=90:t+=90,"translate("+D.centroid(e)+") rotate("+t+")"}return e.outerRadius=E+10,e.innerRadius=E+15,"translate("+D.centroid(e)+")"}),O.each(function(e,t){var n=d3.select(this);n.select(".nv-label text").style("text-anchor",m?(e.startAngle+e.endAngle)/2<Math.PI?"start":"end":"middle").text(function(e,t){var n=(e.endAngle-e.startAngle)/(2*Math.PI),r={key:i(e.data),value:s(e.data),percent:d3.format("%")(n)};return e.value&&n>d?r[p]:""});var r=n.select("text").node().getBBox();n.select(".nv-label rect").attr("width",r.width+10).attr("height",r.height+10).attr("transform",function(){return"translate("+[r.x-5,r.y-5]+")"})})}}),E}var t={top:0,right:0,bottom:0,left:0},n=500,r=500,i=function(e){return e.x},s=function(e){return e.y},o=function(e){return e.description},u=Math.floor(Math.random()*10000),a=e.utils.defaultColor(),f=d3.format(",.2f"),l=!0,c=!0,h=!1,p="key",d=0.02,v=!1,m=!1,g=!1,y=!1,b=0.5,w=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");return E.dispatch=w,E.options=e.utils.optionsFunc.bind(E),E.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,E):t},E.width=function(e){return arguments.length?(n=e,E):n},E.height=function(e){return arguments.length?(r=e,E):r},E.values=function(t){return e.log("pie.values() is no longer supported."),E},E.x=function(e){return arguments.length?(i=e,E):i},E.y=function(e){return arguments.length?(s=d3.functor(e),E):s},E.description=function(e){return arguments.length?(o=e,E):o},E.showLabels=function(e){return arguments.length?(l=e,E):l},E.labelSunbeamLayout=function(e){return arguments.length?(m=e,E):m},E.donutLabelsOutside=function(e){return arguments.length?(h=e,E):h},E.pieLabelsOutside=function(e){return arguments.length?(c=e,E):c},E.labelType=function(e){return arguments.length?(p=e,p=p||"key",E):p},E.donut=function(e){return arguments.length?(v=e,E):v},E.donutRatio=function(e){return arguments.length?(b=e,E):b},E.startAngle=function(e){return arguments.length?(g=e,E):g},E.endAngle=function(e){return arguments.length?(y=e,E):y},E.id=function(e){return arguments.length?(u=e,E):u},E.color=function(t){return arguments.length?(a=e.utils.getColor(t),E):a},E.valueFormat=function(e){return arguments.length?(f=e,E):f},E.labelThreshold=function(e){return arguments.length?(d=e,E):d},E},e.models.pieChart=function(){function v(e){return e.each(function(e){var u=d3.select(this),a=this,f=(i||parseInt(u.style("width"))||960)-r.left-r.right,d=(s||parseInt(u.style("height"))||400)-r.top-r.bottom;v.update=function(){u.transition().call(v)},v.container=this,l.disabled=e.map(function(e){return !!e.disabled});if(!c){var m;c={};for(m in l){l[m] instanceof Array?c[m]=l[m].slice(0):c[m]=l[m]}}if(!e||!e.length){var g=u.selectAll(".nv-noData").data([h]);return g.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),g.attr("x",r.left+f/2).attr("y",r.top+d/2).text(function(e){return e}),v}u.selectAll(".nv-noData").remove();var y=u.selectAll("g.nv-wrap.nv-pieChart").data([e]),b=y.enter().append("g").attr("class","nvd3 nv-wrap nv-pieChart").append("g"),w=y.select("g");b.append("g").attr("class","nv-pieWrap"),b.append("g").attr("class","nv-legendWrap"),o&&(n.width(f).key(t.x()),y.select(".nv-legendWrap").datum(e).call(n),r.top!=n.height()&&(r.top=n.height(),d=(s||parseInt(u.style("height"))||400)-r.top-r.bottom),y.select(".nv-legendWrap").attr("transform","translate(0,"+-r.top+")")),y.attr("transform","translate("+r.left+","+r.top+")"),t.width(f).height(d);var E=w.select(".nv-pieWrap").datum([e]);d3.transition(E).call(t),n.dispatch.on("stateChange",function(e){l=e,p.stateChange(l),v.update()}),t.dispatch.on("elementMouseout.tooltip",function(e){p.tooltipHide(e)}),p.on("changeState",function(t){typeof t.disabled!="undefined"&&(e.forEach(function(e,n){e.disabled=t.disabled[n]}),l.disabled=t.disabled),v.update()})}),v}var t=e.models.pie(),n=e.models.legend(),r={top:30,right:20,bottom:20,left:20},i=null,s=null,o=!0,u=e.utils.defaultColor(),a=!0,f=function(e,t,n,r){return"<h3>"+e+"</h3><p>"+t+"</p>"},l={},c=null,h="No Data Available.",p=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),d=function(n,r){var i=t.description()(n.point)||t.x()(n.point),s=n.pos[0]+(r&&r.offsetLeft||0),o=n.pos[1]+(r&&r.offsetTop||0),u=t.valueFormat()(t.y()(n.point)),a=f(i,u,n,v);e.tooltip.show([s,o],a,n.value<0?"n":"s",null,r)};return t.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+r.left,e.pos[1]+r.top],p.tooltipShow(e)}),p.on("tooltipShow",function(e){a&&d(e)}),p.on("tooltipHide",function(){a&&e.tooltip.cleanup()}),v.legend=n,v.dispatch=p,v.pie=t,d3.rebind(v,t,"valueFormat","values","x","y","description","id","showLabels","donutLabelsOutside","pieLabelsOutside","labelType","donut","donutRatio","labelThreshold"),v.options=e.utils.optionsFunc.bind(v),v.margin=function(e){return arguments.length?(r.top=typeof e.top!="undefined"?e.top:r.top,r.right=typeof e.right!="undefined"?e.right:r.right,r.bottom=typeof e.bottom!="undefined"?e.bottom:r.bottom,r.left=typeof e.left!="undefined"?e.left:r.left,v):r},v.width=function(e){return arguments.length?(i=e,v):i},v.height=function(e){return arguments.length?(s=e,v):s},v.color=function(r){return arguments.length?(u=e.utils.getColor(r),n.color(u),t.color(u),v):u},v.showLegend=function(e){return arguments.length?(o=e,v):o},v.tooltips=function(e){return arguments.length?(a=e,v):a},v.tooltipContent=function(e){return arguments.length?(f=e,v):f},v.state=function(e){return arguments.length?(l=e,v):l},v.defaultState=function(e){return arguments.length?(c=e,v):c},v.noData=function(e){return arguments.length?(h=e,v):h},v},e.models.scatter=function(){function I(q){return q.each(function(I){function Q(){if(!g){return !1}var e,i=d3.merge(I.map(function(e,t){return e.values.map(function(e,n){var r=f(e,n),i=l(e,n);return[o(r)+Math.random()*1e-7,u(i)+Math.random()*1e-7,t,n,e]}).filter(function(e,t){return b(e[4],t)})}));if(D===!0){if(x){var a=X.select("defs").selectAll(".nv-point-clips").data([s]).enter();a.append("clipPath").attr("class","nv-point-clips").attr("id","nv-points-clip-"+s);var c=X.select("#nv-points-clip-"+s).selectAll("circle").data(i);c.enter().append("circle").attr("r",T),c.exit().remove(),c.attr("cx",function(e){return e[0]}).attr("cy",function(e){return e[1]}),X.select(".nv-point-paths").attr("clip-path","url(#nv-points-clip-"+s+")")}i.length&&(i.push([o.range()[0]-20,u.range()[0]-20,null,null]),i.push([o.range()[1]+20,u.range()[1]+20,null,null]),i.push([o.range()[0]-20,u.range()[0]+20,null,null]),i.push([o.range()[1]+20,u.range()[1]-20,null,null]));var h=d3.geom.polygon([[-10,-10],[-10,r+10],[n+10,r+10],[n+10,-10]]),p=d3.geom.voronoi(i).map(function(e,t){return{data:h.clip(e),series:i[t][2],point:i[t][3]}}),d=X.select(".nv-point-paths").selectAll("path").data(p);d.enter().append("path").attr("class",function(e,t){return"nv-path-"+t}),d.exit().remove(),d.attr("d",function(e){return e.data.length===0?"M 0 0":"M"+e.data.join("L")+"Z"});var v=function(e,n){if(F){return 0}var r=I[e.series];if(typeof r=="undefined"){return}var i=r.values[e.point];n({point:i,series:r,pos:[o(f(i,e.point))+t.left,u(l(i,e.point))+t.top],seriesIndex:e.series,pointIndex:e.point})};d.on("click",function(e){v(e,_.elementClick)}).on("mouseover",function(e){v(e,_.elementMouseover)}).on("mouseout",function(e,t){v(e,_.elementMouseout)})}else{X.select(".nv-groups").selectAll(".nv-group").selectAll(".nv-point").on("click",function(e,n){if(F||!I[e.series]){return 0}var r=I[e.series],i=r.values[n];_.elementClick({point:i,series:r,pos:[o(f(i,n))+t.left,u(l(i,n))+t.top],seriesIndex:e.series,pointIndex:n})}).on("mouseover",function(e,n){if(F||!I[e.series]){return 0}var r=I[e.series],i=r.values[n];_.elementMouseover({point:i,series:r,pos:[o(f(i,n))+t.left,u(l(i,n))+t.top],seriesIndex:e.series,pointIndex:n})}).on("mouseout",function(e,t){if(F||!I[e.series]){return 0}var n=I[e.series],r=n.values[t];_.elementMouseout({point:r,series:n,seriesIndex:e.series,pointIndex:t})})}F=!1}var q=n-t.left-t.right,R=r-t.top-t.bottom,U=d3.select(this);I.forEach(function(e,t){e.values.forEach(function(e){e.series=t})});var W=N&&C&&A?[]:d3.merge(I.map(function(e){return e.values.map(function(e,t){return{x:f(e,t),y:l(e,t),size:c(e,t)}})}));o.domain(N||d3.extent(W.map(function(e){return e.x}).concat(d))),w&&I[0]?o.range(k||[(q*E+q)/(2*I[0].values.length),q-q*(1+E)/(2*I[0].values.length)]):o.range(k||[0,q]),u.domain(C||d3.extent(W.map(function(e){return e.y}).concat(v))).range(L||[R,0]),a.domain(A||d3.extent(W.map(function(e){return e.size}).concat(m))).range(O||[16,256]);if(o.domain()[0]===o.domain()[1]||u.domain()[0]===u.domain()[1]){M=!0}o.domain()[0]===o.domain()[1]&&(o.domain()[0]?o.domain([o.domain()[0]-o.domain()[0]*0.01,o.domain()[1]+o.domain()[1]*0.01]):o.domain([-1,1])),u.domain()[0]===u.domain()[1]&&(u.domain()[0]?u.domain([u.domain()[0]-u.domain()[0]*0.01,u.domain()[1]+u.domain()[1]*0.01]):u.domain([-1,1])),isNaN(o.domain()[0])&&o.domain([-1,1]),isNaN(u.domain()[0])&&u.domain([-1,1]),P=P||o,H=H||u,B=B||a;var X=U.selectAll("g.nv-wrap.nv-scatter").data([I]),V=X.enter().append("g").attr("class","nvd3 nv-wrap nv-scatter nv-chart-"+s+(M?" nv-single-point":"")),$=V.append("defs"),J=V.append("g"),K=X.select("g");J.append("g").attr("class","nv-groups"),J.append("g").attr("class","nv-point-paths"),X.attr("transform","translate("+t.left+","+t.top+")"),$.append("clipPath").attr("id","nv-edge-clip-"+s).append("rect"),X.select("#nv-edge-clip-"+s+" rect").attr("width",q).attr("height",R),K.attr("clip-path",S?"url(#nv-edge-clip-"+s+")":""),F=!0;var G=X.select(".nv-groups").selectAll(".nv-group").data(function(e){return e},function(e){return e.key});G.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001),G.exit().remove(),G.attr("class",function(e,t){return"nv-group nv-series-"+t}).classed("hover",function(e){return e.hover}),G.transition().style("fill",function(e,t){return i(e,t)}).style("stroke",function(e,t){return i(e,t)}).style("stroke-opacity",1).style("fill-opacity",0.5);if(p){var Y=G.selectAll("circle.nv-point").data(function(e){return e.values},y);Y.enter().append("circle").style("fill",function(e,t){return e.color}).style("stroke",function(e,t){return e.color}).attr("cx",function(t,n){return e.utils.NaNtoZero(P(f(t,n)))}).attr("cy",function(t,n){return e.utils.NaNtoZero(H(l(t,n)))}).attr("r",function(e,t){return Math.sqrt(a(c(e,t))/Math.PI)}),Y.exit().remove(),G.exit().selectAll("path.nv-point").transition().attr("cx",function(t,n){return e.utils.NaNtoZero(o(f(t,n)))}).attr("cy",function(t,n){return e.utils.NaNtoZero(u(l(t,n)))}).remove(),Y.each(function(e,t){d3.select(this).classed("nv-point",!0).classed("nv-point-"+t,!0).classed("hover",!1)}),Y.transition().attr("cx",function(t,n){return e.utils.NaNtoZero(o(f(t,n)))}).attr("cy",function(t,n){return e.utils.NaNtoZero(u(l(t,n)))}).attr("r",function(e,t){return Math.sqrt(a(c(e,t))/Math.PI)})}else{var Y=G.selectAll("path.nv-point").data(function(e){return e.values});Y.enter().append("path").style("fill",function(e,t){return e.color}).style("stroke",function(e,t){return e.color}).attr("transform",function(e,t){return"translate("+P(f(e,t))+","+H(l(e,t))+")"}).attr("d",d3.svg.symbol().type(h).size(function(e,t){return a(c(e,t))})),Y.exit().remove(),G.exit().selectAll("path.nv-point").transition().attr("transform",function(e,t){return"translate("+o(f(e,t))+","+u(l(e,t))+")"}).remove(),Y.each(function(e,t){d3.select(this).classed("nv-point",!0).classed("nv-point-"+t,!0).classed("hover",!1)}),Y.transition().attr("transform",function(e,t){return"translate("+o(f(e,t))+","+u(l(e,t))+")"}).attr("d",d3.svg.symbol().type(h).size(function(e,t){return a(c(e,t))}))}clearTimeout(j),j=setTimeout(Q,300),P=o.copy(),H=u.copy(),B=a.copy()}),I}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=e.utils.defaultColor(),s=Math.floor(Math.random()*100000),o=d3.scale.linear(),u=d3.scale.linear(),a=d3.scale.linear(),f=function(e){return e.x},l=function(e){return e.y},c=function(e){return e.size||1},h=function(e){return e.shape||"circle"},p=!0,d=[],v=[],m=[],g=!0,y=null,b=function(e){return !e.notActive},w=!1,E=0.1,S=!1,x=!0,T=function(){return 25},N=null,C=null,k=null,L=null,A=null,O=null,M=!1,_=d3.dispatch("elementClick","elementMouseover","elementMouseout"),D=!0,P,H,B,j,F=!1;return I.clearHighlights=function(){d3.selectAll(".nv-chart-"+s+" .nv-point.hover").classed("hover",!1)},I.highlightPoint=function(e,t,n){d3.select(".nv-chart-"+s+" .nv-series-"+e+" .nv-point-"+t).classed("hover",n)},_.on("elementMouseover.point",function(e){g&&I.highlightPoint(e.seriesIndex,e.pointIndex,!0)}),_.on("elementMouseout.point",function(e){g&&I.highlightPoint(e.seriesIndex,e.pointIndex,!1)}),I.dispatch=_,I.options=e.utils.optionsFunc.bind(I),I.x=function(e){return arguments.length?(f=d3.functor(e),I):f},I.y=function(e){return arguments.length?(l=d3.functor(e),I):l},I.size=function(e){return arguments.length?(c=d3.functor(e),I):c},I.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,I):t},I.width=function(e){return arguments.length?(n=e,I):n},I.height=function(e){return arguments.length?(r=e,I):r},I.xScale=function(e){return arguments.length?(o=e,I):o},I.yScale=function(e){return arguments.length?(u=e,I):u},I.zScale=function(e){return arguments.length?(a=e,I):a},I.xDomain=function(e){return arguments.length?(N=e,I):N},I.yDomain=function(e){return arguments.length?(C=e,I):C},I.sizeDomain=function(e){return arguments.length?(A=e,I):A},I.xRange=function(e){return arguments.length?(k=e,I):k},I.yRange=function(e){return arguments.length?(L=e,I):L},I.sizeRange=function(e){return arguments.length?(O=e,I):O},I.forceX=function(e){return arguments.length?(d=e,I):d},I.forceY=function(e){return arguments.length?(v=e,I):v},I.forceSize=function(e){return arguments.length?(m=e,I):m},I.interactive=function(e){return arguments.length?(g=e,I):g},I.pointKey=function(e){return arguments.length?(y=e,I):y},I.pointActive=function(e){return arguments.length?(b=e,I):b},I.padData=function(e){return arguments.length?(w=e,I):w},I.padDataOuter=function(e){return arguments.length?(E=e,I):E},I.clipEdge=function(e){return arguments.length?(S=e,I):S},I.clipVoronoi=function(e){return arguments.length?(x=e,I):x},I.useVoronoi=function(e){return arguments.length?(D=e,D===!1&&(x=!1),I):D},I.clipRadius=function(e){return arguments.length?(T=e,I):T},I.color=function(t){return arguments.length?(i=e.utils.getColor(t),I):i},I.shape=function(e){return arguments.length?(h=e,I):h},I.onlyCircles=function(e){return arguments.length?(p=e,I):p},I.id=function(e){return arguments.length?(s=e,I):s},I.singlePoint=function(e){return arguments.length?(M=e,I):M},I},e.models.scatterChart=function(){function F(e){return e.each(function(e){function K(){if(T){return X.select(".nv-point-paths").style("pointer-events","all"),!1}X.select(".nv-point-paths").style("pointer-events","none");var i=d3.mouse(this);h.distortion(x).focus(i[0]),p.distortion(x).focus(i[1]),X.select(".nv-scatterWrap").call(t),b&&X.select(".nv-x.nv-axis").call(n),w&&X.select(".nv-y.nv-axis").call(r),X.select(".nv-distributionX").datum(e.filter(function(e){return !e.disabled})).call(o),X.select(".nv-distributionY").datum(e.filter(function(e){return !e.disabled})).call(u)}var C=d3.select(this),k=this,L=(f||parseInt(C.style("width"))||960)-a.left-a.right,I=(l||parseInt(C.style("height"))||400)-a.top-a.bottom;F.update=function(){C.transition().duration(D).call(F)},F.container=this,A.disabled=e.map(function(e){return !!e.disabled});if(!O){var q;O={};for(q in A){A[q] instanceof Array?O[q]=A[q].slice(0):O[q]=A[q]}}if(!e||!e.length||!e.filter(function(e){return e.values.length}).length){var R=C.selectAll(".nv-noData").data([_]);return R.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),R.attr("x",a.left+L/2).attr("y",a.top+I/2).text(function(e){return e}),F}C.selectAll(".nv-noData").remove(),P=P||h,H=H||p;var U=C.selectAll("g.nv-wrap.nv-scatterChart").data([e]),z=U.enter().append("g").attr("class","nvd3 nv-wrap nv-scatterChart nv-chart-"+t.id()),W=z.append("g"),X=U.select("g");W.append("rect").attr("class","nvd3 nv-background"),W.append("g").attr("class","nv-x nv-axis"),W.append("g").attr("class","nv-y nv-axis"),W.append("g").attr("class","nv-scatterWrap"),W.append("g").attr("class","nv-distWrap"),W.append("g").attr("class","nv-legendWrap"),W.append("g").attr("class","nv-controlsWrap");if(y){var V=S?L/2:L;i.width(V),U.select(".nv-legendWrap").datum(e).call(i),a.top!=i.height()&&(a.top=i.height(),I=(l||parseInt(C.style("height"))||400)-a.top-a.bottom),U.select(".nv-legendWrap").attr("transform","translate("+(L-V)+","+-a.top+")")}S&&(s.width(180).color(["#444"]),X.select(".nv-controlsWrap").datum(j).attr("transform","translate(0,"+-a.top+")").call(s)),U.attr("transform","translate("+a.left+","+a.top+")"),E&&X.select(".nv-y.nv-axis").attr("transform","translate("+L+",0)"),t.width(L).height(I).color(e.map(function(e,t){return e.color||c(e,t)}).filter(function(t,n){return !e[n].disabled})),d!==0&&t.xDomain(null),v!==0&&t.yDomain(null),U.select(".nv-scatterWrap").datum(e.filter(function(e){return !e.disabled})).call(t);if(d!==0){var $=h.domain()[1]-h.domain()[0];t.xDomain([h.domain()[0]-d*$,h.domain()[1]+d*$])}if(v!==0){var J=p.domain()[1]-p.domain()[0];t.yDomain([p.domain()[0]-v*J,p.domain()[1]+v*J])}(v!==0||d!==0)&&U.select(".nv-scatterWrap").datum(e.filter(function(e){return !e.disabled})).call(t),b&&(n.scale(h).ticks(n.ticks()&&n.ticks().length?n.ticks():L/100).tickSize(-I,0),X.select(".nv-x.nv-axis").attr("transform","translate(0,"+p.range()[0]+")").call(n)),w&&(r.scale(p).ticks(r.ticks()&&r.ticks().length?r.ticks():I/36).tickSize(-L,0),X.select(".nv-y.nv-axis").call(r)),m&&(o.getData(t.x()).scale(h).width(L).color(e.map(function(e,t){return e.color||c(e,t)}).filter(function(t,n){return !e[n].disabled})),W.select(".nv-distWrap").append("g").attr("class","nv-distributionX"),X.select(".nv-distributionX").attr("transform","translate(0,"+p.range()[0]+")").datum(e.filter(function(e){return !e.disabled})).call(o)),g&&(u.getData(t.y()).scale(p).width(I).color(e.map(function(e,t){return e.color||c(e,t)}).filter(function(t,n){return !e[n].disabled})),W.select(".nv-distWrap").append("g").attr("class","nv-distributionY"),X.select(".nv-distributionY").attr("transform","translate("+(E?L:-u.size())+",0)").datum(e.filter(function(e){return !e.disabled})).call(u)),d3.fisheye&&(X.select(".nv-background").attr("width",L).attr("height",I),X.select(".nv-background").on("mousemove",K),X.select(".nv-background").on("click",function(){T=!T}),t.dispatch.on("elementClick.freezeFisheye",function(){T=!T})),s.dispatch.on("legendClick",function(e,i){e.disabled=!e.disabled,x=e.disabled?0:2.5,X.select(".nv-background").style("pointer-events",e.disabled?"none":"all"),X.select(".nv-point-paths").style("pointer-events",e.disabled?"all":"none"),e.disabled?(h.distortion(x).focus(0),p.distortion(x).focus(0),X.select(".nv-scatterWrap").call(t),X.select(".nv-x.nv-axis").call(n),X.select(".nv-y.nv-axis").call(r)):T=!1,F.update()}),i.dispatch.on("stateChange",function(e){A.disabled=e.disabled,M.stateChange(A),F.update()}),t.dispatch.on("elementMouseover.tooltip",function(e){d3.select(".nv-chart-"+t.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",function(t,n){return e.pos[1]-I}),d3.select(".nv-chart-"+t.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",e.pos[0]+o.size()),e.pos=[e.pos[0]+a.left,e.pos[1]+a.top],M.tooltipShow(e)}),M.on("tooltipShow",function(e){N&&B(e,k.parentNode)}),M.on("changeState",function(t){typeof t.disabled!="undefined"&&(e.forEach(function(e,n){e.disabled=t.disabled[n]}),A.disabled=t.disabled),F.update()}),P=h.copy(),H=p.copy()}),F}var t=e.models.scatter(),n=e.models.axis(),r=e.models.axis(),i=e.models.legend(),s=e.models.legend(),o=e.models.distribution(),u=e.models.distribution(),a={top:30,right:20,bottom:50,left:75},f=null,l=null,c=e.utils.defaultColor(),h=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):t.xScale(),p=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):t.yScale(),d=0,v=0,m=!1,g=!1,y=!0,b=!0,w=!0,E=!1,S=!!d3.fisheye,x=0,T=!1,N=!0,C=function(e,t,n){return"<strong>"+t+"</strong>"},k=function(e,t,n){return"<strong>"+n+"</strong>"},L=null,A={},O=null,M=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),_="No Data Available.",D=250;t.xScale(h).yScale(p),n.orient("bottom").tickPadding(10),r.orient(E?"right":"left").tickPadding(10),o.axis("x"),u.axis("y"),s.updateState(!1);var P,H,B=function(i,s){var o=i.pos[0]+(s.offsetLeft||0),u=i.pos[1]+(s.offsetTop||0),f=i.pos[0]+(s.offsetLeft||0),l=p.range()[0]+a.top+(s.offsetTop||0),c=h.range()[0]+a.left+(s.offsetLeft||0),d=i.pos[1]+(s.offsetTop||0),v=n.tickFormat()(t.x()(i.point,i.pointIndex)),m=r.tickFormat()(t.y()(i.point,i.pointIndex));C!=null&&e.tooltip.show([f,l],C(i.series.key,v,m,i,F),"n",1,s,"x-nvtooltip"),k!=null&&e.tooltip.show([c,d],k(i.series.key,v,m,i,F),"e",1,s,"y-nvtooltip"),L!=null&&e.tooltip.show([o,u],L(i.series.key,v,m,i,F),i.value<0?"n":"s",null,s)},j=[{key:"Magnify",disabled:!0}];return t.dispatch.on("elementMouseout.tooltip",function(e){M.tooltipHide(e),d3.select(".nv-chart-"+t.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",0),d3.select(".nv-chart-"+t.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",u.size())}),M.on("tooltipHide",function(){N&&e.tooltip.cleanup()}),F.dispatch=M,F.scatter=t,F.legend=i,F.controls=s,F.xAxis=n,F.yAxis=r,F.distX=o,F.distY=u,d3.rebind(F,t,"id","interactive","pointActive","x","y","shape","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","sizeRange","forceX","forceY","forceSize","clipVoronoi","clipRadius","useVoronoi"),F.options=e.utils.optionsFunc.bind(F),F.margin=function(e){return arguments.length?(a.top=typeof e.top!="undefined"?e.top:a.top,a.right=typeof e.right!="undefined"?e.right:a.right,a.bottom=typeof e.bottom!="undefined"?e.bottom:a.bottom,a.left=typeof e.left!="undefined"?e.left:a.left,F):a},F.width=function(e){return arguments.length?(f=e,F):f},F.height=function(e){return arguments.length?(l=e,F):l},F.color=function(t){return arguments.length?(c=e.utils.getColor(t),i.color(c),o.color(c),u.color(c),F):c},F.showDistX=function(e){return arguments.length?(m=e,F):m},F.showDistY=function(e){return arguments.length?(g=e,F):g},F.showControls=function(e){return arguments.length?(S=e,F):S},F.showLegend=function(e){return arguments.length?(y=e,F):y},F.showXAxis=function(e){return arguments.length?(b=e,F):b},F.showYAxis=function(e){return arguments.length?(w=e,F):w},F.rightAlignYAxis=function(e){return arguments.length?(E=e,r.orient(e?"right":"left"),F):E},F.fisheye=function(e){return arguments.length?(x=e,F):x},F.xPadding=function(e){return arguments.length?(d=e,F):d},F.yPadding=function(e){return arguments.length?(v=e,F):v},F.tooltips=function(e){return arguments.length?(N=e,F):N},F.tooltipContent=function(e){return arguments.length?(L=e,F):L},F.tooltipXContent=function(e){return arguments.length?(C=e,F):C},F.tooltipYContent=function(e){return arguments.length?(k=e,F):k},F.state=function(e){return arguments.length?(A=e,F):A},F.defaultState=function(e){return arguments.length?(O=e,F):O},F.noData=function(e){return arguments.length?(_=e,F):_},F.transitionDuration=function(e){return arguments.length?(D=e,F):D},F},e.models.scatterPlusLineChart=function(){function B(e){return e.each(function(e){function $(){if(S){return z.select(".nv-point-paths").style("pointer-events","all"),!1}z.select(".nv-point-paths").style("pointer-events","none");var i=d3.mouse(this);h.distortion(E).focus(i[0]),p.distortion(E).focus(i[1]),z.select(".nv-scatterWrap").datum(e.filter(function(e){return !e.disabled})).call(t),g&&z.select(".nv-x.nv-axis").call(n),y&&z.select(".nv-y.nv-axis").call(r),z.select(".nv-distributionX").datum(e.filter(function(e){return !e.disabled})).call(o),z.select(".nv-distributionY").datum(e.filter(function(e){return !e.disabled})).call(u)}var T=d3.select(this),N=this,C=(f||parseInt(T.style("width"))||960)-a.left-a.right,j=(l||parseInt(T.style("height"))||400)-a.top-a.bottom;B.update=function(){T.transition().duration(M).call(B)},B.container=this,k.disabled=e.map(function(e){return !!e.disabled});if(!L){var F;L={};for(F in k){k[F] instanceof Array?L[F]=k[F].slice(0):L[F]=k[F]}}if(!e||!e.length||!e.filter(function(e){return e.values.length}).length){var I=T.selectAll(".nv-noData").data([O]);return I.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),I.attr("x",a.left+C/2).attr("y",a.top+j/2).text(function(e){return e}),B}T.selectAll(".nv-noData").remove(),h=t.xScale(),p=t.yScale(),_=_||h,D=D||p;var q=T.selectAll("g.nv-wrap.nv-scatterChart").data([e]),R=q.enter().append("g").attr("class","nvd3 nv-wrap nv-scatterChart nv-chart-"+t.id()),U=R.append("g"),z=q.select("g");U.append("rect").attr("class","nvd3 nv-background").style("pointer-events","none"),U.append("g").attr("class","nv-x nv-axis"),U.append("g").attr("class","nv-y nv-axis"),U.append("g").attr("class","nv-scatterWrap"),U.append("g").attr("class","nv-regressionLinesWrap"),U.append("g").attr("class","nv-distWrap"),U.append("g").attr("class","nv-legendWrap"),U.append("g").attr("class","nv-controlsWrap"),q.attr("transform","translate("+a.left+","+a.top+")"),b&&z.select(".nv-y.nv-axis").attr("transform","translate("+C+",0)"),m&&(i.width(C/2),q.select(".nv-legendWrap").datum(e).call(i),a.top!=i.height()&&(a.top=i.height(),j=(l||parseInt(T.style("height"))||400)-a.top-a.bottom),q.select(".nv-legendWrap").attr("transform","translate("+C/2+","+-a.top+")")),w&&(s.width(180).color(["#444"]),z.select(".nv-controlsWrap").datum(H).attr("transform","translate(0,"+-a.top+")").call(s)),t.width(C).height(j).color(e.map(function(e,t){return e.color||c(e,t)}).filter(function(t,n){return !e[n].disabled})),q.select(".nv-scatterWrap").datum(e.filter(function(e){return !e.disabled})).call(t),q.select(".nv-regressionLinesWrap").attr("clip-path","url(#nv-edge-clip-"+t.id()+")");var W=q.select(".nv-regressionLinesWrap").selectAll(".nv-regLines").data(function(e){return e});W.enter().append("g").attr("class","nv-regLines");var X=W.selectAll(".nv-regLine").data(function(e){return[e]}),V=X.enter().append("line").attr("class","nv-regLine").style("stroke-opacity",0);X.transition().attr("x1",h.range()[0]).attr("x2",h.range()[1]).attr("y1",function(e,t){return p(h.domain()[0]*e.slope+e.intercept)}).attr("y2",function(e,t){return p(h.domain()[1]*e.slope+e.intercept)}).style("stroke",function(e,t,n){return c(e,n)}).style("stroke-opacity",function(e,t){return e.disabled||typeof e.slope=="undefined"||typeof e.intercept=="undefined"?0:1}),g&&(n.scale(h).ticks(n.ticks()?n.ticks():C/100).tickSize(-j,0),z.select(".nv-x.nv-axis").attr("transform","translate(0,"+p.range()[0]+")").call(n)),y&&(r.scale(p).ticks(r.ticks()?r.ticks():j/36).tickSize(-C,0),z.select(".nv-y.nv-axis").call(r)),d&&(o.getData(t.x()).scale(h).width(C).color(e.map(function(e,t){return e.color||c(e,t)}).filter(function(t,n){return !e[n].disabled})),U.select(".nv-distWrap").append("g").attr("class","nv-distributionX"),z.select(".nv-distributionX").attr("transform","translate(0,"+p.range()[0]+")").datum(e.filter(function(e){return !e.disabled})).call(o)),v&&(u.getData(t.y()).scale(p).width(j).color(e.map(function(e,t){return e.color||c(e,t)}).filter(function(t,n){return !e[n].disabled})),U.select(".nv-distWrap").append("g").attr("class","nv-distributionY"),z.select(".nv-distributionY").attr("transform","translate("+(b?C:-u.size())+",0)").datum(e.filter(function(e){return !e.disabled})).call(u)),d3.fisheye&&(z.select(".nv-background").attr("width",C).attr("height",j),z.select(".nv-background").on("mousemove",$),z.select(".nv-background").on("click",function(){S=!S}),t.dispatch.on("elementClick.freezeFisheye",function(){S=!S})),s.dispatch.on("legendClick",function(e,i){e.disabled=!e.disabled,E=e.disabled?0:2.5,z.select(".nv-background").style("pointer-events",e.disabled?"none":"all"),z.select(".nv-point-paths").style("pointer-events",e.disabled?"all":"none"),e.disabled?(h.distortion(E).focus(0),p.distortion(E).focus(0),z.select(".nv-scatterWrap").call(t),z.select(".nv-x.nv-axis").call(n),z.select(".nv-y.nv-axis").call(r)):S=!1,B.update()}),i.dispatch.on("stateChange",function(e){k=e,A.stateChange(k),B.update()}),t.dispatch.on("elementMouseover.tooltip",function(e){d3.select(".nv-chart-"+t.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",e.pos[1]-j),d3.select(".nv-chart-"+t.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",e.pos[0]+o.size()),e.pos=[e.pos[0]+a.left,e.pos[1]+a.top],A.tooltipShow(e)}),A.on("tooltipShow",function(e){x&&P(e,N.parentNode)}),A.on("changeState",function(t){typeof t.disabled!="undefined"&&(e.forEach(function(e,n){e.disabled=t.disabled[n]}),k.disabled=t.disabled),B.update()}),_=h.copy(),D=p.copy()}),B}var t=e.models.scatter(),n=e.models.axis(),r=e.models.axis(),i=e.models.legend(),s=e.models.legend(),o=e.models.distribution(),u=e.models.distribution(),a={top:30,right:20,bottom:50,left:75},f=null,l=null,c=e.utils.defaultColor(),h=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):t.xScale(),p=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):t.yScale(),d=!1,v=!1,m=!0,g=!0,y=!0,b=!1,w=!!d3.fisheye,E=0,S=!1,x=!0,T=function(e,t,n){return"<strong>"+t+"</strong>"},N=function(e,t,n){return"<strong>"+n+"</strong>"},C=function(e,t,n,r){return"<h3>"+e+"</h3><p>"+r+"</p>"},k={},L=null,A=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),O="No Data Available.",M=250;t.xScale(h).yScale(p),n.orient("bottom").tickPadding(10),r.orient(b?"right":"left").tickPadding(10),o.axis("x"),u.axis("y"),s.updateState(!1);var _,D,P=function(i,s){var o=i.pos[0]+(s.offsetLeft||0),u=i.pos[1]+(s.offsetTop||0),f=i.pos[0]+(s.offsetLeft||0),l=p.range()[0]+a.top+(s.offsetTop||0),c=h.range()[0]+a.left+(s.offsetLeft||0),d=i.pos[1]+(s.offsetTop||0),v=n.tickFormat()(t.x()(i.point,i.pointIndex)),m=r.tickFormat()(t.y()(i.point,i.pointIndex));T!=null&&e.tooltip.show([f,l],T(i.series.key,v,m,i,B),"n",1,s,"x-nvtooltip"),N!=null&&e.tooltip.show([c,d],N(i.series.key,v,m,i,B),"e",1,s,"y-nvtooltip"),C!=null&&e.tooltip.show([o,u],C(i.series.key,v,m,i.point.tooltip,i,B),i.value<0?"n":"s",null,s)},H=[{key:"Magnify",disabled:!0}];return t.dispatch.on("elementMouseout.tooltip",function(e){A.tooltipHide(e),d3.select(".nv-chart-"+t.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",0),d3.select(".nv-chart-"+t.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",u.size())}),A.on("tooltipHide",function(){x&&e.tooltip.cleanup()}),B.dispatch=A,B.scatter=t,B.legend=i,B.controls=s,B.xAxis=n,B.yAxis=r,B.distX=o,B.distY=u,d3.rebind(B,t,"id","interactive","pointActive","x","y","shape","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","sizeRange","forceX","forceY","forceSize","clipVoronoi","clipRadius","useVoronoi"),B.options=e.utils.optionsFunc.bind(B),B.margin=function(e){return arguments.length?(a.top=typeof e.top!="undefined"?e.top:a.top,a.right=typeof e.right!="undefined"?e.right:a.right,a.bottom=typeof e.bottom!="undefined"?e.bottom:a.bottom,a.left=typeof e.left!="undefined"?e.left:a.left,B):a},B.width=function(e){return arguments.length?(f=e,B):f},B.height=function(e){return arguments.length?(l=e,B):l},B.color=function(t){return arguments.length?(c=e.utils.getColor(t),i.color(c),o.color(c),u.color(c),B):c},B.showDistX=function(e){return arguments.length?(d=e,B):d},B.showDistY=function(e){return arguments.length?(v=e,B):v},B.showControls=function(e){return arguments.length?(w=e,B):w},B.showLegend=function(e){return arguments.length?(m=e,B):m},B.showXAxis=function(e){return arguments.length?(g=e,B):g},B.showYAxis=function(e){return arguments.length?(y=e,B):y},B.rightAlignYAxis=function(e){return arguments.length?(b=e,r.orient(e?"right":"left"),B):b},B.fisheye=function(e){return arguments.length?(E=e,B):E},B.tooltips=function(e){return arguments.length?(x=e,B):x},B.tooltipContent=function(e){return arguments.length?(C=e,B):C},B.tooltipXContent=function(e){return arguments.length?(T=e,B):T},B.tooltipYContent=function(e){return arguments.length?(N=e,B):N},B.state=function(e){return arguments.length?(k=e,B):k},B.defaultState=function(e){return arguments.length?(L=e,B):L},B.noData=function(e){return arguments.length?(O=e,B):O},B.transitionDuration=function(e){return arguments.length?(M=e,B):M},B},e.models.sparkline=function(){function d(e){return e.each(function(e){var i=n-t.left-t.right,d=r-t.top-t.bottom,v=d3.select(this);s.domain(l||d3.extent(e,u)).range(h||[0,i]),o.domain(c||d3.extent(e,a)).range(p||[d,0]);var m=v.selectAll("g.nv-wrap.nv-sparkline").data([e]),g=m.enter().append("g").attr("class","nvd3 nv-wrap nv-sparkline"),b=g.append("g"),w=m.select("g");m.attr("transform","translate("+t.left+","+t.top+")");var E=m.selectAll("path").data(function(e){return[e]});E.enter().append("path"),E.exit().remove(),E.style("stroke",function(e,t){return e.color||f(e,t)}).attr("d",d3.svg.line().x(function(e,t){return s(u(e,t))}).y(function(e,t){return o(a(e,t))}));var S=m.selectAll("circle.nv-point").data(function(e){function n(t){if(t!=-1){var n=e[t];return n.pointIndex=t,n}return null}var t=e.map(function(e,t){return a(e,t)}),r=n(t.lastIndexOf(o.domain()[1])),i=n(t.indexOf(o.domain()[0])),s=n(t.length-1);return[i,r,s].filter(function(e){return e!=null})});S.enter().append("circle"),S.exit().remove(),S.attr("cx",function(e,t){return s(u(e,e.pointIndex))}).attr("cy",function(e,t){return o(a(e,e.pointIndex))}).attr("r",2).attr("class",function(e,t){return u(e,e.pointIndex)==s.domain()[1]?"nv-point nv-currentValue":a(e,e.pointIndex)==o.domain()[0]?"nv-point nv-minValue":"nv-point nv-maxValue"})}),d}var t={top:2,right:0,bottom:2,left:0},n=400,r=32,i=!0,s=d3.scale.linear(),o=d3.scale.linear(),u=function(e){return e.x},a=function(e){return e.y},f=e.utils.getColor(["#000"]),l,c,h,p;return d.options=e.utils.optionsFunc.bind(d),d.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,d):t},d.width=function(e){return arguments.length?(n=e,d):n},d.height=function(e){return arguments.length?(r=e,d):r},d.x=function(e){return arguments.length?(u=d3.functor(e),d):u},d.y=function(e){return arguments.length?(a=d3.functor(e),d):a},d.xScale=function(e){return arguments.length?(s=e,d):s},d.yScale=function(e){return arguments.length?(o=e,d):o},d.xDomain=function(e){return arguments.length?(l=e,d):l},d.yDomain=function(e){return arguments.length?(c=e,d):c},d.xRange=function(e){return arguments.length?(h=e,d):h},d.yRange=function(e){return arguments.length?(p=e,d):p},d.animate=function(e){return arguments.length?(i=e,d):i},d.color=function(t){return arguments.length?(f=e.utils.getColor(t),d):f},d},e.models.sparklinePlus=function(){function v(e){return e.each(function(c){function O(){if(a){return}var e=C.selectAll(".nv-hoverValue").data(u),r=e.enter().append("g").attr("class","nv-hoverValue").style("stroke-opacity",0).style("fill-opacity",0);e.exit().transition().duration(250).style("stroke-opacity",0).style("fill-opacity",0).remove(),e.attr("transform",function(e){return"translate("+s(t.x()(c[e],e))+",0)"}).transition().duration(250).style("stroke-opacity",1).style("fill-opacity",1);if(!u.length){return}r.append("line").attr("x1",0).attr("y1",-n.top).attr("x2",0).attr("y2",b),r.append("text").attr("class","nv-xValue").attr("x",-6).attr("y",-n.top).attr("text-anchor","end").attr("dy",".9em"),C.select(".nv-hoverValue .nv-xValue").text(f(t.x()(c[u[0]],u[0]))),r.append("text").attr("class","nv-yValue").attr("x",6).attr("y",-n.top).attr("text-anchor","start").attr("dy",".9em"),C.select(".nv-hoverValue .nv-yValue").text(l(t.y()(c[u[0]],u[0])))}function M(){function r(e,n){var r=Math.abs(t.x()(e[0],0)-n),i=0;for(var s=0;s<e.length;s++){Math.abs(t.x()(e[s],s)-n)<r&&(r=Math.abs(t.x()(e[s],s)-n),i=s)}return i}if(a){return}var e=d3.mouse(this)[0]-n.left;u=[r(c,Math.round(s.invert(e)))],O()}var m=d3.select(this),g=(r||parseInt(m.style("width"))||960)-n.left-n.right,b=(i||parseInt(m.style("height"))||400)-n.top-n.bottom;v.update=function(){v(e)},v.container=this;if(!c||!c.length){var w=m.selectAll(".nv-noData").data([d]);return w.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),w.attr("x",n.left+g/2).attr("y",n.top+b/2).text(function(e){return e}),v}m.selectAll(".nv-noData").remove();var E=t.y()(c[c.length-1],c.length-1);s=t.xScale(),o=t.yScale();var S=m.selectAll("g.nv-wrap.nv-sparklineplus").data([c]),T=S.enter().append("g").attr("class","nvd3 nv-wrap nv-sparklineplus"),N=T.append("g"),C=S.select("g");N.append("g").attr("class","nv-sparklineWrap"),N.append("g").attr("class","nv-valueWrap"),N.append("g").attr("class","nv-hoverArea"),S.attr("transform","translate("+n.left+","+n.top+")");var k=C.select(".nv-sparklineWrap");t.width(g).height(b),k.call(t);var L=C.select(".nv-valueWrap"),A=L.selectAll(".nv-currentValue").data([E]);A.enter().append("text").attr("class","nv-currentValue").attr("dx",p?-8:8).attr("dy",".9em").style("text-anchor",p?"end":"start"),A.attr("x",g+(p?n.right:0)).attr("y",h?function(e){return o(e)}:0).style("fill",t.color()(c[c.length-1],c.length-1)).text(l(E)),N.select(".nv-hoverArea").append("rect").on("mousemove",M).on("click",function(){a=!a}).on("mouseout",function(){u=[],O()}),C.select(".nv-hoverArea rect").attr("transform",function(e){return"translate("+-n.left+","+-n.top+")"}).attr("width",g+n.left+n.right).attr("height",b+n.top)}),v}var t=e.models.sparkline(),n={top:15,right:100,bottom:10,left:50},r=null,i=null,s,o,u=[],a=!1,f=d3.format(",r"),l=d3.format(",.2f"),c=!0,h=!0,p=!1,d="No Data Available.";return v.sparkline=t,d3.rebind(v,t,"x","y","xScale","yScale","color"),v.options=e.utils.optionsFunc.bind(v),v.margin=function(e){return arguments.length?(n.top=typeof e.top!="undefined"?e.top:n.top,n.right=typeof e.right!="undefined"?e.right:n.right,n.bottom=typeof e.bottom!="undefined"?e.bottom:n.bottom,n.left=typeof e.left!="undefined"?e.left:n.left,v):n},v.width=function(e){return arguments.length?(r=e,v):r},v.height=function(e){return arguments.length?(i=e,v):i},v.xTickFormat=function(e){return arguments.length?(f=e,v):f},v.yTickFormat=function(e){return arguments.length?(l=e,v):l},v.showValue=function(e){return arguments.length?(c=e,v):c},v.alignValue=function(e){return arguments.length?(h=e,v):h},v.rightAlignValue=function(e){return arguments.length?(p=e,v):p},v.noData=function(e){return arguments.length?(d=e,v):d},v},e.models.stackedArea=function(){function g(e){return e.each(function(e){var a=n-t.left-t.right,b=r-t.top-t.bottom,w=d3.select(this);p=v.xScale(),d=v.yScale();var E=e;e=e.map(function(e,t){return e.seriesIndex=t,e.values=e.values.map(function(e,n){return e.index=n,e.seriesIndex=t,e}),e});var S=e.filter(function(e){return !e.disabled});e=d3.layout.stack().order(l).offset(f).values(function(e){return e.values}).x(o).y(u).out(function(e,t,n){var r=u(e)===0?0:n;e.display={y:r,y0:t}})(S);var T=w.selectAll("g.nv-wrap.nv-stackedarea").data([e]),N=T.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedarea"),C=N.append("defs"),k=N.append("g"),L=T.select("g");k.append("g").attr("class","nv-areaWrap"),k.append("g").attr("class","nv-scatterWrap"),T.attr("transform","translate("+t.left+","+t.top+")"),v.width(a).height(b).x(o).y(function(e){return e.display.y+e.display.y0}).forceY([0]).color(e.map(function(e,t){return e.color||i(e,e.seriesIndex)}));var A=L.select(".nv-scatterWrap").datum(e);A.call(v),C.append("clipPath").attr("id","nv-edge-clip-"+s).append("rect"),T.select("#nv-edge-clip-"+s+" rect").attr("width",a).attr("height",b),L.attr("clip-path",h?"url(#nv-edge-clip-"+s+")":"");var O=d3.svg.area().x(function(e,t){return p(o(e,t))}).y0(function(e){return d(e.display.y0)}).y1(function(e){return d(e.display.y+e.display.y0)}).interpolate(c),M=d3.svg.area().x(function(e,t){return p(o(e,t))}).y0(function(e){return d(e.display.y0)}).y1(function(e){return d(e.display.y0)}),_=L.select(".nv-areaWrap").selectAll("path.nv-area").data(function(e){return e});_.enter().append("path").attr("class",function(e,t){return"nv-area nv-area-"+t}).attr("d",function(e,t){return M(e.values,e.seriesIndex)}).on("mouseover",function(e,t){d3.select(this).classed("hover",!0),m.areaMouseover({point:e,series:e.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:t})}).on("mouseout",function(e,t){d3.select(this).classed("hover",!1),m.areaMouseout({point:e,series:e.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:t})}).on("click",function(e,t){d3.select(this).classed("hover",!1),m.areaClick({point:e,series:e.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:t})}),_.exit().transition().attr("d",function(e,t){return M(e.values,t)}).remove(),_.style("fill",function(e,t){return e.color||i(e,e.seriesIndex)}).style("stroke",function(e,t){return e.color||i(e,e.seriesIndex)}),_.transition().attr("d",function(e,t){return O(e.values,t)}),v.dispatch.on("elementMouseover.area",function(e){L.select(".nv-chart-"+s+" .nv-area-"+e.seriesIndex).classed("hover",!0)}),v.dispatch.on("elementMouseout.area",function(e){L.select(".nv-chart-"+s+" .nv-area-"+e.seriesIndex).classed("hover",!1)}),g.d3_stackedOffset_stackPercent=function(e){var t=e.length,n=e[0].length,r=1/t,i,s,o,a=[];for(s=0;s<n;++s){for(i=0,o=0;i<E.length;i++){o+=u(E[i].values[s])}if(o){for(i=0;i<t;i++){e[i][s][1]/=o}}else{for(i=0;i<t;i++){e[i][s][1]=r}}}for(s=0;s<n;++s){a[s]=0}return a}}),g}var t={top:0,right:0,bottom:0,left:0},n=960,r=500,i=e.utils.defaultColor(),s=Math.floor(Math.random()*100000),o=function(e){return e.x},u=function(e){return e.y},a="stack",f="zero",l="default",c="linear",h=!1,p,d,v=e.models.scatter(),m=d3.dispatch("tooltipShow","tooltipHide","areaClick","areaMouseover","areaMouseout");return v.size(2.2).sizeDomain([2.2,2.2]),v.dispatch.on("elementClick.area",function(e){m.areaClick(e)}),v.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+t.left,e.pos[1]+t.top],m.tooltipShow(e)}),v.dispatch.on("elementMouseout.tooltip",function(e){m.tooltipHide(e)}),g.dispatch=m,g.scatter=v,d3.rebind(g,v,"interactive","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","forceX","forceY","forceSize","clipVoronoi","useVoronoi","clipRadius","highlightPoint","clearHighlights"),g.options=e.utils.optionsFunc.bind(g),g.x=function(e){return arguments.length?(o=d3.functor(e),g):o},g.y=function(e){return arguments.length?(u=d3.functor(e),g):u},g.margin=function(e){return arguments.length?(t.top=typeof e.top!="undefined"?e.top:t.top,t.right=typeof e.right!="undefined"?e.right:t.right,t.bottom=typeof e.bottom!="undefined"?e.bottom:t.bottom,t.left=typeof e.left!="undefined"?e.left:t.left,g):t},g.width=function(e){return arguments.length?(n=e,g):n},g.height=function(e){return arguments.length?(r=e,g):r},g.clipEdge=function(e){return arguments.length?(h=e,g):h},g.color=function(t){return arguments.length?(i=e.utils.getColor(t),g):i},g.offset=function(e){return arguments.length?(f=e,g):f},g.order=function(e){return arguments.length?(l=e,g):l},g.style=function(e){if(!arguments.length){return a}a=e;switch(a){case"stack":g.offset("zero"),g.order("default");break;case"stream":g.offset("wiggle"),g.order("inside-out");break;case"stream-center":g.offset("silhouette"),g.order("inside-out");break;case"expand":g.offset("expand"),g.order("default");break;case"stack_percent":g.offset(g.d3_stackedOffset_stackPercent),g.order("default")}return g},g.interpolate=function(e){return arguments.length?(c=e,g):c},g},e.models.stackedAreaChart=function(){function M(y){return y.each(function(y){var _=d3.select(this),D=this,P=(a||parseInt(_.style("width"))||960)-u.left-u.right,H=(f||parseInt(_.style("height"))||400)-u.top-u.bottom;M.update=function(){_.transition().duration(A).call(M)},M.container=this,S.disabled=y.map(function(e){return !!e.disabled});if(!x){var B;x={};for(B in S){S[B] instanceof Array?x[B]=S[B].slice(0):x[B]=S[B]}}if(!y||!y.length||!y.filter(function(e){return e.values.length}).length){var j=_.selectAll(".nv-noData").data([T]);return j.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle"),j.attr("x",u.left+P/2).attr("y",u.top+H/2).text(function(e){return e}),M}_.selectAll(".nv-noData").remove(),b=t.xScale(),w=t.yScale();var F=_.selectAll("g.nv-wrap.nv-stackedAreaChart").data([y]),I=F.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedAreaChart").append("g"),q=F.select("g");I.append("rect").style("opacity",0),I.append("g").attr("class","nv-x nv-axis"),I.append("g").attr("class","nv-y nv-axis"),I.append("g").attr("class","nv-stackedWrap"),I.append("g").attr("class","nv-legendWrap"),I.append("g").attr("class","nv-controlsWrap"),I.append("g").attr("class","nv-interactive"),q.select("rect").attr("width",P).attr("height",H);if(h){var R=c?P-C:P;i.width(R),q.select(".nv-legendWrap").datum(y).call(i),u.top!=i.height()&&(u.top=i.height(),H=(f||parseInt(_.style("height"))||400)-u.top-u.bottom),q.select(".nv-legendWrap").attr("transform","translate("+(P-R)+","+-u.top+")")}if(c){var U=[{key:L.stacked||"Stacked",metaKey:"Stacked",disabled:t.style()!="stack",style:"stack"},{key:L.stream||"Stream",metaKey:"Stream",disabled:t.style()!="stream",style:"stream"},{key:L.expanded||"Expanded",metaKey:"Expanded",disabled:t.style()!="expand",style:"expand"},{key:L.stack_percent||"Stack %",metaKey:"Stack_Percent",disabled:t.style()!="stack_percent",style:"stack_percent"}];C=k.length/3*260,U=U.filter(function(e){return k.indexOf(e.metaKey)!==-1}),s.width(C).color(["#444","#444","#444"]),q.select(".nv-controlsWrap").datum(U).call(s),u.top!=Math.max(s.height(),i.height())&&(u.top=Math.max(s.height(),i.height()),H=(f||parseInt(_.style("height"))||400)-u.top-u.bottom),q.select(".nv-controlsWrap").attr("transform","translate(0,"+-u.top+")")}F.attr("transform","translate("+u.left+","+u.top+")"),v&&q.select(".nv-y.nv-axis").attr("transform","translate("+P+",0)"),m&&(o.width(P).height(H).margin({left:u.left,top:u.top}).svgContainer(_).xScale(b),F.select(".nv-interactive").call(o)),t.width(P).height(H);var z=q.select(".nv-stackedWrap").datum(y);z.transition().call(t),p&&(n.scale(b).ticks(P/100).tickSize(-H,0),q.select(".nv-x.nv-axis").attr("transform","translate(0,"+H+")"),q.select(".nv-x.nv-axis").transition().duration(0).call(n)),d&&(r.scale(w).ticks(t.offset()=="wiggle"?0:H/36).tickSize(-P,0).setTickFormat(t.style()=="expand"||t.style()=="stack_percent"?d3.format("%"):E),q.select(".nv-y.nv-axis").transition().duration(0).call(r)),t.dispatch.on("areaClick.toggle",function(e){y.filter(function(e){return !e.disabled}).length===1?y=y.map(function(e){return e.disabled=!1,e}):y=y.map(function(t,n){return t.disabled=n!=e.seriesIndex,t}),S.disabled=y.map(function(e){return !!e.disabled}),N.stateChange(S),M.update()}),i.dispatch.on("stateChange",function(e){S.disabled=e.disabled,N.stateChange(S),M.update()}),s.dispatch.on("legendClick",function(e,n){if(!e.disabled){return}U=U.map(function(e){return e.disabled=!0,e}),e.disabled=!1,t.style(e.style),S.style=t.style(),N.stateChange(S),M.update()}),o.dispatch.on("elementMousemove",function(i){t.clearHighlights();var s,a,f,c=[];y.filter(function(e,t){return e.seriesIndex=t,!e.disabled}).forEach(function(n,r){a=e.interactiveBisect(n.values,i.pointXValue,M.x()),t.highlightPoint(r,a,!0);var o=n.values[a];if(typeof o=="undefined"){return}typeof s=="undefined"&&(s=o),typeof f=="undefined"&&(f=M.xScale()(M.x()(o,a)));var u=t.style()=="expand"?o.display.y:M.y()(o,a);c.push({key:n.key,value:u,color:l(n,n.seriesIndex),stackedValue:o.display})}),c.reverse();if(c.length>2){var h=M.yScale().invert(i.mouseY),p=Infinity,d=null;c.forEach(function(e,t){if(h>=e.stackedValue.y0&&h<=e.stackedValue.y0+e.stackedValue.y){d=t;return}}),d!=null&&(c[d].highlight=!0)}var v=n.tickFormat()(M.x()(s,a)),m=t.style()=="expand"?function(e,t){return d3.format(".1%")(e)}:function(e,t){return r.tickFormat()(e)};o.tooltip.position({left:f+u.left,top:i.mouseY+u.top}).chartContainer(D.parentNode).enabled(g).valueFormatter(m).data({value:v,series:c})(),o.renderGuideLine(f)}),o.dispatch.on("elementMouseout",function(e){N.tooltipHide(),t.clearHighlights()}),N.on("tooltipShow",function(e){g&&O(e,D.parentNode)}),N.on("changeState",function(e){typeof e.disabled!="undefined"&&(y.forEach(function(t,n){t.disabled=e.disabled[n]}),S.disabled=e.disabled),typeof e.style!="undefined"&&t.style(e.style),M.update()})}),M}var t=e.models.stackedArea(),n=e.models.axis(),r=e.models.axis(),i=e.models.legend(),s=e.models.legend(),o=e.interactiveGuideline(),u={top:30,right:25,bottom:50,left:60},a=null,f=null,l=e.utils.defaultColor(),c=!0,h=!0,p=!0,d=!0,v=!1,m=!1,g=!0,y=function(e,t,n,r,i){return"<h3>"+e+"</h3><p>"+n+" on "+t+"</p>"},b,w,E=d3.format(",.2f"),S={style:t.style()},x=null,T="No Data Available.",N=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),C=250,k=["Stacked","Stream","Expanded"],L={},A=250;n.orient("bottom").tickPadding(7),r.orient(v?"right":"left"),s.updateState(!1);var O=function(i,s){var o=i.pos[0]+(s.offsetLeft||0),u=i.pos[1]+(s.offsetTop||0),a=n.tickFormat()(t.x()(i.point,i.pointIndex)),f=r.tickFormat()(t.y()(i.point,i.pointIndex)),l=y(i.series.key,a,f,i,M);e.tooltip.show([o,u],l,i.value<0?"n":"s",null,s)};return t.dispatch.on("tooltipShow",function(e){e.pos=[e.pos[0]+u.left,e.pos[1]+u.top],N.tooltipShow(e)}),t.dispatch.on("tooltipHide",function(e){N.tooltipHide(e)}),N.on("tooltipHide",function(){g&&e.tooltip.cleanup()}),M.dispatch=N,M.stacked=t,M.legend=i,M.controls=s,M.xAxis=n,M.yAxis=r,M.interactiveLayer=o,d3.rebind(M,t,"x","y","size","xScale","yScale","xDomain","yDomain","xRange","yRange","sizeDomain","interactive","useVoronoi","offset","order","style","clipEdge","forceX","forceY","forceSize","interpolate"),M.options=e.utils.optionsFunc.bind(M),M.margin=function(e){return arguments.length?(u.top=typeof e.top!="undefined"?e.top:u.top,u.right=typeof e.right!="undefined"?e.right:u.right,u.bottom=typeof e.bottom!="undefined"?e.bottom:u.bottom,u.left=typeof e.left!="undefined"?e.left:u.left,M):u},M.width=function(e){return arguments.length?(a=e,M):a},M.height=function(e){return arguments.length?(f=e,M):f},M.color=function(n){return arguments.length?(l=e.utils.getColor(n),i.color(l),t.color(l),M):l},M.showControls=function(e){return arguments.length?(c=e,M):c},M.showLegend=function(e){return arguments.length?(h=e,M):h},M.showXAxis=function(e){return arguments.length?(p=e,M):p},M.showYAxis=function(e){return arguments.length?(d=e,M):d},M.rightAlignYAxis=function(e){return arguments.length?(v=e,r.orient(e?"right":"left"),M):v},M.useInteractiveGuideline=function(e){return arguments.length?(m=e,e===!0&&(M.interactive(!1),M.useVoronoi(!1)),M):m},M.tooltip=function(e){return arguments.length?(y=e,M):y},M.tooltips=function(e){return arguments.length?(g=e,M):g},M.tooltipContent=function(e){return arguments.length?(y=e,M):y},M.state=function(e){return arguments.length?(S=e,M):S},M.defaultState=function(e){return arguments.length?(x=e,M):x},M.noData=function(e){return arguments.length?(T=e,M):T},M.transitionDuration=function(e){return arguments.length?(A=e,M):A},M.controlsData=function(e){return arguments.length?(k=e,M):k},M.controlLabels=function(e){return arguments.length?typeof e!="object"?L:(L=e,M):L},r.setTickFormat=r.tickFormat,r.tickFormat=function(e){return arguments.length?(E=e,r):E},M}})();var nv=window.nv||{};nv.version="1.1.13b";nv.dev=true;window.nv=nv;nv.tooltip={};nv.utils=nv.utils||{};nv.models={};nv.charts={};nv.graphs=[];nv.logs={};nv.dispatch=d3.dispatch("render_start","render_end");if(nv.dev){nv.dispatch.on("render_start",function(e){nv.logs.startTime=+new Date()});nv.dispatch.on("render_end",function(e){nv.logs.endTime=+new Date();nv.logs.totalTime=nv.logs.endTime-nv.logs.startTime;nv.log("total",nv.logs.totalTime)})}nv.log=function(){if(nv.dev&&console.log&&console.log.apply){console.log.apply(console,arguments)}else{if(nv.dev&&typeof console.log=="function"&&Function.prototype.bind){var log=Function.prototype.bind.call(console.log,console);log.apply(console,arguments)}}return arguments[arguments.length-1]};nv.render=function render(step){step=step||1;nv.render.active=true;nv.dispatch.render_start();setTimeout(function(){var chart,graph;for(var i=0;i<step&&(graph=nv.render.queue[i]);i++){chart=graph.generate();if(typeof graph.callback==typeof(Function)){graph.callback(chart)}nv.graphs.push(chart)}nv.render.queue.splice(0,i);if(nv.render.queue.length){setTimeout(arguments.callee,0)}else{nv.render.active=false;nv.dispatch.render_end()}},0)};nv.render.active=false;nv.render.queue=[];nv.addGraph=function(obj){if(typeof arguments[0]===typeof(Function)){obj={generate:arguments[0],callback:arguments[1]}}nv.render.queue.push(obj);if(!nv.render.active){nv.render()}};nv.identity=function(d){return d};nv.strip=function(s){return s.replace(/(\s|&)/g,"")};function daysInMonth(month,year){return(new Date(year,month+1,0)).getDate()}function d3_time_range(floor,step,number){return function(t0,t1,dt){var time=floor(t0),times=[];if(time<t0){step(time)}if(dt>1){while(time<t1){var date=new Date(+time);if((number(date)%dt===0)){times.push(date)}step(time)}}else{while(time<t1){times.push(new Date(+time));step(time)}}return times}}d3.time.monthEnd=function(date){return new Date(date.getFullYear(),date.getMonth(),0)};d3.time.monthEnds=d3_time_range(d3.time.monthEnd,function(date){date.setUTCDate(date.getUTCDate()+1);date.setDate(daysInMonth(date.getMonth()+1,date.getFullYear()))},function(date){return date.getMonth()});nv.interactiveGuideline=function(){var tooltip=nv.models.tooltip();var width=null,height=null,margin={left:0,top:0},xScale=d3.scale.linear(),yScale=d3.scale.linear(),dispatch=d3.dispatch("elementMousemove","elementMouseout","elementDblclick"),showGuideLine=true,svgContainer=null;var isMSIE=navigator.userAgent.indexOf("MSIE")!==-1;function layer(selection){selection.each(function(data){var container=d3.select(this);var availableWidth=(width||960),availableHeight=(height||400);var wrap=container.selectAll("g.nv-wrap.nv-interactiveLineLayer").data([data]);var wrapEnter=wrap.enter().append("g").attr("class"," nv-wrap nv-interactiveLineLayer");wrapEnter.append("g").attr("class","nv-interactiveGuideLine");if(!svgContainer){return}function mouseHandler(){var d3mouse=d3.mouse(this);var mouseX=d3mouse[0];var mouseY=d3mouse[1];var subtractMargin=true;var mouseOutAnyReason=false;if(isMSIE){mouseX=d3.event.offsetX;mouseY=d3.event.offsetY;if(d3.event.target.tagName!=="svg"){subtractMargin=false}if(d3.event.target.className.baseVal.match("nv-legend")){mouseOutAnyReason=true}}if(subtractMargin){mouseX-=margin.left;mouseY-=margin.top}if(mouseX<0||mouseY<0||mouseX>availableWidth||mouseY>availableHeight||(d3.event.relatedTarget&&d3.event.relatedTarget.ownerSVGElement===undefined)||mouseOutAnyReason){if(isMSIE){if(d3.event.relatedTarget&&d3.event.relatedTarget.ownerSVGElement===undefined&&d3.event.relatedTarget.className.match(tooltip.nvPointerEventsClass)){return}}dispatch.elementMouseout({mouseX:mouseX,mouseY:mouseY});layer.renderGuideLine(null);return}var pointXValue=xScale.invert(mouseX);dispatch.elementMousemove({mouseX:mouseX,mouseY:mouseY,pointXValue:pointXValue});if(d3.event.type==="dblclick"){dispatch.elementDblclick({mouseX:mouseX,mouseY:mouseY,pointXValue:pointXValue})}}svgContainer.on("mousemove",mouseHandler,true).on("mouseout",mouseHandler,true).on("dblclick",mouseHandler);layer.renderGuideLine=function(x){if(!showGuideLine){return}var line=wrap.select(".nv-interactiveGuideLine").selectAll("line").data((x!=null)?[nv.utils.NaNtoZero(x)]:[],String);line.enter().append("line").attr("class","nv-guideline").attr("x1",function(d){return d}).attr("x2",function(d){return d}).attr("y1",availableHeight).attr("y2",0);line.exit().remove()}})}layer.dispatch=dispatch;layer.tooltip=tooltip;layer.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.left=typeof _.left!="undefined"?_.left:margin.left;return layer};layer.width=function(_){if(!arguments.length){return width}width=_;return layer};layer.height=function(_){if(!arguments.length){return height}height=_;return layer};layer.xScale=function(_){if(!arguments.length){return xScale}xScale=_;return layer};layer.showGuideLine=function(_){if(!arguments.length){return showGuideLine}showGuideLine=_;return layer};layer.svgContainer=function(_){if(!arguments.length){return svgContainer}svgContainer=_;return layer};return layer};nv.interactiveBisect=function(values,searchVal,xAccessor){if(!values instanceof Array){return null}if(typeof xAccessor!=="function"){xAccessor=function(d,i){return d.x}}var bisect=d3.bisector(xAccessor).left;var index=d3.max([0,bisect(values,searchVal)-1]);var currentValue=xAccessor(values[index],index);if(typeof currentValue==="undefined"){currentValue=index}if(currentValue===searchVal){return index}var nextIndex=d3.min([index+1,values.length-1]);var nextValue=xAccessor(values[nextIndex],nextIndex);if(typeof nextValue==="undefined"){nextValue=nextIndex}if(Math.abs(nextValue-searchVal)>=Math.abs(currentValue-searchVal)){return index}else{return nextIndex}};nv.nearestValueIndex=function(values,searchVal,threshold){var yDistMax=Infinity,indexToHighlight=null;values.forEach(function(d,i){var delta=Math.abs(searchVal-d);if(delta<=yDistMax&&delta<threshold){yDistMax=delta;indexToHighlight=i}});return indexToHighlight};nv.models.axis=function(){var axis=d3.svg.axis();var margin={top:0,right:0,bottom:0,left:0},width=75,height=60,scale=d3.scale.linear(),axisLabelText=null,showMaxMin=true,highlightZero=true,rotateLabels=0,rotateYLabel=true,staggerLabels=false,isOrdinal=false,ticks=null,axisLabelDistance=12;axis.scale(scale).orient("bottom").tickFormat(function(d){return d});var scale0;function chart(selection){selection.each(function(data){var container=d3.select(this);var wrap=container.selectAll("g.nv-wrap.nv-axis").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-axis");var gEnter=wrapEnter.append("g");var g=wrap.select("g");if(ticks!==null){axis.ticks(ticks)}else{if(axis.orient()=="top"||axis.orient()=="bottom"){axis.ticks(Math.abs(scale.range()[1]-scale.range()[0])/100)}}g.transition().call(axis);scale0=scale0||axis.scale();var fmt=axis.tickFormat();if(fmt==null){fmt=scale0.tickFormat()}var axisLabel=g.selectAll("text.nv-axislabel").data([axisLabelText||null]);axisLabel.exit().remove();switch(axis.orient()){case"top":axisLabel.enter().append("text").attr("class","nv-axislabel");var w=(scale.range().length==2)?scale.range()[1]:(scale.range()[scale.range().length-1]+(scale.range()[1]-scale.range()[0]));axisLabel.attr("text-anchor","middle").attr("y",0).attr("x",w/2);if(showMaxMin){var axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data(scale.domain());axisMaxMin.enter().append("g").attr("class","nv-axisMaxMin").append("text");axisMaxMin.exit().remove();axisMaxMin.attr("transform",function(d,i){return"translate("+scale(d)+",0)"}).select("text").attr("dy","0em").attr("y",-axis.tickPadding()).attr("text-anchor","middle").text(function(d,i){var v=fmt(d);return(""+v).match("NaN")?"":v});axisMaxMin.transition().attr("transform",function(d,i){return"translate("+scale.range()[i]+",0)"})}break;case"bottom":var xLabelMargin=36;var maxTextWidth=30;var xTicks=g.selectAll("g").select("text");if(rotateLabels%360){xTicks.each(function(d,i){var width=this.getBBox().width;if(width>maxTextWidth){maxTextWidth=width}});var sin=Math.abs(Math.sin(rotateLabels*Math.PI/180));var xLabelMargin=(sin?sin*maxTextWidth:maxTextWidth)+30;xTicks.attr("transform",function(d,i,j){return"rotate("+rotateLabels+" 0,0)"}).style("text-anchor",rotateLabels%360>0?"start":"end")}axisLabel.enter().append("text").attr("class","nv-axislabel");var w=(scale.range().length==2)?scale.range()[1]:(scale.range()[scale.range().length-1]+(scale.range()[1]-scale.range()[0]));axisLabel.attr("text-anchor","middle").attr("y",xLabelMargin).attr("x",w/2);if(showMaxMin){var axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data([scale.domain()[0],scale.domain()[scale.domain().length-1]]);axisMaxMin.enter().append("g").attr("class","nv-axisMaxMin").append("text");axisMaxMin.exit().remove();axisMaxMin.attr("transform",function(d,i){return"translate("+(scale(d)+(isOrdinal?scale.rangeBand()/2:0))+",0)"}).select("text").attr("dy",".71em").attr("y",axis.tickPadding()).attr("transform",function(d,i,j){return"rotate("+rotateLabels+" 0,0)"}).style("text-anchor",rotateLabels?(rotateLabels%360>0?"start":"end"):"middle").text(function(d,i){var v=fmt(d);return(""+v).match("NaN")?"":v});axisMaxMin.transition().attr("transform",function(d,i){return"translate("+(scale(d)+(isOrdinal?scale.rangeBand()/2:0))+",0)"})}if(staggerLabels){xTicks.attr("transform",function(d,i){return"translate(0,"+(i%2==0?"0":"12")+")"})}break;case"right":axisLabel.enter().append("text").attr("class","nv-axislabel");axisLabel.style("text-anchor",rotateYLabel?"middle":"begin").attr("transform",rotateYLabel?"rotate(90)":"").attr("y",rotateYLabel?(-Math.max(margin.right,width)+12):-10).attr("x",rotateYLabel?(scale.range()[0]/2):axis.tickPadding());if(showMaxMin){var axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data(scale.domain());axisMaxMin.enter().append("g").attr("class","nv-axisMaxMin").append("text").style("opacity",0);axisMaxMin.exit().remove();axisMaxMin.attr("transform",function(d,i){return"translate(0,"+scale(d)+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",axis.tickPadding()).style("text-anchor","start").text(function(d,i){var v=fmt(d);return(""+v).match("NaN")?"":v});axisMaxMin.transition().attr("transform",function(d,i){return"translate(0,"+scale.range()[i]+")"}).select("text").style("opacity",1)}break;case"left":axisLabel.enter().append("text").attr("class","nv-axislabel");axisLabel.style("text-anchor",rotateYLabel?"middle":"end").attr("transform",rotateYLabel?"rotate(-90)":"").attr("y",rotateYLabel?(-Math.max(margin.left,width)+axisLabelDistance):-10).attr("x",rotateYLabel?(-scale.range()[0]/2):-axis.tickPadding());if(showMaxMin){var axisMaxMin=wrap.selectAll("g.nv-axisMaxMin").data(scale.domain());axisMaxMin.enter().append("g").attr("class","nv-axisMaxMin").append("text").style("opacity",0);axisMaxMin.exit().remove();axisMaxMin.attr("transform",function(d,i){return"translate(0,"+scale0(d)+")"}).select("text").attr("dy",".32em").attr("y",0).attr("x",-axis.tickPadding()).attr("text-anchor","end").text(function(d,i){var v=fmt(d);return(""+v).match("NaN")?"":v});axisMaxMin.transition().attr("transform",function(d,i){return"translate(0,"+scale.range()[i]+")"}).select("text").style("opacity",1)}break}axisLabel.text(function(d){return d});if(showMaxMin&&(axis.orient()==="left"||axis.orient()==="right")){g.selectAll("g").each(function(d,i){d3.select(this).select("text").attr("opacity",1);if(scale(d)<scale.range()[1]+10||scale(d)>scale.range()[0]-10){if(d>1e-10||d<-1e-10){d3.select(this).attr("opacity",0)}d3.select(this).select("text").attr("opacity",0)}});if(scale.domain()[0]==scale.domain()[1]&&scale.domain()[0]==0){wrap.selectAll("g.nv-axisMaxMin").style("opacity",function(d,i){return !i?1:0})}}if(showMaxMin&&(axis.orient()==="top"||axis.orient()==="bottom")){var maxMinRange=[];wrap.selectAll("g.nv-axisMaxMin").each(function(d,i){try{if(i){maxMinRange.push(scale(d)-this.getBBox().width-4)}else{maxMinRange.push(scale(d)+this.getBBox().width+4)}}catch(err){if(i){maxMinRange.push(scale(d)-4)}else{maxMinRange.push(scale(d)+4)}}});g.selectAll("g").each(function(d,i){if(scale(d)<maxMinRange[0]||scale(d)>maxMinRange[1]){if(d>1e-10||d<-1e-10){d3.select(this).remove()}else{d3.select(this).select("text").remove()}}})}if(highlightZero){g.selectAll(".tick").filter(function(d){return !parseFloat(Math.round(d.__data__*100000)/1000000)&&(d.__data__!==undefined)}).classed("zero",true)}scale0=scale.copy()});return chart}chart.axis=axis;d3.rebind(chart,axis,"orient","tickValues","tickSubdivide","tickSize","tickPadding","tickFormat");d3.rebind(chart,scale,"domain","range","rangeBand","rangeBands");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.ticks=function(_){if(!arguments.length){return ticks}ticks=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.axisLabel=function(_){if(!arguments.length){return axisLabelText}axisLabelText=_;return chart};chart.showMaxMin=function(_){if(!arguments.length){return showMaxMin}showMaxMin=_;return chart};chart.highlightZero=function(_){if(!arguments.length){return highlightZero}highlightZero=_;return chart};chart.scale=function(_){if(!arguments.length){return scale}scale=_;axis.scale(scale);isOrdinal=typeof scale.rangeBands==="function";d3.rebind(chart,scale,"domain","range","rangeBand","rangeBands");return chart};chart.rotateYLabel=function(_){if(!arguments.length){return rotateYLabel}rotateYLabel=_;return chart};chart.rotateLabels=function(_){if(!arguments.length){return rotateLabels}rotateLabels=_;return chart};chart.staggerLabels=function(_){if(!arguments.length){return staggerLabels}staggerLabels=_;return chart};chart.axisLabelDistance=function(_){if(!arguments.length){return axisLabelDistance}axisLabelDistance=_;return chart};return chart};nv.models.bullet=function(){var margin={top:0,right:0,bottom:0,left:0},orient="left",reverse=false,ranges=function(d){return d.ranges},markers=function(d){return d.markers},measures=function(d){return d.measures},forceX=[0],width=380,height=30,tickFormat=null,dispatch=d3.dispatch("elementMouseover","elementMouseout");function chart(selection){selection.each(function(d,i){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this),mainGroup=nv.log(this.parentNode.parentNode).getAttribute("transform"),heightFromTop=nv.log(parseInt(mainGroup.replace(/.*,(\d+)\)/,"$1")));var rangez=ranges.call(this,d,i).slice().sort(d3.descending),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i).slice().sort(d3.descending);var MaxX=Math.max(rangez[0]?rangez[0]:0,markerz[0]?markerz[0]:0,measurez[0]?measurez[0]:0);var x1=d3.scale.linear().domain([0,MaxX]).nice().range(reverse?[availableWidth,0]:[0,availableWidth]);var x0=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(x1.range());this.__chart__=x1;var wrap=container.selectAll("g.nv-wrap.nv-bullet").data([d]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bullet");var gEnter=wrapEnter.append("g");var g=wrap.select("g");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var w0=function(d){return Math.abs(x0(d)-x0(0))},w1=function(d){return Math.abs(x1(d)-x1(0))};var range=g.selectAll("rect.nv-range").data(rangez);range.enter().append("rect").attr("class",function(d,i){return"nv-range nv-s"+i}).attr("width",w0).attr("height",availableHeight).attr("x",reverse?x0:0).on("mouseover",function(d,i){dispatch.elementMouseover({value:d,label:(i<=0)?"Maximum":(i>1)?"Minimum":"Mean",pos:[x1(d),heightFromTop]})}).on("mouseout",function(d,i){dispatch.elementMouseout({value:d,label:(i<=0)?"Minimum":(i>=1)?"Maximum":"Mean"})});d3.transition(range).attr("x",reverse?x1:0).attr("width",w1).attr("height",availableHeight);var measure=g.selectAll("rect.nv-measure").data(measurez);measure.enter().append("rect").attr("class",function(d,i){return"nv-measure nv-s"+i}).attr("width",w0).attr("height",availableHeight/3).attr("x",reverse?x0:0).attr("y",availableHeight/3).on("mouseover",function(d){dispatch.elementMouseover({value:d,label:"Current",pos:[x1(d),heightFromTop]})}).on("mouseout",function(d){dispatch.elementMouseout({value:d,label:"Current"})});d3.transition(measure).attr("width",w1).attr("height",availableHeight/3).attr("x",reverse?x1:0).attr("y",availableHeight/3);var marker=g.selectAll("path.nv-markerTriangle").data(markerz);var h3=availableHeight/6;marker.enter().append("path").attr("class","nv-markerTriangle").attr("transform",function(d){return"translate("+x0(d)+","+(availableHeight/2)+")"}).attr("d","M0,"+h3+"L"+h3+","+(-h3)+" "+(-h3)+","+(-h3)+"Z").on("mouseover",function(d,i){dispatch.elementMouseover({value:d,label:"Previous",pos:[x1(d),heightFromTop]})}).on("mouseout",function(d,i){dispatch.elementMouseout({value:d,label:"Previous"})});d3.transition(marker).attr("transform",function(d){return"translate("+x1(d)+","+(availableHeight/2)+")"});marker.exit().remove()});d3.timer.flush();return chart}chart.dispatch=dispatch;chart.orient=function(_){if(!arguments.length){return orient}orient=_;reverse=orient=="right"||orient=="bottom";return chart};chart.ranges=function(_){if(!arguments.length){return ranges}ranges=_;return chart};chart.markers=function(_){if(!arguments.length){return markers}markers=_;return chart};chart.measures=function(_){if(!arguments.length){return measures}measures=_;return chart};chart.forceX=function(_){if(!arguments.length){return forceX}forceX=_;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.tickFormat=function(_){if(!arguments.length){return tickFormat}tickFormat=_;return chart};return chart};nv.models.bulletChart=function(){var bullet=nv.models.bullet();var orient="left",reverse=false,margin={top:5,right:40,bottom:20,left:120},ranges=function(d){return d.ranges},markers=function(d){return d.markers},measures=function(d){return d.measures},width=null,height=55,tickFormat=null,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+e.label+"</h3><p>"+e.value+"</p>"},noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide");var showTooltip=function(e,parentElement){var offsetElement=parentElement.parentNode.parentNode,left=e.pos[0]+offsetElement.offsetLeft+margin.left,top=e.pos[1]+offsetElement.offsetTop+margin.top;var content="<h3>"+e.label+"</h3><p>"+e.value+"</p>";nv.tooltip.show([left,top],content,e.value<0?"e":"w",null,offsetElement.parentNode)};function chart(selection){selection.each(function(d,i){var container=d3.select(this);var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,that=this;chart.update=function(){chart(selection)};chart.container=this;var rangez=ranges.call(this,d,i).slice().sort(d3.descending),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i).slice().sort(d3.descending);var wrap=container.selectAll("g.nv-wrap.nv-bulletChart").data([d]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bulletChart");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-bulletWrap");gEnter.append("g").attr("class","nv-titles");wrap.attr("transform","translate("+margin.left+","+(margin.top+i*height)+")");var MaxX=Math.max(rangez[0]?rangez[0]:0,markerz[0]?markerz[0]:0,measurez[0]?measurez[0]:0);var x1=d3.scale.linear().domain([0,MaxX]).nice().range(reverse?[availableWidth,0]:[0,availableWidth]);var x0=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(x1.range());this.__chart__=x1;var w0=function(d){return Math.abs(x0(d)-x0(0))},w1=function(d){return Math.abs(x1(d)-x1(0))};var title=gEnter.select(".nv-titles").append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(height-margin.top-margin.bottom)/2+")");title.append("text").attr("class","nv-title").text(function(d){return d.title});title.append("text").attr("class","nv-subtitle").attr("dy","1em").text(function(d){return d.subtitle});bullet.width(availableWidth).height(availableHeight);var bulletWrap=g.select(".nv-bulletWrap");d3.transition(bulletWrap).call(bullet);var format=tickFormat||x1.tickFormat(8);var tick=g.selectAll("g.nv-tick").data(x1.ticks(8),function(d){return this.textContent||format(d)});var tickEnter=tick.enter().append("g").attr("class","nv-tick").attr("transform",function(d){return"translate("+x0(d)+",0)"}).style("opacity",0.000001);tickEnter.append("line").attr("y1",availableHeight).attr("y2",availableHeight*7/6);tickEnter.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",availableHeight*7/6).text(format);d3.transition(tickEnter).attr("transform",function(d){return"translate("+x1(d)+",0)"}).style("opacity",1);var tickUpdate=d3.transition(tick).attr("transform",function(d){return"translate("+x1(d)+",0)"}).style("opacity",1);tickUpdate.select("line").attr("y1",availableHeight).attr("y2",availableHeight*7/6);tickUpdate.select("text").attr("y",availableHeight*7/6);d3.transition(tick.exit()).attr("transform",function(d){return"translate("+x1(d)+",0)"}).style("opacity",0.000001).remove();dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}})});d3.timer.flush();return chart}bullet.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});bullet.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.bullet=bullet;chart.orient=function(x){if(!arguments.length){return orient}orient=x;reverse=orient=="right"||orient=="bottom";return chart};chart.ranges=function(x){if(!arguments.length){return ranges}ranges=x;return chart};chart.markers=function(x){if(!arguments.length){return markers}markers=x;return chart};chart.measures=function(x){if(!arguments.length){return measures}measures=x;return chart};chart.width=function(x){if(!arguments.length){return width}width=x;return chart};chart.height=function(x){if(!arguments.length){return height}height=x;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.tickFormat=function(x){if(!arguments.length){return tickFormat}tickFormat=x;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.chartName=function(){var margin={top:30,right:10,bottom:10,left:10},width=960,height=500,color=nv.utils.getColor(d3.scale.category20c().range()),dispatch=d3.dispatch("stateChange","changeState");function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);var wrap=container.selectAll("g.nv-wrap.nv-chartName").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-chartName");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-mainWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")")});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};return chart};nv.models.bullet=function(){var margin={top:0,right:0,bottom:0,left:0},orient="left",reverse=false,ranges=function(d){return d.ranges},markers=function(d){return d.markers},measures=function(d){return d.measures},rangeLabels=function(d){return d.rangeLabels?d.rangeLabels:[]},markerLabels=function(d){return d.markerLabels?d.markerLabels:[]},measureLabels=function(d){return d.measureLabels?d.measureLabels:[]},forceX=[0],width=380,height=30,tickFormat=null,color=nv.utils.getColor(["#1f77b4"]),dispatch=d3.dispatch("elementMouseover","elementMouseout");function chart(selection){selection.each(function(d,i){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);var rangez=ranges.call(this,d,i).slice().sort(d3.descending),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i).slice().sort(d3.descending),rangeLabelz=rangeLabels.call(this,d,i).slice(),markerLabelz=markerLabels.call(this,d,i).slice(),measureLabelz=measureLabels.call(this,d,i).slice();var x1=d3.scale.linear().domain(d3.extent(d3.merge([forceX,rangez]))).range(reverse?[availableWidth,0]:[0,availableWidth]);var x0=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(x1.range());this.__chart__=x1;var rangeMin=d3.min(rangez),rangeMax=d3.max(rangez),rangeAvg=rangez[1];var wrap=container.selectAll("g.nv-wrap.nv-bullet").data([d]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bullet");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("rect").attr("class","nv-range nv-rangeMax");gEnter.append("rect").attr("class","nv-range nv-rangeAvg");gEnter.append("rect").attr("class","nv-range nv-rangeMin");gEnter.append("rect").attr("class","nv-measure");gEnter.append("path").attr("class","nv-markerTriangle");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var w0=function(d){return Math.abs(x0(d)-x0(0))},w1=function(d){return Math.abs(x1(d)-x1(0))};var xp0=function(d){return d<0?x0(d):x0(0)},xp1=function(d){return d<0?x1(d):x1(0)};g.select("rect.nv-rangeMax").attr("height",availableHeight).attr("width",w1(rangeMax>0?rangeMax:rangeMin)).attr("x",xp1(rangeMax>0?rangeMax:rangeMin)).datum(rangeMax>0?rangeMax:rangeMin);g.select("rect.nv-rangeAvg").attr("height",availableHeight).attr("width",w1(rangeAvg)).attr("x",xp1(rangeAvg)).datum(rangeAvg);g.select("rect.nv-rangeMin").attr("height",availableHeight).attr("width",w1(rangeMax)).attr("x",xp1(rangeMax)).attr("width",w1(rangeMax>0?rangeMin:rangeMax)).attr("x",xp1(rangeMax>0?rangeMin:rangeMax)).datum(rangeMax>0?rangeMin:rangeMax);g.select("rect.nv-measure").style("fill",color).attr("height",availableHeight/3).attr("y",availableHeight/3).attr("width",measurez<0?x1(0)-x1(measurez[0]):x1(measurez[0])-x1(0)).attr("x",xp1(measurez)).on("mouseover",function(){dispatch.elementMouseover({value:measurez[0],label:measureLabelz[0]||"Current",pos:[x1(measurez[0]),availableHeight/2]})}).on("mouseout",function(){dispatch.elementMouseout({value:measurez[0],label:measureLabelz[0]||"Current"})});var h3=availableHeight/6;if(markerz[0]){g.selectAll("path.nv-markerTriangle").attr("transform",function(d){return"translate("+x1(markerz[0])+","+(availableHeight/2)+")"}).attr("d","M0,"+h3+"L"+h3+","+(-h3)+" "+(-h3)+","+(-h3)+"Z").on("mouseover",function(){dispatch.elementMouseover({value:markerz[0],label:markerLabelz[0]||"Previous",pos:[x1(markerz[0]),availableHeight/2]})}).on("mouseout",function(){dispatch.elementMouseout({value:markerz[0],label:markerLabelz[0]||"Previous"})})}else{g.selectAll("path.nv-markerTriangle").remove()}wrap.selectAll(".nv-range").on("mouseover",function(d,i){var label=rangeLabelz[i]||(!i?"Maximum":i==1?"Mean":"Minimum");dispatch.elementMouseover({value:d,label:label,pos:[x1(d),availableHeight/2]})}).on("mouseout",function(d,i){var label=rangeLabelz[i]||(!i?"Maximum":i==1?"Mean":"Minimum");dispatch.elementMouseout({value:d,label:label})})});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.orient=function(_){if(!arguments.length){return orient}orient=_;reverse=orient=="right"||orient=="bottom";return chart};chart.ranges=function(_){if(!arguments.length){return ranges}ranges=_;return chart};chart.markers=function(_){if(!arguments.length){return markers}markers=_;return chart};chart.measures=function(_){if(!arguments.length){return measures}measures=_;return chart};chart.forceX=function(_){if(!arguments.length){return forceX}forceX=_;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.tickFormat=function(_){if(!arguments.length){return tickFormat}tickFormat=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};return chart};nv.models.bulletChart=function(){var bullet=nv.models.bullet();var orient="left",reverse=false,margin={top:5,right:40,bottom:20,left:120},ranges=function(d){return d.ranges},markers=function(d){return d.markers},measures=function(d){return d.measures},width=null,height=55,tickFormat=null,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+x+"</h3><p>"+y+"</p>"},noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0)+margin.left,top=e.pos[1]+(offsetElement.offsetTop||0)+margin.top,content=tooltip(e.key,e.label,e.value,e,chart);nv.tooltip.show([left,top],content,e.value<0?"e":"w",null,offsetElement)};function chart(selection){selection.each(function(d,i){var container=d3.select(this);var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,that=this;chart.update=function(){chart(selection)};chart.container=this;if(!d||!ranges.call(this,d,i)){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",18+margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var rangez=ranges.call(this,d,i).slice().sort(d3.descending),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i).slice().sort(d3.descending);var wrap=container.selectAll("g.nv-wrap.nv-bulletChart").data([d]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-bulletChart");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-bulletWrap");gEnter.append("g").attr("class","nv-titles");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var x1=d3.scale.linear().domain([0,Math.max(rangez[0],markerz[0],measurez[0])]).range(reverse?[availableWidth,0]:[0,availableWidth]);var x0=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(x1.range());this.__chart__=x1;var w0=function(d){return Math.abs(x0(d)-x0(0))},w1=function(d){return Math.abs(x1(d)-x1(0))};var title=gEnter.select(".nv-titles").append("g").attr("text-anchor","end").attr("transform","translate(-6,"+(height-margin.top-margin.bottom)/2+")");title.append("text").attr("class","nv-title").text(function(d){return d.title});title.append("text").attr("class","nv-subtitle").attr("dy","1em").text(function(d){return d.subtitle});bullet.width(availableWidth).height(availableHeight);var bulletWrap=g.select(".nv-bulletWrap");d3.transition(bulletWrap).call(bullet);var format=tickFormat||x1.tickFormat(availableWidth/100);var tick=g.selectAll("g.nv-tick").data(x1.ticks(availableWidth/50),function(d){return this.textContent||format(d)});var tickEnter=tick.enter().append("g").attr("class","nv-tick").attr("transform",function(d){return"translate("+x0(d)+",0)"}).style("opacity",0.000001);tickEnter.append("line").attr("y1",availableHeight).attr("y2",availableHeight*7/6);tickEnter.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",availableHeight*7/6).text(format);var tickUpdate=d3.transition(tick).attr("transform",function(d){return"translate("+x1(d)+",0)"}).style("opacity",1);tickUpdate.select("line").attr("y1",availableHeight).attr("y2",availableHeight*7/6);tickUpdate.select("text").attr("y",availableHeight*7/6);d3.transition(tick.exit()).attr("transform",function(d){return"translate("+x1(d)+",0)"}).style("opacity",0.000001).remove();dispatch.on("tooltipShow",function(e){e.key=d.title;if(tooltips){showTooltip(e,that.parentNode)}})});d3.timer.flush();return chart}bullet.dispatch.on("elementMouseover.tooltip",function(e){dispatch.tooltipShow(e)});bullet.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.bullet=bullet;d3.rebind(chart,bullet,"color");chart.options=nv.utils.optionsFunc.bind(chart);chart.orient=function(x){if(!arguments.length){return orient}orient=x;reverse=orient=="right"||orient=="bottom";return chart};chart.ranges=function(x){if(!arguments.length){return ranges}ranges=x;return chart};chart.markers=function(x){if(!arguments.length){return markers}markers=x;return chart};chart.measures=function(x){if(!arguments.length){return measures}measures=x;return chart};chart.width=function(x){if(!arguments.length){return width}width=x;return chart};chart.height=function(x){if(!arguments.length){return height}height=x;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.tickFormat=function(x){if(!arguments.length){return tickFormat}tickFormat=x;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.cumulativeLineChart=function(){var lines=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),interactiveLayer=nv.interactiveGuideline();var margin={top:30,right:30,bottom:50,left:60},color=nv.utils.defaultColor(),width=null,height=null,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,tooltips=true,showControls=true,useInteractiveGuideline=false,rescaleY=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,y,id=lines.id(),state={index:0,rescaleY:rescaleY},defaultState=null,noData="No Data Available.",average=function(d){return d.average},dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),transitionDuration=250;xAxis.orient("bottom").tickPadding(7);yAxis.orient((rightAlignYAxis)?"right":"left");controls.updateState(false);var dx=d3.scale.linear(),index={i:0,x:0};var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this).classed("nv-chart-"+id,true),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}var indexDrag=d3.behavior.drag().on("dragstart",dragStart).on("drag",dragMove).on("dragend",dragEnd);function dragStart(d,i){d3.select(chart.container).style("cursor","ew-resize")}function dragMove(d,i){index.x=d3.event.x;index.i=Math.round(dx.invert(index.x));updateZero()}function dragEnd(d,i){d3.select(chart.container).style("cursor","auto");state.index=index.i;dispatch.stateChange(state)}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=lines.xScale();y=lines.yScale();if(!rescaleY){var seriesDomains=data.filter(function(series){return !series.disabled}).map(function(series,i){var initialDomain=d3.extent(series.values,lines.y());if(initialDomain[0]<-0.95){initialDomain[0]=-0.95}return[(initialDomain[0]-initialDomain[1])/(1+initialDomain[1]),(initialDomain[1]-initialDomain[0])/(1+initialDomain[0])]});var completeDomain=[d3.min(seriesDomains,function(d){return d[0]}),d3.max(seriesDomains,function(d){return d[1]})];lines.yDomain(completeDomain)}else{lines.yDomain(null)}dx.domain([0,data[0].values.length-1]).range([0,availableWidth]).clamp(true);var data=indexify(index.i,data);var interactivePointerEvents=(useInteractiveGuideline)?"none":"all";var wrap=container.selectAll("g.nv-wrap.nv-cumulativeLine").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-cumulativeLine").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-interactive");gEnter.append("g").attr("class","nv-x nv-axis").style("pointer-events","none");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-background");gEnter.append("g").attr("class","nv-linesWrap").style("pointer-events",interactivePointerEvents);gEnter.append("g").attr("class","nv-avgLinesWrap").style("pointer-events","none");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");if(showLegend){legend.width(availableWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}if(showControls){var controlsData=[{key:"Re-scale y-axis",disabled:!rescaleY}];controls.width(140).color(["#444","#444","#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}var tempDisabled=data.filter(function(d){return d.tempDisabled});wrap.select(".tempDisabled").remove();if(tempDisabled.length){wrap.append("text").attr("class","tempDisabled").attr("x",availableWidth/2).attr("y","-.71em").style("text-anchor","end").text(tempDisabled.map(function(d){return d.key}).join(", ")+" values cannot be calculated for this time period.")}if(useInteractiveGuideline){interactiveLayer.width(availableWidth).height(availableHeight).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x);wrap.select(".nv-interactive").call(interactiveLayer)}gEnter.select(".nv-background").append("rect");g.select(".nv-background rect").attr("width",availableWidth).attr("height",availableHeight);lines.y(function(d){return d.display.y}).width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&!data[i].tempDisabled}));var linesWrap=g.select(".nv-linesWrap").datum(data.filter(function(d){return !d.disabled&&!d.tempDisabled}));linesWrap.call(lines);data.forEach(function(d,i){d.seriesIndex=i});var avgLineData=data.filter(function(d){return !d.disabled&&!!average(d)});var avgLines=g.select(".nv-avgLinesWrap").selectAll("line").data(avgLineData,function(d){return d.key});var getAvgLineY=function(d){var yVal=y(average(d));if(yVal<0){return 0}if(yVal>availableHeight){return availableHeight}return yVal};avgLines.enter().append("line").style("stroke-width",2).style("stroke-dasharray","10,10").style("stroke",function(d,i){return lines.color()(d,d.seriesIndex)}).attr("x1",0).attr("x2",availableWidth).attr("y1",getAvgLineY).attr("y2",getAvgLineY);avgLines.style("stroke-opacity",function(d){var yVal=y(average(d));if(yVal<0||yVal>availableHeight){return 0}return 1}).attr("x1",0).attr("x2",availableWidth).attr("y1",getAvgLineY).attr("y2",getAvgLineY);avgLines.exit().remove();var indexLine=linesWrap.selectAll(".nv-indexLine").data([index]);indexLine.enter().append("rect").attr("class","nv-indexLine").attr("width",3).attr("x",-2).attr("fill","red").attr("fill-opacity",0.5).style("pointer-events","all").call(indexDrag);indexLine.attr("transform",function(d){return"translate("+dx(d.i)+",0)"}).attr("height",availableHeight);if(showXAxis){xAxis.scale(x).ticks(Math.min(data[0].values.length,availableWidth/70)).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")");d3.transition(g.select(".nv-x.nv-axis")).call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);d3.transition(g.select(".nv-y.nv-axis")).call(yAxis)}function updateZero(){indexLine.data([index]);var oldDuration=chart.transitionDuration();chart.transitionDuration(0);chart.update();chart.transitionDuration(oldDuration)}g.select(".nv-background rect").on("click",function(){index.x=d3.mouse(this)[0];index.i=Math.round(dx.invert(index.x));state.index=index.i;dispatch.stateChange(state);updateZero()});lines.dispatch.on("elementClick",function(e){index.i=e.pointIndex;index.x=dx(index.i);state.index=index.i;dispatch.stateChange(state);updateZero()});controls.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;rescaleY=!d.disabled;state.rescaleY=rescaleY;dispatch.stateChange(state);chart.update()});legend.dispatch.on("stateChange",function(newState){state.disabled=newState.disabled;dispatch.stateChange(state);chart.update()});interactiveLayer.dispatch.on("elementMousemove",function(e){lines.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];data.filter(function(series,i){series.seriesIndex=i;return !series.disabled}).forEach(function(series,i){pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x());lines.highlightPoint(i,pointIndex,true);var point=series.values[pointIndex];if(typeof point==="undefined"){return}if(typeof singlePoint==="undefined"){singlePoint=point}if(typeof pointXLocation==="undefined"){pointXLocation=chart.xScale()(chart.x()(point,pointIndex))}allData.push({key:series.key,value:chart.y()(point,pointIndex),color:color(series,series.seriesIndex)})});if(allData.length>2){var yValue=chart.yScale().invert(e.mouseY);var domainExtent=Math.abs(chart.yScale().domain()[0]-chart.yScale().domain()[1]);var threshold=0.03*domainExtent;var indexToHighlight=nv.nearestValueIndex(allData.map(function(d){return d.value}),yValue,threshold);if(indexToHighlight!==null){allData[indexToHighlight].highlight=true}}var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex),pointIndex);interactiveLayer.tooltip.position({left:pointXLocation+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).enabled(tooltips).valueFormatter(function(d,i){return yAxis.tickFormat()(d)}).data({value:xValue,series:allData})();interactiveLayer.renderGuideLine(pointXLocation)});interactiveLayer.dispatch.on("elementMouseout",function(e){dispatch.tooltipHide();lines.clearHighlights()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}if(typeof e.index!=="undefined"){index.i=e.index;index.x=dx(index.i);state.index=e.index;indexLine.data([index])}if(typeof e.rescaleY!=="undefined"){rescaleY=e.rescaleY}chart.update()})});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.lines=lines;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.interactiveLayer=interactiveLayer;d3.rebind(chart,lines,"defined","isArea","x","y","xScale","yScale","size","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","useVoronoi","id");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.rescaleY=function(_){if(!arguments.length){return rescaleY}rescaleY=_;return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.useInteractiveGuideline=function(_){if(!arguments.length){return useInteractiveGuideline}useInteractiveGuideline=_;if(_===true){chart.interactive(false);chart.useVoronoi(false)}return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.average=function(_){if(!arguments.length){return average}average=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};function indexify(idx,data){return data.map(function(line,i){if(!line.values){return line}var v=lines.y()(line.values[idx],idx);if(v<-0.95){line.tempDisabled=true;return line}line.tempDisabled=false;line.values=line.values.map(function(point,pointIndex){point.display={y:(lines.y()(point,pointIndex)-v)/(1+v)};return point});return line})}return chart};nv.models.discreteBar=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(Math.random()*10000),x=d3.scale.ordinal(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],color=nv.utils.defaultColor(),showValues=false,valueFormat=d3.format(",.2f"),xDomain,yDomain,xRange,yRange,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),rectClass="discreteBar";var x0,y0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);data.forEach(function(series,i){series.values.forEach(function(point){point.series=i})});var seriesData=(xDomain&&yDomain)?[]:data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0}})});x.domain(xDomain||d3.merge(seriesData).map(function(d){return d.x})).rangeBands(xRange||[0,availableWidth],0.1);y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){return d.y}).concat(forceY)));if(showValues){y.range(yRange||[availableHeight-(y.domain()[0]<0?12:0),y.domain()[1]>0?12:0])}else{y.range(yRange||[availableHeight,0])}x0=x0||x;y0=y0||y.copy().range([y(0),y(0)]);var wrap=container.selectAll("g.nv-wrap.nv-discretebar").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-discretebar");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);groups.exit().transition().style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover});groups.transition().style("stroke-opacity",1).style("fill-opacity",0.75);var bars=groups.selectAll("g.nv-bar").data(function(d){return d.values});bars.exit().remove();var barsEnter=bars.enter().append("g").attr("transform",function(d,i,j){return"translate("+(x(getX(d,i))+x.rangeBand()*0.05)+", "+y(0)+")"}).on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(d.series+0.5)/data.length),y(getY(d,i))],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({value:getY(d,i),point:d,series:data[d.series],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("click",function(d,i){dispatch.elementClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(d.series+0.5)/data.length),y(getY(d,i))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(d.series+0.5)/data.length),y(getY(d,i))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()});barsEnter.append("rect").attr("height",0).attr("width",x.rangeBand()*0.9/data.length);if(showValues){barsEnter.append("text").attr("text-anchor","middle");bars.select("text").text(function(d,i){return valueFormat(getY(d,i))}).transition().attr("x",x.rangeBand()*0.9/2).attr("y",function(d,i){return getY(d,i)<0?y(getY(d,i))-y(0)+12:-4})}else{bars.selectAll("text").remove()}bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).style("fill",function(d,i){return d.color||color(d,i)}).style("stroke",function(d,i){return d.color||color(d,i)}).select("rect").attr("class",rectClass).transition().attr("width",x.rangeBand()*0.9/data.length);bars.transition().attr("transform",function(d,i){var left=x(getX(d,i))+x.rangeBand()*0.05,top=getY(d,i)<0?y(0):y(0)-y(getY(d,i))<1?y(0)-1:y(getY(d,i));return"translate("+left+", "+top+")"}).select("rect").attr("height",function(d,i){return Math.max(Math.abs(y(getY(d,i))-y((yDomain&&yDomain[0])||0))||1)});x0=x.copy();y0=y.copy()});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.showValues=function(_){if(!arguments.length){return showValues}showValues=_;return chart};chart.valueFormat=function(_){if(!arguments.length){return valueFormat}valueFormat=_;return chart};chart.rectClass=function(_){if(!arguments.length){return rectClass}rectClass=_;return chart};return chart};nv.models.discreteBarChart=function(){var discretebar=nv.models.discreteBar(),xAxis=nv.models.axis(),yAxis=nv.models.axis();var margin={top:15,right:10,bottom:50,left:60},width=null,height=null,color=nv.utils.getColor(),showXAxis=true,showYAxis=true,rightAlignYAxis=false,staggerLabels=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+x+"</h3><p>"+y+"</p>"},x,y,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","beforeUpdate"),transitionDuration=250;xAxis.orient("bottom").highlightZero(false).showMaxMin(false).tickFormat(function(d){return d});yAxis.orient((rightAlignYAxis)?"right":"left").tickFormat(d3.format(",.1f"));var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(discretebar.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(discretebar.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){dispatch.beforeUpdate();container.transition().duration(transitionDuration).call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=discretebar.xScale();y=discretebar.yScale().clamp(true);var wrap=container.selectAll("g.nv-wrap.nv-discreteBarWithAxes").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-discreteBarWithAxes").append("g");var defsEnter=gEnter.append("defs");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-barsWrap");g.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}discretebar.width(availableWidth).height(availableHeight);var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return !d.disabled}));barsWrap.transition().call(discretebar);defsEnter.append("clipPath").attr("id","nv-x-label-clip-"+discretebar.id()).append("rect");g.select("#nv-x-label-clip-"+discretebar.id()+" rect").attr("width",x.rangeBand()*(staggerLabels?2:1)).attr("height",16).attr("x",-x.rangeBand()/(staggerLabels?1:2));if(showXAxis){xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+(y.range()[0]+((discretebar.showValues()&&y.domain()[0]<0)?16:0))+")");g.select(".nv-x.nv-axis").transition().call(xAxis);var xTicks=g.select(".nv-x.nv-axis").selectAll("g");if(staggerLabels){xTicks.selectAll("text").attr("transform",function(d,i,j){return"translate(0,"+(j%2==0?"5":"17")+")"})}}if(showYAxis){yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").transition().call(yAxis)}dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}})});return chart}discretebar.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});discretebar.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.discretebar=discretebar;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,discretebar,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","id","showValues","valueFormat");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);discretebar.color(color);return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.staggerLabels=function(_){if(!arguments.length){return staggerLabels}staggerLabels=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.distribution=function(){var margin={top:0,right:0,bottom:0,left:0},width=400,size=8,axis="x",getData=function(d){return d[axis]},color=nv.utils.defaultColor(),scale=d3.scale.linear(),domain;var scale0;function chart(selection){selection.each(function(data){var availableLength=width-(axis==="x"?margin.left+margin.right:margin.top+margin.bottom),naxis=axis=="x"?"y":"x",container=d3.select(this);scale0=scale0||scale;var wrap=container.selectAll("g.nv-distribution").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-distribution");var gEnter=wrapEnter.append("g");var g=wrap.select("g");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var distWrap=g.selectAll("g.nv-dist").data(function(d){return d},function(d){return d.key});distWrap.enter().append("g");distWrap.attr("class",function(d,i){return"nv-dist nv-series-"+i}).style("stroke",function(d,i){return color(d,i)});var dist=distWrap.selectAll("line.nv-dist"+axis).data(function(d){return d.values});dist.enter().append("line").attr(axis+"1",function(d,i){return scale0(getData(d,i))}).attr(axis+"2",function(d,i){return scale0(getData(d,i))});distWrap.exit().selectAll("line.nv-dist"+axis).transition().attr(axis+"1",function(d,i){return scale(getData(d,i))}).attr(axis+"2",function(d,i){return scale(getData(d,i))}).style("stroke-opacity",0).remove();dist.attr("class",function(d,i){return"nv-dist"+axis+" nv-dist"+axis+"-"+i}).attr(naxis+"1",0).attr(naxis+"2",size);dist.transition().attr(axis+"1",function(d,i){return scale(getData(d,i))}).attr(axis+"2",function(d,i){return scale(getData(d,i))});scale0=scale.copy()});return chart}chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.axis=function(_){if(!arguments.length){return axis}axis=_;return chart};chart.size=function(_){if(!arguments.length){return size}size=_;return chart};chart.getData=function(_){if(!arguments.length){return getData}getData=d3.functor(_);return chart};chart.scale=function(_){if(!arguments.length){return scale}scale=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};return chart};nv.models.historicalBar=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(Math.random()*10000),x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},forceX=[],forceY=[0],padData=false,clipEdge=true,color=nv.utils.defaultColor(),xDomain,yDomain,xRange,yRange,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout"),interactive=true;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x.domain(xDomain||d3.extent(data[0].values.map(getX).concat(forceX)));if(padData){x.range(xRange||[availableWidth*0.5/data[0].values.length,availableWidth*(data[0].values.length-0.5)/data[0].values.length])}else{x.range(xRange||[0,availableWidth])}y.domain(yDomain||d3.extent(data[0].values.map(getY).concat(forceY))).range(yRange||[availableHeight,0]);if(x.domain()[0]===x.domain()[1]){x.domain()[0]?x.domain([x.domain()[0]-x.domain()[0]*0.01,x.domain()[1]+x.domain()[1]*0.01]):x.domain([-1,1])}if(y.domain()[0]===y.domain()[1]){y.domain()[0]?y.domain([y.domain()[0]+y.domain()[0]*0.01,y.domain()[1]-y.domain()[1]*0.01]):y.domain([-1,1])}var wrap=container.selectAll("g.nv-wrap.nv-historicalBar-"+id).data([data[0].values]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBar-"+id);var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-bars");wrap.attr("transform","translate("+margin.left+","+margin.top+")");container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})});defsEnter.append("clipPath").attr("id","nv-chart-clip-path-"+id).append("rect");wrap.select("#nv-chart-clip-path-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-chart-clip-path-"+id+")":"");var bars=wrap.select(".nv-bars").selectAll(".nv-bar").data(function(d){return d},function(d,i){return getX(d,i)});bars.exit().remove();var barsEnter=bars.enter().append("rect").attr("x",0).attr("y",function(d,i){return nv.utils.NaNtoZero(y(Math.max(0,getY(d,i))))}).attr("height",function(d,i){return nv.utils.NaNtoZero(Math.abs(y(getY(d,i))-y(0)))}).attr("transform",function(d,i){return"translate("+(x(getX(d,i))-availableWidth/data[0].values.length*0.45)+",0)"}).on("mouseover",function(d,i){if(!interactive){return}d3.select(this).classed("hover",true);dispatch.elementMouseover({point:d,series:data[0],pos:[x(getX(d,i)),y(getY(d,i))],pointIndex:i,seriesIndex:0,e:d3.event})}).on("mouseout",function(d,i){if(!interactive){return}d3.select(this).classed("hover",false);dispatch.elementMouseout({point:d,series:data[0],pointIndex:i,seriesIndex:0,e:d3.event})}).on("click",function(d,i){if(!interactive){return}dispatch.elementClick({value:getY(d,i),data:d,index:i,pos:[x(getX(d,i)),y(getY(d,i))],e:d3.event,id:id});d3.event.stopPropagation()}).on("dblclick",function(d,i){if(!interactive){return}dispatch.elementDblClick({value:getY(d,i),data:d,index:i,pos:[x(getX(d,i)),y(getY(d,i))],e:d3.event,id:id});d3.event.stopPropagation()});bars.attr("fill",function(d,i){return color(d,i)}).attr("class",function(d,i,j){return(getY(d,i)<0?"nv-bar negative":"nv-bar positive")+" nv-bar-"+j+"-"+i}).transition().attr("transform",function(d,i){return"translate("+(x(getX(d,i))-availableWidth/data[0].values.length*0.45)+",0)"}).attr("width",(availableWidth/data[0].values.length)*0.9);bars.transition().attr("y",function(d,i){var rval=getY(d,i)<0?y(0):y(0)-y(getY(d,i))<1?y(0)-1:y(getY(d,i));return nv.utils.NaNtoZero(rval)}).attr("height",function(d,i){return nv.utils.NaNtoZero(Math.max(Math.abs(y(getY(d,i))-y(0)),1))})});return chart}chart.highlightPoint=function(pointIndex,isHoverOver){d3.select(".nv-historicalBar-"+id).select(".nv-bars .nv-bar-0-"+pointIndex).classed("hover",isHoverOver)};chart.clearHighlights=function(){d3.select(".nv-historicalBar-"+id).select(".nv-bars .nv-bar.hover").classed("hover",false)};chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceX=function(_){if(!arguments.length){return forceX}forceX=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.padData=function(_){if(!arguments.length){return padData}padData=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.interactive=function(_){if(!arguments.length){return interactive}interactive=false;return chart};return chart};nv.models.historicalBarChart=function(){var bars=nv.models.historicalBar(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend();var margin={top:30,right:90,bottom:50,left:90},color=nv.utils.defaultColor(),width=null,height=null,showLegend=false,showXAxis=true,showYAxis=true,rightAlignYAxis=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,y,state={},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),transitionDuration=250;xAxis.orient("bottom").tickPadding(7);yAxis.orient((rightAlignYAxis)?"right":"left");var showTooltip=function(e,offsetElement){if(offsetElement){var svg=d3.select(offsetElement).select("svg");var viewBox=(svg.node())?svg.attr("viewBox"):null;if(viewBox){viewBox=viewBox.split(" ");var ratio=parseInt(svg.style("width"))/viewBox[2];e.pos[0]=e.pos[0]*ratio;e.pos[1]=e.pos[1]*ratio}}var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(bars.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(bars.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=bars.xScale();y=bars.yScale();var wrap=container.selectAll("g.nv-wrap.nv-historicalBarChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-historicalBarChart").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-barsWrap");gEnter.append("g").attr("class","nv-legendWrap");if(showLegend){legend.width(availableWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}wrap.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}bars.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return !d.disabled}));barsWrap.transition().call(bars);if(showXAxis){xAxis.scale(x).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")");g.select(".nv-x.nv-axis").transition().call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").transition().call(yAxis)}legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(!data.filter(function(d){return !d.disabled}).length){data.map(function(d){d.disabled=false;wrap.selectAll(".nv-series").classed("disabled",false);return d})}state.disabled=data.map(function(d){return !!d.disabled});dispatch.stateChange(state);selection.transition().call(chart)});legend.dispatch.on("legendDblclick",function(d){data.forEach(function(d){d.disabled=true});d.disabled=false;state.disabled=data.map(function(d){return !!d.disabled});dispatch.stateChange(state);chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}selection.call(chart)})});return chart}bars.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});bars.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.bars=bars;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,bars,"defined","isArea","x","y","size","xScale","yScale","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","id","interpolate","highlightPoint","clearHighlights","interactive");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.indentedTree=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=nv.utils.defaultColor(),id=Math.floor(Math.random()*10000),header=true,filterZero=false,noData="No Data Available.",childIndent=20,columns=[{key:"key",label:"Name",type:"text"}],tableClass=null,iconOpen="images/grey-plus.png",iconClose="images/grey-minus.png",dispatch=d3.dispatch("elementClick","elementDblclick","elementMouseover","elementMouseout"),getUrl=function(d){return d.url};var idx=0;function chart(selection){selection.each(function(data){var depth=1,container=d3.select(this);var tree=d3.layout.tree().children(function(d){return d.values}).size([height,childIndent]);chart.update=function(){container.transition().duration(600).call(chart)};if(!data[0]){data[0]={key:noData}}var nodes=tree.nodes(data[0]);var wrap=d3.select(this).selectAll("div").data([[nodes]]);var wrapEnter=wrap.enter().append("div").attr("class","nvd3 nv-wrap nv-indentedtree");var tableEnter=wrapEnter.append("table");var table=wrap.select("table").attr("width","100%").attr("class",tableClass);if(header){var thead=tableEnter.append("thead");var theadRow1=thead.append("tr");columns.forEach(function(column){theadRow1.append("th").attr("width",column.width?column.width:"10%").style("text-align",column.type=="numeric"?"right":"left").append("span").text(column.label)})}var tbody=table.selectAll("tbody").data(function(d){return d});tbody.enter().append("tbody");depth=d3.max(nodes,function(node){return node.depth});tree.size([height,depth*childIndent]);var node=tbody.selectAll("tr").data(function(d){return d.filter(function(d){return(filterZero&&!d.children)?filterZero(d):true})},function(d,i){return d.id||(d.id||++idx)});node.exit().remove();node.select("img.nv-treeicon").attr("src",icon).classed("folded",folded);var nodeEnter=node.enter().append("tr");columns.forEach(function(column,index){var nodeName=nodeEnter.append("td").style("padding-left",function(d){return(index?0:d.depth*childIndent+12+(icon(d)?0:16))+"px"},"important").style("text-align",column.type=="numeric"?"right":"left");if(index==0){nodeName.append("img").classed("nv-treeicon",true).classed("nv-folded",folded).attr("src",icon).style("width","14px").style("height","14px").style("padding","0 1px").style("display",function(d){return icon(d)?"inline-block":"none"}).on("click",click)}nodeName.each(function(d){if(!index&&getUrl(d)){d3.select(this).append("a").attr("href",getUrl).attr("class",d3.functor(column.classes)).append("span")}else{d3.select(this).append("span")}d3.select(this).select("span").attr("class",d3.functor(column.classes)).text(function(d){return column.format?column.format(d):(d[column.key]||"-")})});if(column.showCount){nodeName.append("span").attr("class","nv-childrenCount");node.selectAll("span.nv-childrenCount").text(function(d){return((d.values&&d.values.length)||(d._values&&d._values.length))?"("+((d.values&&(d.values.filter(function(d){return filterZero?filterZero(d):true}).length))||(d._values&&d._values.filter(function(d){return filterZero?filterZero(d):true}).length)||0)+")":""})}});node.order().on("click",function(d){dispatch.elementClick({row:this,data:d,pos:[d.x,d.y]})}).on("dblclick",function(d){dispatch.elementDblclick({row:this,data:d,pos:[d.x,d.y]})}).on("mouseover",function(d){dispatch.elementMouseover({row:this,data:d,pos:[d.x,d.y]})}).on("mouseout",function(d){dispatch.elementMouseout({row:this,data:d,pos:[d.x,d.y]})});function click(d,_,unshift){d3.event.stopPropagation();if(d3.event.shiftKey&&!unshift){d3.event.shiftKey=false;d.values&&d.values.forEach(function(node){if(node.values||node._values){click(node,0,true)}});return true}if(!hasChildren(d)){return true}if(d.values){d._values=d.values;d.values=null}else{d.values=d._values;d._values=null}chart.update()}function icon(d){return(d._values&&d._values.length)?iconOpen:(d.values&&d.values.length)?iconClose:""}function folded(d){return(d._values&&d._values.length)}function hasChildren(d){var values=d.values||d._values;return(values&&values.length)}});return chart}chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);scatter.color(color);return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.header=function(_){if(!arguments.length){return header}header=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.filterZero=function(_){if(!arguments.length){return filterZero}filterZero=_;return chart};chart.columns=function(_){if(!arguments.length){return columns}columns=_;return chart};chart.tableClass=function(_){if(!arguments.length){return tableClass}tableClass=_;return chart};chart.iconOpen=function(_){if(!arguments.length){return iconOpen}iconOpen=_;return chart};chart.iconClose=function(_){if(!arguments.length){return iconClose}iconClose=_;return chart};chart.getUrl=function(_){if(!arguments.length){return getUrl}getUrl=_;return chart};return chart};nv.models.legend=function(){var margin={top:5,right:0,bottom:5,left:0},width=400,height=20,getKey=function(d){return d.key},color=nv.utils.defaultColor(),align=true,rightAlign=true,updateState=true,radioButtonMode=false,dispatch=d3.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout","stateChange");function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,container=d3.select(this);var wrap=container.selectAll("g.nv-legend").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-legend").append("g");var g=wrap.select("g");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var series=g.selectAll(".nv-series").data(function(d){return d});var seriesEnter=series.enter().append("g").attr("class","nv-series").on("mouseover",function(d,i){dispatch.legendMouseover(d,i)}).on("mouseout",function(d,i){dispatch.legendMouseout(d,i)}).on("click",function(d,i){dispatch.legendClick(d,i);if(updateState){if(radioButtonMode){data.forEach(function(series){series.disabled=true});d.disabled=false}else{d.disabled=!d.disabled;if(data.every(function(series){return series.disabled})){data.forEach(function(series){series.disabled=false})}}dispatch.stateChange({disabled:data.map(function(d){return !!d.disabled})})}}).on("dblclick",function(d,i){dispatch.legendDblclick(d,i);if(updateState){data.forEach(function(series){series.disabled=true});d.disabled=false;dispatch.stateChange({disabled:data.map(function(d){return !!d.disabled})})}});seriesEnter.append("circle").style("stroke-width",2).attr("class","nv-legend-symbol").attr("r",5);seriesEnter.append("text").attr("text-anchor","start").attr("class","nv-legend-text").attr("dy",".32em").attr("dx","8");series.classed("disabled",function(d){return d.disabled});series.exit().remove();series.select("circle").style("fill",function(d,i){return d.color||color(d,i)}).style("stroke",function(d,i){return d.color||color(d,i)});series.select("text").text(getKey);if(align){var seriesWidths=[];series.each(function(d,i){var legendText=d3.select(this).select("text");var nodeTextLength;try{nodeTextLength=legendText.node().getComputedTextLength()}catch(e){nodeTextLength=nv.utils.calcApproxTextWidth(legendText)}seriesWidths.push(nodeTextLength+28)});var seriesPerRow=0;var legendWidth=0;var columnWidths=[];while(legendWidth<availableWidth&&seriesPerRow<seriesWidths.length){columnWidths[seriesPerRow]=seriesWidths[seriesPerRow];legendWidth+=seriesWidths[seriesPerRow++]}if(seriesPerRow===0){seriesPerRow=1}while(legendWidth>availableWidth&&seriesPerRow>1){columnWidths=[];seriesPerRow--;for(var k=0;k<seriesWidths.length;k++){if(seriesWidths[k]>(columnWidths[k%seriesPerRow]||0)){columnWidths[k%seriesPerRow]=seriesWidths[k]}}legendWidth=columnWidths.reduce(function(prev,cur,index,array){return prev+cur})}var xPositions=[];for(var i=0,curX=0;i<seriesPerRow;i++){xPositions[i]=curX;curX+=columnWidths[i]}series.attr("transform",function(d,i){return"translate("+xPositions[i%seriesPerRow]+","+(5+Math.floor(i/seriesPerRow)*20)+")"});if(rightAlign){g.attr("transform","translate("+(width-margin.right-legendWidth)+","+margin.top+")")}else{g.attr("transform","translate(0,"+margin.top+")")}height=margin.top+margin.bottom+(Math.ceil(seriesWidths.length/seriesPerRow)*20)}else{var ypos=5,newxpos=5,maxwidth=0,xpos;series.attr("transform",function(d,i){var length=d3.select(this).select("text").node().getComputedTextLength()+28;xpos=newxpos;if(width<margin.left+margin.right+xpos+length){newxpos=xpos=5;ypos+=20}newxpos+=length;if(newxpos>maxwidth){maxwidth=newxpos}return"translate("+xpos+","+ypos+")"});g.attr("transform","translate("+(width-margin.right-maxwidth)+","+margin.top+")");height=margin.top+margin.bottom+ypos+15}});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.key=function(_){if(!arguments.length){return getKey}getKey=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.align=function(_){if(!arguments.length){return align}align=_;return chart};chart.rightAlign=function(_){if(!arguments.length){return rightAlign}rightAlign=_;return chart};chart.updateState=function(_){if(!arguments.length){return updateState}updateState=_;return chart};chart.radioButtonMode=function(_){if(!arguments.length){return radioButtonMode}radioButtonMode=_;return chart};return chart};nv.models.line=function(){var scatter=nv.models.scatter();var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=nv.utils.defaultColor(),getX=function(d){return d.x},getY=function(d){return d.y},defined=function(d,i){return !isNaN(getY(d,i))&&getY(d,i)!==null},isArea=function(d){return d.area},clipEdge=false,x,y,interpolate="linear";scatter.size(16).sizeDomain([16,256]);var x0,y0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x=scatter.xScale();y=scatter.yScale();x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-line").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-line");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");gEnter.append("g").attr("class","nv-scatterWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");scatter.width(availableWidth).height(availableHeight);var scatterWrap=wrap.select(".nv-scatterWrap");scatterWrap.transition().call(scatter);defsEnter.append("clipPath").attr("id","nv-edge-clip-"+scatter.id()).append("rect");wrap.select("#nv-edge-clip-"+scatter.id()+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+scatter.id()+")":"");scatterWrap.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+scatter.id()+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);groups.exit().transition().style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)});groups.transition().style("stroke-opacity",1).style("fill-opacity",0.5);var areaPaths=groups.selectAll("path.nv-area").data(function(d){return isArea(d)?[d]:[]});areaPaths.enter().append("path").attr("class","nv-area").attr("d",function(d){return d3.svg.area().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x0(getX(d,i)))}).y0(function(d,i){return nv.utils.NaNtoZero(y0(getY(d,i)))}).y1(function(d,i){return y0(y.domain()[0]<=0?y.domain()[1]>=0?0:y.domain()[1]:y.domain()[0])}).apply(this,[d.values])});groups.exit().selectAll("path.nv-area").remove();areaPaths.transition().attr("d",function(d){return d3.svg.area().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).y0(function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}).y1(function(d,i){return y(y.domain()[0]<=0?y.domain()[1]>=0?0:y.domain()[1]:y.domain()[0])}).apply(this,[d.values])});var linePaths=groups.selectAll("path.nv-line").data(function(d){return[d.values]});linePaths.enter().append("path").attr("class","nv-line").attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x0(getX(d,i)))}).y(function(d,i){return nv.utils.NaNtoZero(y0(getY(d,i)))}));groups.exit().selectAll("path.nv-line").transition().attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).y(function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}));linePaths.transition().attr("d",d3.svg.line().interpolate(interpolate).defined(defined).x(function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).y(function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}));x0=x.copy();y0=y.copy()});return chart}chart.dispatch=scatter.dispatch;chart.scatter=scatter;d3.rebind(chart,scatter,"id","interactive","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","forceX","forceY","forceSize","clipVoronoi","useVoronoi","clipRadius","padData","highlightPoint","clearHighlights");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;scatter.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;scatter.y(_);return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);scatter.color(color);return chart};chart.interpolate=function(_){if(!arguments.length){return interpolate}interpolate=_;return chart};chart.defined=function(_){if(!arguments.length){return defined}defined=_;return chart};chart.isArea=function(_){if(!arguments.length){return isArea}isArea=d3.functor(_);return chart};return chart};nv.models.lineChart=function(){var lines=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),interactiveLayer=nv.interactiveGuideline();var margin={top:30,right:20,bottom:50,left:60},color=nv.utils.defaultColor(),width=null,height=null,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,useInteractiveGuideline=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,y,state={},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),transitionDuration=250;xAxis.orient("bottom").tickPadding(7);yAxis.orient((rightAlignYAxis)?"right":"left");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=lines.xScale();y=lines.yScale();var wrap=container.selectAll("g.nv-wrap.nv-lineChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-lineChart").append("g");var g=wrap.select("g");gEnter.append("rect").style("opacity",0);gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-linesWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-interactive");g.select("rect").attr("width",availableWidth).attr("height",availableHeight);if(showLegend){legend.width(availableWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}wrap.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}if(useInteractiveGuideline){interactiveLayer.width(availableWidth).height(availableHeight).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x);wrap.select(".nv-interactive").call(interactiveLayer)}lines.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));var linesWrap=g.select(".nv-linesWrap").datum(data.filter(function(d){return !d.disabled}));linesWrap.transition().call(lines);if(showXAxis){xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")");g.select(".nv-x.nv-axis").transition().call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").transition().call(yAxis)}legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});interactiveLayer.dispatch.on("elementMousemove",function(e){lines.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];data.filter(function(series,i){series.seriesIndex=i;return !series.disabled}).forEach(function(series,i){pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x());lines.highlightPoint(i,pointIndex,true);var point=series.values[pointIndex];if(typeof point==="undefined"){return}if(typeof singlePoint==="undefined"){singlePoint=point}if(typeof pointXLocation==="undefined"){pointXLocation=chart.xScale()(chart.x()(point,pointIndex))}allData.push({key:series.key,value:chart.y()(point,pointIndex),color:color(series,series.seriesIndex)})});if(allData.length>2){var yValue=chart.yScale().invert(e.mouseY);var domainExtent=Math.abs(chart.yScale().domain()[0]-chart.yScale().domain()[1]);var threshold=0.03*domainExtent;var indexToHighlight=nv.nearestValueIndex(allData.map(function(d){return d.value}),yValue,threshold);if(indexToHighlight!==null){allData[indexToHighlight].highlight=true}}var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex));interactiveLayer.tooltip.position({left:pointXLocation+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).enabled(tooltips).valueFormatter(function(d,i){return yAxis.tickFormat()(d)}).data({value:xValue,series:allData})();interactiveLayer.renderGuideLine(pointXLocation)});interactiveLayer.dispatch.on("elementMouseout",function(e){dispatch.tooltipHide();lines.clearHighlights()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}chart.update()})});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.lines=lines;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.interactiveLayer=interactiveLayer;d3.rebind(chart,lines,"defined","isArea","x","y","size","xScale","yScale","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","useVoronoi","id","interpolate");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.useInteractiveGuideline=function(_){if(!arguments.length){return useInteractiveGuideline}useInteractiveGuideline=_;if(_===true){chart.interactive(false);chart.useVoronoi(false)}return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.linePlusBarChart=function(){var lines=nv.models.line(),bars=nv.models.historicalBar(),xAxis=nv.models.axis(),y1Axis=nv.models.axis(),y2Axis=nv.models.axis(),legend=nv.models.legend();var margin={top:30,right:60,bottom:50,left:60},width=null,height=null,getX=function(d){return d.x},getY=function(d){return d.y},color=nv.utils.defaultColor(),showLegend=true,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,y1,y2,state={},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState");bars.padData(true);lines.clipEdge(false).padData(true);xAxis.orient("bottom").tickPadding(7).highlightZero(false);y1Axis.orient("left");y2Axis.orient("right");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=(e.series.bar?y1Axis:y2Axis).tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().call(chart)};state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var dataBars=data.filter(function(d){return !d.disabled&&d.bar});var dataLines=data.filter(function(d){return !d.bar});x=dataLines.filter(function(d){return !d.disabled}).length&&dataLines.filter(function(d){return !d.disabled})[0].values.length?lines.xScale():bars.xScale();y1=bars.yScale();y2=lines.yScale();var wrap=d3.select(this).selectAll("g.nv-wrap.nv-linePlusBar").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-linePlusBar").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y1 nv-axis");gEnter.append("g").attr("class","nv-y2 nv-axis");gEnter.append("g").attr("class","nv-barsWrap");gEnter.append("g").attr("class","nv-linesWrap");gEnter.append("g").attr("class","nv-legendWrap");if(showLegend){legend.width(availableWidth/2);g.select(".nv-legendWrap").datum(data.map(function(series){series.originalKey=series.originalKey===undefined?series.key:series.originalKey;series.key=series.originalKey+(series.bar?" (left axis)":" (right axis)");return series})).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate("+(availableWidth/2)+","+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");lines.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&!data[i].bar}));bars.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&data[i].bar}));var barsWrap=g.select(".nv-barsWrap").datum(dataBars.length?dataBars:[{values:[]}]);var linesWrap=g.select(".nv-linesWrap").datum(dataLines[0]&&!dataLines[0].disabled?dataLines:[{values:[]}]);d3.transition(barsWrap).call(bars);d3.transition(linesWrap).call(lines);xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y1.range()[0]+")");d3.transition(g.select(".nv-x.nv-axis")).call(xAxis);y1Axis.scale(y1).ticks(availableHeight/36).tickSize(-availableWidth,0);d3.transition(g.select(".nv-y1.nv-axis")).style("opacity",dataBars.length?1:0).call(y1Axis);y2Axis.scale(y2).ticks(availableHeight/36).tickSize(dataBars.length?0:-availableWidth,0);g.select(".nv-y2.nv-axis").style("opacity",dataLines.length?1:0).attr("transform","translate("+availableWidth+",0)");d3.transition(g.select(".nv-y2.nv-axis")).call(y2Axis);legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}chart.update()})});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});bars.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});bars.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.legend=legend;chart.lines=lines;chart.bars=bars;chart.xAxis=xAxis;chart.y1Axis=y1Axis;chart.y2Axis=y2Axis;d3.rebind(chart,lines,"defined","size","clipVoronoi","interpolate");chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;lines.x(_);bars.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;lines.y(_);bars.y(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.linePlusBarWithFocusChart=function(){var lines=nv.models.line(),lines2=nv.models.line(),bars=nv.models.historicalBar(),bars2=nv.models.historicalBar(),xAxis=nv.models.axis(),x2Axis=nv.models.axis(),y1Axis=nv.models.axis(),y2Axis=nv.models.axis(),y3Axis=nv.models.axis(),y4Axis=nv.models.axis(),legend=nv.models.legend(),brush=d3.svg.brush();var margin={top:30,right:30,bottom:30,left:60},margin2={top:0,right:30,bottom:20,left:60},width=null,height=null,height2=100,getX=function(d){return d.x},getY=function(d){return d.y},color=nv.utils.defaultColor(),showLegend=true,extent,brushExtent=null,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,x2,y1,y2,y3,y4,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","brush"),transitionDuration=0;lines.clipEdge(true);lines2.interactive(false);xAxis.orient("bottom").tickPadding(5);y1Axis.orient("left");y2Axis.orient("right");x2Axis.orient("bottom").tickPadding(5);y3Axis.orient("left");y4Axis.orient("right");var showTooltip=function(e,offsetElement){if(extent){e.pointIndex+=Math.ceil(extent[0])}var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=(e.series.bar?y1Axis:y2Axis).tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight1=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom-height2,availableHeight2=height2-margin2.top-margin2.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight1/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var dataBars=data.filter(function(d){return !d.disabled&&d.bar});var dataLines=data.filter(function(d){return !d.bar});x=bars.xScale();x2=x2Axis.scale();y1=bars.yScale();y2=lines.yScale();y3=bars2.yScale();y4=lines2.yScale();var series1=data.filter(function(d){return !d.disabled&&d.bar}).map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i)}})});var series2=data.filter(function(d){return !d.disabled&&!d.bar}).map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i)}})});x.range([0,availableWidth]);x2.domain(d3.extent(d3.merge(series1.concat(series2)),function(d){return d.x})).range([0,availableWidth]);var wrap=container.selectAll("g.nv-wrap.nv-linePlusBar").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-linePlusBar").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-legendWrap");var focusEnter=gEnter.append("g").attr("class","nv-focus");focusEnter.append("g").attr("class","nv-x nv-axis");focusEnter.append("g").attr("class","nv-y1 nv-axis");focusEnter.append("g").attr("class","nv-y2 nv-axis");focusEnter.append("g").attr("class","nv-barsWrap");focusEnter.append("g").attr("class","nv-linesWrap");var contextEnter=gEnter.append("g").attr("class","nv-context");contextEnter.append("g").attr("class","nv-x nv-axis");contextEnter.append("g").attr("class","nv-y1 nv-axis");contextEnter.append("g").attr("class","nv-y2 nv-axis");contextEnter.append("g").attr("class","nv-barsWrap");contextEnter.append("g").attr("class","nv-linesWrap");contextEnter.append("g").attr("class","nv-brushBackground");contextEnter.append("g").attr("class","nv-x nv-brush");if(showLegend){legend.width(availableWidth/2);g.select(".nv-legendWrap").datum(data.map(function(series){series.originalKey=series.originalKey===undefined?series.key:series.originalKey;series.key=series.originalKey+(series.bar?" (left axis)":" (right axis)");return series})).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight1=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom-height2}g.select(".nv-legendWrap").attr("transform","translate("+(availableWidth/2)+","+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");bars2.width(availableWidth).height(availableHeight2).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&data[i].bar}));lines2.width(availableWidth).height(availableHeight2).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&!data[i].bar}));var bars2Wrap=g.select(".nv-context .nv-barsWrap").datum(dataBars.length?dataBars:[{values:[]}]);var lines2Wrap=g.select(".nv-context .nv-linesWrap").datum(!dataLines[0].disabled?dataLines:[{values:[]}]);g.select(".nv-context").attr("transform","translate(0,"+(availableHeight1+margin.bottom+margin2.top)+")");bars2Wrap.transition().call(bars2);lines2Wrap.transition().call(lines2);brush.x(x2).on("brush",onBrush);if(brushExtent){brush.extent(brushExtent)}var brushBG=g.select(".nv-brushBackground").selectAll("g").data([brushExtent||brush.extent()]);var brushBGenter=brushBG.enter().append("g");brushBGenter.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",availableHeight2);brushBGenter.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",availableHeight2);var gBrush=g.select(".nv-x.nv-brush").call(brush);gBrush.selectAll("rect").attr("height",availableHeight2);gBrush.selectAll(".resize").append("path").attr("d",resizePath);x2Axis.ticks(availableWidth/100).tickSize(-availableHeight2,0);g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y3.range()[0]+")");g.select(".nv-context .nv-x.nv-axis").transition().call(x2Axis);y3Axis.scale(y3).ticks(availableHeight2/36).tickSize(-availableWidth,0);g.select(".nv-context .nv-y1.nv-axis").style("opacity",dataBars.length?1:0).attr("transform","translate(0,"+x2.range()[0]+")");g.select(".nv-context .nv-y1.nv-axis").transition().call(y3Axis);y4Axis.scale(y4).ticks(availableHeight2/36).tickSize(dataBars.length?0:-availableWidth,0);g.select(".nv-context .nv-y2.nv-axis").style("opacity",dataLines.length?1:0).attr("transform","translate("+x2.range()[1]+",0)");g.select(".nv-context .nv-y2.nv-axis").transition().call(y4Axis);legend.dispatch.on("stateChange",function(newState){chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});function resizePath(d){var e=+(d=="e"),x=e?1:-1,y=availableHeight2/3;return"M"+(0.5*x)+","+y+"A6,6 0 0 "+e+" "+(6.5*x)+","+(y+6)+"V"+(2*y-6)+"A6,6 0 0 "+e+" "+(0.5*x)+","+(2*y)+"ZM"+(2.5*x)+","+(y+8)+"V"+(2*y-8)+"M"+(4.5*x)+","+(y+8)+"V"+(2*y-8)}function updateBrushBG(){if(!brush.empty()){brush.extent(brushExtent)}brushBG.data([brush.empty()?x2.domain():brushExtent]).each(function(d,i){var leftWidth=x2(d[0])-x2.range()[0],rightWidth=x2.range()[1]-x2(d[1]);d3.select(this).select(".left").attr("width",leftWidth<0?0:leftWidth);d3.select(this).select(".right").attr("x",x2(d[1])).attr("width",rightWidth<0?0:rightWidth)})}function onBrush(){brushExtent=brush.empty()?null:brush.extent();extent=brush.empty()?x2.domain():brush.extent();dispatch.brush({extent:extent,brush:brush});updateBrushBG();bars.width(availableWidth).height(availableHeight1).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&data[i].bar}));lines.width(availableWidth).height(availableHeight1).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled&&!data[i].bar}));var focusBarsWrap=g.select(".nv-focus .nv-barsWrap").datum(!dataBars.length?[{values:[]}]:dataBars.map(function(d,i){return{key:d.key,values:d.values.filter(function(d,i){return bars.x()(d,i)>=extent[0]&&bars.x()(d,i)<=extent[1]})}}));var focusLinesWrap=g.select(".nv-focus .nv-linesWrap").datum(dataLines[0].disabled?[{values:[]}]:dataLines.map(function(d,i){return{key:d.key,values:d.values.filter(function(d,i){return lines.x()(d,i)>=extent[0]&&lines.x()(d,i)<=extent[1]})}}));if(dataBars.length){x=bars.xScale()}else{x=lines.xScale()}xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight1,0);xAxis.domain([Math.ceil(extent[0]),Math.floor(extent[1])]);g.select(".nv-x.nv-axis").transition().duration(transitionDuration).call(xAxis);focusBarsWrap.transition().duration(transitionDuration).call(bars);focusLinesWrap.transition().duration(transitionDuration).call(lines);g.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+y1.range()[0]+")");y1Axis.scale(y1).ticks(availableHeight1/36).tickSize(-availableWidth,0);g.select(".nv-focus .nv-y1.nv-axis").style("opacity",dataBars.length?1:0);y2Axis.scale(y2).ticks(availableHeight1/36).tickSize(dataBars.length?0:-availableWidth,0);g.select(".nv-focus .nv-y2.nv-axis").style("opacity",dataLines.length?1:0).attr("transform","translate("+x.range()[1]+",0)");g.select(".nv-focus .nv-y1.nv-axis").transition().duration(transitionDuration).call(y1Axis);g.select(".nv-focus .nv-y2.nv-axis").transition().duration(transitionDuration).call(y2Axis)}onBrush()});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});bars.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});bars.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.legend=legend;chart.lines=lines;chart.lines2=lines2;chart.bars=bars;chart.bars2=bars2;chart.xAxis=xAxis;chart.x2Axis=x2Axis;chart.y1Axis=y1Axis;chart.y2Axis=y2Axis;chart.y3Axis=y3Axis;chart.y4Axis=y4Axis;d3.rebind(chart,lines,"defined","size","clipVoronoi","interpolate");chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;lines.x(_);bars.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;lines.y(_);bars.y(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.brushExtent=function(_){if(!arguments.length){return brushExtent}brushExtent=_;return chart};return chart};nv.models.line=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=nv.utils.defaultColor(),id=Math.floor(Math.random()*10000),getX=function(d){return d.x},getY=function(d){return d.y},clipEdge=false,interpolate="linear";var scatter=nv.models.scatter().id(id).size(16).sizeDomain([16,256]),x,y,x0,y0,timeoutID;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom;x=x||scatter.xScale();y=y||scatter.yScale();x0=x0||x;y0=y0||y;var wrap=d3.select(this).selectAll("g.nv-wrap.nv-line").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-line");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");wrapEnter.append("g").attr("class","nv-scatterWrap");var scatterWrap=wrap.select(".nv-scatterWrap").datum(data);gEnter.append("g").attr("class","nv-groups");scatter.width(availableWidth).height(availableHeight);d3.transition(scatterWrap).call(scatter);wrap.attr("transform","translate("+margin.left+","+margin.top+")");defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");scatterWrap.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);d3.transition(groups.exit()).style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)});d3.transition(groups).style("stroke-opacity",1).style("fill-opacity",0.5);var paths=groups.selectAll("path").data(function(d,i){return[d.values]});paths.enter().append("path").attr("class","nv-line").attr("d",d3.svg.line().interpolate(interpolate).x(function(d,i){return x0(getX(d,i))}).y(function(d,i){return y0(getY(d,i))}));d3.transition(groups.exit().selectAll("path")).attr("d",d3.svg.line().interpolate(interpolate).x(function(d,i){return x(getX(d,i))}).y(function(d,i){return y(getY(d,i))})).remove();d3.transition(paths).attr("d",d3.svg.line().interpolate(interpolate).x(function(d,i){return x(getX(d,i))}).y(function(d,i){return y(getY(d,i))}));x0=x.copy();y0=y.copy()});return chart}chart.dispatch=scatter.dispatch;d3.rebind(chart,scatter,"interactive","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","forceX","forceY","forceSize","clipVoronoi","clipRadius");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin=_;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;scatter.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;scatter.y(_);return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);scatter.color(color);return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.interpolate=function(_){if(!arguments.length){return interpolate}interpolate=_;return chart};chart.defined=function(_){if(!arguments.length){return defined}defined=_;return chart};return chart};nv.models.lineChart=function(){var margin={top:30,right:20,bottom:50,left:60},color=nv.utils.defaultColor(),width=null,height=null,showLegend=true,showControls=true,fisheye=0,pauseFisheye=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},noData="No Data Available.";var x=d3.fisheye.scale(d3.scale.linear).distortion(0);var lines=nv.models.line().xScale(x),y=lines.yScale(),xAxis=nv.models.axis().scale(x).orient("bottom").tickPadding(5),yAxis=nv.models.axis().scale(y).orient("left"),legend=nv.models.legend().height(30),controls=nv.models.legend().height(30).updateState(false),dispatch=d3.dispatch("tooltipShow","tooltipHide");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,null,null,offsetElement)};var controlsData=[{key:"Magnify",disabled:true}];function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){container.append("text").attr("class","nvd3 nv-noData").attr("x",availableWidth/2).attr("y",availableHeight/2).attr("dy","-.7em").style("text-anchor","middle").text(noData);return chart}else{container.select(".nv-noData").remove()}var wrap=container.selectAll("g.nv-wrap.nv-lineChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-lineChart").append("g");gEnter.append("rect").attr("class","nvd3 nv-background").attr("width",availableWidth).attr("height",availableHeight);gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-linesWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");gEnter.append("g").attr("class","nv-controlsWrap");var g=wrap.select("g");if(showLegend){legend.width(availableWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}if(showControls){controls.width(180).color(["#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}lines.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));g.attr("transform","translate("+margin.left+","+margin.top+")");var linesWrap=g.select(".nv-linesWrap").datum(data.filter(function(d){return !d.disabled}));d3.transition(linesWrap).call(lines);xAxis.ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")");d3.transition(g.select(".nv-x.nv-axis")).call(xAxis);yAxis.ticks(availableHeight/36).tickSize(-availableWidth,0);d3.transition(g.select(".nv-y.nv-axis")).call(yAxis);g.select(".nv-background").on("mousemove",updateFisheye);g.select(".nv-background").on("click",function(){pauseFisheye=!pauseFisheye});function updateFisheye(){if(pauseFisheye){g.select(".nv-point-paths").style("pointer-events","all");return false}g.select(".nv-background").style("pointer-events","all");g.select(".nv-point-paths").style("pointer-events","none");var mouse=d3.mouse(this);linesWrap.call(lines);g.select(".nv-x.nv-axis").call(xAxis);x.distortion(fisheye).focus(mouse[0])}controls.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;fisheye=d.disabled?0:5;g.select(".nv-background").style("pointer-events",d.disabled?"none":"all");g.select(".nv-point-paths").style("pointer-events",d.disabled?"all":"none");if(d.disabled){x.distortion(fisheye).focus(0);linesWrap.call(lines);g.select(".nv-x.nv-axis").call(xAxis)}else{pauseFisheye=false}chart.update()});legend.dispatch.on("stateChange",function(newState){chart.update()});lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});if(tooltips){dispatch.on("tooltipShow",function(e){showTooltip(e,that.parentNode)})}lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});if(tooltips){dispatch.on("tooltipHide",nv.tooltip.cleanup)}});return chart}chart.dispatch=dispatch;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,lines,"defined","x","y","size","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","id","interpolate");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin=_;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.lineWithFocusChart=function(){var lines=nv.models.line(),lines2=nv.models.line(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),x2Axis=nv.models.axis(),y2Axis=nv.models.axis(),legend=nv.models.legend(),brush=d3.svg.brush();var margin={top:30,right:30,bottom:30,left:60},margin2={top:0,right:30,bottom:20,left:60},color=nv.utils.defaultColor(),width=null,height=null,height2=100,x,y,x2,y2,showLegend=true,brushExtent=null,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","brush"),transitionDuration=250;lines.clipEdge(true);lines2.interactive(false);xAxis.orient("bottom").tickPadding(5);yAxis.orient("left");x2Axis.orient("bottom").tickPadding(5);y2Axis.orient("left");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(lines.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,null,null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight1=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom-height2,availableHeight2=height2-margin2.top-margin2.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight1/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=lines.xScale();y=lines.yScale();x2=lines2.xScale();y2=lines2.yScale();var wrap=container.selectAll("g.nv-wrap.nv-lineWithFocusChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-lineWithFocusChart").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-legendWrap");var focusEnter=gEnter.append("g").attr("class","nv-focus");focusEnter.append("g").attr("class","nv-x nv-axis");focusEnter.append("g").attr("class","nv-y nv-axis");focusEnter.append("g").attr("class","nv-linesWrap");var contextEnter=gEnter.append("g").attr("class","nv-context");contextEnter.append("g").attr("class","nv-x nv-axis");contextEnter.append("g").attr("class","nv-y nv-axis");contextEnter.append("g").attr("class","nv-linesWrap");contextEnter.append("g").attr("class","nv-brushBackground");contextEnter.append("g").attr("class","nv-x nv-brush");if(showLegend){legend.width(availableWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight1=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom-height2}g.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");lines.width(availableWidth).height(availableHeight1).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));lines2.defined(lines.defined()).width(availableWidth).height(availableHeight2).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));g.select(".nv-context").attr("transform","translate(0,"+(availableHeight1+margin.bottom+margin2.top)+")");var contextLinesWrap=g.select(".nv-context .nv-linesWrap").datum(data.filter(function(d){return !d.disabled}));d3.transition(contextLinesWrap).call(lines2);xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight1,0);yAxis.scale(y).ticks(availableHeight1/36).tickSize(-availableWidth,0);g.select(".nv-focus .nv-x.nv-axis").attr("transform","translate(0,"+availableHeight1+")");brush.x(x2).on("brush",function(){var oldTransition=chart.transitionDuration();chart.transitionDuration(0);onBrush();chart.transitionDuration(oldTransition)});if(brushExtent){brush.extent(brushExtent)}var brushBG=g.select(".nv-brushBackground").selectAll("g").data([brushExtent||brush.extent()]);var brushBGenter=brushBG.enter().append("g");brushBGenter.append("rect").attr("class","left").attr("x",0).attr("y",0).attr("height",availableHeight2);brushBGenter.append("rect").attr("class","right").attr("x",0).attr("y",0).attr("height",availableHeight2);var gBrush=g.select(".nv-x.nv-brush").call(brush);gBrush.selectAll("rect").attr("height",availableHeight2);gBrush.selectAll(".resize").append("path").attr("d",resizePath);onBrush();x2Axis.scale(x2).ticks(availableWidth/100).tickSize(-availableHeight2,0);g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y2.range()[0]+")");d3.transition(g.select(".nv-context .nv-x.nv-axis")).call(x2Axis);y2Axis.scale(y2).ticks(availableHeight2/36).tickSize(-availableWidth,0);d3.transition(g.select(".nv-context .nv-y.nv-axis")).call(y2Axis);g.select(".nv-context .nv-x.nv-axis").attr("transform","translate(0,"+y2.range()[0]+")");legend.dispatch.on("stateChange",function(newState){chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});function resizePath(d){var e=+(d=="e"),x=e?1:-1,y=availableHeight2/3;return"M"+(0.5*x)+","+y+"A6,6 0 0 "+e+" "+(6.5*x)+","+(y+6)+"V"+(2*y-6)+"A6,6 0 0 "+e+" "+(0.5*x)+","+(2*y)+"ZM"+(2.5*x)+","+(y+8)+"V"+(2*y-8)+"M"+(4.5*x)+","+(y+8)+"V"+(2*y-8)}function updateBrushBG(){if(!brush.empty()){brush.extent(brushExtent)}brushBG.data([brush.empty()?x2.domain():brushExtent]).each(function(d,i){var leftWidth=x2(d[0])-x.range()[0],rightWidth=x.range()[1]-x2(d[1]);d3.select(this).select(".left").attr("width",leftWidth<0?0:leftWidth);d3.select(this).select(".right").attr("x",x2(d[1])).attr("width",rightWidth<0?0:rightWidth)})}function onBrush(){brushExtent=brush.empty()?null:brush.extent();var extent=brush.empty()?x2.domain():brush.extent();if(Math.abs(extent[0]-extent[1])<=1){return}dispatch.brush({extent:extent,brush:brush});updateBrushBG();var focusLinesWrap=g.select(".nv-focus .nv-linesWrap").datum(data.filter(function(d){return !d.disabled}).map(function(d,i){return{key:d.key,values:d.values.filter(function(d,i){return lines.x()(d,i)>=extent[0]&&lines.x()(d,i)<=extent[1]})}}));focusLinesWrap.transition().duration(transitionDuration).call(lines);g.select(".nv-focus .nv-x.nv-axis").transition().duration(transitionDuration).call(xAxis);g.select(".nv-focus .nv-y.nv-axis").transition().duration(transitionDuration).call(yAxis)}});return chart}lines.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.legend=legend;chart.lines=lines;chart.lines2=lines2;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.x2Axis=x2Axis;chart.y2Axis=y2Axis;d3.rebind(chart,lines,"defined","isArea","size","xDomain","yDomain","xRange","yRange","forceX","forceY","interactive","clipEdge","clipVoronoi","id");chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return lines.x}lines.x(_);lines2.x(_);return chart};chart.y=function(_){if(!arguments.length){return lines.y}lines.y(_);lines2.y(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.margin2=function(_){if(!arguments.length){return margin2}margin2=_;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.height2=function(_){if(!arguments.length){return height2}height2=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.interpolate=function(_){if(!arguments.length){return lines.interpolate()}lines.interpolate(_);lines2.interpolate(_);return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.xTickFormat=function(_){if(!arguments.length){return xAxis.tickFormat()}xAxis.tickFormat(_);x2Axis.tickFormat(_);return chart};chart.yTickFormat=function(_){if(!arguments.length){return yAxis.tickFormat()}yAxis.tickFormat(_);y2Axis.tickFormat(_);return chart};chart.brushExtent=function(_){if(!arguments.length){return brushExtent}brushExtent=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.multiBar=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,x=d3.scale.ordinal(),y=d3.scale.linear(),id=Math.floor(Math.random()*10000),getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],clipEdge=true,stacked=false,stackOffset="zero",color=nv.utils.defaultColor(),hideable=false,barColor=null,disabled,delay=1200,xDomain,yDomain,xRange,yRange,groupSpacing=0.1,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");var x0,y0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);if(hideable&&data.length){hideable=[{values:data[0].values.map(function(d){return{x:d.x,y:0,series:d.series,size:0.01}})}]}if(stacked){data=d3.layout.stack().offset(stackOffset).values(function(d){return d.values}).y(getY)(!data.length&&hideable?hideable:data)}data.forEach(function(series,i){series.values.forEach(function(point){point.series=i})});if(stacked){data[0].values.map(function(d,i){var posBase=0,negBase=0;data.map(function(d){var f=d.values[i];f.size=Math.abs(f.y);if(f.y<0){f.y1=negBase;negBase=negBase-f.size}else{f.y1=f.size+posBase;posBase=posBase+f.size}})})}var seriesData=(xDomain&&yDomain)?[]:data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0,y1:d.y1}})});x.domain(xDomain||d3.merge(seriesData).map(function(d){return d.x})).rangeBands(xRange||[0,availableWidth],groupSpacing);y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){return stacked?(d.y>0?d.y1:d.y1+d.y):d.y}).concat(forceY))).range(yRange||[availableHeight,0]);if(x.domain()[0]===x.domain()[1]){x.domain()[0]?x.domain([x.domain()[0]-x.domain()[0]*0.01,x.domain()[1]+x.domain()[1]*0.01]):x.domain([-1,1])}if(y.domain()[0]===y.domain()[1]){y.domain()[0]?y.domain([y.domain()[0]+y.domain()[0]*0.01,y.domain()[1]-y.domain()[1]*0.01]):y.domain([-1,1])}x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-multibar").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multibar");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");wrap.attr("transform","translate("+margin.left+","+margin.top+")");defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d,i){return i});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);groups.exit().transition().selectAll("rect.nv-bar").delay(function(d,i){return i*delay/data[0].values.length}).attr("y",function(d){return stacked?y0(d.y0):y0(0)}).attr("height",0).remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)});groups.transition().style("stroke-opacity",1).style("fill-opacity",0.75);var bars=groups.selectAll("rect.nv-bar").data(function(d){return(hideable&&!data.length)?hideable.values:d.values});bars.exit().remove();var barsEnter=bars.enter().append("rect").attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).attr("x",function(d,i,j){return stacked?0:(j*x.rangeBand()/data.length)}).attr("y",function(d){return y0(stacked?d.y0:0)}).attr("height",0).attr("width",x.rangeBand()/(stacked?1:data.length)).attr("transform",function(d,i){return"translate("+x(getX(d,i))+",0)"});bars.style("fill",function(d,i,j){return color(d,j,i)}).style("stroke",function(d,i,j){return color(d,j,i)}).on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({value:getY(d,i),point:d,series:data[d.series],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("click",function(d,i){dispatch.elementClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()});bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).transition().attr("transform",function(d,i){return"translate("+x(getX(d,i))+",0)"});if(barColor){if(!disabled){disabled=data.map(function(){return true})}bars.style("fill",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return !disabled[i]})[j]).toString()}).style("stroke",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return !disabled[i]})[j]).toString()})}if(stacked){bars.transition().delay(function(d,i){return i*delay/data[0].values.length}).attr("y",function(d,i){return y((stacked?d.y1:0))}).attr("height",function(d,i){return Math.max(Math.abs(y(d.y+(stacked?d.y0:0))-y((stacked?d.y0:0))),1)}).attr("x",function(d,i){return stacked?0:(d.series*x.rangeBand()/data.length)}).attr("width",x.rangeBand()/(stacked?1:data.length))}else{bars.transition().delay(function(d,i){return i*delay/data[0].values.length}).attr("x",function(d,i){return d.series*x.rangeBand()/data.length}).attr("width",x.rangeBand()/data.length).attr("y",function(d,i){return getY(d,i)<0?y(0):y(0)-y(getY(d,i))<1?y(0)-1:y(getY(d,i))||0}).attr("height",function(d,i){return Math.max(Math.abs(y(getY(d,i))-y(0)),1)||0})}x0=x.copy();y0=y.copy()});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.stacked=function(_){if(!arguments.length){return stacked}stacked=_;return chart};chart.stackOffset=function(_){if(!arguments.length){return stackOffset}stackOffset=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.barColor=function(_){if(!arguments.length){return barColor}barColor=nv.utils.getColor(_);return chart};chart.disabled=function(_){if(!arguments.length){return disabled}disabled=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.hideable=function(_){if(!arguments.length){return hideable}hideable=_;return chart};chart.delay=function(_){if(!arguments.length){return delay}delay=_;return chart};chart.groupSpacing=function(_){if(!arguments.length){return groupSpacing}groupSpacing=_;return chart};return chart};nv.models.multiBarChart=function(){var multibar=nv.models.multiBar(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend();var margin={top:30,right:20,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=true,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,reduceXTicks=true,staggerLabels=false,rotateLabels=0,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" on "+x+"</p>"},x,y,state={stacked:false},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),controlWidth=function(){return showControls?180:0},transitionDuration=250;multibar.stacked(false);xAxis.orient("bottom").tickPadding(7).highlightZero(true).showMaxMin(false).tickFormat(function(d){return d});yAxis.orient((rightAlignYAxis)?"right":"left").tickFormat(d3.format(",.1f"));controls.updateState(false);var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(multibar.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(multibar.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=multibar.xScale();y=multibar.yScale();var wrap=container.selectAll("g.nv-wrap.nv-multiBarWithLegend").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarWithLegend").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-barsWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");if(showLegend){legend.width(availableWidth-controlWidth());if(multibar.barColor()){data.forEach(function(series,i){series.color=d3.rgb("#ccc").darker(i*1.5).toString()})}g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate("+controlWidth()+","+(-margin.top)+")")}if(showControls){var controlsData=[{key:"Grouped",disabled:multibar.stacked()},{key:"Stacked",disabled:!multibar.stacked()}];controls.width(controlWidth()).color(["#444","#444","#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}multibar.disabled(data.map(function(series){return series.disabled})).width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return !d.disabled}));barsWrap.transition().call(multibar);if(showXAxis){xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")");g.select(".nv-x.nv-axis").transition().call(xAxis);var xTicks=g.select(".nv-x.nv-axis > g").selectAll("g");xTicks.selectAll("line, text").style("opacity",1);if(staggerLabels){var getTranslate=function(x,y){return"translate("+x+","+y+")"};var staggerUp=5,staggerDown=17;xTicks.selectAll("text").attr("transform",function(d,i,j){return getTranslate(0,(j%2==0?staggerUp:staggerDown))});var totalInBetweenTicks=d3.selectAll(".nv-x.nv-axis .nv-wrap g g text")[0].length;g.selectAll(".nv-x.nv-axis .nv-axisMaxMin text").attr("transform",function(d,i){return getTranslate(0,(i===0||totalInBetweenTicks%2!==0)?staggerDown:staggerUp)})}if(reduceXTicks){xTicks.filter(function(d,i){return i%Math.ceil(data[0].values.length/(availableWidth/100))!==0}).selectAll("text, line").style("opacity",0)}if(rotateLabels){xTicks.selectAll(".tick text").attr("transform","rotate("+rotateLabels+" 0,0)").style("text-anchor",rotateLabels>0?"start":"end")}g.select(".nv-x.nv-axis").selectAll("g.nv-axisMaxMin text").style("opacity",1)}if(showYAxis){yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").transition().call(yAxis)}legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});controls.dispatch.on("legendClick",function(d,i){if(!d.disabled){return}controlsData=controlsData.map(function(s){s.disabled=true;return s});d.disabled=false;switch(d.key){case"Grouped":multibar.stacked(false);break;case"Stacked":multibar.stacked(true);break}state.stacked=multibar.stacked();dispatch.stateChange(state);chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}if(typeof e.stacked!=="undefined"){multibar.stacked(e.stacked);state.stacked=e.stacked}chart.update()})});return chart}multibar.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});multibar.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.multibar=multibar;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,multibar,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","clipEdge","id","stacked","stackOffset","delay","barColor","groupSpacing");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.reduceXTicks=function(_){if(!arguments.length){return reduceXTicks}reduceXTicks=_;return chart};chart.rotateLabels=function(_){if(!arguments.length){return rotateLabels}rotateLabels=_;return chart};chart.staggerLabels=function(_){if(!arguments.length){return staggerLabels}staggerLabels=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.multiBarHorizontal=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(Math.random()*10000),x=d3.scale.ordinal(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],color=nv.utils.defaultColor(),barColor=null,disabled,stacked=false,showValues=false,valuePadding=60,valueFormat=d3.format(",.2f"),delay=1200,xDomain,yDomain,xRange,yRange,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");var x0,y0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);if(stacked){data=d3.layout.stack().offset("zero").values(function(d){return d.values}).y(getY)(data)}data.forEach(function(series,i){series.values.forEach(function(point){point.series=i})});if(stacked){data[0].values.map(function(d,i){var posBase=0,negBase=0;data.map(function(d){var f=d.values[i];f.size=Math.abs(f.y);if(f.y<0){f.y1=negBase-f.size;negBase=negBase-f.size}else{f.y1=posBase;posBase=posBase+f.size}})})}var seriesData=(xDomain&&yDomain)?[]:data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0,y1:d.y1}})});x.domain(xDomain||d3.merge(seriesData).map(function(d){return d.x})).rangeBands(xRange||[0,availableHeight],0.1);y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){return stacked?(d.y>0?d.y1+d.y:d.y1):d.y}).concat(forceY)));if(showValues&&!stacked){y.range(yRange||[(y.domain()[0]<0?valuePadding:0),availableWidth-(y.domain()[1]>0?valuePadding:0)])}else{y.range(yRange||[0,availableWidth])}x0=x0||x;y0=y0||d3.scale.linear().domain(y.domain()).range([y(0),y(0)]);var wrap=d3.select(this).selectAll("g.nv-wrap.nv-multibarHorizontal").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multibarHorizontal");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d,i){return i});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);groups.exit().transition().style("stroke-opacity",0.000001).style("fill-opacity",0.000001).remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)});groups.transition().style("stroke-opacity",1).style("fill-opacity",0.75);var bars=groups.selectAll("g.nv-bar").data(function(d){return d.values});bars.exit().remove();var barsEnter=bars.enter().append("g").attr("transform",function(d,i,j){return"translate("+y0(stacked?d.y0:0)+","+(stacked?0:(j*x.rangeBand()/data.length)+x(getX(d,i)))+")"});barsEnter.append("rect").attr("width",0).attr("height",x.rangeBand()/(stacked?1:data.length));bars.on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({value:getY(d,i),point:d,series:data[d.series],pos:[y(getY(d,i)+(stacked?d.y0:0)),x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length)],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({value:getY(d,i),point:d,series:data[d.series],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("click",function(d,i){dispatch.elementClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(x.rangeBand()*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()});barsEnter.append("text");if(showValues&&!stacked){bars.select("text").attr("text-anchor",function(d,i){return getY(d,i)<0?"end":"start"}).attr("y",x.rangeBand()/(data.length*2)).attr("dy",".32em").text(function(d,i){return valueFormat(getY(d,i))});bars.transition().select("text").attr("x",function(d,i){return getY(d,i)<0?-4:y(getY(d,i))-y(0)+4})}else{bars.selectAll("text").text("")}bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"});if(barColor){if(!disabled){disabled=data.map(function(){return true})}bars.style("fill",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return !disabled[i]})[j]).toString()}).style("stroke",function(d,i,j){return d3.rgb(barColor(d,i)).darker(disabled.map(function(d,i){return i}).filter(function(d,i){return !disabled[i]})[j]).toString()})}if(stacked){bars.transition().attr("transform",function(d,i){return"translate("+y(d.y1)+","+x(getX(d,i))+")"}).select("rect").attr("width",function(d,i){return Math.abs(y(getY(d,i)+d.y0)-y(d.y0))}).attr("height",x.rangeBand())}else{bars.transition().attr("transform",function(d,i){return"translate("+(getY(d,i)<0?y(getY(d,i)):y(0))+","+(d.series*x.rangeBand()/data.length+x(getX(d,i)))+")"}).select("rect").attr("height",x.rangeBand()/data.length).attr("width",function(d,i){return Math.max(Math.abs(y(getY(d,i))-y(0)),1)})}x0=x.copy();y0=y.copy()});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.stacked=function(_){if(!arguments.length){return stacked}stacked=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.barColor=function(_){if(!arguments.length){return barColor}barColor=nv.utils.getColor(_);return chart};chart.disabled=function(_){if(!arguments.length){return disabled}disabled=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.delay=function(_){if(!arguments.length){return delay}delay=_;return chart};chart.showValues=function(_){if(!arguments.length){return showValues}showValues=_;return chart};chart.valueFormat=function(_){if(!arguments.length){return valueFormat}valueFormat=_;return chart};chart.valuePadding=function(_){if(!arguments.length){return valuePadding}valuePadding=_;return chart};return chart};nv.models.multiBarHorizontalChart=function(){var multibar=nv.models.multiBarHorizontal(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend().height(30),controls=nv.models.legend().height(30);var margin={top:30,right:20,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=true,showLegend=true,stacked=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+" - "+x+"</h3><p>"+y+"</p>"},x,y,state={stacked:stacked},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),controlWidth=function(){return showControls?180:0},transitionDuration=250;multibar.stacked(stacked);xAxis.orient("left").tickPadding(5).highlightZero(false).showMaxMin(false).tickFormat(function(d){return d});yAxis.orient("bottom").tickFormat(d3.format(",.1f"));controls.updateState(false);var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(multibar.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(multibar.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"e":"w",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=multibar.xScale();y=multibar.yScale();var wrap=container.selectAll("g.nv-wrap.nv-multiBarHorizontalChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarHorizontalChart").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-barsWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");if(showLegend){legend.width(availableWidth-controlWidth());if(multibar.barColor()){data.forEach(function(series,i){series.color=d3.rgb("#ccc").darker(i*1.5).toString()})}g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate("+controlWidth()+","+(-margin.top)+")")}if(showControls){var controlsData=[{key:"Grouped",disabled:multibar.stacked()},{key:"Stacked",disabled:!multibar.stacked()}];controls.width(controlWidth()).color(["#444","#444","#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")");multibar.disabled(data.map(function(series){return series.disabled})).width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return !d.disabled}));barsWrap.transition().call(multibar);xAxis.scale(x).ticks(availableHeight/24).tickSize(-availableWidth,0);g.select(".nv-x.nv-axis").transition().call(xAxis);var xTicks=g.select(".nv-x.nv-axis").selectAll("g");xTicks.selectAll("line, text").style("opacity",1);yAxis.scale(y).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-y.nv-axis").attr("transform","translate(0,"+availableHeight+")");g.select(".nv-y.nv-axis").transition().call(yAxis);legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});controls.dispatch.on("legendClick",function(d,i){if(!d.disabled){return}controlsData=controlsData.map(function(s){s.disabled=true;return s});d.disabled=false;switch(d.key){case"Grouped":multibar.stacked(false);break;case"Stacked":multibar.stacked(true);break}state.stacked=multibar.stacked();dispatch.stateChange(state);chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}if(typeof e.stacked!=="undefined"){multibar.stacked(e.stacked);state.stacked=e.stacked}selection.call(chart)})});return chart}multibar.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});multibar.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.multibar=multibar;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,multibar,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","clipEdge","id","delay","showValues","valueFormat","stacked","barColor");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.multiBarTimeSeries=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,x=d3.time.scale(),y=d3.scale.linear(),id=Math.floor(Math.random()*10000),getX=function(d){return d.x},getY=function(d){return d.y},forceY=[0],clipEdge=true,stacked=false,color=nv.utils.defaultColor(),delay=1200,xDomain,yDomain,xRange,yRange,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");var x0,y0;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);if(stacked){data=d3.layout.stack().offset("zero").values(function(d){return d.values}).y(getY)(data)}data.forEach(function(series,i){series.values.forEach(function(point){point.series=i})});var seriesData=(xDomain&&yDomain)?[]:data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),y0:d.y0}})});x.domain(xDomain||d3.extent(d3.merge(seriesData).map(function(d){return d.x}))).range(xRange||[0,availableWidth]);y.domain(yDomain||d3.extent(d3.merge(seriesData).map(function(d){return d.y+(stacked?d.y0:0)}).concat(forceY))).range(yRange||[availableHeight,0]);if(x.domain()[0]===x.domain()[1]){x.domain()[0]?x.domain([x.domain()[0]-x.domain()[0]*0.01,x.domain()[1]+x.domain()[1]*0.01]):x.domain([-1,1])}if(y.domain()[0]===y.domain()[1]){y.domain()[0]?y.domain([y.domain()[0]+y.domain()[0]*0.01,y.domain()[1]-y.domain()[1]*0.01]):y.domain([-1,1])}x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-multibar").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multibar");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");wrap.attr("transform","translate("+margin.left+","+margin.top+")");defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);d3.transition(groups.exit()).selectAll("rect.nv-bar").delay(function(d,i){return i*delay/data[0].values.length}).attr("y",function(d){return stacked?y0(d.y0):y0(0)}).attr("height",0).remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover}).style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)});d3.transition(groups).style("stroke-opacity",1).style("fill-opacity",0.75);var bars=groups.selectAll("rect.nv-bar").data(function(d){return d.values});bars.exit().remove();var maxElements=0;for(var ei=0;ei<seriesData.length;ei+=1){maxElements=Math.max(seriesData[ei].length,maxElements)}var bandWidth=(availableWidth/maxElements)-0.1;var barWidth=bandWidth/data.length;var barsEnter=bars.enter().append("rect").attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).attr("x",function(d,i,j){return stacked?0:(i*bandWidth)+(j*barWidth)}).attr("y",function(d){return y0(stacked?d.y0:0)}).attr("height",0).attr("width",stacked?bandWidth:barWidth);bars.on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(barWidth*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({value:getY(d,i),point:d,series:data[d.series],pointIndex:i,seriesIndex:d.series,e:d3.event})}).on("click",function(d,i){dispatch.elementClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(barWidth*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({value:getY(d,i),point:d,series:data[d.series],pos:[x(getX(d,i))+(barWidth*(stacked?data.length/2:d.series+0.5)/data.length),y(getY(d,i)+(stacked?d.y0:0))],pointIndex:i,seriesIndex:d.series,e:d3.event});d3.event.stopPropagation()});bars.attr("class",function(d,i){return getY(d,i)<0?"nv-bar negative":"nv-bar positive"}).attr("transform",function(d,i){return"translate("+x(getX(d,i))+",0)"});if(stacked){d3.transition(bars).delay(function(d,i){return i*delay/data[0].values.length}).attr("y",function(d,i){return y(getY(d,i)+(stacked?d.y0:0))}).attr("height",function(d,i){return Math.abs(y(d.y+(stacked?d.y0:0))-y((stacked?d.y0:0)))}).each("end",function(){d3.transition(d3.select(this)).attr("x",function(d,i){return stacked?0:(i*bandWidth)+(j*barWidth)}).attr("width",stacked?bandWidth:barWidth)})}else{d3.transition(bars).delay(function(d,i){return i*delay/data[0].values.length}).attr("x",function(d,i){return d.series*barWidth}).attr("width",barWidth).each("end",function(){d3.transition(d3.select(this)).attr("y",function(d,i){return getY(d,i)<0?y(0):y(getY(d,i))}).attr("height",function(d,i){return Math.abs(y(getY(d,i))-y(0))})})}x0=x.copy();y0=y.copy()});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.stacked=function(_){if(!arguments.length){return stacked}stacked=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.delay=function(_){if(!arguments.length){return delay}delay=_;return chart};return chart};nv.models.multiBarTimeSeriesChart=function(){var multibar=nv.models.multiBarTimeSeries(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend();var margin={top:30,right:20,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=true,showLegend=true,reduceXTicks=true,rotateLabels=0,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" on "+x+"</p>"},x,y,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide");multibar.stacked(false);xAxis.orient("bottom").tickPadding(7).highlightZero(false).showMaxMin(false);yAxis.orient("left").tickFormat(d3.format(",.1f"));var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(multibar.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(multibar.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){selection.transition().call(chart)};chart.container=this;if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=multibar.xScale();y=multibar.yScale();var wrap=container.selectAll("g.nv-wrap.nv-multiBarWithLegend").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-multiBarWithLegend").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-barsWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");if(showLegend){legend.width(availableWidth/2);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate("+(availableWidth/2)+","+(-margin.top)+")")}if(showControls){var controlsData=[{key:"Grouped",disabled:multibar.stacked()},{key:"Stacked",disabled:!multibar.stacked()}];controls.width(180).color(["#444","#444","#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")");multibar.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));var barsWrap=g.select(".nv-barsWrap").datum(data.filter(function(d){return !d.disabled}));d3.transition(barsWrap).call(multibar);xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")");d3.transition(g.select(".nv-x.nv-axis")).call(xAxis);var xTicks=g.select(".nv-x.nv-axis > g").selectAll("g");xTicks.selectAll("line, text").style("opacity",1);if(reduceXTicks){xTicks.filter(function(d,i){return i%Math.ceil(data[0].values.length/(availableWidth/100))!==0}).selectAll("text, line").style("opacity",0)}if(rotateLabels){xTicks.selectAll("text").attr("transform",function(d,i,j){return"rotate("+rotateLabels+" 0,0)"}).attr("text-transform",rotateLabels>0?"start":"end")}yAxis.scale(y).ticks(availableHeight/36).tickSize(-availableWidth,0);d3.transition(g.select(".nv-y.nv-axis")).call(yAxis);legend.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;if(!data.filter(function(d){return !d.disabled}).length){data.map(function(d){d.disabled=false;wrap.selectAll(".nv-series").classed("disabled",false);return d})}selection.transition().call(chart)});controls.dispatch.on("legendClick",function(d,i){if(!d.disabled){return}controlsData=controlsData.map(function(s){s.disabled=true;return s});d.disabled=false;switch(d.key){case"Grouped":multibar.stacked(false);break;case"Stacked":multibar.stacked(true);break}selection.transition().call(chart)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}})});return chart}multibar.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});multibar.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.multibar=multibar;chart.legend=legend;chart.xAxis=xAxis;chart.yAxis=yAxis;d3.rebind(chart,multibar,"x","y","xDomain","yDomain","xRange","yRange","forceX","forceY","clipEdge","id","stacked","delay");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.reduceXTicks=function(_){if(!arguments.length){return reduceXTicks}reduceXTicks=_;return chart};chart.rotateLabels=function(_){if(!arguments.length){return rotateLabels}rotateLabels=_;return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.multiChart=function(){var margin={top:30,right:20,bottom:50,left:60},color=d3.scale.category20().range(),width=null,height=null,showLegend=true,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" at "+x+"</p>"},x,y,yDomain1,yDomain2;var x=d3.scale.linear(),yScale1=d3.scale.linear(),yScale2=d3.scale.linear(),lines1=nv.models.line().yScale(yScale1),lines2=nv.models.line().yScale(yScale2),bars1=nv.models.multiBar().stacked(false).yScale(yScale1),bars2=nv.models.multiBar().stacked(false).yScale(yScale2),stack1=nv.models.stackedArea().yScale(yScale1),stack2=nv.models.stackedArea().yScale(yScale2),xAxis=nv.models.axis().scale(x).orient("bottom").tickPadding(5),yAxis1=nv.models.axis().scale(yScale1).orient("left"),yAxis2=nv.models.axis().scale(yScale2).orient("right"),legend=nv.models.legend().height(30),dispatch=d3.dispatch("tooltipShow","tooltipHide");var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(lines1.x()(e.point,e.pointIndex)),y=((e.series.yAxis==2)?yAxis2:yAxis1).tickFormat()(lines1.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,undefined,undefined,offsetElement.offsetParent)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;chart.update=function(){container.transition().call(chart)};chart.container=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;var dataLines1=data.filter(function(d){return !d.disabled&&d.type=="line"&&d.yAxis==1});var dataLines2=data.filter(function(d){return !d.disabled&&d.type=="line"&&d.yAxis==2});var dataBars1=data.filter(function(d){return !d.disabled&&d.type=="bar"&&d.yAxis==1});var dataBars2=data.filter(function(d){return !d.disabled&&d.type=="bar"&&d.yAxis==2});var dataStack1=data.filter(function(d){return !d.disabled&&d.type=="area"&&d.yAxis==1});var dataStack2=data.filter(function(d){return !d.disabled&&d.type=="area"&&d.yAxis==2});var series1=data.filter(function(d){return !d.disabled&&d.yAxis==1}).map(function(d){return d.values.map(function(d,i){return{x:d.x,y:d.y}})});var series2=data.filter(function(d){return !d.disabled&&d.yAxis==2}).map(function(d){return d.values.map(function(d,i){return{x:d.x,y:d.y}})});x.domain(d3.extent(d3.merge(series1.concat(series2)),function(d){return d.x})).range([0,availableWidth]);var wrap=container.selectAll("g.wrap.multiChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","wrap nvd3 multiChart").append("g");gEnter.append("g").attr("class","x axis");gEnter.append("g").attr("class","y1 axis");gEnter.append("g").attr("class","y2 axis");gEnter.append("g").attr("class","lines1Wrap");gEnter.append("g").attr("class","lines2Wrap");gEnter.append("g").attr("class","bars1Wrap");gEnter.append("g").attr("class","bars2Wrap");gEnter.append("g").attr("class","stack1Wrap");gEnter.append("g").attr("class","stack2Wrap");gEnter.append("g").attr("class","legendWrap");var g=wrap.select("g");if(showLegend){legend.width(availableWidth/2);g.select(".legendWrap").datum(data.map(function(series){series.originalKey=series.originalKey===undefined?series.key:series.originalKey;series.key=series.originalKey+(series.yAxis==1?"":" (right axis)");return series})).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".legendWrap").attr("transform","translate("+(availableWidth/2)+","+(-margin.top)+")")}lines1.width(availableWidth).height(availableHeight).interpolate("monotone").color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==1&&data[i].type=="line"}));lines2.width(availableWidth).height(availableHeight).interpolate("monotone").color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==2&&data[i].type=="line"}));bars1.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==1&&data[i].type=="bar"}));bars2.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==2&&data[i].type=="bar"}));stack1.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==1&&data[i].type=="area"}));stack2.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color[i%color.length]}).filter(function(d,i){return !data[i].disabled&&data[i].yAxis==2&&data[i].type=="area"}));g.attr("transform","translate("+margin.left+","+margin.top+")");var lines1Wrap=g.select(".lines1Wrap").datum(dataLines1);var bars1Wrap=g.select(".bars1Wrap").datum(dataBars1);var stack1Wrap=g.select(".stack1Wrap").datum(dataStack1);var lines2Wrap=g.select(".lines2Wrap").datum(dataLines2);var bars2Wrap=g.select(".bars2Wrap").datum(dataBars2);var stack2Wrap=g.select(".stack2Wrap").datum(dataStack2);var extraValue1=dataStack1.length?dataStack1.map(function(a){return a.values}).reduce(function(a,b){return a.map(function(aVal,i){return{x:aVal.x,y:aVal.y+b[i].y}})}).concat([{x:0,y:0}]):[];var extraValue2=dataStack2.length?dataStack2.map(function(a){return a.values}).reduce(function(a,b){return a.map(function(aVal,i){return{x:aVal.x,y:aVal.y+b[i].y}})}).concat([{x:0,y:0}]):[];yScale1.domain(yDomain1||d3.extent(d3.merge(series1).concat(extraValue1),function(d){return d.y})).range([0,availableHeight]);yScale2.domain(yDomain2||d3.extent(d3.merge(series2).concat(extraValue2),function(d){return d.y})).range([0,availableHeight]);lines1.yDomain(yScale1.domain());bars1.yDomain(yScale1.domain());stack1.yDomain(yScale1.domain());lines2.yDomain(yScale2.domain());bars2.yDomain(yScale2.domain());stack2.yDomain(yScale2.domain());if(dataStack1.length){d3.transition(stack1Wrap).call(stack1)}if(dataStack2.length){d3.transition(stack2Wrap).call(stack2)}if(dataBars1.length){d3.transition(bars1Wrap).call(bars1)}if(dataBars2.length){d3.transition(bars2Wrap).call(bars2)}if(dataLines1.length){d3.transition(lines1Wrap).call(lines1)}if(dataLines2.length){d3.transition(lines2Wrap).call(lines2)}xAxis.ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".x.axis").attr("transform","translate(0,"+availableHeight+")");d3.transition(g.select(".x.axis")).call(xAxis);yAxis1.ticks(availableHeight/36).tickSize(-availableWidth,0);d3.transition(g.select(".y1.axis")).call(yAxis1);yAxis2.ticks(availableHeight/36).tickSize(-availableWidth,0);d3.transition(g.select(".y2.axis")).call(yAxis2);g.select(".y2.axis").style("opacity",series2.length?1:0).attr("transform","translate("+x.range()[1]+",0)");legend.dispatch.on("stateChange",function(newState){chart.update()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}})});return chart}lines1.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines1.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});lines2.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines2.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});bars1.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});bars1.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});bars2.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});bars2.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});stack1.dispatch.on("tooltipShow",function(e){if(!Math.round(stack1.y()(e.point)*100)){setTimeout(function(){d3.selectAll(".point.hover").classed("hover",false)},0);return false}e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top],dispatch.tooltipShow(e)});stack1.dispatch.on("tooltipHide",function(e){dispatch.tooltipHide(e)});stack2.dispatch.on("tooltipShow",function(e){if(!Math.round(stack2.y()(e.point)*100)){setTimeout(function(){d3.selectAll(".point.hover").classed("hover",false)},0);return false}e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top],dispatch.tooltipShow(e)});stack2.dispatch.on("tooltipHide",function(e){dispatch.tooltipHide(e)});lines1.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines1.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});lines2.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});lines2.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.lines1=lines1;chart.lines2=lines2;chart.bars1=bars1;chart.bars2=bars2;chart.stack1=stack1;chart.stack2=stack2;chart.xAxis=xAxis;chart.yAxis1=yAxis1;chart.yAxis2=yAxis2;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;lines1.x(_);bars1.x(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;lines1.y(_);bars1.y(_);return chart};chart.yDomain1=function(_){if(!arguments.length){return yDomain1}yDomain1=_;return chart};chart.yDomain2=function(_){if(!arguments.length){return yDomain2}yDomain2=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin=_;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=_;legend.color(_);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};return chart};nv.models.ohlcBar=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,id=Math.floor(Math.random()*10000),x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},getOpen=function(d){return d.open},getClose=function(d){return d.close},getHigh=function(d){return d.high},getLow=function(d){return d.low},forceX=[],forceY=[],padData=false,clipEdge=true,color=nv.utils.defaultColor(),xDomain,yDomain,xRange,yRange,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x.domain(xDomain||d3.extent(data[0].values.map(getX).concat(forceX)));if(padData){x.range(xRange||[availableWidth*0.5/data[0].values.length,availableWidth*(data[0].values.length-0.5)/data[0].values.length])}else{x.range(xRange||[0,availableWidth])}y.domain(yDomain||[d3.min(data[0].values.map(getLow).concat(forceY)),d3.max(data[0].values.map(getHigh).concat(forceY))]).range(yRange||[availableHeight,0]);if(x.domain()[0]===x.domain()[1]){x.domain()[0]?x.domain([x.domain()[0]-x.domain()[0]*0.01,x.domain()[1]+x.domain()[1]*0.01]):x.domain([-1,1])}if(y.domain()[0]===y.domain()[1]){y.domain()[0]?y.domain([y.domain()[0]+y.domain()[0]*0.01,y.domain()[1]-y.domain()[1]*0.01]):y.domain([-1,1])}var wrap=d3.select(this).selectAll("g.nv-wrap.nv-ohlcBar").data([data[0].values]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-ohlcBar");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-ticks");wrap.attr("transform","translate("+margin.left+","+margin.top+")");container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})});defsEnter.append("clipPath").attr("id","nv-chart-clip-path-"+id).append("rect");wrap.select("#nv-chart-clip-path-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-chart-clip-path-"+id+")":"");var ticks=wrap.select(".nv-ticks").selectAll(".nv-tick").data(function(d){return d});ticks.exit().remove();var ticksEnter=ticks.enter().append("path").attr("class",function(d,i,j){return(getOpen(d,i)>getClose(d,i)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+j+"-"+i}).attr("d",function(d,i){var w=(availableWidth/data[0].values.length)*0.9;return"m0,0l0,"+(y(getOpen(d,i))-y(getHigh(d,i)))+"l"+(-w/2)+",0l"+(w/2)+",0l0,"+(y(getLow(d,i))-y(getOpen(d,i)))+"l0,"+(y(getClose(d,i))-y(getLow(d,i)))+"l"+(w/2)+",0l"+(-w/2)+",0z"}).attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getHigh(d,i))+")"}).on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({point:d,series:data[0],pos:[x(getX(d,i)),y(getY(d,i))],pointIndex:i,seriesIndex:0,e:d3.event})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({point:d,series:data[0],pointIndex:i,seriesIndex:0,e:d3.event})}).on("click",function(d,i){dispatch.elementClick({value:getY(d,i),data:d,index:i,pos:[x(getX(d,i)),y(getY(d,i))],e:d3.event,id:id});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({value:getY(d,i),data:d,index:i,pos:[x(getX(d,i)),y(getY(d,i))],e:d3.event,id:id});d3.event.stopPropagation()});ticks.attr("class",function(d,i,j){return(getOpen(d,i)>getClose(d,i)?"nv-tick negative":"nv-tick positive")+" nv-tick-"+j+"-"+i});d3.transition(ticks).attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getHigh(d,i))+")"}).attr("d",function(d,i){var w=(availableWidth/data[0].values.length)*0.9;return"m0,0l0,"+(y(getOpen(d,i))-y(getHigh(d,i)))+"l"+(-w/2)+",0l"+(w/2)+",0l0,"+(y(getLow(d,i))-y(getOpen(d,i)))+"l0,"+(y(getClose(d,i))-y(getLow(d,i)))+"l"+(w/2)+",0l"+(-w/2)+",0z"})});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=_;return chart};chart.open=function(_){if(!arguments.length){return getOpen}getOpen=_;return chart};chart.close=function(_){if(!arguments.length){return getClose}getClose=_;return chart};chart.high=function(_){if(!arguments.length){return getHigh}getHigh=_;return chart};chart.low=function(_){if(!arguments.length){return getLow}getLow=_;return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.forceX=function(_){if(!arguments.length){return forceX}forceX=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.padData=function(_){if(!arguments.length){return padData}padData=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};return chart};nv.models.parallelCoordinates=function(){var margin={top:30,right:10,bottom:10,left:10},width=960,height=500,x=d3.scale.ordinal(),y={},dimensions=[],color=nv.utils.getColor(d3.scale.category20c().range()),axisLabel=function(d){return d},filters=[],active=[],dispatch=d3.dispatch("brush");function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);active=data;chart.update=function(){};x.rangePoints([0,availableWidth],1).domain(dimensions);dimensions.forEach(function(d){y[d]=d3.scale.linear().domain(d3.extent(data,function(p){return +p[d]})).range([availableHeight,0]);y[d].brush=d3.svg.brush().y(y[d]).on("brush",brush);return d!="name"});var wrap=container.selectAll("g.nv-wrap.nv-parallelCoordinates").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-parallelCoordinates");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-parallelCoordinatesWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var line=d3.svg.line(),axis=d3.svg.axis().orient("left"),background,foreground;background=gEnter.append("g").attr("class","background").selectAll("path").data(data).enter().append("path").attr("d",path);foreground=gEnter.append("g").attr("class","foreground").selectAll("path").data(data).enter().append("path").attr("d",path);var dimension=g.selectAll(".dimension").data(dimensions).enter().append("g").attr("class","dimension").attr("transform",function(d){return"translate("+x(d)+",0)"});dimension.append("g").attr("class","axis").each(function(d){d3.select(this).call(axis.scale(y[d]))}).append("text").attr("text-anchor","middle").attr("y",-9).text(String);dimension.append("g").attr("class","brush").each(function(d){d3.select(this).call(y[d].brush)}).selectAll("rect").attr("x",-8).attr("width",16);function path(d){return line(dimensions.map(function(p){return[x(p),y[p](d[p])]}))}function brush(){var actives=dimensions.filter(function(p){return !y[p].brush.empty()}),extents=actives.map(function(p){return y[p].brush.extent()});filters=[];actives.forEach(function(d,i){filters[i]={dimension:d,extent:extents[i]}});active=[];foreground.style("display",function(d){var isActive=actives.every(function(p,i){return extents[i][0]<=d[p]&&d[p]<=extents[i][1]});if(isActive){active.push(d)}return isActive?null:"none"});dispatch.brush({filters:filters,active:active})}});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.dimensions=function(_){if(!arguments.length){return dimensions}dimensions=_;return chart};chart.filters=function(){return filters};chart.active=function(){return active};return chart};nv.models.pie=function(){var margin={top:0,right:0,bottom:0,left:0},width=500,height=500,getX=function(d){return d.x},getY=function(d){return d.y},getDescription=function(d){return d.description},id=Math.floor(Math.random()*10000),color=nv.utils.defaultColor(),valueFormat=d3.format(",.2f"),showLabels=true,pieLabelsOutside=true,donutLabelsOutside=false,labelType="key",labelThreshold=0.02,donut=false,labelSunbeamLayout=false,startAngle=false,endAngle=false,donutRatio=0.5,dispatch=d3.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,radius=Math.min(availableWidth,availableHeight)/2,arcRadius=radius-(radius/5),container=d3.select(this);var wrap=container.selectAll(".nv-wrap.nv-pie").data(data);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-pie nv-chart-"+id);var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-pie");wrap.attr("transform","translate("+margin.left+","+margin.top+")");g.select(".nv-pie").attr("transform","translate("+availableWidth/2+","+availableHeight/2+")");container.on("click",function(d,i){dispatch.chartClick({data:d,index:i,pos:d3.event,id:id})});var arc=d3.svg.arc().outerRadius(arcRadius);if(startAngle){arc.startAngle(startAngle)}if(endAngle){arc.endAngle(endAngle)}if(donut){arc.innerRadius(radius*donutRatio)}var pie=d3.layout.pie().sort(null).value(function(d){return d.disabled?0:getY(d)});var slices=wrap.select(".nv-pie").selectAll(".nv-slice").data(pie);slices.exit().remove();var ae=slices.enter().append("g").attr("class","nv-slice").on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.elementMouseover({label:getX(d.data),value:getY(d.data),point:d.data,pointIndex:i,pos:[d3.event.pageX,d3.event.pageY],id:id})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.elementMouseout({label:getX(d.data),value:getY(d.data),point:d.data,index:i,id:id})}).on("click",function(d,i){dispatch.elementClick({label:getX(d.data),value:getY(d.data),point:d.data,index:i,pos:d3.event,id:id});d3.event.stopPropagation()}).on("dblclick",function(d,i){dispatch.elementDblClick({label:getX(d.data),value:getY(d.data),point:d.data,index:i,pos:d3.event,id:id});d3.event.stopPropagation()});slices.attr("fill",function(d,i){return color(d,i)}).attr("stroke",function(d,i){return color(d,i)});var paths=ae.append("path").each(function(d){this._current=d});d3.transition(slices.select("path")).attr("d",arc).attrTween("d",arcTween);if(showLabels){var labelsArc=d3.svg.arc().innerRadius(0);if(pieLabelsOutside){labelsArc=arc}if(donutLabelsOutside){labelsArc=d3.svg.arc().outerRadius(arc.outerRadius())}ae.append("g").classed("nv-label",true).each(function(d,i){var group=d3.select(this);group.attr("transform",function(d){if(labelSunbeamLayout){d.outerRadius=arcRadius+10;d.innerRadius=arcRadius+15;var rotateAngle=(d.startAngle+d.endAngle)/2*(180/Math.PI);if((d.startAngle+d.endAngle)/2<Math.PI){rotateAngle-=90}else{rotateAngle+=90}return"translate("+labelsArc.centroid(d)+") rotate("+rotateAngle+")"}else{d.outerRadius=radius+10;d.innerRadius=radius+15;return"translate("+labelsArc.centroid(d)+")"}});group.append("rect").style("stroke","#fff").style("fill","#fff").attr("rx",3).attr("ry",3);group.append("text").style("text-anchor",labelSunbeamLayout?((d.startAngle+d.endAngle)/2<Math.PI?"start":"end"):"middle").style("fill","#000")});slices.select(".nv-label").transition().attr("transform",function(d){if(labelSunbeamLayout){d.outerRadius=arcRadius+10;d.innerRadius=arcRadius+15;var rotateAngle=(d.startAngle+d.endAngle)/2*(180/Math.PI);if((d.startAngle+d.endAngle)/2<Math.PI){rotateAngle-=90}else{rotateAngle+=90}return"translate("+labelsArc.centroid(d)+") rotate("+rotateAngle+")"}else{d.outerRadius=radius+10;d.innerRadius=radius+15;return"translate("+labelsArc.centroid(d)+")"}});slices.each(function(d,i){var slice=d3.select(this);slice.select(".nv-label text").style("text-anchor",labelSunbeamLayout?((d.startAngle+d.endAngle)/2<Math.PI?"start":"end"):"middle").text(function(d,i){var percent=(d.endAngle-d.startAngle)/(2*Math.PI);var labelTypes={key:getX(d.data),value:getY(d.data),percent:d3.format("%")(percent)};return(d.value&&percent>labelThreshold)?labelTypes[labelType]:""});var textBox=slice.select("text").node().getBBox();slice.select(".nv-label rect").attr("width",textBox.width+10).attr("height",textBox.height+10).attr("transform",function(){return"translate("+[textBox.x-5,textBox.y-5]+")"})})}function angle(d){var a=(d.startAngle+d.endAngle)*90/Math.PI-90;return a>90?a-180:a}function arcTween(a){a.endAngle=isNaN(a.endAngle)?0:a.endAngle;a.startAngle=isNaN(a.startAngle)?0:a.startAngle;if(!donut){a.innerRadius=0}var i=d3.interpolate(this._current,a);this._current=i(0);return function(t){return arc(i(t))}}function tweenPie(b){b.innerRadius=0;var i=d3.interpolate({startAngle:0,endAngle:0},b);return function(t){return arc(i(t))}}});return chart}chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.values=function(_){nv.log("pie.values() is no longer supported.");return chart};chart.x=function(_){if(!arguments.length){return getX}getX=_;return chart};chart.y=function(_){if(!arguments.length){return getY}getY=d3.functor(_);return chart};chart.description=function(_){if(!arguments.length){return getDescription}getDescription=_;return chart};chart.showLabels=function(_){if(!arguments.length){return showLabels}showLabels=_;return chart};chart.labelSunbeamLayout=function(_){if(!arguments.length){return labelSunbeamLayout}labelSunbeamLayout=_;return chart};chart.donutLabelsOutside=function(_){if(!arguments.length){return donutLabelsOutside}donutLabelsOutside=_;return chart};chart.pieLabelsOutside=function(_){if(!arguments.length){return pieLabelsOutside}pieLabelsOutside=_;return chart};chart.labelType=function(_){if(!arguments.length){return labelType}labelType=_;labelType=labelType||"key";return chart};chart.donut=function(_){if(!arguments.length){return donut}donut=_;return chart};chart.donutRatio=function(_){if(!arguments.length){return donutRatio}donutRatio=_;return chart};chart.startAngle=function(_){if(!arguments.length){return startAngle}startAngle=_;return chart};chart.endAngle=function(_){if(!arguments.length){return endAngle}endAngle=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.valueFormat=function(_){if(!arguments.length){return valueFormat}valueFormat=_;return chart};chart.labelThreshold=function(_){if(!arguments.length){return labelThreshold}labelThreshold=_;return chart};return chart};nv.models.pieChart=function(){var pie=nv.models.pie(),legend=nv.models.legend();var margin={top:30,right:20,bottom:20,left:20},width=null,height=null,showLegend=true,color=nv.utils.defaultColor(),tooltips=true,tooltip=function(key,y,e,graph){return"<h3>"+key+"</h3><p>"+y+"</p>"},state={},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState");var showTooltip=function(e,offsetElement){var tooltipLabel=pie.description()(e.point)||pie.x()(e.point);var left=e.pos[0]+((offsetElement&&offsetElement.offsetLeft)||0),top=e.pos[1]+((offsetElement&&offsetElement.offsetTop)||0),y=pie.valueFormat()(pie.y()(e.point)),content=tooltip(tooltipLabel,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var wrap=container.selectAll("g.nv-wrap.nv-pieChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-pieChart").append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-pieWrap");gEnter.append("g").attr("class","nv-legendWrap");if(showLegend){legend.width(availableWidth).key(pie.x());wrap.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}wrap.select(".nv-legendWrap").attr("transform","translate(0,"+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");pie.width(availableWidth).height(availableHeight);var pieWrap=g.select(".nv-pieWrap").datum([data]);d3.transition(pieWrap).call(pie);legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});pie.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}chart.update()})});return chart}pie.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e)}});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.legend=legend;chart.dispatch=dispatch;chart.pie=pie;d3.rebind(chart,pie,"valueFormat","values","x","y","description","id","showLabels","donutLabelsOutside","pieLabelsOutside","labelType","donut","donutRatio","labelThreshold");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);pie.color(color);return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.scatter=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=nv.utils.defaultColor(),id=Math.floor(Math.random()*100000),x=d3.scale.linear(),y=d3.scale.linear(),z=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},getSize=function(d){return d.size||1},getShape=function(d){return d.shape||"circle"},onlyCircles=true,forceX=[],forceY=[],forceSize=[],interactive=true,pointKey=null,pointActive=function(d){return !d.notActive},padData=false,padDataOuter=0.1,clipEdge=false,clipVoronoi=true,clipRadius=function(){return 25},xDomain=null,yDomain=null,xRange=null,yRange=null,sizeDomain=null,sizeRange=null,singlePoint=false,dispatch=d3.dispatch("elementClick","elementMouseover","elementMouseout"),useVoronoi=true;var x0,y0,z0,timeoutID,needsUpdate=false;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);data.forEach(function(series,i){series.values.forEach(function(point){point.series=i})});var seriesData=(xDomain&&yDomain&&sizeDomain)?[]:d3.merge(data.map(function(d){return d.values.map(function(d,i){return{x:getX(d,i),y:getY(d,i),size:getSize(d,i)}})}));x.domain(xDomain||d3.extent(seriesData.map(function(d){return d.x}).concat(forceX)));if(padData&&data[0]){x.range(xRange||[(availableWidth*padDataOuter+availableWidth)/(2*data[0].values.length),availableWidth-availableWidth*(1+padDataOuter)/(2*data[0].values.length)])}else{x.range(xRange||[0,availableWidth])}y.domain(yDomain||d3.extent(seriesData.map(function(d){return d.y}).concat(forceY))).range(yRange||[availableHeight,0]);z.domain(sizeDomain||d3.extent(seriesData.map(function(d){return d.size}).concat(forceSize))).range(sizeRange||[16,256]);if(x.domain()[0]===x.domain()[1]||y.domain()[0]===y.domain()[1]){singlePoint=true}if(x.domain()[0]===x.domain()[1]){x.domain()[0]?x.domain([x.domain()[0]-x.domain()[0]*0.01,x.domain()[1]+x.domain()[1]*0.01]):x.domain([-1,1])}if(y.domain()[0]===y.domain()[1]){y.domain()[0]?y.domain([y.domain()[0]-y.domain()[0]*0.01,y.domain()[1]+y.domain()[1]*0.01]):y.domain([-1,1])}if(isNaN(x.domain()[0])){x.domain([-1,1])}if(isNaN(y.domain()[0])){y.domain([-1,1])}x0=x0||x;y0=y0||y;z0=z0||z;var wrap=container.selectAll("g.nv-wrap.nv-scatter").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-scatter nv-chart-"+id+(singlePoint?" nv-single-point":""));var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-groups");gEnter.append("g").attr("class","nv-point-paths");wrap.attr("transform","translate("+margin.left+","+margin.top+")");defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");function updateInteractiveLayer(){if(!interactive){return false}var eventElements;var vertices=d3.merge(data.map(function(group,groupIndex){return group.values.map(function(point,pointIndex){var pX=getX(point,pointIndex);var pY=getY(point,pointIndex);return[x(pX)+Math.random()*1e-7,y(pY)+Math.random()*1e-7,groupIndex,pointIndex,point]}).filter(function(pointArray,pointIndex){return pointActive(pointArray[4],pointIndex)})}));if(useVoronoi===true){if(clipVoronoi){var pointClipsEnter=wrap.select("defs").selectAll(".nv-point-clips").data([id]).enter();pointClipsEnter.append("clipPath").attr("class","nv-point-clips").attr("id","nv-points-clip-"+id);var pointClips=wrap.select("#nv-points-clip-"+id).selectAll("circle").data(vertices);pointClips.enter().append("circle").attr("r",clipRadius);pointClips.exit().remove();pointClips.attr("cx",function(d){return d[0]}).attr("cy",function(d){return d[1]});wrap.select(".nv-point-paths").attr("clip-path","url(#nv-points-clip-"+id+")")}if(vertices.length){vertices.push([x.range()[0]-20,y.range()[0]-20,null,null]);vertices.push([x.range()[1]+20,y.range()[1]+20,null,null]);vertices.push([x.range()[0]-20,y.range()[0]+20,null,null]);vertices.push([x.range()[1]+20,y.range()[1]-20,null,null])}var bounds=d3.geom.polygon([[-10,-10],[-10,height+10],[width+10,height+10],[width+10,-10]]);var voronoi=d3.geom.voronoi(vertices).map(function(d,i){return{data:bounds.clip(d),series:vertices[i][2],point:vertices[i][3]}});var pointPaths=wrap.select(".nv-point-paths").selectAll("path").data(voronoi);pointPaths.enter().append("path").attr("class",function(d,i){return"nv-path-"+i});pointPaths.exit().remove();pointPaths.attr("d",function(d){if(d.data.length===0){return"M 0 0"}else{return"M"+d.data.join("L")+"Z"}});var mouseEventCallback=function(d,mDispatch){if(needsUpdate){return 0}var series=data[d.series];if(typeof series==="undefined"){return}var point=series.values[d.point];mDispatch({point:point,series:series,pos:[x(getX(point,d.point))+margin.left,y(getY(point,d.point))+margin.top],seriesIndex:d.series,pointIndex:d.point})};pointPaths.on("click",function(d){mouseEventCallback(d,dispatch.elementClick)}).on("mouseover",function(d){mouseEventCallback(d,dispatch.elementMouseover)}).on("mouseout",function(d,i){mouseEventCallback(d,dispatch.elementMouseout)})}else{wrap.select(".nv-groups").selectAll(".nv-group").selectAll(".nv-point").on("click",function(d,i){if(needsUpdate||!data[d.series]){return 0}var series=data[d.series],point=series.values[i];dispatch.elementClick({point:point,series:series,pos:[x(getX(point,i))+margin.left,y(getY(point,i))+margin.top],seriesIndex:d.series,pointIndex:i})}).on("mouseover",function(d,i){if(needsUpdate||!data[d.series]){return 0}var series=data[d.series],point=series.values[i];dispatch.elementMouseover({point:point,series:series,pos:[x(getX(point,i))+margin.left,y(getY(point,i))+margin.top],seriesIndex:d.series,pointIndex:i})}).on("mouseout",function(d,i){if(needsUpdate||!data[d.series]){return 0}var series=data[d.series],point=series.values[i];dispatch.elementMouseout({point:point,series:series,seriesIndex:d.series,pointIndex:i})})}needsUpdate=false}needsUpdate=true;var groups=wrap.select(".nv-groups").selectAll(".nv-group").data(function(d){return d},function(d){return d.key});groups.enter().append("g").style("stroke-opacity",0.000001).style("fill-opacity",0.000001);groups.exit().remove();groups.attr("class",function(d,i){return"nv-group nv-series-"+i}).classed("hover",function(d){return d.hover});groups.transition().style("fill",function(d,i){return color(d,i)}).style("stroke",function(d,i){return color(d,i)}).style("stroke-opacity",1).style("fill-opacity",0.5);if(onlyCircles){var points=groups.selectAll("circle.nv-point").data(function(d){return d.values},pointKey);points.enter().append("circle").style("fill",function(d,i){return d.color}).style("stroke",function(d,i){return d.color}).attr("cx",function(d,i){return nv.utils.NaNtoZero(x0(getX(d,i)))}).attr("cy",function(d,i){return nv.utils.NaNtoZero(y0(getY(d,i)))}).attr("r",function(d,i){return Math.sqrt(z(getSize(d,i))/Math.PI)});points.exit().remove();groups.exit().selectAll("path.nv-point").transition().attr("cx",function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).attr("cy",function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}).remove();points.each(function(d,i){d3.select(this).classed("nv-point",true).classed("nv-point-"+i,true).classed("hover",false)});points.transition().attr("cx",function(d,i){return nv.utils.NaNtoZero(x(getX(d,i)))}).attr("cy",function(d,i){return nv.utils.NaNtoZero(y(getY(d,i)))}).attr("r",function(d,i){return Math.sqrt(z(getSize(d,i))/Math.PI)})}else{var points=groups.selectAll("path.nv-point").data(function(d){return d.values});points.enter().append("path").style("fill",function(d,i){return d.color}).style("stroke",function(d,i){return d.color}).attr("transform",function(d,i){return"translate("+x0(getX(d,i))+","+y0(getY(d,i))+")"}).attr("d",d3.svg.symbol().type(getShape).size(function(d,i){return z(getSize(d,i))}));points.exit().remove();groups.exit().selectAll("path.nv-point").transition().attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getY(d,i))+")"}).remove();points.each(function(d,i){d3.select(this).classed("nv-point",true).classed("nv-point-"+i,true).classed("hover",false)});points.transition().attr("transform",function(d,i){return"translate("+x(getX(d,i))+","+y(getY(d,i))+")"}).attr("d",d3.svg.symbol().type(getShape).size(function(d,i){return z(getSize(d,i))}))}clearTimeout(timeoutID);timeoutID=setTimeout(updateInteractiveLayer,300);x0=x.copy();y0=y.copy();z0=z.copy()});return chart}chart.clearHighlights=function(){d3.selectAll(".nv-chart-"+id+" .nv-point.hover").classed("hover",false)};chart.highlightPoint=function(seriesIndex,pointIndex,isHoverOver){d3.select(".nv-chart-"+id+" .nv-series-"+seriesIndex+" .nv-point-"+pointIndex).classed("hover",isHoverOver)};dispatch.on("elementMouseover.point",function(d){if(interactive){chart.highlightPoint(d.seriesIndex,d.pointIndex,true)}});dispatch.on("elementMouseout.point",function(d){if(interactive){chart.highlightPoint(d.seriesIndex,d.pointIndex,false)}});chart.dispatch=dispatch;chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=d3.functor(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=d3.functor(_);return chart};chart.size=function(_){if(!arguments.length){return getSize}getSize=d3.functor(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.zScale=function(_){if(!arguments.length){return z}z=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.sizeDomain=function(_){if(!arguments.length){return sizeDomain}sizeDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.sizeRange=function(_){if(!arguments.length){return sizeRange}sizeRange=_;return chart};chart.forceX=function(_){if(!arguments.length){return forceX}forceX=_;return chart};chart.forceY=function(_){if(!arguments.length){return forceY}forceY=_;return chart};chart.forceSize=function(_){if(!arguments.length){return forceSize}forceSize=_;return chart};chart.interactive=function(_){if(!arguments.length){return interactive}interactive=_;return chart};chart.pointKey=function(_){if(!arguments.length){return pointKey}pointKey=_;return chart};chart.pointActive=function(_){if(!arguments.length){return pointActive}pointActive=_;return chart};chart.padData=function(_){if(!arguments.length){return padData}padData=_;return chart};chart.padDataOuter=function(_){if(!arguments.length){return padDataOuter}padDataOuter=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.clipVoronoi=function(_){if(!arguments.length){return clipVoronoi}clipVoronoi=_;return chart};chart.useVoronoi=function(_){if(!arguments.length){return useVoronoi}useVoronoi=_;if(useVoronoi===false){clipVoronoi=false}return chart};chart.clipRadius=function(_){if(!arguments.length){return clipRadius}clipRadius=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.shape=function(_){if(!arguments.length){return getShape}getShape=_;return chart};chart.onlyCircles=function(_){if(!arguments.length){return onlyCircles}onlyCircles=_;return chart};chart.id=function(_){if(!arguments.length){return id}id=_;return chart};chart.singlePoint=function(_){if(!arguments.length){return singlePoint}singlePoint=_;return chart};return chart};nv.models.scatterChart=function(){var scatter=nv.models.scatter(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),distX=nv.models.distribution(),distY=nv.models.distribution();var margin={top:30,right:20,bottom:50,left:75},width=null,height=null,color=nv.utils.defaultColor(),x=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):scatter.xScale(),y=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):scatter.yScale(),xPadding=0,yPadding=0,showDistX=false,showDistY=false,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,showControls=!!d3.fisheye,fisheye=0,pauseFisheye=false,tooltips=true,tooltipX=function(key,x,y){return"<strong>"+x+"</strong>"},tooltipY=function(key,x,y){return"<strong>"+y+"</strong>"},tooltip=null,state={},defaultState=null,dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),noData="No Data Available.",transitionDuration=250;scatter.xScale(x).yScale(y);xAxis.orient("bottom").tickPadding(10);yAxis.orient((rightAlignYAxis)?"right":"left").tickPadding(10);distX.axis("x");distY.axis("y");controls.updateState(false);var x0,y0;var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),leftX=e.pos[0]+(offsetElement.offsetLeft||0),topX=y.range()[0]+margin.top+(offsetElement.offsetTop||0),leftY=x.range()[0]+margin.left+(offsetElement.offsetLeft||0),topY=e.pos[1]+(offsetElement.offsetTop||0),xVal=xAxis.tickFormat()(scatter.x()(e.point,e.pointIndex)),yVal=yAxis.tickFormat()(scatter.y()(e.point,e.pointIndex));if(tooltipX!=null){nv.tooltip.show([leftX,topX],tooltipX(e.series.key,xVal,yVal,e,chart),"n",1,offsetElement,"x-nvtooltip")}if(tooltipY!=null){nv.tooltip.show([leftY,topY],tooltipY(e.series.key,xVal,yVal,e,chart),"e",1,offsetElement,"y-nvtooltip")}if(tooltip!=null){nv.tooltip.show([left,top],tooltip(e.series.key,xVal,yVal,e,chart),e.value<0?"n":"s",null,offsetElement)}};var controlsData=[{key:"Magnify",disabled:true}];function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-scatterChart").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-scatterChart nv-chart-"+scatter.id());var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("rect").attr("class","nvd3 nv-background");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-scatterWrap");gEnter.append("g").attr("class","nv-distWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");if(showLegend){var legendWidth=(showControls)?availableWidth/2:availableWidth;legend.width(legendWidth);wrap.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}wrap.select(".nv-legendWrap").attr("transform","translate("+(availableWidth-legendWidth)+","+(-margin.top)+")")}if(showControls){controls.width(180).color(["#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}scatter.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));if(xPadding!==0){scatter.xDomain(null)}if(yPadding!==0){scatter.yDomain(null)}wrap.select(".nv-scatterWrap").datum(data.filter(function(d){return !d.disabled})).call(scatter);if(xPadding!==0){var xRange=x.domain()[1]-x.domain()[0];scatter.xDomain([x.domain()[0]-(xPadding*xRange),x.domain()[1]+(xPadding*xRange)])}if(yPadding!==0){var yRange=y.domain()[1]-y.domain()[0];scatter.yDomain([y.domain()[0]-(yPadding*yRange),y.domain()[1]+(yPadding*yRange)])}if(yPadding!==0||xPadding!==0){wrap.select(".nv-scatterWrap").datum(data.filter(function(d){return !d.disabled})).call(scatter)}if(showXAxis){xAxis.scale(x).ticks(xAxis.ticks()&&xAxis.ticks().length?xAxis.ticks():availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")").call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(yAxis.ticks()&&yAxis.ticks().length?yAxis.ticks():availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").call(yAxis)}if(showDistX){distX.getData(scatter.x()).scale(x).width(availableWidth).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));gEnter.select(".nv-distWrap").append("g").attr("class","nv-distributionX");g.select(".nv-distributionX").attr("transform","translate(0,"+y.range()[0]+")").datum(data.filter(function(d){return !d.disabled})).call(distX)}if(showDistY){distY.getData(scatter.y()).scale(y).width(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));gEnter.select(".nv-distWrap").append("g").attr("class","nv-distributionY");g.select(".nv-distributionY").attr("transform","translate("+(rightAlignYAxis?availableWidth:-distY.size())+",0)").datum(data.filter(function(d){return !d.disabled})).call(distY)}if(d3.fisheye){g.select(".nv-background").attr("width",availableWidth).attr("height",availableHeight);g.select(".nv-background").on("mousemove",updateFisheye);g.select(".nv-background").on("click",function(){pauseFisheye=!pauseFisheye});scatter.dispatch.on("elementClick.freezeFisheye",function(){pauseFisheye=!pauseFisheye})}function updateFisheye(){if(pauseFisheye){g.select(".nv-point-paths").style("pointer-events","all");return false}g.select(".nv-point-paths").style("pointer-events","none");var mouse=d3.mouse(this);x.distortion(fisheye).focus(mouse[0]);y.distortion(fisheye).focus(mouse[1]);g.select(".nv-scatterWrap").call(scatter);if(showXAxis){g.select(".nv-x.nv-axis").call(xAxis)}if(showYAxis){g.select(".nv-y.nv-axis").call(yAxis)}g.select(".nv-distributionX").datum(data.filter(function(d){return !d.disabled})).call(distX);g.select(".nv-distributionY").datum(data.filter(function(d){return !d.disabled})).call(distY)}controls.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;fisheye=d.disabled?0:2.5;g.select(".nv-background").style("pointer-events",d.disabled?"none":"all");g.select(".nv-point-paths").style("pointer-events",d.disabled?"all":"none");if(d.disabled){x.distortion(fisheye).focus(0);y.distortion(fisheye).focus(0);g.select(".nv-scatterWrap").call(scatter);g.select(".nv-x.nv-axis").call(xAxis);g.select(".nv-y.nv-axis").call(yAxis)}else{pauseFisheye=false}chart.update()});legend.dispatch.on("stateChange",function(newState){state.disabled=newState.disabled;dispatch.stateChange(state);chart.update()});scatter.dispatch.on("elementMouseover.tooltip",function(e){d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",function(d,i){return e.pos[1]-availableHeight});d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",e.pos[0]+distX.size());e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}chart.update()});x0=x.copy();y0=y.copy()});return chart}scatter.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e);d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",0);d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",distY.size())});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.scatter=scatter;chart.legend=legend;chart.controls=controls;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.distX=distX;chart.distY=distY;d3.rebind(chart,scatter,"id","interactive","pointActive","x","y","shape","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","sizeRange","forceX","forceY","forceSize","clipVoronoi","clipRadius","useVoronoi");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);distX.color(color);distY.color(color);return chart};chart.showDistX=function(_){if(!arguments.length){return showDistX}showDistX=_;return chart};chart.showDistY=function(_){if(!arguments.length){return showDistY}showDistY=_;return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.fisheye=function(_){if(!arguments.length){return fisheye}fisheye=_;return chart};chart.xPadding=function(_){if(!arguments.length){return xPadding}xPadding=_;return chart};chart.yPadding=function(_){if(!arguments.length){return yPadding}yPadding=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltipXContent=function(_){if(!arguments.length){return tooltipX}tooltipX=_;return chart};chart.tooltipYContent=function(_){if(!arguments.length){return tooltipY}tooltipY=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.scatterPlusLineChart=function(){var scatter=nv.models.scatter(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),distX=nv.models.distribution(),distY=nv.models.distribution();var margin={top:30,right:20,bottom:50,left:75},width=null,height=null,color=nv.utils.defaultColor(),x=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):scatter.xScale(),y=d3.fisheye?d3.fisheye.scale(d3.scale.linear).distortion(0):scatter.yScale(),showDistX=false,showDistY=false,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,showControls=!!d3.fisheye,fisheye=0,pauseFisheye=false,tooltips=true,tooltipX=function(key,x,y){return"<strong>"+x+"</strong>"},tooltipY=function(key,x,y){return"<strong>"+y+"</strong>"},tooltip=function(key,x,y,date){return"<h3>"+key+"</h3><p>"+date+"</p>"},state={},defaultState=null,dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),noData="No Data Available.",transitionDuration=250;scatter.xScale(x).yScale(y);xAxis.orient("bottom").tickPadding(10);yAxis.orient((rightAlignYAxis)?"right":"left").tickPadding(10);distX.axis("x");distY.axis("y");controls.updateState(false);var x0,y0;var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),leftX=e.pos[0]+(offsetElement.offsetLeft||0),topX=y.range()[0]+margin.top+(offsetElement.offsetTop||0),leftY=x.range()[0]+margin.left+(offsetElement.offsetLeft||0),topY=e.pos[1]+(offsetElement.offsetTop||0),xVal=xAxis.tickFormat()(scatter.x()(e.point,e.pointIndex)),yVal=yAxis.tickFormat()(scatter.y()(e.point,e.pointIndex));if(tooltipX!=null){nv.tooltip.show([leftX,topX],tooltipX(e.series.key,xVal,yVal,e,chart),"n",1,offsetElement,"x-nvtooltip")}if(tooltipY!=null){nv.tooltip.show([leftY,topY],tooltipY(e.series.key,xVal,yVal,e,chart),"e",1,offsetElement,"y-nvtooltip")}if(tooltip!=null){nv.tooltip.show([left,top],tooltip(e.series.key,xVal,yVal,e.point.tooltip,e,chart),e.value<0?"n":"s",null,offsetElement)}};var controlsData=[{key:"Magnify",disabled:true}];function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=scatter.xScale();y=scatter.yScale();x0=x0||x;y0=y0||y;var wrap=container.selectAll("g.nv-wrap.nv-scatterChart").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-scatterChart nv-chart-"+scatter.id());var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("rect").attr("class","nvd3 nv-background").style("pointer-events","none");gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-scatterWrap");gEnter.append("g").attr("class","nv-regressionLinesWrap");gEnter.append("g").attr("class","nv-distWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}if(showLegend){legend.width(availableWidth/2);wrap.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}wrap.select(".nv-legendWrap").attr("transform","translate("+(availableWidth/2)+","+(-margin.top)+")")}if(showControls){controls.width(180).color(["#444"]);g.select(".nv-controlsWrap").datum(controlsData).attr("transform","translate(0,"+(-margin.top)+")").call(controls)}scatter.width(availableWidth).height(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));wrap.select(".nv-scatterWrap").datum(data.filter(function(d){return !d.disabled})).call(scatter);wrap.select(".nv-regressionLinesWrap").attr("clip-path","url(#nv-edge-clip-"+scatter.id()+")");var regWrap=wrap.select(".nv-regressionLinesWrap").selectAll(".nv-regLines").data(function(d){return d});regWrap.enter().append("g").attr("class","nv-regLines");var regLine=regWrap.selectAll(".nv-regLine").data(function(d){return[d]});var regLineEnter=regLine.enter().append("line").attr("class","nv-regLine").style("stroke-opacity",0);regLine.transition().attr("x1",x.range()[0]).attr("x2",x.range()[1]).attr("y1",function(d,i){return y(x.domain()[0]*d.slope+d.intercept)}).attr("y2",function(d,i){return y(x.domain()[1]*d.slope+d.intercept)}).style("stroke",function(d,i,j){return color(d,j)}).style("stroke-opacity",function(d,i){return(d.disabled||typeof d.slope==="undefined"||typeof d.intercept==="undefined")?0:1});if(showXAxis){xAxis.scale(x).ticks(xAxis.ticks()?xAxis.ticks():availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+y.range()[0]+")").call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(yAxis.ticks()?yAxis.ticks():availableHeight/36).tickSize(-availableWidth,0);g.select(".nv-y.nv-axis").call(yAxis)}if(showDistX){distX.getData(scatter.x()).scale(x).width(availableWidth).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));gEnter.select(".nv-distWrap").append("g").attr("class","nv-distributionX");g.select(".nv-distributionX").attr("transform","translate(0,"+y.range()[0]+")").datum(data.filter(function(d){return !d.disabled})).call(distX)}if(showDistY){distY.getData(scatter.y()).scale(y).width(availableHeight).color(data.map(function(d,i){return d.color||color(d,i)}).filter(function(d,i){return !data[i].disabled}));gEnter.select(".nv-distWrap").append("g").attr("class","nv-distributionY");g.select(".nv-distributionY").attr("transform","translate("+(rightAlignYAxis?availableWidth:-distY.size())+",0)").datum(data.filter(function(d){return !d.disabled})).call(distY)}if(d3.fisheye){g.select(".nv-background").attr("width",availableWidth).attr("height",availableHeight);g.select(".nv-background").on("mousemove",updateFisheye);g.select(".nv-background").on("click",function(){pauseFisheye=!pauseFisheye});scatter.dispatch.on("elementClick.freezeFisheye",function(){pauseFisheye=!pauseFisheye})}function updateFisheye(){if(pauseFisheye){g.select(".nv-point-paths").style("pointer-events","all");return false}g.select(".nv-point-paths").style("pointer-events","none");var mouse=d3.mouse(this);x.distortion(fisheye).focus(mouse[0]);y.distortion(fisheye).focus(mouse[1]);g.select(".nv-scatterWrap").datum(data.filter(function(d){return !d.disabled})).call(scatter);if(showXAxis){g.select(".nv-x.nv-axis").call(xAxis)}if(showYAxis){g.select(".nv-y.nv-axis").call(yAxis)}g.select(".nv-distributionX").datum(data.filter(function(d){return !d.disabled})).call(distX);g.select(".nv-distributionY").datum(data.filter(function(d){return !d.disabled})).call(distY)}controls.dispatch.on("legendClick",function(d,i){d.disabled=!d.disabled;fisheye=d.disabled?0:2.5;g.select(".nv-background").style("pointer-events",d.disabled?"none":"all");g.select(".nv-point-paths").style("pointer-events",d.disabled?"all":"none");if(d.disabled){x.distortion(fisheye).focus(0);y.distortion(fisheye).focus(0);g.select(".nv-scatterWrap").call(scatter);g.select(".nv-x.nv-axis").call(xAxis);g.select(".nv-y.nv-axis").call(yAxis)}else{pauseFisheye=false}chart.update()});legend.dispatch.on("stateChange",function(newState){state=newState;dispatch.stateChange(state);chart.update()});scatter.dispatch.on("elementMouseover.tooltip",function(e){d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",e.pos[1]-availableHeight);d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",e.pos[0]+distX.size());e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top];dispatch.tooltipShow(e)});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}chart.update()});x0=x.copy();y0=y.copy()});return chart}scatter.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e);d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-distx-"+e.pointIndex).attr("y1",0);d3.select(".nv-chart-"+scatter.id()+" .nv-series-"+e.seriesIndex+" .nv-disty-"+e.pointIndex).attr("x2",distY.size())});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.scatter=scatter;chart.legend=legend;chart.controls=controls;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.distX=distX;chart.distY=distY;d3.rebind(chart,scatter,"id","interactive","pointActive","x","y","shape","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","sizeRange","forceX","forceY","forceSize","clipVoronoi","clipRadius","useVoronoi");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);distX.color(color);distY.color(color);return chart};chart.showDistX=function(_){if(!arguments.length){return showDistX}showDistX=_;return chart};chart.showDistY=function(_){if(!arguments.length){return showDistY}showDistY=_;return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.fisheye=function(_){if(!arguments.length){return fisheye}fisheye=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltipXContent=function(_){if(!arguments.length){return tooltipX}tooltipX=_;return chart};chart.tooltipYContent=function(_){if(!arguments.length){return tooltipY}tooltipY=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};return chart};nv.models.sparkline=function(){var margin={top:2,right:0,bottom:2,left:0},width=400,height=32,animate=true,x=d3.scale.linear(),y=d3.scale.linear(),getX=function(d){return d.x},getY=function(d){return d.y},color=nv.utils.getColor(["#000"]),xDomain,yDomain,xRange,yRange;function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x.domain(xDomain||d3.extent(data,getX)).range(xRange||[0,availableWidth]);y.domain(yDomain||d3.extent(data,getY)).range(yRange||[availableHeight,0]);var wrap=container.selectAll("g.nv-wrap.nv-sparkline").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-sparkline");var gEnter=wrapEnter.append("g");var g=wrap.select("g");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var paths=wrap.selectAll("path").data(function(d){return[d]});paths.enter().append("path");paths.exit().remove();paths.style("stroke",function(d,i){return d.color||color(d,i)}).attr("d",d3.svg.line().x(function(d,i){return x(getX(d,i))}).y(function(d,i){return y(getY(d,i))}));var points=wrap.selectAll("circle.nv-point").data(function(data){var yValues=data.map(function(d,i){return getY(d,i)});function pointIndex(index){if(index!=-1){var result=data[index];result.pointIndex=index;return result}else{return null}}var maxPoint=pointIndex(yValues.lastIndexOf(y.domain()[1])),minPoint=pointIndex(yValues.indexOf(y.domain()[0])),currentPoint=pointIndex(yValues.length-1);return[minPoint,maxPoint,currentPoint].filter(function(d){return d!=null})});points.enter().append("circle");points.exit().remove();points.attr("cx",function(d,i){return x(getX(d,d.pointIndex))}).attr("cy",function(d,i){return y(getY(d,d.pointIndex))}).attr("r",2).attr("class",function(d,i){return getX(d,d.pointIndex)==x.domain()[1]?"nv-point nv-currentValue":getY(d,d.pointIndex)==y.domain()[0]?"nv-point nv-minValue":"nv-point nv-maxValue"})});return chart}chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.x=function(_){if(!arguments.length){return getX}getX=d3.functor(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=d3.functor(_);return chart};chart.xScale=function(_){if(!arguments.length){return x}x=_;return chart};chart.yScale=function(_){if(!arguments.length){return y}y=_;return chart};chart.xDomain=function(_){if(!arguments.length){return xDomain}xDomain=_;return chart};chart.yDomain=function(_){if(!arguments.length){return yDomain}yDomain=_;return chart};chart.xRange=function(_){if(!arguments.length){return xRange}xRange=_;return chart};chart.yRange=function(_){if(!arguments.length){return yRange}yRange=_;return chart};chart.animate=function(_){if(!arguments.length){return animate}animate=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};return chart};nv.models.sparklinePlus=function(){var sparkline=nv.models.sparkline();var margin={top:15,right:100,bottom:10,left:50},width=null,height=null,x,y,index=[],paused=false,xTickFormat=d3.format(",r"),yTickFormat=d3.format(",.2f"),showValue=true,alignValue=true,rightAlignValue=false,noData="No Data Available.";function chart(selection){selection.each(function(data){var container=d3.select(this);var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){chart(selection)};chart.container=this;if(!data||!data.length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}var currentValue=sparkline.y()(data[data.length-1],data.length-1);x=sparkline.xScale();y=sparkline.yScale();var wrap=container.selectAll("g.nv-wrap.nv-sparklineplus").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-sparklineplus");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-sparklineWrap");gEnter.append("g").attr("class","nv-valueWrap");gEnter.append("g").attr("class","nv-hoverArea");wrap.attr("transform","translate("+margin.left+","+margin.top+")");var sparklineWrap=g.select(".nv-sparklineWrap");sparkline.width(availableWidth).height(availableHeight);sparklineWrap.call(sparkline);var valueWrap=g.select(".nv-valueWrap");var value=valueWrap.selectAll(".nv-currentValue").data([currentValue]);value.enter().append("text").attr("class","nv-currentValue").attr("dx",rightAlignValue?-8:8).attr("dy",".9em").style("text-anchor",rightAlignValue?"end":"start");value.attr("x",availableWidth+(rightAlignValue?margin.right:0)).attr("y",alignValue?function(d){return y(d)}:0).style("fill",sparkline.color()(data[data.length-1],data.length-1)).text(yTickFormat(currentValue));gEnter.select(".nv-hoverArea").append("rect").on("mousemove",sparklineHover).on("click",function(){paused=!paused}).on("mouseout",function(){index=[];updateValueLine()});g.select(".nv-hoverArea rect").attr("transform",function(d){return"translate("+-margin.left+","+-margin.top+")"}).attr("width",availableWidth+margin.left+margin.right).attr("height",availableHeight+margin.top);function updateValueLine(){if(paused){return}var hoverValue=g.selectAll(".nv-hoverValue").data(index);var hoverEnter=hoverValue.enter().append("g").attr("class","nv-hoverValue").style("stroke-opacity",0).style("fill-opacity",0);hoverValue.exit().transition().duration(250).style("stroke-opacity",0).style("fill-opacity",0).remove();hoverValue.attr("transform",function(d){return"translate("+x(sparkline.x()(data[d],d))+",0)"}).transition().duration(250).style("stroke-opacity",1).style("fill-opacity",1);if(!index.length){return}hoverEnter.append("line").attr("x1",0).attr("y1",-margin.top).attr("x2",0).attr("y2",availableHeight);hoverEnter.append("text").attr("class","nv-xValue").attr("x",-6).attr("y",-margin.top).attr("text-anchor","end").attr("dy",".9em");g.select(".nv-hoverValue .nv-xValue").text(xTickFormat(sparkline.x()(data[index[0]],index[0])));hoverEnter.append("text").attr("class","nv-yValue").attr("x",6).attr("y",-margin.top).attr("text-anchor","start").attr("dy",".9em");g.select(".nv-hoverValue .nv-yValue").text(yTickFormat(sparkline.y()(data[index[0]],index[0])))}function sparklineHover(){if(paused){return}var pos=d3.mouse(this)[0]-margin.left;function getClosestIndex(data,x){var distance=Math.abs(sparkline.x()(data[0],0)-x);var closestIndex=0;for(var i=0;i<data.length;i++){if(Math.abs(sparkline.x()(data[i],i)-x)<distance){distance=Math.abs(sparkline.x()(data[i],i)-x);closestIndex=i}}return closestIndex}index=[getClosestIndex(data,Math.round(x.invert(pos)))];updateValueLine()}});return chart}chart.sparkline=sparkline;d3.rebind(chart,sparkline,"x","y","xScale","yScale","color");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.xTickFormat=function(_){if(!arguments.length){return xTickFormat}xTickFormat=_;return chart};chart.yTickFormat=function(_){if(!arguments.length){return yTickFormat}yTickFormat=_;return chart};chart.showValue=function(_){if(!arguments.length){return showValue}showValue=_;return chart};chart.alignValue=function(_){if(!arguments.length){return alignValue}alignValue=_;return chart};chart.rightAlignValue=function(_){if(!arguments.length){return rightAlignValue}rightAlignValue=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};return chart};nv.models.stackedArea=function(){var margin={top:0,right:0,bottom:0,left:0},width=960,height=500,color=nv.utils.defaultColor(),id=Math.floor(Math.random()*100000),getX=function(d){return d.x},getY=function(d){return d.y},style="stack",offset="zero",order="default",interpolate="linear",clipEdge=false,x,y,scatter=nv.models.scatter(),dispatch=d3.dispatch("tooltipShow","tooltipHide","areaClick","areaMouseover","areaMouseout");scatter.size(2.2).sizeDomain([2.2,2.2]);function chart(selection){selection.each(function(data){var availableWidth=width-margin.left-margin.right,availableHeight=height-margin.top-margin.bottom,container=d3.select(this);x=scatter.xScale();y=scatter.yScale();var dataRaw=data;data.forEach(function(aseries,i){aseries.seriesIndex=i;aseries.values=aseries.values.map(function(d,j){d.index=j;d.seriesIndex=i;return d})});var dataFiltered=data.filter(function(series){return !series.disabled});data=d3.layout.stack().order(order).offset(offset).values(function(d){return d.values}).x(getX).y(getY).out(function(d,y0,y){var yHeight=(getY(d)===0)?0:y;d.display={y:yHeight,y0:y0}})(dataFiltered);var wrap=container.selectAll("g.nv-wrap.nv-stackedarea").data([data]);var wrapEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedarea");var defsEnter=wrapEnter.append("defs");var gEnter=wrapEnter.append("g");var g=wrap.select("g");gEnter.append("g").attr("class","nv-areaWrap");gEnter.append("g").attr("class","nv-scatterWrap");wrap.attr("transform","translate("+margin.left+","+margin.top+")");scatter.width(availableWidth).height(availableHeight).x(getX).y(function(d){return d.display.y+d.display.y0}).forceY([0]).color(data.map(function(d,i){return d.color||color(d,d.seriesIndex)}));var scatterWrap=g.select(".nv-scatterWrap").datum(data);scatterWrap.call(scatter);defsEnter.append("clipPath").attr("id","nv-edge-clip-"+id).append("rect");wrap.select("#nv-edge-clip-"+id+" rect").attr("width",availableWidth).attr("height",availableHeight);g.attr("clip-path",clipEdge?"url(#nv-edge-clip-"+id+")":"");var area=d3.svg.area().x(function(d,i){return x(getX(d,i))}).y0(function(d){return y(d.display.y0)}).y1(function(d){return y(d.display.y+d.display.y0)}).interpolate(interpolate);var zeroArea=d3.svg.area().x(function(d,i){return x(getX(d,i))}).y0(function(d){return y(d.display.y0)}).y1(function(d){return y(d.display.y0)});var path=g.select(".nv-areaWrap").selectAll("path.nv-area").data(function(d){return d});path.enter().append("path").attr("class",function(d,i){return"nv-area nv-area-"+i}).attr("d",function(d,i){return zeroArea(d.values,d.seriesIndex)}).on("mouseover",function(d,i){d3.select(this).classed("hover",true);dispatch.areaMouseover({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:i})}).on("mouseout",function(d,i){d3.select(this).classed("hover",false);dispatch.areaMouseout({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:i})}).on("click",function(d,i){d3.select(this).classed("hover",false);dispatch.areaClick({point:d,series:d.key,pos:[d3.event.pageX,d3.event.pageY],seriesIndex:i})});path.exit().transition().attr("d",function(d,i){return zeroArea(d.values,i)}).remove();path.style("fill",function(d,i){return d.color||color(d,d.seriesIndex)}).style("stroke",function(d,i){return d.color||color(d,d.seriesIndex)});path.transition().attr("d",function(d,i){return area(d.values,i)});scatter.dispatch.on("elementMouseover.area",function(e){g.select(".nv-chart-"+id+" .nv-area-"+e.seriesIndex).classed("hover",true)});scatter.dispatch.on("elementMouseout.area",function(e){g.select(".nv-chart-"+id+" .nv-area-"+e.seriesIndex).classed("hover",false)});chart.d3_stackedOffset_stackPercent=function(stackData){var n=stackData.length,m=stackData[0].length,k=1/n,i,j,o,y0=[];for(j=0;j<m;++j){for(i=0,o=0;i<dataRaw.length;i++){o+=getY(dataRaw[i].values[j])}if(o){for(i=0;i<n;i++){stackData[i][j][1]/=o}}else{for(i=0;i<n;i++){stackData[i][j][1]=k}}}for(j=0;j<m;++j){y0[j]=0}return y0}});return chart}scatter.dispatch.on("elementClick.area",function(e){dispatch.areaClick(e)});scatter.dispatch.on("elementMouseover.tooltip",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top],dispatch.tooltipShow(e)});scatter.dispatch.on("elementMouseout.tooltip",function(e){dispatch.tooltipHide(e)});chart.dispatch=dispatch;chart.scatter=scatter;d3.rebind(chart,scatter,"interactive","size","xScale","yScale","zScale","xDomain","yDomain","xRange","yRange","sizeDomain","forceX","forceY","forceSize","clipVoronoi","useVoronoi","clipRadius","highlightPoint","clearHighlights");chart.options=nv.utils.optionsFunc.bind(chart);chart.x=function(_){if(!arguments.length){return getX}getX=d3.functor(_);return chart};chart.y=function(_){if(!arguments.length){return getY}getY=d3.functor(_);return chart};chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.clipEdge=function(_){if(!arguments.length){return clipEdge}clipEdge=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);return chart};chart.offset=function(_){if(!arguments.length){return offset}offset=_;return chart};chart.order=function(_){if(!arguments.length){return order}order=_;return chart};chart.style=function(_){if(!arguments.length){return style}style=_;switch(style){case"stack":chart.offset("zero");chart.order("default");break;case"stream":chart.offset("wiggle");chart.order("inside-out");break;case"stream-center":chart.offset("silhouette");chart.order("inside-out");break;case"expand":chart.offset("expand");chart.order("default");break;case"stack_percent":chart.offset(chart.d3_stackedOffset_stackPercent);chart.order("default");break}return chart};chart.interpolate=function(_){if(!arguments.length){return interpolate}interpolate=_;return chart};return chart};nv.models.stackedAreaChart=function(){var stacked=nv.models.stackedArea(),xAxis=nv.models.axis(),yAxis=nv.models.axis(),legend=nv.models.legend(),controls=nv.models.legend(),interactiveLayer=nv.interactiveGuideline();var margin={top:30,right:25,bottom:50,left:60},width=null,height=null,color=nv.utils.defaultColor(),showControls=true,showLegend=true,showXAxis=true,showYAxis=true,rightAlignYAxis=false,useInteractiveGuideline=false,tooltips=true,tooltip=function(key,x,y,e,graph){return"<h3>"+key+"</h3><p>"+y+" on "+x+"</p>"},x,y,yAxisTickFormat=d3.format(",.2f"),state={style:stacked.style()},defaultState=null,noData="No Data Available.",dispatch=d3.dispatch("tooltipShow","tooltipHide","stateChange","changeState"),controlWidth=250,cData=["Stacked","Stream","Expanded"],controlLabels={},transitionDuration=250;xAxis.orient("bottom").tickPadding(7);yAxis.orient((rightAlignYAxis)?"right":"left");controls.updateState(false);var showTooltip=function(e,offsetElement){var left=e.pos[0]+(offsetElement.offsetLeft||0),top=e.pos[1]+(offsetElement.offsetTop||0),x=xAxis.tickFormat()(stacked.x()(e.point,e.pointIndex)),y=yAxis.tickFormat()(stacked.y()(e.point,e.pointIndex)),content=tooltip(e.series.key,x,y,e,chart);nv.tooltip.show([left,top],content,e.value<0?"n":"s",null,offsetElement)};function chart(selection){selection.each(function(data){var container=d3.select(this),that=this;var availableWidth=(width||parseInt(container.style("width"))||960)-margin.left-margin.right,availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom;chart.update=function(){container.transition().duration(transitionDuration).call(chart)};chart.container=this;state.disabled=data.map(function(d){return !!d.disabled});if(!defaultState){var key;defaultState={};for(key in state){if(state[key] instanceof Array){defaultState[key]=state[key].slice(0)}else{defaultState[key]=state[key]}}}if(!data||!data.length||!data.filter(function(d){return d.values.length}).length){var noDataText=container.selectAll(".nv-noData").data([noData]);noDataText.enter().append("text").attr("class","nvd3 nv-noData").attr("dy","-.7em").style("text-anchor","middle");noDataText.attr("x",margin.left+availableWidth/2).attr("y",margin.top+availableHeight/2).text(function(d){return d});return chart}else{container.selectAll(".nv-noData").remove()}x=stacked.xScale();y=stacked.yScale();var wrap=container.selectAll("g.nv-wrap.nv-stackedAreaChart").data([data]);var gEnter=wrap.enter().append("g").attr("class","nvd3 nv-wrap nv-stackedAreaChart").append("g");var g=wrap.select("g");gEnter.append("rect").style("opacity",0);gEnter.append("g").attr("class","nv-x nv-axis");gEnter.append("g").attr("class","nv-y nv-axis");gEnter.append("g").attr("class","nv-stackedWrap");gEnter.append("g").attr("class","nv-legendWrap");gEnter.append("g").attr("class","nv-controlsWrap");gEnter.append("g").attr("class","nv-interactive");g.select("rect").attr("width",availableWidth).attr("height",availableHeight);if(showLegend){var legendWidth=(showControls)?availableWidth-controlWidth:availableWidth;legend.width(legendWidth);g.select(".nv-legendWrap").datum(data).call(legend);if(margin.top!=legend.height()){margin.top=legend.height();availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-legendWrap").attr("transform","translate("+(availableWidth-legendWidth)+","+(-margin.top)+")")}if(showControls){var controlsData=[{key:controlLabels.stacked||"Stacked",metaKey:"Stacked",disabled:stacked.style()!="stack",style:"stack"},{key:controlLabels.stream||"Stream",metaKey:"Stream",disabled:stacked.style()!="stream",style:"stream"},{key:controlLabels.expanded||"Expanded",metaKey:"Expanded",disabled:stacked.style()!="expand",style:"expand"},{key:controlLabels.stack_percent||"Stack %",metaKey:"Stack_Percent",disabled:stacked.style()!="stack_percent",style:"stack_percent"}];controlWidth=(cData.length/3)*260;controlsData=controlsData.filter(function(d){return cData.indexOf(d.metaKey)!==-1});controls.width(controlWidth).color(["#444","#444","#444"]);g.select(".nv-controlsWrap").datum(controlsData).call(controls);if(margin.top!=Math.max(controls.height(),legend.height())){margin.top=Math.max(controls.height(),legend.height());availableHeight=(height||parseInt(container.style("height"))||400)-margin.top-margin.bottom}g.select(".nv-controlsWrap").attr("transform","translate(0,"+(-margin.top)+")")}wrap.attr("transform","translate("+margin.left+","+margin.top+")");if(rightAlignYAxis){g.select(".nv-y.nv-axis").attr("transform","translate("+availableWidth+",0)")}if(useInteractiveGuideline){interactiveLayer.width(availableWidth).height(availableHeight).margin({left:margin.left,top:margin.top}).svgContainer(container).xScale(x);wrap.select(".nv-interactive").call(interactiveLayer)}stacked.width(availableWidth).height(availableHeight);var stackedWrap=g.select(".nv-stackedWrap").datum(data);stackedWrap.transition().call(stacked);if(showXAxis){xAxis.scale(x).ticks(availableWidth/100).tickSize(-availableHeight,0);g.select(".nv-x.nv-axis").attr("transform","translate(0,"+availableHeight+")");g.select(".nv-x.nv-axis").transition().duration(0).call(xAxis)}if(showYAxis){yAxis.scale(y).ticks(stacked.offset()=="wiggle"?0:availableHeight/36).tickSize(-availableWidth,0).setTickFormat((stacked.style()=="expand"||stacked.style()=="stack_percent")?d3.format("%"):yAxisTickFormat);g.select(".nv-y.nv-axis").transition().duration(0).call(yAxis)}stacked.dispatch.on("areaClick.toggle",function(e){if(data.filter(function(d){return !d.disabled}).length===1){data.forEach(function(d){d.disabled=false})}else{data.forEach(function(d,i){d.disabled=(i!=e.seriesIndex)})}state.disabled=data.map(function(d){return !!d.disabled});dispatch.stateChange(state);chart.update()});legend.dispatch.on("stateChange",function(newState){state.disabled=newState.disabled;dispatch.stateChange(state);chart.update()});controls.dispatch.on("legendClick",function(d,i){if(!d.disabled){return}controlsData=controlsData.map(function(s){s.disabled=true;return s});d.disabled=false;stacked.style(d.style);state.style=stacked.style();dispatch.stateChange(state);chart.update()});interactiveLayer.dispatch.on("elementMousemove",function(e){stacked.clearHighlights();var singlePoint,pointIndex,pointXLocation,allData=[];data.filter(function(series,i){series.seriesIndex=i;return !series.disabled}).forEach(function(series,i){pointIndex=nv.interactiveBisect(series.values,e.pointXValue,chart.x());stacked.highlightPoint(i,pointIndex,true);var point=series.values[pointIndex];if(typeof point==="undefined"){return}if(typeof singlePoint==="undefined"){singlePoint=point}if(typeof pointXLocation==="undefined"){pointXLocation=chart.xScale()(chart.x()(point,pointIndex))}var tooltipValue=(stacked.style()=="expand")?point.display.y:chart.y()(point,pointIndex);allData.push({key:series.key,value:tooltipValue,color:color(series,series.seriesIndex),stackedValue:point.display})});allData.reverse();if(allData.length>2){var yValue=chart.yScale().invert(e.mouseY);var yDistMax=Infinity,indexToHighlight=null;allData.forEach(function(series,i){if(yValue>=series.stackedValue.y0&&yValue<=(series.stackedValue.y0+series.stackedValue.y)){indexToHighlight=i;return}});if(indexToHighlight!=null){allData[indexToHighlight].highlight=true}}var xValue=xAxis.tickFormat()(chart.x()(singlePoint,pointIndex));var valueFormatter=(stacked.style()=="expand")?function(d,i){return d3.format(".1%")(d)}:function(d,i){return yAxis.tickFormat()(d)};interactiveLayer.tooltip.position({left:pointXLocation+margin.left,top:e.mouseY+margin.top}).chartContainer(that.parentNode).enabled(tooltips).valueFormatter(valueFormatter).data({value:xValue,series:allData})();interactiveLayer.renderGuideLine(pointXLocation)});interactiveLayer.dispatch.on("elementMouseout",function(e){dispatch.tooltipHide();stacked.clearHighlights()});dispatch.on("tooltipShow",function(e){if(tooltips){showTooltip(e,that.parentNode)}});dispatch.on("changeState",function(e){if(typeof e.disabled!=="undefined"){data.forEach(function(series,i){series.disabled=e.disabled[i]});state.disabled=e.disabled}if(typeof e.style!=="undefined"){stacked.style(e.style)}chart.update()})});return chart}stacked.dispatch.on("tooltipShow",function(e){e.pos=[e.pos[0]+margin.left,e.pos[1]+margin.top],dispatch.tooltipShow(e)});stacked.dispatch.on("tooltipHide",function(e){dispatch.tooltipHide(e)});dispatch.on("tooltipHide",function(){if(tooltips){nv.tooltip.cleanup()}});chart.dispatch=dispatch;chart.stacked=stacked;chart.legend=legend;chart.controls=controls;chart.xAxis=xAxis;chart.yAxis=yAxis;chart.interactiveLayer=interactiveLayer;d3.rebind(chart,stacked,"x","y","size","xScale","yScale","xDomain","yDomain","xRange","yRange","sizeDomain","interactive","useVoronoi","offset","order","style","clipEdge","forceX","forceY","forceSize","interpolate");chart.options=nv.utils.optionsFunc.bind(chart);chart.margin=function(_){if(!arguments.length){return margin}margin.top=typeof _.top!="undefined"?_.top:margin.top;margin.right=typeof _.right!="undefined"?_.right:margin.right;margin.bottom=typeof _.bottom!="undefined"?_.bottom:margin.bottom;margin.left=typeof _.left!="undefined"?_.left:margin.left;return chart};chart.width=function(_){if(!arguments.length){return width}width=_;return chart};chart.height=function(_){if(!arguments.length){return height}height=_;return chart};chart.color=function(_){if(!arguments.length){return color}color=nv.utils.getColor(_);legend.color(color);stacked.color(color);return chart};chart.showControls=function(_){if(!arguments.length){return showControls}showControls=_;return chart};chart.showLegend=function(_){if(!arguments.length){return showLegend}showLegend=_;return chart};chart.showXAxis=function(_){if(!arguments.length){return showXAxis}showXAxis=_;return chart};chart.showYAxis=function(_){if(!arguments.length){return showYAxis}showYAxis=_;return chart};chart.rightAlignYAxis=function(_){if(!arguments.length){return rightAlignYAxis}rightAlignYAxis=_;yAxis.orient((_)?"right":"left");return chart};chart.useInteractiveGuideline=function(_){if(!arguments.length){return useInteractiveGuideline}useInteractiveGuideline=_;if(_===true){chart.interactive(false);chart.useVoronoi(false)}return chart};chart.tooltip=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.tooltips=function(_){if(!arguments.length){return tooltips}tooltips=_;return chart};chart.tooltipContent=function(_){if(!arguments.length){return tooltip}tooltip=_;return chart};chart.state=function(_){if(!arguments.length){return state}state=_;return chart};chart.defaultState=function(_){if(!arguments.length){return defaultState}defaultState=_;return chart};chart.noData=function(_){if(!arguments.length){return noData}noData=_;return chart};chart.transitionDuration=function(_){if(!arguments.length){return transitionDuration}transitionDuration=_;return chart};chart.controlsData=function(_){if(!arguments.length){return cData}cData=_;return chart};chart.controlLabels=function(_){if(!arguments.length){return controlLabels}if(typeof _!=="object"){return controlLabels}controlLabels=_;return chart};yAxis.setTickFormat=yAxis.tickFormat;yAxis.tickFormat=function(_){if(!arguments.length){return yAxisTickFormat}yAxisTickFormat=_;return yAxis};return chart};(function(){window.nv.tooltip={};window.nv.models.tooltip=function(){var content=null,data=null,gravity="w",distance=50,snapDistance=25,fixedTop=null,classes=null,chartContainer=null,tooltipElem=null,position={left:null,top:null},enabled=true,id="nvtooltip-"+Math.floor(Math.random()*100000);var nvPointerEventsClass="nv-pointer-events-none";var valueFormatter=function(d,i){return d};var headerFormatter=function(d){return d};var contentGenerator=function(d){if(content!=null){return content}if(d==null){return""}var table=d3.select(document.createElement("table"));var theadEnter=table.selectAll("thead").data([d]).enter().append("thead");theadEnter.append("tr").append("td").attr("colspan",3).append("strong").classed("x-value",true).html(headerFormatter(d.value));var tbodyEnter=table.selectAll("tbody").data([d]).enter().append("tbody");var trowEnter=tbodyEnter.selectAll("tr").data(function(p){return p.series}).enter().append("tr").classed("highlight",function(p){return p.highlight});trowEnter.append("td").classed("legend-color-guide",true).append("div").style("background-color",function(p){return p.color});trowEnter.append("td").classed("key",true).html(function(p){return p.key});trowEnter.append("td").classed("value",true).html(function(p,i){return valueFormatter(p.value,i)});trowEnter.selectAll("td").each(function(p){if(p.highlight){var opacityScale=d3.scale.linear().domain([0,1]).range(["#fff",p.color]);var opacity=0.6;d3.select(this).style("border-bottom-color",opacityScale(opacity)).style("border-top-color",opacityScale(opacity))}});var html=table.node().outerHTML;if(d.footer!==undefined){html+="<div class='footer'>"+d.footer+"</div>"}return html};var dataSeriesExists=function(d){if(d&&d.series&&d.series.length>0){return true}return false};function convertViewBoxRatio(){if(chartContainer){var svg=d3.select(chartContainer);if(svg.node().tagName!=="svg"){svg=svg.select("svg")}var viewBox=(svg.node())?svg.attr("viewBox"):null;if(viewBox){viewBox=viewBox.split(" ");var ratio=parseInt(svg.style("width"))/viewBox[2];position.left=position.left*ratio;position.top=position.top*ratio}}}function getTooltipContainer(newContent){var body;if(chartContainer){body=d3.select(chartContainer)}else{body=d3.select("body")}var container=body.select(".nvtooltip");if(container.node()===null){container=body.append("div").attr("class","nvtooltip "+(classes?classes:"xy-tooltip")).attr("id",id)}container.node().innerHTML=newContent;container.style("top",0).style("left",0).style("opacity",0);container.selectAll("div, table, td, tr").classed(nvPointerEventsClass,true);container.classed(nvPointerEventsClass,true);return container.node()}function nvtooltip(){if(!enabled){return}if(!dataSeriesExists(data)){return}convertViewBoxRatio();var left=position.left;var top=(fixedTop!=null)?fixedTop:position.top;var container=getTooltipContainer(contentGenerator(data));tooltipElem=container;if(chartContainer){var svgComp=chartContainer.getElementsByTagName("svg")[0];var boundRect=(svgComp)?svgComp.getBoundingClientRect():chartContainer.getBoundingClientRect();var svgOffset={left:0,top:0};if(svgComp){var svgBound=svgComp.getBoundingClientRect();var chartBound=chartContainer.getBoundingClientRect();var svgBoundTop=svgBound.top;if(svgBoundTop<0){var containerBound=chartContainer.getBoundingClientRect();svgBoundTop=(Math.abs(svgBoundTop)>containerBound.height)?0:svgBoundTop}svgOffset.top=Math.abs(svgBoundTop-chartBound.top);svgOffset.left=Math.abs(svgBound.left-chartBound.left)}left+=chartContainer.offsetLeft+svgOffset.left-2*chartContainer.scrollLeft;top+=chartContainer.offsetTop+svgOffset.top-2*chartContainer.scrollTop}if(snapDistance&&snapDistance>0){top=Math.floor(top/snapDistance)*snapDistance}nv.tooltip.calcTooltipPosition([left,top],gravity,distance,container);return nvtooltip}nvtooltip.nvPointerEventsClass=nvPointerEventsClass;nvtooltip.content=function(_){if(!arguments.length){return content}content=_;return nvtooltip};nvtooltip.tooltipElem=function(){return tooltipElem};nvtooltip.contentGenerator=function(_){if(!arguments.length){return contentGenerator}if(typeof _==="function"){contentGenerator=_}return nvtooltip};nvtooltip.data=function(_){if(!arguments.length){return data}data=_;return nvtooltip};nvtooltip.gravity=function(_){if(!arguments.length){return gravity}gravity=_;return nvtooltip};nvtooltip.distance=function(_){if(!arguments.length){return distance}distance=_;return nvtooltip};nvtooltip.snapDistance=function(_){if(!arguments.length){return snapDistance}snapDistance=_;return nvtooltip};nvtooltip.classes=function(_){if(!arguments.length){return classes}classes=_;return nvtooltip};nvtooltip.chartContainer=function(_){if(!arguments.length){return chartContainer}chartContainer=_;return nvtooltip};nvtooltip.position=function(_){if(!arguments.length){return position}position.left=(typeof _.left!=="undefined")?_.left:position.left;position.top=(typeof _.top!=="undefined")?_.top:position.top;return nvtooltip};nvtooltip.fixedTop=function(_){if(!arguments.length){return fixedTop}fixedTop=_;return nvtooltip};nvtooltip.enabled=function(_){if(!arguments.length){return enabled}enabled=_;return nvtooltip};nvtooltip.valueFormatter=function(_){if(!arguments.length){return valueFormatter}if(typeof _==="function"){valueFormatter=_}return nvtooltip};nvtooltip.headerFormatter=function(_){if(!arguments.length){return headerFormatter}if(typeof _==="function"){headerFormatter=_}return nvtooltip};nvtooltip.id=function(){return id};return nvtooltip};nv.tooltip.show=function(pos,content,gravity,dist,parentContainer,classes){var container=document.createElement("div");container.className="nvtooltip "+(classes?classes:"xy-tooltip");var body=parentContainer;if(!parentContainer||parentContainer.tagName.match(/g|svg/i)){body=document.getElementsByTagName("body")[0]}container.style.left=0;container.style.top=0;container.style.opacity=0;container.innerHTML=content;body.appendChild(container);if(parentContainer){pos[0]=pos[0]-parentContainer.scrollLeft;pos[1]=pos[1]-parentContainer.scrollTop}nv.tooltip.calcTooltipPosition(pos,gravity,dist,container)};nv.tooltip.findFirstNonSVGParent=function(Elem){while(Elem.tagName.match(/^g|svg$/i)!==null){Elem=Elem.parentNode}return Elem};nv.tooltip.findTotalOffsetTop=function(Elem,initialTop){var offsetTop=initialTop;do{if(!isNaN(Elem.offsetTop)){offsetTop+=(Elem.offsetTop)}}while(Elem=Elem.offsetParent);return offsetTop};nv.tooltip.findTotalOffsetLeft=function(Elem,initialLeft){var offsetLeft=initialLeft;do{if(!isNaN(Elem.offsetLeft)){offsetLeft+=(Elem.offsetLeft)}}while(Elem=Elem.offsetParent);return offsetLeft};nv.tooltip.calcTooltipPosition=function(pos,gravity,dist,container){var height=parseInt(container.offsetHeight),width=parseInt(container.offsetWidth),windowWidth=nv.utils.windowSize().width,windowHeight=nv.utils.windowSize().height,scrollTop=window.pageYOffset,scrollLeft=window.pageXOffset,left,top;windowHeight=window.innerWidth>=document.body.scrollWidth?windowHeight:windowHeight-16;windowWidth=window.innerHeight>=document.body.scrollHeight?windowWidth:windowWidth-16;gravity=gravity||"s";dist=dist||20;var tooltipTop=function(Elem){return nv.tooltip.findTotalOffsetTop(Elem,top)};var tooltipLeft=function(Elem){return nv.tooltip.findTotalOffsetLeft(Elem,left)};switch(gravity){case"e":left=pos[0]-width-dist;top=pos[1]-(height/2);var tLeft=tooltipLeft(container);var tTop=tooltipTop(container);if(tLeft<scrollLeft){left=pos[0]+dist>scrollLeft?pos[0]+dist:scrollLeft-tLeft+left}if(tTop<scrollTop){top=scrollTop-tTop+top}if(tTop+height>scrollTop+windowHeight){top=scrollTop+windowHeight-tTop+top-height}break;case"w":left=pos[0]+dist;top=pos[1]-(height/2);var tLeft=tooltipLeft(container);var tTop=tooltipTop(container);if(tLeft+width>windowWidth){left=pos[0]-width-dist}if(tTop<scrollTop){top=scrollTop+5}if(tTop+height>scrollTop+windowHeight){top=scrollTop+windowHeight-tTop+top-height}break;case"n":left=pos[0]-(width/2)-5;top=pos[1]+dist;var tLeft=tooltipLeft(container);var tTop=tooltipTop(container);if(tLeft<scrollLeft){left=scrollLeft+5}if(tLeft+width>windowWidth){left=left-width/2+5}if(tTop+height>scrollTop+windowHeight){top=scrollTop+windowHeight-tTop+top-height}break;case"s":left=pos[0]-(width/2);top=pos[1]-height-dist;var tLeft=tooltipLeft(container);var tTop=tooltipTop(container);if(tLeft<scrollLeft){left=scrollLeft+5}if(tLeft+width>windowWidth){left=left-width/2+5}if(scrollTop>tTop){top=scrollTop}break;case"none":left=pos[0];top=pos[1]-dist;var tLeft=tooltipLeft(container);var tTop=tooltipTop(container);break}container.style.left=left+"px";container.style.top=top+"px";container.style.opacity=1;container.style.position="absolute";return container};nv.tooltip.cleanup=function(){var tooltips=document.getElementsByClassName("nvtooltip");var purging=[];while(tooltips.length){purging.push(tooltips[0]);tooltips[0].style.transitionDelay="0 !important";tooltips[0].style.opacity=0;tooltips[0].className="nvtooltip-pending-removal"}setTimeout(function(){while(purging.length){var removeMe=purging.pop();removeMe.parentNode.removeChild(removeMe)}},500)}})();nv.utils.windowSize=function(){var size={width:640,height:480};if(document.body&&document.body.offsetWidth){size.width=document.body.offsetWidth;size.height=document.body.offsetHeight}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){size.width=document.documentElement.offsetWidth;size.height=document.documentElement.offsetHeight}if(window.innerWidth&&window.innerHeight){size.width=window.innerWidth;size.height=window.innerHeight}return(size)};nv.utils.windowResize=function(fun){if(fun===undefined){return}var oldresize=window.onresize;window.onresize=function(e){if(typeof oldresize=="function"){oldresize(e)}fun(e)}};nv.utils.getColor=function(color){if(!arguments.length){return nv.utils.defaultColor()}if(Object.prototype.toString.call(color)==="[object Array]"){return function(d,i){return d.color||color[i%color.length]}}else{return color}};nv.utils.defaultColor=function(){var colors=d3.scale.category20().range();return function(d,i){return d.color||colors[i%colors.length]}};nv.utils.customTheme=function(dictionary,getKey,defaultColors){getKey=getKey||function(series){return series.key};defaultColors=defaultColors||d3.scale.category20().range();var defIndex=defaultColors.length;return function(series,index){var key=getKey(series);if(!defIndex){defIndex=defaultColors.length}if(typeof dictionary[key]!=="undefined"){return(typeof dictionary[key]==="function")?dictionary[key]():dictionary[key]}else{return defaultColors[--defIndex]}}};nv.utils.pjax=function(links,content){d3.selectAll(links).on("click",function(){history.pushState(this.href,this.textContent,this.href);load(this.href);d3.event.preventDefault()});function load(href){d3.html(href,function(fragment){var target=d3.select(content).node();target.parentNode.replaceChild(d3.select(fragment).select(content).node(),target);nv.utils.pjax(links,content)})}d3.select(window).on("popstate",function(){if(d3.event.state){load(d3.event.state)}})};nv.utils.calcApproxTextWidth=function(svgTextElem){if(svgTextElem instanceof d3.selection){var fontSize=parseInt(svgTextElem.style("font-size").replace("px",""));var textLength=svgTextElem.text().length;return textLength*fontSize*0.5}return 0};nv.utils.NaNtoZero=function(n){if(typeof n!=="number"||isNaN(n)||n===null||n===Infinity){return 0}return n};nv.utils.optionsFunc=function(args){if(args){d3.map(args).forEach((function(key,value){if(typeof this[key]==="function"){this[key](value)}}).bind(this))}return this};if(!jQuery){throw new Error("Bootstrap requires jQuery")}+function(a){function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b){if(void 0!==a.style[c]){return{end:b[c]}}}}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one(a.support.transition.end,function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b()})}(window.jQuery),+function(a){var b='[data-dismiss="alert"]',c=function(c){a(c).on("click",b,this.close)};c.prototype.close=function(b){function c(){f.trigger("closed.bs.alert").remove()}var d=a(this),e=d.attr("data-target");e||(e=d.attr("href"),e=e&&e.replace(/.*(?=#[^\s]*$)/,""));var f=a(e);b&&b.preventDefault(),f.length||(f=d.hasClass("alert")?d:d.parent()),f.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one(a.support.transition.end,c).emulateTransitionEnd(150):c())};var d=a.fn.alert;a.fn.alert=function(b){return this.each(function(){var d=a(this),e=d.data("bs.alert");e||d.data("bs.alert",e=new c(this)),"string"==typeof b&&e[b].call(d)})},a.fn.alert.Constructor=c,a.fn.alert.noConflict=function(){return a.fn.alert=d,this},a(document).on("click.bs.alert.data-api",b,c.prototype.close)}(window.jQuery),+function(a){var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d)};b.DEFAULTS={loadingText:"loading..."},b.prototype.setState=function(a){var b="disabled",c=this.$element,d=c.is("input")?"val":"html",e=c.data();a+="Text",e.resetText||c.data("resetText",c[d]()),c[d](e[a]||this.options[a]),setTimeout(function(){"loadingText"==a?c.addClass(b).attr(b,b):c.removeClass(b).removeAttr(b)},0)},b.prototype.toggle=function(){var a=this.$element.closest('[data-toggle="buttons"]');if(a.length){var b=this.$element.find("input").prop("checked",!this.$element.hasClass("active")).trigger("change");"radio"===b.prop("type")&&a.find(".active").removeClass("active")}this.$element.toggleClass("active")};var c=a.fn.button;a.fn.button=function(c){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof c&&c;e||d.data("bs.button",e=new b(this,f)),"toggle"==c?e.toggle():c&&e.setState(c)})},a.fn.button.Constructor=b,a.fn.button.noConflict=function(){return a.fn.button=c,this},a(document).on("click.bs.button.data-api","[data-toggle^=button]",function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),c.button("toggle"),b.preventDefault()})}(window.jQuery),+function(a){var b=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};b.DEFAULTS={interval:5000,pause:"hover",wrap:!0},b.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},b.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},b.prototype.to=function(b){var c=this,d=this.getActiveIndex();return b>this.$items.length-1||0>b?void 0:this.sliding?this.$element.one("slid",function(){c.to(b)}):d==b?this.pause().cycle():this.slide(b>d?"next":"prev",a(this.$items[b]))},b.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition.end&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},b.prototype.next=function(){return this.sliding?void 0:this.slide("next")},b.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},b.prototype.slide=function(b,c){var d=this.$element.find(".item.active"),e=c||d[b](),f=this.interval,g="next"==b?"left":"right",h="next"==b?"first":"last",i=this;if(!e.length){if(!this.options.wrap){return}e=this.$element.find(".item")[h]()}this.sliding=!0,f&&this.pause();var j=a.Event("slide.bs.carousel",{relatedTarget:e[0],direction:g});if(!e.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var b=a(i.$indicators.children()[i.getActiveIndex()]);b&&b.addClass("active")})),a.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(j),j.isDefaultPrevented()){return}e.addClass(b),e[0].offsetWidth,d.addClass(g),e.addClass(g),d.one(a.support.transition.end,function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger("slid")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(j),j.isDefaultPrevented()){return}d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return f&&this.cycle(),this}};var c=a.fn.carousel;a.fn.carousel=function(c){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c),g="string"==typeof c?c:f.slide;e||d.data("bs.carousel",e=new b(this,f)),"number"==typeof c?e.to(c):g?e[g]():f.interval&&e.pause().cycle()})},a.fn.carousel.Constructor=b,a.fn.carousel.noConflict=function(){return a.fn.carousel=c,this},a(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(b){var c,d=a(this),e=a(d.attr("data-target")||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"")),f=a.extend({},e.data(),d.data()),g=d.attr("data-slide-to");g&&(f.interval=!1),e.carousel(f),(g=d.attr("data-slide-to"))&&e.data("bs.carousel").to(g),b.preventDefault()}),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var b=a(this);b.carousel(b.data())})})}(window.jQuery),+function(a){var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d),this.transitioning=null,this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};b.DEFAULTS={toggle:!0},b.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},b.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b=a.Event("show.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.$parent&&this.$parent.find("> .panel > .in");if(c&&c.length){var d=c.data("bs.collapse");if(d&&d.transitioning){return}c.collapse("hide"),d||c.data("bs.collapse",null)}var e=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[e](0),this.transitioning=1;var f=function(){this.$element.removeClass("collapsing").addClass("in")[e]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition){return f.call(this)}var g=a.camelCase(["scroll",e].join("-"));this.$element.one(a.support.transition.end,a.proxy(f,this)).emulateTransitionEnd(350)[e](this.$element[0][g])}}},b.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var d=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return a.support.transition?(this.$element[c](0).one(a.support.transition.end,a.proxy(d,this)).emulateTransitionEnd(350),void 0):d.call(this)}}},b.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var c=a.fn.collapse;a.fn.collapse=function(c){return this.each(function(){var d=a(this),e=d.data("bs.collapse"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c);e||d.data("bs.collapse",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.collapse.Constructor=b,a.fn.collapse.noConflict=function(){return a.fn.collapse=c,this},a(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(b){var c,d=a(this),e=d.attr("data-target")||b.preventDefault()||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,""),f=a(e),g=f.data("bs.collapse"),h=g?"toggle":d.data(),i=d.attr("data-parent"),j=i&&a(i);g&&g.transitioning||(j&&j.find('[data-toggle=collapse][data-parent="'+i+'"]').not(d).addClass("collapsed"),d[f.hasClass("in")?"addClass":"removeClass"]("collapsed")),f.collapse(h)})}(window.jQuery),+function(a){function b(){a(d).remove(),a(e).each(function(b){var d=c(a(this));d.hasClass("open")&&(d.trigger(b=a.Event("hide.bs.dropdown")),b.isDefaultPrevented()||d.removeClass("open").trigger("hidden.bs.dropdown"))})}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}var d=".dropdown-backdrop",e="[data-toggle=dropdown]",f=function(b){a(b).on("click.bs.dropdown",this.toggle)};f.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){if("ontouchstart" in document.documentElement&&!f.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b),f.trigger(d=a.Event("show.bs.dropdown")),d.isDefaultPrevented()){return}f.toggleClass("open").trigger("shown.bs.dropdown"),e.focus()}return !1}},f.prototype.keydown=function(b){if(/(38|40|27)/.test(b.keyCode)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var f=c(d),g=f.hasClass("open");if(!g||g&&27==b.keyCode){return 27==b.which&&f.find(e).focus(),d.click()}var h=a("[role=menu] li:not(.divider):visible a",f);if(h.length){var i=h.index(h.filter(":focus"));38==b.keyCode&&i>0&&i--,40==b.keyCode&&i<h.length-1&&i++,~i||(i=0),h.eq(i).focus()}}}};var g=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),d=c.data("dropdown");d||c.data("dropdown",d=new f(this)),"string"==typeof b&&d[b].call(c)})},a.fn.dropdown.Constructor=f,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=g,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",e,f.prototype.toggle).on("keydown.bs.dropdown.data-api",e+", [role=menu]",f.prototype.keydown)}(window.jQuery),+function(a){var b=function(b,c){this.options=c,this.$element=a(b),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};b.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},b.prototype.toggle=function(a){return this[this.isShown?"hide":"show"](a)},b.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(document.body),c.$element.show(),d&&c.$element[0].offsetWidth,c.$element.addClass("in").attr("aria-hidden",!1),c.enforceFocus();var e=a.Event("shown.bs.modal",{relatedTarget:b});d?c.$element.find(".modal-dialog").one(a.support.transition.end,function(){c.$element.focus().trigger(e)}).emulateTransitionEnd(300):c.$element.focus().trigger(e)}))},b.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one(a.support.transition.end,a.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},b.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.focus()},this))},b.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},b.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.removeBackdrop(),a.$element.trigger("hidden.bs.modal")})},b.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},b.prototype.backdrop=function(b){var c=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=a.support.transition&&c;if(this.$backdrop=a('<div class="modal-backdrop '+c+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",a.proxy(function(a){a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),d&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b){return}d?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()}else{!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()):b&&b()}};var c=a.fn.modal;a.fn.modal=function(c,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},b.DEFAULTS,e.data(),"object"==typeof c&&c);f||e.data("bs.modal",f=new b(this,g)),"string"==typeof c?f[c](d):g.show&&f.show(d)})},a.fn.modal.Constructor=b,a.fn.modal.noConflict=function(){return a.fn.modal=c,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=a(c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},e.data(),c.data());b.preventDefault(),e.modal(f,this).one("hide",function(){c.is(":visible")&&c.focus()})}),a(document).on("show.bs.modal",".modal",function(){a(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){a(document.body).removeClass("modal-open")})}(window.jQuery),+function(a){var b=function(a,b){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",a,b)};b.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},b.prototype.init=function(b,c,d){this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d);for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g){this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this))}else{if("manual"!=g){var h="hover"==g?"mouseenter":"focus",i="hover"==g?"mouseleave":"blur";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},b.prototype.getDefaults=function(){return b.DEFAULTS},b.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},b.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},b.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show),void 0):c.show()},b.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide),void 0):c.hide()},b.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(b),b.isDefaultPrevented()){return}var c=this.tip();this.setContent(),this.options.animation&&c.addClass("fade");var d="function"==typeof this.options.placement?this.options.placement.call(this,c[0],this.$element[0]):this.options.placement,e=/\s?auto?\s?/i,f=e.test(d);f&&(d=d.replace(e,"")||"top"),c.detach().css({top:0,left:0,display:"block"}).addClass(d),this.options.container?c.appendTo(this.options.container):c.insertAfter(this.$element);var g=this.getPosition(),h=c[0].offsetWidth,i=c[0].offsetHeight;if(f){var j=this.$element.parent(),k=d,l=document.documentElement.scrollTop||document.body.scrollTop,m="body"==this.options.container?window.innerWidth:j.outerWidth(),n="body"==this.options.container?window.innerHeight:j.outerHeight(),o="body"==this.options.container?0:j.offset().left;d="bottom"==d&&g.top+g.height+i-l>n?"top":"top"==d&&g.top-l-i<0?"bottom":"right"==d&&g.right+h>m?"left":"left"==d&&g.left-h<o?"right":d,c.removeClass(k).addClass(d)}var p=this.getCalculatedOffset(d,g,h,i);this.applyPlacement(p,d),this.$element.trigger("shown.bs."+this.type)}},b.prototype.applyPlacement=function(a,b){var c,d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),a.top=a.top+g,a.left=a.left+h,d.offset(a).addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;if("top"==b&&j!=f&&(c=!0,a.top=a.top+f-j),/bottom|top/.test(b)){var k=0;a.left<0&&(k=-2*a.left,a.left=0,d.offset(a),i=d[0].offsetWidth,j=d[0].offsetHeight),this.replaceArrow(k-e+i,i,"left")}else{this.replaceArrow(j-f,j,"top")}c&&d.offset(a)},b.prototype.replaceArrow=function(a,b,c){this.arrow().css(c,a?50*(1-a/b)+"%":"")},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},b.prototype.hide=function(){function b(){"in"!=c.hoverState&&d.detach()}var c=this,d=this.tip(),e=a.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:(d.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?d.one(a.support.transition.end,b).emulateTransitionEnd(150):b(),this.$element.trigger("hidden.bs."+this.type),this)},b.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},b.prototype.hasContent=function(){return this.getTitle()},b.prototype.getPosition=function(){var b=this.$element[0];return a.extend({},"function"==typeof b.getBoundingClientRect?b.getBoundingClientRect():{width:b.offsetWidth,height:b.offsetHeight},this.$element.offset())},b.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},b.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},b.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},b.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},b.prototype.enable=function(){this.enabled=!0},b.prototype.disable=function(){this.enabled=!1},b.prototype.toggleEnabled=function(){this.enabled=!this.enabled},b.prototype.toggle=function(b){var c=b?a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;c.tip().hasClass("in")?c.leave(c):c.enter(c)},b.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var c=a.fn.tooltip;a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof c&&c;e||d.data("bs.tooltip",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=c,this}}(window.jQuery),+function(a){var b=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip){throw new Error("Popover requires tooltip.js")}b.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),b.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),b.prototype.constructor=b,b.prototype.getDefaults=function(){return b.DEFAULTS},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content")[this.options.html?"html":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},b.prototype.hasContent=function(){return this.getTitle()||this.getContent()},b.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},b.prototype.tip=function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip};var c=a.fn.popover;a.fn.popover=function(c){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof c&&c;e||d.data("bs.popover",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.popover.Constructor=b,a.fn.popover.noConflict=function(){return a.fn.popover=c,this}}(window.jQuery),+function(a){function b(c,d){var e,f=a.proxy(this.process,this);this.$element=a(c).is("body")?a(window):a(c),this.$body=a("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",f),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||(e=a(c).attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=a([]),this.targets=a([]),this.activeTarget=null,this.refresh(),this.process()}b.DEFAULTS={offset:10},b.prototype.refresh=function(){var b=this.$element[0]==window?"offset":"position";this.offsets=a([]),this.targets=a([]);var c=this;this.$body.find(this.selector).map(function(){var d=a(this),e=d.data("target")||d.attr("href"),f=/^#\w/.test(e)&&a(e);return f&&f.length&&[[f[b]().top+(!a.isWindow(c.$scrollElement.get(0))&&c.$scrollElement.scrollTop()),e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){c.offsets.push(this[0]),c.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,d=c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(b>=d){return g!=(a=f.last()[0])&&this.activate(a)}for(a=e.length;a--;){g!=f[a]&&b>=e[a]&&(!e[a+1]||b<=e[a+1])&&this.activate(f[a])}},b.prototype.activate=function(b){this.activeTarget=b,a(this.selector).parents(".active").removeClass("active");var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate")};var c=a.fn.scrollspy;a.fn.scrollspy=function(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=c,this},a(window).on("load",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);b.scrollspy(b.data())})})}(window.jQuery),+function(a){var b=function(b){this.element=a(b)};b.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.attr("data-target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a")[0],f=a.Event("show.bs.tab",{relatedTarget:e});if(b.trigger(f),!f.isDefaultPrevented()){var g=a(d);this.activate(b.parent("li"),c),this.activate(g,g.parent(),function(){b.trigger({type:"shown.bs.tab",relatedTarget:e})})}}},b.prototype.activate=function(b,c,d){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),b.addClass("active"),g?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active"),d&&d()}var f=c.find("> .active"),g=d&&a.support.transition&&f.hasClass("fade");g?f.one(a.support.transition.end,e).emulateTransitionEnd(150):e(),f.removeClass("in")};var c=a.fn.tab;a.fn.tab=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new b(this)),"string"==typeof c&&e[c]()})},a.fn.tab.Constructor=b,a.fn.tab.noConflict=function(){return a.fn.tab=c,this},a(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(b){b.preventDefault(),a(this).tab("show")})}(window.jQuery),+function(a){var b=function(c,d){this.options=a.extend({},b.DEFAULTS,d),this.$window=a(window).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(c),this.affixed=this.unpin=null,this.checkPosition()};b.RESET="affix affix-top affix-bottom",b.DEFAULTS={offset:0},b.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},b.prototype.checkPosition=function(){if(this.$element.is(":visible")){var c=a(document).height(),d=this.$window.scrollTop(),e=this.$element.offset(),f=this.options.offset,g=f.top,h=f.bottom;"object"!=typeof f&&(h=g=f),"function"==typeof g&&(g=f.top()),"function"==typeof h&&(h=f.bottom());var i=null!=this.unpin&&d+this.unpin<=e.top?!1:null!=h&&e.top+this.$element.height()>=c-h?"bottom":null!=g&&g>=d?"top":!1;this.affixed!==i&&(this.unpin&&this.$element.css("top",""),this.affixed=i,this.unpin="bottom"==i?e.top-d:null,this.$element.removeClass(b.RESET).addClass("affix"+(i?"-"+i:"")),"bottom"==i&&this.$element.offset({top:document.body.offsetHeight-h-this.$element.height()}))}};var c=a.fn.affix;a.fn.affix=function(c){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof c&&c;e||d.data("bs.affix",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.affix.Constructor=b,a.fn.affix.noConflict=function(){return a.fn.affix=c,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var b=a(this),c=b.data();c.offset=c.offset||{},c.offsetBottom&&(c.offset.bottom=c.offsetBottom),c.offsetTop&&(c.offset.top=c.offsetTop),b.affix(c)})})}(window.jQuery);(function(){var e=[].slice;(function(t,n){var r;return r=function(){function e(e){var r=this;this.$el=t(e),t(n).resize(function(){return r.refresh()})}return e.prototype.start=function(){var e,t,n,r;if(this._overlay_visible()){return !1}this._add_overlay_layer(),r=this.$el.find("*[data-intro]");for(t=0,n=r.length;t<n;t++){e=r[t],this._show_element(e)}return this.$el.trigger("chardinJs:start")},e.prototype.toggle=function(){return this._overlay_visible()?this.stop():this.start()},e.prototype.refresh=function(){var e,t,n,r,i;if(this._overlay_visible()){r=this.$el.find("*[data-intro]"),i=[];for(t=0,n=r.length;t<n;t++){e=r[t],i.push(this._position_helper_layer(e))}return i}return this},e.prototype.stop=function(){return this.$el.find(".chardinjs-overlay").fadeOut(function(){return t(this).remove()}),this.$el.find(".chardinjs-helper-layer").remove(),this.$el.find(".chardinjs-show-element").removeClass("chardinjs-show-element"),this.$el.find(".chardinjs-relative-position").removeClass("chardinjs-relative-position"),n.removeEventListener?n.removeEventListener("keydown",this._onKeyDown,!0):document.detachEvent&&document.detachEvent("onkeydown",this._onKeyDown),this.$el.trigger("chardinJs:stop")},e.prototype._overlay_visible=function(){return this.$el.find(".chardinjs-overlay").length!==0},e.prototype._add_overlay_layer=function(){var e,t,n,r=this;return this._overlay_visible()?!1:(t=document.createElement("div"),n="",t.className="chardinjs-overlay",this.$el.prop("tagName")==="BODY"?(n+="top: 0;bottom: 0; left: 0;right: 0;position: fixed;",t.setAttribute("style",n)):(e=this._get_offset(this.$el.get()[0]),e&&(n+="width: "+e.width+"px; height:"+e.height+"px; top:"+e.top+"px;left: "+e.left+"px;",t.setAttribute("style",n))),this.$el.get()[0].appendChild(t),t.onclick=function(){return r.stop()},setTimeout(function(){return n+="opacity: .8;",t.setAttribute("style",n)},10))},e.prototype._get_position=function(e){return e.getAttribute("data-position")||"bottom"},e.prototype._place_tooltip=function(e){var n,r,i,s,o,u,a;u=t(e).data("tooltip_layer"),a=this._get_offset(u),u.style.top=null,u.style.right=null,u.style.bottom=null,u.style.left=null;switch(this._get_position(e)){case"top":case"bottom":i=this._get_offset(e),o=i.width,r=t(u).width(),u.style.left=""+(o/2-a.width/2)+"px";break;case"left":case"right":i=this._get_offset(e),s=i.height,n=t(u).height(),u.style.top=""+(s/2-a.height/2)+"px"}switch(this._get_position(e)){case"left":return u.style.left="-"+(a.width-34)+"px";case"right":return u.style.right="-"+(a.width-34)+"px";case"bottom":return u.style.bottom="-"+a.height+"px";case"top":return u.style.top="-"+a.height+"px"}},e.prototype._position_helper_layer=function(e){var n,r;return r=t(e).data("helper_layer"),n=this._get_offset(e),r.setAttribute("style","width: "+n.width+"px; height:"+n.height+"px; top:"+n.top+"px; left: "+n.left+"px;")},e.prototype._show_element=function(e){var n,r,i,s;r=this._get_offset(e),i=document.createElement("div"),s=document.createElement("div"),t(e).data("helper_layer",i).data("tooltip_layer",s),e.id&&i.setAttribute("data-id",e.id),i.className="chardinjs-helper-layer chardinjs-"+this._get_position(e),this._position_helper_layer(e),this.$el.get()[0].appendChild(i),s.className="chardinjs-tooltip chardinjs-"+this._get_position(e),s.innerHTML="<div class='chardinjs-tooltiptext'>"+e.getAttribute("data-intro")+"</div>",i.appendChild(s),this._place_tooltip(e),e.className+=" chardinjs-show-element",n="",e.currentStyle?n=e.currentStyle.position:document.defaultView&&document.defaultView.getComputedStyle&&(n=document.defaultView.getComputedStyle(e,null).getPropertyValue("position")),n=n.toLowerCase();if(n!=="absolute"&&n!=="relative"){return e.className+=" chardinjs-relative-position"}},e.prototype._get_offset=function(e){var t,n,r;t={width:e.offsetWidth,height:e.offsetHeight},n=0,r=0;while(e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop)){n+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent}return t.top=r,t.left=n,t},e}(),t.fn.extend({chardinJs:function(){var n,i,s,o;return o=arguments[0],i=2<=arguments.length?e.call(arguments,1):[],n=t(this[0]),s=n.data("chardinJs"),s||n.data("chardinJs",s=new r(this,o)),typeof o=="string"&&s[o].apply(s,i),s}})})(window.jQuery,window)}).call(this);(function(exports){crossfilter.version="1.3.5";function crossfilter_identity(d){return d}crossfilter.permute=permute;function permute(array,index){for(var i=0,n=index.length,copy=new Array(n);i<n;++i){copy[i]=array[index[i]]}return copy}var bisect=crossfilter.bisect=bisect_by(crossfilter_identity);bisect.by=bisect_by;function bisect_by(f){function bisectLeft(a,x,lo,hi){while(lo<hi){var mid=lo+hi>>>1;if(f(a[mid])<x){lo=mid+1}else{hi=mid}}return lo}function bisectRight(a,x,lo,hi){while(lo<hi){var mid=lo+hi>>>1;if(x<f(a[mid])){hi=mid}else{lo=mid+1}}return lo}bisectRight.right=bisectRight;bisectRight.left=bisectLeft;return bisectRight}var heap=crossfilter.heap=heap_by(crossfilter_identity);heap.by=heap_by;function heap_by(f){function heap(a,lo,hi){var n=hi-lo,i=(n>>>1)+1;while(--i>0){sift(a,i,n,lo)}return a}function sort(a,lo,hi){var n=hi-lo,t;while(--n>0){t=a[lo],a[lo]=a[lo+n],a[lo+n]=t,sift(a,1,n,lo)}return a}function sift(a,i,n,lo){var d=a[--lo+i],x=f(d),child;while((child=i<<1)<=n){if(child<n&&f(a[lo+child])>f(a[lo+child+1])){child++}if(x<=f(a[lo+child])){break}a[lo+i]=a[lo+child];i=child}a[lo+i]=d}heap.sort=sort;return heap}var heapselect=crossfilter.heapselect=heapselect_by(crossfilter_identity);heapselect.by=heapselect_by;function heapselect_by(f){var heap=heap_by(f);function heapselect(a,lo,hi,k){var queue=new Array(k=Math.min(hi-lo,k)),min,i,x,d;for(i=0;i<k;++i){queue[i]=a[lo++]}heap(queue,0,k);if(lo<hi){min=f(queue[0]);do{if(x=f(d=a[lo])>min){queue[0]=d;min=f(heap(queue,0,k)[0])}}while(++lo<hi)}return queue}return heapselect}var insertionsort=crossfilter.insertionsort=insertionsort_by(crossfilter_identity);insertionsort.by=insertionsort_by;function insertionsort_by(f){function insertionsort(a,lo,hi){for(var i=lo+1;i<hi;++i){for(var j=i,t=a[i],x=f(t);j>lo&&f(a[j-1])>x;--j){a[j]=a[j-1]}a[j]=t}return a}return insertionsort}var quicksort=crossfilter.quicksort=quicksort_by(crossfilter_identity);quicksort.by=quicksort_by;function quicksort_by(f){var insertionsort=insertionsort_by(f);function sort(a,lo,hi){return(hi-lo<quicksort_sizeThreshold?insertionsort:quicksort)(a,lo,hi)}function quicksort(a,lo,hi){var sixth=(hi-lo)/6|0,i1=lo+sixth,i5=hi-1-sixth,i3=lo+hi-1>>1,i2=i3-sixth,i4=i3+sixth;var e1=a[i1],x1=f(e1),e2=a[i2],x2=f(e2),e3=a[i3],x3=f(e3),e4=a[i4],x4=f(e4),e5=a[i5],x5=f(e5);var t;if(x1>x2){t=e1,e1=e2,e2=t,t=x1,x1=x2,x2=t}if(x4>x5){t=e4,e4=e5,e5=t,t=x4,x4=x5,x5=t}if(x1>x3){t=e1,e1=e3,e3=t,t=x1,x1=x3,x3=t}if(x2>x3){t=e2,e2=e3,e3=t,t=x2,x2=x3,x3=t}if(x1>x4){t=e1,e1=e4,e4=t,t=x1,x1=x4,x4=t}if(x3>x4){t=e3,e3=e4,e4=t,t=x3,x3=x4,x4=t}if(x2>x5){t=e2,e2=e5,e5=t,t=x2,x2=x5,x5=t}if(x2>x3){t=e2,e2=e3,e3=t,t=x2,x2=x3,x3=t}if(x4>x5){t=e4,e4=e5,e5=t,t=x4,x4=x5,x5=t}var pivot1=e2,pivotValue1=x2,pivot2=e4,pivotValue2=x4;a[i1]=e1;a[i2]=a[lo];a[i3]=e3;a[i4]=a[hi-1];a[i5]=e5;var less=lo+1,great=hi-2;var pivotsEqual=pivotValue1<=pivotValue2&&pivotValue1>=pivotValue2;if(pivotsEqual){for(var k=less;k<=great;++k){var ek=a[k],xk=f(ek);if(xk<pivotValue1){if(k!==less){a[k]=a[less];a[less]=ek}++less}else{if(xk>pivotValue1){while(true){var greatValue=f(a[great]);if(greatValue>pivotValue1){great--;continue}else{if(greatValue<pivotValue1){a[k]=a[less];a[less++]=a[great];a[great--]=ek;break}else{a[k]=a[great];a[great--]=ek;break}}}}}}}else{for(var k=less;k<=great;k++){var ek=a[k],xk=f(ek);if(xk<pivotValue1){if(k!==less){a[k]=a[less];a[less]=ek}++less}else{if(xk>pivotValue2){while(true){var greatValue=f(a[great]);if(greatValue>pivotValue2){great--;if(great<k){break}continue}else{if(greatValue<pivotValue1){a[k]=a[less];a[less++]=a[great];a[great--]=ek}else{a[k]=a[great];a[great--]=ek}break}}}}}}a[lo]=a[less-1];a[less-1]=pivot1;a[hi-1]=a[great+1];a[great+1]=pivot2;sort(a,lo,less-1);sort(a,great+2,hi);if(pivotsEqual){return a}if(less<i1&&great>i5){var lessValue,greatValue;while((lessValue=f(a[less]))<=pivotValue1&&lessValue>=pivotValue1){++less}while((greatValue=f(a[great]))<=pivotValue2&&greatValue>=pivotValue2){--great}for(var k=less;k<=great;k++){var ek=a[k],xk=f(ek);if(xk<=pivotValue1&&xk>=pivotValue1){if(k!==less){a[k]=a[less];a[less]=ek}less++}else{if(xk<=pivotValue2&&xk>=pivotValue2){while(true){var greatValue=f(a[great]);if(greatValue<=pivotValue2&&greatValue>=pivotValue2){great--;if(great<k){break}continue}else{if(greatValue<pivotValue1){a[k]=a[less];a[less++]=a[great];a[great--]=ek}else{a[k]=a[great];a[great--]=ek}break}}}}}}return sort(a,less,great+1)}return sort}var quicksort_sizeThreshold=32;var crossfilter_array8=crossfilter_arrayUntyped,crossfilter_array16=crossfilter_arrayUntyped,crossfilter_array32=crossfilter_arrayUntyped,crossfilter_arrayLengthen=crossfilter_identity,crossfilter_arrayWiden=crossfilter_identity;if(typeof Uint8Array!=="undefined"){crossfilter_array8=function(n){return new Uint8Array(n)};crossfilter_array16=function(n){return new Uint16Array(n)};crossfilter_array32=function(n){return new Uint32Array(n)};crossfilter_arrayLengthen=function(array,length){if(array.length>=length){return array}var copy=new array.constructor(length);copy.set(array);return copy};crossfilter_arrayWiden=function(array,width){var copy;switch(width){case 16:copy=crossfilter_array16(array.length);break;case 32:copy=crossfilter_array32(array.length);break;default:throw new Error("invalid array width!")}copy.set(array);return copy}}function crossfilter_arrayUntyped(n){return new Array(n)}function crossfilter_filterExact(bisect,value){return function(values){var n=values.length;return[bisect.left(values,value,0,n),bisect.right(values,value,0,n)]}}function crossfilter_filterRange(bisect,range){var min=range[0],max=range[1];return function(values){var n=values.length;return[bisect.left(values,min,0,n),bisect.left(values,max,0,n)]}}function crossfilter_filterAll(values){return[0,values.length]}function crossfilter_null(){return null}function crossfilter_zero(){return 0}function crossfilter_reduceIncrement(p){return p+1}function crossfilter_reduceDecrement(p){return p-1}function crossfilter_reduceAdd(f){return function(p,v){return p+ +f(v)}}function crossfilter_reduceSubtract(f){return function(p,v){return p-f(v)}}exports.crossfilter=crossfilter;function crossfilter(){var crossfilter={add:add,remove:removeData,dimension:dimension,groupAll:groupAll,size:size};var data=[],n=0,m=0,M=8,filters=crossfilter_array8(0),filterListeners=[],dataListeners=[],removeDataListeners=[];function add(newData){var n0=n,n1=newData.length;if(n1){data=data.concat(newData);filters=crossfilter_arrayLengthen(filters,n+=n1);dataListeners.forEach(function(l){l(newData,n0,n1)})}return crossfilter}function removeData(){var newIndex=crossfilter_index(n,n),removed=[];for(var i=0,j=0;i<n;++i){if(filters[i]){newIndex[i]=j++}else{removed.push(i)}}filterListeners.forEach(function(l){l(0,[],removed)});removeDataListeners.forEach(function(l){l(newIndex)});for(var i=0,j=0,k;i<n;++i){if(k=filters[i]){if(i!==j){filters[j]=k,data[j]=data[i]}++j}}data.length=j;while(n>j){filters[--n]=0}}function dimension(value){var dimension={filter:filter,filterExact:filterExact,filterRange:filterRange,filterFunction:filterFunction,filterAll:filterAll,top:top,bottom:bottom,group:group,groupAll:groupAll,dispose:dispose,remove:dispose};var one=~m&-~m,zero=~one,values,index,newValues,newIndex,sort=quicksort_by(function(i){return newValues[i]}),refilter=crossfilter_filterAll,refilterFunction,indexListeners=[],dimensionGroups=[],lo0=0,hi0=0;dataListeners.unshift(preAdd);dataListeners.push(postAdd);removeDataListeners.push(removeData);m|=one;if(M>=32?!one:m&(1<<M)-1){filters=crossfilter_arrayWiden(filters,M<<=1)}preAdd(data,0,n);postAdd(data,0,n);function preAdd(newData,n0,n1){newValues=newData.map(value);newIndex=sort(crossfilter_range(n1),0,n1);newValues=permute(newValues,newIndex);var bounds=refilter(newValues),lo1=bounds[0],hi1=bounds[1],i;if(refilterFunction){for(i=0;i<n1;++i){if(!refilterFunction(newValues[i],i)){filters[newIndex[i]+n0]|=one}}}else{for(i=0;i<lo1;++i){filters[newIndex[i]+n0]|=one}for(i=hi1;i<n1;++i){filters[newIndex[i]+n0]|=one}}if(!n0){values=newValues;index=newIndex;lo0=lo1;hi0=hi1;return}var oldValues=values,oldIndex=index,i0=0,i1=0;values=new Array(n);index=crossfilter_index(n,n);for(i=0;i0<n0&&i1<n1;++i){if(oldValues[i0]<newValues[i1]){values[i]=oldValues[i0];index[i]=oldIndex[i0++]}else{values[i]=newValues[i1];index[i]=newIndex[i1++]+n0}}for(;i0<n0;++i0,++i){values[i]=oldValues[i0];index[i]=oldIndex[i0]}for(;i1<n1;++i1,++i){values[i]=newValues[i1];index[i]=newIndex[i1]+n0}bounds=refilter(values),lo0=bounds[0],hi0=bounds[1]}function postAdd(newData,n0,n1){indexListeners.forEach(function(l){l(newValues,newIndex,n0,n1)});newValues=newIndex=null}function removeData(reIndex){for(var i=0,j=0,k;i<n;++i){if(filters[k=index[i]]){if(i!==j){values[j]=values[i]}index[j]=reIndex[k];++j}}values.length=j;while(j<n){index[j++]=0}var bounds=refilter(values);lo0=bounds[0],hi0=bounds[1]}function filterIndexBounds(bounds){var lo1=bounds[0],hi1=bounds[1];if(refilterFunction){refilterFunction=null;filterIndexFunction(function(d,i){return lo1<=i&&i<hi1});lo0=lo1;hi0=hi1;return dimension}var i,j,k,added=[],removed=[];if(lo1<lo0){for(i=lo1,j=Math.min(lo0,hi1);i<j;++i){filters[k=index[i]]^=one;added.push(k)}}else{if(lo1>lo0){for(i=lo0,j=Math.min(lo1,hi0);i<j;++i){filters[k=index[i]]^=one;removed.push(k)}}}if(hi1>hi0){for(i=Math.max(lo1,hi0),j=hi1;i<j;++i){filters[k=index[i]]^=one;added.push(k)}}else{if(hi1<hi0){for(i=Math.max(lo0,hi1),j=hi0;i<j;++i){filters[k=index[i]]^=one;removed.push(k)}}}lo0=lo1;hi0=hi1;filterListeners.forEach(function(l){l(one,added,removed)});return dimension}function filter(range){return range==null?filterAll():Array.isArray(range)?filterRange(range):typeof range==="function"?filterFunction(range):filterExact(range)}function filterExact(value){return filterIndexBounds((refilter=crossfilter_filterExact(bisect,value))(values))}function filterRange(range){return filterIndexBounds((refilter=crossfilter_filterRange(bisect,range))(values))}function filterAll(){return filterIndexBounds((refilter=crossfilter_filterAll)(values))}function filterFunction(f){refilter=crossfilter_filterAll;filterIndexFunction(refilterFunction=f);lo0=0;hi0=n;return dimension}function filterIndexFunction(f){var i,k,x,added=[],removed=[];for(i=0;i<n;++i){if(!(filters[k=index[i]]&one)^(x=f(values[i],i))){if(x){filters[k]&=zero,added.push(k)}else{filters[k]|=one,removed.push(k)}}}filterListeners.forEach(function(l){l(one,added,removed)})}function top(k){var array=[],i=hi0,j;while(--i>=lo0&&k>0){if(!filters[j=index[i]]){array.push(data[j]);--k}}return array}function bottom(k){var array=[],i=lo0,j;while(i<hi0&&k>0){if(!filters[j=index[i]]){array.push(data[j]);--k}i++}return array}function group(key){var group={top:top,all:all,reduce:reduce,reduceCount:reduceCount,reduceSum:reduceSum,order:order,orderNatural:orderNatural,size:size,dispose:dispose,remove:dispose};dimensionGroups.push(group);var groups,groupIndex,groupWidth=8,groupCapacity=crossfilter_capacity(groupWidth),k=0,select,heap,reduceAdd,reduceRemove,reduceInitial,update=crossfilter_null,reset=crossfilter_null,resetNeeded=true;if(arguments.length<1){key=crossfilter_identity}filterListeners.push(update);indexListeners.push(add);removeDataListeners.push(removeData);add(values,index,0,n);function add(newValues,newIndex,n0,n1){var oldGroups=groups,reIndex=crossfilter_index(k,groupCapacity),add=reduceAdd,initial=reduceInitial,k0=k,i0=0,i1=0,j,g0,x0,x1,g,x;if(resetNeeded){add=initial=crossfilter_null}groups=new Array(k),k=0;groupIndex=k0>1?crossfilter_arrayLengthen(groupIndex,n):crossfilter_index(n,groupCapacity);if(k0){x0=(g0=oldGroups[0]).key}while(i1<n1&&!((x1=key(newValues[i1]))>=x1)){++i1}while(i1<n1){if(g0&&x0<=x1){g=g0,x=x0;reIndex[i0]=k;if(g0=oldGroups[++i0]){x0=g0.key}}else{g={key:x1,value:initial()},x=x1}groups[k]=g;while(!(x1>x)){groupIndex[j=newIndex[i1]+n0]=k;if(!(filters[j]&zero)){g.value=add(g.value,data[j])}if(++i1>=n1){break}x1=key(newValues[i1])}groupIncrement()}while(i0<k0){groups[reIndex[i0]=k]=oldGroups[i0++];groupIncrement()}if(k>i0){for(i0=0;i0<n0;++i0){groupIndex[i0]=reIndex[groupIndex[i0]]}}j=filterListeners.indexOf(update);if(k>1){update=updateMany;reset=resetMany}else{if(k===1){update=updateOne;reset=resetOne}else{update=crossfilter_null;reset=crossfilter_null}groupIndex=null}filterListeners[j]=update;function groupIncrement(){if(++k===groupCapacity){reIndex=crossfilter_arrayWiden(reIndex,groupWidth<<=1);groupIndex=crossfilter_arrayWiden(groupIndex,groupWidth);groupCapacity=crossfilter_capacity(groupWidth)}}}function removeData(){if(k>1){var oldK=k,oldGroups=groups,seenGroups=crossfilter_index(oldK,oldK);for(var i=0,j=0;i<n;++i){if(filters[i]){seenGroups[groupIndex[j]=groupIndex[i]]=1;++j}}groups=[],k=0;for(i=0;i<oldK;++i){if(seenGroups[i]){seenGroups[i]=k++;groups.push(oldGroups[i])}}if(k>1){for(var i=0;i<j;++i){groupIndex[i]=seenGroups[groupIndex[i]]}}else{groupIndex=null}filterListeners[filterListeners.indexOf(update)]=k>1?(reset=resetMany,update=updateMany):k===1?(reset=resetOne,update=updateOne):reset=update=crossfilter_null}else{if(k===1){for(var i=0;i<n;++i){if(filters[i]){return}}groups=[],k=0;filterListeners[filterListeners.indexOf(update)]=update=reset=crossfilter_null}}}function updateMany(filterOne,added,removed){if(filterOne===one||resetNeeded){return}var i,k,n,g;for(i=0,n=added.length;i<n;++i){if(!(filters[k=added[i]]&zero)){g=groups[groupIndex[k]];g.value=reduceAdd(g.value,data[k])}}for(i=0,n=removed.length;i<n;++i){if((filters[k=removed[i]]&zero)===filterOne){g=groups[groupIndex[k]];g.value=reduceRemove(g.value,data[k])}}}function updateOne(filterOne,added,removed){if(filterOne===one||resetNeeded){return}var i,k,n,g=groups[0];for(i=0,n=added.length;i<n;++i){if(!(filters[k=added[i]]&zero)){g.value=reduceAdd(g.value,data[k])}}for(i=0,n=removed.length;i<n;++i){if((filters[k=removed[i]]&zero)===filterOne){g.value=reduceRemove(g.value,data[k])}}}function resetMany(){var i,g;for(i=0;i<k;++i){groups[i].value=reduceInitial()}for(i=0;i<n;++i){if(!(filters[i]&zero)){g=groups[groupIndex[i]];g.value=reduceAdd(g.value,data[i])}}}function resetOne(){var i,g=groups[0];g.value=reduceInitial();for(i=0;i<n;++i){if(!(filters[i]&zero)){g.value=reduceAdd(g.value,data[i])}}}function all(){if(resetNeeded){reset(),resetNeeded=false}return groups}function top(k){var top=select(all(),0,groups.length,k);return heap.sort(top,0,top.length)}function reduce(add,remove,initial){reduceAdd=add;reduceRemove=remove;reduceInitial=initial;resetNeeded=true;return group}function reduceCount(){return reduce(crossfilter_reduceIncrement,crossfilter_reduceDecrement,crossfilter_zero)}function reduceSum(value){return reduce(crossfilter_reduceAdd(value),crossfilter_reduceSubtract(value),crossfilter_zero)}function order(value){select=heapselect_by(valueOf);heap=heap_by(valueOf);function valueOf(d){return value(d.value)}return group}function orderNatural(){return order(crossfilter_identity)}function size(){return k}function dispose(){var i=filterListeners.indexOf(update);if(i>=0){filterListeners.splice(i,1)}i=indexListeners.indexOf(add);if(i>=0){indexListeners.splice(i,1)}i=removeDataListeners.indexOf(removeData);if(i>=0){removeDataListeners.splice(i,1)}return group}return reduceCount().orderNatural()}function groupAll(){var g=group(crossfilter_null),all=g.all;delete g.all;delete g.top;delete g.order;delete g.orderNatural;delete g.size;g.value=function(){return all()[0].value};return g}function dispose(){dimensionGroups.forEach(function(group){group.dispose()});var i=dataListeners.indexOf(preAdd);if(i>=0){dataListeners.splice(i,1)}i=dataListeners.indexOf(postAdd);if(i>=0){dataListeners.splice(i,1)}i=removeDataListeners.indexOf(removeData);if(i>=0){removeDataListeners.splice(i,1)}for(i=0;i<n;++i){filters[i]&=zero}m&=zero;return dimension}return dimension}function groupAll(){var group={reduce:reduce,reduceCount:reduceCount,reduceSum:reduceSum,value:value,dispose:dispose,remove:dispose};var reduceValue,reduceAdd,reduceRemove,reduceInitial,resetNeeded=true;filterListeners.push(update);dataListeners.push(add);add(data,0,n);function add(newData,n0){var i;if(resetNeeded){return}for(i=n0;i<n;++i){if(!filters[i]){reduceValue=reduceAdd(reduceValue,data[i])}}}function update(filterOne,added,removed){var i,k,n;if(resetNeeded){return}for(i=0,n=added.length;i<n;++i){if(!filters[k=added[i]]){reduceValue=reduceAdd(reduceValue,data[k])}}for(i=0,n=removed.length;i<n;++i){if(filters[k=removed[i]]===filterOne){reduceValue=reduceRemove(reduceValue,data[k])}}}function reset(){var i;reduceValue=reduceInitial();for(i=0;i<n;++i){if(!filters[i]){reduceValue=reduceAdd(reduceValue,data[i])}}}function reduce(add,remove,initial){reduceAdd=add;reduceRemove=remove;reduceInitial=initial;resetNeeded=true;return group}function reduceCount(){return reduce(crossfilter_reduceIncrement,crossfilter_reduceDecrement,crossfilter_zero)}function reduceSum(value){return reduce(crossfilter_reduceAdd(value),crossfilter_reduceSubtract(value),crossfilter_zero)}function value(){if(resetNeeded){reset(),resetNeeded=false}return reduceValue}function dispose(){var i=filterListeners.indexOf(update);if(i>=0){filterListeners.splice(i)}i=dataListeners.indexOf(add);if(i>=0){dataListeners.splice(i)}return group}return reduceCount()}function size(){return n}return arguments.length?add(arguments[0]):crossfilter}function crossfilter_index(n,m){return(m<257?crossfilter_array8:m<65537?crossfilter_array16:crossfilter_array32)(n)}function crossfilter_range(n){var range=crossfilter_index(n,n);for(var i=-1;++i<n;){range[i]=i}return range}function crossfilter_capacity(w){return w===8?256:w===16?65536:4294967296}})(this);d3=function(){function n(n){return null!=n&&!isNaN(n)}function t(n){return n.length}function e(n){for(var t=1;n*t%1;){t*=10}return t}function r(n,t){try{for(var e in t){Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}}catch(r){n.prototype=t}}function u(){}function i(){}function o(n,t,e){return function(){var r=e.apply(t,arguments);return r===t?n:r}}function a(n,t){if(t in n){return t}t=t.charAt(0).toUpperCase()+t.substring(1);for(var e=0,r=Do.length;r>e;++e){var u=Do[e]+t;if(u in n){return u}}}function c(){}function l(){}function s(n){function t(){for(var t,r=e,u=-1,i=r.length;++u<i;){(t=r[u].on)&&t.apply(this,arguments)}return n}var e=[],r=new u;return t.on=function(t,u){var i,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,e=e.slice(0,i=e.indexOf(o)).concat(e.slice(i+1)),r.remove(t)),u&&e.push(r.set(t,{on:u})),n)},t}function f(){mo.event.preventDefault()}function h(){for(var n,t=mo.event;n=t.sourceEvent;){t=n}return t}function g(n){for(var t=new l,e=0,r=arguments.length;++e<r;){t[arguments[e]]=s(t)}return t.of=function(e,r){return function(u){try{var i=u.sourceEvent=mo.event;u.target=n,mo.event=u,t[u.type].apply(e,r)}finally{mo.event=i}}},t}function p(n){return Lo(n,Ro),n}function d(n){return"function"==typeof n?n:function(){return Ho(n,this)}}function v(n){return"function"==typeof n?n:function(){return Fo(n,this)}}function m(n,t){function e(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}function u(){this.setAttribute(n,t)}function i(){this.setAttributeNS(n.space,n.local,t)}function o(){var e=t.apply(this,arguments);null==e?this.removeAttribute(n):this.setAttribute(n,e)}function a(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}return n=mo.ns.qualify(n),null==t?n.local?r:e:"function"==typeof t?n.local?a:o:n.local?i:u}function y(n){return n.trim().replace(/\s+/g," ")}function M(n){return new RegExp("(?:^|\\s+)"+mo.requote(n)+"(?:\\s+|$)","g")}function x(n,t){function e(){for(var e=-1;++e<u;){n[e](this,t)}}function r(){for(var e=-1,r=t.apply(this,arguments);++e<u;){n[e](this,r)}}n=n.trim().split(/\s+/).map(b);var u=n.length;return"function"==typeof t?r:e}function b(n){var t=M(n);return function(e,r){if(u=e.classList){return r?u.add(n):u.remove(n)}var u=e.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||e.setAttribute("class",y(u+" "+n))):e.setAttribute("class",y(u.replace(t," ")))}}function _(n,t,e){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,e)}function i(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,e)}return null==t?r:"function"==typeof t?i:u}function w(n,t){function e(){delete this[n]}function r(){this[n]=t}function u(){var e=t.apply(this,arguments);null==e?delete this[n]:this[n]=e}return null==t?e:"function"==typeof t?u:r}function S(n){return"function"==typeof n?n:(n=mo.ns.qualify(n)).local?function(){return xo.createElementNS(n.space,n.local)}:function(){return xo.createElementNS(this.namespaceURI,n)}}function E(n){return{__data__:n}}function k(n){return function(){return Oo(this,n)}}function A(n){return arguments.length||(n=mo.ascending),function(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}}function N(n,t){for(var e=0,r=n.length;r>e;e++){for(var u,i=n[e],o=0,a=i.length;a>o;o++){(u=i[o])&&t(u,o,e)}}return n}function T(n){return Lo(n,Io),n}function q(n){var t,e;return function(r,u,i){var o,a=n[i].update,c=a.length;for(i!=e&&(e=i,t=0),u>=t&&(t=u+1);!(o=a[t])&&++t<c;){}return o}}function z(){var n=this.__transition__;n&&++n.active}function C(n,t,e){function r(){var t=this[o];t&&(this.removeEventListener(n,t,t.$),delete this[o])}function u(){var u=l(t,Mo(arguments));r.call(this),this.addEventListener(n,this[o]=u,u.$=e),u._=t}function i(){var t,e=new RegExp("^__on([^.]+)"+mo.requote(n)+"$");for(var r in this){if(t=r.match(e)){var u=this[r];this.removeEventListener(t[1],u,u.$),delete this[r]}}}var o="__on"+n,a=n.indexOf("."),l=D;a>0&&(n=n.substring(0,a));var s=Zo.get(n);return s&&(n=s,l=j),a?t?u:r:t?c:i}function D(n,t){return function(e){var r=mo.event;mo.event=e,t[0]=this.__data__;try{n.apply(this,t)}finally{mo.event=r}}}function j(n,t){var e=D(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||e.call(t,n)}}function L(){var n=".dragsuppress-"+ ++Xo,t="touchmove"+n,e="selectstart"+n,r="dragstart"+n,u="click"+n,i=mo.select(_o).on(t,f).on(e,f).on(r,f),o=bo.style,a=o[Vo];return o[Vo]="none",function(t){function e(){i.on(u,null)}i.on(n,null),o[Vo]=a,t&&(i.on(u,function(){f(),e()},!0),setTimeout(e,0))}}function H(n,t){t.changedTouches&&(t=t.changedTouches[0]);var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();if(0>$o&&(_o.scrollX||_o.scrollY)){e=mo.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var u=e[0][0].getScreenCTM();$o=!(u.f||u.e),e.remove()}return $o?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]}var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}function F(n){return n>0?1:0>n?-1:0}function P(n){return n>1?0:-1>n?Bo:Math.acos(n)}function O(n){return n>1?Bo/2:-1>n?-Bo/2:Math.asin(n)}function R(n){return(Math.exp(n)-Math.exp(-n))/2}function Y(n){return(Math.exp(n)+Math.exp(-n))/2}function I(n){return R(n)/Y(n)}function U(n){return(n=Math.sin(n/2))*n}function Z(){}function V(n,t,e){return new X(n,t,e)}function X(n,t,e){this.h=n,this.s=t,this.l=e}function $(n,t,e){function r(n){return n>360?n-=360:0>n&&(n+=360),60>n?i+(o-i)*n/60:180>n?o:240>n?i+(o-i)*(240-n)/60:i}function u(n){return Math.round(255*r(n))}var i,o;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,e=0>e?0:e>1?1:e,o=0.5>=e?e*(1+t):e+t-e*t,i=2*e-o,ot(u(n+120),u(n),u(n-120))}function B(n,t,e){return new W(n,t,e)}function W(n,t,e){this.h=n,this.c=t,this.l=e}function J(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),G(e,Math.cos(n*=Go)*t,Math.sin(n)*t)}function G(n,t,e){return new K(n,t,e)}function K(n,t,e){this.l=n,this.a=t,this.b=e}function Q(n,t,e){var r=(n+16)/116,u=r+t/500,i=r-e/200;return u=tt(u)*ca,r=tt(r)*la,i=tt(i)*sa,ot(rt(3.2404542*u-1.5371385*r-0.4985314*i),rt(-0.969266*u+1.8760108*r+0.041556*i),rt(0.0556434*u-0.2040259*r+1.0572252*i))}function nt(n,t,e){return n>0?B(Math.atan2(e,t)*Ko,Math.sqrt(t*t+e*e),n):B(0/0,0/0,n)}function tt(n){return n>0.206893034?n*n*n:(n-4/29)/7.787037}function et(n){return n>0.008856?Math.pow(n,1/3):7.787037*n+4/29}function rt(n){return Math.round(255*(0.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-0.055))}function ut(n){return ot(n>>16,255&n>>8,255&n)}function it(n){return ut(n)+""}function ot(n,t,e){return new at(n,t,e)}function at(n,t,e){this.r=n,this.g=t,this.b=e}function ct(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function lt(n,t,e){var r,u,i,o=0,a=0,c=0;if(r=/([a-z]+)\((.*)\)/i.exec(n)){switch(u=r[2].split(","),r[1]){case"hsl":return e(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(gt(u[0]),gt(u[1]),gt(u[2]))}}return(i=ga.get(n))?t(i.r,i.g,i.b):(null!=n&&"#"===n.charAt(0)&&(4===n.length?(o=n.charAt(1),o+=o,a=n.charAt(2),a+=a,c=n.charAt(3),c+=c):7===n.length&&(o=n.substring(1,3),a=n.substring(3,5),c=n.substring(5,7)),o=parseInt(o,16),a=parseInt(a,16),c=parseInt(c,16)),t(o,a,c))}function st(n,t,e){var r,u,i=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-i,c=(o+i)/2;return a?(u=0.5>c?a/(o+i):a/(2-o-i),r=n==o?(t-e)/a+(e>t?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=0/0,u=c>0&&1>c?0:r),V(r,u,c)}function ft(n,t,e){n=ht(n),t=ht(t),e=ht(e);var r=et((0.4124564*n+0.3575761*t+0.1804375*e)/ca),u=et((0.2126729*n+0.7151522*t+0.072175*e)/la),i=et((0.0193339*n+0.119192*t+0.9503041*e)/sa);return G(116*u-16,500*(r-u),200*(u-i))}function ht(n){return(n/=255)<=0.04045?n/12.92:Math.pow((n+0.055)/1.055,2.4)}function gt(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function pt(n){return"function"==typeof n?n:function(){return n}}function dt(n){return n}function vt(n){return function(t,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),mt(t,e,n,r)}}function mt(n,t,e,r){function u(){var n,t=c.status;if(!t&&c.responseText||t>=200&&300>t||304===t){try{n=e.call(i,c)}catch(r){return o.error.call(i,r),void 0}o.load.call(i,n)}else{o.error.call(i,c)}}var i={},o=mo.dispatch("beforesend","progress","load","error"),a={},c=new XMLHttpRequest,l=null;return !_o.XDomainRequest||"withCredentials" in c||!/^(http(s)?:)?\/\//.test(n)||(c=new XDomainRequest),"onload" in c?c.onload=c.onerror=u:c.onreadystatechange=function(){c.readyState>3&&u()},c.onprogress=function(n){var t=mo.event;mo.event=n;try{o.progress.call(i,c)}finally{mo.event=t}},i.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?a[n]:(null==t?delete a[n]:a[n]=t+"",i)},i.mimeType=function(n){return arguments.length?(t=null==n?null:n+"",i):t},i.responseType=function(n){return arguments.length?(l=n,i):l},i.response=function(n){return e=n,i},["get","post"].forEach(function(n){i[n]=function(){return i.send.apply(i,[n].concat(Mo(arguments)))}}),i.send=function(e,r,u){if(2===arguments.length&&"function"==typeof r&&(u=r,r=null),c.open(e,n,!0),null==t||"accept" in a||(a.accept=t+",*/*"),c.setRequestHeader){for(var s in a){c.setRequestHeader(s,a[s])}}return null!=t&&c.overrideMimeType&&c.overrideMimeType(t),null!=l&&(c.responseType=l),null!=u&&i.on("error",u).on("load",function(n){u(null,n)}),o.beforesend.call(i,c),c.send(null==r?null:r),i},i.abort=function(){return c.abort(),i},mo.rebind(i,o,"on"),null==r?i:i.get(yt(r))}function yt(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}function Mt(){var n=bt(),t=_t()-n;t>24?(isFinite(t)&&(clearTimeout(ma),ma=setTimeout(Mt,t)),va=0):(va=1,Ma(Mt))}function xt(n,t,e){var r=arguments.length;2>r&&(t=0),3>r&&(e=Date.now()),ya.callback=n,ya.time=e+t}function bt(){var n=Date.now();for(ya=pa;ya;){n>=ya.time&&(ya.flush=ya.callback(n-ya.time)),ya=ya.next}return n}function _t(){for(var n,t=pa,e=1/0;t;){t.flush?t=n?n.next=t.next:pa=t.next:(t.time<e&&(e=t.time),t=(n=t).next)}return da=n,e}function wt(n,t){var e=Math.pow(10,3*Math.abs(8-t));return{scale:t>8?function(n){return n/e}:function(n){return n*e},symbol:n}}function St(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function Et(n){return n+""}function kt(){}function At(n,t,e){var r=e.s=n+t,u=r-n,i=r-u;e.t=n-i+(t-u)}function Nt(n,t){n&&za.hasOwnProperty(n.type)&&za[n.type](n,t)}function Tt(n,t,e){var r,u=-1,i=n.length-e;for(t.lineStart();++u<i;){r=n[u],t.point(r[0],r[1],r[2])}t.lineEnd()}function qt(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;){Tt(n[e],t,1)}t.polygonEnd()}function zt(){function n(n,t){n*=Go,t=t*Go/2+Bo/4;var e=n-r,o=Math.cos(t),a=Math.sin(t),c=i*a,l=u*o+c*Math.cos(e),s=c*Math.sin(e);Da.add(Math.atan2(s,l)),r=n,u=o,i=a}var t,e,r,u,i;ja.point=function(o,a){ja.point=n,r=(t=o)*Go,u=Math.cos(a=(e=a)*Go/2+Bo/4),i=Math.sin(a)},ja.lineEnd=function(){n(t,e)}}function Ct(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function Dt(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function jt(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function Lt(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function Ht(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function Ft(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function Pt(n){return[Math.atan2(n[1],n[0]),O(n[2])]}function Ot(n,t){return Math.abs(n[0]-t[0])<Wo&&Math.abs(n[1]-t[1])<Wo}function Rt(n,t){n*=Go;var e=Math.cos(t*=Go);Yt(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function Yt(n,t,e){++La,Fa+=(n-Fa)/La,Pa+=(t-Pa)/La,Oa+=(e-Oa)/La}function It(){function n(n,u){n*=Go;var i=Math.cos(u*=Go),o=i*Math.cos(n),a=i*Math.sin(n),c=Math.sin(u),l=Math.atan2(Math.sqrt((l=e*c-r*a)*l+(l=r*o-t*c)*l+(l=t*a-e*o)*l),t*o+e*a+r*c);Ha+=l,Ra+=l*(t+(t=o)),Ya+=l*(e+(e=a)),Ia+=l*(r+(r=c)),Yt(t,e,r)}var t,e,r;Xa.point=function(u,i){u*=Go;var o=Math.cos(i*=Go);t=o*Math.cos(u),e=o*Math.sin(u),r=Math.sin(i),Xa.point=n,Yt(t,e,r)}}function Ut(){Xa.point=Rt}function Zt(){function n(n,t){n*=Go;var e=Math.cos(t*=Go),o=e*Math.cos(n),a=e*Math.sin(n),c=Math.sin(t),l=u*c-i*a,s=i*o-r*c,f=r*a-u*o,h=Math.sqrt(l*l+s*s+f*f),g=r*o+u*a+i*c,p=h&&-P(g)/h,d=Math.atan2(h,g);Ua+=p*l,Za+=p*s,Va+=p*f,Ha+=d,Ra+=d*(r+(r=o)),Ya+=d*(u+(u=a)),Ia+=d*(i+(i=c)),Yt(r,u,i)}var t,e,r,u,i;Xa.point=function(o,a){t=o,e=a,Xa.point=n,o*=Go;var c=Math.cos(a*=Go);r=c*Math.cos(o),u=c*Math.sin(o),i=Math.sin(a),Yt(r,u,i)},Xa.lineEnd=function(){n(t,e),Xa.lineEnd=Ut,Xa.point=Rt}}function Vt(){return !0}function Xt(n,t,e,r,u){var i=[],o=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(Ot(e,r)){u.lineStart();for(var a=0;t>a;++a){u.point((e=n[a])[0],e[1])}return u.lineEnd(),void 0}var c={point:e,points:n,other:null,visited:!1,entry:!0,subject:!0},l={point:e,points:[e],other:c,visited:!1,entry:!1,subject:!1};c.other=l,i.push(c),o.push(l),c={point:r,points:[r],other:null,visited:!1,entry:!1,subject:!0},l={point:r,points:[r],other:c,visited:!1,entry:!0,subject:!1},c.other=l,i.push(c),o.push(l)}}),o.sort(t),$t(i),$t(o),i.length){if(e){for(var a=1,c=!e(o[0].point),l=o.length;l>a;++a){o[a].entry=c=!c}}for(var s,f,h,g=i[0];;){for(s=g;s.visited;){if((s=s.next)===g){return}}f=s.points,u.lineStart();do{if(s.visited=s.other.visited=!0,s.entry){if(s.subject){for(var a=0;a<f.length;a++){u.point((h=f[a])[0],h[1])}}else{r(s.point,s.next.point,1,u)}s=s.next}else{if(s.subject){f=s.prev.points;for(var a=f.length;--a>=0;){u.point((h=f[a])[0],h[1])}}else{r(s.point,s.prev.point,-1,u)}s=s.prev}s=s.other,f=s.points}while(!s.visited);u.lineEnd()}}}function $t(n){if(t=n.length){for(var t,e,r=0,u=n[0];++r<t;){u.next=e=n[r],e.prev=u,u=e}u.next=e=n[0],e.prev=u}}function Bt(n,t,e,r){return function(u){function i(t,e){n(t,e)&&u.point(t,e)}function o(n,t){d.point(n,t)}function a(){v.point=o,d.lineStart()}function c(){v.point=i,d.lineEnd()}function l(n,t){y.point(n,t),p.push([n,t])}function s(){y.lineStart(),p=[]}function f(){l(p[0][0],p[0][1]),y.lineEnd();var n,t=y.clean(),e=m.buffer(),r=e.length;if(p.pop(),g.push(p),p=null,r){if(1&t){n=e[0];var i,r=n.length-1,o=-1;for(u.lineStart();++o<r;){u.point((i=n[o])[0],i[1])}return u.lineEnd(),void 0}r>1&&2&t&&e.push(e.pop().concat(e.shift())),h.push(e.filter(Wt))}}var h,g,p,d=t(u),v={point:i,lineStart:a,lineEnd:c,polygonStart:function(){v.point=l,v.lineStart=s,v.lineEnd=f,h=[],g=[],u.polygonStart()},polygonEnd:function(){v.point=i,v.lineStart=a,v.lineEnd=c,h=mo.merge(h),h.length?Xt(h,Gt,null,e,u):r(g)&&(u.lineStart(),e(null,null,1,u),u.lineEnd()),u.polygonEnd(),h=g=null},sphere:function(){u.polygonStart(),u.lineStart(),e(null,null,1,u),u.lineEnd(),u.polygonEnd()}},m=Jt(),y=t(m);return v}}function Wt(n){return n.length>1}function Jt(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:c,buffer:function(){var e=t;return t=[],n=null,e},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function Gt(n,t){return((n=n.point)[0]<0?n[1]-Bo/2-Wo:Bo/2-n[1])-((t=t.point)[0]<0?t[1]-Bo/2-Wo:Bo/2-t[1])}function Kt(n,t){var e=n[0],r=n[1],u=[Math.sin(e),-Math.cos(e),0],i=0,o=!1,a=!1,c=0;Da.reset();for(var l=0,s=t.length;s>l;++l){var f=t[l],h=f.length;if(h){for(var g=f[0],p=g[0],d=g[1]/2+Bo/4,v=Math.sin(d),m=Math.cos(d),y=1;;){y===h&&(y=0),n=f[y];var M=n[0],x=n[1]/2+Bo/4,b=Math.sin(x),_=Math.cos(x),w=M-p,S=Math.abs(w)>Bo,E=v*b;if(Da.add(Math.atan2(E*Math.sin(w),m*_+E*Math.cos(w))),Math.abs(x)<Wo&&(a=!0),i+=S?w+(w>=0?2:-2)*Bo:w,S^p>=e^M>=e){var k=jt(Ct(g),Ct(n));Ft(k);var A=jt(u,k);Ft(A);var N=(S^w>=0?-1:1)*O(A[2]);r>N&&(c+=S^w>=0?1:-1)}if(!y++){break}p=M,v=b,m=_,g=n}Math.abs(i)>Wo&&(o=!0)}}return(!a&&!o&&0>Da||-Wo>i)^1&c}function Qt(n){var t,e=0/0,r=0/0,u=0/0;return{lineStart:function(){n.lineStart(),t=1},point:function(i,o){var a=i>0?Bo:-Bo,c=Math.abs(i-e);Math.abs(c-Bo)<Wo?(n.point(e,r=(r+o)/2>0?Bo/2:-Bo/2),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),n.point(i,r),t=0):u!==a&&c>=Bo&&(Math.abs(e-u)<Wo&&(e-=u*Wo),Math.abs(i-a)<Wo&&(i-=a*Wo),r=ne(e,r,i,o),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),t=0),n.point(e=i,r=o),u=a},lineEnd:function(){n.lineEnd(),e=r=0/0},clean:function(){return 2-t}}}function ne(n,t,e,r){var u,i,o=Math.sin(n-e);return Math.abs(o)>Wo?Math.atan((Math.sin(t)*(i=Math.cos(r))*Math.sin(e)-Math.sin(r)*(u=Math.cos(t))*Math.sin(n))/(u*i*o)):(t+r)/2}function te(n,t,e,r){var u;if(null==n){u=e*Bo/2,r.point(-Bo,u),r.point(0,u),r.point(Bo,u),r.point(Bo,0),r.point(Bo,-u),r.point(0,-u),r.point(-Bo,-u),r.point(-Bo,0),r.point(-Bo,u)}else{if(Math.abs(n[0]-t[0])>Wo){var i=(n[0]<t[0]?1:-1)*Bo;u=e*i/2,r.point(-i,u),r.point(0,u),r.point(i,u)}else{r.point(t[0],t[1])}}}function ee(n){return Kt(Ba,n)}function re(n){function t(n,t){return Math.cos(n)*Math.cos(t)>o}function e(n){var e,i,o,c,s;return{lineStart:function(){c=o=!1,s=1},point:function(f,h){var g,p=[f,h],d=t(f,h),v=a?d?0:u(f,h):d?u(f+(0>f?Bo:-Bo),h):0;if(!e&&(c=o=d)&&n.lineStart(),d!==o&&(g=r(e,p),(Ot(e,g)||Ot(p,g))&&(p[0]+=Wo,p[1]+=Wo,d=t(p[0],p[1]))),d!==o){s=0,d?(n.lineStart(),g=r(p,e),n.point(g[0],g[1])):(g=r(e,p),n.point(g[0],g[1]),n.lineEnd()),e=g}else{if(l&&e&&a^d){var m;v&i||!(m=r(p,e,!0))||(s=0,a?(n.lineStart(),n.point(m[0][0],m[0][1]),n.point(m[1][0],m[1][1]),n.lineEnd()):(n.point(m[1][0],m[1][1]),n.lineEnd(),n.lineStart(),n.point(m[0][0],m[0][1])))}}!d||e&&Ot(e,p)||n.point(p[0],p[1]),e=p,o=d,i=v},lineEnd:function(){o&&n.lineEnd(),e=null},clean:function(){return s|(c&&o)<<1}}}function r(n,t,e){var r=Ct(n),u=Ct(t),i=[1,0,0],a=jt(r,u),c=Dt(a,a),l=a[0],s=c-l*l;if(!s){return !e&&n}var f=o*c/s,h=-o*l/s,g=jt(i,a),p=Ht(i,f),d=Ht(a,h);Lt(p,d);var v=g,m=Dt(p,v),y=Dt(v,v),M=m*m-y*(Dt(p,p)-1);if(!(0>M)){var x=Math.sqrt(M),b=Ht(v,(-m-x)/y);if(Lt(b,p),b=Pt(b),!e){return b}var _,w=n[0],S=t[0],E=n[1],k=t[1];w>S&&(_=w,w=S,S=_);var A=S-w,N=Math.abs(A-Bo)<Wo,T=N||Wo>A;if(!N&&E>k&&(_=E,E=k,k=_),T?N?E+k>0^b[1]<(Math.abs(b[0]-w)<Wo?E:k):E<=b[1]&&b[1]<=k:A>Bo^(w<=b[0]&&b[0]<=S)){var q=Ht(v,(-m+x)/y);return Lt(q,p),[b,Pt(q)]}}}function u(t,e){var r=a?n:Bo-n,u=0;return -r>t?u|=1:t>r&&(u|=2),-r>e?u|=4:e>r&&(u|=8),u}function i(n){return Kt(c,n)}var o=Math.cos(n),a=o>0,c=[n,0],l=Math.abs(o)>Wo,s=Te(n,6*Go);return Bt(t,e,s,i)}function ue(n,t,e,r){function u(r,u){return Math.abs(r[0]-n)<Wo?u>0?0:3:Math.abs(r[0]-e)<Wo?u>0?2:1:Math.abs(r[1]-t)<Wo?u>0?1:0:u>0?3:2}function i(n,t){return o(n.point,t.point)}function o(n,t){var e=u(n,1),r=u(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}function a(u,i){var o=i[0]-u[0],a=i[1]-u[1],c=[0,1];return Math.abs(o)<Wo&&Math.abs(a)<Wo?n<=u[0]&&u[0]<=e&&t<=u[1]&&u[1]<=r:ie(n-u[0],o,c)&&ie(u[0]-e,-o,c)&&ie(t-u[1],a,c)&&ie(u[1]-r,-a,c)?(c[1]<1&&(i[0]=u[0]+c[1]*o,i[1]=u[1]+c[1]*a),c[0]>0&&(u[0]+=c[0]*o,u[1]+=c[0]*a),!0):!1}return function(c){function l(i){var o=u(i,-1),a=s([0===o||3===o?n:e,o>1?r:t]);return a}function s(n){for(var t=0,e=M.length,r=n[1],u=0;e>u;++u){for(var i,o=1,a=M[u],c=a.length,l=a[0];c>o;++o){i=a[o],l[1]<=r?i[1]>r&&f(l,i,n)>0&&++t:i[1]<=r&&f(l,i,n)<0&&--t,l=i}}return 0!==t}function f(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(e[0]-n[0])*(t[1]-n[1])}function h(i,a,c,l){var s=0,f=0;if(null==i||(s=u(i,c))!==(f=u(a,c))||o(i,a)<0^c>0){do{l.point(0===s||3===s?n:e,s>1?r:t)}while((s=(s+c+4)%4)!==f)}else{l.point(a[0],a[1])}}function g(u,i){return u>=n&&e>=u&&i>=t&&r>=i}function p(n,t){g(n,t)&&c.point(n,t)}function d(){q.point=m,M&&M.push(x=[]),A=!0,k=!1,S=E=0/0}function v(){y&&(m(b,_),w&&k&&T.rejoin(),y.push(T.buffer())),q.point=p,k&&c.lineEnd()}function m(n,t){n=Math.max(-Wa,Math.min(Wa,n)),t=Math.max(-Wa,Math.min(Wa,t));var e=g(n,t);if(M&&x.push([n,t]),A){b=n,_=t,w=e,A=!1,e&&(c.lineStart(),c.point(n,t))}else{if(e&&k){c.point(n,t)}else{var r=[S,E],u=[n,t];a(r,u)?(k||(c.lineStart(),c.point(r[0],r[1])),c.point(u[0],u[1]),e||c.lineEnd()):e&&(c.lineStart(),c.point(n,t))}}S=n,E=t,k=e}var y,M,x,b,_,w,S,E,k,A,N=c,T=Jt(),q={point:p,lineStart:d,lineEnd:v,polygonStart:function(){c=T,y=[],M=[]},polygonEnd:function(){c=N,(y=mo.merge(y)).length?(c.polygonStart(),Xt(y,i,l,h,c),c.polygonEnd()):s([n,t])&&(c.polygonStart(),c.lineStart(),h(null,null,1,c),c.lineEnd(),c.polygonEnd()),y=M=x=null}};return q}}function ie(n,t,e){if(Math.abs(t)<Wo){return 0>=n}var r=n/t;if(t>0){if(r>e[1]){return !1}r>e[0]&&(e[0]=r)}else{if(r<e[0]){return !1}r<e[1]&&(e[1]=r)}return !0}function oe(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),e}function ae(n){var t=0,e=Bo/3,r=_e(n),u=r(t,e);return u.parallels=function(n){return arguments.length?r(t=n[0]*Bo/180,e=n[1]*Bo/180):[180*(t/Bo),180*(e/Bo)]},u}function ce(n,t){function e(n,t){var e=Math.sqrt(i-2*u*Math.sin(t))/u;return[e*Math.sin(n*=u),o-e*Math.cos(n)]}var r=Math.sin(n),u=(r+Math.sin(t))/2,i=1+r*(2*u-r),o=Math.sqrt(i)/u;return e.invert=function(n,t){var e=o-t;return[Math.atan2(n,e)/u,O((i-(n*n+e*e)*u*u)/(2*u))]},e}function le(){function n(n,t){Ga+=u*n-r*t,r=n,u=t}var t,e,r,u;ec.point=function(i,o){ec.point=n,t=r=i,e=u=o},ec.lineEnd=function(){n(t,e)}}function se(n,t){Ka>n&&(Ka=n),n>nc&&(nc=n),Qa>t&&(Qa=t),t>tc&&(tc=t)}function fe(){function n(n,t){o.push("M",n,",",t,i)}function t(n,t){o.push("M",n,",",t),a.point=e}function e(n,t){o.push("L",n,",",t)}function r(){a.point=n}function u(){o.push("Z")}var i=he(4.5),o=[],a={point:n,lineStart:function(){a.point=t},lineEnd:r,polygonStart:function(){a.lineEnd=u},polygonEnd:function(){a.lineEnd=r,a.point=n},pointRadius:function(n){return i=he(n),a},result:function(){if(o.length){var n=o.join("");return o=[],n}}};return a}function he(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function ge(n,t){Fa+=n,Pa+=t,++Oa}function pe(){function n(n,r){var u=n-t,i=r-e,o=Math.sqrt(u*u+i*i);Ra+=o*(t+n)/2,Ya+=o*(e+r)/2,Ia+=o,ge(t=n,e=r)}var t,e;uc.point=function(r,u){uc.point=n,ge(t=r,e=u)}}function de(){uc.point=ge}function ve(){function n(n,t){var e=n-r,i=t-u,o=Math.sqrt(e*e+i*i);Ra+=o*(r+n)/2,Ya+=o*(u+t)/2,Ia+=o,o=u*n-r*t,Ua+=o*(r+n),Za+=o*(u+t),Va+=3*o,ge(r=n,u=t)}var t,e,r,u;uc.point=function(i,o){uc.point=n,ge(t=r=i,e=u=o)},uc.lineEnd=function(){n(t,e)}}function me(n){function t(t,e){n.moveTo(t,e),n.arc(t,e,o,0,2*Bo)}function e(t,e){n.moveTo(t,e),a.point=r}function r(t,e){n.lineTo(t,e)}function u(){a.point=t}function i(){n.closePath()}var o=4.5,a={point:t,lineStart:function(){a.point=e},lineEnd:u,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=u,a.point=t},pointRadius:function(n){return o=n,a},result:c};return a}function ye(n){function t(t){function r(e,r){e=n(e,r),t.point(e[0],e[1])}function u(){M=0/0,S.point=o,t.lineStart()}function o(r,u){var o=Ct([r,u]),a=n(r,u);e(M,x,y,b,_,w,M=a[0],x=a[1],y=r,b=o[0],_=o[1],w=o[2],i,t),t.point(M,x)}function a(){S.point=r,t.lineEnd()}function c(){u(),S.point=l,S.lineEnd=s}function l(n,t){o(f=n,h=t),g=M,p=x,d=b,v=_,m=w,S.point=o}function s(){e(M,x,y,b,_,w,g,p,f,d,v,m,i,t),S.lineEnd=a,a()}var f,h,g,p,d,v,m,y,M,x,b,_,w,S={point:r,lineStart:u,lineEnd:a,polygonStart:function(){t.polygonStart(),S.lineStart=c},polygonEnd:function(){t.polygonEnd(),S.lineStart=u}};return S}function e(t,i,o,a,c,l,s,f,h,g,p,d,v,m){var y=s-t,M=f-i,x=y*y+M*M;if(x>4*r&&v--){var b=a+g,_=c+p,w=l+d,S=Math.sqrt(b*b+_*_+w*w),E=Math.asin(w/=S),k=Math.abs(Math.abs(w)-1)<Wo?(o+h)/2:Math.atan2(_,b),A=n(k,E),N=A[0],T=A[1],q=N-t,z=T-i,C=M*q-y*z;(C*C/x>r||Math.abs((y*q+M*z)/x-0.5)>0.3||u>a*g+c*p+l*d)&&(e(t,i,o,a,c,l,N,T,k,b/=S,_/=S,w,v,m),m.point(N,T),e(N,T,k,b,_,w,s,f,h,g,p,d,v,m))}}var r=0.5,u=Math.cos(30*Go),i=16;return t.precision=function(n){return arguments.length?(i=(r=n*n)>0&&16,t):Math.sqrt(r)},t}function Me(n){this.stream=n}function xe(n){var t=ye(function(t,e){return n([t*Ko,e*Ko])});return function(n){var e=new Me(n=t(n));return e.point=function(t,e){n.point(t*Go,e*Go)},e}}function be(n){return _e(function(){return n})()}function _e(n){function t(n){return n=a(n[0]*Go,n[1]*Go),[n[0]*h+c,l-n[1]*h]}function e(n){return n=a.invert((n[0]-c)/h,(l-n[1])/h),n&&[n[0]*Ko,n[1]*Ko]}function r(){a=oe(o=Ee(m,y,M),i);var n=i(d,v);return c=g-n[0]*h,l=p+n[1]*h,u()}function u(){return s&&(s.valid=!1,s=null),t}var i,o,a,c,l,s,f=ye(function(n,t){return n=i(n,t),[n[0]*h+c,l-n[1]*h]}),h=150,g=480,p=250,d=0,v=0,m=0,y=0,M=0,x=$a,b=dt,_=null,w=null;return t.stream=function(n){return s&&(s.valid=!1),s=we(o,x(f(b(n)))),s.valid=!0,s},t.clipAngle=function(n){return arguments.length?(x=null==n?(_=n,$a):re((_=+n)*Go),u()):_},t.clipExtent=function(n){return arguments.length?(w=n,b=n?ue(n[0][0],n[0][1],n[1][0],n[1][1]):dt,u()):w},t.scale=function(n){return arguments.length?(h=+n,r()):h},t.translate=function(n){return arguments.length?(g=+n[0],p=+n[1],r()):[g,p]},t.center=function(n){return arguments.length?(d=n[0]%360*Go,v=n[1]%360*Go,r()):[d*Ko,v*Ko]},t.rotate=function(n){return arguments.length?(m=n[0]%360*Go,y=n[1]%360*Go,M=n.length>2?n[2]%360*Go:0,r()):[m*Ko,y*Ko,M*Ko]},mo.rebind(t,f,"precision"),function(){return i=n.apply(this,arguments),t.invert=i.invert&&e,r()}}function we(n,t){var e=new Me(t);return e.point=function(e,r){r=n(e*Go,r*Go),e=r[0],t.point(e>Bo?e-2*Bo:-Bo>e?e+2*Bo:e,r[1])},e}function Se(n,t){return[n,t]}function Ee(n,t,e){return n?t||e?oe(Ae(n),Ne(t,e)):Ae(n):t||e?Ne(t,e):Se}function ke(n){return function(t,e){return t+=n,[t>Bo?t-2*Bo:-Bo>t?t+2*Bo:t,e]}}function Ae(n){var t=ke(n);return t.invert=ke(-n),t}function Ne(n,t){function e(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,l=Math.sin(t),s=l*r+a*u;return[Math.atan2(c*i-s*o,a*r-l*u),O(s*i+c*o)]}var r=Math.cos(n),u=Math.sin(n),i=Math.cos(t),o=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,l=Math.sin(t),s=l*i-c*o;return[Math.atan2(c*i+l*o,a*r+s*u),O(s*r-a*u)]},e}function Te(n,t){var e=Math.cos(n),r=Math.sin(n);return function(u,i,o,a){var c=o*t;null!=u?(u=qe(e,u),i=qe(e,i),(o>0?i>u:u>i)&&(u+=2*o*Bo)):(u=n+2*o*Bo,i=n-0.5*c);for(var l,s=u;o>0?s>i:i>s;s-=c){a.point((l=Pt([e,-r*Math.cos(s),-r*Math.sin(s)]))[0],l[1])}}}function qe(n,t){var e=Ct(t);e[0]-=n,Ft(e);var r=P(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-Wo)%(2*Math.PI)}function ze(n,t,e){var r=mo.range(n,t-Wo,e).concat(t);return function(n){return r.map(function(t){return[n,t]})}}function Ce(n,t,e){var r=mo.range(n,t-Wo,e).concat(t);return function(n){return r.map(function(t){return[t,n]})}}function De(n){return n.source}function je(n){return n.target}function Le(n,t,e,r){var u=Math.cos(t),i=Math.sin(t),o=Math.cos(r),a=Math.sin(r),c=u*Math.cos(n),l=u*Math.sin(n),s=o*Math.cos(e),f=o*Math.sin(e),h=2*Math.asin(Math.sqrt(U(r-t)+u*o*U(e-n))),g=1/Math.sin(h),p=h?function(n){var t=Math.sin(n*=h)*g,e=Math.sin(h-n)*g,r=e*c+t*s,u=e*l+t*f,o=e*i+t*a;return[Math.atan2(u,r)*Ko,Math.atan2(o,Math.sqrt(r*r+u*u))*Ko]}:function(){return[n*Ko,t*Ko]};return p.distance=h,p}function He(){function n(n,u){var i=Math.sin(u*=Go),o=Math.cos(u),a=Math.abs((n*=Go)-t),c=Math.cos(a);ic+=Math.atan2(Math.sqrt((a=o*Math.sin(a))*a+(a=r*i-e*o*c)*a),e*i+r*o*c),t=n,e=i,r=o}var t,e,r;oc.point=function(u,i){t=u*Go,e=Math.sin(i*=Go),r=Math.cos(i),oc.point=n},oc.lineEnd=function(){oc.point=oc.lineEnd=c}}function Fe(n,t){function e(t,e){var r=Math.cos(t),u=Math.cos(e),i=n(r*u);return[i*u*Math.sin(t),i*Math.sin(e)]}return e.invert=function(n,e){var r=Math.sqrt(n*n+e*e),u=t(r),i=Math.sin(u),o=Math.cos(u);return[Math.atan2(n*i,r*o),Math.asin(r&&e*i/r)]},e}function Pe(n,t){function e(n,t){var e=Math.abs(Math.abs(t)-Bo/2)<Wo?0:o/Math.pow(u(t),i);return[e*Math.sin(i*n),o-e*Math.cos(i*n)]}var r=Math.cos(n),u=function(n){return Math.tan(Bo/4+n/2)},i=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(u(t)/u(n)),o=r*Math.pow(u(n),i)/i;return i?(e.invert=function(n,t){var e=o-t,r=F(i)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/i,2*Math.atan(Math.pow(o/r,1/i))-Bo/2]},e):Re}function Oe(n,t){function e(n,t){var e=i-t;return[e*Math.sin(u*n),i-e*Math.cos(u*n)]}var r=Math.cos(n),u=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),i=r/u+n;return Math.abs(u)<Wo?Se:(e.invert=function(n,t){var e=i-t;return[Math.atan2(n,e)/u,i-F(u)*Math.sqrt(n*n+e*e)]},e)}function Re(n,t){return[n,Math.log(Math.tan(Bo/4+t/2))]}function Ye(n){var t,e=be(n),r=e.scale,u=e.translate,i=e.clipExtent;return e.scale=function(){var n=r.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.translate=function(){var n=u.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.clipExtent=function(n){var o=i.apply(e,arguments);if(o===e){if(t=null==n){var a=Bo*r(),c=u();i([[c[0]-a,c[1]-a],[c[0]+a,c[1]+a]])}}else{t&&(o=null)}return o},e.clipExtent(null)}function Ie(n,t){var e=Math.cos(t)*Math.sin(n);return[Math.log((1+e)/(1-e))/2,Math.atan2(Math.tan(t),Math.cos(n))]}function Ue(n){function t(t){function o(){l.push("M",i(n(s),a))}for(var c,l=[],s=[],f=-1,h=t.length,g=pt(e),p=pt(r);++f<h;){u.call(this,c=t[f],f)?s.push([+g.call(this,c,f),+p.call(this,c,f)]):s.length&&(o(),s=[])}return s.length&&o(),l.length?l.join(""):null}var e=Ze,r=Ve,u=Vt,i=Xe,o=i.key,a=0.7;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.defined=function(n){return arguments.length?(u=n,t):u},t.interpolate=function(n){return arguments.length?(o="function"==typeof n?i=n:(i=hc.get(n)||Xe).key,t):o},t.tension=function(n){return arguments.length?(a=n,t):a},t}function Ze(n){return n[0]}function Ve(n){return n[1]}function Xe(n){return n.join("L")}function $e(n){return Xe(n)+"Z"}function Be(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;){u.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1])}return e>1&&u.push("H",r[0]),u.join("")}function We(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;){u.push("V",(r=n[t])[1],"H",r[0])}return u.join("")}function Je(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;){u.push("H",(r=n[t])[0],"V",r[1])}return u.join("")}function Ge(n,t){return n.length<4?Xe(n):n[1]+nr(n.slice(1,n.length-1),tr(n,t))}function Ke(n,t){return n.length<3?Xe(n):n[0]+nr((n.push(n[0]),n),tr([n[n.length-2]].concat(n,[n[1]]),t))}function Qe(n,t){return n.length<3?Xe(n):n[0]+nr(n,tr(n,t))}function nr(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2){return Xe(n)}var e=n.length!=t.length,r="",u=n[0],i=n[1],o=t[0],a=o,c=1;if(e&&(r+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],u=n[1],c=2),t.length>1){a=t[1],i=n[c],c++,r+="C"+(u[0]+o[0])+","+(u[1]+o[1])+","+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1];for(var l=2;l<t.length;l++,c++){i=n[c],a=t[l],r+="S"+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1]}}if(e){var s=n[c];r+="Q"+(i[0]+2*a[0]/3)+","+(i[1]+2*a[1]/3)+","+s[0]+","+s[1]}return r}function tr(n,t){for(var e,r=[],u=(1-t)/2,i=n[0],o=n[1],a=1,c=n.length;++a<c;){e=i,i=o,o=n[a],r.push([u*(o[0]-e[0]),u*(o[1]-e[1])])}return r}function er(n){if(n.length<3){return Xe(n)}var t=1,e=n.length,r=n[0],u=r[0],i=r[1],o=[u,u,u,(r=n[1])[0]],a=[i,i,i,r[1]],c=[u,",",i,"L",or(dc,o),",",or(dc,a)];for(n.push(n[e-1]);++t<=e;){r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),ar(c,o,a)}return n.pop(),c.push("L",r),c.join("")}function rr(n){if(n.length<4){return Xe(n)}for(var t,e=[],r=-1,u=n.length,i=[0],o=[0];++r<3;){t=n[r],i.push(t[0]),o.push(t[1])}for(e.push(or(dc,i)+","+or(dc,o)),--r;++r<u;){t=n[r],i.shift(),i.push(t[0]),o.shift(),o.push(t[1]),ar(e,i,o)}return e.join("")}function ur(n){for(var t,e,r=-1,u=n.length,i=u+4,o=[],a=[];++r<4;){e=n[r%u],o.push(e[0]),a.push(e[1])}for(t=[or(dc,o),",",or(dc,a)],--r;++r<i;){e=n[r%u],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),ar(t,o,a)}return t.join("")}function ir(n,t){var e=n.length-1;if(e){for(var r,u,i=n[0][0],o=n[0][1],a=n[e][0]-i,c=n[e][1]-o,l=-1;++l<=e;){r=n[l],u=l/e,r[0]=t*r[0]+(1-t)*(i+u*a),r[1]=t*r[1]+(1-t)*(o+u*c)}}return er(n)}function or(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function ar(n,t,e){n.push("C",or(gc,t),",",or(gc,e),",",or(pc,t),",",or(pc,e),",",or(dc,t),",",or(dc,e))}function cr(n,t){return(t[1]-n[1])/(t[0]-n[0])}function lr(n){for(var t=0,e=n.length-1,r=[],u=n[0],i=n[1],o=r[0]=cr(u,i);++t<e;){r[t]=(o+(o=cr(u=i,i=n[t+1])))/2}return r[t]=o,r}function sr(n){for(var t,e,r,u,i=[],o=lr(n),a=-1,c=n.length-1;++a<c;){t=cr(n[a],n[a+1]),Math.abs(t)<0.000001?o[a]=o[a+1]=0:(e=o[a]/t,r=o[a+1]/t,u=e*e+r*r,u>9&&(u=3*t/Math.sqrt(u),o[a]=u*e,o[a+1]=u*r))}for(a=-1;++a<=c;){u=(n[Math.min(c,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),i.push([u||0,o[a]*u||0])}return i}function fr(n){return n.length<3?Xe(n):n[0]+nr(n,sr(n))}function hr(n,t,e,r){var u,i,o,a,c,l,s;return u=r[n],i=u[0],o=u[1],u=r[t],a=u[0],c=u[1],u=r[e],l=u[0],s=u[1],(s-o)*(a-i)-(c-o)*(l-i)>0}function gr(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function pr(n,t,e,r){var u=n[0],i=e[0],o=t[0]-u,a=r[0]-i,c=n[1],l=e[1],s=t[1]-c,f=r[1]-l,h=(a*(c-l)-f*(u-i))/(f*o-a*s);return[u+h*o,c+h*s]}function dr(n){var t=n[0],e=n[n.length-1];return !(t[0]-e[0]||t[1]-e[1])}function vr(n,t){var e={list:n.map(function(n,t){return{index:t,x:n[0],y:n[1]}}).sort(function(n,t){return n.y<t.y?-1:n.y>t.y?1:n.x<t.x?-1:n.x>t.x?1:0}),bottomSite:null},r={list:[],leftEnd:null,rightEnd:null,init:function(){r.leftEnd=r.createHalfEdge(null,"l"),r.rightEnd=r.createHalfEdge(null,"l"),r.leftEnd.r=r.rightEnd,r.rightEnd.l=r.leftEnd,r.list.unshift(r.leftEnd,r.rightEnd)},createHalfEdge:function(n,t){return{edge:n,side:t,vertex:null,l:null,r:null}},insert:function(n,t){t.l=n,t.r=n.r,n.r.l=t,n.r=t},leftBound:function(n){var t=r.leftEnd;do{t=t.r}while(t!=r.rightEnd&&u.rightOf(t,n));return t=t.l},del:function(n){n.l.r=n.r,n.r.l=n.l,n.edge=null},right:function(n){return n.r},left:function(n){return n.l},leftRegion:function(n){return null==n.edge?e.bottomSite:n.edge.region[n.side]},rightRegion:function(n){return null==n.edge?e.bottomSite:n.edge.region[mc[n.side]]}},u={bisect:function(n,t){var e={region:{l:n,r:t},ep:{l:null,r:null}},r=t.x-n.x,u=t.y-n.y,i=r>0?r:-r,o=u>0?u:-u;return e.c=n.x*r+n.y*u+0.5*(r*r+u*u),i>o?(e.a=1,e.b=u/r,e.c/=r):(e.b=1,e.a=r/u,e.c/=u),e},intersect:function(n,t){var e=n.edge,r=t.edge;if(!e||!r||e.region.r==r.region.r){return null}var u=e.a*r.b-e.b*r.a;if(Math.abs(u)<1e-10){return null}var i,o,a=(e.c*r.b-r.c*e.b)/u,c=(r.c*e.a-e.c*r.a)/u,l=e.region.r,s=r.region.r;l.y<s.y||l.y==s.y&&l.x<s.x?(i=n,o=e):(i=t,o=r);var f=a>=o.region.r.x;return f&&"l"===i.side||!f&&"r"===i.side?null:{x:a,y:c}},rightOf:function(n,t){var e=n.edge,r=e.region.r,u=t.x>r.x;if(u&&"l"===n.side){return 1}if(!u&&"r"===n.side){return 0}if(1===e.a){var i=t.y-r.y,o=t.x-r.x,a=0,c=0;if(!u&&e.b<0||u&&e.b>=0?c=a=i>=e.b*o:(c=t.x+t.y*e.b>e.c,e.b<0&&(c=!c),c||(a=1)),!a){var l=r.x-e.region.l.x;c=e.b*(o*o-i*i)<l*i*(1+2*o/l+e.b*e.b),e.b<0&&(c=!c)}}else{var s=e.c-e.a*t.x,f=t.y-s,h=t.x-r.x,g=s-r.y;c=f*f>h*h+g*g}return"l"===n.side?c:!c},endPoint:function(n,e,r){n.ep[e]=r,n.ep[mc[e]]&&t(n)},distance:function(n,t){var e=n.x-t.x,r=n.y-t.y;return Math.sqrt(e*e+r*r)}},i={list:[],insert:function(n,t,e){n.vertex=t,n.ystar=t.y+e;for(var r=0,u=i.list,o=u.length;o>r;r++){var a=u[r];if(!(n.ystar>a.ystar||n.ystar==a.ystar&&t.x>a.vertex.x)){break}}u.splice(r,0,n)},del:function(n){for(var t=0,e=i.list,r=e.length;r>t&&e[t]!=n;++t){}e.splice(t,1)},empty:function(){return 0===i.list.length},nextEvent:function(n){for(var t=0,e=i.list,r=e.length;r>t;++t){if(e[t]==n){return e[t+1]}}return null},min:function(){var n=i.list[0];return{x:n.vertex.x,y:n.ystar}},extractMin:function(){return i.list.shift()}};r.init(),e.bottomSite=e.list.shift();for(var o,a,c,l,s,f,h,g,p,d,v,m,y,M=e.list.shift();;){if(i.empty()||(o=i.min()),M&&(i.empty()||M.y<o.y||M.y==o.y&&M.x<o.x)){a=r.leftBound(M),c=r.right(a),h=r.rightRegion(a),m=u.bisect(h,M),f=r.createHalfEdge(m,"l"),r.insert(a,f),d=u.intersect(a,f),d&&(i.del(a),i.insert(a,d,u.distance(d,M))),a=f,f=r.createHalfEdge(m,"r"),r.insert(a,f),d=u.intersect(f,c),d&&i.insert(f,d,u.distance(d,M)),M=e.list.shift()}else{if(i.empty()){break}a=i.extractMin(),l=r.left(a),c=r.right(a),s=r.right(c),h=r.leftRegion(a),g=r.rightRegion(c),v=a.vertex,u.endPoint(a.edge,a.side,v),u.endPoint(c.edge,c.side,v),r.del(a),i.del(c),r.del(c),y="l",h.y>g.y&&(p=h,h=g,g=p,y="r"),m=u.bisect(h,g),f=r.createHalfEdge(m,y),r.insert(l,f),u.endPoint(m,mc[y],v),d=u.intersect(l,f),d&&(i.del(l),i.insert(l,d,u.distance(d,h))),d=u.intersect(f,s),d&&i.insert(f,d,u.distance(d,h))}}for(a=r.right(r.leftEnd);a!=r.rightEnd;a=r.right(a)){t(a.edge)}}function mr(n){return n.x}function yr(n){return n.y}function Mr(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function xr(n,t,e,r,u,i){if(!n(t,e,r,u,i)){var o=0.5*(e+u),a=0.5*(r+i),c=t.nodes;c[0]&&xr(n,c[0],e,r,o,a),c[1]&&xr(n,c[1],o,r,u,a),c[2]&&xr(n,c[2],e,a,o,i),c[3]&&xr(n,c[3],o,a,u,i)}}function br(n,t){n=mo.rgb(n),t=mo.rgb(t);var e=n.r,r=n.g,u=n.b,i=t.r-e,o=t.g-r,a=t.b-u;return function(n){return"#"+ct(Math.round(e+i*n))+ct(Math.round(r+o*n))+ct(Math.round(u+a*n))}}function _r(n,t){var e,r={},u={};for(e in n){e in t?r[e]=Er(n[e],t[e]):u[e]=n[e]}for(e in t){e in n||(u[e]=t[e])}return function(n){for(e in r){u[e]=r[e](n)}return u}}function wr(n,t){return t-=n=+n,function(e){return n+t*e}}function Sr(n,t){var e,r,u,i,o,a=0,c=0,l=[],s=[];for(n+="",t+="",yc.lastIndex=0,r=0;e=yc.exec(t);++r){e.index&&l.push(t.substring(a,c=e.index)),s.push({i:l.length,x:e[0]}),l.push(null),a=yc.lastIndex}for(a<t.length&&l.push(t.substring(a)),r=0,i=s.length;(e=yc.exec(n))&&i>r;++r){if(o=s[r],o.x==e[0]){if(o.i){if(null==l[o.i+1]){for(l[o.i-1]+=o.x,l.splice(o.i,1),u=r+1;i>u;++u){s[u].i--}}else{for(l[o.i-1]+=o.x+l[o.i+1],l.splice(o.i,2),u=r+1;i>u;++u){s[u].i-=2}}}else{if(null==l[o.i+1]){l[o.i]=o.x}else{for(l[o.i]=o.x+l[o.i+1],l.splice(o.i+1,1),u=r+1;i>u;++u){s[u].i--}}}s.splice(r,1),i--,r--}else{o.x=wr(parseFloat(e[0]),parseFloat(o.x))}}for(;i>r;){o=s.pop(),null==l[o.i+1]?l[o.i]=o.x:(l[o.i]=o.x+l[o.i+1],l.splice(o.i+1,1)),i--}return 1===l.length?null==l[0]?(o=s[0].x,function(n){return o(n)+""}):function(){return t}:function(n){for(r=0;i>r;++r){l[(o=s[r]).i]=o.x(n)}return l.join("")}}function Er(n,t){for(var e,r=mo.interpolators.length;--r>=0&&!(e=mo.interpolators[r](n,t));){}return e}function kr(n,t){var e,r=[],u=[],i=n.length,o=t.length,a=Math.min(n.length,t.length);for(e=0;a>e;++e){r.push(Er(n[e],t[e]))}for(;i>e;++e){u[e]=n[e]}for(;o>e;++e){u[e]=t[e]}return function(n){for(e=0;a>e;++e){u[e]=r[e](n)}return u}}function Ar(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function Nr(n){return function(t){return 1-n(1-t)}}function Tr(n){return function(t){return 0.5*(0.5>t?n(2*t):2-n(2-2*t))}}function qr(n){return n*n}function zr(n){return n*n*n}function Cr(n){if(0>=n){return 0}if(n>=1){return 1}var t=n*n,e=t*n;return 4*(0.5>n?e:3*(n-t)+e-0.75)}function Dr(n){return function(t){return Math.pow(t,n)}}function jr(n){return 1-Math.cos(n*Bo/2)}function Lr(n){return Math.pow(2,10*(n-1))}function Hr(n){return 1-Math.sqrt(1-n*n)}function Fr(n,t){var e;return arguments.length<2&&(t=0.45),arguments.length?e=t/(2*Bo)*Math.asin(1/n):(n=1,e=t/4),function(r){return 1+n*Math.pow(2,10*-r)*Math.sin(2*(r-e)*Bo/t)}}function Pr(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function Or(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+0.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+0.9375:7.5625*(n-=2.625/2.75)*n+0.984375}function Rr(n,t){n=mo.hcl(n),t=mo.hcl(t);var e=n.h,r=n.c,u=n.l,i=t.h-e,o=t.c-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return J(e+i*n,r+o*n,u+a*n)+""}}function Yr(n,t){n=mo.hsl(n),t=mo.hsl(t);var e=n.h,r=n.s,u=n.l,i=t.h-e,o=t.s-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return $(e+i*n,r+o*n,u+a*n)+""}}function Ir(n,t){n=mo.lab(n),t=mo.lab(t);var e=n.l,r=n.a,u=n.b,i=t.l-e,o=t.a-r,a=t.b-u;return function(n){return Q(e+i*n,r+o*n,u+a*n)+""}}function Ur(n,t){return t-=n,function(e){return Math.round(n+t*e)}}function Zr(n){var t=[n.a,n.b],e=[n.c,n.d],r=Xr(t),u=Vr(t,e),i=Xr($r(e,t,-u))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*Ko,this.translate=[n.e,n.f],this.scale=[r,i],this.skew=i?Math.atan2(u,i)*Ko:0}function Vr(n,t){return n[0]*t[0]+n[1]*t[1]}function Xr(n){var t=Math.sqrt(Vr(n,n));return t&&(n[0]/=t,n[1]/=t),t}function $r(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}function Br(n,t){var e,r=[],u=[],i=mo.transform(n),o=mo.transform(t),a=i.translate,c=o.translate,l=i.rotate,s=o.rotate,f=i.skew,h=o.skew,g=i.scale,p=o.scale;return a[0]!=c[0]||a[1]!=c[1]?(r.push("translate(",null,",",null,")"),u.push({i:1,x:wr(a[0],c[0])},{i:3,x:wr(a[1],c[1])})):c[0]||c[1]?r.push("translate("+c+")"):r.push(""),l!=s?(l-s>180?s+=360:s-l>180&&(l+=360),u.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:wr(l,s)})):s&&r.push(r.pop()+"rotate("+s+")"),f!=h?u.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:wr(f,h)}):h&&r.push(r.pop()+"skewX("+h+")"),g[0]!=p[0]||g[1]!=p[1]?(e=r.push(r.pop()+"scale(",null,",",null,")"),u.push({i:e-4,x:wr(g[0],p[0])},{i:e-2,x:wr(g[1],p[1])})):(1!=p[0]||1!=p[1])&&r.push(r.pop()+"scale("+p+")"),e=u.length,function(n){for(var t,i=-1;++i<e;){r[(t=u[i]).i]=t.x(n)}return r.join("")}}function Wr(n,t){return t=t-(n=+n)?1/(t-n):0,function(e){return(e-n)*t}}function Jr(n,t){return t=t-(n=+n)?1/(t-n):0,function(e){return Math.max(0,Math.min(1,(e-n)*t))}}function Gr(n){for(var t=n.source,e=n.target,r=Qr(t,e),u=[t];t!==r;){t=t.parent,u.push(t)}for(var i=u.length;e!==r;){u.splice(i,0,e),e=e.parent}return u}function Kr(n){for(var t=[],e=n.parent;null!=e;){t.push(n),n=e,e=e.parent}return t.push(n),t}function Qr(n,t){if(n===t){return n}for(var e=Kr(n),r=Kr(t),u=e.pop(),i=r.pop(),o=null;u===i;){o=u,u=e.pop(),i=r.pop()}return o}function nu(n){n.fixed|=2}function tu(n){n.fixed&=-7}function eu(n){n.fixed|=4,n.px=n.x,n.py=n.y}function ru(n){n.fixed&=-5}function uu(n,t,e){var r=0,u=0;if(n.charge=0,!n.leaf){for(var i,o=n.nodes,a=o.length,c=-1;++c<a;){i=o[c],null!=i&&(uu(i,t,e),n.charge+=i.charge,r+=i.charge*i.cx,u+=i.charge*i.cy)}}if(n.point){n.leaf||(n.point.x+=Math.random()-0.5,n.point.y+=Math.random()-0.5);var l=t*e[n.point.index];n.charge+=n.pointCharge=l,r+=l*n.point.x,u+=l*n.point.y}n.cx=r/n.charge,n.cy=u/n.charge}function iu(n,t){return mo.rebind(n,t,"sort","children","value"),n.nodes=n,n.links=lu,n}function ou(n){return n.children}function au(n){return n.value}function cu(n,t){return t.value-n.value}function lu(n){return mo.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function su(n){return n.x}function fu(n){return n.y}function hu(n,t,e){n.y0=t,n.y=e}function gu(n){return mo.range(n.length)}function pu(n){for(var t=-1,e=n[0].length,r=[];++t<e;){r[t]=0}return r}function du(n){for(var t,e=1,r=0,u=n[0][1],i=n.length;i>e;++e){(t=n[e][1])>u&&(r=e,u=t)}return r}function vu(n){return n.reduce(mu,0)}function mu(n,t){return n+t[1]}function yu(n,t){return Mu(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function Mu(n,t){for(var e=-1,r=+n[0],u=(n[1]-r)/t,i=[];++e<=t;){i[e]=u*e+r}return i}function xu(n){return[mo.min(n),mo.max(n)]}function bu(n,t){return n.parent==t.parent?1:2}function _u(n){var t=n.children;return t&&t.length?t[0]:n._tree.thread}function wu(n){var t,e=n.children;return e&&(t=e.length)?e[t-1]:n._tree.thread}function Su(n,t){var e=n.children;if(e&&(u=e.length)){for(var r,u,i=-1;++i<u;){t(r=Su(e[i],t),n)>0&&(n=r)}}return n}function Eu(n,t){return n.x-t.x}function ku(n,t){return t.x-n.x}function Au(n,t){return n.depth-t.depth}function Nu(n,t){function e(n,r){var u=n.children;if(u&&(o=u.length)){for(var i,o,a=null,c=-1;++c<o;){i=u[c],e(i,a),a=i}}t(n,r)}e(n,null)}function Tu(n){for(var t,e=0,r=0,u=n.children,i=u.length;--i>=0;){t=u[i]._tree,t.prelim+=e,t.mod+=e,e+=t.shift+(r+=t.change)}}function qu(n,t,e){n=n._tree,t=t._tree;var r=e/(t.number-n.number);n.change+=r,t.change-=r,t.shift+=e,t.prelim+=e,t.mod+=e}function zu(n,t,e){return n._tree.ancestor.parent==t.parent?n._tree.ancestor:e}function Cu(n,t){return n.value-t.value}function Du(n,t){var e=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=e,e._pack_prev=t}function ju(n,t){n._pack_next=t,t._pack_prev=n}function Lu(n,t){var e=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return 0.999*u*u>e*e+r*r}function Hu(n){function t(n){s=Math.min(n.x-n.r,s),f=Math.max(n.x+n.r,f),h=Math.min(n.y-n.r,h),g=Math.max(n.y+n.r,g)}if((e=n.children)&&(l=e.length)){var e,r,u,i,o,a,c,l,s=1/0,f=-1/0,h=1/0,g=-1/0;if(e.forEach(Fu),r=e[0],r.x=-r.r,r.y=0,t(r),l>1&&(u=e[1],u.x=u.r,u.y=0,t(u),l>2)){for(i=e[2],Ru(r,u,i),t(i),Du(r,i),r._pack_prev=i,Du(i,u),u=r._pack_next,o=3;l>o;o++){Ru(r,u,i=e[o]);var p=0,d=1,v=1;for(a=u._pack_next;a!==u;a=a._pack_next,d++){if(Lu(a,i)){p=1;break}}if(1==p){for(c=r._pack_prev;c!==a._pack_prev&&!Lu(c,i);c=c._pack_prev,v++){}}p?(v>d||d==v&&u.r<r.r?ju(r,u=a):ju(r=c,u),o--):(Du(r,i),u=i,t(i))}}var m=(s+f)/2,y=(h+g)/2,M=0;for(o=0;l>o;o++){i=e[o],i.x-=m,i.y-=y,M=Math.max(M,i.r+Math.sqrt(i.x*i.x+i.y*i.y))}n.r=M,e.forEach(Pu)}}function Fu(n){n._pack_next=n._pack_prev=n}function Pu(n){delete n._pack_next,delete n._pack_prev}function Ou(n,t,e,r){var u=n.children;if(n.x=t+=r*n.x,n.y=e+=r*n.y,n.r*=r,u){for(var i=-1,o=u.length;++i<o;){Ou(u[i],t,e,r)}}}function Ru(n,t,e){var r=n.r+e.r,u=t.x-n.x,i=t.y-n.y;if(r&&(u||i)){var o=t.r+e.r,a=u*u+i*i;o*=o,r*=r;var c=0.5+(r-o)/(2*a),l=Math.sqrt(Math.max(0,2*o*(r+a)-(r-=a)*r-o*o))/(2*a);e.x=n.x+c*u+l*i,e.y=n.y+c*i-l*u}else{e.x=n.x+r,e.y=n.y}}function Yu(n){return 1+mo.max(n,function(n){return n.y})}function Iu(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function Uu(n){var t=n.children;return t&&t.length?Uu(t[0]):n}function Zu(n){var t,e=n.children;return e&&(t=e.length)?Zu(e[t-1]):n}function Vu(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function Xu(n,t){var e=n.x+t[3],r=n.y+t[0],u=n.dx-t[1]-t[3],i=n.dy-t[0]-t[2];return 0>u&&(e+=u/2,u=0),0>i&&(r+=i/2,i=0),{x:e,y:r,dx:u,dy:i}}function $u(n){var t=n[0],e=n[n.length-1];return e>t?[t,e]:[e,t]}function Bu(n){return n.rangeExtent?n.rangeExtent():$u(n.range())}function Wu(n,t,e,r){var u=e(n[0],n[1]),i=r(t[0],t[1]);return function(n){return i(u(n))}}function Ju(n,t){var e,r=0,u=n.length-1,i=n[r],o=n[u];return i>o&&(e=r,r=u,u=e,e=i,i=o,o=e),n[r]=t.floor(i),n[u]=t.ceil(o),n}function Gu(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:Nc}function Ku(n,t,e,r){var u=[],i=[],o=0,a=Math.min(n.length,t.length)-1;for(n[a]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<=a;){u.push(e(n[o-1],n[o])),i.push(r(t[o-1],t[o]))}return function(t){var e=mo.bisect(n,t,1,a)-1;return i[e](u[e](t))}}function Qu(n,t,e,r){function u(){var u=Math.min(n.length,t.length)>2?Ku:Wu,c=r?Jr:Wr;return o=u(n,t,c,e),a=u(t,n,c,Er),i}function i(n){return o(n)}var o,a;return i.invert=function(n){return a(n)},i.domain=function(t){return arguments.length?(n=t.map(Number),u()):n},i.range=function(n){return arguments.length?(t=n,u()):t},i.rangeRound=function(n){return i.range(n).interpolate(Ur)},i.clamp=function(n){return arguments.length?(r=n,u()):r},i.interpolate=function(n){return arguments.length?(e=n,u()):e},i.ticks=function(t){return ri(n,t)},i.tickFormat=function(t,e){return ui(n,t,e)},i.nice=function(t){return ti(n,t),u()},i.copy=function(){return Qu(n,t,e,r)},u()}function ni(n,t){return mo.rebind(n,t,"range","rangeRound","interpolate","clamp")}function ti(n,t){return Ju(n,Gu(ei(n,t)[2]))}function ei(n,t){null==t&&(t=10);var e=$u(n),r=e[1]-e[0],u=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),i=t/r*u;return 0.15>=i?u*=10:0.35>=i?u*=5:0.75>=i&&(u*=2),e[0]=Math.ceil(e[0]/u)*u,e[1]=Math.floor(e[1]/u)*u+0.5*u,e[2]=u,e}function ri(n,t){return mo.range.apply(mo,ei(n,t))}function ui(n,t,e){var r=-Math.floor(Math.log(ei(n,t)[2])/Math.LN10+0.01);return mo.format(e?e.replace(Ea,function(n,t,e,u,i,o,a,c,l,s){return[t,e,u,i,o,a,c,l||"."+(r-2*("%"===s)),s].join("")}):",."+r+"f")}function ii(n,t,e,r){function u(n){return(e?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(t)}function i(n){return e?Math.pow(t,n):-Math.pow(t,-n)}function o(t){return n(u(t))}return o.invert=function(t){return i(n.invert(t))},o.domain=function(t){return arguments.length?(e=t[0]>=0,n.domain((r=t.map(Number)).map(u)),o):r},o.base=function(e){return arguments.length?(t=+e,n.domain(r.map(u)),o):t},o.nice=function(){var t=Ju(r.map(u),e?Math:qc);return n.domain(t),r=t.map(i),o},o.ticks=function(){var n=$u(r),o=[],a=n[0],c=n[1],l=Math.floor(u(a)),s=Math.ceil(u(c)),f=t%1?2:t;if(isFinite(s-l)){if(e){for(;s>l;l++){for(var h=1;f>h;h++){o.push(i(l)*h)}}o.push(i(l))}else{for(o.push(i(l));l++<s;){for(var h=f-1;h>0;h--){o.push(i(l)*h)}}}for(l=0;o[l]<a;l++){}for(s=o.length;o[s-1]>c;s--){}o=o.slice(l,s)}return o},o.tickFormat=function(n,t){if(!arguments.length){return Tc}arguments.length<2?t=Tc:"function"!=typeof t&&(t=mo.format(t));var r,a=Math.max(0.1,n/o.ticks().length),c=e?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(n){return n/i(c(u(n)+r))<=a?t(n):""}},o.copy=function(){return ii(n.copy(),t,e,r)},ni(o,n)}function oi(n,t,e){function r(t){return n(u(t))}var u=ai(t),i=ai(1/t);return r.invert=function(t){return i(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((e=t.map(Number)).map(u)),r):e},r.ticks=function(n){return ri(e,n)},r.tickFormat=function(n,t){return ui(e,n,t)},r.nice=function(n){return r.domain(ti(e,n))},r.exponent=function(o){return arguments.length?(u=ai(t=o),i=ai(1/t),n.domain(e.map(u)),r):t},r.copy=function(){return oi(n.copy(),t,e)},ni(r,n)}function ai(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function ci(n,t){function e(t){return o[((i.get(t)||i.set(t,n.push(t)))-1)%o.length]}function r(t,e){return mo.range(n.length).map(function(n){return t+e*n})}var i,o,a;return e.domain=function(r){if(!arguments.length){return n}n=[],i=new u;for(var o,a=-1,c=r.length;++a<c;){i.has(o=r[a])||i.set(o,n.push(o))}return e[t.t].apply(e,t.a)},e.range=function(n){return arguments.length?(o=n,a=0,t={t:"range",a:arguments},e):o},e.rangePoints=function(u,i){arguments.length<2&&(i=0);var c=u[0],l=u[1],s=(l-c)/(Math.max(1,n.length-1)+i);return o=r(n.length<2?(c+l)/2:c+s*i/2,s),a=0,t={t:"rangePoints",a:arguments},e},e.rangeBands=function(u,i,c){arguments.length<2&&(i=0),arguments.length<3&&(c=i);var l=u[1]<u[0],s=u[l-0],f=u[1-l],h=(f-s)/(n.length-i+2*c);return o=r(s+h*c,h),l&&o.reverse(),a=h*(1-i),t={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(u,i,c){arguments.length<2&&(i=0),arguments.length<3&&(c=i);var l=u[1]<u[0],s=u[l-0],f=u[1-l],h=Math.floor((f-s)/(n.length-i+2*c)),g=f-s-(n.length-i)*h;return o=r(s+Math.round(g/2),h),l&&o.reverse(),a=Math.round(h*(1-i)),t={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return a},e.rangeExtent=function(){return $u(t.a[0])},e.copy=function(){return ci(n,t)},e.domain(n)}function li(n,t){function e(){var e=0,i=t.length;for(u=[];++e<i;){u[e-1]=mo.quantile(n,e/i)}return r}function r(n){return isNaN(n=+n)?void 0:t[mo.bisect(u,n)]}var u;return r.domain=function(t){return arguments.length?(n=t.filter(function(n){return !isNaN(n)}).sort(mo.ascending),e()):n},r.range=function(n){return arguments.length?(t=n,e()):t},r.quantiles=function(){return u},r.invertExtent=function(e){return e=t.indexOf(e),0>e?[0/0,0/0]:[e>0?u[e-1]:n[0],e<u.length?u[e]:n[n.length-1]]},r.copy=function(){return li(n,t)},e()}function si(n,t,e){function r(t){return e[Math.max(0,Math.min(o,Math.floor(i*(t-n))))]}function u(){return i=e.length/(t-n),o=e.length-1,r}var i,o;return r.domain=function(e){return arguments.length?(n=+e[0],t=+e[e.length-1],u()):[n,t]},r.range=function(n){return arguments.length?(e=n,u()):e},r.invertExtent=function(t){return t=e.indexOf(t),t=0>t?0/0:t/i+n,[t,t+1/i]},r.copy=function(){return si(n,t,e)},u()}function fi(n,t){function e(e){return e>=e?t[mo.bisect(n,e)]:void 0}return e.domain=function(t){return arguments.length?(n=t,e):n},e.range=function(n){return arguments.length?(t=n,e):t},e.invertExtent=function(e){return e=t.indexOf(e),[n[e-1],n[e]]},e.copy=function(){return fi(n,t)},e}function hi(n){function t(n){return +n}return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=e.map(t),t):n},t.ticks=function(t){return ri(n,t)},t.tickFormat=function(t,e){return ui(n,t,e)},t.copy=function(){return hi(n)},t}function gi(n){return n.innerRadius}function pi(n){return n.outerRadius}function di(n){return n.startAngle}function vi(n){return n.endAngle}function mi(n){for(var t,e,r,u=-1,i=n.length;++u<i;){t=n[u],e=t[0],r=t[1]+Lc,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r)}return n}function yi(n){function t(t){function c(){d.push("M",a(n(m),f),s,l(n(v.reverse()),f),"Z")}for(var h,g,p,d=[],v=[],m=[],y=-1,M=t.length,x=pt(e),b=pt(u),_=e===r?function(){return g}:pt(r),w=u===i?function(){return p}:pt(i);++y<M;){o.call(this,h=t[y],y)?(v.push([g=+x.call(this,h,y),p=+b.call(this,h,y)]),m.push([+_.call(this,h,y),+w.call(this,h,y)])):v.length&&(c(),v=[],m=[])}return v.length&&c(),d.length?d.join(""):null}var e=Ze,r=Ze,u=0,i=Ve,o=Vt,a=Xe,c=a.key,l=a,s="L",f=0.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(u=i=n,t):i},t.y0=function(n){return arguments.length?(u=n,t):u},t.y1=function(n){return arguments.length?(i=n,t):i},t.defined=function(n){return arguments.length?(o=n,t):o},t.interpolate=function(n){return arguments.length?(c="function"==typeof n?a=n:(a=hc.get(n)||Xe).key,l=a.reverse||a,s=a.closed?"M":"L",t):c},t.tension=function(n){return arguments.length?(f=n,t):f},t}function Mi(n){return n.radius}function xi(n){return[n.x,n.y]}function bi(n){return function(){var t=n.apply(this,arguments),e=t[0],r=t[1]+Lc;return[e*Math.cos(r),e*Math.sin(r)]}}function _i(){return 64}function wi(){return"circle"}function Si(n){var t=Math.sqrt(n/Bo);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Ei(n,t){return Lo(n,Ic),n.id=t,n}function ki(n,t,e,r){var u=n.id;return N(n,"function"==typeof e?function(n,i,o){n.__transition__[u].tween.set(t,r(e.call(n,n.__data__,i,o)))}:(e=r(e),function(n){n.__transition__[u].tween.set(t,e)}))}function Ai(n){return null==n&&(n=""),function(){this.textContent=n}}function Ni(n,t,e,r){var i=n.__transition__||(n.__transition__={active:0,count:0}),o=i[e];if(!o){var a=r.time;o=i[e]={tween:new u,time:a,ease:r.ease,delay:r.delay,duration:r.duration},++i.count,mo.timer(function(r){function u(r){return i.active>e?l():(i.active=e,o.event&&o.event.start.call(n,s,t),o.tween.forEach(function(e,r){(r=r.call(n,s,t))&&p.push(r)}),c(r)?1:(xt(c,0,a),void 0))}function c(r){if(i.active!==e){return l()}for(var u=(r-h)/g,a=f(u),c=p.length;c>0;){p[--c].call(n,a)}return u>=1?(o.event&&o.event.end.call(n,s,t),l()):void 0}function l(){return --i.count?delete i[e]:delete n.__transition__,1}var s=n.__data__,f=o.ease,h=o.delay,g=o.duration,p=[];return r>=h?u(r):(xt(u,h,a),void 0)},0,a)}}function Ti(n,t){n.attr("transform",function(n){return"translate("+t(n)+",0)"})}function qi(n,t){n.attr("transform",function(n){return"translate(0,"+t(n)+")"})}function zi(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ci(n,t,e){function r(t){var e=n(t),r=i(e,1);return r-t>t-e?e:r}function u(e){return t(e=n(new Wc(e-1)),1),e}function i(n,e){return t(n=new Wc(+n),e),n}function o(n,r,i){var o=u(n),a=[];if(i>1){for(;r>o;){e(o)%i||a.push(new Date(+o)),t(o,1)}}else{for(;r>o;){a.push(new Date(+o)),t(o,1)}}return a}function a(n,t,e){try{Wc=zi;var r=new zi;return r._=n,o(r,t,e)}finally{Wc=Date}}n.floor=n,n.round=r,n.ceil=u,n.offset=i,n.range=o;var c=n.utc=Di(n);return c.floor=c,c.round=Di(r),c.ceil=Di(u),c.offset=Di(i),c.range=a,n}function Di(n){return function(t,e){try{Wc=zi;var r=new zi;return r._=t,n(r,e)._}finally{Wc=Date}}}function ji(n){function t(t){for(var r,u,i,o=[],a=-1,c=0;++a<e;){37===n.charCodeAt(a)&&(o.push(n.substring(c,a)),null!=(u=pl[r=n.charAt(++a)])&&(r=n.charAt(++a)),(i=dl[r])&&(r=i(t,null==u?"e"===r?" ":"0":u)),o.push(r),c=a+1)}return o.push(n.substring(c,a)),o.join("")}var e=n.length;return t.parse=function(t){var e={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},r=Li(e,n,t,0);if(r!=t.length){return null}"p" in e&&(e.H=e.H%12+12*e.p);var u=null!=e.Z&&Wc!==zi,i=new (u?zi:Wc);return"j" in e?i.setFullYear(e.y,0,e.j):"w" in e&&("W" in e||"U" in e)?(i.setFullYear(e.y,0,1),i.setFullYear(e.y,0,"W" in e?(e.w+6)%7+7*e.W-(i.getDay()+5)%7:e.w+7*e.U-(i.getDay()+6)%7)):i.setFullYear(e.y,e.m,e.d),i.setHours(e.H+Math.floor(e.Z/100),e.M+e.Z%100,e.S,e.L),u?i._:i},t.toString=function(){return n},t}function Li(n,t,e,r){for(var u,i,o,a=0,c=t.length,l=e.length;c>a;){if(r>=l){return -1}if(u=t.charCodeAt(a++),37===u){if(o=t.charAt(a++),i=vl[o in pl?t.charAt(a++):o],!i||(r=i(n,e,r))<0){return -1}}else{if(u!=e.charCodeAt(r++)){return -1}}}return r}function Hi(n){return new RegExp("^(?:"+n.map(mo.requote).join("|")+")","i")}function Fi(n){for(var t=new u,e=-1,r=n.length;++e<r;){t.set(n[e].toLowerCase(),e)}return t}function Pi(n,t,e){var r=0>n?"-":"",u=(r?-n:n)+"",i=u.length;return r+(e>i?new Array(e-i+1).join(t)+u:u)}function Oi(n,t,e){al.lastIndex=0;var r=al.exec(t.substring(e));return r?(n.w=cl.get(r[0].toLowerCase()),e+r[0].length):-1}function Ri(n,t,e){il.lastIndex=0;var r=il.exec(t.substring(e));return r?(n.w=ol.get(r[0].toLowerCase()),e+r[0].length):-1}function Yi(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Ii(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e));return r?(n.U=+r[0],e+r[0].length):-1}function Ui(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e));return r?(n.W=+r[0],e+r[0].length):-1}function Zi(n,t,e){fl.lastIndex=0;var r=fl.exec(t.substring(e));return r?(n.m=hl.get(r[0].toLowerCase()),e+r[0].length):-1}function Vi(n,t,e){ll.lastIndex=0;var r=ll.exec(t.substring(e));return r?(n.m=sl.get(r[0].toLowerCase()),e+r[0].length):-1}function Xi(n,t,e){return Li(n,dl.c.toString(),t,e)}function $i(n,t,e){return Li(n,dl.x.toString(),t,e)}function Bi(n,t,e){return Li(n,dl.X.toString(),t,e)}function Wi(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Ji(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e,e+2));return r?(n.y=Ki(+r[0]),e+r[0].length):-1}function Gi(n,t,e){return/^[+-]\d{4}$/.test(t=t.substring(e,e+5))?(n.Z=+t,e+5):-1}function Ki(n){return n+(n>68?1900:2000)}function Qi(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function no(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function to(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function eo(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function ro(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function uo(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function io(n,t,e){ml.lastIndex=0;var r=ml.exec(t.substring(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function oo(n,t,e){var r=yl.get(t.substring(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)}function ao(n){var t=n.getTimezoneOffset(),e=t>0?"-":"+",r=~~(Math.abs(t)/60),u=Math.abs(t)%60;return e+Pi(r,"0",2)+Pi(u,"0",2)}function co(n,t,e){gl.lastIndex=0;var r=gl.exec(t.substring(e,e+1));return r?e+r[0].length:-1}function lo(n){function t(n){try{Wc=zi;var t=new Wc;return t._=n,e(t)}finally{Wc=Date}}var e=ji(n);return t.parse=function(n){try{Wc=zi;var t=e.parse(n);return t&&t._}finally{Wc=Date}},t.toString=e.toString,t}function so(n){return n.toISOString()}function fo(n,t,e){function r(t){return n(t)}function u(n,e){var r=n[1]-n[0],u=r/e,i=mo.bisect(xl,u);return i==xl.length?[t.year,ei(n.map(function(n){return n/31536000000}),e)[2]]:i?t[u/xl[i-1]<xl[i]/u?i-1:i]:[Sl,ei(n,e)[2]]}return r.invert=function(t){return ho(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain(t),r):n.domain().map(ho)},r.nice=function(n,t){function e(e){return !isNaN(e)&&!n.range(e,ho(+e+1),t).length}var i=r.domain(),o=$u(i),a=null==n?u(o,10):"number"==typeof n&&u(o,n);return a&&(n=a[0],t=a[1]),r.domain(Ju(i,t>1?{floor:function(t){for(;e(t=n.floor(t));){t=ho(t-1)}return t},ceil:function(t){for(;e(t=n.ceil(t));){t=ho(+t+1)}return t}}:n))},r.ticks=function(n,t){var e=$u(r.domain()),i=null==n?u(e,10):"number"==typeof n?u(e,n):!n.range&&[{range:n},t];return i&&(n=i[0],t=i[1]),n.range(e[0],ho(+e[1]+1),t)},r.tickFormat=function(){return e},r.copy=function(){return fo(n.copy(),t,e)},ni(r,n)}function ho(n){return new Date(n)}function go(n){return function(t){for(var e=n.length-1,r=n[e];!r[1](t);){r=n[--e]}return r[0](t)}}function po(n){return JSON.parse(n.responseText)}function vo(n){var t=xo.createRange();return t.selectNode(xo.body),t.createContextualFragment(n.responseText)}var mo={version:"3.3.3"};Date.now||(Date.now=function(){return +new Date});var yo=[].slice,Mo=function(n){return yo.call(n)},xo=document,bo=xo.documentElement,_o=window;try{Mo(bo.childNodes)[0].nodeType}catch(wo){Mo=function(n){for(var t=n.length,e=new Array(t);t--;){e[t]=n[t]}return e}}try{xo.createElement("div").style.setProperty("opacity",0,"")}catch(So){var Eo=_o.Element.prototype,ko=Eo.setAttribute,Ao=Eo.setAttributeNS,No=_o.CSSStyleDeclaration.prototype,To=No.setProperty;Eo.setAttribute=function(n,t){ko.call(this,n,t+"")},Eo.setAttributeNS=function(n,t,e){Ao.call(this,n,t,e+"")},No.setProperty=function(n,t,e){To.call(this,n,t+"",e)}}mo.ascending=function(n,t){return t>n?-1:n>t?1:n>=t?0:0/0},mo.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:0/0},mo.min=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i&&!(null!=(e=n[u])&&e>=e);){e=void 0}for(;++u<i;){null!=(r=n[u])&&e>r&&(e=r)}}else{for(;++u<i&&!(null!=(e=t.call(n,n[u],u))&&e>=e);){e=void 0}for(;++u<i;){null!=(r=t.call(n,n[u],u))&&e>r&&(e=r)}}return e},mo.max=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i&&!(null!=(e=n[u])&&e>=e);){e=void 0}for(;++u<i;){null!=(r=n[u])&&r>e&&(e=r)}}else{for(;++u<i&&!(null!=(e=t.call(n,n[u],u))&&e>=e);){e=void 0}for(;++u<i;){null!=(r=t.call(n,n[u],u))&&r>e&&(e=r)}}return e},mo.extent=function(n,t){var e,r,u,i=-1,o=n.length;if(1===arguments.length){for(;++i<o&&!(null!=(e=u=n[i])&&e>=e);){e=u=void 0}for(;++i<o;){null!=(r=n[i])&&(e>r&&(e=r),r>u&&(u=r))}}else{for(;++i<o&&!(null!=(e=u=t.call(n,n[i],i))&&e>=e);){e=void 0}for(;++i<o;){null!=(r=t.call(n,n[i],i))&&(e>r&&(e=r),r>u&&(u=r))}}return[e,u]},mo.sum=function(n,t){var e,r=0,u=n.length,i=-1;if(1===arguments.length){for(;++i<u;){isNaN(e=+n[i])||(r+=e)}}else{for(;++i<u;){isNaN(e=+t.call(n,n[i],i))||(r+=e)}}return r},mo.mean=function(t,e){var r,u=t.length,i=0,o=-1,a=0;if(1===arguments.length){for(;++o<u;){n(r=t[o])&&(i+=(r-i)/++a)}}else{for(;++o<u;){n(r=e.call(t,t[o],o))&&(i+=(r-i)/++a)}}return a?i:void 0},mo.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),u=+n[r-1],i=e-r;return i?u+i*(n[r]-u):u},mo.median=function(t,e){return arguments.length>1&&(t=t.map(e)),t=t.filter(n),t.length?mo.quantile(t.sort(mo.ascending),0.5):void 0},mo.bisector=function(n){return{left:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n.call(t,t[i],i)<e?r=i+1:u=i}return r},right:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;e<n.call(t,t[i],i)?u=i:r=i+1}return r}}};var qo=mo.bisector(function(n){return n});mo.bisectLeft=qo.left,mo.bisect=mo.bisectRight=qo.right,mo.shuffle=function(n){for(var t,e,r=n.length;r;){e=0|Math.random()*r--,t=n[r],n[r]=n[e],n[e]=t}return n},mo.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;){r[e]=n[t[e]]}return r},mo.pairs=function(n){for(var t,e=0,r=n.length-1,u=n[0],i=new Array(0>r?0:r);r>e;){i[e]=[t=u,u=n[++e]]}return i},mo.zip=function(){if(!(u=arguments.length)){return[]}for(var n=-1,e=mo.min(arguments,t),r=new Array(e);++n<e;){for(var u,i=-1,o=r[n]=new Array(u);++i<u;){o[i]=arguments[i][n]}}return r},mo.transpose=function(n){return mo.zip.apply(mo,n)},mo.keys=function(n){var t=[];for(var e in n){t.push(e)}return t},mo.values=function(n){var t=[];for(var e in n){t.push(n[e])}return t},mo.entries=function(n){var t=[];for(var e in n){t.push({key:e,value:n[e]})}return t},mo.merge=function(n){return Array.prototype.concat.apply([],n)},mo.range=function(n,t,r){if(arguments.length<3&&(r=1,arguments.length<2&&(t=n,n=0)),1/0===(t-n)/r){throw new Error("infinite range")}var u,i=[],o=e(Math.abs(r)),a=-1;if(n*=o,t*=o,r*=o,0>r){for(;(u=n+r*++a)>t;){i.push(u/o)}}else{for(;(u=n+r*++a)<t;){i.push(u/o)}}return i},mo.map=function(n){var t=new u;if(n instanceof u){n.forEach(function(n,e){t.set(n,e)})}else{for(var e in n){t.set(e,n[e])}}return t},r(u,{has:function(n){return zo+n in this},get:function(n){return this[zo+n]},set:function(n,t){return this[zo+n]=t},remove:function(n){return n=zo+n,n in this&&delete this[n]},keys:function(){var n=[];return this.forEach(function(t){n.push(t)}),n},values:function(){var n=[];return this.forEach(function(t,e){n.push(e)}),n},entries:function(){var n=[];return this.forEach(function(t,e){n.push({key:t,value:e})}),n},forEach:function(n){for(var t in this){t.charCodeAt(0)===Co&&n.call(this,t.substring(1),this[t])}}});var zo="\0",Co=zo.charCodeAt(0);mo.nest=function(){function n(t,a,c){if(c>=o.length){return r?r.call(i,a):e?a.sort(e):a}for(var l,s,f,h,g=-1,p=a.length,d=o[c++],v=new u;++g<p;){(h=v.get(l=d(s=a[g])))?h.push(s):v.set(l,[s])}return t?(s=t(),f=function(e,r){s.set(e,n(t,r,c))}):(s={},f=function(e,r){s[e]=n(t,r,c)}),v.forEach(f),s}function t(n,e){if(e>=o.length){return n}var r=[],u=a[e++];return n.forEach(function(n,u){r.push({key:n,values:t(u,e)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var e,r,i={},o=[],a=[];return i.map=function(t,e){return n(e,t,0)},i.entries=function(e){return t(n(mo.map,e,0),0)},i.key=function(n){return o.push(n),i},i.sortKeys=function(n){return a[o.length-1]=n,i},i.sortValues=function(n){return e=n,i},i.rollup=function(n){return r=n,i},i},mo.set=function(n){var t=new i;if(n){for(var e=0,r=n.length;r>e;++e){t.add(n[e])}}return t},r(i,{has:function(n){return zo+n in this},add:function(n){return this[zo+n]=!0,n},remove:function(n){return n=zo+n,n in this&&delete this[n]},values:function(){var n=[];return this.forEach(function(t){n.push(t)}),n},forEach:function(n){for(var t in this){t.charCodeAt(0)===Co&&n.call(this,t.substring(1))}}}),mo.behavior={},mo.rebind=function(n,t){for(var e,r=1,u=arguments.length;++r<u;){n[e=arguments[r]]=o(n,t,t[e])}return n};var Do=["webkit","ms","moz","Moz","o","O"];mo.dispatch=function(){for(var n=new l,t=-1,e=arguments.length;++t<e;){n[arguments[t]]=s(n)}return n},l.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(e>=0&&(r=n.substring(e+1),n=n.substring(0,e)),n){return arguments.length<2?this[n].on(r):this[n].on(r,t)}if(2===arguments.length){if(null==t){for(n in this){this.hasOwnProperty(n)&&this[n].on(r,null)}}return this}},mo.event=null,mo.requote=function(n){return n.replace(jo,"\\$&")};var jo=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,Lo={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t){n[e]=t[e]}},Ho=function(n,t){return t.querySelector(n)},Fo=function(n,t){return t.querySelectorAll(n)},Po=bo[a(bo,"matchesSelector")],Oo=function(n,t){return Po.call(n,t)};"function"==typeof Sizzle&&(Ho=function(n,t){return Sizzle(n,t)[0]||null},Fo=function(n,t){return Sizzle.uniqueSort(Sizzle(n,t))},Oo=Sizzle.matchesSelector),mo.selection=function(){return Uo};var Ro=mo.selection.prototype=[];Ro.select=function(n){var t,e,r,u,i=[];n=d(n);for(var o=-1,a=this.length;++o<a;){i.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var c=-1,l=r.length;++c<l;){(u=r[c])?(t.push(e=n.call(u,u.__data__,c,o)),e&&"__data__" in u&&(e.__data__=u.__data__)):t.push(null)}}return p(i)},Ro.selectAll=function(n){var t,e,r=[];n=v(n);for(var u=-1,i=this.length;++u<i;){for(var o=this[u],a=-1,c=o.length;++a<c;){(e=o[a])&&(r.push(t=Mo(n.call(e,e.__data__,a,u))),t.parentNode=e)}}return p(r)};var Yo={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};mo.ns={prefix:Yo,qualify:function(n){var t=n.indexOf(":"),e=n;return t>=0&&(e=n.substring(0,t),n=n.substring(t+1)),Yo.hasOwnProperty(e)?{space:Yo[e],local:n}:n}},Ro.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return n=mo.ns.qualify(n),n.local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n){this.each(m(t,n[t]))}return this}return this.each(m(n,t))},Ro.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=n.trim().split(/^|\s+/g)).length,u=-1;if(t=e.classList){for(;++u<r;){if(!t.contains(n[u])){return !1}}}else{for(t=e.getAttribute("class");++u<r;){if(!M(n[u]).test(t)){return !1}}}return !0}for(t in n){this.each(x(t,n[t]))}return this}return this.each(x(n,t))},Ro.style=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t="");for(e in n){this.each(_(e,n[e],t))}return this}if(2>r){return _o.getComputedStyle(this.node(),null).getPropertyValue(n)}e=""}return this.each(_(n,t,e))},Ro.property=function(n,t){if(arguments.length<2){if("string"==typeof n){return this.node()[n]}for(t in n){this.each(w(t,n[t]))}return this}return this.each(w(n,t))},Ro.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},Ro.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},Ro.append=function(n){return n=S(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},Ro.insert=function(n,t){return n=S(n),t=d(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments))})},Ro.remove=function(){return this.each(function(){var n=this.parentNode;n&&n.removeChild(this)})},Ro.data=function(n,t){function e(n,e){var r,i,o,a=n.length,f=e.length,h=Math.min(a,f),g=new Array(f),p=new Array(f),d=new Array(a);if(t){var v,m=new u,y=new u,M=[];for(r=-1;++r<a;){v=t.call(i=n[r],i.__data__,r),m.has(v)?d[r]=i:m.set(v,i),M.push(v)}for(r=-1;++r<f;){v=t.call(e,o=e[r],r),(i=m.get(v))?(g[r]=i,i.__data__=o):y.has(v)||(p[r]=E(o)),y.set(v,o),m.remove(v)}for(r=-1;++r<a;){m.has(M[r])&&(d[r]=n[r])}}else{for(r=-1;++r<h;){i=n[r],o=e[r],i?(i.__data__=o,g[r]=i):p[r]=E(o)}for(;f>r;++r){p[r]=E(e[r])}for(;a>r;++r){d[r]=n[r]}}p.update=g,p.parentNode=g.parentNode=d.parentNode=n.parentNode,c.push(p),l.push(g),s.push(d)}var r,i,o=-1,a=this.length;if(!arguments.length){for(n=new Array(a=(r=this[0]).length);++o<a;){(i=r[o])&&(n[o]=i.__data__)}return n}var c=T([]),l=p([]),s=p([]);if("function"==typeof n){for(;++o<a;){e(r=this[o],n.call(r,r.parentNode.__data__,o))}}else{for(;++o<a;){e(r=this[o],n)}}return l.enter=function(){return c},l.exit=function(){return s},l},Ro.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},Ro.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=k(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]),t.parentNode=(e=this[i]).parentNode;for(var a=0,c=e.length;c>a;a++){(r=e[a])&&n.call(r,r.__data__,a)&&t.push(r)}}return p(u)},Ro.order=function(){for(var n=-1,t=this.length;++n<t;){for(var e,r=this[n],u=r.length-1,i=r[u];--u>=0;){(e=r[u])&&(i&&i!==e.nextSibling&&i.parentNode.insertBefore(e,i),i=e)}}return this},Ro.sort=function(n){n=A.apply(this,arguments);for(var t=-1,e=this.length;++t<e;){this[t].sort(n)}return this.order()},Ro.each=function(n){return N(this,function(t,e,r){n.call(t,t.__data__,e,r)})},Ro.call=function(n){var t=Mo(arguments);return n.apply(t[0]=this,t),this},Ro.empty=function(){return !this.node()},Ro.node=function(){for(var n=0,t=this.length;t>n;n++){for(var e=this[n],r=0,u=e.length;u>r;r++){var i=e[r];if(i){return i}}}return null},Ro.size=function(){var n=0;return this.each(function(){++n}),n};var Io=[];mo.selection.enter=T,mo.selection.enter.prototype=Io,Io.append=Ro.append,Io.empty=Ro.empty,Io.node=Ro.node,Io.call=Ro.call,Io.size=Ro.size,Io.select=function(n){for(var t,e,r,u,i,o=[],a=-1,c=this.length;++a<c;){r=(u=this[a]).update,o.push(t=[]),t.parentNode=u.parentNode;for(var l=-1,s=u.length;++l<s;){(i=u[l])?(t.push(r[l]=e=n.call(u.parentNode,i.__data__,l,a)),e.__data__=i.__data__):t.push(null)}}return p(o)},Io.insert=function(n,t){return arguments.length<2&&(t=q(this)),Ro.insert.call(this,n,t)},Ro.transition=function(){for(var n,t,e=Pc||++Uc,r=[],u=Oc||{time:Date.now(),ease:Cr,delay:0,duration:250},i=-1,o=this.length;++i<o;){r.push(n=[]);for(var a=this[i],c=-1,l=a.length;++c<l;){(t=a[c])&&Ni(t,c,e,u),n.push(t)}}return Ei(r,e)},Ro.interrupt=function(){return this.each(z)},mo.select=function(n){var t=["string"==typeof n?Ho(n,xo):n];return t.parentNode=bo,p([t])},mo.selectAll=function(n){var t=Mo("string"==typeof n?Fo(n,xo):n);return t.parentNode=bo,p([t])};var Uo=mo.select(bo);Ro.on=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(e in n){this.each(C(e,n[e],t))}return this}if(2>r){return(r=this.node()["__on"+n])&&r._}e=!1}return this.each(C(n,t,e))};var Zo=mo.map({mouseenter:"mouseover",mouseleave:"mouseout"});Zo.forEach(function(n){"on"+n in xo&&Zo.remove(n)});var Vo=a(bo.style,"userSelect"),Xo=0;mo.mouse=function(n){return H(n,h())};var $o=/WebKit/.test(_o.navigator.userAgent)?-1:0;mo.touches=function(n,t){return arguments.length<2&&(t=h().touches),t?Mo(t).map(function(t){var e=H(n,t);return e.identifier=t.identifier,e}):[]},mo.behavior.drag=function(){function n(){this.on("mousedown.drag",o).on("touchstart.drag",a)}function t(){return mo.event.changedTouches[0].identifier}function e(n,t){return mo.touches(n).filter(function(n){return n.identifier===t})[0]}function r(n,t,e,r){return function(){function o(){if(!s){return a()}var n=t(s,g),e=n[0]-d[0],r=n[1]-d[1];v|=e|r,d=n,f({type:"drag",x:n[0]+c[0],y:n[1]+c[1],dx:e,dy:r})}function a(){m.on(e+"."+p,null).on(r+"."+p,null),y(v&&mo.event.target===h),f({type:"dragend"})}var c,l=this,s=l.parentNode,f=u.of(l,arguments),h=mo.event.target,g=n(),p=null==g?"drag":"drag-"+g,d=t(s,g),v=0,m=mo.select(_o).on(e+"."+p,o).on(r+"."+p,a),y=L();i?(c=i.apply(l,arguments),c=[c.x-d[0],c.y-d[1]]):c=[0,0],f({type:"dragstart"})}}var u=g(n,"drag","dragstart","dragend"),i=null,o=r(c,mo.mouse,"mousemove","mouseup"),a=r(t,e,"touchmove","touchend");return n.origin=function(t){return arguments.length?(i=t,n):i},mo.rebind(n,u,"on")};var Bo=Math.PI,Wo=0.000001,Jo=Wo*Wo,Go=Bo/180,Ko=180/Bo,Qo=Math.SQRT2,na=2,ta=4;mo.interpolateZoom=function(n,t){function e(n){var t=n*y;if(m){var e=Y(d),o=i/(na*h)*(e*I(Qo*t+d)-R(d));return[r+o*l,u+o*s,i*e/Y(Qo*t+d)]}return[r+n*l,u+n*s,i*Math.exp(Qo*t)]}var r=n[0],u=n[1],i=n[2],o=t[0],a=t[1],c=t[2],l=o-r,s=a-u,f=l*l+s*s,h=Math.sqrt(f),g=(c*c-i*i+ta*f)/(2*i*na*h),p=(c*c-i*i-ta*f)/(2*c*na*h),d=Math.log(Math.sqrt(g*g+1)-g),v=Math.log(Math.sqrt(p*p+1)-p),m=v-d,y=(m||Math.log(c/i))/Qo;return e.duration=1000*y,e},mo.behavior.zoom=function(){function n(n){n.on(A,l).on(ua+".zoom",h).on(N,p).on("dblclick.zoom",d).on(q,s)}function t(n){return[(n[0]-S.x)/S.k,(n[1]-S.y)/S.k]}function e(n){return[n[0]*S.k+S.x,n[1]*S.k+S.y]}function r(n){S.k=Math.max(k[0],Math.min(k[1],n))}function u(n,t){t=e(t),S.x+=n[0]-t[0],S.y+=n[1]-t[1]}function i(){b&&b.domain(x.range().map(function(n){return(n-S.x)/S.k}).map(x.invert)),w&&w.domain(_.range().map(function(n){return(n-S.y)/S.k}).map(_.invert))}function o(n){n({type:"zoomstart"})}function a(n){i(),n({type:"zoom",scale:S.k,translate:[S.x,S.y]})}function c(n){n({type:"zoomend"})}function l(){function n(){s=1,u(mo.mouse(r),h),a(i)}function e(){f.on(N,_o===r?p:null).on(T,null),g(s&&mo.event.target===l),c(i)}var r=this,i=C.of(r,arguments),l=mo.event.target,s=0,f=mo.select(_o).on(N,n).on(T,e),h=t(mo.mouse(r)),g=L();z.call(r),o(i)}function s(){function n(){var n=mo.touches(p);return g=S.k,n.forEach(function(n){n.identifier in v&&(v[n.identifier]=t(n))}),n}function e(){for(var t=mo.event.changedTouches,e=0,i=t.length;i>e;++e){v[t[e].identifier]=null}var o=n(),c=Date.now();if(1===o.length){if(500>c-M){var l=o[0],s=v[l.identifier];r(2*S.k),u(l,s),f(),a(d)}M=c}else{if(o.length>1){var l=o[0],h=o[1],g=l[0]-h[0],p=l[1]-h[1];m=g*g+p*p}}}function i(){for(var n,t,e,i,o=mo.touches(p),c=0,l=o.length;l>c;++c,i=null){if(e=o[c],i=v[e.identifier]){if(t){break}n=e,t=i}}if(i){var s=(s=e[0]-n[0])*s+(s=e[1]-n[1])*s,f=m&&Math.sqrt(s/m);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+i[0])/2,(t[1]+i[1])/2],r(f*g)}M=null,u(n,t),a(d)}function h(){if(mo.event.touches.length){for(var t=mo.event.changedTouches,e=0,r=t.length;r>e;++e){delete v[t[e].identifier]}for(var u in v){return void n()}}_.on(x,null).on(b,null),w.on(A,l).on(q,s),E(),c(d)}var g,p=this,d=C.of(p,arguments),v={},m=0,y=mo.event.changedTouches[0].identifier,x="touchmove.zoom-"+y,b="touchend.zoom-"+y,_=mo.select(_o).on(x,i).on(b,h),w=mo.select(p).on(A,null).on(q,e),E=L();z.call(p),e(),o(d)}function h(){var n=C.of(this,arguments);y?clearTimeout(y):(z.call(this),o(n)),y=setTimeout(function(){y=null,c(n)},50),f();var e=m||mo.mouse(this);v||(v=t(e)),r(Math.pow(2,0.002*ea())*S.k),u(e,v),a(n)}function p(){v=null}function d(){var n=C.of(this,arguments),e=mo.mouse(this),i=t(e),l=Math.log(S.k)/Math.LN2;o(n),r(Math.pow(2,mo.event.shiftKey?Math.ceil(l)-1:Math.floor(l)+1)),u(e,i),a(n),c(n)}var v,m,y,M,x,b,_,w,S={x:0,y:0,k:1},E=[960,500],k=ra,A="mousedown.zoom",N="mousemove.zoom",T="mouseup.zoom",q="touchstart.zoom",C=g(n,"zoomstart","zoom","zoomend");return n.event=function(n){n.each(function(){var n=C.of(this,arguments),t=S;Pc?mo.select(this).transition().each("start.zoom",function(){S=this.__chart__||{x:0,y:0,k:1},o(n)}).tween("zoom:zoom",function(){var e=E[0],r=E[1],u=e/2,i=r/2,o=mo.interpolateZoom([(u-S.x)/S.k,(i-S.y)/S.k,e/S.k],[(u-t.x)/t.k,(i-t.y)/t.k,e/t.k]);return function(t){var r=o(t),c=e/r[2];this.__chart__=S={x:u-r[0]*c,y:i-r[1]*c,k:c},a(n)}}).each("end.zoom",function(){c(n)}):(this.__chart__=S,o(n),a(n),c(n))})},n.translate=function(t){return arguments.length?(S={x:+t[0],y:+t[1],k:S.k},i(),n):[S.x,S.y]},n.scale=function(t){return arguments.length?(S={x:S.x,y:S.y,k:+t},i(),n):S.k},n.scaleExtent=function(t){return arguments.length?(k=null==t?ra:[+t[0],+t[1]],n):k},n.center=function(t){return arguments.length?(m=t&&[+t[0],+t[1]],n):m},n.size=function(t){return arguments.length?(E=t&&[+t[0],+t[1]],n):E},n.x=function(t){return arguments.length?(b=t,x=t.copy(),S={x:0,y:0,k:1},n):b},n.y=function(t){return arguments.length?(w=t,_=t.copy(),S={x:0,y:0,k:1},n):w},mo.rebind(n,C,"on")};var ea,ra=[0,1/0],ua="onwheel" in xo?(ea=function(){return -mo.event.deltaY*(mo.event.deltaMode?120:1)},"wheel"):"onmousewheel" in xo?(ea=function(){return mo.event.wheelDelta},"mousewheel"):(ea=function(){return -mo.event.detail},"MozMousePixelScroll");Z.prototype.toString=function(){return this.rgb()+""},mo.hsl=function(n,t,e){return 1===arguments.length?n instanceof X?V(n.h,n.s,n.l):lt(""+n,st,V):V(+n,+t,+e)};var ia=X.prototype=new Z;ia.brighter=function(n){return n=Math.pow(0.7,arguments.length?n:1),V(this.h,this.s,this.l/n)},ia.darker=function(n){return n=Math.pow(0.7,arguments.length?n:1),V(this.h,this.s,n*this.l)},ia.rgb=function(){return $(this.h,this.s,this.l)},mo.hcl=function(n,t,e){return 1===arguments.length?n instanceof W?B(n.h,n.c,n.l):n instanceof K?nt(n.l,n.a,n.b):nt((n=ft((n=mo.rgb(n)).r,n.g,n.b)).l,n.a,n.b):B(+n,+t,+e)};var oa=W.prototype=new Z;oa.brighter=function(n){return B(this.h,this.c,Math.min(100,this.l+aa*(arguments.length?n:1)))},oa.darker=function(n){return B(this.h,this.c,Math.max(0,this.l-aa*(arguments.length?n:1)))},oa.rgb=function(){return J(this.h,this.c,this.l).rgb()},mo.lab=function(n,t,e){return 1===arguments.length?n instanceof K?G(n.l,n.a,n.b):n instanceof W?J(n.l,n.c,n.h):ft((n=mo.rgb(n)).r,n.g,n.b):G(+n,+t,+e)};var aa=18,ca=0.95047,la=1,sa=1.08883,fa=K.prototype=new Z;fa.brighter=function(n){return G(Math.min(100,this.l+aa*(arguments.length?n:1)),this.a,this.b)},fa.darker=function(n){return G(Math.max(0,this.l-aa*(arguments.length?n:1)),this.a,this.b)},fa.rgb=function(){return Q(this.l,this.a,this.b)},mo.rgb=function(n,t,e){return 1===arguments.length?n instanceof at?ot(n.r,n.g,n.b):lt(""+n,ot,$):ot(~~n,~~t,~~e)};var ha=at.prototype=new Z;ha.brighter=function(n){n=Math.pow(0.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b,u=30;return t||e||r?(t&&u>t&&(t=u),e&&u>e&&(e=u),r&&u>r&&(r=u),ot(Math.min(255,~~(t/n)),Math.min(255,~~(e/n)),Math.min(255,~~(r/n)))):ot(u,u,u)},ha.darker=function(n){return n=Math.pow(0.7,arguments.length?n:1),ot(~~(n*this.r),~~(n*this.g),~~(n*this.b))},ha.hsl=function(){return st(this.r,this.g,this.b)},ha.toString=function(){return"#"+ct(this.r)+ct(this.g)+ct(this.b)};var ga=mo.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});ga.forEach(function(n,t){ga.set(n,ut(t))}),mo.functor=pt,mo.xhr=vt(dt),mo.dsv=function(n,t){function e(n,e,i){arguments.length<3&&(i=e,e=null);var o=mo.xhr(n,t,i);return o.row=function(n){return arguments.length?o.response(null==(e=n)?r:u(n)):e},o.row(e)}function r(n){return e.parse(n.responseText)}function u(n){return function(t){return e.parse(t.responseText,n)}}function o(t){return t.map(a).join(n)}function a(n){return c.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var c=new RegExp('["'+n+"\n]"),l=n.charCodeAt(0);return e.parse=function(n,t){var r;return e.parseRows(n,function(n,e){if(r){return r(n,e-1)}var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,e){return t(u(n),e)}:u})},e.parseRows=function(n,t){function e(){if(s>=c){return o}if(u){return u=!1,i}var t=s;if(34===n.charCodeAt(t)){for(var e=t;e++<c;){if(34===n.charCodeAt(e)){if(34!==n.charCodeAt(e+1)){break}++e}}s=e+2;var r=n.charCodeAt(e+1);return 13===r?(u=!0,10===n.charCodeAt(e+2)&&++s):10===r&&(u=!0),n.substring(t+1,e).replace(/""/g,'"')}for(;c>s;){var r=n.charCodeAt(s++),a=1;if(10===r){u=!0}else{if(13===r){u=!0,10===n.charCodeAt(s)&&(++s,++a)}else{if(r!==l){continue}}}return n.substring(t,s-a)}return n.substring(t)}for(var r,u,i={},o={},a=[],c=n.length,s=0,f=0;(r=e())!==o;){for(var h=[];r!==i&&r!==o;){h.push(r),r=e()}(!t||(h=t(h,f++)))&&a.push(h)}return a},e.format=function(t){if(Array.isArray(t[0])){return e.formatRows(t)}var r=new i,u=[];return t.forEach(function(n){for(var t in n){r.has(t)||u.push(r.add(t))}}),[u.map(a).join(n)].concat(t.map(function(t){return u.map(function(n){return a(t[n])}).join(n)})).join("\n")},e.formatRows=function(n){return n.map(o).join("\n")},e},mo.csv=mo.dsv(",","text/csv"),mo.tsv=mo.dsv("	","text/tab-separated-values");var pa,da,va,ma,ya,Ma=_o[a(_o,"requestAnimationFrame")]||function(n){setTimeout(n,17)};mo.timer=function(n,t,e){var r=arguments.length;2>r&&(t=0),3>r&&(e=Date.now());var u=e+t,i={callback:n,time:u,next:null};da?da.next=i:pa=i,da=i,va||(ma=clearTimeout(ma),va=1,Ma(Mt))},mo.timer.flush=function(){bt(),_t()};var xa=".",ba=",",_a=[3,3],wa="$",Sa=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(wt);mo.formatPrefix=function(n,t){var e=0;return n&&(0>n&&(n*=-1),t&&(n=mo.round(n,St(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((0>=e?e+1:e-1)/3)))),Sa[8+e/3]},mo.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)},mo.format=function(n){var t=Ea.exec(n),e=t[1]||" ",r=t[2]||">",u=t[3]||"",i=t[4]||"",o=t[5],a=+t[6],c=t[7],l=t[8],s=t[9],f=1,h="",g=!1;switch(l&&(l=+l.substring(1)),(o||"0"===e&&"="===r)&&(o=e="0",r="=",c&&(a-=Math.floor((a-1)/4))),s){case"n":c=!0,s="g";break;case"%":f=100,h="%",s="f";break;case"p":f=100,h="%",s="r";break;case"b":case"o":case"x":case"X":"#"===i&&(i="0"+s.toLowerCase());case"c":case"d":g=!0,l=0;break;case"s":f=-1,s="r"}"#"===i?i="":"$"===i&&(i=wa),"r"!=s||l||(s="g"),null!=l&&("g"==s?l=Math.max(1,Math.min(21,l)):("e"==s||"f"==s)&&(l=Math.max(0,Math.min(20,l)))),s=ka.get(s)||Et;var p=o&&c;return function(n){if(g&&n%1){return""}var t=0>n||0===n&&0>1/n?(n=-n,"-"):u;if(0>f){var d=mo.formatPrefix(n,l);n=d.scale(n),h=d.symbol}else{n*=f}n=s(n,l);var v=n.lastIndexOf("."),m=0>v?n:n.substring(0,v),y=0>v?"":xa+n.substring(v+1);!o&&c&&(m=Aa(m));var M=i.length+m.length+y.length+(p?0:t.length),x=a>M?new Array(M=a-M+1).join(e):"";return p&&(m=Aa(x+m)),t+=i,n=m+y,("<"===r?t+n+x:">"===r?x+t+n:"^"===r?x.substring(0,M>>=1)+t+n+x.substring(M):t+(p?n:x+n))+h}};var Ea=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ka=mo.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=mo.round(n,St(n,t))).toFixed(Math.max(0,Math.min(20,St(n*(1+1e-15),t))))}}),Aa=dt;if(_a){var Na=_a.length;Aa=function(n){for(var t=n.length,e=[],r=0,u=_a[0];t>0&&u>0;){e.push(n.substring(t-=u,t+u)),u=_a[r=(r+1)%Na]}return e.reverse().join(ba)}}mo.geo={},kt.prototype={s:0,t:0,add:function(n){At(n,this.t,Ta),At(Ta.s,this.s,this),this.s?this.t+=Ta.t:this.s=Ta.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var Ta=new kt;mo.geo.stream=function(n,t){n&&qa.hasOwnProperty(n.type)?qa[n.type](n,t):Nt(n,t)};var qa={Feature:function(n,t){Nt(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,u=e.length;++r<u;){Nt(e[r].geometry,t)}}},za={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;){n=e[r],t.point(n[0],n[1],n[2])}},LineString:function(n,t){Tt(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;){Tt(e[r],t,0)}},Polygon:function(n,t){qt(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;){qt(e[r],t)}},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,u=e.length;++r<u;){Nt(e[r],t)}}};mo.geo.area=function(n){return Ca=0,mo.geo.stream(n,ja),Ca};var Ca,Da=new kt,ja={sphere:function(){Ca+=4*Bo},point:c,lineStart:c,lineEnd:c,polygonStart:function(){Da.reset(),ja.lineStart=zt},polygonEnd:function(){var n=2*Da;Ca+=0>n?4*Bo+n:n,ja.lineStart=ja.lineEnd=ja.point=c}};mo.geo.bounds=function(){function n(n,t){M.push(x=[s=n,h=n]),f>t&&(f=t),t>g&&(g=t)}function t(t,e){var r=Ct([t*Go,e*Go]);if(m){var u=jt(m,r),i=[u[1],-u[0],0],o=jt(i,u);Ft(o),o=Pt(o);var c=t-p,l=c>0?1:-1,d=o[0]*Ko*l,v=Math.abs(c)>180;if(v^(d>l*p&&l*t>d)){var y=o[1]*Ko;y>g&&(g=y)}else{if(d=(d+360)%360-180,v^(d>l*p&&l*t>d)){var y=-o[1]*Ko;f>y&&(f=y)}else{f>e&&(f=e),e>g&&(g=e)}}v?p>t?a(s,t)>a(s,h)&&(h=t):a(t,h)>a(s,h)&&(s=t):h>=s?(s>t&&(s=t),t>h&&(h=t)):t>p?a(s,t)>a(s,h)&&(h=t):a(t,h)>a(s,h)&&(s=t)}else{n(t,e)}m=r,p=t}function e(){b.point=t}function r(){x[0]=s,x[1]=h,b.point=n,m=null}function u(n,e){if(m){var r=n-p;y+=Math.abs(r)>180?r+(r>0?360:-360):r}else{d=n,v=e}ja.point(n,e),t(n,e)}function i(){ja.lineStart()}function o(){u(d,v),ja.lineEnd(),Math.abs(y)>Wo&&(s=-(h=180)),x[0]=s,x[1]=h,m=null}function a(n,t){return(t-=n)<0?t+360:t}function c(n,t){return n[0]-t[0]}function l(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var s,f,h,g,p,d,v,m,y,M,x,b={point:n,lineStart:e,lineEnd:r,polygonStart:function(){b.point=u,b.lineStart=i,b.lineEnd=o,y=0,ja.polygonStart()},polygonEnd:function(){ja.polygonEnd(),b.point=n,b.lineStart=e,b.lineEnd=r,0>Da?(s=-(h=180),f=-(g=90)):y>Wo?g=90:-Wo>y&&(f=-90),x[0]=s,x[1]=h}};return function(n){g=h=-(s=f=1/0),M=[],mo.geo.stream(n,b);var t=M.length;if(t){M.sort(c);for(var e,r=1,u=M[0],i=[u];t>r;++r){e=M[r],l(e[0],u)||l(e[1],u)?(a(u[0],e[1])>a(u[0],u[1])&&(u[1]=e[1]),a(e[0],u[1])>a(u[0],u[1])&&(u[0]=e[0])):i.push(u=e)}for(var o,e,p=-1/0,t=i.length-1,r=0,u=i[t];t>=r;u=e,++r){e=i[r],(o=a(u[1],e[0]))>p&&(p=o,s=e[0],h=u[1])}}return M=x=null,1/0===s||1/0===f?[[0/0,0/0],[0/0,0/0]]:[[s,f],[h,g]]}}(),mo.geo.centroid=function(n){La=Ha=Fa=Pa=Oa=Ra=Ya=Ia=Ua=Za=Va=0,mo.geo.stream(n,Xa);var t=Ua,e=Za,r=Va,u=t*t+e*e+r*r;return Jo>u&&(t=Ra,e=Ya,r=Ia,Wo>Ha&&(t=Fa,e=Pa,r=Oa),u=t*t+e*e+r*r,Jo>u)?[0/0,0/0]:[Math.atan2(e,t)*Ko,O(r/Math.sqrt(u))*Ko]};var La,Ha,Fa,Pa,Oa,Ra,Ya,Ia,Ua,Za,Va,Xa={sphere:c,point:Rt,lineStart:It,lineEnd:Ut,polygonStart:function(){Xa.lineStart=Zt},polygonEnd:function(){Xa.lineStart=It}},$a=Bt(Vt,Qt,te,ee),Ba=[-Bo,0],Wa=1000000000;mo.geo.clipExtent=function(){var n,t,e,r,u,i,o={stream:function(n){return u&&(u.valid=!1),u=i(n),u.valid=!0,u},extent:function(a){return arguments.length?(i=ue(n=+a[0][0],t=+a[0][1],e=+a[1][0],r=+a[1][1]),u&&(u.valid=!1,u=null),o):[[n,t],[e,r]]}};return o.extent([[0,0],[960,500]])},(mo.geo.conicEqualArea=function(){return ae(ce)}).raw=ce,mo.geo.albers=function(){return mo.geo.conicEqualArea().rotate([96,0]).center([-0.6,38.7]).parallels([29.5,45.5]).scale(1070)},mo.geo.albersUsa=function(){function n(n){var i=n[0],o=n[1];return t=null,e(i,o),t||(r(i,o),t)||u(i,o),t}var t,e,r,u,i=mo.geo.albers(),o=mo.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=mo.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(n,e){t=[n,e]}};return n.invert=function(n){var t=i.scale(),e=i.translate(),r=(n[0]-e[0])/t,u=(n[1]-e[1])/t;return(u>=0.12&&0.234>u&&r>=-0.425&&-0.214>r?o:u>=0.166&&0.234>u&&r>=-0.214&&-0.115>r?a:i).invert(n)},n.stream=function(n){var t=i.stream(n),e=o.stream(n),r=a.stream(n);return{point:function(n,u){t.point(n,u),e.point(n,u),r.point(n,u)},sphere:function(){t.sphere(),e.sphere(),r.sphere()},lineStart:function(){t.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},n.precision=function(t){return arguments.length?(i.precision(t),o.precision(t),a.precision(t),n):i.precision()},n.scale=function(t){return arguments.length?(i.scale(t),o.scale(0.35*t),a.scale(t),n.translate(i.translate())):i.scale()},n.translate=function(t){if(!arguments.length){return i.translate()}var l=i.scale(),s=+t[0],f=+t[1];return e=i.translate(t).clipExtent([[s-0.455*l,f-0.238*l],[s+0.455*l,f+0.238*l]]).stream(c).point,r=o.translate([s-0.307*l,f+0.201*l]).clipExtent([[s-0.425*l+Wo,f+0.12*l+Wo],[s-0.214*l-Wo,f+0.234*l-Wo]]).stream(c).point,u=a.translate([s-0.205*l,f+0.212*l]).clipExtent([[s-0.214*l+Wo,f+0.166*l+Wo],[s-0.115*l-Wo,f+0.234*l-Wo]]).stream(c).point,n},n.scale(1070)};var Ja,Ga,Ka,Qa,nc,tc,ec={point:c,lineStart:c,lineEnd:c,polygonStart:function(){Ga=0,ec.lineStart=le},polygonEnd:function(){ec.lineStart=ec.lineEnd=ec.point=c,Ja+=Math.abs(Ga/2)}},rc={point:se,lineStart:c,lineEnd:c,polygonStart:c,polygonEnd:c},uc={point:ge,lineStart:pe,lineEnd:de,polygonStart:function(){uc.lineStart=ve},polygonEnd:function(){uc.point=ge,uc.lineStart=pe,uc.lineEnd=de}};mo.geo.transform=function(n){return{stream:function(t){var e=new Me(t);for(var r in n){e[r]=n[r]}return e}}},Me.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},mo.geo.path=function(){function n(n){return n&&("function"==typeof a&&i.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=u(i)),mo.geo.stream(n,o)),i.result()}function t(){return o=null,n}var e,r,u,i,o,a=4.5;return n.area=function(n){return Ja=0,mo.geo.stream(n,u(ec)),Ja},n.centroid=function(n){return Fa=Pa=Oa=Ra=Ya=Ia=Ua=Za=Va=0,mo.geo.stream(n,u(uc)),Va?[Ua/Va,Za/Va]:Ia?[Ra/Ia,Ya/Ia]:Oa?[Fa/Oa,Pa/Oa]:[0/0,0/0]},n.bounds=function(n){return nc=tc=-(Ka=Qa=1/0),mo.geo.stream(n,u(rc)),[[Ka,Qa],[nc,tc]]},n.projection=function(n){return arguments.length?(u=(e=n)?n.stream||xe(n):dt,t()):e},n.context=function(n){return arguments.length?(i=null==(r=n)?new fe:new me(n),"function"!=typeof a&&i.pointRadius(a),t()):r},n.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(i.pointRadius(+t),+t),n):a},n.projection(mo.geo.albersUsa()).context(null)},mo.geo.projection=be,mo.geo.projectionMutator=_e,(mo.geo.equirectangular=function(){return be(Se)}).raw=Se.invert=Se,mo.geo.rotation=function(n){function t(t){return t=n(t[0]*Go,t[1]*Go),t[0]*=Ko,t[1]*=Ko,t}return n=Ee(n[0]%360*Go,n[1]*Go,n.length>2?n[2]*Go:0),t.invert=function(t){return t=n.invert(t[0]*Go,t[1]*Go),t[0]*=Ko,t[1]*=Ko,t},t},mo.geo.circle=function(){function n(){var n="function"==typeof r?r.apply(this,arguments):r,t=Ee(-n[0]*Go,-n[1]*Go,0).invert,u=[];return e(null,null,1,{point:function(n,e){u.push(n=t(n,e)),n[0]*=Ko,n[1]*=Ko}}),{type:"Polygon",coordinates:[u]}}var t,e,r=[0,0],u=6;return n.origin=function(t){return arguments.length?(r=t,n):r},n.angle=function(r){return arguments.length?(e=Te((t=+r)*Go,u*Go),n):t},n.precision=function(r){return arguments.length?(e=Te(t*Go,(u=+r)*Go),n):u},n.angle(90)},mo.geo.distance=function(n,t){var e,r=(t[0]-n[0])*Go,u=n[1]*Go,i=t[1]*Go,o=Math.sin(r),a=Math.cos(r),c=Math.sin(u),l=Math.cos(u),s=Math.sin(i),f=Math.cos(i);return Math.atan2(Math.sqrt((e=f*o)*e+(e=l*s-c*f*a)*e),c*s+l*f*a)},mo.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return mo.range(Math.ceil(i/v)*v,u,v).map(h).concat(mo.range(Math.ceil(l/m)*m,c,m).map(g)).concat(mo.range(Math.ceil(r/p)*p,e,p).filter(function(n){return Math.abs(n%v)>Wo}).map(s)).concat(mo.range(Math.ceil(a/d)*d,o,d).filter(function(n){return Math.abs(n%m)>Wo}).map(f))}var e,r,u,i,o,a,c,l,s,f,h,g,p=10,d=p,v=90,m=360,y=2.5;return n.lines=function(){return t().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[h(i).concat(g(c).slice(1),h(u).reverse().slice(1),g(l).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(i=+t[0][0],u=+t[1][0],l=+t[0][1],c=+t[1][1],i>u&&(t=i,i=u,u=t),l>c&&(t=l,l=c,c=t),n.precision(y)):[[i,l],[u,c]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],a=+t[0][1],o=+t[1][1],r>e&&(t=r,r=e,e=t),a>o&&(t=a,a=o,o=t),n.precision(y)):[[r,a],[e,o]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(v=+t[0],m=+t[1],n):[v,m]},n.minorStep=function(t){return arguments.length?(p=+t[0],d=+t[1],n):[p,d]},n.precision=function(t){return arguments.length?(y=+t,s=ze(a,o,90),f=Ce(r,e,y),h=ze(l,c,90),g=Ce(i,u,y),n):y},n.majorExtent([[-180,-90+Wo],[180,90-Wo]]).minorExtent([[-180,-80-Wo],[180,80+Wo]])},mo.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||u.apply(this,arguments)]}}var t,e,r=De,u=je;return n.distance=function(){return mo.geo.distance(t||r.apply(this,arguments),e||u.apply(this,arguments))},n.source=function(e){return arguments.length?(r=e,t="function"==typeof e?null:e,n):r},n.target=function(t){return arguments.length?(u=t,e="function"==typeof t?null:t,n):u},n.precision=function(){return arguments.length?n:0},n},mo.geo.interpolate=function(n,t){return Le(n[0]*Go,n[1]*Go,t[0]*Go,t[1]*Go)},mo.geo.length=function(n){return ic=0,mo.geo.stream(n,oc),ic};var ic,oc={sphere:c,point:c,lineStart:He,lineEnd:c,polygonStart:c,polygonEnd:c},ac=Fe(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(mo.geo.azimuthalEqualArea=function(){return be(ac)}).raw=ac;var cc=Fe(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},dt);(mo.geo.azimuthalEquidistant=function(){return be(cc)}).raw=cc,(mo.geo.conicConformal=function(){return ae(Pe)}).raw=Pe,(mo.geo.conicEquidistant=function(){return ae(Oe)}).raw=Oe;var lc=Fe(function(n){return 1/n},Math.atan);(mo.geo.gnomonic=function(){return be(lc)}).raw=lc,Re.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-Bo/2]},(mo.geo.mercator=function(){return Ye(Re)}).raw=Re;var sc=Fe(function(){return 1},Math.asin);(mo.geo.orthographic=function(){return be(sc)}).raw=sc;var fc=Fe(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(mo.geo.stereographic=function(){return be(fc)}).raw=fc,Ie.invert=function(n,t){return[Math.atan2(R(n),Math.cos(t)),O(Math.sin(t)/Y(n))]},(mo.geo.transverseMercator=function(){return Ye(Ie)}).raw=Ie,mo.geom={},mo.svg={},mo.svg.line=function(){return Ue(dt)};var hc=mo.map({linear:Xe,"linear-closed":$e,step:Be,"step-before":We,"step-after":Je,basis:er,"basis-open":rr,"basis-closed":ur,bundle:ir,cardinal:Qe,"cardinal-open":Ge,"cardinal-closed":Ke,monotone:fr});hc.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var gc=[0,2/3,1/3,0],pc=[0,1/3,2/3,0],dc=[0,1/6,2/3,1/6];mo.geom.hull=function(n){function t(n){if(n.length<3){return[]}var t,u,i,o,a,c,l,s,f,h,g,p,d=pt(e),v=pt(r),m=n.length,y=m-1,M=[],x=[],b=0;if(d===Ze&&r===Ve){t=n}else{for(i=0,t=[];m>i;++i){t.push([+d.call(this,u=n[i],i),+v.call(this,u,i)])}}for(i=1;m>i;++i){(t[i][1]<t[b][1]||t[i][1]==t[b][1]&&t[i][0]<t[b][0])&&(b=i)}for(i=0;m>i;++i){i!==b&&(c=t[i][1]-t[b][1],a=t[i][0]-t[b][0],M.push({angle:Math.atan2(c,a),index:i}))}for(M.sort(function(n,t){return n.angle-t.angle}),g=M[0].angle,h=M[0].index,f=0,i=1;y>i;++i){if(o=M[i].index,g==M[i].angle){if(a=t[h][0]-t[b][0],c=t[h][1]-t[b][1],l=t[o][0]-t[b][0],s=t[o][1]-t[b][1],a*a+c*c>=l*l+s*s){M[i].index=-1;continue}M[f].index=-1}g=M[i].angle,f=i,h=o}for(x.push(b),i=0,o=0;2>i;++o){M[o].index>-1&&(x.push(M[o].index),i++)}for(p=x.length;y>o;++o){if(!(M[o].index<0)){for(;!hr(x[p-2],x[p-1],M[o].index,t);){--p}x[p++]=M[o].index}}var _=[];for(i=p-1;i>=0;--i){_.push(n[x[i]])}return _}var e=Ze,r=Ve;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t)},mo.geom.polygon=function(n){return Lo(n,vc),n};var vc=mo.geom.polygon.prototype=[];vc.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],u=0;++t<e;){n=r,r=this[t],u+=n[1]*r[0]-n[0]*r[1]}return 0.5*u},vc.centroid=function(n){var t,e,r=-1,u=this.length,i=0,o=0,a=this[u-1];for(arguments.length||(n=-1/(6*this.area()));++r<u;){t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],i+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e}return[i*n,o*n]},vc.clip=function(n){for(var t,e,r,u,i,o,a=dr(n),c=-1,l=this.length-dr(this),s=this[l-1];++c<l;){for(t=n.slice(),n.length=0,u=this[c],i=t[(r=t.length-a)-1],e=-1;++e<r;){o=t[e],gr(o,s,u)?(gr(i,s,u)||n.push(pr(i,o,s,u)),n.push(o)):gr(i,s,u)&&n.push(pr(i,o,s,u)),i=o}a&&n.push(n[0]),s=u}return n},mo.geom.delaunay=function(n){var t=n.map(function(){return[]}),e=[];return vr(n,function(e){t[e.region.l.index].push(n[e.region.r.index])}),t.forEach(function(t,r){var u=n[r],i=u[0],o=u[1];t.forEach(function(n){n.angle=Math.atan2(n[0]-i,n[1]-o)}),t.sort(function(n,t){return n.angle-t.angle});for(var a=0,c=t.length-1;c>a;a++){e.push([u,t[a],t[a+1]])}}),e},mo.geom.voronoi=function(n){function t(n){var t,i,o,a=n.map(function(){return[]}),c=pt(e),l=pt(r),s=n.length,f=1000000;if(c===Ze&&l===Ve){t=n}else{for(t=new Array(s),o=0;s>o;++o){t[o]=[+c.call(this,i=n[o],o),+l.call(this,i,o)]}}if(vr(t,function(n){var t,e,r,u,i,o;1===n.a&&n.b>=0?(t=n.ep.r,e=n.ep.l):(t=n.ep.l,e=n.ep.r),1===n.a?(i=t?t.y:-f,r=n.c-n.b*i,o=e?e.y:f,u=n.c-n.b*o):(r=t?t.x:-f,i=n.c-n.a*r,u=e?e.x:f,o=n.c-n.a*u);var c=[r,i],l=[u,o];a[n.region.l.index].push(c,l),a[n.region.r.index].push(c,l)}),a=a.map(function(n,e){var r=t[e][0],u=t[e][1],i=n.map(function(n){return Math.atan2(n[0]-r,n[1]-u)}),o=mo.range(n.length).sort(function(n,t){return i[n]-i[t]});return o.filter(function(n,t){return !t||i[n]-i[o[t-1]]>Wo}).map(function(t){return n[t]})}),a.forEach(function(n,e){var r=n.length;if(!r){return n.push([-f,-f],[-f,f],[f,f],[f,-f])}if(!(r>2)){var u=t[e],i=n[0],o=n[1],a=u[0],c=u[1],l=i[0],s=i[1],h=o[0],g=o[1],p=Math.abs(h-l),d=g-s;if(Math.abs(d)<Wo){var v=s>c?-f:f;n.push([-f,v],[f,v])}else{if(Wo>p){var m=l>a?-f:f;n.push([m,-f],[m,f])}else{var v=(l-a)*(g-s)>(h-l)*(s-c)?f:-f,y=Math.abs(d)-p;Math.abs(y)<Wo?n.push([0>d?v:-v,v]):(y>0&&(v*=-1),n.push([-f,v],[f,v]))}}}}),u){for(o=0;s>o;++o){u.clip(a[o])}}for(o=0;s>o;++o){a[o].point=n[o]}return a}var e=Ze,r=Ve,u=null;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.clipExtent=function(n){if(!arguments.length){return u&&[u[0],u[2]]}if(null==n){u=null}else{var e=+n[0][0],r=+n[0][1],i=+n[1][0],o=+n[1][1];u=mo.geom.polygon([[e,r],[e,o],[i,o],[i,r]])}return t},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):u&&u[2]},t.links=function(n){var t,u,i,o=n.map(function(){return[]}),a=[],c=pt(e),l=pt(r),s=n.length;if(c===Ze&&l===Ve){t=n}else{for(t=new Array(s),i=0;s>i;++i){t[i]=[+c.call(this,u=n[i],i),+l.call(this,u,i)]}}return vr(t,function(t){var e=t.region.l.index,r=t.region.r.index;o[e][r]||(o[e][r]=o[r][e]=!0,a.push({source:n[e],target:n[r]}))}),a},t.triangles=function(n){if(e===Ze&&r===Ve){return mo.geom.delaunay(n)}for(var t,u=new Array(c),i=pt(e),o=pt(r),a=-1,c=n.length;++a<c;){(u[a]=[+i.call(this,t=n[a],a),+o.call(this,t,a)]).data=t}return mo.geom.delaunay(u).map(function(n){return n.map(function(n){return n.data})})},t)};var mc={l:"r",r:"l"};mo.geom.quadtree=function(n,t,e,r,u){function i(n){function i(n,t,e,r,u,i,o,a){if(!isNaN(e)&&!isNaN(r)){if(n.leaf){var c=n.x,s=n.y;if(null!=c){if(Math.abs(c-e)+Math.abs(s-r)<0.01){l(n,t,e,r,u,i,o,a)}else{var f=n.point;n.x=n.y=n.point=null,l(n,f,c,s,u,i,o,a),l(n,t,e,r,u,i,o,a)}}else{n.x=e,n.y=r,n.point=t}}else{l(n,t,e,r,u,i,o,a)}}}function l(n,t,e,r,u,o,a,c){var l=0.5*(u+a),s=0.5*(o+c),f=e>=l,h=r>=s,g=(h<<1)+f;n.leaf=!1,n=n.nodes[g]||(n.nodes[g]=Mr()),f?u=l:a=l,h?o=s:c=s,i(n,t,e,r,u,o,a,c)}var s,f,h,g,p,d,v,m,y,M=pt(a),x=pt(c);if(null!=t){d=t,v=e,m=r,y=u}else{if(m=y=-(d=v=1/0),f=[],h=[],p=n.length,o){for(g=0;p>g;++g){s=n[g],s.x<d&&(d=s.x),s.y<v&&(v=s.y),s.x>m&&(m=s.x),s.y>y&&(y=s.y),f.push(s.x),h.push(s.y)}}else{for(g=0;p>g;++g){var b=+M(s=n[g],g),_=+x(s,g);d>b&&(d=b),v>_&&(v=_),b>m&&(m=b),_>y&&(y=_),f.push(b),h.push(_)}}}var w=m-d,S=y-v;w>S?y=v+w:m=d+S;var E=Mr();if(E.add=function(n){i(E,n,+M(n,++g),+x(n,g),d,v,m,y)},E.visit=function(n){xr(n,E,d,v,m,y)},g=-1,null==t){for(;++g<p;){i(E,n[g],f[g],h[g],d,v,m,y)}--g}else{n.forEach(E.add)}return f=h=n=s=null,E}var o,a=Ze,c=Ve;return(o=arguments.length)?(a=mr,c=yr,3===o&&(u=e,r=t,e=t=0),i(n)):(i.x=function(n){return arguments.length?(a=n,i):a},i.y=function(n){return arguments.length?(c=n,i):c},i.extent=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=+n[0][0],e=+n[0][1],r=+n[1][0],u=+n[1][1]),i):null==t?null:[[t,e],[r,u]]},i.size=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=e=0,r=+n[0],u=+n[1]),i):null==t?null:[r-t,u-e]},i)},mo.interpolateRgb=br,mo.interpolateObject=_r,mo.interpolateNumber=wr,mo.interpolateString=Sr;var yc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;mo.interpolate=Er,mo.interpolators=[function(n,t){var e=typeof t;return("string"===e?ga.has(t)||/^(#|rgb\(|hsl\()/.test(t)?br:Sr:t instanceof Z?br:"object"===e?Array.isArray(t)?kr:_r:wr)(n,t)}],mo.interpolateArray=kr;var Mc=function(){return dt},xc=mo.map({linear:Mc,poly:Dr,quad:function(){return qr},cubic:function(){return zr},sin:function(){return jr},exp:function(){return Lr},circle:function(){return Hr},elastic:Fr,back:Pr,bounce:function(){return Or}}),bc=mo.map({"in":dt,out:Nr,"in-out":Tr,"out-in":function(n){return Tr(Nr(n))}});mo.ease=function(n){var t=n.indexOf("-"),e=t>=0?n.substring(0,t):n,r=t>=0?n.substring(t+1):"in";return e=xc.get(e)||Mc,r=bc.get(r)||dt,Ar(r(e.apply(null,Array.prototype.slice.call(arguments,1))))},mo.interpolateHcl=Rr,mo.interpolateHsl=Yr,mo.interpolateLab=Ir,mo.interpolateRound=Ur,mo.transform=function(n){var t=xo.createElementNS(mo.ns.prefix.svg,"g");return(mo.transform=function(n){if(null!=n){t.setAttribute("transform",n);var e=t.transform.baseVal.consolidate()}return new Zr(e?e.matrix:_c)})(n)},Zr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var _c={a:1,b:0,c:0,d:1,e:0,f:0};mo.interpolateTransform=Br,mo.layout={},mo.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;){t.push(Gr(n[e]))}return t}},mo.layout.chord=function(){function n(){var n,l,f,h,g,p={},d=[],v=mo.range(i),m=[];for(e=[],r=[],n=0,h=-1;++h<i;){for(l=0,g=-1;++g<i;){l+=u[h][g]}d.push(l),m.push(mo.range(i)),n+=l}for(o&&v.sort(function(n,t){return o(d[n],d[t])}),a&&m.forEach(function(n,t){n.sort(function(n,e){return a(u[t][n],u[t][e])})}),n=(2*Bo-s*i)/n,l=0,h=-1;++h<i;){for(f=l,g=-1;++g<i;){var y=v[h],M=m[y][g],x=u[y][M],b=l,_=l+=x*n;p[y+"-"+M]={index:y,subindex:M,startAngle:b,endAngle:_,value:x}}r[y]={index:y,startAngle:f,endAngle:l,value:(l-f)/n},l+=s}for(h=-1;++h<i;){for(g=h-1;++g<i;){var w=p[h+"-"+g],S=p[g+"-"+h];(w.value||S.value)&&e.push(w.value<S.value?{source:S,target:w}:{source:w,target:S})}}c&&t()}function t(){e.sort(function(n,t){return c((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var e,r,u,i,o,a,c,l={},s=0;return l.matrix=function(n){return arguments.length?(i=(u=n)&&u.length,e=r=null,l):u},l.padding=function(n){return arguments.length?(s=n,e=r=null,l):s},l.sortGroups=function(n){return arguments.length?(o=n,e=r=null,l):o},l.sortSubgroups=function(n){return arguments.length?(a=n,e=null,l):a},l.sortChords=function(n){return arguments.length?(c=n,e&&t(),l):c},l.chords=function(){return e||n(),e},l.groups=function(){return r||n(),r},l},mo.layout.force=function(){function n(n){return function(t,e,r,u){if(t.point!==n){var i=t.cx-n.x,o=t.cy-n.y,a=1/Math.sqrt(i*i+o*o);if(d>(u-e)*a){var c=t.charge*a*a;return n.px-=i*c,n.py-=o*c,!0}if(t.point&&isFinite(a)){var c=t.pointCharge*a*a;n.px-=i*c,n.py-=o*c}}return !t.charge}}function t(n){n.px=mo.event.x,n.py=mo.event.y,a.resume()}var e,r,u,i,o,a={},c=mo.dispatch("start","tick","end"),l=[1,1],s=0.9,f=wc,h=Sc,g=-30,p=0.1,d=0.8,v=[],m=[];return a.tick=function(){if((r*=0.99)<0.005){return c.end({type:"end",alpha:r=0}),!0}var t,e,a,f,h,d,y,M,x,b=v.length,_=m.length;for(e=0;_>e;++e){a=m[e],f=a.source,h=a.target,M=h.x-f.x,x=h.y-f.y,(d=M*M+x*x)&&(d=r*i[e]*((d=Math.sqrt(d))-u[e])/d,M*=d,x*=d,h.x-=M*(y=f.weight/(h.weight+f.weight)),h.y-=x*y,f.x+=M*(y=1-y),f.y+=x*y)}if((y=r*p)&&(M=l[0]/2,x=l[1]/2,e=-1,y)){for(;++e<b;){a=v[e],a.x+=(M-a.x)*y,a.y+=(x-a.y)*y}}if(g){for(uu(t=mo.geom.quadtree(v),r,o),e=-1;++e<b;){(a=v[e]).fixed||t.visit(n(a))}}for(e=-1;++e<b;){a=v[e],a.fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*s,a.y-=(a.py-(a.py=a.y))*s)}c.tick({type:"tick",alpha:r})},a.nodes=function(n){return arguments.length?(v=n,a):v},a.links=function(n){return arguments.length?(m=n,a):m},a.size=function(n){return arguments.length?(l=n,a):l},a.linkDistance=function(n){return arguments.length?(f="function"==typeof n?n:+n,a):f},a.distance=a.linkDistance,a.linkStrength=function(n){return arguments.length?(h="function"==typeof n?n:+n,a):h},a.friction=function(n){return arguments.length?(s=+n,a):s},a.charge=function(n){return arguments.length?(g="function"==typeof n?n:+n,a):g},a.gravity=function(n){return arguments.length?(p=+n,a):p},a.theta=function(n){return arguments.length?(d=+n,a):d},a.alpha=function(n){return arguments.length?(n=+n,r?r=n>0?n:0:n>0&&(c.start({type:"start",alpha:r=n}),mo.timer(a.tick)),a):r},a.start=function(){function n(n,r){for(var u,i=t(e),o=-1,a=i.length;++o<a;){if(!isNaN(u=i[o][n])){return u}}return Math.random()*r}function t(){if(!c){for(c=[],r=0;p>r;++r){c[r]=[]}for(r=0;d>r;++r){var n=m[r];c[n.source.index].push(n.target),c[n.target.index].push(n.source)}}return c[e]}var e,r,c,s,p=v.length,d=m.length,y=l[0],M=l[1];for(e=0;p>e;++e){(s=v[e]).index=e,s.weight=0}for(e=0;d>e;++e){s=m[e],"number"==typeof s.source&&(s.source=v[s.source]),"number"==typeof s.target&&(s.target=v[s.target]),++s.source.weight,++s.target.weight}for(e=0;p>e;++e){s=v[e],isNaN(s.x)&&(s.x=n("x",y)),isNaN(s.y)&&(s.y=n("y",M)),isNaN(s.px)&&(s.px=s.x),isNaN(s.py)&&(s.py=s.y)}if(u=[],"function"==typeof f){for(e=0;d>e;++e){u[e]=+f.call(this,m[e],e)}}else{for(e=0;d>e;++e){u[e]=f}}if(i=[],"function"==typeof h){for(e=0;d>e;++e){i[e]=+h.call(this,m[e],e)}}else{for(e=0;d>e;++e){i[e]=h}}if(o=[],"function"==typeof g){for(e=0;p>e;++e){o[e]=+g.call(this,v[e],e)}}else{for(e=0;p>e;++e){o[e]=g}}return a.resume()},a.resume=function(){return a.alpha(0.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return e||(e=mo.behavior.drag().origin(dt).on("dragstart.force",nu).on("drag.force",t).on("dragend.force",tu)),arguments.length?(this.on("mouseover.force",eu).on("mouseout.force",ru).call(e),void 0):e},mo.rebind(a,c,"on")};var wc=20,Sc=1;mo.layout.hierarchy=function(){function n(t,o,a){var c=u.call(e,t,o);if(t.depth=o,a.push(t),c&&(l=c.length)){for(var l,s,f=-1,h=t.children=[],g=0,p=o+1;++f<l;){s=n(c[f],p,a),s.parent=t,h.push(s),g+=s.value}r&&h.sort(r),i&&(t.value=g)}else{i&&(t.value=+i.call(e,t,o)||0)}return t}function t(n,r){var u=n.children,o=0;if(u&&(a=u.length)){for(var a,c=-1,l=r+1;++c<a;){o+=t(u[c],l)}}else{i&&(o=+i.call(e,n,r)||0)}return i&&(n.value=o),o}function e(t){var e=[];return n(t,0,e),e}var r=cu,u=ou,i=au;return e.sort=function(n){return arguments.length?(r=n,e):r},e.children=function(n){return arguments.length?(u=n,e):u},e.value=function(n){return arguments.length?(i=n,e):i},e.revalue=function(n){return t(n,0),n},e},mo.layout.partition=function(){function n(t,e,r,u){var i=t.children;if(t.x=e,t.y=t.depth*u,t.dx=r,t.dy=u,i&&(o=i.length)){var o,a,c,l=-1;for(r=t.value?r/t.value:0;++l<o;){n(a=i[l],e,c=a.value*r,u),e+=c}}}function t(n){var e=n.children,r=0;if(e&&(u=e.length)){for(var u,i=-1;++i<u;){r=Math.max(r,t(e[i]))}}return 1+r}function e(e,i){var o=r.call(this,e,i);return n(o[0],0,u[0],u[1]/t(o[0])),o}var r=mo.layout.hierarchy(),u=[1,1];return e.size=function(n){return arguments.length?(u=n,e):u},iu(e,r)},mo.layout.pie=function(){function n(i){var o=i.map(function(e,r){return +t.call(n,e,r)}),a=+("function"==typeof r?r.apply(this,arguments):r),c=(("function"==typeof u?u.apply(this,arguments):u)-a)/mo.sum(o),l=mo.range(i.length);null!=e&&l.sort(e===Ec?function(n,t){return o[t]-o[n]}:function(n,t){return e(i[n],i[t])});var s=[];return l.forEach(function(n){var t;s[n]={data:i[n],value:t=o[n],startAngle:a,endAngle:a+=t*c}}),s}var t=Number,e=Ec,r=0,u=2*Bo;return n.value=function(e){return arguments.length?(t=e,n):t},n.sort=function(t){return arguments.length?(e=t,n):e},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(u=t,n):u},n};var Ec={};mo.layout.stack=function(){function n(a,c){var l=a.map(function(e,r){return t.call(n,e,r)}),s=l.map(function(t){return t.map(function(t,e){return[i.call(n,t,e),o.call(n,t,e)]})}),f=e.call(n,s,c);l=mo.permute(l,f),s=mo.permute(s,f);var h,g,p,d=r.call(n,s,c),v=l.length,m=l[0].length;for(g=0;m>g;++g){for(u.call(n,l[0][g],p=d[g],s[0][g][1]),h=1;v>h;++h){u.call(n,l[h][g],p+=s[h-1][g][1],s[h][g][1])}}return a}var t=dt,e=gu,r=pu,u=hu,i=su,o=fu;return n.values=function(e){return arguments.length?(t=e,n):t},n.order=function(t){return arguments.length?(e="function"==typeof t?t:kc.get(t)||gu,n):e},n.offset=function(t){return arguments.length?(r="function"==typeof t?t:Ac.get(t)||pu,n):r},n.x=function(t){return arguments.length?(i=t,n):i},n.y=function(t){return arguments.length?(o=t,n):o},n.out=function(t){return arguments.length?(u=t,n):u},n};var kc=mo.map({"inside-out":function(n){var t,e,r=n.length,u=n.map(du),i=n.map(vu),o=mo.range(r).sort(function(n,t){return u[n]-u[t]}),a=0,c=0,l=[],s=[];for(t=0;r>t;++t){e=o[t],c>a?(a+=i[e],l.push(e)):(c+=i[e],s.push(e))}return s.reverse().concat(l)},reverse:function(n){return mo.range(n.length).reverse()},"default":gu}),Ac=mo.map({silhouette:function(n){var t,e,r,u=n.length,i=n[0].length,o=[],a=0,c=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++){r+=n[t][e][1]}r>a&&(a=r),o.push(r)}for(e=0;i>e;++e){c[e]=(a-o[e])/2}return c},wiggle:function(n){var t,e,r,u,i,o,a,c,l,s=n.length,f=n[0],h=f.length,g=[];for(g[0]=c=l=0,e=1;h>e;++e){for(t=0,u=0;s>t;++t){u+=n[t][e][1]}for(t=0,i=0,a=f[e][0]-f[e-1][0];s>t;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);t>r;++r){o+=(n[r][e][1]-n[r][e-1][1])/a}i+=o*n[t][e][1]}g[e]=c-=u?i/u*a:0,l>c&&(l=c)}for(e=0;h>e;++e){g[e]-=l}return g},expand:function(n){var t,e,r,u=n.length,i=n[0].length,o=1/u,a=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++){r+=n[t][e][1]}if(r){for(t=0;u>t;t++){n[t][e][1]/=r}}else{for(t=0;u>t;t++){n[t][e][1]=o}}}for(e=0;i>e;++e){a[e]=0}return a},zero:pu});mo.layout.histogram=function(){function n(n,i){for(var o,a,c=[],l=n.map(e,this),s=r.call(this,l,i),f=u.call(this,s,l,i),i=-1,h=l.length,g=f.length-1,p=t?1:1/h;++i<g;){o=c[i]=[],o.dx=f[i+1]-(o.x=f[i]),o.y=0}if(g>0){for(i=-1;++i<h;){a=l[i],a>=s[0]&&a<=s[1]&&(o=c[mo.bisect(f,a,1,g)-1],o.y+=p,o.push(n[i]))}}return c}var t=!0,e=Number,r=xu,u=yu;return n.value=function(t){return arguments.length?(e=t,n):e},n.range=function(t){return arguments.length?(r=pt(t),n):r},n.bins=function(t){return arguments.length?(u="number"==typeof t?function(n){return Mu(n,t)}:pt(t),n):u},n.frequency=function(e){return arguments.length?(t=!!e,n):t},n},mo.layout.tree=function(){function n(n,i){function o(n,t){var r=n.children,u=n._tree;if(r&&(i=r.length)){for(var i,a,l,s=r[0],f=s,h=-1;++h<i;){l=r[h],o(l,a),f=c(l,a,f),a=l}Tu(n);var g=0.5*(s._tree.prelim+l._tree.prelim);t?(u.prelim=t._tree.prelim+e(n,t),u.mod=u.prelim-g):u.prelim=g}else{t&&(u.prelim=t._tree.prelim+e(n,t))}}function a(n,t){n.x=n._tree.prelim+t;var e=n.children;if(e&&(r=e.length)){var r,u=-1;for(t+=n._tree.mod;++u<r;){a(e[u],t)}}}function c(n,t,r){if(t){for(var u,i=n,o=n,a=t,c=n.parent.children[0],l=i._tree.mod,s=o._tree.mod,f=a._tree.mod,h=c._tree.mod;a=wu(a),i=_u(i),a&&i;){c=_u(c),o=wu(o),o._tree.ancestor=n,u=a._tree.prelim+f-i._tree.prelim-l+e(a,i),u>0&&(qu(zu(a,n,r),n,u),l+=u,s+=u),f+=a._tree.mod,l+=i._tree.mod,h+=c._tree.mod,s+=o._tree.mod}a&&!wu(o)&&(o._tree.thread=a,o._tree.mod+=f-s),i&&!_u(c)&&(c._tree.thread=i,c._tree.mod+=l-h,r=n)}return r}var l=t.call(this,n,i),s=l[0];Nu(s,function(n,t){n._tree={ancestor:n,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),o(s),a(s,-s._tree.prelim);var f=Su(s,ku),h=Su(s,Eu),g=Su(s,Au),p=f.x-e(f,h)/2,d=h.x+e(h,f)/2,v=g.depth||1;return Nu(s,u?function(n){n.x*=r[0],n.y=n.depth*r[1],delete n._tree}:function(n){n.x=(n.x-p)/(d-p)*r[0],n.y=n.depth/v*r[1],delete n._tree}),l}var t=mo.layout.hierarchy().sort(null).value(null),e=bu,r=[1,1],u=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(u=null==(r=t),n):u?null:r},n.nodeSize=function(t){return arguments.length?(u=null!=(r=t),n):u?r:null},iu(n,t)},mo.layout.pack=function(){function n(n,i){var o=e.call(this,n,i),a=o[0],c=u[0],l=u[1],s=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(a.x=a.y=0,Nu(a,function(n){n.r=+s(n.value)}),Nu(a,Hu),r){var f=r*(t?1:Math.max(2*a.r/c,2*a.r/l))/2;Nu(a,function(n){n.r+=f}),Nu(a,Hu),Nu(a,function(n){n.r-=f})}return Ou(a,c/2,l/2,t?1:1/Math.max(2*a.r/c,2*a.r/l)),o}var t,e=mo.layout.hierarchy().sort(Cu),r=0,u=[1,1];return n.size=function(t){return arguments.length?(u=t,n):u},n.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,n):t},n.padding=function(t){return arguments.length?(r=+t,n):r},iu(n,e)},mo.layout.cluster=function(){function n(n,i){var o,a=t.call(this,n,i),c=a[0],l=0;Nu(c,function(n){var t=n.children;t&&t.length?(n.x=Iu(t),n.y=Yu(t)):(n.x=o?l+=e(n,o):0,n.y=0,o=n)});var s=Uu(c),f=Zu(c),h=s.x-e(s,f)/2,g=f.x+e(f,s)/2;return Nu(c,u?function(n){n.x=(n.x-c.x)*r[0],n.y=(c.y-n.y)*r[1]}:function(n){n.x=(n.x-h)/(g-h)*r[0],n.y=(1-(c.y?n.y/c.y:1))*r[1]}),a}var t=mo.layout.hierarchy().sort(null).value(null),e=bu,r=[1,1],u=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(u=null==(r=t),n):u?null:r},n.nodeSize=function(t){return arguments.length?(u=null!=(r=t),n):u?r:null},iu(n,t)},mo.layout.treemap=function(){function n(n,t){for(var e,r,u=-1,i=n.length;++u<i;){r=(e=n[u]).value*(0>t?0:t),e.area=isNaN(r)||0>=r?0:r}}function t(e){var i=e.children;if(i&&i.length){var o,a,c,l=f(e),s=[],h=i.slice(),p=1/0,d="slice"===g?l.dx:"dice"===g?l.dy:"slice-dice"===g?1&e.depth?l.dy:l.dx:Math.min(l.dx,l.dy);for(n(h,l.dx*l.dy/e.value),s.area=0;(c=h.length)>0;){s.push(o=h[c-1]),s.area+=o.area,"squarify"!==g||(a=r(s,d))<=p?(h.pop(),p=a):(s.area-=s.pop().area,u(s,d,l,!1),d=Math.min(l.dx,l.dy),s.length=s.area=0,p=1/0)}s.length&&(u(s,d,l,!0),s.length=s.area=0),i.forEach(t)}}function e(t){var r=t.children;if(r&&r.length){var i,o=f(t),a=r.slice(),c=[];for(n(a,o.dx*o.dy/t.value),c.area=0;i=a.pop();){c.push(i),c.area+=i.area,null!=i.z&&(u(c,i.z?o.dx:o.dy,o,!a.length),c.length=c.area=0)}r.forEach(e)}}function r(n,t){for(var e,r=n.area,u=0,i=1/0,o=-1,a=n.length;++o<a;){(e=n[o].area)&&(i>e&&(i=e),e>u&&(u=e))}return r*=r,t*=t,r?Math.max(t*u*p/r,r/(t*i*p)):1/0}function u(n,t,e,r){var u,i=-1,o=n.length,a=e.x,l=e.y,s=t?c(n.area/t):0;if(t==e.dx){for((r||s>e.dy)&&(s=e.dy);++i<o;){u=n[i],u.x=a,u.y=l,u.dy=s,a+=u.dx=Math.min(e.x+e.dx-a,s?c(u.area/s):0)}u.z=!0,u.dx+=e.x+e.dx-a,e.y+=s,e.dy-=s}else{for((r||s>e.dx)&&(s=e.dx);++i<o;){u=n[i],u.x=a,u.y=l,u.dx=s,l+=u.dy=Math.min(e.y+e.dy-l,s?c(u.area/s):0)}u.z=!1,u.dy+=e.y+e.dy-l,e.x+=s,e.dx-=s}}function i(r){var u=o||a(r),i=u[0];return i.x=0,i.y=0,i.dx=l[0],i.dy=l[1],o&&a.revalue(i),n([i],i.dx*i.dy/i.value),(o?e:t)(i),h&&(o=u),u}var o,a=mo.layout.hierarchy(),c=Math.round,l=[1,1],s=null,f=Vu,h=!1,g="squarify",p=0.5*(1+Math.sqrt(5));return i.size=function(n){return arguments.length?(l=n,i):l},i.padding=function(n){function t(t){var e=n.call(i,t,t.depth);return null==e?Vu(t):Xu(t,"number"==typeof e?[e,e,e,e]:e)}function e(t){return Xu(t,n)}if(!arguments.length){return s}var r;return f=null==(s=n)?Vu:"function"==(r=typeof n)?t:"number"===r?(n=[n,n,n,n],e):e,i},i.round=function(n){return arguments.length?(c=n?Math.round:Number,i):c!=Number},i.sticky=function(n){return arguments.length?(h=n,o=null,i):h},i.ratio=function(n){return arguments.length?(p=n,i):p},i.mode=function(n){return arguments.length?(g=n+"",i):g},iu(i,a)},mo.random={normal:function(n,t){var e=arguments.length;return 2>e&&(t=1),1>e&&(n=0),function(){var e,r,u;do{e=2*Math.random()-1,r=2*Math.random()-1,u=e*e+r*r}while(!u||u>1);return n+t*e*Math.sqrt(-2*Math.log(u)/u)}},logNormal:function(){var n=mo.random.normal.apply(mo,arguments);return function(){return Math.exp(n())}},irwinHall:function(n){return function(){for(var t=0,e=0;n>e;e++){t+=Math.random()}return t/n}}},mo.scale={};var Nc={floor:dt,ceil:dt};mo.scale.linear=function(){return Qu([0,1],[0,1],Er,!1)},mo.scale.log=function(){return ii(mo.scale.linear().domain([0,1]),10,!0,[1,10])};var Tc=mo.format(".0e"),qc={floor:function(n){return -Math.ceil(-n)},ceil:function(n){return -Math.floor(-n)}};mo.scale.pow=function(){return oi(mo.scale.linear(),1,[0,1])},mo.scale.sqrt=function(){return mo.scale.pow().exponent(0.5)},mo.scale.ordinal=function(){return ci([],{t:"range",a:[[]]})},mo.scale.category10=function(){return mo.scale.ordinal().range(zc)},mo.scale.category20=function(){return mo.scale.ordinal().range(Cc)},mo.scale.category20b=function(){return mo.scale.ordinal().range(Dc)},mo.scale.category20c=function(){return mo.scale.ordinal().range(jc)};var zc=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(it),Cc=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(it),Dc=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(it),jc=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(it);mo.scale.quantile=function(){return li([],[])},mo.scale.quantize=function(){return si(0,1,[0,1])},mo.scale.threshold=function(){return fi([0.5],[0,1])},mo.scale.identity=function(){return hi([0,1])},mo.svg.arc=function(){function n(){var n=t.apply(this,arguments),i=e.apply(this,arguments),o=r.apply(this,arguments)+Lc,a=u.apply(this,arguments)+Lc,c=(o>a&&(c=o,o=a,a=c),a-o),l=Bo>c?"0":"1",s=Math.cos(o),f=Math.sin(o),h=Math.cos(a),g=Math.sin(a);return c>=Hc?n?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+n+"A"+n+","+n+" 0 1,0 0,"+-n+"A"+n+","+n+" 0 1,0 0,"+n+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z":n?"M"+i*s+","+i*f+"A"+i+","+i+" 0 "+l+",1 "+i*h+","+i*g+"L"+n*h+","+n*g+"A"+n+","+n+" 0 "+l+",0 "+n*s+","+n*f+"Z":"M"+i*s+","+i*f+"A"+i+","+i+" 0 "+l+",1 "+i*h+","+i*g+"L0,0Z"}var t=gi,e=pi,r=di,u=vi;return n.innerRadius=function(e){return arguments.length?(t=pt(e),n):t},n.outerRadius=function(t){return arguments.length?(e=pt(t),n):e},n.startAngle=function(t){return arguments.length?(r=pt(t),n):r},n.endAngle=function(t){return arguments.length?(u=pt(t),n):u},n.centroid=function(){var n=(t.apply(this,arguments)+e.apply(this,arguments))/2,i=(r.apply(this,arguments)+u.apply(this,arguments))/2+Lc;return[Math.cos(i)*n,Math.sin(i)*n]},n};var Lc=-Bo/2,Hc=2*Bo-0.000001;mo.svg.line.radial=function(){var n=Ue(mi);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},We.reverse=Je,Je.reverse=We,mo.svg.area=function(){return yi(dt)},mo.svg.area.radial=function(){var n=yi(mi);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},mo.svg.chord=function(){function n(n,a){var c=t(this,i,n,a),l=t(this,o,n,a);return"M"+c.p0+r(c.r,c.p1,c.a1-c.a0)+(e(c,l)?u(c.r,c.p1,c.r,c.p0):u(c.r,c.p1,l.r,l.p0)+r(l.r,l.p1,l.a1-l.a0)+u(l.r,l.p1,c.r,c.p0))+"Z"}function t(n,t,e,r){var u=t.call(n,e,r),i=a.call(n,u,r),o=c.call(n,u,r)+Lc,s=l.call(n,u,r)+Lc;return{r:i,a0:o,a1:s,p0:[i*Math.cos(o),i*Math.sin(o)],p1:[i*Math.cos(s),i*Math.sin(s)]}}function e(n,t){return n.a0==t.a0&&n.a1==t.a1}function r(n,t,e){return"A"+n+","+n+" 0 "+ +(e>Bo)+",1 "+t}function u(n,t,e,r){return"Q 0,0 "+r}var i=De,o=je,a=Mi,c=di,l=vi;return n.radius=function(t){return arguments.length?(a=pt(t),n):a},n.source=function(t){return arguments.length?(i=pt(t),n):i},n.target=function(t){return arguments.length?(o=pt(t),n):o},n.startAngle=function(t){return arguments.length?(c=pt(t),n):c},n.endAngle=function(t){return arguments.length?(l=pt(t),n):l},n},mo.svg.diagonal=function(){function n(n,u){var i=t.call(this,n,u),o=e.call(this,n,u),a=(i.y+o.y)/2,c=[i,{x:i.x,y:a},{x:o.x,y:a},o];return c=c.map(r),"M"+c[0]+"C"+c[1]+" "+c[2]+" "+c[3]}var t=De,e=je,r=xi;return n.source=function(e){return arguments.length?(t=pt(e),n):t},n.target=function(t){return arguments.length?(e=pt(t),n):e},n.projection=function(t){return arguments.length?(r=t,n):r},n},mo.svg.diagonal.radial=function(){var n=mo.svg.diagonal(),t=xi,e=n.projection;return n.projection=function(n){return arguments.length?e(bi(t=n)):t},n},mo.svg.symbol=function(){function n(n,r){return(Fc.get(t.call(this,n,r))||Si)(e.call(this,n,r))}var t=wi,e=_i;return n.type=function(e){return arguments.length?(t=pt(e),n):t},n.size=function(t){return arguments.length?(e=pt(t),n):e},n};var Fc=mo.map({circle:Si,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*Yc)),e=t*Yc;return"M0,"+-t+"L"+e+",0 0,"+t+" "+-e+",0Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/Rc),e=t*Rc/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/Rc),e=t*Rc/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});mo.svg.symbolTypes=Fc.keys();var Pc,Oc,Rc=Math.sqrt(3),Yc=Math.tan(30*Go),Ic=[],Uc=0;Ic.call=Ro.call,Ic.empty=Ro.empty,Ic.node=Ro.node,Ic.size=Ro.size,mo.transition=function(n){return arguments.length?Pc?n.transition():n:Uo.transition()},mo.transition.prototype=Ic,Ic.select=function(n){var t,e,r,u=this.id,i=[];n=d(n);for(var o=-1,a=this.length;++o<a;){i.push(t=[]);for(var c=this[o],l=-1,s=c.length;++l<s;){(r=c[l])&&(e=n.call(r,r.__data__,l,o))?("__data__" in r&&(e.__data__=r.__data__),Ni(e,l,u,r.__transition__[u]),t.push(e)):t.push(null)}}return Ei(i,u)},Ic.selectAll=function(n){var t,e,r,u,i,o=this.id,a=[];n=v(n);for(var c=-1,l=this.length;++c<l;){for(var s=this[c],f=-1,h=s.length;++f<h;){if(r=s[f]){i=r.__transition__[o],e=n.call(r,r.__data__,f,c),a.push(t=[]);for(var g=-1,p=e.length;++g<p;){(u=e[g])&&Ni(u,g,o,i),t.push(u)}}}}return Ei(a,o)},Ic.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=k(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]);for(var e=this[i],a=0,c=e.length;c>a;a++){(r=e[a])&&n.call(r,r.__data__,a)&&t.push(r)}}return Ei(u,this.id)},Ic.tween=function(n,t){var e=this.id;return arguments.length<2?this.node().__transition__[e].tween.get(n):N(this,null==t?function(t){t.__transition__[e].tween.remove(n)}:function(r){r.__transition__[e].tween.set(n,t)})},Ic.attr=function(n,t){function e(){this.removeAttribute(a)}function r(){this.removeAttributeNS(a.space,a.local)}function u(n){return null==n?e:(n+="",function(){var t,e=this.getAttribute(a);return e!==n&&(t=o(e,n),function(n){this.setAttribute(a,t(n))})})}function i(n){return null==n?r:(n+="",function(){var t,e=this.getAttributeNS(a.space,a.local);return e!==n&&(t=o(e,n),function(n){this.setAttributeNS(a.space,a.local,t(n))})})}if(arguments.length<2){for(t in n){this.attr(t,n[t])}return this}var o="transform"==n?Br:Er,a=mo.ns.qualify(n);return ki(this,"attr."+n,t,a.local?i:u)},Ic.attrTween=function(n,t){function e(n,e){var r=t.call(this,n,e,this.getAttribute(u));return r&&function(n){this.setAttribute(u,r(n))}}function r(n,e){var r=t.call(this,n,e,this.getAttributeNS(u.space,u.local));return r&&function(n){this.setAttributeNS(u.space,u.local,r(n))}}var u=mo.ns.qualify(n);return this.tween("attr."+n,u.local?r:e)},Ic.style=function(n,t,e){function r(){this.style.removeProperty(n)}function u(t){return null==t?r:(t+="",function(){var r,u=_o.getComputedStyle(this,null).getPropertyValue(n);return u!==t&&(r=Er(u,t),function(t){this.style.setProperty(n,r(t),e)})})}var i=arguments.length;if(3>i){if("string"!=typeof n){2>i&&(t="");for(e in n){this.style(e,n[e],t)}return this}e=""}return ki(this,"style."+n,t,u)},Ic.styleTween=function(n,t,e){function r(r,u){var i=t.call(this,r,u,_o.getComputedStyle(this,null).getPropertyValue(n));return i&&function(t){this.style.setProperty(n,i(t),e)}}return arguments.length<3&&(e=""),this.tween("style."+n,r)},Ic.text=function(n){return ki(this,"text",n,Ai)},Ic.remove=function(){return this.each("end.transition",function(){var n;this.__transition__.count<2&&(n=this.parentNode)&&n.removeChild(this)})},Ic.ease=function(n){var t=this.id;return arguments.length<1?this.node().__transition__[t].ease:("function"!=typeof n&&(n=mo.ease.apply(mo,arguments)),N(this,function(e){e.__transition__[t].ease=n}))},Ic.delay=function(n){var t=this.id;return N(this,"function"==typeof n?function(e,r,u){e.__transition__[t].delay=+n.call(e,e.__data__,r,u)}:(n=+n,function(e){e.__transition__[t].delay=n}))},Ic.duration=function(n){var t=this.id;return N(this,"function"==typeof n?function(e,r,u){e.__transition__[t].duration=Math.max(1,n.call(e,e.__data__,r,u))}:(n=Math.max(1,n),function(e){e.__transition__[t].duration=n}))},Ic.each=function(n,t){var e=this.id;if(arguments.length<2){var r=Oc,u=Pc;Pc=e,N(this,function(t,r,u){Oc=t.__transition__[e],n.call(t,t.__data__,r,u)}),Oc=r,Pc=u}else{N(this,function(r){var u=r.__transition__[e];(u.event||(u.event=mo.dispatch("start","end"))).on(n,t)})}return this},Ic.transition=function(){for(var n,t,e,r,u=this.id,i=++Uc,o=[],a=0,c=this.length;c>a;a++){o.push(n=[]);for(var t=this[a],l=0,s=t.length;s>l;l++){(e=t[l])&&(r=Object.create(e.__transition__[u]),r.delay+=r.duration,Ni(e,l,i,r)),n.push(e)}}return Ei(o,i)},mo.svg.axis=function(){function n(n){n.each(function(){var n,l=mo.select(this),s=null==c?e.ticks?e.ticks.apply(e,a):e.domain():c,f=null==t?e.tickFormat?e.tickFormat.apply(e,a):dt:t,h=l.selectAll(".tick").data(s,dt),g=h.enter().insert("g",".domain").attr("class","tick").style("opacity",0.000001),p=mo.transition(h.exit()).style("opacity",0.000001).remove(),d=mo.transition(h).style("opacity",1),v=Bu(e),m=l.selectAll(".domain").data([0]),y=(m.enter().append("path").attr("class","domain"),mo.transition(m)),M=e.copy(),x=this.__chart__||M;this.__chart__=M,g.append("line"),g.append("text");var b=g.select("line"),_=d.select("line"),w=h.select("text").text(f),S=g.select("text"),E=d.select("text");switch(r){case"bottom":n=Ti,b.attr("y2",u),S.attr("y",Math.max(u,0)+o),_.attr("x2",0).attr("y2",u),E.attr("x",0).attr("y",Math.max(u,0)+o),w.attr("dy",".71em").style("text-anchor","middle"),y.attr("d","M"+v[0]+","+i+"V0H"+v[1]+"V"+i);break;case"top":n=Ti,b.attr("y2",-u),S.attr("y",-(Math.max(u,0)+o)),_.attr("x2",0).attr("y2",-u),E.attr("x",0).attr("y",-(Math.max(u,0)+o)),w.attr("dy","0em").style("text-anchor","middle"),y.attr("d","M"+v[0]+","+-i+"V0H"+v[1]+"V"+-i);break;case"left":n=qi,b.attr("x2",-u),S.attr("x",-(Math.max(u,0)+o)),_.attr("x2",-u).attr("y2",0),E.attr("x",-(Math.max(u,0)+o)).attr("y",0),w.attr("dy",".32em").style("text-anchor","end"),y.attr("d","M"+-i+","+v[0]+"H0V"+v[1]+"H"+-i);break;case"right":n=qi,b.attr("x2",u),S.attr("x",Math.max(u,0)+o),_.attr("x2",u).attr("y2",0),E.attr("x",Math.max(u,0)+o).attr("y",0),w.attr("dy",".32em").style("text-anchor","start"),y.attr("d","M"+i+","+v[0]+"H0V"+v[1]+"H"+i)}if(e.rangeBand){var k=M.rangeBand()/2,A=function(n){return M(n)+k};g.call(n,A),d.call(n,A)}else{g.call(n,x),d.call(n,M),p.call(n,M)}})}var t,e=mo.scale.linear(),r=Zc,u=6,i=6,o=3,a=[10],c=null;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(r=t in Vc?t+"":Zc,n):r},n.ticks=function(){return arguments.length?(a=arguments,n):a},n.tickValues=function(t){return arguments.length?(c=t,n):c},n.tickFormat=function(e){return arguments.length?(t=e,n):t},n.tickSize=function(t){var e=arguments.length;return e?(u=+t,i=+arguments[e-1],n):u},n.innerTickSize=function(t){return arguments.length?(u=+t,n):u},n.outerTickSize=function(t){return arguments.length?(i=+t,n):i},n.tickPadding=function(t){return arguments.length?(o=+t,n):o},n.tickSubdivide=function(){return arguments.length&&n},n};var Zc="bottom",Vc={top:1,right:1,bottom:1,left:1};mo.svg.brush=function(){function n(i){i.each(function(){var i=mo.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",u).on("touchstart.brush",u),o=i.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=i.selectAll(".resize").data(v,dt);a.exit().remove(),a.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return Xc[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",n.empty()?"none":null);var s,f=mo.transition(i),h=mo.transition(o);c&&(s=Bu(c),h.attr("x",s[0]).attr("width",s[1]-s[0]),e(f)),l&&(s=Bu(l),h.attr("y",s[0]).attr("height",s[1]-s[0]),r(f)),t(f)})}function t(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+s[+/e$/.test(n)]+","+h[+/^s/.test(n)]+")"})}function e(n){n.select(".extent").attr("x",s[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",s[1]-s[0])}function r(n){n.select(".extent").attr("y",h[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function u(){function u(){32==mo.event.keyCode&&(N||(M=null,q[0]-=s[1],q[1]-=h[1],N=2),f())}function g(){32==mo.event.keyCode&&2==N&&(q[0]+=s[1],q[1]+=h[1],N=0,f())}function v(){var n=mo.mouse(b),u=!1;x&&(n[0]+=x[0],n[1]+=x[1]),N||(mo.event.altKey?(M||(M=[(s[0]+s[1])/2,(h[0]+h[1])/2]),q[0]=s[+(n[0]<M[0])],q[1]=h[+(n[1]<M[1])]):M=null),k&&m(n,c,0)&&(e(S),u=!0),A&&m(n,l,1)&&(r(S),u=!0),u&&(t(S),w({type:"brush",mode:N?"move":"resize"}))}function m(n,t,e){var r,u,a=Bu(t),c=a[0],l=a[1],f=q[e],g=e?h:s,v=g[1]-g[0];return N&&(c-=f,l-=v+f),r=(e?d:p)?Math.max(c,Math.min(l,n[e])):n[e],N?u=(r+=f)+v:(M&&(f=Math.max(c,Math.min(l,2*M[e]-r))),r>f?(u=r,r=f):u=f),g[0]!=r||g[1]!=u?(e?o=null:i=null,g[0]=r,g[1]=u,!0):void 0}function y(){v(),S.style("pointer-events","all").selectAll(".resize").style("display",n.empty()?"none":null),mo.select("body").style("cursor",null),z.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),T(),w({type:"brushend"})}var M,x,b=this,_=mo.select(mo.event.target),w=a.of(b,arguments),S=mo.select(b),E=_.datum(),k=!/^(n|s)$/.test(E)&&c,A=!/^(e|w)$/.test(E)&&l,N=_.classed("extent"),T=L(),q=mo.mouse(b),z=mo.select(_o).on("keydown.brush",u).on("keyup.brush",g);if(mo.event.changedTouches?z.on("touchmove.brush",v).on("touchend.brush",y):z.on("mousemove.brush",v).on("mouseup.brush",y),S.interrupt().selectAll("*").interrupt(),N){q[0]=s[0]-q[0],q[1]=h[0]-q[1]}else{if(E){var C=+/w$/.test(E),D=+/^n/.test(E);x=[s[1-C]-q[0],h[1-D]-q[1]],q[0]=s[C],q[1]=h[D]}else{mo.event.altKey&&(M=q.slice())}}S.style("pointer-events","none").selectAll(".resize").style("display",null),mo.select("body").style("cursor",_.style("cursor")),w({type:"brushstart"}),v()}var i,o,a=g(n,"brushstart","brush","brushend"),c=null,l=null,s=[0,0],h=[0,0],p=!0,d=!0,v=$c[0];return n.event=function(n){n.each(function(){var n=a.of(this,arguments),t={x:s,y:h,i:i,j:o},e=this.__chart__||t;this.__chart__=t,Pc?mo.select(this).transition().each("start.brush",function(){i=e.i,o=e.j,s=e.x,h=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var e=kr(s,t.x),r=kr(h,t.y);return i=o=null,function(u){s=t.x=e(u),h=t.y=r(u),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){i=t.i,o=t.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},n.x=function(t){return arguments.length?(c=t,v=$c[!c<<1|!l],n):c},n.y=function(t){return arguments.length?(l=t,v=$c[!c<<1|!l],n):l},n.clamp=function(t){return arguments.length?(c&&l?(p=!!t[0],d=!!t[1]):c?p=!!t:l&&(d=!!t),n):c&&l?[p,d]:c?p:l?d:null},n.extent=function(t){var e,r,u,a,f;return arguments.length?(c&&(e=t[0],r=t[1],l&&(e=e[0],r=r[0]),i=[e,r],c.invert&&(e=c(e),r=c(r)),e>r&&(f=e,e=r,r=f),(e!=s[0]||r!=s[1])&&(s=[e,r])),l&&(u=t[0],a=t[1],c&&(u=u[1],a=a[1]),o=[u,a],l.invert&&(u=l(u),a=l(a)),u>a&&(f=u,u=a,a=f),(u!=h[0]||a!=h[1])&&(h=[u,a])),n):(c&&(i?(e=i[0],r=i[1]):(e=s[0],r=s[1],c.invert&&(e=c.invert(e),r=c.invert(r)),e>r&&(f=e,e=r,r=f))),l&&(o?(u=o[0],a=o[1]):(u=h[0],a=h[1],l.invert&&(u=l.invert(u),a=l.invert(a)),u>a&&(f=u,u=a,a=f))),c&&l?[[e,u],[r,a]]:c?[e,r]:l&&[u,a])},n.clear=function(){return n.empty()||(s=[0,0],h=[0,0],i=o=null),n},n.empty=function(){return !!c&&s[0]==s[1]||!!l&&h[0]==h[1]},mo.rebind(n,a,"on")};var Xc={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},$c=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Bc=mo.time={},Wc=Date,Jc=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];zi.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Gc.setUTCDate.apply(this._,arguments)},setDay:function(){Gc.setUTCDay.apply(this._,arguments)},setFullYear:function(){Gc.setUTCFullYear.apply(this._,arguments)},setHours:function(){Gc.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Gc.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Gc.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Gc.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Gc.setUTCSeconds.apply(this._,arguments)},setTime:function(){Gc.setTime.apply(this._,arguments)}};var Gc=Date.prototype,Kc="%a %b %e %X %Y",Qc="%m/%d/%Y",nl="%H:%M:%S",tl=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],el=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],rl=["January","February","March","April","May","June","July","August","September","October","November","December"],ul=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];Bc.year=Ci(function(n){return n=Bc.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),Bc.years=Bc.year.range,Bc.years.utc=Bc.year.utc.range,Bc.day=Ci(function(n){var t=new Wc(2000,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),Bc.days=Bc.day.range,Bc.days.utc=Bc.day.utc.range,Bc.dayOfYear=function(n){var t=Bc.year(n);return Math.floor((n-t-60000*(n.getTimezoneOffset()-t.getTimezoneOffset()))/86400000)},Jc.forEach(function(n,t){n=n.toLowerCase(),t=7-t;var e=Bc[n]=Ci(function(n){return(n=Bc.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var e=Bc.year(n).getDay();return Math.floor((Bc.dayOfYear(n)+(e+t)%7)/7)-(e!==t)});Bc[n+"s"]=e.range,Bc[n+"s"].utc=e.utc.range,Bc[n+"OfYear"]=function(n){var e=Bc.year(n).getDay();return Math.floor((Bc.dayOfYear(n)+(e+t)%7)/7)}}),Bc.week=Bc.sunday,Bc.weeks=Bc.sunday.range,Bc.weeks.utc=Bc.sunday.utc.range,Bc.weekOfYear=Bc.sundayOfYear,Bc.format=ji;var il=Hi(tl),ol=Fi(tl),al=Hi(el),cl=Fi(el),ll=Hi(rl),sl=Fi(rl),fl=Hi(ul),hl=Fi(ul),gl=/^%/,pl={"-":"",_:" ",0:"0"},dl={a:function(n){return el[n.getDay()]},A:function(n){return tl[n.getDay()]},b:function(n){return ul[n.getMonth()]},B:function(n){return rl[n.getMonth()]},c:ji(Kc),d:function(n,t){return Pi(n.getDate(),t,2)},e:function(n,t){return Pi(n.getDate(),t,2)},H:function(n,t){return Pi(n.getHours(),t,2)},I:function(n,t){return Pi(n.getHours()%12||12,t,2)},j:function(n,t){return Pi(1+Bc.dayOfYear(n),t,3)},L:function(n,t){return Pi(n.getMilliseconds(),t,3)},m:function(n,t){return Pi(n.getMonth()+1,t,2)},M:function(n,t){return Pi(n.getMinutes(),t,2)},p:function(n){return n.getHours()>=12?"PM":"AM"},S:function(n,t){return Pi(n.getSeconds(),t,2)},U:function(n,t){return Pi(Bc.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return Pi(Bc.mondayOfYear(n),t,2)},x:ji(Qc),X:ji(nl),y:function(n,t){return Pi(n.getFullYear()%100,t,2)},Y:function(n,t){return Pi(n.getFullYear()%10000,t,4)},Z:ao,"%":function(){return"%"}},vl={a:Oi,A:Ri,b:Zi,B:Vi,c:Xi,d:no,e:no,H:eo,I:eo,j:to,L:io,m:Qi,M:ro,p:oo,S:uo,U:Ii,w:Yi,W:Ui,x:$i,X:Bi,y:Ji,Y:Wi,Z:Gi,"%":co},ml=/^\s*\d+/,yl=mo.map({am:0,pm:1});ji.utc=lo;var Ml=lo("%Y-%m-%dT%H:%M:%S.%LZ");ji.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?so:Ml,so.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},so.toString=Ml.toString,Bc.second=Ci(function(n){return new Wc(1000*Math.floor(n/1000))},function(n,t){n.setTime(n.getTime()+1000*Math.floor(t))},function(n){return n.getSeconds()}),Bc.seconds=Bc.second.range,Bc.seconds.utc=Bc.second.utc.range,Bc.minute=Ci(function(n){return new Wc(60000*Math.floor(n/60000))},function(n,t){n.setTime(n.getTime()+60000*Math.floor(t))},function(n){return n.getMinutes()}),Bc.minutes=Bc.minute.range,Bc.minutes.utc=Bc.minute.utc.range,Bc.hour=Ci(function(n){var t=n.getTimezoneOffset()/60;return new Wc(3600000*(Math.floor(n/3600000-t)+t))},function(n,t){n.setTime(n.getTime()+3600000*Math.floor(t))},function(n){return n.getHours()}),Bc.hours=Bc.hour.range,Bc.hours.utc=Bc.hour.utc.range,Bc.month=Ci(function(n){return n=Bc.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),Bc.months=Bc.month.range,Bc.months.utc=Bc.month.utc.range;var xl=[1000,5000,15000,30000,60000,300000,900000,1800000,3600000,10800000,21600000,43200000,86400000,172800000,604800000,2592000000,7776000000,31536000000],bl=[[Bc.second,1],[Bc.second,5],[Bc.second,15],[Bc.second,30],[Bc.minute,1],[Bc.minute,5],[Bc.minute,15],[Bc.minute,30],[Bc.hour,1],[Bc.hour,3],[Bc.hour,6],[Bc.hour,12],[Bc.day,1],[Bc.day,2],[Bc.week,1],[Bc.month,1],[Bc.month,3],[Bc.year,1]],_l=[[ji("%Y"),Vt],[ji("%B"),function(n){return n.getMonth()}],[ji("%b %d"),function(n){return 1!=n.getDate()}],[ji("%a %d"),function(n){return n.getDay()&&1!=n.getDate()}],[ji("%I %p"),function(n){return n.getHours()}],[ji("%I:%M"),function(n){return n.getMinutes()}],[ji(":%S"),function(n){return n.getSeconds()}],[ji(".%L"),function(n){return n.getMilliseconds()}]],wl=go(_l);bl.year=Bc.year,Bc.scale=function(){return fo(mo.scale.linear(),bl,wl)};var Sl={range:function(n,t,e){return mo.range(+n,+t,e).map(ho)}},El=bl.map(function(n){return[n[0].utc,n[1]]}),kl=[[lo("%Y"),Vt],[lo("%B"),function(n){return n.getUTCMonth()}],[lo("%b %d"),function(n){return 1!=n.getUTCDate()}],[lo("%a %d"),function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],[lo("%I %p"),function(n){return n.getUTCHours()}],[lo("%I:%M"),function(n){return n.getUTCMinutes()}],[lo(":%S"),function(n){return n.getUTCSeconds()}],[lo(".%L"),function(n){return n.getUTCMilliseconds()}]],Al=go(kl);return El.year=Bc.year.utc,Bc.scale.utc=function(){return fo(mo.scale.linear(),El,Al)},mo.text=vt(function(n){return n.responseText}),mo.json=function(n,t){return mt(n,"application/json",po,t)},mo.html=function(n,t){return mt(n,"text/html",vo,t)},mo.xml=vt(function(n){return n.responseXML}),mo}();
/*!
 *  dc 2.0.0-dev
 *  http://nickqizhu.github.io/dc.js/
 *  Copyright 2012 Nick Zhu and other contributors
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */
;dc=(function(){var dc={version:"2.0.0-dev",constants:{CHART_CLASS:"dc-chart",DEBUG_GROUP_CLASS:"debug",STACK_CLASS:"stack",DESELECTED_CLASS:"deselected",SELECTED_CLASS:"selected",NODE_INDEX_NAME:"__index__",GROUP_INDEX_NAME:"__group_index__",DEFAULT_CHART_GROUP:"__default_chart_group__",EVENT_DELAY:40,NEGLIGIBLE_NUMBER:1e-10},_renderlet:null};dc.chartRegistry=function(){var _chartMap={};function initializeChartGroup(group){if(!group){group=dc.constants.DEFAULT_CHART_GROUP}if(!_chartMap[group]){_chartMap[group]=[]}return group}return{has:function(chart){for(var e in _chartMap){if(_chartMap[e].indexOf(chart)>=0){return true}}return false},register:function(chart,group){group=initializeChartGroup(group);_chartMap[group].push(chart)},clear:function(group){if(group){delete _chartMap[group]}else{_chartMap={}}},list:function(group){group=initializeChartGroup(group);return _chartMap[group]}}}();dc.registerChart=function(chart,group){dc.chartRegistry.register(chart,group)};dc.hasChart=function(chart){return dc.chartRegistry.has(chart)};dc.deregisterAllCharts=function(group){dc.chartRegistry.clear(group)};dc.filterAll=function(group){var charts=dc.chartRegistry.list(group);for(var i=0;i<charts.length;++i){charts[i].filterAll()}};dc.renderAll=function(group){var charts=dc.chartRegistry.list(group);for(var i=0;i<charts.length;++i){charts[i].render()}if(dc._renderlet!==null){dc._renderlet(group)}};dc.redrawAll=function(group){var charts=dc.chartRegistry.list(group);for(var i=0;i<charts.length;++i){charts[i].redraw()}if(dc._renderlet!==null){dc._renderlet(group)}};dc.disableTransitions=false;dc.transition=function(selections,duration,callback){if(duration<=0||duration===undefined||dc.disableTransitions){return selections}var s=selections.transition().duration(duration);if(typeof(callback)==="function"){callback(s)}return s};dc.units={};dc.units.integers=function(s,e){return Math.abs(e-s)};dc.units.ordinal=function(s,e,domain){return domain};dc.units.fp={};dc.units.fp.precision=function(precision){var _f=function(s,e){var d=Math.abs((e-s)/_f.resolution);if(dc.utils.isNegligible(d-Math.floor(d))){return Math.floor(d)}else{return Math.ceil(d)}};_f.resolution=precision;return _f};dc.round={};dc.round.floor=function(n){return Math.floor(n)};dc.round.ceil=function(n){return Math.ceil(n)};dc.round.round=function(n){return Math.round(n)};dc.override=function(obj,functionName,newFunction){var existingFunction=obj[functionName];obj["_"+functionName]=existingFunction;obj[functionName]=newFunction};dc.renderlet=function(_){if(!arguments.length){return dc._renderlet}dc._renderlet=_;return dc};dc.instanceOfChart=function(o){return o instanceof Object&&o.__dc_flag__&&true};dc.errors={};dc.errors.Exception=function(msg){var _msg=msg||"Unexpected internal error";this.message=_msg;this.toString=function(){return _msg}};dc.errors.InvalidStateException=function(){dc.errors.Exception.apply(this,arguments)};dc.dateFormat=d3.time.format("%m/%d/%Y");dc.printers={};dc.printers.filters=function(filters){var s="";for(var i=0;i<filters.length;++i){if(i>0){s+=", "}s+=dc.printers.filter(filters[i])}return s};dc.printers.filter=function(filter){var s="";if(filter){if(filter instanceof Array){if(filter.length>=2){s="["+dc.utils.printSingleValue(filter[0])+" -> "+dc.utils.printSingleValue(filter[1])+"]"}else{if(filter.length>=1){s=dc.utils.printSingleValue(filter[0])}}}else{s=dc.utils.printSingleValue(filter)}}return s};dc.pluck=function(n,f){return function(d,i){return f?f.call(this,d[n],i):d[n]}};dc.utils={};dc.utils.printSingleValue=function(filter){var s=""+filter;if(filter instanceof Date){s=dc.dateFormat(filter)}else{if(typeof(filter)=="string"){s=filter}else{if(dc.utils.isFloat(filter)){s=dc.utils.printSingleValue.fformat(filter)}else{if(dc.utils.isInteger(filter)){s=Math.round(filter)}}}}return s};dc.utils.printSingleValue.fformat=d3.format(".2f");dc.utils.add=function(l,r){if(typeof r==="string"){r=r.replace("%","")}if(l instanceof Date){if(typeof r==="string"){r=+r}var d=new Date();d.setTime(l.getTime());d.setDate(l.getDate()+r);return d}else{if(typeof r==="string"){var percentage=(+r/100);return l>0?l*(1+percentage):l*(1-percentage)}else{return l+r}}};dc.utils.subtract=function(l,r){if(typeof r==="string"){r=r.replace("%","")}if(l instanceof Date){if(typeof r==="string"){r=+r}var d=new Date();d.setTime(l.getTime());d.setDate(l.getDate()-r);return d}else{if(typeof r==="string"){var percentage=(+r/100);return l<0?l*(1+percentage):l*(1-percentage)}else{return l-r}}};dc.utils.GroupStack=function(){var _dataLayers=[[]];var _groups=[];var _defaultAccessor;var _hideChartGroup;function initializeDataLayer(i){if(!_dataLayers[i]){_dataLayers[i]=[]}}this.setDataPoint=function(layerIndex,pointIndex,data){initializeDataLayer(layerIndex);_dataLayers[layerIndex][pointIndex]=data};this.getDataPoint=function(x,y){initializeDataLayer(x);var dataPoint=_dataLayers[x][y];if(dataPoint===undefined){dataPoint=0}return dataPoint};this.addGroup=function(group,accessor){if(!accessor){accessor=_defaultAccessor}_groups.push([group,accessor]);return _groups.length-1};this.addNamedGroup=function(group,name,accessor){var groupIndex=this.addGroup(group,accessor);_groups[groupIndex].name=name;return name};this.getGroupByIndex=function(index){return _groups[index][0]};this.getAccessorByIndex=function(index){return _groups[index][1]};this.getNameOfVisibleByIndex=function(index){if(index===-1){if(_hideChartGroup){index++}else{return}}var visible=_groups.filter(function(group){return !group.hidden});return visible[index].name};this.size=function(){return _groups.length};this.clear=function(){_dataLayers=[];_groups=[]};this.setDefaultAccessor=function(retriever){_defaultAccessor=retriever};this.getDataLayers=function(){return _dataLayers};this.clearDataLayers=function(){_dataLayers=[[]]};this.showGroups=function(name,showChartGroup){if(showChartGroup){_hideChartGroup=false}this.toggleGroups(name,false)};this.hideGroups=function(name,hideChartGroup){if(hideChartGroup){_hideChartGroup=true}this.toggleGroups(name,true)};this.toggleGroups=function(name,value){for(var i=0;i<_groups.length;++i){if(_groups[i].name===name){_groups[i].hidden=value}}};this.setTitle=function(name,titleAccessor){for(var i=0;i<_groups.length;++i){if(_groups[i].name===name){_groups[i].title=titleAccessor}}};this.getTitle=function(name){for(var i=0;i<_groups.length;++i){if(_groups[i].name===name){return _groups[i].title}}};this.toLayers=function(){var layers=[];for(var i=0;i<_dataLayers.length;++i){if(i===0&&_hideChartGroup){continue}if(i>0&&_groups[i-1].hidden){continue}var layer={index:i,points:[]};var dataPoints=_dataLayers[i];for(var j=0;j<dataPoints.length;++j){layer.points.push(dataPoints[j])}layers.push(layer)}return layers}};dc.utils.isNumber=function(n){return n===+n};dc.utils.isFloat=function(n){return n===+n&&n!==(n|0)};dc.utils.isInteger=function(n){return n===+n&&n===(n|0)};dc.utils.isNegligible=function(max){return max===undefined||(max<dc.constants.NEGLIGIBLE_NUMBER&&max>-dc.constants.NEGLIGIBLE_NUMBER)};dc.utils.clamp=function(val,min,max){return val<min?min:(val>max?max:val)};var _idCounter=0;dc.utils.uniqueId=function(){return ++_idCounter};dc.utils.groupMax=function(group,accessor){var max=d3.max(group.all(),accessor);if(dc.utils.isNegligible(max)){max=0}return max};dc.utils.groupMin=function(group,accessor){var min=d3.min(group.all(),accessor);if(dc.utils.isNegligible(min)){min=0}return min};dc.utils.nameToId=function(name){return name.toLowerCase().replace(/[\s]/g,"_").replace(/[\.']/g,"")};dc.utils.appendOrSelect=function(parent,name){var element=parent.select(name);if(element.empty()){element=parent.append(name)}return element};dc.utils.createLegendable=function(chart,group,accessor,color){var legendable={name:chart._getGroupName(group,accessor),data:group};if(color){legendable.color=color}if(chart.dashStyle&&chart.dashStyle()){legendable.dashstyle=chart.dashStyle()}return legendable};dc.utils.safeNumber=function(n){return dc.utils.isNumber(+n)?+n:0};dc.events={current:null};dc.events.trigger=function(closure,delay){if(!delay){closure();return}dc.events.current=closure;setTimeout(function(){if(closure==dc.events.current){closure()}},delay)};dc.baseChart=function(_chart){_chart.__dc_flag__=dc.utils.uniqueId();var _dimension;var _group;var _anchor;var _root;var _svg;var _minWidth=200;var _default_width=function(element){var width=element&&element.getBoundingClientRect&&element.getBoundingClientRect().width;return(width&&width>_minWidth)?width:_minWidth};var _width=_default_width;var _minHeight=200;var _default_height=function(element){var height=element&&element.getBoundingClientRect&&element.getBoundingClientRect().height;return(height&&height>_minHeight)?height:_minHeight};var _height=_default_height;var _keyAccessor=dc.pluck("key");var _valueAccessor=dc.pluck("value");var _label=dc.pluck("key");var _ordering=dc.pluck("key");var _orderSort;var _renderLabel=false;var _title=function(d){return _chart.keyAccessor()(d)+": "+_chart.valueAccessor()(d)};var _renderTitle=false;var _transitionDuration=750;var _filterPrinter=dc.printers.filters;var _renderlets=[];var _mandatoryAttributes=["dimension","group"];var _chartGroup=dc.constants.DEFAULT_CHART_GROUP;var NULL_LISTENER=function(){};var _listeners={preRender:NULL_LISTENER,postRender:NULL_LISTENER,preRedraw:NULL_LISTENER,postRedraw:NULL_LISTENER,filtered:NULL_LISTENER,zoomed:NULL_LISTENER};var _legend;var _filters=[];var _filterHandler=function(dimension,filters){dimension.filter(null);if(filters.length===0){dimension.filter(null)}else{dimension.filterFunction(function(d){for(var i=0;i<filters.length;i++){var filter=filters[i];if(filter.isFiltered&&filter.isFiltered(d)){return true}else{if(filter==d){return true}}}return false})}return filters};var _data=function(group){return group.all()};_chart.width=function(w){if(!arguments.length){return _width(_root.node())}_width=d3.functor(w||_default_width);return _chart};_chart.height=function(h){if(!arguments.length){return _height(_root.node())}_height=d3.functor(h||_default_height);return _chart};_chart.minWidth=function(w){if(!arguments.length){return _minWidth}_minWidth=w;return _chart};_chart.minHeight=function(w){if(!arguments.length){return _minHeight}_minHeight=w;return _chart};_chart.dimension=function(d){if(!arguments.length){return _dimension}_dimension=d;_chart.expireCache();return _chart};_chart.data=function(d){if(!arguments.length){return _data.call(_chart,_group)}_data=d3.functor(d);_chart.expireCache();return _chart};_chart.group=function(g,name){if(!arguments.length){return _group}_group=g;_chart.expireCache();if(typeof name==="string"){_chart._setGroupName(_group,name)}return _chart};function groupName(chart,g,accessor){var c=chart.chartID(),k="__names__";if(!accessor||accessor==chart.valueAccessor()){accessor="default"}if(!g[k]){g[k]={}}if(!g[k][c]){g[k][c]={a:[],n:[]}}var i=g[k][c].a.indexOf(accessor);if(i==-1){i=g[k][c].a.length;g[k][c].a[i]=accessor;g[k][c].n[i]={name:""}}return g[k][c].n[i]}_chart._getGroupName=function(g,accessor){return groupName(_chart,g,accessor).name};_chart._setGroupName=function(g,name,accessor){groupName(_chart,g,accessor).name=name};_chart.ordering=function(o){if(!arguments.length){return _ordering}_ordering=o;_orderSort=crossfilter.quicksort.by(_ordering);_chart.expireCache();return _chart};_chart.computeOrderedGroups=function(data){if(data.length<=1){return data}if(!_orderSort){_orderSort=crossfilter.quicksort.by(_ordering)}return _orderSort(data,0,data.length)};_chart.filterAll=function(){return _chart.filter(null)};_chart.dataSet=function(){return _dimension!==undefined&&_group!==undefined};_chart.select=function(s){return _root.select(s)};_chart.selectAll=function(s){return _root?_root.selectAll(s):null};_chart.anchor=function(a,chartGroup){if(!arguments.length){return _anchor}if(dc.instanceOfChart(a)){_anchor=a.anchor();_root=a.root()}else{_anchor=a;_root=d3.select(_anchor);_root.classed(dc.constants.CHART_CLASS,true);dc.registerChart(_chart,chartGroup)}_chartGroup=chartGroup;return _chart};_chart.anchorName=function(){var a=_chart.anchor();if(a&&a.id){return a.id}if(a&&a.replace){return a.replace("#","")}return""+_chart.chartID()};_chart.root=function(r){if(!arguments.length){return _root}_root=r;return _chart};_chart.svg=function(_){if(!arguments.length){return _svg}_svg=_;return _chart};_chart.resetSvg=function(){_chart.select("svg").remove();return generateSvg()};function generateSvg(){_svg=_chart.root().append("svg").attr("width",_chart.width()).attr("height",_chart.height());return _svg}_chart.filterPrinter=function(_){if(!arguments.length){return _filterPrinter}_filterPrinter=_;return _chart};_chart.turnOnControls=function(){if(_root){_chart.selectAll(".reset").style("visibility","visible");_chart.selectAll(".filter").text(_filterPrinter(_chart.filters())).style("visibility","visible")}return _chart};_chart.turnOffControls=function(){if(_root){_chart.selectAll(".reset").style("visibility","hidden");_chart.selectAll(".filter").style("visibility","hidden").text(_chart.filter())}return _chart};_chart.transitionDuration=function(d){if(!arguments.length){return _transitionDuration}_transitionDuration=d;return _chart};_chart._mandatoryAttributes=function(_){if(!arguments.length){return _mandatoryAttributes}_mandatoryAttributes=_;return _chart};function checkForMandatoryAttributes(a){if(!_chart[a]||!_chart[a]()){throw new dc.errors.InvalidStateException("Mandatory attribute chart."+a+" is missing on chart[#"+_chart.anchorName()+"]")}}_chart.render=function(){_listeners.preRender(_chart);if(_mandatoryAttributes){_mandatoryAttributes.forEach(checkForMandatoryAttributes)}var result=_chart.doRender();if(_legend){_legend.render()}_chart.activateRenderlets("postRender");return result};_chart.activateRenderlets=function(event){if(_chart.transitionDuration()>0&&_svg){_svg.transition().duration(_chart.transitionDuration()).each("end",function(){runAllRenderlets();if(event){_listeners[event](_chart)}})}else{runAllRenderlets();if(event){_listeners[event](_chart)}}};_chart.redraw=function(){_listeners.preRedraw(_chart);var result=_chart.doRedraw();_chart.activateRenderlets("postRedraw");return result};_chart._invokeFilteredListener=function(f){if(f!==undefined){_listeners.filtered(_chart,f)}};_chart._invokeZoomedListener=function(){_listeners.zoomed(_chart)};_chart.hasFilter=function(filter){if(!arguments.length){return _filters.length>0}return _filters.indexOf(filter)>=0};function removeFilter(_){_filters.splice(_filters.indexOf(_),1);applyFilters();_chart._invokeFilteredListener(_)}function addFilter(_){_filters.push(_);applyFilters();_chart._invokeFilteredListener(_)}function resetFilters(){_filters=[];applyFilters();_chart._invokeFilteredListener(null)}function applyFilters(){if(_chart.dimension()&&_chart.dimension().filter){var fs=_filterHandler(_chart.dimension(),_filters);_filters=fs?fs:_filters}}_chart.replaceFilter=function(_){_filters=[];_chart.filter(_)};_chart.filter=function(_){if(!arguments.length){return _filters.length>0?_filters[0]:null}if(_ instanceof Array&&_[0] instanceof Array){_[0].forEach(function(d){if(_chart.hasFilter(d)){_filters.splice(_filters.indexOf(d),1)}else{_filters.push(d)}});applyFilters();_chart._invokeFilteredListener(_)}else{if(_===null){resetFilters()}else{if(_chart.hasFilter(_)){removeFilter(_)}else{addFilter(_)}}}if(_root!==null&&_chart.hasFilter()){_chart.turnOnControls()}else{_chart.turnOffControls()}return _chart};_chart.filters=function(){return _filters};_chart.highlightSelected=function(e){d3.select(e).classed(dc.constants.SELECTED_CLASS,true);d3.select(e).classed(dc.constants.DESELECTED_CLASS,false)};_chart.fadeDeselected=function(e){d3.select(e).classed(dc.constants.SELECTED_CLASS,false);d3.select(e).classed(dc.constants.DESELECTED_CLASS,true)};_chart.resetHighlight=function(e){d3.select(e).classed(dc.constants.SELECTED_CLASS,false);d3.select(e).classed(dc.constants.DESELECTED_CLASS,false)};_chart.onClick=function(d){var filter=_chart.keyAccessor()(d);dc.events.trigger(function(){_chart.filter(filter);dc.redrawAll(_chart.chartGroup())})};_chart.filterHandler=function(_){if(!arguments.length){return _filterHandler}_filterHandler=_;return _chart};_chart.doRender=function(){return _chart};_chart.doRedraw=function(){return _chart};_chart.legendables=function(){return[]};_chart.legendHighlight=function(d){};_chart.legendReset=function(d){};_chart.legendToggle=function(d){};_chart.isLegendableHidden=function(d){return false};_chart.keyAccessor=function(_){if(!arguments.length){return _keyAccessor}_keyAccessor=_;return _chart};_chart.valueAccessor=function(_){if(!arguments.length){return _valueAccessor}_valueAccessor=_;return _chart};_chart.label=function(_){if(!arguments.length){return _label}_label=_;_renderLabel=true;return _chart};_chart.renderLabel=function(_){if(!arguments.length){return _renderLabel}_renderLabel=_;return _chart};_chart.title=function(_){if(!arguments.length){return _title}_title=_;_renderTitle=true;return _chart};_chart.renderTitle=function(_){if(!arguments.length){return _renderTitle}_renderTitle=_;return _chart};_chart.renderlet=function(_){_renderlets.push(_);return _chart};function runAllRenderlets(){for(var i=0;i<_renderlets.length;++i){_renderlets[i](_chart)}}_chart.chartGroup=function(_){if(!arguments.length){return _chartGroup}_chartGroup=_;return _chart};_chart.expireCache=function(){return _chart};_chart.legend=function(l){if(!arguments.length){return _legend}_legend=l;_legend.parent(_chart);return _chart};_chart.on=function(event,listener){_listeners[event]=listener;return _chart};_chart.chartID=function(){return _chart.__dc_flag__};return _chart};dc.marginable=function(_chart){var _margin={top:10,right:50,bottom:30,left:30};_chart.margins=function(m){if(!arguments.length){return _margin}_margin=m;return _chart};_chart.effectiveWidth=function(){return _chart.width()-_chart.margins().left-_chart.margins().right};_chart.effectiveHeight=function(){return _chart.height()-_chart.margins().top-_chart.margins().bottom};return _chart};dc.coordinateGridChart=function(_chart){var GRID_LINE_CLASS="grid-line";var HORIZONTAL_CLASS="horizontal";var VERTICAL_CLASS="vertical";var Y_AXIS_LABEL_CLASS="y-axis-label";var X_AXIS_LABEL_CLASS="x-axis-label";var DEFAULT_AXIS_LABLEL_PADDING=12;_chart=dc.colorChart(dc.marginable(dc.baseChart(_chart)));_chart.colors(d3.scale.category10());_chart._mandatoryAttributes().push("x");var _parent;var _g;var _chartBodyG;var _x;var _xOriginalDomain;var _xAxis=d3.svg.axis();var _xUnits=dc.units.integers;var _xAxisPadding=0;var _xElasticity=false;var _xAxisLabel;var _xAxisLabelPadding=0;var _y;var _yAxis=d3.svg.axis();var _yAxisPadding=0;var _yElasticity=false;var _yAxisLabel;var _yAxisLabelPadding=0;var _brush=d3.svg.brush();var _brushOn=true;var _round;var _renderHorizontalGridLine=false;var _renderVerticalGridLine=false;var _refocused=false;var _unitCount;var _zoomScale=[1,Infinity];var _zoomOutRestrict=true;var _zoom=d3.behavior.zoom().on("zoom",zoomHandler);var _nullZoom=d3.behavior.zoom().on("zoom",null);var _rangeChart;var _focusChart;var _mouseZoomable=false;var _clipPadding=0;var _outerRangeBandPadding=0.5;var _rangeBandPadding=0;_chart.rescale=function(){_unitCount=undefined};_chart.rangeChart=function(_){if(!arguments.length){return _rangeChart}_rangeChart=_;_rangeChart.focusChart(_chart);return _chart};_chart.zoomScale=function(_){if(!arguments.length){return _zoomScale}_zoomScale=_;return _chart};_chart.zoomOutRestrict=function(r){if(!arguments.length){return _zoomOutRestrict}_zoomScale[0]=r?1:0;_zoomOutRestrict=r;return _chart};_chart._generateG=function(parent){if(parent===undefined){_parent=_chart.svg()}else{_parent=parent}_g=_parent.append("g");_chartBodyG=_g.append("g").attr("class","chart-body").attr("transform","translate("+_chart.margins().left+", "+_chart.margins().top+")").attr("clip-path","url(#"+getClipPathId()+")");return _g};_chart.g=function(_){if(!arguments.length){return _g}_g=_;return _chart};_chart.mouseZoomable=function(z){if(!arguments.length){return _mouseZoomable}_mouseZoomable=z;return _chart};_chart.chartBodyG=function(_){if(!arguments.length){return _chartBodyG}_chartBodyG=_;return _chart};_chart.x=function(_){if(!arguments.length){return _x}_x=_;_xOriginalDomain=_x.domain();return _chart};_chart.xOriginalDomain=function(){return _xOriginalDomain};_chart.xUnits=function(_){if(!arguments.length){return _xUnits}_xUnits=_;return _chart};_chart.xAxis=function(_){if(!arguments.length){return _xAxis}_xAxis=_;return _chart};_chart.elasticX=function(_){if(!arguments.length){return _xElasticity}_xElasticity=_;return _chart};_chart.xAxisPadding=function(_){if(!arguments.length){return _xAxisPadding}_xAxisPadding=_;return _chart};_chart.xUnitCount=function(){if(_unitCount===undefined){var units=_chart.xUnits()(_chart.x().domain()[0],_chart.x().domain()[1],_chart.x().domain());if(units instanceof Array){_unitCount=units.length}else{_unitCount=units}}return _unitCount};_chart.isOrdinal=function(){return _chart.xUnits()===dc.units.ordinal};function prepareXAxis(g){if(_chart.elasticX()&&!_chart.isOrdinal()){_x.domain([_chart.xAxisMin(),_chart.xAxisMax()])}else{if(_chart.isOrdinal()&&_x.domain().length===0){var orderedData=_chart.computeOrderedGroups(_chart.data());_x.domain(orderedData.map(_chart.keyAccessor()))}}if(_chart.isOrdinal()){_x.rangeBands([0,_chart.xAxisLength()],_rangeBandPadding,_outerRangeBandPadding)}else{_x.range([0,_chart.xAxisLength()])}_xAxis=_xAxis.scale(_chart.x()).orient("bottom");renderVerticalGridLines(g)}_chart.renderXAxis=function(g){var axisXG=g.selectAll("g.x");if(axisXG.empty()){axisXG=g.append("g").attr("class","axis x").attr("transform","translate("+_chart.margins().left+","+_chart.xAxisY()+")")}var axisXLab=g.selectAll("text."+X_AXIS_LABEL_CLASS);if(axisXLab.empty()&&_chart.xAxisLabel()){axisXLab=g.append("text").attr("transform","translate("+(_chart.margins().left+_chart.xAxisLength()/2)+","+(_chart.height()-_xAxisLabelPadding)+")").attr("class",X_AXIS_LABEL_CLASS).attr("text-anchor","middle").text(_chart.xAxisLabel())}if(_chart.xAxisLabel()&&axisXLab.text()!=_chart.xAxisLabel()){axisYLab.text(_chart.xAxisLabel())}dc.transition(axisXG,_chart.transitionDuration()).call(_xAxis)};function renderVerticalGridLines(g){var gridLineG=g.selectAll("g."+VERTICAL_CLASS);if(_renderVerticalGridLine){if(gridLineG.empty()){gridLineG=g.insert("g",":first-child").attr("class",GRID_LINE_CLASS+" "+VERTICAL_CLASS).attr("transform","translate("+_chart.yAxisX()+","+_chart.margins().top+")")}var ticks=_xAxis.tickValues()?_xAxis.tickValues():_x.ticks(_xAxis.ticks()[0]);var lines=gridLineG.selectAll("line").data(ticks);var linesGEnter=lines.enter().append("line").attr("x1",function(d){return _x(d)}).attr("y1",_chart.xAxisY()-_chart.margins().top).attr("x2",function(d){return _x(d)}).attr("y2",0).attr("opacity",0);dc.transition(linesGEnter,_chart.transitionDuration()).attr("opacity",1);dc.transition(lines,_chart.transitionDuration()).attr("x1",function(d){return _x(d)}).attr("y1",_chart.xAxisY()-_chart.margins().top).attr("x2",function(d){return _x(d)}).attr("y2",0);lines.exit().remove()}else{gridLineG.selectAll("line").remove()}}_chart.xAxisY=function(){return(_chart.height()-_chart.margins().bottom)};_chart.xAxisLength=function(){return _chart.effectiveWidth()};_chart.xAxisLabel=function(_,pad){if(!arguments.length){return _xAxisLabel}_xAxisLabel=_;_chart.margins().bottom-=_xAxisLabelPadding;_xAxisLabelPadding=(pad===undefined)?DEFAULT_AXIS_LABLEL_PADDING:pad;_chart.margins().bottom+=_xAxisLabelPadding;return _chart};function prepareYAxis(g){if(_y===undefined||_chart.elasticY()){_y=d3.scale.linear();_y.domain([_chart.yAxisMin(),_chart.yAxisMax()]).rangeRound([_chart.yAxisHeight(),0])}_y.range([_chart.yAxisHeight(),0]);_yAxis=_yAxis.scale(_y).orient("left");renderHorizontalGridLines(g)}_chart.renderYAxis=function(g){var axisYG=g.selectAll("g.y");if(axisYG.empty()){axisYG=g.append("g").attr("class","axis y").attr("transform","translate("+_chart.yAxisX()+","+_chart.margins().top+")")}var axisYLab=g.selectAll("text."+Y_AXIS_LABEL_CLASS);if(axisYLab.empty()&&_chart.yAxisLabel()){axisYLab=g.append("text").attr("transform","translate("+_yAxisLabelPadding+","+(_chart.margins().top+_chart.yAxisHeight()/2)+"),rotate(-90)").attr("class",Y_AXIS_LABEL_CLASS).attr("text-anchor","middle").text(_chart.yAxisLabel())}if(_chart.yAxisLabel()&&axisYLab.text()!=_chart.yAxisLabel()){axisYLab.text(_chart.yAxisLabel())}dc.transition(axisYG,_chart.transitionDuration()).call(_yAxis)};function renderHorizontalGridLines(g){var gridLineG=g.selectAll("g."+HORIZONTAL_CLASS);if(_renderHorizontalGridLine){var ticks=_yAxis.tickValues()?_yAxis.tickValues():_y.ticks(_yAxis.ticks()[0]);if(gridLineG.empty()){gridLineG=g.insert("g",":first-child").attr("class",GRID_LINE_CLASS+" "+HORIZONTAL_CLASS).attr("transform","translate("+_chart.yAxisX()+","+_chart.margins().top+")")}var lines=gridLineG.selectAll("line").data(ticks);var linesGEnter=lines.enter().append("line").attr("x1",1).attr("y1",function(d){return _y(d)}).attr("x2",_chart.xAxisLength()).attr("y2",function(d){return _y(d)}).attr("opacity",0);dc.transition(linesGEnter,_chart.transitionDuration()).attr("opacity",1);dc.transition(lines,_chart.transitionDuration()).attr("x1",1).attr("y1",function(d){return _y(d)}).attr("x2",_chart.xAxisLength()).attr("y2",function(d){return _y(d)});lines.exit().remove()}else{gridLineG.selectAll("line").remove()}}_chart.yAxisX=function(){return _chart.margins().left};_chart.yAxisLabel=function(_,pad){if(!arguments.length){return _yAxisLabel}_yAxisLabel=_;_chart.margins().left-=_yAxisLabelPadding;_yAxisLabelPadding=(pad===undefined)?DEFAULT_AXIS_LABLEL_PADDING:pad;_chart.margins().left+=_yAxisLabelPadding;return _chart};_chart.y=function(_){if(!arguments.length){return _y}_y=_;return _chart};_chart.yAxis=function(y){if(!arguments.length){return _yAxis}_yAxis=y;return _chart};_chart.elasticY=function(_){if(!arguments.length){return _yElasticity}_yElasticity=_;return _chart};_chart.renderHorizontalGridLines=function(_){if(!arguments.length){return _renderHorizontalGridLine}_renderHorizontalGridLine=_;return _chart};_chart.renderVerticalGridLines=function(_){if(!arguments.length){return _renderVerticalGridLine}_renderVerticalGridLine=_;return _chart};_chart.xAxisMin=function(){var min=d3.min(_chart.data(),function(e){return _chart.keyAccessor()(e)});return dc.utils.subtract(min,_xAxisPadding)};_chart.xAxisMax=function(){var max=d3.max(_chart.data(),function(e){return _chart.keyAccessor()(e)});return dc.utils.add(max,_xAxisPadding)};_chart.yAxisMin=function(){var min=d3.min(_chart.data(),function(e){return _chart.valueAccessor()(e)});return dc.utils.subtract(min,_yAxisPadding)};_chart.yAxisMax=function(){var max=d3.max(_chart.data(),function(e){return _chart.valueAccessor()(e)});return dc.utils.add(max,_yAxisPadding)};_chart.yAxisPadding=function(_){if(!arguments.length){return _yAxisPadding}_yAxisPadding=_;return _chart};_chart.yAxisHeight=function(){return _chart.effectiveHeight()};_chart.round=function(_){if(!arguments.length){return _round}_round=_;return _chart};_chart._rangeBandPadding=function(_){if(!arguments.length){return _rangeBandPadding}_rangeBandPadding=_;return _chart};_chart._outerRangeBandPadding=function(_){if(!arguments.length){return _outerRangeBandPadding}_outerRangeBandPadding=_;return _chart};dc.override(_chart,"filter",function(_){if(!arguments.length){return _chart._filter()}_chart._filter(_);if(_){_chart.brush().extent(_)}else{_chart.brush().clear()}return _chart});_chart.brush=function(_){if(!arguments.length){return _brush}_brush=_;return _chart};function brushHeight(){return _chart.xAxisY()-_chart.margins().top}_chart.renderBrush=function(g){if(_chart.isOrdinal()){_brushOn=false}if(_brushOn){_brush.on("brush",_chart._brushing);_brush.on("brushstart",_chart._disableMouseZoom);_brush.on("brushend",configureMouseZoom);var gBrush=g.append("g").attr("class","brush").attr("transform","translate("+_chart.margins().left+","+_chart.margins().top+")").call(_brush.x(_chart.x()));gBrush.selectAll("rect").attr("height",brushHeight());gBrush.selectAll(".resize").append("path").attr("d",_chart.resizeHandlePath);if(_chart.hasFilter()){_chart.redrawBrush(g)}}};_chart.extendBrush=function(){var extent=_brush.extent();if(_chart.round()){extent[0]=extent.map(_chart.round())[0];extent[1]=extent.map(_chart.round())[1];_g.select(".brush").call(_brush.extent(extent))}return extent};_chart.brushIsEmpty=function(extent){return _brush.empty()||!extent||extent[1]<=extent[0]};_chart._brushing=function(){var extent=_chart.extendBrush();_chart.redrawBrush(_g);if(_chart.brushIsEmpty(extent)){dc.events.trigger(function(){_chart.filter(null);dc.redrawAll(_chart.chartGroup())},dc.constants.EVENT_DELAY)}else{var rangedFilter=dc.filters.RangedFilter(extent[0],extent[1]);dc.events.trigger(function(){_chart.replaceFilter(rangedFilter);dc.redrawAll(_chart.chartGroup())},dc.constants.EVENT_DELAY)}};_chart.redrawBrush=function(g){if(_brushOn){if(_chart.filter()&&_chart.brush().empty()){_chart.brush().extent(_chart.filter())}var gBrush=g.select("g.brush");gBrush.call(_chart.brush().x(_chart.x()));gBrush.selectAll("rect").attr("height",brushHeight())}_chart.fadeDeselectedArea()};_chart.fadeDeselectedArea=function(){};_chart.resizeHandlePath=function(d){var e=+(d=="e"),x=e?1:-1,y=brushHeight()/3;return"M"+(0.5*x)+","+y+"A6,6 0 0 "+e+" "+(6.5*x)+","+(y+6)+"V"+(2*y-6)+"A6,6 0 0 "+e+" "+(0.5*x)+","+(2*y)+"ZM"+(2.5*x)+","+(y+8)+"V"+(2*y-8)+"M"+(4.5*x)+","+(y+8)+"V"+(2*y-8)};function getClipPathId(){return _chart.anchorName()+"-clip"}_chart.clipPadding=function(p){if(!arguments.length){return _clipPadding}_clipPadding=p;return _chart};function generateClipPath(){var defs=dc.utils.appendOrSelect(_parent,"defs");var chartBodyClip=dc.utils.appendOrSelect(defs,"clipPath").attr("id",getClipPathId());var padding=_clipPadding*2;dc.utils.appendOrSelect(chartBodyClip,"rect").attr("width",_chart.xAxisLength()+padding).attr("height",_chart.yAxisHeight()+padding)}_chart._preprocessData=function(){};_chart.doRender=function(){_chart.resetSvg();_chart._preprocessData();_chart._generateG();generateClipPath();drawChart(true);configureMouseZoom();return _chart};_chart.doRedraw=function(){_chart._preprocessData();drawChart(false);return _chart};function drawChart(render){prepareXAxis(_chart.g());prepareYAxis(_chart.g());_chart.plotData();if(_chart.elasticX()||_refocused||render){_chart.renderXAxis(_chart.g())}if(_chart.elasticY()||render){_chart.renderYAxis(_chart.g())}if(render){_chart.renderBrush(_chart.g())}else{_chart.redrawBrush(_chart.g())}}function configureMouseZoom(){if(_mouseZoomable){_chart._enableMouseZoom()}else{_chart._disableMouseZoom()}}_chart._enableMouseZoom=function(){_zoom.x(_chart.x()).scaleExtent(_zoomScale).size([_chart.width(),_chart.height()]);_chart.root().call(_zoom)};_chart._disableMouseZoom=function(){_chart.root().call(_nullZoom)};function zoomHandler(){_refocused=true;if(_zoomOutRestrict){_chart.x().domain(constrainRange(_chart.x().domain(),_xOriginalDomain));if(_rangeChart){_chart.x().domain(constrainRange(_chart.x().domain(),_rangeChart.x().domain()))}}var domain=_chart.x().domain();var domFilter=dc.filters.RangedFilter(domain[0],domain[1]);_chart.replaceFilter(domFilter);_chart.rescale();_chart.redraw();if(_rangeChart&&!rangesEqual(_chart.filter(),_rangeChart.filter())){dc.events.trigger(function(){_rangeChart.replaceFilter(domFilter);_rangeChart.redraw()})}_chart._invokeZoomedListener();dc.events.trigger(function(){dc.redrawAll(_chart.chartGroup())},dc.constants.EVENT_DELAY);_refocused=!rangesEqual(domain,_xOriginalDomain)}function constrainRange(range,constraint){var constrainedRange=[];constrainedRange[0]=d3.max([range[0],constraint[0]]);constrainedRange[1]=d3.min([range[1],constraint[1]]);return constrainedRange}_chart.focus=function(range){if(hasRangeSelected(range)){_chart.x().domain(range)}else{_chart.x().domain(_xOriginalDomain)}_zoom.x(_chart.x());zoomHandler()};_chart.refocused=function(){return _refocused};_chart.focusChart=function(c){if(!arguments.length){return _focusChart}_focusChart=c;_chart.on("filtered",function(chart){if(!rangesEqual(chart.filter(),_focusChart.filter())){dc.events.trigger(function(){_focusChart.focus(chart.filter())})}});return _chart};function rangesEqual(range1,range2){if(!range1&&!range2){return true}if(range1.length===0&&range2.length===0){return true}if(range1&&range2&&range1[0].valueOf()===range2[0].valueOf()&&range1[1].valueOf()===range2[1].valueOf()){return true}return false}_chart.brushOn=function(_){if(!arguments.length){return _brushOn}_brushOn=_;return _chart};function hasRangeSelected(range){return range instanceof Array&&range.length>1}return _chart};dc.colorChart=function(_chart){var _colors=d3.scale.category20c();var _colorAccessor=function(d){return _chart.keyAccessor()(d)};var _colorCalculator=function(value){return _colors(value,_chart)};_chart.colors=function(_){if(!arguments.length){return _colors}if(_ instanceof Array){_colors=d3.scale.quantize().range(_)}else{_colors=_}return _chart};_chart.ordinalColors=function(r){return _chart.colors(d3.scale.ordinal().range(r))};_chart.linearColors=function(r){return _chart.colors(d3.scale.linear().range(r).interpolate(d3.interpolateHcl))};_chart.colorAccessor=function(_){if(!arguments.length){return _colorAccessor}_colorAccessor=_;return _chart};_chart.colorDomain=function(_){if(!arguments.length){return _colors.domain()}_colors.domain(_);return _chart};_chart.calculateColorDomain=function(){var newDomain=[d3.min(_chart.data(),_chart.colorAccessor()),d3.max(_chart.data(),_chart.colorAccessor())];_colors.domain(newDomain)};_chart.getColor=function(d,i){return _colorCalculator(_colorAccessor(d,i))};_chart.colorCalculator=function(_){if(!arguments.length){return _colorCalculator}_colorCalculator=_;return _chart};return _chart};dc.stackableChart=function(_chart){var _groupStack=new dc.utils.GroupStack();var _stackLayout=d3.layout.stack().offset("zero").order("default").values(function(d){return d.points});var _allGroups;var _allValueAccessors;var _allKeyAccessors;var _stackLayers;var _hiddenStacks=[];var _hidableStacks=false;_chart.stack=function(group,name,accessor){if(!arguments.length){_groupStack.clear()}_groupStack.setDefaultAccessor(_chart.valueAccessor());if(typeof name==="string"){_chart._setGroupName(group,name,accessor);_groupStack.addNamedGroup(group,name,accessor)}else{accessor=name;_groupStack.addGroup(group,accessor)}_chart.expireCache();return _chart};_chart.hidableStacks=function(_){if(!arguments.length){return _hidableStacks}_hidableStacks=_;return _chart};_chart.hideStack=function(stackName){_groupStack.hideGroups(stackName,_chart._getGroupName(_chart.group())==stackName)};_chart.showStack=function(stackName){_groupStack.showGroups(stackName,_chart._getGroupName(_chart.group())==stackName)};_chart.expireCache=function(){_allGroups=null;_allValueAccessors=null;_allKeyAccessors=null;_stackLayers=null;return _chart};_chart.allGroups=function(){if(_allGroups===null){_allGroups=[];_allGroups.push(_chart.group());for(var i=0;i<_groupStack.size();++i){_allGroups.push(_groupStack.getGroupByIndex(i))}}return _allGroups};_chart.allValueAccessors=function(){if(_allValueAccessors===null){_allValueAccessors=[];_allValueAccessors.push(_chart.valueAccessor());for(var i=0;i<_groupStack.size();++i){_allValueAccessors.push(_groupStack.getAccessorByIndex(i))}}return _allValueAccessors};_chart.getValueAccessorByIndex=function(groupIndex){return _chart.allValueAccessors()[groupIndex]};_chart.yAxisMin=function(){var min,all=flattenStack();min=d3.min(all,function(p){return(p.y+p.y0<p.y0)?(p.y+p.y0):p.y0});min=dc.utils.subtract(min,_chart.yAxisPadding());return min};_chart.yAxisMax=function(){var max,all=flattenStack();max=d3.max(all,function(p){return p.y+p.y0});max=dc.utils.add(max,_chart.yAxisPadding());return max};function flattenStack(){var all=[];if(_chart.x()){var xDomain=_chart.x().domain();var test;if(_chart.isOrdinal()){var domainSet=d3.set(xDomain);test=function(p){return domainSet.has(p.x)}}else{test=function(p){return p.x>=xDomain[0]&&p.x<=xDomain[xDomain.length-1]}}_chart.stackLayers().forEach(function(e){e.points.forEach(function(p){if(test(p)){all.push(p)}})})}else{_chart.stackLayers().forEach(function(e){all=all.concat(e.points)})}return all}_chart.allKeyAccessors=function(){if(_allKeyAccessors===null){_allKeyAccessors=[];_allKeyAccessors.push(_chart.keyAccessor());for(var i=0;i<_groupStack.size();++i){_allKeyAccessors.push(_chart.keyAccessor())}}return _allKeyAccessors};_chart.getKeyAccessorByIndex=function(groupIndex){return _chart.allKeyAccessors()[groupIndex]};_chart.xAxisMin=function(){var min=_chart.allGroups().reduce(function(min,group,groupIndex){var m=dc.utils.groupMin(group,_chart.getKeyAccessorByIndex(groupIndex));return(min===null||min>m)?m:min},null);return dc.utils.subtract(min,_chart.xAxisPadding())};_chart.xAxisMax=function(){var max=_chart.allGroups().reduce(function(max,group,groupIndex){var m=dc.utils.groupMax(group,_chart.getKeyAccessorByIndex(groupIndex));return(max===null||max<m)?m:max},null);return dc.utils.add(max,_chart.xAxisPadding())};function calculateDataPointMatrix(group,groupIndex){group.all().forEach(function(d,dataIndex){var key=_chart.getKeyAccessorByIndex(groupIndex)(d);var value=_chart.getValueAccessorByIndex(groupIndex)(d);_groupStack.setDataPoint(groupIndex,dataIndex,{data:d,x:key,y:value,layer:groupIndex})})}_chart.calculateDataPointMatrixForAll=function(){_groupStack.clearDataLayers();_chart.allGroups().forEach(calculateDataPointMatrix)};_chart.getChartStack=function(){return _groupStack};dc.override(_chart,"valueAccessor",function(_){if(!arguments.length){return _chart._valueAccessor()}_chart.expireCache();return _chart._valueAccessor(_)});dc.override(_chart,"keyAccessor",function(_){if(!arguments.length){return _chart._keyAccessor()}_chart.expireCache();return _chart._keyAccessor(_)});dc.override(_chart,"title",function(stackName,titleAccessor){if(!stackName){return _chart._title()}var firstStack=_chart.group()&&stackName===_chart._getGroupName(_chart.group());if(typeof stackName==="function"){return _chart._title(stackName)}else{if(!titleAccessor){if(firstStack){return _chart._title()}else{return _groupStack.getTitle(stackName)}}}if(firstStack){return _chart._title(titleAccessor)}else{_groupStack.setTitle(stackName,titleAccessor)}return _chart});_chart.getTitleOfVisibleByIndex=function(index){return _chart.title(_groupStack.getNameOfVisibleByIndex(index-1))||_chart.title()};_chart.stackLayout=function(stack){if(!arguments.length){return _stackLayout}_stackLayout=stack;return _chart};_chart.stackLayers=function(_){if(!arguments.length){if(_stackLayers===null){_chart.calculateDataPointMatrixForAll();var layers=_groupStack.toLayers();if(layers.length===0){return[]}_stackLayers=_chart.stackLayout()(layers)}return _stackLayers}else{_stackLayers=_}};_chart._layerColorAccessor=function(d){return d.layer===undefined?d.index:d.layer};_chart.colorAccessor(_chart._layerColorAccessor);_chart.legendables=function(){return _chart.allGroups().map(function(g,i){return dc.utils.createLegendable(_chart,g,_chart.getValueAccessorByIndex(i),_chart.colorCalculator()(i))})};_chart.isLegendableHidden=function(d){return _hiddenStacks.indexOf(d.name)!==-1};_chart.legendToggle=function(d){if(_hidableStacks){var index;if((index=_hiddenStacks.indexOf(d.name))!==-1){_hiddenStacks.splice(index,1);_chart.showStack(d.name)}else{_hiddenStacks.push(d.name);_chart.hideStack(d.name)}}_chart.render()};return _chart};dc.abstractBubbleChart=function(_chart){var _maxBubbleRelativeSize=0.3;var _minRadiusWithLabel=10;_chart.BUBBLE_NODE_CLASS="node";_chart.BUBBLE_CLASS="bubble";_chart.MIN_RADIUS=10;_chart=dc.colorChart(_chart);_chart.renderLabel(true);_chart.renderTitle(false);_chart.data(function(group){return group.top(Infinity)});var _r=d3.scale.linear().domain([0,100]);var _rValueAccessor=function(d){return d.r};_chart.r=function(_){if(!arguments.length){return _r}_r=_;return _chart};_chart.radiusValueAccessor=function(_){if(!arguments.length){return _rValueAccessor}_rValueAccessor=_;return _chart};_chart.rMin=function(){var min=d3.min(_chart.data(),function(e){return _chart.radiusValueAccessor()(e)});return min};_chart.rMax=function(){var max=d3.max(_chart.data(),function(e){return _chart.radiusValueAccessor()(e)});return max};_chart.bubbleR=function(d){var value=_chart.radiusValueAccessor()(d);var r=_chart.r()(value);if(isNaN(r)||value<=0){r=0}return r};var labelFunction=function(d){return _chart.label()(d)};var labelOpacity=function(d){return(_chart.bubbleR(d)>_minRadiusWithLabel)?1:0};_chart.doRenderLabel=function(bubbleGEnter){if(_chart.renderLabel()){var label=bubbleGEnter.select("text");if(label.empty()){label=bubbleGEnter.append("text").attr("text-anchor","middle").attr("dy",".3em").on("click",_chart.onClick)}label.attr("opacity",0).text(labelFunction);dc.transition(label,_chart.transitionDuration()).attr("opacity",labelOpacity)}};_chart.doUpdateLabels=function(bubbleGEnter){if(_chart.renderLabel()){var labels=bubbleGEnter.selectAll("text").text(labelFunction);dc.transition(labels,_chart.transitionDuration()).attr("opacity",labelOpacity)}};var titleFunction=function(d){return _chart.title()(d)};_chart.doRenderTitles=function(g){if(_chart.renderTitle()){var title=g.select("title");if(title.empty()){g.append("title").text(titleFunction)}}};_chart.doUpdateTitles=function(g){if(_chart.renderTitle()){g.selectAll("title").text(titleFunction)}};_chart.minRadiusWithLabel=function(_){if(!arguments.length){return _minRadiusWithLabel}_minRadiusWithLabel=_;return _chart};_chart.maxBubbleRelativeSize=function(_){if(!arguments.length){return _maxBubbleRelativeSize}_maxBubbleRelativeSize=_;return _chart};_chart.fadeDeselectedArea=function(){if(_chart.hasFilter()){_chart.selectAll("g."+_chart.BUBBLE_NODE_CLASS).each(function(d){if(_chart.isSelectedNode(d)){_chart.highlightSelected(this)}else{_chart.fadeDeselected(this)}})}else{_chart.selectAll("g."+_chart.BUBBLE_NODE_CLASS).each(function(d){_chart.resetHighlight(this)})}};_chart.isSelectedNode=function(d){return _chart.hasFilter(d.key)};_chart.onClick=function(d){var filter=d.key;dc.events.trigger(function(){_chart.filter(filter);dc.redrawAll(_chart.chartGroup())})};return _chart};dc.pieChart=function(parent,chartGroup){var DEFAULT_MIN_ANGLE_FOR_LABEL=0.5;var _sliceCssClass="pie-slice";var _radius,_innerRadius=0;var _g;var _minAngleForLabel=DEFAULT_MIN_ANGLE_FOR_LABEL;var _externalLabelRadius;var _chart=dc.capped(dc.colorChart(dc.baseChart({})));_chart.colorAccessor(_chart.cappedKeyAccessor);_chart.title(function(d){return _chart.cappedKeyAccessor(d)+": "+_chart.cappedValueAccessor(d)});_chart.slicesCap=_chart.cap;_chart.label(_chart.cappedKeyAccessor);_chart.renderLabel(true);_chart.transitionDuration(350);_chart.doRender=function(){_chart.resetSvg();_g=_chart.svg().append("g").attr("transform","translate("+_chart.cx()+","+_chart.cy()+")");drawChart();return _chart};function drawChart(){_radius=_radius?_radius:d3.min([_chart.width(),_chart.height()])/2;var arc=buildArcs();var pie=pieLayout();var pieData=pie(_chart.data());if(_g){var slices=_g.selectAll("g."+_sliceCssClass).data(pieData);createElements(slices,arc,pieData);updateElements(pieData,arc);removeElements(slices);highlightFilter()}}function createElements(slices,arc,pieData){var slicesEnter=createSliceNodes(slices);createSlicePath(slicesEnter,arc);createTitles(slicesEnter);createLabels(pieData,arc)}function createSliceNodes(slices){var slicesEnter=slices.enter().append("g").attr("class",function(d,i){return _sliceCssClass+" _"+i});return slicesEnter}function createSlicePath(slicesEnter,arc){var slicePath=slicesEnter.append("path").attr("fill",fill).on("click",onClick).attr("d",function(d,i){return safeArc(d,i,arc)});slicePath.transition().duration(_chart.transitionDuration()).attrTween("d",tweenPie)}function createTitles(slicesEnter){if(_chart.renderTitle()){slicesEnter.append("title").text(function(d){return _chart.title()(d)})}}function positionLabels(labelsEnter,arc){dc.transition(labelsEnter,_chart.transitionDuration()).attr("transform",function(d){return labelPosition(d,arc)}).attr("text-anchor","middle").text(function(d){var data=d.data;if(sliceHasNoData(data)||sliceTooSmall(d)){return""}return _chart.label()(d.data)})}function createLabels(pieData,arc){if(_chart.renderLabel()){var labels=_g.selectAll("text."+_sliceCssClass).data(pieData);labels.exit().remove();var labelsEnter=labels.enter().append("text").attr("class",function(d,i){var classes=_sliceCssClass+" _"+i;if(_externalLabelRadius){classes+=" external"}return classes}).on("click",onClick);positionLabels(labelsEnter,arc)}}function updateElements(pieData,arc){updateSlicePaths(pieData,arc);updateLabels(pieData,arc);updateTitles(pieData)}function updateSlicePaths(pieData,arc){var slicePaths=_g.selectAll("g."+_sliceCssClass).data(pieData).select("path").attr("d",function(d,i){return safeArc(d,i,arc)});dc.transition(slicePaths,_chart.transitionDuration(),function(s){s.attrTween("d",tweenPie)}).attr("fill",fill)}function updateLabels(pieData,arc){if(_chart.renderLabel()){var labels=_g.selectAll("text."+_sliceCssClass).data(pieData);positionLabels(labels,arc)}}function updateTitles(pieData){if(_chart.renderTitle()){_g.selectAll("g."+_sliceCssClass).data(pieData).select("title").text(function(d){return _chart.title()(d.data)})}}function removeElements(slices){slices.exit().remove()}function highlightFilter(){if(_chart.hasFilter()){_chart.selectAll("g."+_sliceCssClass).each(function(d){if(isSelectedSlice(d)){_chart.highlightSelected(this)}else{_chart.fadeDeselected(this)}})}else{_chart.selectAll("g."+_sliceCssClass).each(function(d){_chart.resetHighlight(this)})}}_chart.innerRadius=function(r){if(!arguments.length){return _innerRadius}_innerRadius=r;return _chart};_chart.radius=function(r){if(!arguments.length){return _radius}_radius=r;return _chart};_chart.cx=function(){return _chart.width()/2};_chart.cy=function(){return _chart.height()/2};function buildArcs(){return d3.svg.arc().outerRadius(_radius).innerRadius(_innerRadius)}function isSelectedSlice(d){return _chart.hasFilter(_chart.cappedKeyAccessor(d.data))}_chart.doRedraw=function(){drawChart();return _chart};_chart.minAngleForLabel=function(_){if(!arguments.length){return _minAngleForLabel}_minAngleForLabel=_;return _chart};function pieLayout(){return d3.layout.pie().sort(null).value(_chart.cappedValueAccessor)}function sliceTooSmall(d){var angle=(d.endAngle-d.startAngle);return isNaN(angle)||angle<_minAngleForLabel}function sliceHasNoData(d){return _chart.cappedValueAccessor(d)===0}function tweenPie(b){b.innerRadius=_innerRadius;var current=this._current;if(isOffCanvas(current)){current={startAngle:0,endAngle:0}}var i=d3.interpolate(current,b);this._current=i(0);return function(t){return safeArc(i(t),0,buildArcs())}}function isOffCanvas(current){return !current||isNaN(current.startAngle)||isNaN(current.endAngle)}function fill(d,i){return _chart.getColor(d.data,i)}function onClick(d,i){_chart.onClick(d.data,i)}function safeArc(d,i,arc){var path=arc(d,i);if(path.indexOf("NaN")>=0){path="M0,0"}return path}_chart.externalLabels=function(radius){if(arguments.length===0){return _externalLabelRadius}else{if(radius){_externalLabelRadius=radius}else{_externalLabelRadius=undefined}}return _chart};function labelPosition(d,arc){var centroid;if(_externalLabelRadius){centroid=d3.svg.arc().outerRadius(_radius+_externalLabelRadius).innerRadius(_radius+_externalLabelRadius).centroid(d)}else{centroid=arc.centroid(d)}if(isNaN(centroid[0])||isNaN(centroid[1])){return"translate(0,0)"}else{return"translate("+centroid+")"}}_chart.legendables=function(){return _chart.data().map(function(d,i){var legendable={name:d.key,data:d.value,others:d.others};legendable.color=_chart.getColor(d,i);return legendable})};_chart.getColor=function(d,i){return _chart.colorCalculator()(_chart.colorAccessor()(d,i))};_chart.legendHighlight=function(d){highlightSliceFromLegendable(d,true)};_chart.legendReset=function(d){highlightSliceFromLegendable(d,false)};_chart.legendToggle=function(d){_chart.onClick({key:d.name,others:d.others})};function highlightSliceFromLegendable(legendable,highlighted){_chart.selectAll("g.pie-slice").each(function(d){if(legendable.name==d.data.key){d3.select(this).classed("highlight",highlighted)}})}return _chart.anchor(parent,chartGroup)};dc.barChart=function(parent,chartGroup){var MIN_BAR_WIDTH=1;var DEFAULT_GAP_BETWEEN_BARS=2;var _chart=dc.stackableChart(dc.coordinateGridChart({}));var _gap=DEFAULT_GAP_BETWEEN_BARS;var _centerBar=false;var _barWidth;dc.override(_chart,"rescale",function(){_chart._rescale();_barWidth=undefined});_chart.plotData=function(){var layers=_chart.chartBodyG().selectAll("g.stack").data(_chart.stackLayers());calculateBarWidth();layers.enter().append("g").attr("class",function(d,i){return"stack _"+i});layers.each(function(d,i){var layer=d3.select(this);renderBars(layer,i,d)});_chart.stackLayers(null)};function barHeight(d){return dc.utils.safeNumber(Math.abs(_chart.y()(d.y+d.y0)-_chart.y()(d.y0)))}function renderBars(layer,layerIndex,d){var bars=layer.selectAll("rect.bar").data(d.points,dc.pluck("data",_chart.keyAccessor()));bars.enter().append("rect").attr("class","bar").attr("fill",_chart.getColor);if(_chart.renderTitle()){bars.append("title").text(dc.pluck("data",_chart.getTitleOfVisibleByIndex(layerIndex)))}if(_chart.isOrdinal()){bars.on("click",onClick)}dc.transition(bars,_chart.transitionDuration()).attr("x",function(d){var x=_chart.x()(d.x);if(_centerBar){x-=_barWidth/2}if(_chart.isOrdinal()){x+=_gap/2}return dc.utils.safeNumber(x)}).attr("y",function(d){var y=_chart.y()(d.y+d.y0);if(d.y<0){y-=barHeight(d)}return dc.utils.safeNumber(y)}).attr("width",_barWidth).attr("height",function(d){return barHeight(d)}).attr("fill",_chart.getColor).select("title").text(dc.pluck("data",_chart.getTitleOfVisibleByIndex(layerIndex)));dc.transition(bars.exit(),_chart.transitionDuration()).attr("height",0).remove()}function calculateBarWidth(){if(_barWidth===undefined){var numberOfBars=_chart.xUnitCount();if(_chart.isOrdinal()&&!_gap){_barWidth=Math.floor(_chart.x().rangeBand())}else{if(_gap){_barWidth=Math.floor((_chart.xAxisLength()-(numberOfBars-1)*_gap)/numberOfBars)}else{_barWidth=Math.floor(_chart.xAxisLength()/(1+_chart.barPadding())/numberOfBars)}}if(_barWidth==Infinity||isNaN(_barWidth)||_barWidth<MIN_BAR_WIDTH){_barWidth=MIN_BAR_WIDTH}}}_chart.fadeDeselectedArea=function(){var bars=_chart.chartBodyG().selectAll("rect.bar");var extent=_chart.brush().extent();if(_chart.isOrdinal()){if(_chart.hasFilter()){bars.classed(dc.constants.SELECTED_CLASS,function(d){return _chart.hasFilter(_chart.keyAccessor()(d.data))});bars.classed(dc.constants.DESELECTED_CLASS,function(d){return !_chart.hasFilter(_chart.keyAccessor()(d.data))})}else{bars.classed(dc.constants.SELECTED_CLASS,false);bars.classed(dc.constants.DESELECTED_CLASS,false)}}else{if(!_chart.brushIsEmpty(extent)){var start=extent[0];var end=extent[1];bars.classed(dc.constants.DESELECTED_CLASS,function(d){var xValue=_chart.keyAccessor()(d.data);return xValue<start||xValue>=end})}else{bars.classed(dc.constants.DESELECTED_CLASS,false)}}};_chart.centerBar=function(_){if(!arguments.length){return _centerBar}_centerBar=_;return _chart};function onClick(d){_chart.onClick(d.data)}_chart.barPadding=function(_){if(!arguments.length){return _chart._rangeBandPadding()}_chart._rangeBandPadding(_);_gap=0;return _chart};_chart.outerPadding=_chart._outerRangeBandPadding;_chart.gap=function(_){if(!arguments.length){return _gap}_gap=_;return _chart};_chart.extendBrush=function(){var extent=_chart.brush().extent();if(_chart.round()&&!_centerBar){extent[0]=extent.map(_chart.round())[0];extent[1]=extent.map(_chart.round())[1];_chart.chartBodyG().select(".brush").call(_chart.brush().extent(extent))}return extent};_chart.legendHighlight=function(d){if(!_chart.isLegendableHidden(d)){_chart.select(".chart-body").selectAll("rect.bar").filter(function(){return d3.select(this).attr("fill")==d.color}).classed("highlight",true);_chart.select(".chart-body").selectAll("rect.bar").filter(function(){return d3.select(this).attr("fill")!=d.color}).classed("fadeout",true)}};_chart.legendReset=function(d){_chart.selectAll(".chart-body").selectAll("rect.bar").filter(function(){return d3.select(this).attr("fill")==d.color}).classed("highlight",false);_chart.selectAll(".chart-body").selectAll("rect.bar").filter(function(){return d3.select(this).attr("fill")!=d.color}).classed("fadeout",false)};dc.override(_chart,"xAxisMax",function(){var max=this._xAxisMax();if("resolution" in _chart.xUnits()){var res=_chart.xUnits().resolution;max+=res}return max});return _chart.anchor(parent,chartGroup)};dc.lineChart=function(parent,chartGroup){var DEFAULT_DOT_RADIUS=5;var TOOLTIP_G_CLASS="dc-tooltip";var DOT_CIRCLE_CLASS="dot";var Y_AXIS_REF_LINE_CLASS="yRef";var X_AXIS_REF_LINE_CLASS="xRef";var DEFAULT_DOT_OPACITY=0.000001;var _chart=dc.stackableChart(dc.coordinateGridChart({}));var _renderArea=false;var _dotRadius=DEFAULT_DOT_RADIUS;var _dataPointRadius=null;var _dataPointFillOpacity=DEFAULT_DOT_OPACITY;var _dataPointStrokeOpacity=DEFAULT_DOT_OPACITY;var _interpolate="linear";var _tension=0.7;var _defined;var _dashStyle;_chart.transitionDuration(500);_chart.plotData=function(){var chartBody=_chart.chartBodyG();var layersList=chartBody.selectAll("g.stack-list");if(layersList.empty()){layersList=chartBody.append("g").attr("class","stack-list")}var layers=layersList.selectAll("g.stack").data(_chart.stackLayers());var layersEnter=layers.enter().append("g").attr("class",function(d,i){return"stack _"+i});drawLine(layersEnter,layers);drawArea(layersEnter,layers);drawDots(chartBody,layers);_chart.stackLayers(null)};_chart.interpolate=function(_){if(!arguments.length){return _interpolate}_interpolate=_;return _chart};_chart.tension=function(_){if(!arguments.length){return _tension}_tension=_;return _chart};_chart.defined=function(_){if(!arguments.length){return _defined}_defined=_;return _chart};_chart.dashStyle=function(_){if(!arguments.length){return _dashStyle}_dashStyle=_;return _chart};_chart.renderArea=function(_){if(!arguments.length){return _renderArea}_renderArea=_;return _chart};function drawLine(layersEnter,layers){var line=d3.svg.line().x(function(d){return _chart.x()(d.x)}).y(function(d){return _chart.y()(d.y+d.y0)}).interpolate(_interpolate).tension(_tension);if(_defined){line.defined(_defined)}var path=layersEnter.append("path").attr("class","line").attr("stroke",_chart.getColor).attr("fill",_chart.getColor);if(_dashStyle){path.attr("stroke-dasharray",_dashStyle)}dc.transition(layers.select("path.line"),_chart.transitionDuration()).attr("d",function(d){return safeD(line(d.points))})}function drawArea(layersEnter,layers){if(_renderArea){var area=d3.svg.area().x(function(d){return _chart.x()(d.x)}).y(function(d){return _chart.y()(d.y+d.y0)}).y0(function(d){return _chart.y()(d.y0)}).interpolate(_interpolate).tension(_tension);if(_defined){area.defined(_defined)}layersEnter.append("path").attr("class","area").attr("fill",_chart.getColor).attr("d",function(d){return safeD(area(d.points))});dc.transition(layers.select("path.area"),_chart.transitionDuration()).attr("d",function(d){return safeD(area(d.points))})}}function safeD(d){return(!d||d.indexOf("NaN")>=0)?"M0,0":d}function drawDots(chartBody,layers){if(!_chart.brushOn()){var tooltipListClass=TOOLTIP_G_CLASS+"-list";var tooltips=chartBody.select("g."+tooltipListClass);if(tooltips.empty()){tooltips=chartBody.append("g").attr("class",tooltipListClass)}layers.each(function(d,layerIndex){var layer=d3.select(this);var points=layer.datum().points;if(_defined){points=points.filter(_defined)}var g=tooltips.select("g."+TOOLTIP_G_CLASS+"._"+layerIndex);if(g.empty()){g=tooltips.append("g").attr("class",TOOLTIP_G_CLASS+" _"+layerIndex)}createRefLines(g);var dots=g.selectAll("circle."+DOT_CIRCLE_CLASS).data(points);dots.enter().append("circle").attr("class",DOT_CIRCLE_CLASS).attr("r",getDotRadius()).attr("fill",_chart.getColor).style("fill-opacity",_dataPointFillOpacity).style("stroke-opacity",_dataPointStrokeOpacity).on("mousemove",function(d){var dot=d3.select(this);showDot(dot);showRefLines(dot,g)}).on("mouseout",function(d){var dot=d3.select(this);hideDot(dot);hideRefLines(g)}).append("title").text(dc.pluck("data",_chart.getTitleOfVisibleByIndex(layerIndex)));dots.attr("cx",function(d){return dc.utils.safeNumber(_chart.x()(d.x))}).attr("cy",function(d){return dc.utils.safeNumber(_chart.y()(d.y+d.y0))}).select("title").text(dc.pluck("data",_chart.getTitleOfVisibleByIndex(layerIndex)));dots.exit().remove()})}}function createRefLines(g){var yRefLine=g.select("path."+Y_AXIS_REF_LINE_CLASS).empty()?g.append("path").attr("class",Y_AXIS_REF_LINE_CLASS):g.select("path."+Y_AXIS_REF_LINE_CLASS);yRefLine.style("display","none").attr("stroke-dasharray","5,5");var xRefLine=g.select("path."+X_AXIS_REF_LINE_CLASS).empty()?g.append("path").attr("class",X_AXIS_REF_LINE_CLASS):g.select("path."+X_AXIS_REF_LINE_CLASS);xRefLine.style("display","none").attr("stroke-dasharray","5,5")}function showDot(dot){dot.style("fill-opacity",0.8);dot.style("stroke-opacity",0.8);dot.attr("r",_dotRadius);return dot}function showRefLines(dot,g){var x=dot.attr("cx");var y=dot.attr("cy");g.select("path."+Y_AXIS_REF_LINE_CLASS).style("display","").attr("d","M0 "+y+"L"+(x)+" "+(y));g.select("path."+X_AXIS_REF_LINE_CLASS).style("display","").attr("d","M"+x+" "+_chart.yAxisHeight()+"L"+x+" "+y)}function getDotRadius(){return _dataPointRadius||_dotRadius}function hideDot(dot){dot.style("fill-opacity",_dataPointFillOpacity).style("stroke-opacity",_dataPointStrokeOpacity).attr("r",getDotRadius())}function hideRefLines(g){g.select("path."+Y_AXIS_REF_LINE_CLASS).style("display","none");g.select("path."+X_AXIS_REF_LINE_CLASS).style("display","none")}_chart.dotRadius=function(_){if(!arguments.length){return _dotRadius}_dotRadius=_;return _chart};_chart.renderDataPoints=function(options){if(!arguments.length){return{fillOpacity:_dataPointFillOpacity,strokeOpacity:_dataPointStrokeOpacity,radius:_dataPointRadius}}else{if(!options){_dataPointFillOpacity=DEFAULT_DOT_OPACITY;_dataPointStrokeOpacity=DEFAULT_DOT_OPACITY;_dataPointRadius=null}else{_dataPointFillOpacity=options.fillOpacity||0.8;_dataPointStrokeOpacity=options.strokeOpacity||0.8;_dataPointRadius=options.radius||2}}return _chart};_chart.legendHighlight=function(d){if(!_chart.isLegendableHidden(d)){_chart.selectAll(".chart-body").selectAll("path").filter(function(){return d3.select(this).attr("fill")==d.color}).classed("highlight",true);_chart.selectAll(".chart-body").selectAll("path").filter(function(){return d3.select(this).attr("fill")!=d.color}).classed("fadeout",true)}};_chart.legendReset=function(d){_chart.selectAll(".chart-body").selectAll("path").filter(function(){return d3.select(this).attr("fill")==d.color}).classed("highlight",false);_chart.selectAll(".chart-body").selectAll("path").filter(function(){return d3.select(this).attr("fill")!=d.color}).classed("fadeout",false)};return _chart.anchor(parent,chartGroup)};dc.dataCount=function(parent,chartGroup){var _formatNumber=d3.format(",d");var _chart=dc.baseChart({});_chart.doRender=function(){_chart.selectAll(".total-count").text(_formatNumber(_chart.dimension().size()));_chart.selectAll(".filter-count").text(_formatNumber(_chart.group().value()));return _chart};_chart.doRedraw=function(){return _chart.doRender()};return _chart.anchor(parent,chartGroup)};dc.dataTable=function(parent,chartGroup){var LABEL_CSS_CLASS="dc-table-label";var ROW_CSS_CLASS="dc-table-row";var COLUMN_CSS_CLASS="dc-table-column";var GROUP_CSS_CLASS="dc-table-group";var _chart=dc.baseChart({});var _size=25;var _columns=[];var _sortBy=function(d){return d};var _order=d3.ascending;_chart.doRender=function(){_chart.selectAll("tbody").remove();renderRows(renderGroups());return _chart};function renderGroups(){var groups=_chart.root().selectAll("tbody").data(nestEntries(),function(d){return _chart.keyAccessor()(d)});var rowGroup=groups.enter().append("tbody");rowGroup.append("tr").attr("class",GROUP_CSS_CLASS).append("td").attr("class",LABEL_CSS_CLASS).attr("colspan",_columns.length).html(function(d){return _chart.keyAccessor()(d)});groups.exit().remove();return rowGroup}function nestEntries(){var entries=_chart.dimension().top(_size);return d3.nest().key(_chart.group()).sortKeys(_order).entries(entries.sort(function(a,b){return _order(_sortBy(a),_sortBy(b))}))}function renderRows(groups){var rows=groups.order().selectAll("tr."+ROW_CSS_CLASS).data(function(d){return d.values});var rowEnter=rows.enter().append("tr").attr("class",ROW_CSS_CLASS);_columns.forEach(function(f,i){rowEnter.append("td").attr("class",COLUMN_CSS_CLASS+" _"+i).html(f)});rows.exit().remove();return rows}_chart.doRedraw=function(){return _chart.doRender()};_chart.size=function(s){if(!arguments.length){return _size}_size=s;return _chart};_chart.columns=function(_){if(!arguments.length){return _columns}_columns=_;return _chart};_chart.sortBy=function(_){if(!arguments.length){return _sortBy}_sortBy=_;return _chart};_chart.order=function(_){if(!arguments.length){return _order}_order=_;return _chart};return _chart.anchor(parent,chartGroup)};dc.bubbleChart=function(parent,chartGroup){var _chart=dc.abstractBubbleChart(dc.coordinateGridChart({}));var _elasticRadius=false;_chart.transitionDuration(750);var bubbleLocator=function(d){return"translate("+(bubbleX(d))+","+(bubbleY(d))+")"};_chart.elasticRadius=function(_){if(!arguments.length){return _elasticRadius}_elasticRadius=_;return _chart};_chart.plotData=function(){if(_elasticRadius){_chart.r().domain([_chart.rMin(),_chart.rMax()])}_chart.r().range([_chart.MIN_RADIUS,_chart.xAxisLength()*_chart.maxBubbleRelativeSize()]);var bubbleG=_chart.chartBodyG().selectAll("g."+_chart.BUBBLE_NODE_CLASS).data(_chart.data(),_chart.keyAccessor());renderNodes(bubbleG);updateNodes(bubbleG);removeNodes(bubbleG);_chart.fadeDeselectedArea()};function renderNodes(bubbleG){var bubbleGEnter=bubbleG.enter().append("g");bubbleGEnter.attr("class",_chart.BUBBLE_NODE_CLASS).attr("transform",bubbleLocator).append("circle").attr("class",function(d,i){return _chart.BUBBLE_CLASS+" _"+i}).on("click",_chart.onClick).attr("fill",_chart.getColor).attr("r",0);dc.transition(bubbleG,_chart.transitionDuration()).selectAll("circle."+_chart.BUBBLE_CLASS).attr("r",function(d){return _chart.bubbleR(d)}).attr("opacity",function(d){return(_chart.bubbleR(d)>0)?1:0});_chart.doRenderLabel(bubbleGEnter);_chart.doRenderTitles(bubbleGEnter)}function updateNodes(bubbleG){dc.transition(bubbleG,_chart.transitionDuration()).attr("transform",bubbleLocator).selectAll("circle."+_chart.BUBBLE_CLASS).attr("fill",_chart.getColor).attr("r",function(d){return _chart.bubbleR(d)}).attr("opacity",function(d){return(_chart.bubbleR(d)>0)?1:0});_chart.doUpdateLabels(bubbleG);_chart.doUpdateTitles(bubbleG)}function removeNodes(bubbleG){bubbleG.exit().remove()}function bubbleX(d){var x=_chart.x()(_chart.keyAccessor()(d));if(isNaN(x)){x=0}return x}function bubbleY(d){var y=_chart.y()(_chart.valueAccessor()(d));if(isNaN(y)){y=0}return y}_chart.renderBrush=function(g){};_chart.redrawBrush=function(g){_chart.fadeDeselectedArea()};return _chart.anchor(parent,chartGroup)};dc.compositeChart=function(parent,chartGroup){var SUB_CHART_CLASS="sub";var _chart=dc.coordinateGridChart({});var _children=[];var _shareColors=false,_shareTitle=true;_chart._mandatoryAttributes([]);_chart.transitionDuration(500);dc.override(_chart,"_generateG",function(){var g=this.__generateG();for(var i=0;i<_children.length;++i){var child=_children[i];generateChildG(child,i);if(!child.dimension()){child.dimension(_chart.dimension())}if(!child.group()){child.group(_chart.group())}child.chartGroup(_chart.chartGroup());child.svg(_chart.svg());child.xUnits(_chart.xUnits());child.transitionDuration(_chart.transitionDuration());child.brushOn(_chart.brushOn())}return g});function generateChildG(child,i){child._generateG(_chart.g());child.g().attr("class",SUB_CHART_CLASS+" _"+i)}_chart.plotData=function(){for(var i=0;i<_children.length;++i){var child=_children[i];if(!child.g()){generateChildG(child,i)}if(_shareColors){child.colors(_chart.colors())}child.x(_chart.x());child.y(_chart.y());child.xAxis(_chart.xAxis());child.yAxis(_chart.yAxis());child.plotData();child.activateRenderlets()}};_chart.fadeDeselectedArea=function(){for(var i=0;i<_children.length;++i){var child=_children[i];child.brush(_chart.brush());child.fadeDeselectedArea()}};_chart.compose=function(charts){_children=charts;_children.forEach(function(child,i){child.height(_chart.height());child.width(_chart.width());child.margins(_chart.margins());if(_shareTitle){child.title(_chart.title())}if(_shareColors&&child.colorAccessor()===child._layerColorAccessor){child.colorCalculator(function(){return child.colors()(i)})}});return _chart};_chart.children=function(){return _children};_chart.shareColors=function(_){if(!arguments.length){return _shareColors}_shareColors=_;return _chart};_chart.shareTitle=function(_){if(!arguments.length){return _shareTitle}_shareTitle=_;return _chart};function getAllYAxisMinFromChildCharts(){var allMins=[];for(var i=0;i<_children.length;++i){allMins.push(_children[i].yAxisMin())}return allMins}_chart.yAxisMin=function(){return d3.min(getAllYAxisMinFromChildCharts())};function getAllYAxisMaxFromChildCharts(){var allMaxes=[];for(var i=0;i<_children.length;++i){allMaxes.push(_children[i].yAxisMax())}return allMaxes}_chart.yAxisMax=function(){return dc.utils.add(d3.max(getAllYAxisMaxFromChildCharts()),_chart.yAxisPadding())};function getAllXAxisMinFromChildCharts(){var allMins=[];for(var i=0;i<_children.length;++i){allMins.push(_children[i].xAxisMin())}return allMins}_chart.xAxisMin=function(){return dc.utils.subtract(d3.min(getAllXAxisMinFromChildCharts()),_chart.xAxisPadding())};function getAllXAxisMaxFromChildCharts(){var allMaxes=[];for(var i=0;i<_children.length;++i){allMaxes.push(_children[i].xAxisMax())}return allMaxes}_chart.xAxisMax=function(){return dc.utils.add(d3.max(getAllXAxisMaxFromChildCharts()),_chart.xAxisPadding())};_chart.legendables=function(){var items=[];_children.forEach(function(child,i){if(_shareColors){child.colors(_chart.colors())}var childLegendables=child.legendables();if(childLegendables.length){items.push.apply(items,childLegendables)}else{items.push(dc.utils.createLegendable(child,child.group(),child.valueAccessor(),child.colorCalculator()(i)))}});return items};_chart.legendHighlight=function(d){for(var j=0;j<_children.length;++j){var child=_children[j];child.legendHighlight(d)}};_chart.legendReset=function(d){for(var j=0;j<_children.length;++j){var child=_children[j];child.legendReset(d)}};return _chart.anchor(parent,chartGroup)};dc.seriesChart=function(parent,chartGroup){var _chart=dc.compositeChart(parent,chartGroup);var _charts={};var _chartFunction=dc.lineChart;var _seriesAccessor;var _seriesSort=d3.ascending;var _valueSort=keySort;_chart._mandatoryAttributes().push("seriesAccessor","chart");_chart.shareColors(true);function keySort(a,b){return d3.ascending(_chart.keyAccessor()(a),_chart.keyAccessor()(b))}_chart._preprocessData=function(){var keep=[];var children_changed;var nester=d3.nest().key(_seriesAccessor);if(_seriesSort){nester.sortKeys(_seriesSort)}if(_valueSort){nester.sortValues(_valueSort)}var nesting=nester.entries(_chart.data());var children=nesting.map(function(sub,i){var subChart=_charts[sub.key]||_chartFunction.call(_chart,_chart,chartGroup,sub.key,i);if(!_charts[sub.key]){children_changed=true}_charts[sub.key]=subChart;keep.push(sub.key);return subChart.dimension(_chart.dimension()).group({all:d3.functor(sub.values)},sub.key).keyAccessor(_chart.keyAccessor()).valueAccessor(_chart.valueAccessor()).colorCalculator(function(){return subChart.colors()(sub.key)})});Object.keys(_charts).filter(function(c){return keep.indexOf(c)===-1}).forEach(function(c){clearChart(c);children_changed=true});_chart._compose(children);if(children_changed&&_chart.legend()){_chart.legend().render()}};function clearChart(c){if(_charts[c].g()){_charts[c].g().remove()}delete _charts[c]}function resetChildren(){Object.keys(_charts).map(clearChart);_charts={}}_chart.chart=function(_){if(!arguments.length){return _chartFunction}_chartFunction=_;resetChildren();return _chart};_chart.seriesAccessor=function(_){if(!arguments.length){return _seriesAccessor}_seriesAccessor=_;resetChildren();return _chart};_chart.seriesSort=function(_){if(!arguments.length){return _seriesSort}_seriesSort=_;resetChildren();return _chart};_chart.valueSort=function(_){if(!arguments.length){return _valueSort}_valueSort=_;resetChildren();return _chart};_chart._compose=_chart.compose;delete _chart.compose;return _chart};dc.geoChoroplethChart=function(parent,chartGroup){var _chart=dc.colorChart(dc.baseChart({}));_chart.colorAccessor(function(d,i){return d||0});var projection=d3.geo.mercator().scale(400).translate([-400,275]);var _geoPath=d3.geo.path().projection(projection);var _projectionFlag;var _geoJsons=[];_chart.doRender=function(){_chart.resetSvg();for(var layerIndex=0;layerIndex<_geoJsons.length;++layerIndex){var states=_chart.svg().append("g").attr("class","layer"+layerIndex);var regionG=states.selectAll("g."+geoJson(layerIndex).name).data(geoJson(layerIndex).data).enter().append("g").attr("class",geoJson(layerIndex).name);regionG.append("path").attr("fill","white").attr("d",_geoPath);regionG.append("title");plotData(layerIndex)}_projectionFlag=false};function plotData(layerIndex){var data=generateLayeredData();if(isDataLayer(layerIndex)){var regionG=renderRegionG(layerIndex);renderPaths(regionG,layerIndex,data);renderTitle(regionG,layerIndex,data)}}function generateLayeredData(){var data={};var groupAll=_chart.data();for(var i=0;i<groupAll.length;++i){data[_chart.keyAccessor()(groupAll[i])]=_chart.valueAccessor()(groupAll[i])}return data}function isDataLayer(layerIndex){return geoJson(layerIndex).keyAccessor}function renderRegionG(layerIndex){var regionG=_chart.svg().selectAll(layerSelector(layerIndex)).classed("selected",function(d){return isSelected(layerIndex,d)}).classed("deselected",function(d){return isDeselected(layerIndex,d)}).attr("class",function(d){var layerNameClass=geoJson(layerIndex).name;var regionClass=dc.utils.nameToId(geoJson(layerIndex).keyAccessor(d));var baseClasses=layerNameClass+" "+regionClass;if(isSelected(layerIndex,d)){baseClasses+=" selected"}if(isDeselected(layerIndex,d)){baseClasses+=" deselected"}return baseClasses});return regionG}function layerSelector(layerIndex){return"g.layer"+layerIndex+" g."+geoJson(layerIndex).name}function isSelected(layerIndex,d){return _chart.hasFilter()&&_chart.hasFilter(getKey(layerIndex,d))}function isDeselected(layerIndex,d){return _chart.hasFilter()&&!_chart.hasFilter(getKey(layerIndex,d))}function getKey(layerIndex,d){return geoJson(layerIndex).keyAccessor(d)}function geoJson(index){return _geoJsons[index]}function renderPaths(regionG,layerIndex,data){var paths=regionG.select("path").attr("fill",function(d){var currentFill=d3.select(this).attr("fill");if(currentFill){return currentFill}return"none"}).on("click",function(d){return _chart.onClick(d,layerIndex)});dc.transition(paths,_chart.transitionDuration()).attr("fill",function(d,i){return _chart.getColor(data[geoJson(layerIndex).keyAccessor(d)],i)})}_chart.onClick=function(d,layerIndex){var selectedRegion=geoJson(layerIndex).keyAccessor(d);dc.events.trigger(function(){_chart.filter(selectedRegion);dc.redrawAll(_chart.chartGroup())})};function renderTitle(regionG,layerIndex,data){if(_chart.renderTitle()){regionG.selectAll("title").text(function(d){var key=getKey(layerIndex,d);var value=data[key];return _chart.title()({key:key,value:value})})}}_chart.doRedraw=function(){for(var layerIndex=0;layerIndex<_geoJsons.length;++layerIndex){plotData(layerIndex);if(_projectionFlag){_chart.svg().selectAll("g."+geoJson(layerIndex).name+" path").attr("d",_geoPath)}}_projectionFlag=false};_chart.overlayGeoJson=function(json,name,keyAccessor){for(var i=0;i<_geoJsons.length;++i){if(_geoJsons[i].name==name){_geoJsons[i].data=json;_geoJsons[i].keyAccessor=keyAccessor;return _chart}}_geoJsons.push({name:name,data:json,keyAccessor:keyAccessor});return _chart};_chart.projection=function(projection){_geoPath.projection(projection);_projectionFlag=true;return _chart};_chart.geoJsons=function(){return _geoJsons};_chart.removeGeoJson=function(name){var geoJsons=[];for(var i=0;i<_geoJsons.length;++i){var layer=_geoJsons[i];if(layer.name!=name){geoJsons.push(layer)}}_geoJsons=geoJsons;return _chart};return _chart.anchor(parent,chartGroup)};dc.bubbleOverlay=function(root,chartGroup){var BUBBLE_OVERLAY_CLASS="bubble-overlay";var BUBBLE_NODE_CLASS="node";var BUBBLE_CLASS="bubble";var _chart=dc.abstractBubbleChart(dc.baseChart({}));var _g;var _points=[];_chart.transitionDuration(750);_chart.radiusValueAccessor(function(d){return d.value});_chart.point=function(name,x,y){_points.push({name:name,x:x,y:y});return _chart};_chart.doRender=function(){_g=initOverlayG();_chart.r().range([_chart.MIN_RADIUS,_chart.width()*_chart.maxBubbleRelativeSize()]);initializeBubbles();_chart.fadeDeselectedArea();return _chart};function initOverlayG(){_g=_chart.select("g."+BUBBLE_OVERLAY_CLASS);if(_g.empty()){_g=_chart.svg().append("g").attr("class",BUBBLE_OVERLAY_CLASS)}return _g}function initializeBubbles(){var data=mapData();_points.forEach(function(point){var nodeG=getNodeG(point,data);var circle=nodeG.select("circle."+BUBBLE_CLASS);if(circle.empty()){circle=nodeG.append("circle").attr("class",BUBBLE_CLASS).attr("r",0).attr("fill",_chart.getColor).on("click",_chart.onClick)}dc.transition(circle,_chart.transitionDuration()).attr("r",function(d){return _chart.bubbleR(d)});_chart.doRenderLabel(nodeG);_chart.doRenderTitles(nodeG)})}function mapData(){var data={};_chart.data().forEach(function(datum){data[_chart.keyAccessor()(datum)]=datum});return data}function getNodeG(point,data){var bubbleNodeClass=BUBBLE_NODE_CLASS+" "+dc.utils.nameToId(point.name);var nodeG=_g.select("g."+dc.utils.nameToId(point.name));if(nodeG.empty()){nodeG=_g.append("g").attr("class",bubbleNodeClass).attr("transform","translate("+point.x+","+point.y+")")}nodeG.datum(data[point.name]);return nodeG}_chart.doRedraw=function(){updateBubbles();_chart.fadeDeselectedArea();return _chart};function updateBubbles(){var data=mapData();_points.forEach(function(point){var nodeG=getNodeG(point,data);var circle=nodeG.select("circle."+BUBBLE_CLASS);dc.transition(circle,_chart.transitionDuration()).attr("r",function(d){return _chart.bubbleR(d)}).attr("fill",_chart.getColor);_chart.doUpdateLabels(nodeG);_chart.doUpdateTitles(nodeG)})}_chart.debug=function(flag){if(flag){var debugG=_chart.select("g."+dc.constants.DEBUG_GROUP_CLASS);if(debugG.empty()){debugG=_chart.svg().append("g").attr("class",dc.constants.DEBUG_GROUP_CLASS)}var debugText=debugG.append("text").attr("x",10).attr("y",20);debugG.append("rect").attr("width",_chart.width()).attr("height",_chart.height()).on("mousemove",function(){var position=d3.mouse(debugG.node());var msg=position[0]+", "+position[1];debugText.text(msg)})}else{_chart.selectAll(".debug").remove()}return _chart};_chart.anchor(root,chartGroup);return _chart};dc.rowChart=function(parent,chartGroup){var _g;var _labelOffsetX=10;var _labelOffsetY=15;var _gap=5;var _rowCssClass="row";var _chart=dc.capped(dc.marginable(dc.colorChart(dc.baseChart({}))));var _x;var _elasticX;var _xAxis=d3.svg.axis().orient("bottom");var _rowData;_chart.rowsCap=_chart.cap;function calculateAxisScale(){if(!_x||_elasticX){var extent=d3.extent(_rowData,_chart.cappedValueAccessor);if(extent[0]>0){extent[0]=0}_x=d3.scale.linear().domain(extent).range([0,_chart.effectiveWidth()])}_xAxis.scale(_x)}function drawAxis(){var axisG=_g.select("g.axis");calculateAxisScale();if(axisG.empty()){axisG=_g.append("g").attr("class","axis").attr("transform","translate(0, "+_chart.effectiveHeight()+")")}dc.transition(axisG,_chart.transitionDuration()).call(_xAxis)}_chart.doRender=function(){_chart.resetSvg();_g=_chart.svg().append("g").attr("transform","translate("+_chart.margins().left+","+_chart.margins().top+")");drawChart();return _chart};_chart.title(function(d){return _chart.cappedKeyAccessor(d)+": "+_chart.cappedValueAccessor(d)});_chart.label(_chart.cappedKeyAccessor);_chart.x=function(x){if(!arguments.length){return _x}_x=x;return _chart};function drawGridLines(){_g.selectAll("g.tick").select("line.grid-line").remove();_g.selectAll("g.tick").append("line").attr("class","grid-line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",function(){return -_chart.effectiveHeight()})}function drawChart(){_rowData=_chart.data();drawAxis();drawGridLines();var rows=_g.selectAll("g."+_rowCssClass).data(_rowData);createElements(rows);removeElements(rows);updateElements(rows)}function createElements(rows){var rowEnter=rows.enter().append("g").attr("class",function(d,i){return _rowCssClass+" _"+i});rowEnter.append("rect").attr("width",0);createLabels(rowEnter);updateLabels(rows)}function removeElements(rows){rows.exit().remove()}function updateElements(rows){var n=_rowData.length;var height=(_chart.effectiveHeight()-(n+1)*_gap)/n;var rect=rows.attr("transform",function(d,i){return"translate(0,"+((i+1)*_gap+i*height)+")"}).select("rect").attr("height",height).attr("fill",_chart.getColor).on("click",onClick).classed("deselected",function(d){return(_chart.hasFilter())?!isSelectedRow(d):false}).classed("selected",function(d){return(_chart.hasFilter())?isSelectedRow(d):false});dc.transition(rect,_chart.transitionDuration()).attr("width",function(d){var start=_x(0)==-Infinity?_x(1):_x(0);return Math.abs(start-_x(_chart.valueAccessor()(d)))}).attr("transform",translateX);createTitles(rows);updateLabels(rows)}function createTitles(rows){if(_chart.renderTitle()){rows.selectAll("title").remove();rows.append("title").text(_chart.title())}}function createLabels(rowEnter){if(_chart.renderLabel()){rowEnter.append("text").on("click",onClick)}}function updateLabels(rows){if(_chart.renderLabel()){var lab=rows.select("text").attr("x",_labelOffsetX).attr("y",_labelOffsetY).on("click",onClick).attr("class",function(d,i){return _rowCssClass+" _"+i}).text(function(d){return _chart.label()(d)});dc.transition(lab,_chart.transitionDuration()).attr("transform",translateX)}}function onClick(d){_chart.onClick(d)}function translateX(d){var x=_x(_chart.cappedValueAccessor(d)),x0=_x(0),s=x>x0?x0:x;return"translate("+s+",0)"}_chart.doRedraw=function(){drawChart();return _chart};_chart.xAxis=function(){return _xAxis};_chart.gap=function(g){if(!arguments.length){return _gap}_gap=g;return _chart};_chart.elasticX=function(_){if(!arguments.length){return _elasticX}_elasticX=_;return _chart};_chart.labelOffsetX=function(o){if(!arguments.length){return _labelOffsetX}_labelOffsetX=o;return _chart};_chart.labelOffsetY=function(o){if(!arguments.length){return _labelOffsetY}_labelOffsetY=o;return _chart};function isSelectedRow(d){return _chart.hasFilter(_chart.cappedKeyAccessor(d))}return _chart.anchor(parent,chartGroup)};dc.legend=function(){var LABEL_GAP=2;var _legend={},_parent,_x=0,_y=0,_itemHeight=12,_gap=5,_horizontal=false,_legendWidth=560,_itemWidth=70;var _g;_legend.parent=function(p){if(!arguments.length){return _parent}_parent=p;return _legend};_legend.render=function(){_parent.svg().select("g.dc-legend").remove();_g=_parent.svg().append("g").attr("class","dc-legend").attr("transform","translate("+_x+","+_y+")");var itemEnter=_g.selectAll("g.dc-legend-item").data(_parent.legendables()).enter().append("g").attr("class","dc-legend-item").classed("fadeout",function(d){return _parent.isLegendableHidden(d)}).on("mouseover",function(d){_parent.legendHighlight(d)}).on("mouseout",function(d){_parent.legendReset(d)}).on("click",function(d){_parent.legendToggle(d)});if(_parent.legendables().some(function(legendItem){return legendItem.dashstyle})){itemEnter.append("line").attr("x1",0).attr("y1",_itemHeight/2).attr("x2",_itemHeight).attr("y2",_itemHeight/2).attr("stroke-width",2).attr("stroke-dasharray",function(d){return d.dashstyle}).attr("stroke",function(d){return d.color})}else{itemEnter.append("rect").attr("width",_itemHeight).attr("height",_itemHeight).attr("fill",function(d){return d.color})}itemEnter.append("text").text(function(d){return d.name}).attr("x",_itemHeight+LABEL_GAP).attr("y",function(){return _itemHeight/2+(this.clientHeight?this.clientHeight:13)/2-2});var _cumulativeLegendTextWidth=0;var row=0;itemEnter.attr("transform",function(d,i){if(_horizontal){var translateBy="translate("+_cumulativeLegendTextWidth+","+row*legendItemHeight()+")";if((_cumulativeLegendTextWidth+_itemWidth)>=_legendWidth){++row;_cumulativeLegendTextWidth=0}else{_cumulativeLegendTextWidth+=_itemWidth}return translateBy}else{return"translate(0,"+i*legendItemHeight()+")"}})};function legendItemHeight(){return _gap+_itemHeight}_legend.x=function(x){if(!arguments.length){return _x}_x=x;return _legend};_legend.y=function(y){if(!arguments.length){return _y}_y=y;return _legend};_legend.gap=function(gap){if(!arguments.length){return _gap}_gap=gap;return _legend};_legend.itemHeight=function(h){if(!arguments.length){return _itemHeight}_itemHeight=h;return _legend};_legend.horizontal=function(_){if(!arguments.length){return _horizontal}_horizontal=_;return _legend};_legend.legendWidth=function(_){if(!arguments.length){return _legendWidth}_legendWidth=_;return _legend};_legend.itemWidth=function(_){if(!arguments.length){return _itemWidth}_itemWidth=_;return _legend};return _legend};dc.capped=function(_chart){var _cap=Infinity;var _othersLabel="Others";var _othersGrouper=function(topRows){var topRowsSum=d3.sum(topRows,_chart.valueAccessor()),allRows=_chart.group().all(),allRowsSum=d3.sum(allRows,_chart.valueAccessor()),topKeys=topRows.map(_chart.keyAccessor()),allKeys=allRows.map(_chart.keyAccessor()),topSet=d3.set(topKeys),others=allKeys.filter(function(d){return !topSet.has(d)});if(allRowsSum>topRowsSum){return topRows.concat([{others:others,key:_othersLabel,value:allRowsSum-topRowsSum}])}return topRows};_chart.cappedKeyAccessor=function(d,i){if(d.others){return d.key}return _chart.keyAccessor()(d,i)};_chart.cappedValueAccessor=function(d,i){if(d.others){return d.value}return _chart.valueAccessor()(d,i)};_chart.data(function(group){if(_cap==Infinity){return _chart.computeOrderedGroups(group.all())}else{var topRows=group.top(_cap);topRows=_chart.computeOrderedGroups(topRows);if(_othersGrouper){return _othersGrouper(topRows)}return topRows}});_chart.cap=function(_){if(!arguments.length){return _cap}_cap=_;return _chart};_chart.othersLabel=function(_){if(!arguments.length){return _othersLabel}_othersLabel=_;return _chart};_chart.othersGrouper=function(_){if(!arguments.length){return _othersGrouper}_othersGrouper=_;return _chart};dc.override(_chart,"onClick",function(d){if(d.others){_chart.filter([d.others])}_chart._onClick(d)});return _chart};dc.scatterPlot=function(parent,chartGroup){var _chart=dc.coordinateGridChart({});var _locator=function(d){return"translate("+_chart.x()(_chart.keyAccessor()(d))+","+_chart.y()(_chart.valueAccessor()(d))+")"};var _symbolSize=3;_chart.transitionDuration(0);_chart.plotData=function(){var symbols=_chart.chartBodyG().selectAll("circle.symbol").data(_chart.data());symbols.enter().append("circle").attr("class","symbol").attr("fill",_chart.getColor(0)).attr("transform",_locator);dc.transition(symbols,_chart.transitionDuration()).attr("transform",_locator).attr("r",_symbolSize);dc.transition(symbols.filter(function(d){return _chart.valueAccessor()(d)===0}),_chart.transitionDuration()).attr("r",0).remove();dc.transition(symbols.exit(),_chart.transitionDuration()).attr("r",0).remove()};_chart.symbolSize=function(s){if(!arguments.length){return _symbolSize}_symbolSize=s;return _chart};return _chart.anchor(parent,chartGroup)};dc.numberDisplay=function(parent,chartGroup){var SPAN_CLASS="number-display";var _formatNumber=d3.format(".2s");var _chart=dc.baseChart({});_chart._mandatoryAttributes(["group"]);_chart.value=function(){return _chart.data()};_chart.data(function(group){var valObj=group.value?group.value():group.top(1)[0];return _chart.valueAccessor()(valObj)});_chart.transitionDuration(250);_chart.doRender=function(){var newValue=_chart.value(),span=_chart.selectAll("."+SPAN_CLASS);if(span.empty()){span=span.data([0]).enter().append("span").attr("class",SPAN_CLASS)}span.transition().duration(_chart.transitionDuration()).ease("quad-out-in").tween("text",function(){var interp=d3.interpolateNumber(this.lastValue||0,newValue);this.lastValue=newValue;return function(t){this.textContent=_chart.formatNumber()(interp(t))}});return _chart};_chart.doRedraw=function(){return _chart.doRender()};_chart.formatNumber=function(_){if(!arguments.length){return _formatNumber}_formatNumber=_;return _chart};return _chart.anchor(parent,chartGroup)};dc.heatMap=function(parent,chartGroup){var DEFAULT_BORDER_RADIUS=6.75;var _chartBody;var _cols;var _rows;var _xBorderRadius=DEFAULT_BORDER_RADIUS;var _yBorderRadius=DEFAULT_BORDER_RADIUS;var _chart=dc.colorChart(dc.marginable(dc.baseChart({})));_chart._mandatoryAttributes(["group"]);_chart.title(_chart.colorAccessor());var _xAxisOnClick=function(d){filterAxis(0,d)};var _yAxisOnClick=function(d){filterAxis(1,d)};var _boxOnClick=function(d){var filter=d.key;dc.events.trigger(function(){_chart.filter(filter);dc.redrawAll(_chart.chartGroup())})};function filterAxis(axis,value){var cellsOnAxis=_chart.selectAll(".box-group").filter(function(d){return d.key[axis]==value});var unfilteredCellsOnAxis=cellsOnAxis.filter(function(d){return !_chart.hasFilter(d.key)});dc.events.trigger(function(){if(unfilteredCellsOnAxis.empty()){cellsOnAxis.each(function(d){_chart.filter(d.key)})}else{unfilteredCellsOnAxis.each(function(d){_chart.filter(d.key)})}dc.redrawAll(_chart.chartGroup())})}dc.override(_chart,"filter",function(filter){if(filter){return _chart._filter(dc.filters.TwoDimensionalFilter(filter))}else{return _chart._filter()}});function uniq(d,i,a){return !i||a[i-1]!=d}_chart.rows=function(_){if(arguments.length){_rows=_;return _chart}if(_rows){return _rows}var rowValues=_chart.data().map(_chart.valueAccessor());rowValues.sort(d3.ascending);return d3.scale.ordinal().domain(rowValues.filter(uniq))};_chart.cols=function(_){if(arguments.length){_cols=_;return _chart}if(_cols){return _cols}var colValues=_chart.data().map(_chart.keyAccessor());colValues.sort(d3.ascending);return d3.scale.ordinal().domain(colValues.filter(uniq))};_chart.doRender=function(){_chart.resetSvg();_chartBody=_chart.svg().append("g").attr("class","heatmap").attr("transform","translate("+_chart.margins().left+","+_chart.margins().top+")");return _chart.doRedraw()};_chart.doRedraw=function(){var rows=_chart.rows(),cols=_chart.cols(),rowCount=rows.domain().length,colCount=cols.domain().length,boxWidth=Math.floor(_chart.effectiveWidth()/colCount),boxHeight=Math.floor(_chart.effectiveHeight()/rowCount);cols.rangeRoundBands([0,_chart.effectiveWidth()]);rows.rangeRoundBands([_chart.effectiveHeight(),0]);var boxes=_chartBody.selectAll("g.box-group").data(_chart.data(),function(d,i){return _chart.keyAccessor()(d,i)+"\0"+_chart.valueAccessor()(d,i)});var gEnter=boxes.enter().append("g").attr("class","box-group");gEnter.append("rect").attr("class","heat-box").attr("fill","white").on("click",_chart.boxOnClick());gEnter.append("title").text(_chart.title());dc.transition(boxes.selectAll("rect"),_chart.transitionDuration()).attr("x",function(d,i){return cols(_chart.keyAccessor()(d,i))}).attr("y",function(d,i){return rows(_chart.valueAccessor()(d,i))}).attr("rx",_xBorderRadius).attr("ry",_yBorderRadius).attr("fill",_chart.getColor).attr("width",boxWidth).attr("height",boxHeight);boxes.exit().remove();var gCols=_chartBody.selectAll("g.cols");if(gCols.empty()){gCols=_chartBody.append("g").attr("class","cols axis")}gCols.selectAll("text").data(cols.domain()).enter().append("text").attr("x",function(d){return cols(d)+boxWidth/2}).style("text-anchor","middle").attr("y",_chart.effectiveHeight()).attr("dy",12).on("click",_chart.xAxisOnClick()).text(function(d){return d});var gRows=_chartBody.selectAll("g.rows");if(gRows.empty()){gRows=_chartBody.append("g").attr("class","rows axis")}gRows.selectAll("text").data(rows.domain()).enter().append("text").attr("dy",6).style("text-anchor","end").attr("x",0).attr("dx",-2).on("click",_chart.yAxisOnClick()).text(function(d){return d});dc.transition(gRows.selectAll("text"),_chart.transitionDuration()).text(function(d){return d}).attr("y",function(d){return rows(d)+boxHeight/2});if(_chart.hasFilter()){_chart.selectAll("g.box-group").each(function(d){if(_chart.isSelectedNode(d)){_chart.highlightSelected(this)}else{_chart.fadeDeselected(this)}})}else{_chart.selectAll("g.box-group").each(function(d){_chart.resetHighlight(this)})}};_chart.boxOnClick=function(f){if(!arguments.length){return _boxOnClick}_boxOnClick=f;return _chart};_chart.xAxisOnClick=function(f){if(!arguments.length){return _xAxisOnClick}_xAxisOnClick=f;return _chart};_chart.yAxisOnClick=function(f){if(!arguments.length){return _yAxisOnClick}_yAxisOnClick=f;return _chart};_chart.xBorderRadius=function(d){if(arguments.length){_xBorderRadius=d}return _xBorderRadius};_chart.yBorderRadius=function(d){if(arguments.length){_yBorderRadius=d}return _yBorderRadius};_chart.isSelectedNode=function(d){return _chart.hasFilter(d.key)};return _chart.anchor(parent,chartGroup)};(function(){d3.box=function(){var width=1,height=1,duration=0,domain=null,value=Number,whiskers=boxWhiskers,quartiles=boxQuartiles,tickFormat=null;function box(g){g.each(function(d,i){d=d.map(value).sort(d3.ascending);var g=d3.select(this),n=d.length,min=d[0],max=d[n-1];var quartileData=d.quartiles=quartiles(d);var whiskerIndices=whiskers&&whiskers.call(this,d,i),whiskerData=whiskerIndices&&whiskerIndices.map(function(i){return d[i]});var outlierIndices=whiskerIndices?d3.range(0,whiskerIndices[0]).concat(d3.range(whiskerIndices[1]+1,n)):d3.range(n);var x1=d3.scale.linear().domain(domain&&domain.call(this,d,i)||[min,max]).range([height,0]);var x0=this.__chart__||d3.scale.linear().domain([0,Infinity]).range(x1.range());this.__chart__=x1;var center=g.selectAll("line.center").data(whiskerData?[whiskerData]:[]);center.enter().insert("line","rect").attr("class","center").attr("x1",width/2).attr("y1",function(d){return x0(d[0])}).attr("x2",width/2).attr("y2",function(d){return x0(d[1])}).style("opacity",0.000001).transition().duration(duration).style("opacity",1).attr("y1",function(d){return x1(d[0])}).attr("y2",function(d){return x1(d[1])});center.transition().duration(duration).style("opacity",1).attr("y1",function(d){return x1(d[0])}).attr("y2",function(d){return x1(d[1])});center.exit().transition().duration(duration).style("opacity",0.000001).attr("y1",function(d){return x1(d[0])}).attr("y2",function(d){return x1(d[1])}).remove();var box=g.selectAll("rect.box").data([quartileData]);box.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(d){return x0(d[2])}).attr("width",width).attr("height",function(d){return x0(d[0])-x0(d[2])}).transition().duration(duration).attr("y",function(d){return x1(d[2])}).attr("height",function(d){return x1(d[0])-x1(d[2])});box.transition().duration(duration).attr("y",function(d){return x1(d[2])}).attr("height",function(d){return x1(d[0])-x1(d[2])});var medianLine=g.selectAll("line.median").data([quartileData[1]]);medianLine.enter().append("line").attr("class","median").attr("x1",0).attr("y1",x0).attr("x2",width).attr("y2",x0).transition().duration(duration).attr("y1",x1).attr("y2",x1);medianLine.transition().duration(duration).attr("y1",x1).attr("y2",x1);var whisker=g.selectAll("line.whisker").data(whiskerData||[]);whisker.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",x0).attr("x2",width).attr("y2",x0).style("opacity",0.000001).transition().duration(duration).attr("y1",x1).attr("y2",x1).style("opacity",1);whisker.transition().duration(duration).attr("y1",x1).attr("y2",x1).style("opacity",1);whisker.exit().transition().duration(duration).attr("y1",x1).attr("y2",x1).style("opacity",0.000001).remove();var outlier=g.selectAll("circle.outlier").data(outlierIndices,Number);outlier.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",width/2).attr("cy",function(i){return x0(d[i])}).style("opacity",0.000001).transition().duration(duration).attr("cy",function(i){return x1(d[i])}).style("opacity",1);outlier.transition().duration(duration).attr("cy",function(i){return x1(d[i])}).style("opacity",1);outlier.exit().transition().duration(duration).attr("cy",function(i){return x1(d[i])}).style("opacity",0.000001).remove();var format=tickFormat||x1.tickFormat(8);var boxTick=g.selectAll("text.box").data(quartileData);boxTick.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(d,i){return i&1?6:-6}).attr("x",function(d,i){return i&1?width:0}).attr("y",x0).attr("text-anchor",function(d,i){return i&1?"start":"end"}).text(format).transition().duration(duration).attr("y",x1);boxTick.transition().duration(duration).text(format).attr("y",x1);var whiskerTick=g.selectAll("text.whisker").data(whiskerData||[]);whiskerTick.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",width).attr("y",x0).text(format).style("opacity",0.000001).transition().duration(duration).attr("y",x1).style("opacity",1);whiskerTick.transition().duration(duration).text(format).attr("y",x1).style("opacity",1);whiskerTick.exit().transition().duration(duration).attr("y",x1).style("opacity",0.000001).remove()});d3.timer.flush()}box.width=function(x){if(!arguments.length){return width}width=x;return box};box.height=function(x){if(!arguments.length){return height}height=x;return box};box.tickFormat=function(x){if(!arguments.length){return tickFormat}tickFormat=x;return box};box.duration=function(x){if(!arguments.length){return duration}duration=x;return box};box.domain=function(x){if(!arguments.length){return domain}domain=x==null?x:d3.functor(x);return box};box.value=function(x){if(!arguments.length){return value}value=x;return box};box.whiskers=function(x){if(!arguments.length){return whiskers}whiskers=x;return box};box.quartiles=function(x){if(!arguments.length){return quartiles}quartiles=x;return box};return box};function boxWhiskers(d){return[0,d.length-1]}function boxQuartiles(d){return[d3.quantile(d,0.25),d3.quantile(d,0.5),d3.quantile(d,0.75)]}})();dc.boxPlot=function(parent,chartGroup){var _chart=dc.coordinateGridChart({});var _whisker_iqr_factor=1.5;var _whiskers_iqr=default_whiskers_iqr;var _whiskers=_whiskers_iqr(_whisker_iqr_factor);var _box=d3.box();var _tickFormat=null;var _boxWidth=function(innerChartWidth,xUnits){if(_chart.isOrdinal()){return _chart.x().rangeBand()}else{return innerChartWidth/(1+_chart.boxPadding())/xUnits}};_chart.yAxisPadding(12);_chart.x(d3.scale.ordinal());_chart.xUnits(dc.units.ordinal);_chart.data(function(group){return group.all().map(function(d){d.map=function(accessor){return accessor.call(d,d)};return d})});_chart.boxPadding=_chart._rangeBandPadding;_chart.boxPadding(0.8);_chart.outerPadding=_chart._outerRangeBandPadding;_chart.outerPadding(0.5);_chart.boxWidth=function(_){if(!arguments.length){return _boxWidth}_boxWidth=d3.functor(_);return _chart};var boxTransform=function(d,i){var xOffset=_chart.x()(_chart.keyAccessor()(d,i));return"translate("+xOffset+",0)"};_chart.plotData=function(){var _calculatedBoxWidth=_boxWidth(_chart.effectiveWidth(),_chart.xUnitCount());_box.whiskers(_whiskers).width(_calculatedBoxWidth).height(_chart.effectiveHeight()).value(_chart.valueAccessor()).domain(_chart.y().domain()).duration(_chart.transitionDuration()).tickFormat(_tickFormat);var boxesG=_chart.chartBodyG().selectAll("g.box").data(_chart.data());renderBoxes(boxesG);updateBoxes(boxesG);removeBoxes(boxesG);_chart.fadeDeselectedArea()};function renderBoxes(boxesG){var boxesGEnter=boxesG.enter().append("g");boxesGEnter.attr("class","box").attr("transform",boxTransform).call(_box).on("click",function(d){_chart.filter(d.key);dc.redrawAll(_chart.chartGroup())})}function updateBoxes(boxesG){dc.transition(boxesG,_chart.transitionDuration()).attr("transform",boxTransform).call(_box).each(function(){d3.select(this).select("rect.box").attr("fill",_chart.getColor)})}function removeBoxes(boxesG){boxesG.exit().remove().call(_box)}_chart.fadeDeselectedArea=function(){if(_chart.hasFilter()){_chart.selectAll("g.box").each(function(d){if(_chart.isSelectedNode(d)){_chart.highlightSelected(this)}else{_chart.fadeDeselected(this)}})}else{_chart.selectAll("g.box").each(function(){_chart.resetHighlight(this)})}};_chart.isSelectedNode=function(d){return _chart.hasFilter(d.key)};_chart.yAxisMin=function(){var min=d3.min(_chart.data(),function(e){return d3.min(_chart.valueAccessor()(e))});return dc.utils.subtract(min,_chart.yAxisPadding())};_chart.yAxisMax=function(){var max=d3.max(_chart.data(),function(e){return d3.max(_chart.valueAccessor()(e))});return dc.utils.add(max,_chart.yAxisPadding())};_chart.tickFormat=function(x){if(!arguments.length){return _tickFormat}_tickFormat=x;return _chart};function default_whiskers_iqr(k){return function(d){var q1=d.quartiles[0],q3=d.quartiles[2],iqr=(q3-q1)*k,i=-1,j=d.length;while(d[++i]<q1-iqr){}while(d[--j]>q3+iqr){}return[i,j]}}return _chart.anchor(parent,chartGroup)};return dc})();dc.filters={};dc.filters.RangedFilter=function(low,high){var range=Array(low,high);range.isFiltered=function(value){return value>=this[0]&&value<this[1]};return range};dc.filters.TwoDimensionalFilter=function(array){var filter=array;filter.isFiltered=function(value){return value.length&&value.length==filter.length&&value[0]==filter[0]&&value[1]==filter[1]};return filter};(function(e,t,n,r){function i(t){if(t[0]&&e.isPlainObject(t[0])){this.data=t[0]}else{this.el=t}this.isCoords=true;this.coords={};this.init();return this}var s=i.prototype;s.init=function(){this.set();this.original_coords=this.get()};s.set=function(e,t){var n=this.el;if(n&&!e){this.data=n.offset();this.data.width=n.width();this.data.height=n.height()}if(n&&e&&!t){var r=n.offset();this.data.top=r.top;this.data.left=r.left}var i=this.data;this.coords.x1=i.left;this.coords.y1=i.top;this.coords.x2=i.left+i.width;this.coords.y2=i.top+i.height;this.coords.cx=i.left+i.width/2;this.coords.cy=i.top+i.height/2;this.coords.width=i.width;this.coords.height=i.height;this.coords.el=n||false;return this};s.update=function(t){if(!t&&!this.el){return this}if(t){var n=e.extend({},this.data,t);this.data=n;return this.set(true,true)}this.set(true);return this};s.get=function(){return this.coords};e.fn.coords=function(){if(this.data("coords")){return this.data("coords")}var e=new i(this,arguments[0]);this.data("coords",e);return e}})(jQuery,window,document);(function(e,t,n,r){function s(t,n,r){this.options=e.extend(i,r);this.$element=t;this.last_colliders=[];this.last_colliders_coords=[];if(typeof n==="string"||n instanceof jQuery){this.$colliders=e(n,this.options.colliders_context).not(this.$element)}else{this.colliders=e(n)}this.init()}var i={colliders_context:n.body};var o=s.prototype;o.init=function(){this.find_collisions()};o.overlaps=function(e,t){var n=false;var r=false;if(t.x1>=e.x1&&t.x1<=e.x2||t.x2>=e.x1&&t.x2<=e.x2||e.x1>=t.x1&&e.x2<=t.x2){n=true}if(t.y1>=e.y1&&t.y1<=e.y2||t.y2>=e.y1&&t.y2<=e.y2||e.y1>=t.y1&&e.y2<=t.y2){r=true}return n&&r};o.detect_overlapping_region=function(e,t){var n="";var r="";if(e.y1>t.cy&&e.y1<t.y2){n="N"}if(e.y2>t.y1&&e.y2<t.cy){n="S"}if(e.x1>t.cx&&e.x1<t.x2){r="W"}if(e.x2>t.x1&&e.x2<t.cx){r="E"}return n+r||"C"};o.calculate_overlapped_area_coords=function(t,n){var r=Math.max(t.x1,n.x1);var i=Math.max(t.y1,n.y1);var s=Math.min(t.x2,n.x2);var o=Math.min(t.y2,n.y2);return e({left:r,top:i,width:s-r,height:o-i}).coords().get()};o.calculate_overlapped_area=function(e){return e.width*e.height};o.manage_colliders_start_stop=function(t,n,r){var i=this.last_colliders_coords;for(var s=0,o=i.length;s<o;s++){if(e.inArray(i[s],t)===-1){n.call(this,i[s])}}for(var u=0,a=t.length;u<a;u++){if(e.inArray(t[u],i)===-1){r.call(this,t[u])}}};o.find_collisions=function(t){var n=this;var r=[];var i=[];var s=this.colliders||this.$colliders;var o=s.length;var u=n.$element.coords().update(t||false).get();while(o--){var a=n.$colliders?e(s[o]):s[o];var f=a.isCoords?a:a.coords();var l=f.get();var c=n.overlaps(u,l);if(!c){continue}var h=n.detect_overlapping_region(u,l);if(h==="C"){var p=n.calculate_overlapped_area_coords(u,l);var d=n.calculate_overlapped_area(p);var v={area:d,area_coords:p,region:h,coords:l,player_coords:u,el:a};if(n.options.on_overlap){n.options.on_overlap.call(this,v)}r.push(f);i.push(v)}}if(n.options.on_overlap_stop||n.options.on_overlap_start){this.manage_colliders_start_stop(r,n.options.on_overlap_start,n.options.on_overlap_stop)}this.last_colliders_coords=r;return i};o.get_closest_colliders=function(e){var t=this.find_collisions(e);t.sort(function(e,t){if(e.region==="C"&&t.region==="C"){if(e.coords.y1<t.coords.y1||e.coords.x1<t.coords.x1){return -1}else{return 1}}if(e.area<t.area){return 1}return 1});return t};e.fn.collision=function(e,t){return new s(this,e,t)}})(jQuery,window,document);(function(e,t){e.debounce=function(e,t,n){var r;return function(){var i=this,s=arguments;var o=function(){r=null;if(!n){e.apply(i,s)}};if(n&&!r){e.apply(i,s)}clearTimeout(r);r=setTimeout(o,t)}};e.throttle=function(e,t){var n,r,i,s,o,u;var a=debounce(function(){o=s=false},t);return function(){n=this;r=arguments;var f=function(){i=null;if(o){e.apply(n,r)}a()};if(!i){i=setTimeout(f,t)}if(s){o=true}else{u=e.apply(n,r)}a();s=true;return u}}})(window);(function(e,t,n,r){function a(t,r){this.options=e.extend({},i,r);this.$body=e(n.body);this.$container=e(t);this.$dragitems=e(this.options.items,this.$container);this.is_dragging=false;this.player_min_left=0+this.options.offset_left;this.init()}var i={items:".gs_w",distance:1,limit:true,offset_left:0,autoscroll:true,ignore_dragging:["INPUT","TEXTAREA","SELECT","BUTTON"],handle:null};var s=e(t);var o=!!("ontouchstart" in t);var u={start:o?"touchstart":"mousedown.draggable",move:o?"touchmove":"mousemove.draggable",end:o?"touchend":"mouseup.draggable"};var f=a.prototype;f.init=function(){this.calculate_positions();this.$container.css("position","relative");this.disabled=false;this.events();this.on_window_resize=throttle(e.proxy(this.calculate_positions,this),200);e(t).bind("resize",this.on_window_resize)};f.events=function(){this.proxied_on_select_start=e.proxy(this.on_select_start,this);this.$container.on("selectstart",this.proxied_on_select_start);this.proxied_drag_handler=e.proxy(this.drag_handler,this);this.$container.on(u.start,this.options.items,this.proxied_drag_handler);this.proxied_pointer_events_end=e.proxy(function(e){this.is_dragging=false;if(this.disabled){return}this.$body.off(u.move);if(this.drag_start){this.on_dragstop(e)}},this);this.$body.on(u.end,this.proxied_pointer_events_end)};f.get_actual_pos=function(e){var t=e.position();return t};f.get_mouse_pos=function(e){if(o){var t=e.originalEvent;e=t.touches.length?t.touches[0]:t.changedTouches[0]}return{left:e.clientX,top:e.clientY}};f.get_offset=function(e){e.preventDefault();var t=this.get_mouse_pos(e);var n=Math.round(t.left-this.mouse_init_pos.left);var r=Math.round(t.top-this.mouse_init_pos.top);var i=Math.round(this.el_init_offset.left+n-this.baseX);var s=Math.round(this.el_init_offset.top+r-this.baseY+this.scrollOffset);if(this.options.limit){if(i>this.player_max_left){i=this.player_max_left}else{if(i<this.player_min_left){i=this.player_min_left}}}return{left:i,top:s,mouse_left:t.left,mouse_top:t.top}};f.manage_scroll=function(e){var t;var n=s.scrollTop();var r=n;var i=r+this.window_height;var o=i-50;var u=r+50;var a=e.mouse_left;var f=r+e.mouse_top;var l=this.doc_height-this.window_height+this.player_height;if(f>=o){t=n+30;if(t<l){s.scrollTop(t);this.scrollOffset=this.scrollOffset+30}}if(f<=u){t=n-30;if(t>0){s.scrollTop(t);this.scrollOffset=this.scrollOffset-30}}};f.calculate_positions=function(e){this.window_height=s.height()};f.drag_handler=function(t){var n=t.target.nodeName;if(this.disabled||t.which!==1&&!o){return}if(this.ignore_drag(t)){return}var r=this;var i=true;this.$player=e(t.currentTarget);this.el_init_pos=this.get_actual_pos(this.$player);this.mouse_init_pos=this.get_mouse_pos(t);this.offsetY=this.mouse_init_pos.top-this.el_init_pos.top;this.on_pointer_events_move=function(e){var t=r.get_mouse_pos(e);var n=Math.abs(t.left-r.mouse_init_pos.left);var s=Math.abs(t.top-r.mouse_init_pos.top);if(!(n>r.options.distance||s>r.options.distance)){return false}if(i){i=false;r.on_dragstart.call(r,e);return false}if(r.is_dragging===true){r.on_dragmove.call(r,e)}return false};this.$body.on(u.move,this.on_pointer_events_move);return false};f.on_dragstart=function(t){t.preventDefault();this.drag_start=true;this.is_dragging=true;var r=this.$container.offset();this.baseX=Math.round(r.left);this.baseY=Math.round(r.top);this.doc_height=e(n).height();if(this.options.helper==="clone"){this.$helper=this.$player.clone().appendTo(this.$container).addClass("helper");this.helper=true}else{this.helper=false}this.scrollOffset=0;this.el_init_offset=this.$player.offset();this.player_width=this.$player.width();this.player_height=this.$player.height();this.player_max_left=this.$container.width()-this.player_width+this.options.offset_left;if(this.options.start){this.options.start.call(this.$player,t,{helper:this.helper?this.$helper:this.$player})}return false};f.on_dragmove=function(e){var t=this.get_offset(e);this.options.autoscroll&&this.manage_scroll(t);(this.helper?this.$helper:this.$player).css({position:"absolute",left:t.left,top:t.top});var n={position:{left:t.left,top:t.top}};if(this.options.drag){this.options.drag.call(this.$player,e,n)}return false};f.on_dragstop=function(e){var t=this.get_offset(e);this.drag_start=false;var n={position:{left:t.left,top:t.top}};if(this.options.stop){this.options.stop.call(this.$player,e,n)}if(this.helper){this.$helper.remove()}return false};f.on_select_start=function(e){if(this.disabled){return}if(this.ignore_drag(e)){return}return false};f.enable=function(){this.disabled=false};f.disable=function(){this.disabled=true};f.destroy=function(){this.disable();this.$container.off("selectstart",this.proxied_on_select_start);this.$container.off(u.start,this.proxied_drag_handler);this.$body.off(u.end,this.proxied_pointer_events_end);this.$body.off(u.move,this.on_pointer_events_move);e(t).unbind("resize",this.on_window_resize);e.removeData(this.$container,"drag")};f.ignore_drag=function(t){if(this.options.handle){return !e(t.target).is(this.options.handle)}return e.inArray(t.target.nodeName,this.options.ignore_dragging)>=0};e.fn.dragg=function(t){return this.each(function(){if(!e.data(this,"drag")){e.data(this,"drag",new a(this,t))}})}})(jQuery,window,document);(function(e,t,n,r){function s(t,n){this.options=e.extend(true,i,n);this.$el=e(t);this.$wrapper=this.$el.parent();this.$widgets=this.$el.children(this.options.widget_selector).addClass("gs_w");this.widgets=[];this.$changed=e([]);this.w_queue={};this.wrapper_width=this.$wrapper.width();this.min_widget_width=this.options.widget_margins[0]*2+this.options.widget_base_dimensions[0];this.min_widget_height=this.options.widget_margins[1]*2+this.options.widget_base_dimensions[1];this.init()}var i={namespace:"",widget_selector:"li",static_class:"static",widget_margins:[10,10],widget_base_dimensions:[400,225],extra_rows:0,extra_cols:0,min_cols:1,max_cols:60,min_rows:15,max_rows:15,max_size_x:6,autogenerate_stylesheet:true,avoid_overlapped_widgets:true,shift_larger_widgets_down:true,serialize_params:function(e,t){return{col:t.col,row:t.row,size_x:t.size_x,size_y:t.size_y}},collision:{},draggable:{distance:4,items:".gs_w:not(.static)"}};s.generated_stylesheets=[];var o=s.prototype;o.init=function(){this.generate_grid_and_stylesheet();this.get_widgets_from_DOM();this.set_dom_grid_height();this.$wrapper.addClass("ready");this.draggable();e(t).bind("resize",throttle(e.proxy(this.recalculate_faux_grid,this),200))};o.disable=function(){this.$wrapper.find(".player-revert").removeClass("player-revert");this.drag_api.disable();return this};o.enable=function(){this.drag_api.enable();return this};o.add_widget=function(t,n,r,i,s){var o;n||(n=1);r||(r=1);if(!i&!s){o=this.next_position(n,r)}else{o={col:i,row:s};this.empty_cells(i,s,n,r)}var u=e(t).attr({"data-col":o.col,"data-row":o.row,"data-sizex":n,"data-sizey":r}).addClass("gs_w").appendTo(this.$el).hide();this.$widgets=this.$widgets.add(u);this.$changed=this.$changed.add(u);this.register_widget(u);this.add_faux_rows(o.size_y);this.set_dom_grid_height();return u.fadeIn()};o.resize_widget=function(t,n,r){var i=t.coords().grid;n||(n=i.size_x);r||(r=i.size_y);if(n>this.cols){n=this.cols}var s=this.get_cells_occupied(i);var o=i.size_x;var u=i.size_y;var a=i.col;var f=a;var l=n>o;var c=r>u;if(a+n-1>this.cols){var h=a+(n-1)-this.cols;var p=a-h;f=Math.max(1,p)}var d={col:f,row:i.row,size_x:n,size_y:r};var v=this.get_cells_occupied(d);var m=[];e.each(s.cols,function(t,n){if(e.inArray(n,v.cols)===-1){m.push(n)}});var g=[];e.each(v.cols,function(t,n){if(e.inArray(n,s.cols)===-1){g.push(n)}});var y=[];e.each(s.rows,function(t,n){if(e.inArray(n,v.rows)===-1){y.push(n)}});var b=[];e.each(v.rows,function(t,n){if(e.inArray(n,s.rows)===-1){b.push(n)}});this.remove_from_gridmap(i);if(g.length){var w=[f,i.row,n,Math.min(u,r),t];this.empty_cells.apply(this,w)}if(b.length){var E=[f,i.row,n,r,t];this.empty_cells.apply(this,E)}i.col=f;i.size_x=n;i.size_y=r;this.add_to_gridmap(d,t);t.data("coords").update({width:n*this.options.widget_base_dimensions[0]+(n-1)*this.options.widget_margins[0]*2,height:r*this.options.widget_base_dimensions[1]+(r-1)*this.options.widget_margins[1]*2});if(r>u){this.add_faux_rows(r-u)}if(n>o){this.add_faux_cols(n-o)}t.attr({"data-col":f,"data-sizex":n,"data-sizey":r});if(m.length){var S=[m[0],i.row,m.length,Math.min(u,r),t];this.remove_empty_cells.apply(this,S)}if(y.length){var x=[f,i.row,n,r,t];this.remove_empty_cells.apply(this,x)}return t};o.empty_cells=function(t,n,r,i,s){var o=this.widgets_below({col:t,row:n-i,size_x:r,size_y:i});o.not(s).each(e.proxy(function(t,r){var s=e(r).coords().grid;if(!(s.row<=n+i-1)){return}var o=n+i-s.row;this.move_widget_down(e(r),o)},this));this.set_dom_grid_height();return this};o.remove_empty_cells=function(e,t,n,r,i){var s=this.widgets_below({col:e,row:t,size_x:n,size_y:r});this.set_dom_grid_height();return this};o.next_position=function(e,t){e||(e=1);t||(t=1);var n=this.gridmap;var r=n.length;var i=[];var s;for(var o=1;o<r;o++){s=n[o].length;for(var u=1;u<=s;u++){var a=this.can_move_to({size_x:e,size_y:t},o,u);if(a){i.push({col:o,row:u,size_y:t,size_x:e})}}}if(i.length){return this.sort_by_row_and_col_asc(i)[0]}return false};o.remove_by_grid=function(e,t){var n=this.is_widget(e,t);if(n){this.remove_widget(n)}};o.remove_widget=function(t,n,r){var i=t instanceof jQuery?t:e(t);var s=i.coords().grid;if(e.isFunction(n)){r=n;n=false}this.cells_occupied_by_placeholder={};this.$widgets=this.$widgets.not(i);var o=this.widgets_below(i);this.remove_from_gridmap(s);i.fadeOut(e.proxy(function(){i.remove();if(!n){o.each(e.proxy(function(t,n){this.move_widget_up(e(n),s.size_y)},this))}this.set_dom_grid_height();if(r){r.call(this,t)}},this))};o.remove_all_widgets=function(t){this.$widgets.each(e.proxy(function(e,n){this.remove_widget(n,true,t)},this));return this};o.serialize=function(t){t||(t=this.$widgets);var n=[];t.each(e.proxy(function(t,r){if(typeof e(r).coords().grid!="undefined"){n.push(this.options.serialize_params(e(r),e(r).coords().grid))}},this));return n};o.serialize_changed=function(){return this.serialize(this.$changed)};o.register_widget=function(e){var t={col:parseInt(e.attr("data-col"),10),row:parseInt(e.attr("data-row"),10),size_x:parseInt(e.attr("data-sizex"),10),size_y:parseInt(e.attr("data-sizey"),10),el:e};if(this.options.avoid_overlapped_widgets&&!this.can_move_to({size_x:t.size_x,size_y:t.size_y},t.col,t.row)){t=this.next_position(t.size_x,t.size_y);t.el=e;e.attr({"data-col":t.col,"data-row":t.row,"data-sizex":t.size_x,"data-sizey":t.size_y})}e.data("coords",e.coords());e.data("coords").grid=t;this.add_to_gridmap(t,e);return this};o.update_widget_position=function(e,t){this.for_each_cell_occupied(e,function(e,n){if(!this.gridmap[e]){return this}this.gridmap[e][n]=t});return this};o.remove_from_gridmap=function(e){return this.update_widget_position(e,false)};o.add_to_gridmap=function(e,t){this.update_widget_position(e,t||e.el)};o.draggable=function(){var t=this;var n=e.extend(true,{},this.options.draggable,{offset_left:this.options.widget_margins[0],start:function(n,r){t.$widgets.filter(".player-revert").removeClass("player-revert");t.$player=e(this);t.$helper=t.options.draggable.helper==="clone"?e(r.helper):t.$player;t.helper=!t.$helper.is(t.$player);t.on_start_drag.call(t,n,r);t.$el.trigger("gridster:dragstart")},stop:function(e,n){t.on_stop_drag.call(t,e,n);t.$el.trigger("gridster:dragstop")},drag:throttle(function(e,n){t.on_drag.call(t,e,n);t.$el.trigger("gridster:drag")},60)});this.drag_api=this.$el.dragg(n).data("drag");return this};o.on_start_drag=function(t,n){this.$helper.add(this.$player).add(this.$wrapper).addClass("dragging");this.$player.addClass("player");this.player_grid_data=this.$player.coords().grid;this.placeholder_grid_data=e.extend({},this.player_grid_data);this.$el.css("height",this.$el.height()+this.player_grid_data.size_y*this.min_widget_height);var r=this.faux_grid;var i=this.$player.data("coords").coords;this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data);this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data);this.last_cols=[];this.last_rows=[];this.collision_api=this.$helper.collision(r,this.options.collision);this.$preview_holder=e("<li />",{"class":"preview-holder","data-row":this.$player.attr("data-row"),"data-col":this.$player.attr("data-col"),css:{width:i.width,height:i.height}}).appendTo(this.$el);if(this.options.draggable.start){this.options.draggable.start.call(this,t,n)}};o.on_drag=function(e,t){if(this.$player===null){return false}var n={left:t.position.left+this.baseX,top:t.position.top+this.baseY};this.colliders_data=this.collision_api.get_closest_colliders(n);this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column);this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row);if(this.helper&&this.$player){this.$player.css({left:t.position.left,top:t.position.top})}if(this.options.draggable.drag){this.options.draggable.drag.call(this,e,t)}};o.on_stop_drag=function(e,t){this.$helper.add(this.$player).add(this.$wrapper).removeClass("dragging");t.position.left=t.position.left+this.baseX;t.position.top=t.position.top+this.baseY;this.colliders_data=this.collision_api.get_closest_colliders(t.position);this.on_overlapped_column_change(this.on_start_overlapping_column,this.on_stop_overlapping_column);this.on_overlapped_row_change(this.on_start_overlapping_row,this.on_stop_overlapping_row);this.$player.addClass("player-revert").removeClass("player").attr({"data-col":this.placeholder_grid_data.col,"data-row":this.placeholder_grid_data.row}).css({left:"",top:""});this.$changed=this.$changed.add(this.$player);this.cells_occupied_by_player=this.get_cells_occupied(this.placeholder_grid_data);this.set_cells_player_occupies(this.placeholder_grid_data.col,this.placeholder_grid_data.row);this.$player.coords().grid.row=this.placeholder_grid_data.row;this.$player.coords().grid.col=this.placeholder_grid_data.col;if(this.options.draggable.stop){this.options.draggable.stop.call(this,e,t)}this.$preview_holder.remove();this.$player=null;this.$helper=null;this.placeholder_grid_data={};this.player_grid_data={};this.cells_occupied_by_placeholder={};this.cells_occupied_by_player={};this.w_queue={};this.set_dom_grid_height()};o.on_overlapped_column_change=function(t,n){if(!this.colliders_data.length){return}var r=this.get_targeted_columns(this.colliders_data[0].el.data.col);var i=this.last_cols.length;var s=r.length;var o;for(o=0;o<s;o++){if(e.inArray(r[o],this.last_cols)===-1){(t||e.noop).call(this,r[o])}}for(o=0;o<i;o++){if(e.inArray(this.last_cols[o],r)===-1){(n||e.noop).call(this,this.last_cols[o])}}this.last_cols=r;return this};o.on_overlapped_row_change=function(t,n){if(!this.colliders_data.length){return}var r=this.get_targeted_rows(this.colliders_data[0].el.data.row);var i=this.last_rows.length;var s=r.length;var o;for(o=0;o<s;o++){if(e.inArray(r[o],this.last_rows)===-1){(t||e.noop).call(this,r[o])}}for(o=0;o<i;o++){if(e.inArray(this.last_rows[o],r)===-1){(n||e.noop).call(this,this.last_rows[o])}}this.last_rows=r};o.set_player=function(t,n,r){var i=this;var s=false;if(!r){this.empty_cells_player_occupies()}var o=!r?i.colliders_data[0].el.data:{col:t};var u=o.col;var a=o.row||n;this.player_grid_data={col:u,row:a,size_y:this.player_grid_data.size_y,size_x:this.player_grid_data.size_x};this.cells_occupied_by_player=this.get_cells_occupied(this.player_grid_data);this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data);var f=this.get_widgets_overlapped(this.player_grid_data);var l=this.player_grid_data.size_y;var c=this.player_grid_data.size_x;var h=this.cells_occupied_by_placeholder;var p=this;f.each(e.proxy(function(t,n){var r=e(n);var i=r.coords().grid;i.col=parseInt(i.col);i.row=parseInt(i.row);i.size_x=parseInt(i.size_x);i.size_y=parseInt(i.size_y);c=parseInt(c);l=parseInt(l);var o=h.cols[0]+c-1;var d=h.rows[0]+l-1;if(r.hasClass(p.options.static_class)){return true}if(i.size_x<=c&&i.size_y<=l){if(!p.is_swap_occupied(h.cols[0],i.row,i.size_x,i.size_y)&&!p.is_player_in(h.cols[0],i.row)&&!p.is_in_queue(h.cols[0],i.row,r)){s=p.queue_widget(h.cols[0],i.row,r)}else{if(!p.is_swap_occupied(o,i.row,i.size_x,i.size_y)&&!p.is_player_in(o,i.row)&&!p.is_in_queue(o,i.row,r)){s=p.queue_widget(o,i.row,r)}else{if(!p.is_swap_occupied(i.col,h.rows[0],i.size_x,i.size_y)&&!p.is_player_in(i.col,h.rows[0])&&!p.is_in_queue(i.col,h.rows[0],r)){s=p.queue_widget(i.col,h.rows[0],r)}else{if(!p.is_swap_occupied(i.col,d,i.size_x,i.size_y)&&!p.is_player_in(i.col,d)&&!p.is_in_queue(i.col,d,r)){s=p.queue_widget(i.col,d,r)}else{if(!p.is_swap_occupied(h.cols[0],h.rows[0],i.size_x,i.size_y)&&!p.is_player_in(h.cols[0],h.rows[0])&&!p.is_in_queue(h.cols[0],h.rows[0],r)){s=p.queue_widget(h.cols[0],h.rows[0],r)}else{for(var v=0;v<c;v++){for(var m=0;m<l;m++){var g=h.cols[0]+v;var y=h.rows[0]+m;if(!p.is_swap_occupied(g,y,i.size_x,i.size_y)&&!p.is_player_in(g,y)&&!p.is_in_queue(g,y,r)){s=p.queue_widget(g,y,r);v=c;break}}}}}}}}}else{if(p.options.shift_larger_widgets_down&&!s){f.each(e.proxy(function(t,n){var r=e(n);var i=r.coords().grid;if(p.can_go_down(r)){p.move_widget_down(r,p.player_grid_data.size_y);p.set_placeholder(u,a)}}))}}p.clean_up_changed()}));if(s&&this.can_placeholder_be_set(u,a,c,l)){for(var d in this.w_queue){var t=parseInt(d.split("_")[0]);var n=parseInt(d.split("_")[1]);if(this.w_queue[d]!="full"){this.new_move_widget_to(this.w_queue[d],t,n)}}this.set_placeholder(u,a)}if(!f.length){var v=this.can_go_player_up(this.player_grid_data);if(v!==false){a=v}if(this.can_placeholder_be_set(u,a,c,l)){this.set_placeholder(u,a)}}this.w_queue={};return{col:u,row:a}};o.is_swap_occupied=function(e,t,n,r){var i=false;for(var s=0;s<n;s++){for(var o=0;o<r;o++){var u=e+s;var a=t+o;var f=u+"_"+a;if(this.is_occupied(u,a)){i=true}else{if(f in this.w_queue){if(this.w_queue[f]=="full"){i=true;continue}$tw=this.w_queue[f];tgd=$tw.coords().grid;if(!this.is_widget_under_player(tgd.col,tgd.row)){delete this.w_queue[f]}}}if(a>parseInt(this.options.max_rows)){i=true}if(u>parseInt(this.options.max_cols)){i=true}if(this.is_player_in(u,a)){i=true}}}return i};o.can_placeholder_be_set=function(e,t,n,r){var i=true;for(var s=0;s<n;s++){for(var o=0;o<r;o++){var u=e+s;var a=t+o;var f=u+"_"+a;var l=this.is_widget(u,a);if(a>parseInt(this.options.max_rows)){i=false}if(u>parseInt(this.options.max_cols)){i=false}if(this.is_occupied(u,a)&&!this.is_widget_queued_and_can_move(l)){i=false}}}return i};o.queue_widget=function(e,t,n){var r=n;var i=r.coords().grid;var s=e+"_"+t;if(s in this.w_queue){return false}this.w_queue[s]=r;for(var o=0;o<i.size_x;o++){for(var u=0;u<i.size_y;u++){var a=e+o;var f=t+u;var l=a+"_"+f;if(l==s){continue}this.w_queue[l]="full"}}return true};o.is_widget_queued_and_can_move=function(e){var t=false;if(e===false){return false}for(var n in this.w_queue){if(this.w_queue[n]=="full"){continue}if(this.w_queue[n].attr("data-col")==e.attr("data-col")&&this.w_queue[n].attr("data-row")==e.attr("data-row")){t=true;var r=this.w_queue[n];var i=parseInt(n.split("_")[0]);var s=parseInt(n.split("_")[1]);var o=r.coords().grid;for(var u=0;u<o.size_x;u++){for(var a=0;a<o.size_y;a++){var f=i+u;var l=s+a;if(this.is_player_in(f,l)){t=false}}}}}return t};o.is_in_queue=function(e,t,n){var r=false;var i=e+"_"+t;if(i in this.w_queue){if(this.w_queue[i]=="full"){r=true}else{$tw=this.w_queue[i];tgd=$tw.coords().grid;if(!this.is_widget_under_player(tgd.col,tgd.row)){delete this.w_queue[i];r=false}else{if(this.w_queue[i].attr("data-col")==n.attr("data-col")&&this.w_queue[i].attr("data-row")==n.attr("data-row")){delete this.w_queue[i];r=false}else{r=true}}}}return r};o.widgets_constraints=function(t){var n=e([]);var r;var i=[];var s=[];t.each(e.proxy(function(t,r){var o=e(r);var u=o.coords().grid;if(this.can_go_widget_up(u)){n=n.add(o);i.push(u)}else{s.push(u)}},this));r=t.not(n);return{can_go_up:this.sort_by_row_asc(i),can_not_go_up:this.sort_by_row_desc(s)}};o.sort_by_row_asc=function(t){t=t.sort(function(t,n){if(!t.row){t=e(t).coords().grid;n=e(n).coords().grid}if(t.row>n.row){return 1}return -1});return t};o.sort_by_row_and_col_asc=function(e){e=e.sort(function(e,t){if(e.row>t.row||e.row===t.row&&e.col>t.col){return 1}return -1});return e};o.sort_by_col_asc=function(e){e=e.sort(function(e,t){if(e.col>t.col){return 1}return -1});return e};o.sort_by_row_desc=function(e){e=e.sort(function(e,t){if(e.row+e.size_y<t.row+t.size_y){return 1}return -1});return e};o.manage_movements=function(t,n,r){e.each(t,e.proxy(function(e,t){var i=t;var s=i.el;var o=this.can_go_widget_up(i);if(o){this.move_widget_to(s,o);this.set_placeholder(n,o+i.size_y)}else{var u=this.can_go_player_up(this.player_grid_data);if(!u){var a=r+this.player_grid_data.size_y-i.row;if(this.can_go_down(s)){console.log("In Move Down!");this.move_widget_down(s,a);this.set_placeholder(n,r)}}}},this));return this};o.is_player=function(e,t){if(t&&!this.gridmap[e]){return false}var n=t?this.gridmap[e][t]:e;return n&&(n.is(this.$player)||n.is(this.$helper))};o.is_player_in=function(t,n){var r=this.cells_occupied_by_player||{};return e.inArray(t,r.cols)>=0&&e.inArray(n,r.rows)>=0};o.is_placeholder_in=function(t,n){var r=this.cells_occupied_by_placeholder||{};return this.is_placeholder_in_col(t)&&e.inArray(n,r.rows)>=0};o.is_placeholder_in_col=function(t){var n=this.cells_occupied_by_placeholder||[];return e.inArray(t,n.cols)>=0};o.is_empty=function(e,t){if(typeof this.gridmap[e]!=="undefined"&&typeof this.gridmap[e][t]!=="undefined"&&this.gridmap[e][t]===false){return true}return false};o.is_occupied=function(e,t){if(!this.gridmap[e]){return false}if(this.gridmap[e][t]){return true}return false};o.is_widget=function(e,t){var n=this.gridmap[e];if(!n){return false}n=n[t];if(n){return n}return false};o.is_static=function(e,t){var n=this.gridmap[e];if(!n){return false}n=n[t];if(n){if(n.hasClass(this.options.static_class)){return true}}return false};o.is_widget_under_player=function(e,t){if(this.is_widget(e,t)){return this.is_player_in(e,t)}return false};o.get_widgets_under_player=function(t){t||(t=this.cells_occupied_by_player||{cols:[],rows:[]});var n=e([]);e.each(t.cols,e.proxy(function(r,i){e.each(t.rows,e.proxy(function(e,t){if(this.is_widget(i,t)){n=n.add(this.gridmap[i][t])}},this))},this));return n};o.set_placeholder=function(t,n){var r=e.extend({},this.placeholder_grid_data);var i=this.widgets_below({col:r.col,row:r.row,size_y:r.size_y,size_x:r.size_x});var s=t+parseInt(r.size_x)-1;if(s>this.cols){t=t-(s-t)}var o=this.placeholder_grid_data.row<n;var u=this.placeholder_grid_data.col!==t;this.placeholder_grid_data.col=t;this.placeholder_grid_data.row=n;this.cells_occupied_by_placeholder=this.get_cells_occupied(this.placeholder_grid_data);this.$preview_holder.attr({"data-row":n,"data-col":t});if(o||u){i.each(e.proxy(function(t,n){$w=e(n);wgd=$w.coords().grid;var r=this.can_go_widget_up(wgd);if(r){this.move_widget_to($w,r)}},this))}var a=this.get_widgets_under_player(this.cells_occupied_by_placeholder);if(a.length){a.each(e.proxy(function(t,i){var s=e(i);this.move_widget_down(s,n+r.size_y-s.data("coords").grid.row)},this))}};o.can_go_player_up=function(e){var t=e.row+e.size_y-1;var n=true;var r=[];var i=10000;var s=this.get_widgets_under_player();this.for_each_column_occupied(e,function(e){var o=this.gridmap[e];var u=t+1;r[e]=[];while(--u>0){if(this.is_empty(e,u)||this.is_player(e,u)||this.is_widget(e,u)&&o[u].is(s)){r[e].push(u);i=u<i?u:i}else{break}}if(r[e].length===0){n=false;return true}r[e].sort()});if(!n){return false}return this.get_valid_rows(e,r,i)};o.can_go_widget_up=function(e){var t=e.row+e.size_y-1;var n=true;var r=[];var i=10000;this.for_each_column_occupied(e,function(s){var o=this.gridmap[s];r[s]=[];var u=t+1;while(--u>0){if(this.is_widget(s,u)&&!this.is_player_in(s,u)){if(!o[u].is(e.el)){break}}if(!this.is_player(s,u)&&!this.is_placeholder_in(s,u)&&!this.is_player_in(s,u)){r[s].push(u)}if(u<i){i=u}}if(r[s].length===0){n=false;return true}r[s].sort()});if(!n){return false}return this.get_valid_rows(e,r,i)};o.get_valid_rows=function(t,n,r){var i=t.row;var s=t.row+t.size_y-1;var o=t.size_y;var u=r-1;var a=[];while(++u<=s){var f=true;e.each(n,function(t,n){if(e.isArray(n)&&e.inArray(u,n)===-1){f=false}});if(f===true){a.push(u);if(a.length===o){break}}}var l=false;if(o===1){if(a[0]!==i){l=a[0]||false}}else{if(a[0]!==i){l=this.get_consecutive_numbers_index(a,o)}}return l};o.get_consecutive_numbers_index=function(e,t){var n=e.length;var r=[];var i=true;var s=-1;for(var o=0;o<n;o++){if(i||e[o]===s+1){r.push(o);if(r.length===t){break}i=false}else{r=[];i=true}s=e[o]}return r.length>=t?e[r[0]]:false};o.get_widgets_overlapped=function(){var t;var n=e([]);var r=[];var i=this.cells_occupied_by_player.rows.slice(0);i.reverse();e.each(this.cells_occupied_by_player.cols,e.proxy(function(t,s){e.each(i,e.proxy(function(t,i){if(!this.gridmap[s]){return true}var o=this.gridmap[s][i];if(this.is_occupied(s,i)&&!this.is_player(o)&&e.inArray(o,r)===-1){n=n.add(o);r.push(o)}},this))},this));return n};o.on_start_overlapping_column=function(e){this.set_player(e,false)};o.on_start_overlapping_row=function(e){this.set_player(false,e)};o.on_stop_overlapping_column=function(e){var t=this;if(this.options.shift_larger_widgets_down){this.for_each_widget_below(e,this.cells_occupied_by_player.rows[0],function(e,n){t.move_widget_up(this,t.player_grid_data.size_y)})}};o.on_stop_overlapping_row=function(e){var t=this;var n=this.cells_occupied_by_player.cols;if(this.options.shift_larger_widgets_down){for(var r=0,i=n.length;r<i;r++){this.for_each_widget_below(n[r],e,function(e,n){console.log("from_on_stop_overlapping_row");t.move_widget_up(this,t.player_grid_data.size_y)})}}};o.new_move_widget_to=function(e,t,n){var r=this;var i=e.coords().grid;this.remove_from_gridmap(i);i.row=n;i.col=t;this.add_to_gridmap(i);e.attr("data-row",n);e.attr("data-col",t);this.update_widget_position(i,e);this.$changed=this.$changed.add(e);return this};o.move_widget_to=function(t,n){var r=this;var i=t.coords().grid;var s=n-i.row;var o=this.widgets_below(t);var u=this.can_move_to(i,i.col,n,t);if(u===false){return false}this.remove_from_gridmap(i);i.row=n;this.add_to_gridmap(i);t.attr("data-row",n);this.$changed=this.$changed.add(t);o.each(function(t,n){var i=e(n);var s=i.coords().grid;var o=r.can_go_widget_up(s);if(o&&o!==s.row){r.move_widget_to(i,o)}});return this};o.move_widget_up=function(t,n){var r=t.coords().grid;var i=r.row;var s=[];var o=true;n||(n=1);if(!this.can_go_up(t)){return false}this.for_each_column_occupied(r,function(r){if(e.inArray(t,s)===-1){var o=t.coords().grid;var u=i-n;u=this.can_go_up_to_row(o,r,u);if(!u){return true}var a=this.widgets_below(t);this.remove_from_gridmap(o);o.row=u;this.add_to_gridmap(o);t.attr("data-row",o.row);this.$changed=this.$changed.add(t);s.push(t)}})};o.move_widget_down=function(t,n){var r=t.coords().grid;var i=r.row;var s=[];var o=n;if(!t){return false}if(e.inArray(t,s)===-1){var u=t.coords().grid;var a=i+n;var f=this.widgets_below(t);this.remove_from_gridmap(u);f.each(e.proxy(function(t,n){var r=e(n);var i=r.coords().grid;var s=this.displacement_diff(i,u,o);if(s>0){this.move_widget_down(r,s)}},this));u.row=a;this.update_widget_position(u,t);t.attr("data-row",u.row);this.$changed=this.$changed.add(t);s.push(t)}};o.can_go_up_to_row=function(t,n,r){var i=this.gridmap;var s=true;var o=[];var u=t.row;var a;this.for_each_column_occupied(t,function(e){var t=i[e];o[e]=[];a=u;while(a--){if(this.is_empty(e,a)&&!this.is_placeholder_in(e,a)){o[e].push(a)}else{break}}if(!o[e].length){s=false;return true}});if(!s){return false}a=r;for(a=1;a<u;a++){var f=true;for(var l=0,c=o.length;l<c;l++){if(o[l]&&e.inArray(a,o[l])===-1){f=false}}if(f===true){s=a;break}}return s};o.displacement_diff=function(e,t,n){var r=e.row;var i=[];var s=t.row+t.size_y;this.for_each_column_occupied(e,function(e){var t=0;for(var n=s;n<r;n++){if(this.is_empty(e,n)){t=t+1}}i.push(t)});var o=Math.max.apply(Math,i);n=n-o;return n>0?n:0};o.widgets_below=function(t){var n=e.isPlainObject(t)?t:t.coords().grid;var r=this;var i=this.gridmap;var s=n.row+n.size_y-1;var o=e([]);this.for_each_column_occupied(n,function(t){r.for_each_widget_below(t,s,function(t,n){if(!r.is_player(this)&&e.inArray(this,o)===-1){o=o.add(this);return true}})});return this.sort_by_row_asc(o)};o.set_cells_player_occupies=function(e,t){this.remove_from_gridmap(this.placeholder_grid_data);this.placeholder_grid_data.col=e;this.placeholder_grid_data.row=t;this.add_to_gridmap(this.placeholder_grid_data,this.$player);return this};o.empty_cells_player_occupies=function(){this.remove_from_gridmap(this.placeholder_grid_data);return this};o.can_go_down=function(t){var n=true;var r=this;if(t.hasClass(this.options.static_class)){n=false}this.widgets_below(t).each(function(){if(e(this).hasClass(r.options.static_class)){n=false}});return n};o.can_go_up=function(e){var t=e.coords().grid;var n=t.row;var r=n-1;var i=this.gridmap;var s=[];var o=true;if(n===1){return false}this.for_each_column_occupied(t,function(e){var t=this.is_widget(e,r);if(this.is_occupied(e,r)||this.is_player(e,r)||this.is_placeholder_in(e,r)||this.is_player_in(e,r)){o=false;return true}});return o};o.can_move_to=function(e,t,n,r){var i=this.gridmap;var s=e.el;var o={size_y:e.size_y,size_x:e.size_x,col:t,row:n};var u=true;var a=t+e.size_x-1;if(a>this.cols){return false}if(r&&r<n+e.size_y-1){return false}this.for_each_cell_occupied(o,function(t,n){var r=this.is_widget(t,n);if(r&&(!e.el||r.is(s))){u=false}});return u};o.get_targeted_columns=function(e){var t=(e||this.player_grid_data.col)+(this.player_grid_data.size_x-1);var n=[];for(var r=e;r<=t;r++){n.push(r)}return n};o.get_targeted_rows=function(e){var t=(e||this.player_grid_data.row)+(this.player_grid_data.size_y-1);var n=[];for(var r=e;r<=t;r++){n.push(r)}return n};o.get_cells_occupied=function(e){var t={cols:[],rows:[]};var n;if(arguments[1] instanceof jQuery){e=arguments[1].coords().grid}for(n=0;n<e.size_x;n++){var r=e.col+n;t.cols.push(r)}for(n=0;n<e.size_y;n++){var i=e.row+n;t.rows.push(i)}return t};o.for_each_cell_occupied=function(e,t){this.for_each_column_occupied(e,function(n){this.for_each_row_occupied(e,function(e){t.call(this,n,e)})});return this};o.for_each_column_occupied=function(e,t){for(var n=0;n<e.size_x;n++){var r=e.col+n;t.call(this,r,e)}};o.for_each_row_occupied=function(e,t){for(var n=0;n<e.size_y;n++){var r=e.row+n;t.call(this,r,e)}};o.clean_up_changed=function(){$gr=this;$gr.$changed.each(function(){if($gr.options.shift_larger_widgets_down){$gr.move_widget_up(e(this))}})};o._traversing_widgets=function(t,n,r,i,s){var o=this.gridmap;if(!o[r]){return}var u,a;var f=t+"/"+n;if(arguments[2] instanceof jQuery){var l=arguments[2].coords().grid;r=l.col;i=l.row;s=arguments[3]}var c=[];var h=i;var p={"for_each/above":function(){while(h--){if(h>0&&this.is_widget(r,h)&&e.inArray(o[r][h],c)===-1){u=s.call(o[r][h],r,h);c.push(o[r][h]);if(u){break}}}},"for_each/below":function(){for(h=i+1,a=o[r].length;h<a;h++){if(this.is_widget(r,h)&&e.inArray(o[r][h],c)===-1){u=s.call(o[r][h],r,h);c.push(o[r][h])}}}};if(p[f]){p[f].call(this)}};o.for_each_widget_above=function(e,t,n){this._traversing_widgets("for_each","above",e,t,n);return this};o.for_each_widget_below=function(e,t,n){this._traversing_widgets("for_each","below",e,t,n);return this};o.get_highest_occupied_cell=function(){var e;var t=this.gridmap;var n=[];var r=[];for(var i=t.length-1;i>=1;i--){for(e=t[i].length-1;e>=1;e--){if(this.is_widget(i,e)){n.push(e);r[e]=i;break}}}var s=Math.max.apply(Math,n);this.highest_occupied_cell={col:r[s],row:s};return this.highest_occupied_cell};o.get_widgets_from=function(t,n){var r=this.gridmap;var i=e();if(t){i=i.add(this.$widgets.filter(function(){var n=e(this).attr("data-col");return n===t||n>t}))}if(n){i=i.add(this.$widgets.filter(function(){var t=e(this).attr("data-row");return t===n||t>n}))}return i};o.set_dom_grid_height=function(){var e=this.get_highest_occupied_cell().row;this.$el.css("height",e*this.min_widget_height);return this};o.generate_stylesheet=function(t){var n="";var r=this.options.max_size_x;var i=0;var o=0;var u;var a;t||(t={});t.cols||(t.cols=this.cols);t.rows||(t.rows=this.rows);t.namespace||(t.namespace=this.options.namespace);t.widget_base_dimensions||(t.widget_base_dimensions=this.options.widget_base_dimensions);t.widget_margins||(t.widget_margins=this.options.widget_margins);t.min_widget_width=t.widget_margins[0]*2+t.widget_base_dimensions[0];t.min_widget_height=t.widget_margins[1]*2+t.widget_base_dimensions[1];var f=e.param(t);if(e.inArray(f,s.generated_stylesheets)>=0){return false}s.generated_stylesheets.push(f);for(u=t.cols;u>=0;u--){n+=t.namespace+' [data-col="'+(u+1)+'"] { left:'+(u*t.widget_base_dimensions[0]+u*t.widget_margins[0]+(u+1)*t.widget_margins[0])+"px;} "}for(u=t.rows;u>=0;u--){n+=t.namespace+' [data-row="'+(u+1)+'"] { top:'+(u*t.widget_base_dimensions[1]+u*t.widget_margins[1]+(u+1)*t.widget_margins[1])+"px;} "}for(var l=1;l<=t.rows;l++){n+=t.namespace+' [data-sizey="'+l+'"] { height:'+(l*t.widget_base_dimensions[1]+(l-1)*t.widget_margins[1]*2)+"px;}"}for(var c=1;c<=r;c++){n+=t.namespace+' [data-sizex="'+c+'"] { width:'+(c*t.widget_base_dimensions[0]+(c-1)*t.widget_margins[0]*2)+"px;}"}return this.add_style_tag(n)};o.add_style_tag=function(e){var t=n;var r=t.createElement("style");t.getElementsByTagName("head")[0].appendChild(r);r.setAttribute("type","text/css");if(r.styleSheet){r.styleSheet.cssText=e}else{r.appendChild(n.createTextNode(e))}return this};o.generate_faux_grid=function(e,t){this.faux_grid=[];this.gridmap=[];var n;var r;for(n=t;n>0;n--){this.gridmap[n]=[];for(r=e;r>0;r--){this.add_faux_cell(r,n)}}return this};o.add_faux_cell=function(t,n){var r=e({left:this.baseX+(n-1)*this.min_widget_width,top:this.baseY+(t-1)*this.min_widget_height,width:this.min_widget_width,height:this.min_widget_height,col:n,row:t,original_col:n,original_row:t}).coords();if(!e.isArray(this.gridmap[n])){this.gridmap[n]=[]}this.gridmap[n][t]=false;this.faux_grid.push(r);return this};o.add_faux_rows=function(e){var t=this.rows;var n=t+(e||1);for(var r=n;r>t;r--){for(var i=this.cols;i>=1;i--){this.add_faux_cell(r,i)}}this.rows=n;if(this.options.autogenerate_stylesheet){this.generate_stylesheet()}return this};o.add_faux_cols=function(e){var t=this.cols;var n=t+(e||1);for(var r=t;r<n;r++){for(var i=this.rows;i>=1;i--){this.add_faux_cell(i,r)}}this.cols=n;if(this.options.autogenerate_stylesheet){this.generate_stylesheet()}return this};o.recalculate_faux_grid=function(){var n=this.$wrapper.width();this.baseX=(e(t).width()-n)/2;this.baseY=this.$wrapper.offset().top;e.each(this.faux_grid,e.proxy(function(e,t){this.faux_grid[e]=t.update({left:this.baseX+(t.data.col-1)*this.min_widget_width,top:this.baseY+(t.data.row-1)*this.min_widget_height})},this));return this};o.get_widgets_from_DOM=function(){this.$widgets.each(e.proxy(function(t,n){this.register_widget(e(n))},this));return this};o.generate_grid_and_stylesheet=function(){var n=this.$wrapper.width();var r=this.$wrapper.height();var i=Math.floor(n/this.min_widget_width)+this.options.extra_cols;var s=this.$widgets.map(function(){return e(this).attr("data-col")});s=Array.prototype.slice.call(s,0);s.length||(s=[0]);var o=Math.max.apply(Math,s);var u=this.options.extra_rows;this.$widgets.each(function(t,n){u+=+e(n).attr("data-sizey")});this.cols=Math.max(o,i,this.options.min_cols);this.rows=this.options.max_rows;this.baseX=(e(t).width()-n)/2;this.baseY=this.$wrapper.offset().top;if(this.options.autogenerate_stylesheet){this.generate_stylesheet()}return this.generate_faux_grid(this.rows,this.cols)};e.fn.gridster=function(t){return this.each(function(){if(!e(this).data("gridster")){e(this).data("gridster",new s(this,t))}})};e.Gridster=o})(jQuery,window,document);(function(a,b,c){(function(a){typeof define=="function"&&define.amd?define(["jquery"],a):jQuery&&!jQuery.fn.sparkline&&a(jQuery)})(function(d){var e={},f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L=0;f=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:c,normalRangeMax:c,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:c,chartRangeMax:c,chartRangeMinX:c,chartRangeMaxX:c,tooltipFormat:new h('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:c,nullColor:c,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:c,chartRangeMin:c,chartRangeClip:!1,colorMap:c,tooltipFormat:new h('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new h('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:c,thresholdValue:0,chartRangeMax:c,chartRangeMin:c,chartRangeClip:!1,tooltipFormat:new h("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:c,tooltipFormat:new h("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new h('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:c,targetColor:"#4a2",chartRangeMax:c,chartRangeMin:c,tooltipFormat:new h("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},E='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',g=function(){var a,b;return a=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(a.prototype=d.extend(new arguments[0],arguments[arguments.length-1]),a._super=arguments[0].prototype):a.prototype=arguments[arguments.length-1],arguments.length>2&&(b=Array.prototype.slice.call(arguments,1,-1),b.unshift(a.prototype),d.extend.apply(d,b))):a.prototype=arguments[0],a.prototype.cls=a,a},d.SPFormatClass=h=g({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(a,b){this.format=a,this.fclass=b},render:function(a,b,d){var e=this,f=a,g,h,i,j,k;return this.format.replace(this.fre,function(){var a;return h=arguments[1],i=arguments[3],g=e.precre.exec(h),g?(k=g[2],h=g[1]):k=!1,j=f[h],j===c?"":i&&b&&b[i]?(a=b[i],a.get?b[i].get(j)||j:b[i][j]||j):(n(j)&&(d.get("numberFormatter")?j=d.get("numberFormatter")(j):j=s(j,k,d.get("numberDigitGroupCount"),d.get("numberDigitGroupSep"),d.get("numberDecimalMark"))),j)})}}),d.spformat=function(a,b){return new h(a,b)},i=function(a,b,c){return a<b?b:a>c?c:a},j=function(a,c){var d;return c===2?(d=b.floor(a.length/2),a.length%2?a[d]:(a[d-1]+a[d])/2):a.length%2?(d=(a.length*c+c)/4,d%1?(a[b.floor(d)]+a[b.floor(d)-1])/2:a[d-1]):(d=(a.length*c+2)/4,d%1?(a[b.floor(d)]+a[b.floor(d)-1])/2:a[d-1])},k=function(a){var b;switch(a){case"undefined":a=c;break;case"null":a=null;break;case"true":a=!0;break;case"false":a=!1;break;default:b=parseFloat(a),a==b&&(a=b)}return a},l=function(a){var b,c=[];for(b=a.length;b--;){c[b]=k(a[b])}return c},m=function(a,b){var c,d,e=[];for(c=0,d=a.length;c<d;c++){a[c]!==b&&e.push(a[c])}return e},n=function(a){return !isNaN(parseFloat(a))&&isFinite(a)},s=function(a,b,c,e,f){var g,h;a=(b===!1?parseFloat(a).toString():a.toFixed(b)).split(""),g=(g=d.inArray(".",a))<0?a.length:g,g<a.length&&(a[g]=f);for(h=g-c;h>0;h-=c){a.splice(h,0,e)}return a.join("")},o=function(a,b,c){var d;for(d=b.length;d--;){if(c&&b[d]===null){continue}if(b[d]!==a){return !1}}return !0},p=function(a){var b=0,c;for(c=a.length;c--;){b+=typeof a[c]=="number"?a[c]:0}return b},r=function(a){return d.isArray(a)?a:[a]},q=function(b){var c;a.createStyleSheet?a.createStyleSheet().cssText=b:(c=a.createElement("style"),c.type="text/css",a.getElementsByTagName("head")[0].appendChild(c),c[typeof a.body.style.WebkitAppearance=="string"?"innerText":"innerHTML"]=b)},d.fn.simpledraw=function(b,e,f,g){var h,i;if(f&&(h=this.data("_jqs_vcanvas"))){return h}if(d.fn.sparkline.canvas===!1){return !1}if(d.fn.sparkline.canvas===c){var j=a.createElement("canvas");if(!j.getContext||!j.getContext("2d")){if(!a.namespaces||!!a.namespaces.v){return d.fn.sparkline.canvas=!1,!1}a.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),d.fn.sparkline.canvas=function(a,b,c,d){return new J(a,b,c)}}else{d.fn.sparkline.canvas=function(a,b,c,d){return new I(a,b,c,d)}}}return b===c&&(b=d(this).innerWidth()),e===c&&(e=d(this).innerHeight()),h=d.fn.sparkline.canvas(b,e,this,g),i=d(this).data("_jqs_mhandler"),i&&i.registerCanvas(h),h},d.fn.cleardraw=function(){var a=this.data("_jqs_vcanvas");a&&a.reset()},d.RangeMapClass=t=g({init:function(a){var b,c,d=[];for(b in a){a.hasOwnProperty(b)&&typeof b=="string"&&b.indexOf(":")>-1&&(c=b.split(":"),c[0]=c[0].length===0?-Infinity:parseFloat(c[0]),c[1]=c[1].length===0?Infinity:parseFloat(c[1]),c[2]=a[b],d.push(c))}this.map=a,this.rangelist=d||!1},get:function(a){var b=this.rangelist,d,e,f;if((f=this.map[a])!==c){return f}if(b){for(d=b.length;d--;){e=b[d];if(e[0]<=a&&e[1]>=a){return e[2]}}}return c}}),d.range_map=function(a){return new t(a)},u=g({init:function(a,b){var c=d(a);this.$el=c,this.options=b,this.currentPageX=0,this.currentPageY=0,this.el=a,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!b.get("disableTooltips"),this.highlightEnabled=!b.get("disableHighlight")},registerSparkline:function(a){this.splist.push(a),this.over&&this.updateDisplay()},registerCanvas:function(a){var b=d(a.canvas);this.canvas=a,this.$canvas=b,b.mouseenter(d.proxy(this.mouseenter,this)),b.mouseleave(d.proxy(this.mouseleave,this)),b.click(d.proxy(this.mouseclick,this))},reset:function(a){this.splist=[],this.tooltip&&a&&(this.tooltip.remove(),this.tooltip=c)},mouseclick:function(a){var b=d.Event("sparklineClick");b.originalEvent=a,b.sparklines=this.splist,this.$el.trigger(b)},mouseenter:function(b){d(a.body).unbind("mousemove.jqs"),d(a.body).bind("mousemove.jqs",d.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=b.pageX,this.currentPageY=b.pageY,this.currentEl=b.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new v(this.options),this.tooltip.updatePosition(b.pageX,b.pageY)),this.updateDisplay()},mouseleave:function(){d(a.body).unbind("mousemove.jqs");var b=this.splist,c=b.length,e=!1,f,g;this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null);for(g=0;g<c;g++){f=b[g],f.clearRegionHighlight()&&(e=!0)}e&&this.canvas.render()},mousemove:function(a){this.currentPageX=a.pageX,this.currentPageY=a.pageY,this.currentEl=a.target,this.tooltip&&this.tooltip.updatePosition(a.pageX,a.pageY),this.updateDisplay()},updateDisplay:function(){var a=this.splist,b=a.length,c=!1,e=this.$canvas.offset(),f=this.currentPageX-e.left,g=this.currentPageY-e.top,h,i,j,k,l;if(!this.over){return}for(j=0;j<b;j++){i=a[j],k=i.setRegionHighlight(this.currentEl,f,g),k&&(c=!0)}if(c){l=d.Event("sparklineRegionChange"),l.sparklines=this.splist,this.$el.trigger(l);if(this.tooltip){h="";for(j=0;j<b;j++){i=a[j],h+=i.getCurrentRegionTooltip()}this.tooltip.setContent(h)}this.disableHighlight||this.canvas.render()}k===null&&this.mouseleave()}}),v=g({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(b){var c=b.get("tooltipClassname","jqstooltip"),e=this.sizeStyle,f;this.container=b.get("tooltipContainer")||a.body,this.tooltipOffsetX=b.get("tooltipOffsetX",10),this.tooltipOffsetY=b.get("tooltipOffsetY",12),d("#jqssizetip").remove(),d("#jqstooltip").remove(),this.sizetip=d("<div/>",{id:"jqssizetip",style:e,"class":c}),this.tooltip=d("<div/>",{id:"jqstooltip","class":c}).appendTo(this.container),f=this.tooltip.offset(),this.offsetLeft=f.left,this.offsetTop=f.top,this.hidden=!0,d(window).unbind("resize.jqs scroll.jqs"),d(window).bind("resize.jqs scroll.jqs",d.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=d(window).scrollTop(),this.scrollLeft=d(window).scrollLeft(),this.scrollRight=this.scrollLeft+d(window).width(),this.updatePosition()},getSize:function(a){this.sizetip.html(a).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(a){if(!a){this.tooltip.css("visibility","hidden"),this.hidden=!0;return}this.getSize(a),this.tooltip.html(a).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())},updatePosition:function(a,b){if(a===c){if(this.mousex===c){return}a=this.mousex-this.offsetLeft,b=this.mousey-this.offsetTop}else{this.mousex=a-=this.offsetLeft,this.mousey=b-=this.offsetTop}if(!this.height||!this.width||this.hidden){return}b-=this.height+this.tooltipOffsetY,a+=this.tooltipOffsetX,b<this.scrollTop&&(b=this.scrollTop),a<this.scrollLeft?a=this.scrollLeft:a+this.width>this.scrollRight&&(a=this.scrollRight-this.width),this.tooltip.css({left:a,top:b})},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=c,d(window).unbind("resize.jqs scroll.jqs")}}),F=function(){q(E)},d(F),K=[],d.fn.sparkline=function(b,e){return this.each(function(){var f=new d.fn.sparkline.options(this,e),g=d(this),h,i;h=function(){var e,h,i,j,k,l,m;if(b==="html"||b===c){m=this.getAttribute(f.get("tagValuesAttribute"));if(m===c||m===null){m=g.html()}e=m.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")}else{e=b}h=f.get("width")==="auto"?e.length*f.get("defaultPixelsPerValue"):f.get("width");if(f.get("height")==="auto"){if(!f.get("composite")||!d.data(this,"_jqs_vcanvas")){j=a.createElement("span"),j.innerHTML="a",g.html(j),i=d(j).innerHeight()||d(j).height(),d(j).remove(),j=null}}else{i=f.get("height")}f.get("disableInteraction")?k=!1:(k=d.data(this,"_jqs_mhandler"),k?f.get("composite")||k.reset():(k=new u(this,f),d.data(this,"_jqs_mhandler",k)));if(f.get("composite")&&!d.data(this,"_jqs_vcanvas")){d.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),d.data(this,"_jqs_errnotify",!0));return}l=new (d.fn.sparkline[f.get("type")])(this,e,f,h,i),l.render(),k&&k.registerSparkline(l)};if(d(this).html()&&!f.get("disableHiddenCheck")&&d(this).is(":hidden")||!d(this).parents("body").length){if(!f.get("composite")&&d.data(this,"_jqs_pending")){for(i=K.length;i;i--){K[i-1][0]==this&&K.splice(i-1,1)}}K.push([this,h]),d.data(this,"_jqs_pending",!0)}else{h.call(this)}})},d.fn.sparkline.defaults=f(),d.sparkline_display_visible=function(){var a,b,c,e=[];for(b=0,c=K.length;b<c;b++){a=K[b][0],d(a).is(":visible")&&!d(a).parents().is(":hidden")?(K[b][1].call(a),d.data(K[b][0],"_jqs_pending",!1),e.push(b)):!d(a).closest("html").length&&!d.data(a,"_jqs_pending")&&(d.data(K[b][0],"_jqs_pending",!1),e.push(b))}for(b=e.length;b;b--){K.splice(e[b-1],1)}},d.fn.sparkline.options=g({init:function(a,b){var c,f,g,h;this.userOptions=b=b||{},this.tag=a,this.tagValCache={},f=d.fn.sparkline.defaults,g=f.common,this.tagOptionsPrefix=b.enableTagOptions&&(b.tagOptionsPrefix||g.tagOptionsPrefix),h=this.getTagSetting("type"),h===e?c=f[b.type||g.type]:c=f[h],this.mergedOptions=d.extend({},g,c,b)},getTagSetting:function(a){var b=this.tagOptionsPrefix,d,f,g,h;if(b===!1||b===c){return e}if(this.tagValCache.hasOwnProperty(a)){d=this.tagValCache.key}else{d=this.tag.getAttribute(b+a);if(d===c||d===null){d=e}else{if(d.substr(0,1)==="["){d=d.substr(1,d.length-2).split(",");for(f=d.length;f--;){d[f]=k(d[f].replace(/(^\s*)|(\s*$)/g,""))}}else{if(d.substr(0,1)==="{"){g=d.substr(1,d.length-2).split(","),d={};for(f=g.length;f--;){h=g[f].split(":",2),d[h[0].replace(/(^\s*)|(\s*$)/g,"")]=k(h[1].replace(/(^\s*)|(\s*$)/g,""))}}else{d=k(d)}}}this.tagValCache.key=d}return d},get:function(a,b){var d=this.getTagSetting(a),f;return d!==e?d:(f=this.mergedOptions[a])===c?b:f}}),d.fn.sparkline._base=g({disabled:!1,init:function(a,b,e,f,g){this.el=a,this.$el=d(a),this.values=b,this.options=e,this.width=f,this.height=g,this.currentRegion=c},initTarget:function(){var a=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),a))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(a,b){},setRegionHighlight:function(a,b,d){var e=this.currentRegion,f=!this.options.get("disableHighlight"),g;return b>this.canvasWidth||d>this.canvasHeight||b<0||d<0?null:(g=this.getRegion(a,b,d),e!==g?(e!==c&&f&&this.removeHighlight(),this.currentRegion=g,g!==c&&f&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return this.currentRegion!==c?(this.removeHighlight(),this.currentRegion=c,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(a){},getCurrentRegionTooltip:function(){var a=this.options,b="",e=[],f,g,i,j,k,l,m,n,o,p,q,r,s,t;if(this.currentRegion===c){return""}f=this.getCurrentRegionFields(),q=a.get("tooltipFormatter");if(q){return q(this,a,f)}a.get("tooltipChartTitle")&&(b+='<div class="jqs jqstitle">'+a.get("tooltipChartTitle")+"</div>\n"),g=this.options.get("tooltipFormat");if(!g){return""}d.isArray(g)||(g=[g]),d.isArray(f)||(f=[f]),m=this.options.get("tooltipFormatFieldlist"),n=this.options.get("tooltipFormatFieldlistKey");if(m&&n){o=[];for(l=f.length;l--;){p=f[l][n],(t=d.inArray(p,m))!=-1&&(o[t]=f[l])}f=o}i=g.length,s=f.length;for(l=0;l<i;l++){r=g[l],typeof r=="string"&&(r=new h(r)),j=r.fclass||"jqsfield";for(t=0;t<s;t++){if(!f[t].isNull||!a.get("tooltipSkipNull")){d.extend(f[t],{prefix:a.get("tooltipPrefix"),suffix:a.get("tooltipSuffix")}),k=r.render(f[t],a.get("tooltipValueLookups"),a),e.push('<div class="'+j+'">'+k+"</div>")}}}return e.length?b+e.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(a,c){var d=c.get("highlightColor"),e=c.get("highlightLighten"),f,g,h,j;if(d){return d}if(e){f=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(a);if(f){h=[],g=a.length===4?16:1;for(j=0;j<3;j++){h[j]=i(b.round(parseInt(f[j+1],16)*g*e),0,255)}return"rgb("+h.join(",")+")"}}return a}}),w={changeHighlight:function(a){var b=this.currentRegion,c=this.target,e=this.regionShapes[b],f;e&&(f=this.renderRegion(b,a),d.isArray(f)||d.isArray(e)?(c.replaceWithShapes(e,f),this.regionShapes[b]=d.map(f,function(a){return a.id})):(c.replaceWithShape(e,f),this.regionShapes[b]=f.id))},render:function(){var a=this.values,b=this.target,c=this.regionShapes,e,f,g,h;if(!this.cls._super.render.call(this)){return}for(g=a.length;g--;){e=this.renderRegion(g);if(e){if(d.isArray(e)){f=[];for(h=e.length;h--;){e[h].append(),f.push(e[h].id)}c[g]=f}else{e.append(),c[g]=e.id}}else{c[g]=null}}b.render()}},d.fn.sparkline.line=x=g(d.fn.sparkline._base,{type:"line",init:function(a,b,c,d,e){x._super.init.call(this,a,b,c,d,e),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(a,b,d){var e,f=this.regionMap;for(e=f.length;e--;){if(f[e]!==null&&b>=f[e][0]&&b<=f[e][1]){return f[e][2]}}return c},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.yvalues[a]===null,x:this.xvalues[a],y:this.yvalues[a],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:a}},renderHighlight:function(){var a=this.currentRegion,b=this.target,d=this.vertices[a],e=this.options,f=e.get("spotRadius"),g=e.get("highlightSpotColor"),h=e.get("highlightLineColor"),i,j;if(!d){return}f&&g&&(i=b.drawCircle(d[0],d[1],f,c,g),this.highlightSpotId=i.id,b.insertAfterShape(this.lastShapeId,i)),h&&(j=b.drawLine(d[0],this.canvasTop,d[0],this.canvasTop+this.canvasHeight,h),this.highlightLineId=j.id,b.insertAfterShape(this.lastShapeId,j))},removeHighlight:function(){var a=this.target;this.highlightSpotId&&(a.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(a.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var a=this.values,c=a.length,d=this.xvalues,e=this.yvalues,f=this.yminmax,g,h,i,j,k;for(g=0;g<c;g++){h=a[g],i=typeof a[g]=="string",j=typeof a[g]=="object"&&a[g] instanceof Array,k=i&&a[g].split(":"),i&&k.length===2?(d.push(Number(k[0])),e.push(Number(k[1])),f.push(Number(k[1]))):j?(d.push(h[0]),e.push(h[1]),f.push(h[1])):(d.push(g),a[g]===null||a[g]==="null"?e.push(null):(e.push(Number(h)),f.push(Number(h))))}this.options.get("xvalues")&&(d=this.options.get("xvalues")),this.maxy=this.maxyorg=b.max.apply(b,f),this.miny=this.minyorg=b.min.apply(b,f),this.maxx=b.max.apply(b,d),this.minx=b.min.apply(b,d),this.xvalues=d,this.yvalues=e,this.yminmax=f},processRangeOptions:function(){var a=this.options,b=a.get("normalRangeMin"),d=a.get("normalRangeMax");b!==c&&(b<this.miny&&(this.miny=b),d>this.maxy&&(this.maxy=d)),a.get("chartRangeMin")!==c&&(a.get("chartRangeClip")||a.get("chartRangeMin")<this.miny)&&(this.miny=a.get("chartRangeMin")),a.get("chartRangeMax")!==c&&(a.get("chartRangeClip")||a.get("chartRangeMax")>this.maxy)&&(this.maxy=a.get("chartRangeMax")),a.get("chartRangeMinX")!==c&&(a.get("chartRangeClipX")||a.get("chartRangeMinX")<this.minx)&&(this.minx=a.get("chartRangeMinX")),a.get("chartRangeMaxX")!==c&&(a.get("chartRangeClipX")||a.get("chartRangeMaxX")>this.maxx)&&(this.maxx=a.get("chartRangeMaxX"))},drawNormalRange:function(a,d,e,f,g){var h=this.options.get("normalRangeMin"),i=this.options.get("normalRangeMax"),j=d+b.round(e-e*((i-this.miny)/g)),k=b.round(e*(i-h)/g);this.target.drawRect(a,j,f,k,c,this.options.get("normalRangeColor")).append()},render:function(){var a=this.options,e=this.target,f=this.canvasWidth,g=this.canvasHeight,h=this.vertices,i=a.get("spotRadius"),j=this.regionMap,k,l,m,n,o,p,q,r,s,u,v,w,y,z,A,B,C,D,E,F,G,H,I,J,K;if(!x._super.render.call(this)){return}this.scanValues(),this.processRangeOptions(),I=this.xvalues,J=this.yvalues;if(!this.yminmax.length||this.yvalues.length<2){return}n=o=0,k=this.maxx-this.minx===0?1:this.maxx-this.minx,l=this.maxy-this.miny===0?1:this.maxy-this.miny,m=this.yvalues.length-1,i&&(f<i*4||g<i*4)&&(i=0);if(i){G=a.get("highlightSpotColor")&&!a.get("disableInteraction");if(G||a.get("minSpotColor")||a.get("spotColor")&&J[m]===this.miny){g-=b.ceil(i)}if(G||a.get("maxSpotColor")||a.get("spotColor")&&J[m]===this.maxy){g-=b.ceil(i),n+=b.ceil(i)}if(G||(a.get("minSpotColor")||a.get("maxSpotColor"))&&(J[0]===this.miny||J[0]===this.maxy)){o+=b.ceil(i),f-=b.ceil(i)}if(G||a.get("spotColor")||a.get("minSpotColor")||a.get("maxSpotColor")&&(J[m]===this.miny||J[m]===this.maxy)){f-=b.ceil(i)}}g--,a.get("normalRangeMin")!==c&&!a.get("drawNormalOnTop")&&this.drawNormalRange(o,n,g,f,l),q=[],r=[q],z=A=null,B=J.length;for(K=0;K<B;K++){s=I[K],v=I[K+1],u=J[K],w=o+b.round((s-this.minx)*(f/k)),y=K<B-1?o+b.round((v-this.minx)*(f/k)):f,A=w+(y-w)/2,j[K]=[z||0,A,K],z=A,u===null?K&&(J[K-1]!==null&&(q=[],r.push(q)),h.push(null)):(u<this.miny&&(u=this.miny),u>this.maxy&&(u=this.maxy),q.length||q.push([w,n+g]),p=[w,n+b.round(g-g*((u-this.miny)/l))],q.push(p),h.push(p))}C=[],D=[],E=r.length;for(K=0;K<E;K++){q=r[K],q.length&&(a.get("fillColor")&&(q.push([q[q.length-1][0],n+g]),D.push(q.slice(0)),q.pop()),q.length>2&&(q[0]=[q[0][0],q[1][1]]),C.push(q))}E=D.length;for(K=0;K<E;K++){e.drawShape(D[K],a.get("fillColor"),a.get("fillColor")).append()}a.get("normalRangeMin")!==c&&a.get("drawNormalOnTop")&&this.drawNormalRange(o,n,g,f,l),E=C.length;for(K=0;K<E;K++){e.drawShape(C[K],a.get("lineColor"),c,a.get("lineWidth")).append()}if(i&&a.get("valueSpots")){F=a.get("valueSpots"),F.get===c&&(F=new t(F));for(K=0;K<B;K++){H=F.get(J[K]),H&&e.drawCircle(o+b.round((I[K]-this.minx)*(f/k)),n+b.round(g-g*((J[K]-this.miny)/l)),i,c,H).append()}}i&&a.get("spotColor")&&J[m]!==null&&e.drawCircle(o+b.round((I[I.length-1]-this.minx)*(f/k)),n+b.round(g-g*((J[m]-this.miny)/l)),i,c,a.get("spotColor")).append(),this.maxy!==this.minyorg&&(i&&a.get("minSpotColor")&&(s=I[d.inArray(this.minyorg,J)],e.drawCircle(o+b.round((s-this.minx)*(f/k)),n+b.round(g-g*((this.minyorg-this.miny)/l)),i,c,a.get("minSpotColor")).append()),i&&a.get("maxSpotColor")&&(s=I[d.inArray(this.maxyorg,J)],e.drawCircle(o+b.round((s-this.minx)*(f/k)),n+b.round(g-g*((this.maxyorg-this.miny)/l)),i,c,a.get("maxSpotColor")).append())),this.lastShapeId=e.getLastShapeId(),this.canvasTop=n,e.render()}}),d.fn.sparkline.bar=y=g(d.fn.sparkline._base,w,{type:"bar",init:function(a,e,f,g,h){var j=parseInt(f.get("barWidth"),10),n=parseInt(f.get("barSpacing"),10),o=f.get("chartRangeMin"),p=f.get("chartRangeMax"),q=f.get("chartRangeClip"),r=Infinity,s=-Infinity,u,v,w,x,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R;y._super.init.call(this,a,e,f,g,h);for(A=0,B=e.length;A<B;A++){O=e[A],u=typeof O=="string"&&O.indexOf(":")>-1;if(u||d.isArray(O)){J=!0,u&&(O=e[A]=l(O.split(":"))),O=m(O,null),v=b.min.apply(b,O),w=b.max.apply(b,O),v<r&&(r=v),w>s&&(s=w)}}this.stacked=J,this.regionShapes={},this.barWidth=j,this.barSpacing=n,this.totalBarWidth=j+n,this.width=g=e.length*j+(e.length-1)*n,this.initTarget(),q&&(H=o===c?-Infinity:o,I=p===c?Infinity:p),z=[],x=J?[]:z;var S=[],T=[];for(A=0,B=e.length;A<B;A++){if(J){K=e[A],e[A]=N=[],S[A]=0,x[A]=T[A]=0;for(L=0,M=K.length;L<M;L++){O=N[L]=q?i(K[L],H,I):K[L],O!==null&&(O>0&&(S[A]+=O),r<0&&s>0?O<0?T[A]+=b.abs(O):x[A]+=O:x[A]+=b.abs(O-(O<0?s:r)),z.push(O))}}else{O=q?i(e[A],H,I):e[A],O=e[A]=k(O),O!==null&&z.push(O)}}this.max=G=b.max.apply(b,z),this.min=F=b.min.apply(b,z),this.stackMax=s=J?b.max.apply(b,S):G,this.stackMin=r=J?b.min.apply(b,z):F,f.get("chartRangeMin")!==c&&(f.get("chartRangeClip")||f.get("chartRangeMin")<F)&&(F=f.get("chartRangeMin")),f.get("chartRangeMax")!==c&&(f.get("chartRangeClip")||f.get("chartRangeMax")>G)&&(G=f.get("chartRangeMax")),this.zeroAxis=D=f.get("zeroAxis",!0),F<=0&&G>=0&&D?E=0:D==0?E=F:F>0?E=F:E=G,this.xaxisOffset=E,C=J?b.max.apply(b,x)+b.max.apply(b,T):G-F,this.canvasHeightEf=D&&F<0?this.canvasHeight-2:this.canvasHeight-1,F<E?(Q=J&&G>=0?s:G,P=(Q-E)/C*this.canvasHeight,P!==b.ceil(P)&&(this.canvasHeightEf-=2,P=b.ceil(P))):P=this.canvasHeight,this.yoffset=P,d.isArray(f.get("colorMap"))?(this.colorMapByIndex=f.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=f.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===c&&(this.colorMapByValue=new t(this.colorMapByValue))),this.range=C},getRegion:function(a,d,e){var f=b.floor(d/this.totalBarWidth);return f<0||f>=this.values.length?c:f},getCurrentRegionFields:function(){var a=this.currentRegion,b=r(this.values[a]),c=[],d,e;for(e=b.length;e--;){d=b[e],c.push({isNull:d===null,value:d,color:this.calcColor(e,d,a),offset:a})}return c},calcColor:function(a,b,e){var f=this.colorMapByIndex,g=this.colorMapByValue,h=this.options,i,j;return this.stacked?i=h.get("stackedBarColor"):i=b<0?h.get("negBarColor"):h.get("barColor"),b===0&&h.get("zeroColor")!==c&&(i=h.get("zeroColor")),g&&(j=g.get(b))?i=j:f&&f.length>e&&(i=f[e]),d.isArray(i)?i[a%i.length]:i},renderRegion:function(a,e){var f=this.values[a],g=this.options,h=this.xaxisOffset,i=[],j=this.range,k=this.stacked,l=this.target,m=a*this.totalBarWidth,n=this.canvasHeightEf,p=this.yoffset,q,r,s,t,u,v,w,x,y,z;f=d.isArray(f)?f:[f],w=f.length,x=f[0],t=o(null,f),z=o(h,f,!0);if(t){return g.get("nullColor")?(s=e?g.get("nullColor"):this.calcHighlightColor(g.get("nullColor"),g),q=p>0?p-1:p,l.drawRect(m,q,this.barWidth-1,0,s,s)):c}u=p;for(v=0;v<w;v++){x=f[v];if(k&&x===h){if(!z||y){continue}y=!0}j>0?r=b.floor(n*(b.abs(x-h)/j))+1:r=1,x<h||x===h&&p===0?(q=u,u+=r):(q=p-r,p-=r),s=this.calcColor(v,x,a),e&&(s=this.calcHighlightColor(s,g)),i.push(l.drawRect(m,q,this.barWidth-1,r-1,s,s))}return i.length===1?i[0]:i}}),d.fn.sparkline.tristate=z=g(d.fn.sparkline._base,w,{type:"tristate",init:function(a,b,e,f,g){var h=parseInt(e.get("barWidth"),10),i=parseInt(e.get("barSpacing"),10);z._super.init.call(this,a,b,e,f,g),this.regionShapes={},this.barWidth=h,this.barSpacing=i,this.totalBarWidth=h+i,this.values=d.map(b,Number),this.width=f=b.length*h+(b.length-1)*i,d.isArray(e.get("colorMap"))?(this.colorMapByIndex=e.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=e.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===c&&(this.colorMapByValue=new t(this.colorMapByValue))),this.initTarget()},getRegion:function(a,c,d){return b.floor(c/this.totalBarWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===c,value:this.values[a],color:this.calcColor(this.values[a],a),offset:a}},calcColor:function(a,b){var c=this.values,d=this.options,e=this.colorMapByIndex,f=this.colorMapByValue,g,h;return f&&(h=f.get(a))?g=h:e&&e.length>b?g=e[b]:c[b]<0?g=d.get("negBarColor"):c[b]>0?g=d.get("posBarColor"):g=d.get("zeroBarColor"),g},renderRegion:function(a,c){var d=this.values,e=this.options,f=this.target,g,h,i,j,k,l;g=f.pixelHeight,i=b.round(g/2),j=a*this.totalBarWidth,d[a]<0?(k=i,h=i-1):d[a]>0?(k=0,h=i-1):(k=i-1,h=2),l=this.calcColor(d[a],a);if(l===null){return}return c&&(l=this.calcHighlightColor(l,e)),f.drawRect(j,k,this.barWidth-1,h-1,l,l)}}),d.fn.sparkline.discrete=A=g(d.fn.sparkline._base,w,{type:"discrete",init:function(a,e,f,g,h){A._super.init.call(this,a,e,f,g,h),this.regionShapes={},this.values=e=d.map(e,Number),this.min=b.min.apply(b,e),this.max=b.max.apply(b,e),this.range=this.max-this.min,this.width=g=f.get("width")==="auto"?e.length*2:this.width,this.interval=b.floor(g/e.length),this.itemWidth=g/e.length,f.get("chartRangeMin")!==c&&(f.get("chartRangeClip")||f.get("chartRangeMin")<this.min)&&(this.min=f.get("chartRangeMin")),f.get("chartRangeMax")!==c&&(f.get("chartRangeClip")||f.get("chartRangeMax")>this.max)&&(this.max=f.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight=f.get("lineHeight")==="auto"?b.round(this.canvasHeight*0.3):f.get("lineHeight"))},getRegion:function(a,c,d){return b.floor(c/this.itemWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===c,value:this.values[a],offset:a}},renderRegion:function(a,c){var d=this.values,e=this.options,f=this.min,g=this.max,h=this.range,j=this.interval,k=this.target,l=this.canvasHeight,m=this.lineHeight,n=l-m,o,p,q,r;return p=i(d[a],f,g),r=a*j,o=b.round(n-n*((p-f)/h)),q=e.get("thresholdColor")&&p<e.get("thresholdValue")?e.get("thresholdColor"):e.get("lineColor"),c&&(q=this.calcHighlightColor(q,e)),k.drawLine(r,o,r,o+m,q)}}),d.fn.sparkline.bullet=B=g(d.fn.sparkline._base,{type:"bullet",init:function(a,d,e,f,g){var h,i,j;B._super.init.call(this,a,d,e,f,g),this.values=d=l(d),j=d.slice(),j[0]=j[0]===null?j[2]:j[0],j[1]=d[1]===null?j[2]:j[1],h=b.min.apply(b,d),i=b.max.apply(b,d),e.get("base")===c?h=h<0?h:0:h=e.get("base"),this.min=h,this.max=i,this.range=i-h,this.shapes={},this.valueShapes={},this.regiondata={},this.width=f=e.get("width")==="auto"?"4.0em":f,this.target=this.$el.simpledraw(f,g,e.get("composite")),d.length||(this.disabled=!0),this.initTarget()},getRegion:function(a,b,d){var e=this.target.getShapeAt(a,b,d);return e!==c&&this.shapes[e]!==c?this.shapes[e]:c},getCurrentRegionFields:function(){var a=this.currentRegion;return{fieldkey:a.substr(0,1),value:this.values[a.substr(1)],region:a}},changeHighlight:function(a){var b=this.currentRegion,c=this.valueShapes[b],d;delete this.shapes[c];switch(b.substr(0,1)){case"r":d=this.renderRange(b.substr(1),a);break;case"p":d=this.renderPerformance(a);break;case"t":d=this.renderTarget(a)}this.valueShapes[b]=d.id,this.shapes[d.id]=b,this.target.replaceWithShape(c,d)},renderRange:function(a,c){var d=this.values[a],e=b.round(this.canvasWidth*((d-this.min)/this.range)),f=this.options.get("rangeColors")[a-2];return c&&(f=this.calcHighlightColor(f,this.options)),this.target.drawRect(0,0,e-1,this.canvasHeight-1,f,f)},renderPerformance:function(a){var c=this.values[1],d=b.round(this.canvasWidth*((c-this.min)/this.range)),e=this.options.get("performanceColor");return a&&(e=this.calcHighlightColor(e,this.options)),this.target.drawRect(0,b.round(this.canvasHeight*0.3),d-1,b.round(this.canvasHeight*0.4)-1,e,e)},renderTarget:function(a){var c=this.values[0],d=b.round(this.canvasWidth*((c-this.min)/this.range)-this.options.get("targetWidth")/2),e=b.round(this.canvasHeight*0.1),f=this.canvasHeight-e*2,g=this.options.get("targetColor");return a&&(g=this.calcHighlightColor(g,this.options)),this.target.drawRect(d,e,this.options.get("targetWidth")-1,f-1,g,g)},render:function(){var a=this.values.length,b=this.target,c,d;if(!B._super.render.call(this)){return}for(c=2;c<a;c++){d=this.renderRange(c).append(),this.shapes[d.id]="r"+c,this.valueShapes["r"+c]=d.id}this.values[1]!==null&&(d=this.renderPerformance().append(),this.shapes[d.id]="p1",this.valueShapes.p1=d.id),this.values[0]!==null&&(d=this.renderTarget().append(),this.shapes[d.id]="t0",this.valueShapes.t0=d.id),b.render()}}),d.fn.sparkline.pie=C=g(d.fn.sparkline._base,{type:"pie",init:function(a,c,e,f,g){var h=0,i;C._super.init.call(this,a,c,e,f,g),this.shapes={},this.valueShapes={},this.values=c=d.map(c,Number),e.get("width")==="auto"&&(this.width=this.height);if(c.length>0){for(i=c.length;i--;){h+=c[i]}}this.total=h,this.initTarget(),this.radius=b.floor(b.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(a,b,d){var e=this.target.getShapeAt(a,b,d);return e!==c&&this.shapes[e]!==c?this.shapes[e]:c},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===c,value:this.values[a],percent:this.values[a]/this.total*100,color:this.options.get("sliceColors")[a%this.options.get("sliceColors").length],offset:a}},changeHighlight:function(a){var b=this.currentRegion,c=this.renderSlice(b,a),d=this.valueShapes[b];delete this.shapes[d],this.target.replaceWithShape(d,c),this.valueShapes[b]=c.id,this.shapes[c.id]=b},renderSlice:function(a,d){var e=this.target,f=this.options,g=this.radius,h=f.get("borderWidth"),i=f.get("offset"),j=2*b.PI,k=this.values,l=this.total,m=i?2*b.PI*(i/360):0,n,o,p,q,r;q=k.length;for(p=0;p<q;p++){n=m,o=m,l>0&&(o=m+j*(k[p]/l));if(a===p){return r=f.get("sliceColors")[p%f.get("sliceColors").length],d&&(r=this.calcHighlightColor(r,f)),e.drawPieSlice(g,g,g-h,n,o,c,r)}m=o}},render:function(){var a=this.target,d=this.values,e=this.options,f=this.radius,g=e.get("borderWidth"),h,i;if(!C._super.render.call(this)){return}g&&a.drawCircle(f,f,b.floor(f-g/2),e.get("borderColor"),c,g).append();for(i=d.length;i--;){d[i]&&(h=this.renderSlice(i).append(),this.valueShapes[i]=h.id,this.shapes[h.id]=i)}a.render()}}),d.fn.sparkline.box=D=g(d.fn.sparkline._base,{type:"box",init:function(a,b,c,e,f){D._super.init.call(this,a,b,c,e,f),this.values=d.map(b,Number),this.width=c.get("width")==="auto"?"4.0em":e,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var a=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==c&&a.push({field:"lo",value:this.loutlier}),this.routlier!==c&&a.push({field:"ro",value:this.routlier}),this.lwhisker!==c&&a.push({field:"lw",value:this.lwhisker}),this.rwhisker!==c&&a.push({field:"rw",value:this.rwhisker}),a},render:function(){var a=this.target,d=this.values,e=d.length,f=this.options,g=this.canvasWidth,h=this.canvasHeight,i=f.get("chartRangeMin")===c?b.min.apply(b,d):f.get("chartRangeMin"),k=f.get("chartRangeMax")===c?b.max.apply(b,d):f.get("chartRangeMax"),l=0,m,n,o,p,q,r,s,t,u,v,w;if(!D._super.render.call(this)){return}if(f.get("raw")){f.get("showOutliers")&&d.length>5?(n=d[0],m=d[1],p=d[2],q=d[3],r=d[4],s=d[5],t=d[6]):(m=d[0],p=d[1],q=d[2],r=d[3],s=d[4])}else{d.sort(function(a,b){return a-b}),p=j(d,1),q=j(d,2),r=j(d,3),o=r-p;if(f.get("showOutliers")){m=s=c;for(u=0;u<e;u++){m===c&&d[u]>p-o*f.get("outlierIQR")&&(m=d[u]),d[u]<r+o*f.get("outlierIQR")&&(s=d[u])}n=d[0],t=d[e-1]}else{m=d[0],s=d[e-1]}}this.quartiles=[p,q,r],this.lwhisker=m,this.rwhisker=s,this.loutlier=n,this.routlier=t,w=g/(k-i+1),f.get("showOutliers")&&(l=b.ceil(f.get("spotRadius")),g-=2*b.ceil(f.get("spotRadius")),w=g/(k-i+1),n<m&&a.drawCircle((n-i)*w+l,h/2,f.get("spotRadius"),f.get("outlierLineColor"),f.get("outlierFillColor")).append(),t>s&&a.drawCircle((t-i)*w+l,h/2,f.get("spotRadius"),f.get("outlierLineColor"),f.get("outlierFillColor")).append()),a.drawRect(b.round((p-i)*w+l),b.round(h*0.1),b.round((r-p)*w),b.round(h*0.8),f.get("boxLineColor"),f.get("boxFillColor")).append(),a.drawLine(b.round((m-i)*w+l),b.round(h/2),b.round((p-i)*w+l),b.round(h/2),f.get("lineColor")).append(),a.drawLine(b.round((m-i)*w+l),b.round(h/4),b.round((m-i)*w+l),b.round(h-h/4),f.get("whiskerColor")).append(),a.drawLine(b.round((s-i)*w+l),b.round(h/2),b.round((r-i)*w+l),b.round(h/2),f.get("lineColor")).append(),a.drawLine(b.round((s-i)*w+l),b.round(h/4),b.round((s-i)*w+l),b.round(h-h/4),f.get("whiskerColor")).append(),a.drawLine(b.round((q-i)*w+l),b.round(h*0.1),b.round((q-i)*w+l),b.round(h*0.9),f.get("medianColor")).append(),f.get("target")&&(v=b.ceil(f.get("spotRadius")),a.drawLine(b.round((f.get("target")-i)*w+l),b.round(h/2-v),b.round((f.get("target")-i)*w+l),b.round(h/2+v),f.get("targetColor")).append(),a.drawLine(b.round((f.get("target")-i)*w+l-v),b.round(h/2),b.round((f.get("target")-i)*w+l+v),b.round(h/2),f.get("targetColor")).append()),a.render()}}),G=g({init:function(a,b,c,d){this.target=a,this.id=b,this.type=c,this.args=d},append:function(){return this.target.appendShape(this),this}}),H=g({_pxregex:/(\d+)(px)?\s*$/i,init:function(a,b,c){if(!a){return}this.width=a,this.height=b,this.target=c,this.lastShapeId=null,c[0]&&(c=c[0]),d.data(c,"_jqs_vcanvas",this)},drawLine:function(a,b,c,d,e,f){return this.drawShape([[a,b],[c,d]],e,f)},drawShape:function(a,b,c,d){return this._genShape("Shape",[a,b,c,d])},drawCircle:function(a,b,c,d,e,f){return this._genShape("Circle",[a,b,c,d,e,f])},drawPieSlice:function(a,b,c,d,e,f,g){return this._genShape("PieSlice",[a,b,c,d,e,f,g])},drawRect:function(a,b,c,d,e,f){return this._genShape("Rect",[a,b,c,d,e,f])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(a,b){d(b).html(a)},_calculatePixelDims:function(a,b,c){var e;e=this._pxregex.exec(b),e?this.pixelHeight=e[1]:this.pixelHeight=d(c).height(),e=this._pxregex.exec(a),e?this.pixelWidth=e[1]:this.pixelWidth=d(c).width()},_genShape:function(a,b){var c=L++;return b.unshift(c),new G(this,c,a,b)},appendShape:function(a){alert("appendShape not implemented")},replaceWithShape:function(a,b){alert("replaceWithShape not implemented")},insertAfterShape:function(a,b){alert("insertAfterShape not implemented")},removeShapeId:function(a){alert("removeShapeId not implemented")},getShapeAt:function(a,b,c){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),I=g(H,{init:function(b,e,f,g){I._super.init.call(this,b,e,f),this.canvas=a.createElement("canvas"),f[0]&&(f=f[0]),d.data(f,"_jqs_vcanvas",this),d(this.canvas).css({display:"inline-block",width:b,height:e,verticalAlign:"top"}),this._insert(this.canvas,f),this._calculatePixelDims(b,e,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=g,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=c,d(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(a,b,d){var e=this.canvas.getContext("2d");return a!==c&&(e.strokeStyle=a),e.lineWidth=d===c?1:d,b!==c&&(e.fillStyle=b),e},reset:function(){var a=this._getContext();a.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=c},_drawShape:function(a,b,d,e,f){var g=this._getContext(d,e,f),h,i;g.beginPath(),g.moveTo(b[0][0]+0.5,b[0][1]+0.5);for(h=1,i=b.length;h<i;h++){g.lineTo(b[h][0]+0.5,b[h][1]+0.5)}d!==c&&g.stroke(),e!==c&&g.fill(),this.targetX!==c&&this.targetY!==c&&g.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawCircle:function(a,d,e,f,g,h,i){var j=this._getContext(g,h,i);j.beginPath(),j.arc(d,e,f,0,2*b.PI,!1),this.targetX!==c&&this.targetY!==c&&j.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a),g!==c&&j.stroke(),h!==c&&j.fill()},_drawPieSlice:function(a,b,d,e,f,g,h,i){var j=this._getContext(h,i);j.beginPath(),j.moveTo(b,d),j.arc(b,d,e,f,g,!1),j.lineTo(b,d),j.closePath(),h!==c&&j.stroke(),i&&j.fill(),this.targetX!==c&&this.targetY!==c&&j.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawRect:function(a,b,c,d,e,f,g){return this._drawShape(a,[[b,c],[b+d,c],[b+d,c+e],[b,c+e],[b,c]],f,g)},appendShape:function(a){return this.shapes[a.id]=a,this.shapeseq.push(a.id),this.lastShapeId=a.id,a.id},replaceWithShape:function(a,b){var c=this.shapeseq,d;this.shapes[b.id]=b;for(d=c.length;d--;){c[d]==a&&(c[d]=b.id)}delete this.shapes[a]},replaceWithShapes:function(a,b){var c=this.shapeseq,d={},e,f,g;for(f=a.length;f--;){d[a[f]]=!0}for(f=c.length;f--;){e=c[f],d[e]&&(c.splice(f,1),delete this.shapes[e],g=f)}for(f=b.length;f--;){c.splice(g,0,b[f].id),this.shapes[b[f].id]=b[f]}},insertAfterShape:function(a,b){var c=this.shapeseq,d;for(d=c.length;d--;){if(c[d]===a){c.splice(d+1,0,b.id),this.shapes[b.id]=b;return}}},removeShapeId:function(a){var b=this.shapeseq,c;for(c=b.length;c--;){if(b[c]===a){b.splice(c,1);break}}delete this.shapes[a]},getShapeAt:function(a,b,c){return this.targetX=b,this.targetY=c,this.render(),this.currentTargetShapeId},render:function(){var a=this.shapeseq,b=this.shapes,c=a.length,d=this._getContext(),e,f,g;d.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(g=0;g<c;g++){e=a[g],f=b[e],this["_draw"+f.type].apply(this,f.args)}this.interact||(this.shapes={},this.shapeseq=[])}}),J=g(H,{init:function(b,c,e){var f;J._super.init.call(this,b,c,e),e[0]&&(e=e[0]),d.data(e,"_jqs_vcanvas",this),this.canvas=a.createElement("span"),d(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:b,height:c,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,e),this._calculatePixelDims(b,c,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,f='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",f),this.group=d(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(a,b,d,e,f){var g=[],h,i,j,k,l,m,n;for(n=0,m=b.length;n<m;n++){g[n]=""+b[n][0]+","+b[n][1]}return h=g.splice(0,1),f=f===c?1:f,i=d===c?' stroked="false" ':' strokeWeight="'+f+'px" strokeColor="'+d+'" ',j=e===c?' filled="false"':' fillColor="'+e+'" filled="true" ',k=g[0]===g[g.length-1]?"x ":"",l='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+a+'" '+i+j+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+h+" l "+g.join(", ")+" "+k+'e"> </v:shape>',l},_drawCircle:function(a,b,d,e,f,g,h){var i,j,k;return b-=e,d-=e,i=f===c?' stroked="false" ':' strokeWeight="'+h+'px" strokeColor="'+f+'" ',j=g===c?' filled="false"':' fillColor="'+g+'" filled="true" ',k='<v:oval  id="jqsshape'+a+'" '+i+j+' style="position:absolute;top:'+d+"px; left:"+b+"px; width:"+e*2+"px; height:"+e*2+'px"></v:oval>',k},_drawPieSlice:function(a,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r;if(g===h){return""}h-g===2*b.PI&&(g=0,h=2*b.PI),l=d+b.round(b.cos(g)*f),m=e+b.round(b.sin(g)*f),n=d+b.round(b.cos(h)*f),o=e+b.round(b.sin(h)*f);if(l===n&&m===o){if(h-g<b.PI){return""}l=n=d+f,m=o=e}return l===n&&m===o&&h-g<b.PI?"":(k=[d-f,e-f,d+f,e+f,l,m,n,o],p=i===c?' stroked="false" ':' strokeWeight="1px" strokeColor="'+i+'" ',q=j===c?' filled="false"':' fillColor="'+j+'" filled="true" ',r='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+a+'" '+p+q+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+d+","+e+" wa "+k.join(", ")+' x e"> </v:shape>',r)},_drawRect:function(a,b,c,d,e,f,g){return this._drawShape(a,[[b,c],[b,c+e],[b+d,c+e],[b+d,c],[b,c]],f,g)},reset:function(){this.group.innerHTML=""},appendShape:function(a){var b=this["_draw"+a.type].apply(this,a.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",b):this.prerender+=b,this.lastShapeId=a.id,a.id},replaceWithShape:function(a,b){var c=d("#jqsshape"+a),e=this["_draw"+b.type].apply(this,b.args);c[0].outerHTML=e},replaceWithShapes:function(a,b){var c=d("#jqsshape"+a[0]),e="",f=b.length,g;for(g=0;g<f;g++){e+=this["_draw"+b[g].type].apply(this,b[g].args)}c[0].outerHTML=e;for(g=1;g<a.length;g++){d("#jqsshape"+a[g]).remove()}},insertAfterShape:function(a,b){var c=d("#jqsshape"+a),e=this["_draw"+b.type].apply(this,b.args);c[0].insertAdjacentHTML("afterEnd",e)},removeShapeId:function(a){var b=d("#jqsshape"+a);this.group.removeChild(b[0])},getShapeAt:function(a,b,c){var d=a.id.substr(8);return d},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})})})(document,Math);function MarkerManager(e,t){var n=this;n.map_=e;n.mapZoom_=e.getZoom();n.projectionHelper_=new ProjectionHelperOverlay(e);google.maps.event.addListener(n.projectionHelper_,"ready",function(){n.projection_=this.getProjection();n.initialize(e,t)})}function GridBounds(e){this.minX=Math.min(e[0].x,e[1].x);this.maxX=Math.max(e[0].x,e[1].x);this.minY=Math.min(e[0].y,e[1].y);this.maxY=Math.max(e[0].y,e[1].y)}function ProjectionHelperOverlay(e){this.setMap(e);var t=8;var n=1<<t;var r=7;this._map=e;this._zoom=-1;this._X0=this._Y0=this._X1=this._Y1=-1}MarkerManager.prototype.initialize=function(e,t){var n=this;t=t||{};n.tileSize_=MarkerManager.DEFAULT_TILE_SIZE_;var r=e.mapTypes;var i=1;for(var s in r){if(r.hasOwnProperty(s)&&r.get(s)&&r.get(s).maxZoom==="number"){var o=e.mapTypes.get(s).maxZoom;if(o>i){i=o}}}n.maxZoom_=t.maxZoom||19;n.trackMarkers_=t.trackMarkers;n.show_=t.show||true;var u;if(typeof t.borderPadding==="number"){u=t.borderPadding}else{u=MarkerManager.DEFAULT_BORDER_PADDING_}n.swPadding_=new google.maps.Size(-u,u);n.nePadding_=new google.maps.Size(u,-u);n.borderPadding_=u;n.gridWidth_={};n.grid_={};n.grid_[n.maxZoom_]={};n.numMarkers_={};n.numMarkers_[n.maxZoom_]=0;google.maps.event.addListener(e,"dragend",function(){n.onMapMoveEnd_()});google.maps.event.addListener(e,"idle",function(){n.onMapMoveEnd_()});google.maps.event.addListener(e,"zoom_changed",function(){n.onMapMoveEnd_()});n.removeOverlay_=function(e){e.setMap(null);n.shownMarkers_--};n.addOverlay_=function(e){if(n.show_){e.setMap(n.map_);n.shownMarkers_++}};n.resetManager_();n.shownMarkers_=0;n.shownBounds_=n.getMapGridBounds_();google.maps.event.trigger(n,"loaded")};MarkerManager.DEFAULT_TILE_SIZE_=1024;MarkerManager.DEFAULT_BORDER_PADDING_=100;MarkerManager.MERCATOR_ZOOM_LEVEL_ZERO_RANGE=256;MarkerManager.prototype.resetManager_=function(){var e=MarkerManager.MERCATOR_ZOOM_LEVEL_ZERO_RANGE;for(var t=0;t<=this.maxZoom_;++t){this.grid_[t]={};this.numMarkers_[t]=0;this.gridWidth_[t]=Math.ceil(e/this.tileSize_);e<<=1}};MarkerManager.prototype.clearMarkers=function(){this.processAll_(this.shownBounds_,this.removeOverlay_);this.resetManager_()};MarkerManager.prototype.getTilePoint_=function(e,t,n){var r=this.projectionHelper_.LatLngToPixel(e,t);var i=new google.maps.Point(Math.floor((r.x+n.width)/this.tileSize_),Math.floor((r.y+n.height)/this.tileSize_));return i};MarkerManager.prototype.addMarkerBatch_=function(e,t,n){var r=this;var i=e.getPosition();e.MarkerManager_minZoom=t;if(this.trackMarkers_){google.maps.event.addListener(e,"changed",function(e,t,n){r.onMarkerMoved_(e,t,n)})}var s=this.getTilePoint_(i,n,new google.maps.Size(0,0,0,0));for(var o=n;o>=t;o--){var u=this.getGridCellCreate_(s.x,s.y,o);u.push(e);s.x=s.x>>1;s.y=s.y>>1}};MarkerManager.prototype.isGridPointVisible_=function(e){var t=this.shownBounds_.minY<=e.y&&e.y<=this.shownBounds_.maxY;var n=this.shownBounds_.minX;var r=n<=e.x&&e.x<=this.shownBounds_.maxX;if(!r&&n<0){var i=this.gridWidth_[this.shownBounds_.z];r=n+i<=e.x&&e.x<=i-1}return t&&r};MarkerManager.prototype.onMarkerMoved_=function(e,t,n){var r=this.maxZoom_;var i=false;var s=this.getTilePoint_(t,r,new google.maps.Size(0,0,0,0));var o=this.getTilePoint_(n,r,new google.maps.Size(0,0,0,0));while(r>=0&&(s.x!==o.x||s.y!==o.y)){var u=this.getGridCellNoCreate_(s.x,s.y,r);if(u){if(this.removeFromArray_(u,e)){this.getGridCellCreate_(o.x,o.y,r).push(e)}}if(r===this.mapZoom_){if(this.isGridPointVisible_(s)){if(!this.isGridPointVisible_(o)){this.removeOverlay_(e);i=true}}else{if(this.isGridPointVisible_(o)){this.addOverlay_(e);i=true}}}s.x=s.x>>1;s.y=s.y>>1;o.x=o.x>>1;o.y=o.y>>1;--r}if(i){this.notifyListeners_()}};MarkerManager.prototype.removeMarker=function(e){var t=this.maxZoom_;var n=false;var r=e.getPosition();var i=this.getTilePoint_(r,t,new google.maps.Size(0,0,0,0));while(t>=0){var s=this.getGridCellNoCreate_(i.x,i.y,t);if(s){this.removeFromArray_(s,e)}if(t===this.mapZoom_){if(this.isGridPointVisible_(i)){this.removeOverlay_(e);n=true}}i.x=i.x>>1;i.y=i.y>>1;--t}if(n){this.notifyListeners_()}this.numMarkers_[e.MarkerManager_minZoom]--};MarkerManager.prototype.addMarkers=function(e,t,n){var r=this.getOptMaxZoom_(n);for(var i=e.length-1;i>=0;i--){this.addMarkerBatch_(e[i],t,r)}this.numMarkers_[t]+=e.length};MarkerManager.prototype.getOptMaxZoom_=function(e){return e||this.maxZoom_};MarkerManager.prototype.getMarkerCount=function(e){var t=0;for(var n=0;n<=e;n++){t+=this.numMarkers_[n]}return t};MarkerManager.prototype.getMarker=function(e,t,n){var r=new google.maps.LatLng(e,t);var i=this.getTilePoint_(r,n,new google.maps.Size(0,0,0,0));var s=new google.maps.Marker({position:r});var o=this.getGridCellNoCreate_(i.x,i.y,n);if(o!==undefined){for(var u=0;u<o.length;u++){if(e===o[u].getPosition().lat()&&t===o[u].getPosition().lng()){s=o[u]}}}return s};MarkerManager.prototype.addMarker=function(e,t,n){var r=this.getOptMaxZoom_(n);this.addMarkerBatch_(e,t,r);var i=this.getTilePoint_(e.getPosition(),this.mapZoom_,new google.maps.Size(0,0,0,0));if(this.isGridPointVisible_(i)&&t<=this.shownBounds_.z&&this.shownBounds_.z<=r){this.addOverlay_(e);this.notifyListeners_()}this.numMarkers_[t]++};GridBounds.prototype.equals=function(e){if(this.maxX===e.maxX&&this.maxY===e.maxY&&this.minX===e.minX&&this.minY===e.minY){return true}else{return false}};GridBounds.prototype.containsPoint=function(e){var t=this;return t.minX<=e.x&&t.maxX>=e.x&&t.minY<=e.y&&t.maxY>=e.y};MarkerManager.prototype.getGridCellCreate_=function(e,t,n){var r=this.grid_[n];if(e<0){e+=this.gridWidth_[n]}var i=r[e];if(!i){i=r[e]=[];return i[t]=[]}var s=i[t];if(!s){return i[t]=[]}return s};MarkerManager.prototype.getGridCellNoCreate_=function(e,t,n){var r=this.grid_[n];if(e<0){e+=this.gridWidth_[n]}var i=r[e];return i?i[t]:undefined};MarkerManager.prototype.getGridBounds_=function(e,t,n,r){t=Math.min(t,this.maxZoom_);var i=e.getSouthWest();var s=e.getNorthEast();var o=this.getTilePoint_(i,t,n);var u=this.getTilePoint_(s,t,r);var a=this.gridWidth_[t];if(s.lng()<i.lng()||u.x<o.x){o.x-=a}if(u.x-o.x+1>=a){o.x=0;u.x=a-1}var f=new GridBounds([o,u]);f.z=t;return f};MarkerManager.prototype.getMapGridBounds_=function(){return this.getGridBounds_(this.map_.getBounds(),this.mapZoom_,this.swPadding_,this.nePadding_)};MarkerManager.prototype.onMapMoveEnd_=function(){this.objectSetTimeout_(this,this.updateMarkers_,0)};MarkerManager.prototype.objectSetTimeout_=function(e,t,n){return window.setTimeout(function(){t.call(e)},n)};MarkerManager.prototype.visible=function(){return this.show_?true:false};MarkerManager.prototype.isHidden=function(){return !this.show_};MarkerManager.prototype.show=function(){this.show_=true;this.refresh()};MarkerManager.prototype.hide=function(){this.show_=false;this.refresh()};MarkerManager.prototype.toggle=function(){this.show_=!this.show_;this.refresh()};MarkerManager.prototype.refresh=function(){if(this.shownMarkers_>0){this.processAll_(this.shownBounds_,this.removeOverlay_)}if(this.show_){this.processAll_(this.shownBounds_,this.addOverlay_)}this.notifyListeners_()};MarkerManager.prototype.updateMarkers_=function(){this.mapZoom_=this.map_.getZoom();var e=this.getMapGridBounds_();if(e.equals(this.shownBounds_)&&e.z===this.shownBounds_.z){return}if(e.z!==this.shownBounds_.z){this.processAll_(this.shownBounds_,this.removeOverlay_);if(this.show_){this.processAll_(e,this.addOverlay_)}}else{this.rectangleDiff_(this.shownBounds_,e,this.removeCellMarkers_);if(this.show_){this.rectangleDiff_(e,this.shownBounds_,this.addCellMarkers_)}}this.shownBounds_=e;this.notifyListeners_()};MarkerManager.prototype.notifyListeners_=function(){google.maps.event.trigger(this,"changed",this.shownBounds_,this.shownMarkers_)};MarkerManager.prototype.processAll_=function(e,t){for(var n=e.minX;n<=e.maxX;n++){for(var r=e.minY;r<=e.maxY;r++){this.processCellMarkers_(n,r,e.z,t)}}};MarkerManager.prototype.processCellMarkers_=function(e,t,n,r){var i=this.getGridCellNoCreate_(e,t,n);if(i){for(var s=i.length-1;s>=0;s--){r(i[s])}}};MarkerManager.prototype.removeCellMarkers_=function(e,t,n){this.processCellMarkers_(e,t,n,this.removeOverlay_)};MarkerManager.prototype.addCellMarkers_=function(e,t,n){this.processCellMarkers_(e,t,n,this.addOverlay_)};MarkerManager.prototype.rectangleDiff_=function(e,t,n){var r=this;r.rectangleDiffCoords_(e,t,function(t,i){n.apply(r,[t,i,e.z])})};MarkerManager.prototype.rectangleDiffCoords_=function(e,t,n){var r=e.minX;var i=e.minY;var s=e.maxX;var o=e.maxY;var u=t.minX;var a=t.minY;var f=t.maxX;var l=t.maxY;var c,h;for(c=r;c<=s;c++){for(h=i;h<=o&&h<a;h++){n(c,h)}for(h=Math.max(l+1,i);h<=o;h++){n(c,h)}}for(h=Math.max(i,a);h<=Math.min(o,l);h++){for(c=Math.min(s+1,u)-1;c>=r;c--){n(c,h)}for(c=Math.max(r,f+1);c<=s;c++){n(c,h)}}};MarkerManager.prototype.removeFromArray_=function(e,t,n){var r=0;for(var i=0;i<e.length;++i){if(e[i]===t||n&&e[i]===t){e.splice(i--,1);r++}}return r};ProjectionHelperOverlay.prototype=new google.maps.OverlayView;ProjectionHelperOverlay.prototype.LngToX_=function(e){return 1+e/180};ProjectionHelperOverlay.prototype.LatToY_=function(e){var t=Math.sin(e*Math.PI/180);return 1-0.5/Math.PI*Math.log((1+t)/(1-t))};ProjectionHelperOverlay.prototype.LatLngToPixel=function(e,t){var n=this._map;var r=this.getProjection().fromLatLngToDivPixel(e);var i={x:~~(0.5+this.LngToX_(e.lng())*(2<<t+6)),y:~~(0.5+this.LatToY_(e.lat())*(2<<t+6))};return i};ProjectionHelperOverlay.prototype.draw=function(){if(!this.ready){this.ready=true;google.maps.event.trigger(this,"ready")}};
/*!
  Tinycon - A small library for manipulating the Favicon
  Tom Moor, http://tommoor.com
  Copyright (c) 2012 Tom Moor
  MIT Licensed
  @version 0.6
*/
(function(){var e={};var t=null;var n=null;var r=document.title;var i=null;var s=null;var o={};var u=window.devicePixelRatio||1;var a=16*u;var f={width:7,height:9,font:10*u+"px arial",colour:"#ffffff",background:"#F03D25",fallback:true,abbreviate:true};var l=function(){var e=navigator.userAgent.toLowerCase();return function(t){return e.indexOf(t)!==-1}}();var c={ie:l("msie"),chrome:l("chrome"),webkit:l("chrome")||l("safari"),safari:l("safari")&&!l("chrome"),mozilla:l("mozilla")&&!l("chrome")&&!l("safari")};var h=function(){var e=document.getElementsByTagName("link");for(var t=0,n=e.length;t<n;t++){if((e[t].getAttribute("rel")||"").match(/\bicon\b/)){return e[t]}}return false};var p=function(){var e=document.getElementsByTagName("link");var t=document.getElementsByTagName("head")[0];for(var n=0,r=e.length;n<r;n++){var i=typeof e[n]!=="undefined";if(i&&(e[n].getAttribute("rel")||"").match(/\bicon\b/)){t.removeChild(e[n])}}};var d=function(){if(!n||!t){var e=h();n=t=e?e.getAttribute("href"):"/favicon.ico"}return t};var v=function(){if(!s){s=document.createElement("canvas");s.width=a;s.height=a}return s};var m=function(e){p();var t=document.createElement("link");t.type="image/x-icon";t.rel="icon";t.href=e;document.getElementsByTagName("head")[0].appendChild(t)};var g=function(e){if(window.console){window.console.log(e)}};var y=function(e,t){if(!v().getContext||c.ie||c.safari||o.fallback==="force"){return b(e)}var n=v().getContext("2d");var t=t||"#000000";var r=d();i=document.createElement("img");i.onload=function(){n.clearRect(0,0,a,a);n.drawImage(i,0,0,16,16,0,0,a,a);if(!c.mozilla){n.drawImage(i,0,0,32,32,0,0,a,a)}if((e+"").length>0){w(n,e,t)}E()};if(!r.match(/^data/)){i.crossOrigin="anonymous"}i.src=r};var b=function(e){if(o.fallback){if((e+"").length>0){document.title="("+e+") "+r}else{document.title=r}}};var w=function(e,t,n){if(typeof t=="number"&&t>99&&o.abbreviate){t=S(t)}var r=(t+"").length-1;var i=o.width*u+6*u*r,s=o.height*u;var f=a-s,l=a-i-u,h=16*u,p=16*u,d=2*u;e.font=(c.webkit?"bold ":"")+o.font;e.fillStyle=o.background;e.strokeStyle=o.background;e.lineWidth=u;e.beginPath();e.moveTo(l+d,f);e.quadraticCurveTo(l,f,l,f+d);e.lineTo(l,h-d);e.quadraticCurveTo(l,h,l+d,h);e.lineTo(p-d,h);e.quadraticCurveTo(p,h,p,h-d);e.lineTo(p,f+d);e.quadraticCurveTo(p,f,p-d,f);e.closePath();e.fill();e.beginPath();e.strokeStyle="rgba(0,0,0,0.3)";e.moveTo(l+d/2,h);e.lineTo(p-d/2,h);e.stroke();e.fillStyle=o.colour;e.textAlign="right";e.textBaseline="top";e.fillText(t,u===2?29:15,c.mozilla?7*u:6*u)};var E=function(){if(!v().getContext){return}m(v().toDataURL())};var S=function(e){var t=[["G",1000000000],["M",1000000],["k",1000]];for(var n=0;n<t.length;++n){if(e>=t[n][1]){e=x(e/t[n][1])+t[n][0];break}}return e};var x=function(e,t){var n=new Number(e);return n.toFixed(t)};e.setOptions=function(e){o={};for(var t in f){o[t]=e.hasOwnProperty(t)?e[t]:f[t]}return this};e.setImage=function(e){t=e;E();return this};e.setBubble=function(e,t){e=e||"";y(e,t);return this};e.reset=function(){m(n)};e.setOptions(f);window.Tinycon=e})();topojson=function(){function e(e,n){function t(n){var t=e.arcs[n],r=t[0],o=[0,0];return t.forEach(function(e){o[0]+=e[0],o[1]+=e[1]}),[r,o]}var r={},o={};n.forEach(function(e){var n,a,i=t(e),u=i[0],c=i[1];if(n=o[u]){if(delete o[n.end],n.push(e),n.end=c,a=r[c]){delete r[a.start];var s=a===n?n:n.concat(a);r[s.start=n.start]=o[s.end=a.end]=s}else{if(a=o[c]){delete r[a.start],delete o[a.end];var s=n.concat(a.map(function(e){return ~e}).reverse());r[s.start=n.start]=o[s.end=a.start]=s}else{r[n.start]=o[n.end]=n}}}else{if(n=r[c]){if(delete r[n.start],n.unshift(e),n.start=u,a=o[u]){delete o[a.end];var f=a===n?n:a.concat(n);r[f.start=a.start]=o[f.end=n.end]=f}else{if(a=r[u]){delete r[a.start],delete o[a.end];var f=a.map(function(e){return ~e}).reverse().concat(n);r[f.start=a.end]=o[f.end=n.end]=f}else{r[n.start]=o[n.end]=n}}}else{if(n=r[u]){if(delete r[n.start],n.unshift(~e),n.start=c,a=o[c]){delete o[a.end];var f=a===n?n:a.concat(n);r[f.start=a.start]=o[f.end=n.end]=f}else{if(a=r[c]){delete r[a.start],delete o[a.end];var f=a.map(function(e){return ~e}).reverse().concat(n);r[f.start=a.end]=o[f.end=n.end]=f}else{r[n.start]=o[n.end]=n}}}else{if(n=o[c]){if(delete o[n.end],n.push(~e),n.end=u,a=o[u]){delete r[a.start];var s=a===n?n:n.concat(a);r[s.start=n.start]=o[s.end=a.end]=s}else{if(a=r[u]){delete r[a.start],delete o[a.end];var s=n.concat(a.map(function(e){return ~e}).reverse());r[s.start=n.start]=o[s.end=a.start]=s}else{r[n.start]=o[n.end]=n}}}else{n=[e],r[n.start=u]=o[n.end=c]=n}}}}});var a=[];for(var i in o){a.push(o[i])}return a}function n(n,t,r){function a(e){0>e&&(e=~e),(l[e]||(l[e]=[])).push(f)}function i(e){e.forEach(a)}function u(e){e.forEach(i)}function c(e){"GeometryCollection"===e.type?e.geometries.forEach(c):e.type in d&&(f=e,d[e.type](e.arcs))}var s=[];if(arguments.length>1){var f,l=[],d={LineString:i,MultiLineString:u,Polygon:u,MultiPolygon:function(e){e.forEach(u)}};c(t),l.forEach(arguments.length<3?function(e,n){s.push(n)}:function(e,n){r(e[0],e[e.length-1])&&s.push(n)})}else{for(var p=0,v=n.arcs.length;v>p;++p){s.push(p)}}return o(n,{type:"MultiLineString",arcs:e(n,s)})}function t(e,n){return"GeometryCollection"===n.type?{type:"FeatureCollection",features:n.geometries.map(function(n){return r(e,n)})}:r(e,n)}function r(e,n){var t={type:"Feature",id:n.id,properties:n.properties||{},geometry:o(e,n)};return null==n.id&&delete t.id,t}function o(e,n){function t(e,n){n.length&&n.pop();for(var t,r=f[0>e?~e:e],o=0,i=r.length;i>o;++o){n.push(t=r[o].slice()),s(t,o)}0>e&&a(n,i)}function r(e){return e=e.slice(),s(e,0),e}function o(e){for(var n=[],r=0,o=e.length;o>r;++r){t(e[r],n)}return n.length<2&&n.push(n[0].slice()),n}function i(e){for(var n=o(e);n.length<4;){n.push(n[0].slice())}return n}function u(e){return e.map(i)}function c(e){var n=e.type;return"GeometryCollection"===n?{type:n,geometries:e.geometries.map(c)}:n in l?{type:n,coordinates:l[n](e)}:null}var s=d(e.transform),f=e.arcs,l={Point:function(e){return r(e.coordinates)},MultiPoint:function(e){return e.coordinates.map(r)},LineString:function(e){return o(e.arcs)},MultiLineString:function(e){return e.arcs.map(o)},Polygon:function(e){return u(e.arcs)},MultiPolygon:function(e){return e.arcs.map(u)}};return c(n)}function a(e,n){for(var t,r=e.length,o=r-n;o<--r;){t=e[o],e[o++]=e[r],e[r]=t}}function i(e,n){for(var t=0,r=e.length;r>t;){var o=t+r>>>1;e[o]<n?t=o+1:r=o}return t}function u(e){function n(e,n){e.forEach(function(e){0>e&&(e=~e);var t=o[e];t?t.push(n):o[e]=[n]})}function t(e,t){e.forEach(function(e){n(e,t)})}function r(e,n){"GeometryCollection"===e.type?e.geometries.forEach(function(e){r(e,n)}):e.type in u&&u[e.type](e.arcs,n)}var o={},a=e.map(function(){return[]}),u={LineString:n,MultiLineString:t,Polygon:t,MultiPolygon:function(e,n){e.forEach(function(e){t(e,n)})}};e.forEach(r);for(var c in o){for(var s=o[c],f=s.length,l=0;f>l;++l){for(var d=l+1;f>d;++d){var p,v=s[l],h=s[d];(p=a[v])[c=i(p,h)]!==h&&p.splice(c,0,h),(p=a[h])[c=i(p,v)]!==v&&p.splice(c,0,v)}}}return a}function c(e,n){function t(e){i.remove(e),e[1][2]=n(e),i.push(e)}var r,o=d(e.transform),a=p(e.transform),i=l(f),u=0;for(n||(n=s),e.arcs.forEach(function(e){var t=[];e.forEach(o);for(var a=1,u=e.length-1;u>a;++a){r=e.slice(a-1,a+2),r[1][2]=n(r),t.push(r),i.push(r)}e[0][2]=e[u][2]=1/0;for(var a=0,u=t.length;u>a;++a){r=t[a],r.previous=t[a-1],r.next=t[a+1]}});r=i.pop();){var c=r.previous,v=r.next;r[1][2]<u?r[1][2]=u:u=r[1][2],c&&(c.next=v,c[2]=r[2],t(c)),v&&(v.previous=c,v[0]=r[0],t(v))}return e.arcs.forEach(function(e){e.forEach(a)}),e}function s(e){return Math.abs((e[0][0]-e[2][0])*(e[1][1]-e[0][1])-(e[0][0]-e[1][0])*(e[2][1]-e[0][1]))}function f(e,n){return e[1][2]-n[1][2]}function l(e){function n(n){for(var t=o[n];n>0;){var r=(n+1>>1)-1,a=o[r];if(e(t,a)>=0){break}o[a.index=n]=a,o[t.index=n=r]=t}}function t(n){for(var t=o[n];;){var r=n+1<<1,a=r-1,i=n,u=o[i];if(a<o.length&&e(o[a],u)<0&&(u=o[i=a]),r<o.length&&e(o[r],u)<0&&(u=o[i=r]),i===n){break}o[u.index=n]=u,o[t.index=n=i]=t}}var r={},o=[];return r.push=function(){for(var e=0,t=arguments.length;t>e;++e){var r=arguments[e];n(r.index=o.push(r)-1)}return o.length},r.pop=function(){var e=o[0],n=o.pop();return o.length&&(o[n.index=0]=n,t(0)),e},r.remove=function(r){var a=r.index,i=o.pop();return a!==o.length&&(o[i.index=a]=i,(e(i,r)<0?n:t)(a)),a},r}function d(e){if(!e){return v}var n,t,r=e.scale[0],o=e.scale[1],a=e.translate[0],i=e.translate[1];return function(e,u){u||(n=t=0),e[0]=(n+=e[0])*r+a,e[1]=(t+=e[1])*o+i}}function p(e){if(!e){return v}var n,t,r=e.scale[0],o=e.scale[1],a=e.translate[0],i=e.translate[1];return function(e,u){u||(n=t=0);var c=0|(e[0]-a)/r,s=0|(e[1]-i)/o;e[0]=c-n,e[1]=s-t,n=c,t=s}}function v(){}return{version:"1.4.2",mesh:n,feature:t,neighbors:u,presimplify:c}}();(function(){var root=this;var previousUnderscore=root._;var breaker={};var ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype;var push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty;var nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind;var _=function(obj){if(obj instanceof _){return obj}if(!(this instanceof _)){return new _(obj)}this._wrapped=obj};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=_}exports._=_}else{root._=_}_.VERSION="1.5.2";var each=_.each=_.forEach=function(obj,iterator,context){if(obj==null){return}if(nativeForEach&&obj.forEach===nativeForEach){obj.forEach(iterator,context)}else{if(obj.length===+obj.length){for(var i=0,length=obj.length;i<length;i++){if(iterator.call(context,obj[i],i,obj)===breaker){return}}}else{var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker){return}}}}};_.map=_.collect=function(obj,iterator,context){var results=[];if(obj==null){return results}if(nativeMap&&obj.map===nativeMap){return obj.map(iterator,context)}each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))});return results};var reduceError="Reduce of empty array with no initial value";_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null){obj=[]}if(nativeReduce&&obj.reduce===nativeReduce){if(context){iterator=_.bind(iterator,context)}return initial?obj.reduce(iterator,memo):obj.reduce(iterator)}each(obj,function(value,index,list){if(!initial){memo=value;initial=true}else{memo=iterator.call(context,memo,value,index,list)}});if(!initial){throw new TypeError(reduceError)}return memo};_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=arguments.length>2;if(obj==null){obj=[]}if(nativeReduceRight&&obj.reduceRight===nativeReduceRight){if(context){iterator=_.bind(iterator,context)}return initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator)}var length=obj.length;if(length!==+length){var keys=_.keys(obj);length=keys.length}each(obj,function(value,index,list){index=keys?keys[--length]:--length;if(!initial){memo=obj[index];initial=true}else{memo=iterator.call(context,memo,obj[index],index,list)}});if(!initial){throw new TypeError(reduceError)}return memo};_.find=_.detect=function(obj,iterator,context){var result;any(obj,function(value,index,list){if(iterator.call(context,value,index,list)){result=value;return true}});return result};_.filter=_.select=function(obj,iterator,context){var results=[];if(obj==null){return results}if(nativeFilter&&obj.filter===nativeFilter){return obj.filter(iterator,context)}each(obj,function(value,index,list){if(iterator.call(context,value,index,list)){results.push(value)}});return results};_.reject=function(obj,iterator,context){return _.filter(obj,function(value,index,list){return !iterator.call(context,value,index,list)},context)};_.every=_.all=function(obj,iterator,context){iterator||(iterator=_.identity);var result=true;if(obj==null){return result}if(nativeEvery&&obj.every===nativeEvery){return obj.every(iterator,context)}each(obj,function(value,index,list){if(!(result=result&&iterator.call(context,value,index,list))){return breaker}});return !!result};var any=_.some=_.any=function(obj,iterator,context){iterator||(iterator=_.identity);var result=false;if(obj==null){return result}if(nativeSome&&obj.some===nativeSome){return obj.some(iterator,context)}each(obj,function(value,index,list){if(result||(result=iterator.call(context,value,index,list))){return breaker}});return !!result};_.contains=_.include=function(obj,target){if(obj==null){return false}if(nativeIndexOf&&obj.indexOf===nativeIndexOf){return obj.indexOf(target)!=-1}return any(obj,function(value){return value===target})};_.invoke=function(obj,method){var args=slice.call(arguments,2);var isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})};_.pluck=function(obj,key){return _.map(obj,function(value){return value[key]})};_.where=function(obj,attrs,first){if(_.isEmpty(attrs)){return first?void 0:[]}return _[first?"find":"filter"](obj,function(value){for(var key in attrs){if(attrs[key]!==value[key]){return false}}return true})};_.findWhere=function(obj,attrs){return _.where(obj,attrs,true)};_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.max.apply(Math,obj)}if(!iterator&&_.isEmpty(obj)){return -Infinity}var result={computed:-Infinity,value:-Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed>result.computed&&(result={value:value,computed:computed})});return result.value};_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535){return Math.min.apply(Math,obj)}if(!iterator&&_.isEmpty(obj)){return Infinity}var result={computed:Infinity,value:Infinity};each(obj,function(value,index,list){var computed=iterator?iterator.call(context,value,index,list):value;computed<result.computed&&(result={value:value,computed:computed})});return result.value};_.shuffle=function(obj){var rand;var index=0;var shuffled=[];each(obj,function(value){rand=_.random(index++);shuffled[index-1]=shuffled[rand];shuffled[rand]=value});return shuffled};_.sample=function(obj,n,guard){if(arguments.length<2||guard){return obj[_.random(obj.length-1)]}return _.shuffle(obj).slice(0,Math.max(0,n))};var lookupIterator=function(value){return _.isFunction(value)?value:function(obj){return obj[value]}};_.sortBy=function(obj,value,context){var iterator=lookupIterator(value);return _.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria;var b=right.criteria;if(a!==b){if(a>b||a===void 0){return 1}if(a<b||b===void 0){return -1}}return left.index-right.index}),"value")};var group=function(behavior){return function(obj,value,context){var result={};var iterator=value==null?_.identity:lookupIterator(value);each(obj,function(value,index){var key=iterator.call(context,value,index,obj);behavior(result,key,value)});return result}};_.groupBy=group(function(result,key,value){(_.has(result,key)?result[key]:(result[key]=[])).push(value)});_.indexBy=group(function(result,key,value){result[key]=value});_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1});_.sortedIndex=function(array,obj,iterator,context){iterator=iterator==null?_.identity:lookupIterator(iterator);var value=iterator.call(context,obj);var low=0,high=array.length;while(low<high){var mid=(low+high)>>>1;iterator.call(context,array[mid])<value?low=mid+1:high=mid}return low};_.toArray=function(obj){if(!obj){return[]}if(_.isArray(obj)){return slice.call(obj)}if(obj.length===+obj.length){return _.map(obj,_.identity)}return _.values(obj)};_.size=function(obj){if(obj==null){return 0}return(obj.length===+obj.length)?obj.length:_.keys(obj).length};_.first=_.head=_.take=function(array,n,guard){if(array==null){return void 0}return(n==null)||guard?array[0]:slice.call(array,0,n)};_.initial=function(array,n,guard){return slice.call(array,0,array.length-((n==null)||guard?1:n))};_.last=function(array,n,guard){if(array==null){return void 0}if((n==null)||guard){return array[array.length-1]}else{return slice.call(array,Math.max(array.length-n,0))}};_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,(n==null)||guard?1:n)};_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,output){if(shallow&&_.every(input,_.isArray)){return concat.apply(output,input)}each(input,function(value){if(_.isArray(value)||_.isArguments(value)){shallow?push.apply(output,value):flatten(value,shallow,output)}else{output.push(value)}});return output};_.flatten=function(array,shallow){return flatten(array,shallow,[])};_.without=function(array){return _.difference(array,slice.call(arguments,1))};_.uniq=_.unique=function(array,isSorted,iterator,context){if(_.isFunction(isSorted)){context=iterator;iterator=isSorted;isSorted=false}var initial=iterator?_.map(array,iterator,context):array;var results=[];var seen=[];each(initial,function(value,index){if(isSorted?(!index||seen[seen.length-1]!==value):!_.contains(seen,value)){seen.push(value);results.push(array[index])}});return results};_.union=function(){return _.uniq(_.flatten(arguments,true))};_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.indexOf(other,item)>=0})})};_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return !_.contains(rest,value)})};_.zip=function(){var length=_.max(_.pluck(arguments,"length").concat(0));var results=new Array(length);for(var i=0;i<length;i++){results[i]=_.pluck(arguments,""+i)}return results};_.object=function(list,values){if(list==null){return{}}var result={};for(var i=0,length=list.length;i<length;i++){if(values){result[list[i]]=values[i]}else{result[list[i][0]]=list[i][1]}}return result};_.indexOf=function(array,item,isSorted){if(array==null){return -1}var i=0,length=array.length;if(isSorted){if(typeof isSorted=="number"){i=(isSorted<0?Math.max(0,length+isSorted):isSorted)}else{i=_.sortedIndex(array,item);return array[i]===item?i:-1}}if(nativeIndexOf&&array.indexOf===nativeIndexOf){return array.indexOf(item,isSorted)}for(;i<length;i++){if(array[i]===item){return i}}return -1};_.lastIndexOf=function(array,item,from){if(array==null){return -1}var hasIndex=from!=null;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf){return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item)}var i=(hasIndex?from:array.length);while(i--){if(array[i]===item){return i}}return -1};_.range=function(start,stop,step){if(arguments.length<=1){stop=start||0;start=0}step=arguments[2]||1;var length=Math.max(Math.ceil((stop-start)/step),0);var idx=0;var range=new Array(length);while(idx<length){range[idx++]=start;start+=step}return range};var ctor=function(){};_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind){return nativeBind.apply(func,slice.call(arguments,1))}if(!_.isFunction(func)){throw new TypeError}args=slice.call(arguments,2);return bound=function(){if(!(this instanceof bound)){return func.apply(context,args.concat(slice.call(arguments)))}ctor.prototype=func.prototype;var self=new ctor;ctor.prototype=null;var result=func.apply(self,args.concat(slice.call(arguments)));if(Object(result)===result){return result}return self}};_.partial=function(func){var args=slice.call(arguments,1);return function(){return func.apply(this,args.concat(slice.call(arguments)))}};_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(funcs.length===0){throw new Error("bindAll must be passed function names")}each(funcs,function(f){obj[f]=_.bind(obj[f],obj)});return obj};_.memoize=function(func,hasher){var memo={};hasher||(hasher=_.identity);return function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:(memo[key]=func.apply(this,arguments))}};_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)};_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))};_.throttle=function(func,wait,options){var context,args,result;var timeout=null;var previous=0;options||(options={});var later=function(){previous=options.leading===false?0:new Date;timeout=null;result=func.apply(context,args)};return function(){var now=new Date;if(!previous&&options.leading===false){previous=now}var remaining=wait-(now-previous);context=this;args=arguments;if(remaining<=0){clearTimeout(timeout);timeout=null;previous=now;result=func.apply(context,args)}else{if(!timeout&&options.trailing!==false){timeout=setTimeout(later,remaining)}}return result}};_.debounce=function(func,wait,immediate){var timeout,args,context,timestamp,result;return function(){context=this;args=arguments;timestamp=new Date();var later=function(){var last=(new Date())-timestamp;if(last<wait){timeout=setTimeout(later,wait-last)}else{timeout=null;if(!immediate){result=func.apply(context,args)}}};var callNow=immediate&&!timeout;if(!timeout){timeout=setTimeout(later,wait)}if(callNow){result=func.apply(context,args)}return result}};_.once=function(func){var ran=false,memo;return function(){if(ran){return memo}ran=true;memo=func.apply(this,arguments);func=null;return memo}};_.wrap=function(func,wrapper){return function(){var args=[func];push.apply(args,arguments);return wrapper.apply(this,args)}};_.compose=function(){var funcs=arguments;return function(){var args=arguments;for(var i=funcs.length-1;i>=0;i--){args=[funcs[i].apply(this,args)]}return args[0]}};_.after=function(times,func){return function(){if(--times<1){return func.apply(this,arguments)}}};_.keys=nativeKeys||function(obj){if(obj!==Object(obj)){throw new TypeError("Invalid object")}var keys=[];for(var key in obj){if(_.has(obj,key)){keys.push(key)}}return keys};_.values=function(obj){var keys=_.keys(obj);var length=keys.length;var values=new Array(length);for(var i=0;i<length;i++){values[i]=obj[keys[i]]}return values};_.pairs=function(obj){var keys=_.keys(obj);var length=keys.length;var pairs=new Array(length);for(var i=0;i<length;i++){pairs[i]=[keys[i],obj[keys[i]]]}return pairs};_.invert=function(obj){var result={};var keys=_.keys(obj);for(var i=0,length=keys.length;i<length;i++){result[obj[keys[i]]]=keys[i]}return result};_.functions=_.methods=function(obj){var names=[];for(var key in obj){if(_.isFunction(obj[key])){names.push(key)}}return names.sort()};_.extend=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){obj[prop]=source[prop]}}});return obj};_.pick=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));each(keys,function(key){if(key in obj){copy[key]=obj[key]}});return copy};_.omit=function(obj){var copy={};var keys=concat.apply(ArrayProto,slice.call(arguments,1));for(var key in obj){if(!_.contains(keys,key)){copy[key]=obj[key]}}return copy};_.defaults=function(obj){each(slice.call(arguments,1),function(source){if(source){for(var prop in source){if(obj[prop]===void 0){obj[prop]=source[prop]}}}});return obj};_.clone=function(obj){if(!_.isObject(obj)){return obj}return _.isArray(obj)?obj.slice():_.extend({},obj)};_.tap=function(obj,interceptor){interceptor(obj);return obj};var eq=function(a,b,aStack,bStack){if(a===b){return a!==0||1/a==1/b}if(a==null||b==null){return a===b}if(a instanceof _){a=a._wrapped}if(b instanceof _){b=b._wrapped}var className=toString.call(a);if(className!=toString.call(b)){return false}switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:(a==0?1/a==1/b:a==+b);case"[object Date]":case"[object Boolean]":return +a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object"){return false}var length=aStack.length;while(length--){if(aStack[length]==a){return bStack[length]==b}}var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&(aCtor instanceof aCtor)&&_.isFunction(bCtor)&&(bCtor instanceof bCtor))){return false}aStack.push(a);bStack.push(b);var size=0,result=true;if(className=="[object Array]"){size=a.length;result=size==b.length;if(result){while(size--){if(!(result=eq(a[size],b[size],aStack,bStack))){break}}}}else{for(var key in a){if(_.has(a,key)){size++;if(!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))){break}}}if(result){for(key in b){if(_.has(b,key)&&!(size--)){break}}result=!size}}aStack.pop();bStack.pop();return result};_.isEqual=function(a,b){return eq(a,b,[],[])};_.isEmpty=function(obj){if(obj==null){return true}if(_.isArray(obj)||_.isString(obj)){return obj.length===0}for(var key in obj){if(_.has(obj,key)){return false}}return true};_.isElement=function(obj){return !!(obj&&obj.nodeType===1)};_.isArray=nativeIsArray||function(obj){return toString.call(obj)=="[object Array]"};_.isObject=function(obj){return obj===Object(obj)};each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}});if(!_.isArguments(arguments)){_.isArguments=function(obj){return !!(obj&&_.has(obj,"callee"))}}if(typeof(/./)!=="function"){_.isFunction=function(obj){return typeof obj==="function"}}_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))};_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj};_.isBoolean=function(obj){return obj===true||obj===false||toString.call(obj)=="[object Boolean]"};_.isNull=function(obj){return obj===null};_.isUndefined=function(obj){return obj===void 0};_.has=function(obj,key){return hasOwnProperty.call(obj,key)};_.noConflict=function(){root._=previousUnderscore;return this};_.identity=function(value){return value};_.times=function(n,iterator,context){var accum=Array(Math.max(0,n));for(var i=0;i<n;i++){accum[i]=iterator.call(context,i)}return accum};_.random=function(min,max){if(max==null){max=min;min=0}return min+Math.floor(Math.random()*(max-min+1))};var entityMap={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};entityMap.unescape=_.invert(entityMap.escape);var entityRegexes={escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")};_.each(["escape","unescape"],function(method){_[method]=function(string){if(string==null){return""}return(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}});_.result=function(object,property){if(object==null){return void 0}var value=object[property];return _.isFunction(value)?value.call(object):value};_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];push.apply(args,arguments);return result.call(this,func.apply(_,args))}})};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id};_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/;var escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"};var escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g;_.template=function(text,data,settings){var render;settings=_.defaults({},settings,_.templateSettings);var matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g");var index=0;var source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]});if(escape){source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"}if(interpolate){source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"}if(evaluate){source+="';\n"+evaluate+"\n__p+='"}index=offset+match.length;return match});source+="';\n";if(!settings.variable){source="with(obj||{}){\n"+source+"}\n"}source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){e.source=source;throw e}if(data){return render(data,_)}var template=function(data){return render.call(this,data,_)};template.source="function("+(settings.variable||"obj")+"){\n"+source+"}";return template};_.chain=function(obj){return _(obj).chain()};var result=function(obj){return this._chain?_(obj).chain():obj};_.mixin(_);each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;method.apply(obj,arguments);if((name=="shift"||name=="splice")&&obj.length===0){delete obj[0]}return result.call(this,obj)}});each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}});_.extend(_.prototype,{chain:function(){this._chain=true;return this},value:function(){return this._wrapped}})}).call(this);(function(){function v(a,b){var c;a||(a={});for(c in b){a[c]=b[c]}return a}function x(){var a,b=arguments.length,c={},d=function(a,b){var c,h;typeof a!=="object"&&(a={});for(h in b){b.hasOwnProperty(h)&&(c=b[h],a[h]=c&&typeof c==="object"&&Object.prototype.toString.call(c)!=="[object Array]"&&typeof c.nodeType!=="number"?d(a[h]||{},c):b[h])}return a};for(a=0;a<b;a++){c=d(c,arguments[a])}return c}function lb(){for(var a=0,b=arguments,c=b.length,d={};a<c;a++){d[b[a++]]=b[a]}return d}function z(a,b){return parseInt(a,b||10)}function ja(a){return typeof a==="string"}function ba(a){return typeof a==="object"}function Wa(a){return Object.prototype.toString.call(a)==="[object Array]"}function ra(a){return typeof a==="number"}function sa(a){return S.log(a)/S.LN10}function ka(a){return S.pow(10,a)}function la(a,b){for(var c=a.length;c--;){if(a[c]===b){a.splice(c,1);break}}}function t(a){return a!==r&&a!==null}function C(a,b,c){var d,e;if(ja(b)){t(c)?a.setAttribute(b,c):a&&a.getAttribute&&(e=a.getAttribute(b))}else{if(t(b)&&ba(b)){for(d in b){a.setAttribute(d,b[d])}}}return e}function ha(a){return Wa(a)?a:[a]}function o(){var a=arguments,b,c,d=a.length;for(b=0;b<d;b++){if(c=a[b],typeof c!=="undefined"&&c!==null){return c}}}function F(a,b){if(ya&&b&&b.opacity!==r){b.filter="alpha(opacity="+b.opacity*100+")"}v(a.style,b)}function Z(a,b,c,d,e){a=G.createElement(a);b&&v(a,b);e&&F(a,{padding:0,border:$,margin:0});c&&F(a,c);d&&d.appendChild(a);return a}function ca(a,b){var c=function(){};c.prototype=new a;v(c.prototype,b);return c}function za(a,b,c,d){var e=N.lang,a=+a||0,f=b===-1?(a.toString().split(".")[1]||"").length:isNaN(b=T(b))?2:b,b=c===void 0?e.decimalPoint:c,d=d===void 0?e.thousandsSep:d,e=a<0?"-":"",c=String(z(a=T(a).toFixed(f))),g=c.length>3?c.length%3:0;return e+(g?c.substr(0,g)+d:"")+c.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+d)+(f?b+T(a-c).toFixed(f).slice(2):"")}function La(a,b){return Array((b||2)+1-String(a).length).join(0)+a}function ma(a,b,c){var d=a[b];a[b]=function(){var a=Array.prototype.slice.call(arguments);a.unshift(d);return c.apply(this,a)}}function Ma(a,b){for(var c="{",d=!1,e,f,g,h,i,k=[];(c=a.indexOf(c))!==-1;){e=a.slice(0,c);if(d){f=e.split(":");g=f.shift().split(".");i=g.length;e=b;for(h=0;h<i;h++){e=e[g[h]]}if(f.length){f=f.join(":"),g=/\.([0-9])/,h=N.lang,i=void 0,/f$/.test(f)?(i=(i=f.match(g))?i[1]:-1,e=za(e,i,h.decimalPoint,f.indexOf(",")>-1?h.thousandsSep:"")):e=Aa(f,e)}}k.push(e);a=a.slice(c+1);c=(d=!d)?"}":"{"}k.push(a);return k.join("")}function xb(a){return S.pow(10,U(S.log(a)/S.LN10))}function yb(a,b,c,d){var e,c=o(c,1);e=a/c;b||(b=[1,2,2.5,5,10],d&&d.allowDecimals===!1&&(c===1?b=[1,2,5,10]:c<=0.1&&(b=[1/c])));for(d=0;d<b.length;d++){if(a=b[d],e<=(b[d]+(b[d+1]||b[d]))/2){break}}a*=c;return a}function zb(a,b){var c=b||[[mb,[1,2,5,10,20,25,50,100,200,500]],[eb,[1,2,5,10,15,30]],[Xa,[1,2,5,10,15,30]],[Ba,[1,2,3,4,6,8,12]],[fa,[1,2]],[Na,[1,2]],[Oa,[1,2,3,4,6]],[na,null]],d=c[c.length-1],e=H[d[0]],f=d[1],g;for(g=0;g<c.length;g++){if(d=c[g],e=H[d[0]],f=d[1],c[g+1]&&a<=(e*f[f.length-1]+H[c[g+1][0]])/2){break}}e===H[na]&&a<5*e&&(f=[1,2,5]);e===H[na]&&a<5*e&&(f=[1,2,5]);c=yb(a/e,f,d[0]===na?xb(a/e):1);return{unitRange:e,count:c,unitName:d[0]}}function fb(a,b,c,d){var e=[],f={},g=N.global.useUTC,h,i=new Date(b),k=a.unitRange,j=a.count;if(t(b)){k>=H[eb]&&(i.setMilliseconds(0),i.setSeconds(k>=H[Xa]?0:j*U(i.getSeconds()/j)));if(k>=H[Xa]){i[Nb](k>=H[Ba]?0:j*U(i[Ab]()/j))}if(k>=H[Ba]){i[Ob](k>=H[fa]?0:j*U(i[Bb]()/j))}if(k>=H[fa]){i[Cb](k>=H[Oa]?1:j*U(i[Pa]()/j))}k>=H[Oa]&&(i[Pb](k>=H[na]?0:j*U(i[nb]()/j)),h=i[ob]());k>=H[na]&&(h-=h%j,i[Qb](h));if(k===H[Na]){i[Cb](i[Pa]()-i[Db]()+o(d,1))}b=1;h=i[ob]();for(var d=i.getTime(),l=i[nb](),m=i[Pa](),n=g?0:(86400000+i.getTimezoneOffset()*60000)%86400000;d<c;){e.push(d),k===H[na]?d=pb(h+b*j,0):k===H[Oa]?d=pb(h,l+b*j):!g&&(k===H[fa]||k===H[Na])?d=pb(h,l,m+b*j*(k===H[fa]?1:7)):d+=k*j,b++}e.push(d);q(Eb(e,function(a){return k<=H[Ba]&&a%H[fa]===n}),function(a){f[a]=fa})}e.info=v(a,{higherRanks:f,totalRange:k*j});return e}function Rb(){this.symbol=this.color=0}function Sb(a,b){var c=a.length,d,e;for(e=0;e<c;e++){a[e].ss_i=e}a.sort(function(a,c){d=b(a,c);return d===0?a.ss_i-c.ss_i:d});for(e=0;e<c;e++){delete a[e].ss_i}}function Qa(a){for(var b=a.length,c=a[0];b--;){a[b]<c&&(c=a[b])}return c}function ta(a){for(var b=a.length,c=a[0];b--;){a[b]>c&&(c=a[b])}return c}function Ca(a,b){for(var c in a){a[c]&&a[c]!==b&&a[c].destroy&&a[c].destroy(),delete a[c]}}function Ya(a){qb||(qb=Z(Ra));a&&qb.appendChild(a);qb.innerHTML=""}function Da(a,b){var c="Highcharts error #"+a+": www.highcharts.com/errors/"+a;if(b){throw c}else{X.console&&console.log(c)}}function oa(a){return parseFloat(a.toPrecision(14))}function Za(a,b){Sa=o(a,b.animation)}function Tb(){var a=N.global.useUTC,b=a?"getUTC":"get",c=a?"setUTC":"set";pb=a?Date.UTC:function(a,b,c,g,h,i){return(new Date(a,b,o(c,1),o(g,0),o(h,0),o(i,0))).getTime()};Ab=b+"Minutes";Bb=b+"Hours";Db=b+"Day";Pa=b+"Date";nb=b+"Month";ob=b+"FullYear";Nb=c+"Minutes";Ob=c+"Hours";Cb=c+"Date";Pb=c+"Month";Qb=c+"FullYear"}function Ea(){}function $a(a,b,c,d){this.axis=a;this.pos=b;this.type=c||"";this.isNew=!0;!c&&!d&&this.addLabel()}function Fb(a,b){this.axis=a;if(b){this.options=b,this.id=b.id}}function Ub(a,b,c,d,e,f){var g=a.chart.inverted;this.axis=a;this.isNegative=c;this.options=b;this.x=d;this.total=0;this.points={};this.stack=e;this.percent=f==="percent";this.alignOptions={align:b.align||(g?c?"left":"right":"center"),verticalAlign:b.verticalAlign||(g?"middle":c?"bottom":"top"),y:o(b.y,g?4:c?14:-6),x:o(b.x,g?c?-6:6:0)};this.textAlign=b.textAlign||(g?c?"right":"left":"center")}function ua(){this.init.apply(this,arguments)}function Gb(){this.init.apply(this,arguments)}function rb(a,b){this.init(a,b)}function Hb(a,b){this.init(a,b)}function Ta(){this.init.apply(this,arguments)}function Ib(a){var b=a.options,c=b.navigator,d=c.enabled,b=b.scrollbar,e=b.enabled,f=d?c.height:0,g=e?b.height:0;this.handles=[];this.scrollbarButtons=[];this.elementsToDestroy=[];this.chart=a;this.setBaseSeries();this.height=f;this.scrollbarHeight=g;this.scrollbarEnabled=e;this.navigatorEnabled=d;this.navigatorOptions=c;this.scrollbarOptions=b;this.outlineHeight=f+g;this.init()}function Jb(a){this.init(a)}var r,G=document,X=window,S=Math,s=S.round,U=S.floor,pa=S.ceil,u=S.max,D=S.min,T=S.abs,da=S.cos,ia=S.sin,ab=S.PI,gb=ab*2/360,Ua=navigator.userAgent,Vb=X.opera,ya=/msie/i.test(Ua)&&!Vb,sb=G.documentMode===8,tb=/AppleWebKit/.test(Ua),ub=/Firefox/.test(Ua),hb=/(Mobile|Android|Windows Phone)/.test(Ua),Fa="http://www.w3.org/2000/svg",ea=!!G.createElementNS&&!!G.createElementNS(Fa,"svg").createSVGRect,cc=ub&&parseInt(Ua.split("Firefox/")[1],10)<4,ga=!ea&&!ya&&!!G.createElement("canvas").getContext,bb,ib=G.documentElement.ontouchstart!==r,Wb={},Kb=0,qb,N,Aa,Sa,Lb,H,qa=function(){},Va=[],Ra="div",$="none",Xb="rgba(192,192,192,"+(ea?0.0001:0.002)+")",mb="millisecond",eb="second",Xa="minute",Ba="hour",fa="day",Na="week",Oa="month",na="year",Yb="stroke-width",pb,Ab,Bb,Db,Pa,nb,ob,Nb,Ob,Cb,Pb,Qb,L={};X.Highcharts=X.Highcharts?Da(16,!0):{};Aa=function(a,b,c){if(!t(b)||isNaN(b)){return"Invalid date"}var a=o(a,"%Y-%m-%d %H:%M:%S"),d=new Date(b),e,f=d[Bb](),g=d[Db](),h=d[Pa](),i=d[nb](),k=d[ob](),j=N.lang,l=j.weekdays,d=v({a:l[g].substr(0,3),A:l[g],d:La(h),e:h,b:j.shortMonths[i],B:j.months[i],m:La(i+1),y:k.toString().substr(2,2),Y:k,H:La(f),I:La(f%12||12),l:f%12||12,M:La(d[Ab]()),p:f<12?"AM":"PM",P:f<12?"am":"pm",S:La(d.getSeconds()),L:La(s(b%1000),3)},Highcharts.dateFormats);for(e in d){for(;a.indexOf("%"+e)!==-1;){a=a.replace("%"+e,typeof d[e]==="function"?d[e](b):d[e])}}return c?a.substr(0,1).toUpperCase()+a.substr(1):a};Rb.prototype={wrapColor:function(a){if(this.color>=a){this.color=0}},wrapSymbol:function(a){if(this.symbol>=a){this.symbol=0}}};H=lb(mb,1,eb,1000,Xa,60000,Ba,3600000,fa,86400000,Na,604800000,Oa,2678400000,na,31556952000);Lb={init:function(a,b,c){var b=b||"",d=a.shift,e=b.indexOf("C")>-1,f=e?7:3,g,b=b.split(" "),c=[].concat(c),h,i,k=function(a){for(g=a.length;g--;){a[g]==="M"&&a.splice(g+1,0,a[g+1],a[g+2],a[g+1],a[g+2])}};e&&(k(b),k(c));a.isArea&&(h=b.splice(b.length-6,6),i=c.splice(c.length-6,6));if(d<=c.length/f){for(;d--;){c=[].concat(c).splice(0,f).concat(c)}}a.shift=0;if(b.length){for(a=c.length;b.length<a;){d=[].concat(b).splice(b.length-f,f),e&&(d[f-6]=d[f-2],d[f-5]=d[f-1]),b=b.concat(d)}}h&&(b=b.concat(h),c=c.concat(i));return[b,c]},step:function(a,b,c,d){var e=[],f=a.length;if(c===1){e=d}else{if(f===b.length&&c<1){for(;f--;){d=parseFloat(a[f]),e[f]=isNaN(d)?a[f]:c*parseFloat(b[f]-d)+d}}else{e=b}}return e}};(function(a){X.HighchartsAdapter=X.HighchartsAdapter||a&&{init:function(b){var c=a.fx,d=c.step,e,f=a.Tween,g=f&&f.propHooks;e=a.cssHooks.opacity;a.extend(a.easing,{easeOutQuad:function(a,b,c,d,e){return -d*(b/=e)*(b-2)+c}});a.each(["cur","_default","width","height","opacity"],function(a,b){var e=d,j,l;b==="cur"?e=c.prototype:b==="_default"&&f&&(e=g[b],b="set");(j=e[b])&&(e[b]=function(c){c=a?c:this;l=c.elem;return l.attr?l.attr(c.prop,b==="cur"?r:c.now):j.apply(this,arguments)})});ma(e,"get",function(a,b,c){return b.attr?b.opacity||0:a.call(this,b,c)});e=function(a){var c=a.elem,d;if(!a.started){d=b.init(c,c.d,c.toD),a.start=d[0],a.end=d[1],a.started=!0}c.attr("d",b.step(a.start,a.end,a.pos,c.toD))};f?g.d={set:e}:d.d=e;this.each=Array.prototype.forEach?function(a,b){return Array.prototype.forEach.call(a,b)}:function(a,b){for(var c=0,d=a.length;c<d;c++){if(b.call(a[c],a[c],c,a)===!1){return c}}};a.fn.highcharts=function(){var a="Chart",b=arguments,c,d;ja(b[0])&&(a=b[0],b=Array.prototype.slice.call(b,1));c=b[0];if(c!==r){c.chart=c.chart||{},c.chart.renderTo=this[0],new Highcharts[a](c,b[1]),d=this}c===r&&(d=Va[C(this[0],"data-highcharts-chart")]);return d}},getScript:a.getScript,inArray:a.inArray,adapterRun:function(b,c){return a(b)[c]()},grep:a.grep,map:function(a,c){for(var d=[],e=0,f=a.length;e<f;e++){d[e]=c.call(a[e],a[e],e,a)}return d},offset:function(b){return a(b).offset()},addEvent:function(b,c,d){a(b).bind(c,d)},removeEvent:function(b,c,d){var e=G.removeEventListener?"removeEventListener":"detachEvent";G[e]&&b&&!b[e]&&(b[e]=function(){});a(b).unbind(c,d)},fireEvent:function(b,c,d,e){var f=a.Event(c),g="detached"+c,h;!ya&&d&&(delete d.layerX,delete d.layerY);v(f,d);b[c]&&(b[g]=b[c],b[c]=null);a.each(["preventDefault","stopPropagation"],function(a,b){var c=f[b];f[b]=function(){try{c.call(f)}catch(a){b==="preventDefault"&&(h=!0)}}});a(b).trigger(f);b[g]&&(b[c]=b[g],b[g]=null);e&&!f.isDefaultPrevented()&&!h&&e(f)},washMouseEvent:function(a){var c=a.originalEvent||a;if(c.pageX===r){c.pageX=a.pageX,c.pageY=a.pageY}return c},animate:function(b,c,d){var e=a(b);if(!b.style){b.style={}}if(c.d){b.toD=c.d,c.d=1}e.stop();e.animate(c,d)},stop:function(b){a(b).stop()}}})(X.jQuery);var P=X.HighchartsAdapter,I=P||{};P&&P.init.call(P,Lb);var vb=I.adapterRun,dc=I.getScript,va=I.inArray,q=I.each,Eb=I.grep,ec=I.offset,Ga=I.map,E=I.addEvent,V=I.removeEvent,B=I.fireEvent,Zb=I.washMouseEvent,Mb=I.animate,jb=I.stop,I={enabled:!0,x:0,y:15,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"}};N={colors:"#2f7ed8,#0d233a,#8bbc21,#910000,#1aadce,#492970,#f28f43,#77a1e5,#c42525,#a6c96a".split(","),symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),weekdays:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),decimalPoint:".",numericSymbols:"k,M,G,T,P,E".split(","),resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/stock/1.3.4/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/stock/1.3.4/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacingTop:10,spacingRight:10,spacingBottom:15,spacingLeft:10,style:{fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",margin:15,style:{color:"#274b6d",fontSize:"16px"}},subtitle:{text:"",align:"center",style:{color:"#4d759e"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1000},events:{},lineWidth:2,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:x(I,{align:"center",enabled:!1,formatter:function(){return this.y===null?"":za(this.y,-1)},verticalAlign:"bottom",y:0}),cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0}},labels:{style:{position:"absolute",color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{cursor:"pointer",color:"#274b6d",fontSize:"12px"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:"absolute",width:"13px",height:"13px"},symbolWidth:16,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:"relative",top:"1em"},style:{position:"absolute",backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:!0,animation:ea,backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b><br/>',shadow:!0,snap:hb?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var Q=N.plotOptions,P=Q.line;Tb();var wa=function(a){var b=[],c,d;(function(a){a&&a.stops?d=Ga(a.stops,function(a){return wa(a[1])}):(c=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/.exec(a))?b=[z(c[1]),z(c[2]),z(c[3]),parseFloat(c[4],10)]:(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(a))?b=[z(c[1],16),z(c[2],16),z(c[3],16),1]:(c=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(a))&&(b=[z(c[1]),z(c[2]),z(c[3]),1])})(a);return{get:function(c){var f;d?(f=x(a),f.stops=[].concat(f.stops),q(d,function(a,b){f.stops[b]=[f.stops[b][0],a.get(c)]})):f=b&&!isNaN(b[0])?c==="rgb"?"rgb("+b[0]+","+b[1]+","+b[2]+")":c==="a"?b[3]:"rgba("+b.join(",")+")":a;return f},brighten:function(a){if(d){q(d,function(b){b.brighten(a)})}else{if(ra(a)&&a!==0){var c;for(c=0;c<3;c++){b[c]+=z(a*255),b[c]<0&&(b[c]=0),b[c]>255&&(b[c]=255)}}}return this},rgba:b,setOpacity:function(a){b[3]=a;return this}}};Ea.prototype={init:function(a,b){this.element=b==="span"?Z(b):G.createElementNS(Fa,b);this.renderer=a;this.attrSetters={}},opacity:1,animate:function(a,b,c){b=o(b,Sa,!0);jb(this);if(b){b=x(b);if(c){b.complete=c}Mb(this,a,b)}else{this.attr(a),c&&c()}},attr:function(a,b){var c,d,e,f,g=this.element,h=g.nodeName.toLowerCase(),i=this.renderer,k,j=this.attrSetters,l=this.shadows,m,n,p=this;ja(a)&&t(b)&&(c=a,a={},a[c]=b);if(ja(a)){c=a,h==="circle"?c={x:"cx",y:"cy"}[c]||c:c==="strokeWidth"&&(c="stroke-width"),p=C(g,c)||this[c]||0,c!=="d"&&c!=="visibility"&&(p=parseFloat(p))}else{for(c in a){if(k=!1,d=a[c],e=j[c]&&j[c].call(this,d,c),e!==!1){e!==r&&(d=e);if(c==="d"){d&&d.join&&(d=d.join(" ")),/(NaN| {2}|^$)/.test(d)&&(d="M 0 0")}else{if(c==="x"&&h==="text"){for(e=0;e<g.childNodes.length;e++){f=g.childNodes[e],C(f,"x")===C(g,"x")&&C(f,"x",d)}}else{if(this.rotation&&(c==="x"||c==="y")){n=!0}else{if(c==="fill"){d=i.color(d,g,c)}else{if(h==="circle"&&(c==="x"||c==="y")){c={x:"cx",y:"cy"}[c]||c}else{if(h==="rect"&&c==="r"){C(g,{rx:d,ry:d}),k=!0}else{if(c==="translateX"||c==="translateY"||c==="rotation"||c==="verticalAlign"||c==="scaleX"||c==="scaleY"){k=n=!0}else{if(c==="stroke"){d=i.color(d,g,c)}else{if(c==="dashstyle"){if(c="stroke-dasharray",d=d&&d.toLowerCase(),d==="solid"){d=$}else{if(d){d=d.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(",");for(e=d.length;e--;){d[e]=z(d[e])*o(a["stroke-width"],this["stroke-width"])}d=d.join(",")}}}else{if(c==="width"){d=z(d)}else{if(c==="align"){c="text-anchor",d={left:"start",center:"middle",right:"end"}[d]}else{if(c==="title"){e=g.getElementsByTagName("title")[0],e||(e=G.createElementNS(Fa,"title"),g.appendChild(e)),e.textContent=d}}}}}}}}}}}}c==="strokeWidth"&&(c="stroke-width");if(c==="stroke-width"||c==="stroke"){this[c]=d;if(this.stroke&&this["stroke-width"]){C(g,"stroke",this.stroke),C(g,"stroke-width",this["stroke-width"]),this.hasStroke=!0}else{if(c==="stroke-width"&&d===0&&this.hasStroke){g.removeAttribute("stroke"),this.hasStroke=!1}}k=!0}this.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(c)&&(m||(this.symbolAttr(a),m=!0),k=!0);if(l&&/^(width|height|visibility|x|y|d|transform|cx|cy|r)$/.test(c)){for(e=l.length;e--;){C(l[e],c,c==="height"?u(d-(l[e].cutHeight||0),0):d)}}if((c==="width"||c==="height")&&h==="rect"&&d<0){d=0}this[c]=d;c==="text"?(d!==this.textStr&&delete this.bBox,this.textStr=d,this.added&&i.buildText(this)):k||C(g,c,d)}}n&&this.updateTransform()}return p},addClass:function(a){var b=this.element,c=C(b,"class")||"";c.indexOf(a)===-1&&C(b,"class",c+" "+a);return this},symbolAttr:function(a){var b=this;q("x,y,r,start,end,width,height,innerR,anchorX,anchorY".split(","),function(c){b[c]=o(a[c],b[c])});b.attr({d:b.renderer.symbols[b.symbolName](b.x,b.y,b.width,b.height,b)})},clip:function(a){return this.attr("clip-path",a?"url("+this.renderer.url+"#"+a.id+")":$)},crisp:function(a,b,c,d,e){var f,g={},h={},i,a=a||this.strokeWidth||this.attr&&this.attr("stroke-width")||0;i=s(a)%2/2;h.x=U(b||this.x||0)+i;h.y=U(c||this.y||0)+i;h.width=U((d||this.width||0)-2*i);h.height=U((e||this.height||0)-2*i);h.strokeWidth=a;for(f in h){this[f]!==h[f]&&(this[f]=g[f]=h[f])}return g},css:function(a){var b=this.element,c=a&&a.width&&b.nodeName.toLowerCase()==="text",d,e="",f=function(a,b){return"-"+b.toLowerCase()};if(a&&a.color){a.fill=a.color}this.styles=a=v(this.styles,a);ga&&c&&delete a.width;if(ya&&!ea){c&&delete a.width,F(this.element,a)}else{for(d in a){e+=d.replace(/([A-Z])/g,f)+":"+a[d]+";"}C(b,"style",e)}c&&this.added&&this.renderer.buildText(this);return this},on:function(a,b){var c=this.element;if(ib&&a==="click"){c.ontouchstart=function(a){a.preventDefault();b.call(c,a)}}c["on"+a]=b;return this},setRadialReference:function(a){this.element.radialReference=a;return this},translate:function(a,b){return this.attr({translateX:a,translateY:b})},invert:function(){this.inverted=!0;this.updateTransform();return this},htmlCss:function(a){var b=this.element;if(b=a&&b.tagName==="SPAN"&&a.width){delete a.width,this.textWidth=b,this.updateTransform()}this.styles=v(this.styles,a);F(this.element,a);return this},htmlGetBBox:function(){var a=this.element,b=this.bBox;if(!b){if(a.nodeName==="text"){a.style.position="absolute"}b=this.bBox={x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}}return b},htmlUpdateTransform:function(){if(this.added){var a=this.renderer,b=this.element,c=this.translateX||0,d=this.translateY||0,e=this.x||0,f=this.y||0,g=this.textAlign||"left",h={left:0,center:0.5,right:1}[g],i=g&&g!=="left",k=this.shadows;F(b,{marginLeft:c,marginTop:d});k&&q(k,function(a){F(a,{marginLeft:c+1,marginTop:d+1})});this.inverted&&q(b.childNodes,function(c){a.invertChild(c,b)});if(b.tagName==="SPAN"){var j,l,k=this.rotation,m;j=0;var n=1,p=0,K;m=z(this.textWidth);var y=this.xCorr||0,w=this.yCorr||0,M=[k,g,b.innerHTML,this.textWidth].join(",");if(M!==this.cTT){t(k)&&(j=k*gb,n=da(j),p=ia(j),this.setSpanRotation(k,p,n));j=o(this.elemWidth,b.offsetWidth);l=o(this.elemHeight,b.offsetHeight);if(j>m&&/[ \-]/.test(b.textContent||b.innerText)){F(b,{width:m+"px",display:"block",whiteSpace:"normal"}),j=m}m=a.fontMetrics(b.style.fontSize).b;y=n<0&&-j;w=p<0&&-l;K=n*p<0;y+=p*m*(K?1-h:h);w-=n*m*(k?K?h:1-h:1);i&&(y-=j*h*(n<0?-1:1),k&&(w-=l*h*(p<0?-1:1)),F(b,{textAlign:g}));this.xCorr=y;this.yCorr=w}F(b,{left:e+y+"px",top:f+w+"px"});if(tb){l=b.offsetHeight}this.cTT=M}}else{this.alignOnAdd=!0}},setSpanRotation:function(a){var b={};b[ya?"-ms-transform":tb?"-webkit-transform":ub?"MozTransform":Vb?"-o-transform":""]=b.transform="rotate("+a+"deg)";F(this.element,b)},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.scaleX,d=this.scaleY,e=this.inverted,f=this.rotation;e&&(a+=this.attr("width"),b+=this.attr("height"));a=["translate("+a+","+b+")"];e?a.push("rotate(90) scale(-1,1)"):f&&a.push("rotate("+f+" "+(this.x||0)+" "+(this.y||0)+")");(t(c)||t(d))&&a.push("scale("+o(c,1)+" "+o(d,1)+")");a.length&&C(this.element,"transform",a.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,b,c){var d,e,f,g,h={};e=this.renderer;f=e.alignedObjects;if(a){if(this.alignOptions=a,this.alignByTranslate=b,!c||ja(c)){this.alignTo=d=c||"renderer",la(f,this),f.push(this),c=null}}else{a=this.alignOptions,b=this.alignByTranslate,d=this.alignTo}c=o(c,e[d],e);d=a.align;e=a.verticalAlign;f=(c.x||0)+(a.x||0);g=(c.y||0)+(a.y||0);if(d==="right"||d==="center"){f+=(c.width-(a.width||0))/{right:1,center:2}[d]}h[b?"translateX":"x"]=s(f);if(e==="bottom"||e==="middle"){g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1)}h[b?"translateY":"y"]=s(g);this[this.placed?"animate":"attr"](h);this.placed=!0;this.alignAttr=h;return this},getBBox:function(){var a=this.bBox,b=this.renderer,c,d=this.rotation;c=this.element;var e=this.styles,f=d*gb;if(!a){if(c.namespaceURI===Fa||b.forExport){try{a=c.getBBox?v({},c.getBBox()):{width:c.offsetWidth,height:c.offsetHeight}}catch(g){}if(!a||a.width<0){a={width:0,height:0}}}else{a=this.htmlGetBBox()}if(b.isSVG){b=a.width;c=a.height;if(ya&&e&&e.fontSize==="11px"&&c.toPrecision(3)==="22.7"){a.height=c=14}if(d){a.width=T(c*ia(f))+T(b*da(f)),a.height=T(c*da(f))+T(b*ia(f))}}this.bBox=a}return a},show:function(){return this.attr({visibility:"visible"})},hide:function(){return this.attr({visibility:"hidden"})},fadeOut:function(a){var b=this;b.animate({opacity:0},{duration:a||150,complete:function(){b.hide()}})},add:function(a){var b=this.renderer,c=a||b,d=c.element||b.box,e=d.childNodes,f=this.element,g=C(f,"zIndex"),h;if(a){this.parentGroup=a}this.parentInverted=a&&a.inverted;this.textStr!==void 0&&b.buildText(this);if(g){c.handleZ=!0,g=z(g)}if(c.handleZ){for(c=0;c<e.length;c++){if(a=e[c],b=C(a,"zIndex"),a!==f&&(z(b)>g||!t(g)&&t(b))){d.insertBefore(f,a);h=!0;break}}}h||d.appendChild(f);this.added=!0;B(this,"add");return this},safeRemoveChild:function(a){var b=a.parentNode;b&&b.removeChild(a)},destroy:function(){var a=this,b=a.element||{},c=a.shadows,d=a.renderer.isSVG&&b.nodeName==="SPAN"&&b.parentNode,e,f;b.onclick=b.onmouseout=b.onmouseover=b.onmousemove=b.point=null;jb(a);if(a.clipPath){a.clipPath=a.clipPath.destroy()}if(a.stops){for(f=0;f<a.stops.length;f++){a.stops[f]=a.stops[f].destroy()}a.stops=null}a.safeRemoveChild(b);for(c&&q(c,function(b){a.safeRemoveChild(b)});d&&d.childNodes.length===0;){b=d.parentNode,a.safeRemoveChild(d),d=b}a.alignTo&&la(a.renderer.alignedObjects,a);for(e in a){delete a[e]}return null},shadow:function(a,b,c){var d=[],e,f,g=this.element,h,i,k,j;if(a){i=o(a.width,3);k=(a.opacity||0.15)/i;j=this.parentInverted?"(-1,-1)":"("+o(a.offsetX,1)+", "+o(a.offsetY,1)+")";for(e=1;e<=i;e++){f=g.cloneNode(0);h=i*2+1-2*e;C(f,{isShadow:"true",stroke:a.color||"black","stroke-opacity":k*e,"stroke-width":h,transform:"translate"+j,fill:$});if(c){C(f,"height",u(C(f,"height")-h,0)),f.cutHeight=h}b?b.element.appendChild(f):g.parentNode.insertBefore(f,g);d.push(f)}this.shadows=d}return this}};var Ha=function(){this.init.apply(this,arguments)};Ha.prototype={Element:Ea,init:function(a,b,c,d){var e=location,f,g;f=this.createElement("svg").attr({version:"1.1"});g=f.element;a.appendChild(g);a.innerHTML.indexOf("xmlns")===-1&&C(g,"xmlns",Fa);this.isSVG=!0;this.box=g;this.boxWrapper=f;this.alignedObjects=[];this.url=(ub||tb)&&G.getElementsByTagName("base").length?e.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"";this.createElement("desc").add().element.appendChild(G.createTextNode("Created with Highstock 1.3.4"));this.defs=this.createElement("defs").add();this.forExport=d;this.gradients={};this.setSize(b,c,!1);var h;if(ub&&a.getBoundingClientRect){this.subPixelFix=b=function(){F(a,{left:0,top:0});h=a.getBoundingClientRect();F(a,{left:pa(h.left)-h.left+"px",top:pa(h.top)-h.top+"px"})},b(),E(X,"resize",b)}},isHidden:function(){return !this.boxWrapper.getBBox().width},destroy:function(){var a=this.defs;this.box=null;this.boxWrapper=this.boxWrapper.destroy();Ca(this.gradients||{});this.gradients=null;if(a){this.defs=a.destroy()}this.subPixelFix&&V(X,"resize",this.subPixelFix);return this.alignedObjects=null},createElement:function(a){var b=new this.Element;b.init(this,a);return b},draw:function(){},buildText:function(a){for(var b=a.element,c=this,d=c.forExport,e=o(a.textStr,"").toString().replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g),f=b.childNodes,g=/style="([^"]+)"/,h=/href="(http[^"]+)"/,i=C(b,"x"),k=a.styles,j=k&&k.width&&z(k.width),l=k&&k.lineHeight,m=f.length;m--;){b.removeChild(f[m])}j&&!a.added&&this.box.appendChild(b);e[e.length-1]===""&&e.pop();q(e,function(e,f){var m,y=0,e=e.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");m=e.split("|||");q(m,function(e){if(e!==""||m.length===1){var n={},o=G.createElementNS(Fa,"tspan"),q;g.test(e)&&(q=e.match(g)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),C(o,"style",q));h.test(e)&&!d&&(C(o,"onclick",'location.href="'+e.match(h)[1]+'"'),F(o,{cursor:"pointer"}));e=(e.replace(/<(.|\n)*?>/g,"")||" ").replace(/&lt;/g,"<").replace(/&gt;/g,">");if(e!==" "&&(o.appendChild(G.createTextNode(e)),y?n.dx=0:n.x=i,C(o,n),!y&&f&&(!ea&&d&&F(o,{display:"block"}),C(o,"dy",l||c.fontMetrics(/px$/.test(o.style.fontSize)?o.style.fontSize:k.fontSize).h,tb&&o.offsetHeight)),b.appendChild(o),y++,j)){for(var e=e.replace(/([^\^])-/g,"$1- ").split(" "),r,A=[];e.length||A.length;){delete a.bBox,r=a.getBBox().width,n=r>j,!n||e.length===1?(e=A,A=[],e.length&&(o=G.createElementNS(Fa,"tspan"),C(o,{dy:l||16,x:i}),q&&C(o,"style",q),b.appendChild(o),r>j&&(j=r))):(o.removeChild(o.firstChild),A.unshift(e.pop())),e.length&&o.appendChild(G.createTextNode(e.join(" ").replace(/- /g,"-")))}}}})})},button:function(a,b,c,d,e,f,g){var h=this.label(a,b,c,null,null,null,null,null,"button"),i=0,k,j,l,m,n,a={x1:0,y1:0,x2:0,y2:1},e=x({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:a,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},e);l=e.style;delete e.style;f=x(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#FFF"],[1,"#ACF"]]}},f);m=f.style;delete f.style;g=x(e,{stroke:"#68A",fill:{linearGradient:a,stops:[[0,"#9BD"],[1,"#CDF"]]}},g);n=g.style;delete g.style;E(h.element,ya?"mouseover":"mouseenter",function(){h.attr(f).css(m)});E(h.element,ya?"mouseout":"mouseleave",function(){k=[e,f,g][i];j=[l,m,n][i];h.attr(k).css(j)});h.setState=function(a){(i=a)?a===2&&h.attr(g).css(n):h.attr(e).css(l)};return h.on("click",function(){d.call(h)}).attr(e).css(v({cursor:"default"},l))},crispLine:function(a,b){a[1]===a[4]&&(a[1]=a[4]=s(a[1])-b%2/2);a[2]===a[5]&&(a[2]=a[5]=s(a[2])+b%2/2);return a},path:function(a){var b={fill:$};Wa(a)?b.d=a:ba(a)&&v(b,a);return this.createElement("path").attr(b)},circle:function(a,b,c){a=ba(a)?a:{x:a,y:b,r:c};return this.createElement("circle").attr(a)},arc:function(a,b,c,d,e,f){if(ba(a)){b=a.y,c=a.r,d=a.innerR,e=a.start,f=a.end,a=a.x}a=this.symbol("arc",a||0,b||0,c||0,c||0,{innerR:d||0,start:e||0,end:f||0});a.r=c;return a},rect:function(a,b,c,d,e,f){e=ba(a)?a.r:e;e=this.createElement("rect").attr({rx:e,ry:e,fill:$});return e.attr(ba(a)?a:e.crisp(f,a,b,u(c,0),u(d,0)))},setSize:function(a,b,c){var d=this.alignedObjects,e=d.length;this.width=a;this.height=b;for(this.boxWrapper[o(c,!0)?"animate":"attr"]({width:a,height:b});e--;){d[e].align()}},g:function(a){var b=this.createElement("g");return t(a)?b.attr({"class":"highcharts-"+a}):b},image:function(a,b,c,d,e){var f={preserveAspectRatio:$};arguments.length>1&&v(f,{x:b,y:c,width:d,height:e});f=this.createElement("image").attr(f);f.element.setAttributeNS?f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a):f.element.setAttribute("hc-svg-href",a);return f},symbol:function(a,b,c,d,e,f){var g,h=this.symbols[a],h=h&&h(s(b),s(c),d,e,f),i=/^url\((.*?)\)$/,k,j;if(h){g=this.path(h),v(g,{symbolName:a,x:b,y:c,width:d,height:e}),f&&v(g,f)}else{if(i.test(a)){j=function(a,b){a.element&&(a.attr({width:b[0],height:b[1]}),a.alignByTranslate||a.translate(s((d-b[0])/2),s((e-b[1])/2)))},k=a.match(i)[1],a=Wb[k],g=this.image(k).attr({x:b,y:c}),g.isImg=!0,a?j(g,a):(g.attr({width:0,height:0}),Z("img",{onload:function(){j(g,Wb[k]=[this.width,this.height])},src:k}))}}return g},symbols:{circle:function(a,b,c,d){var e=0.166*c;return["M",a+c/2,b,"C",a+c+e,b,a+c+e,b+d,a+c/2,b+d,"C",a-e,b+d,a-e,b,a+c/2,b,"Z"]},square:function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c,b+d,a,b+d,"Z"]},triangle:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d,a,b+d,"Z"]},"triangle-down":function(a,b,c,d){return["M",a,b,"L",a+c,b,a+c/2,b+d,"Z"]},diamond:function(a,b,c,d){return["M",a+c/2,b,"L",a+c,b+d/2,a+c/2,b+d,a,b+d/2,"Z"]},arc:function(a,b,c,d,e){var f=e.start,c=e.r||c||d,g=e.end-0.001,d=e.innerR,h=e.open,i=da(f),k=ia(f),j=da(g),g=ia(g),e=e.end-f<ab?0:1;return["M",a+c*i,b+c*k,"A",c,c,0,e,1,a+c*j,b+c*g,h?"M":"L",a+d*j,b+d*g,"A",d,d,0,e,0,a+d*i,b+d*k,h?"":"Z"]}},clipRect:function(a,b,c,d){var e="highcharts-"+Kb++,f=this.createElement("clipPath").attr({id:e}).add(this.defs),a=this.rect(a,b,c,d,0).add(f);a.id=e;a.clipPath=f;return a},color:function(a,b,c){var d=this,e,f=/^rgba/,g,h,i,k,j,l,m,n=[];a&&a.linearGradient?g="linearGradient":a&&a.radialGradient&&(g="radialGradient");if(g){c=a[g];h=d.gradients;k=a.stops;b=b.radialReference;Wa(c)&&(a[g]=c={x1:c[0],y1:c[1],x2:c[2],y2:c[3],gradientUnits:"userSpaceOnUse"});g==="radialGradient"&&b&&!t(c.gradientUnits)&&(c=x(c,{cx:b[0]-b[2]/2+c.cx*b[2],cy:b[1]-b[2]/2+c.cy*b[2],r:c.r*b[2],gradientUnits:"userSpaceOnUse"}));for(m in c){m!=="id"&&n.push(m,c[m])}for(m in k){n.push(k[m])}n=n.join(",");h[n]?a=h[n].id:(c.id=a="highcharts-"+Kb++,h[n]=i=d.createElement(g).attr(c).add(d.defs),i.stops=[],q(k,function(a){f.test(a[1])?(e=wa(a[1]),j=e.get("rgb"),l=e.get("a")):(j=a[1],l=1);a=d.createElement("stop").attr({offset:a[0],"stop-color":j,"stop-opacity":l}).add(i);i.stops.push(a)}));return"url("+d.url+"#"+a+")"}else{return f.test(a)?(e=wa(a),C(b,c+"-opacity",e.get("a")),e.get("rgb")):(b.removeAttribute(c+"-opacity"),a)}},text:function(a,b,c,d){var e=N.chart.style,f=ga||!ea&&this.forExport;if(d&&!this.forExport){return this.html(a,b,c)}b=s(o(b,0));c=s(o(c,0));a=this.createElement("text").attr({x:b,y:c,text:a}).css({fontFamily:e.fontFamily,fontSize:e.fontSize});f&&a.css({position:"absolute"});a.x=b;a.y=c;return a},html:function(a,b,c){var d=N.chart.style,e=this.createElement("span"),f=e.attrSetters,g=e.element,h=e.renderer;f.text=function(a){a!==g.innerHTML&&delete this.bBox;g.innerHTML=a;return !1};f.x=f.y=f.align=function(a,b){b==="align"&&(b="textAlign");e[b]=a;e.htmlUpdateTransform();return !1};e.attr({text:a,x:s(b),y:s(c)}).css({position:"absolute",whiteSpace:"nowrap",fontFamily:d.fontFamily,fontSize:d.fontSize});e.css=e.htmlCss;if(h.isSVG){e.add=function(a){var b,c=h.box.parentNode,d=[];if(a){if(b=a.div,!b){for(;a;){d.push(a),a=a.parentGroup}q(d.reverse(),function(a){var d;b=a.div=a.div||Z(Ra,{className:C(a.element,"class")},{position:"absolute",left:(a.translateX||0)+"px",top:(a.translateY||0)+"px"},b||c);d=b.style;v(a.attrSetters,{translateX:function(a){d.left=a+"px"},translateY:function(a){d.top=a+"px"},visibility:function(a,b){d[b]=a}})})}}else{b=c}b.appendChild(g);e.added=!0;e.alignOnAdd&&e.htmlUpdateTransform();return e}}return e},fontMetrics:function(a){var a=z(a||11),a=a<24?a+4:s(a*1.2),b=s(a*0.8);return{h:a,b:b}},label:function(a,b,c,d,e,f,g,h,i){function k(){var a,b;a=K.element.style;w=(cb===void 0||A===void 0||p.styles.textAlign)&&K.getBBox();p.width=(cb||w.width||0)+2*aa+u;p.height=(A||w.height||0)+2*aa;D=aa+n.fontMetrics(a&&a.fontSize).b;if(z){if(!o){a=s(-M*aa),b=h?-D:0,p.box=o=d?n.symbol(d,a,b,p.width,p.height):n.rect(a,b,p.width,p.height,0,db[Yb]),o.add(p)}o.isImg||o.attr(x({width:p.width,height:p.height},db));db=null}}function j(){var a=p.styles,a=a&&a.textAlign,b=u+aa*(1-M),c;c=h?0:D;if(t(cb)&&(a==="center"||a==="right")){b+={center:0.5,right:1}[a]*(cb-w.width)}(b!==K.x||c!==K.y)&&K.attr({x:b,y:c});K.x=b;K.y=c}function l(a,b){o?o.attr(a,b):db[a]=b}function m(){K.add(p);p.attr({text:a,x:b,y:c});o&&t(e)&&p.attr({anchorX:e,anchorY:f})}var n=this,p=n.g(i),K=n.text("",0,0,g).attr({zIndex:1}),o,w,M=0,aa=3,u=0,cb,A,O,xa,J=0,db={},D,g=p.attrSetters,z;E(p,"add",m);g.width=function(a){cb=a;return !1};g.height=function(a){A=a;return !1};g.padding=function(a){t(a)&&a!==aa&&(aa=a,j());return !1};g.paddingLeft=function(a){t(a)&&a!==u&&(u=a,j());return !1};g.align=function(a){M={left:0,center:0.5,right:1}[a];return !1};g.text=function(a,b){K.attr(b,a);k();j();return !1};g[Yb]=function(a,b){z=!0;J=a%2/2;l(b,a);return !1};g.stroke=g.fill=g.r=function(a,b){b==="fill"&&(z=!0);l(b,a);return !1};g.anchorX=function(a,b){e=a;l(b,a+J-O);return !1};g.anchorY=function(a,b){f=a;l(b,a-xa);return !1};g.x=function(a){p.x=a;a-=M*((cb||w.width)+aa);O=s(a);p.attr("translateX",O);return !1};g.y=function(a){xa=p.y=s(a);p.attr("translateY",xa);return !1};var C=p.css;return v(p,{css:function(a){if(a){var b={},a=x(a);q("fontSize,fontWeight,fontFamily,color,lineHeight,width,textDecoration".split(","),function(c){a[c]!==r&&(b[c]=a[c],delete a[c])});K.css(b)}return C.call(p,a)},getBBox:function(){return{width:w.width+2*aa,height:w.height+2*aa,x:w.x-aa,y:w.y-aa}},shadow:function(a){o&&o.shadow(a);return p},destroy:function(){V(p,"add",m);V(p.element,"mouseenter");V(p.element,"mouseleave");K&&(K=K.destroy());o&&(o=o.destroy());Ea.prototype.destroy.call(p);p=n=k=j=l=m=null}})}};bb=Ha;var kb,Y;if(!ea&&!ga){Highcharts.VMLElement=Y={init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ","absolute",";"],e=b===Ra;(b==="shape"||e)&&d.push("left:0;top:0;width:1px;height:1px;");d.push("visibility: ",e?"hidden":"visible");c.push(' style="',d.join(""),'"/>');if(b){c=e||b==="span"||b==="img"?c.join(""):a.prepVML(c),this.element=Z(c)}this.renderer=a;this.attrSetters={}},add:function(a){var b=this.renderer,c=this.element,d=b.box,d=a?a.element||a:d;a&&a.inverted&&b.invertChild(c,d);d.appendChild(c);this.added=!0;this.alignOnAdd&&!this.deferUpdateTransform&&this.updateTransform();B(this,"add");return this},updateTransform:Ea.prototype.htmlUpdateTransform,setSpanRotation:function(a,b,c){F(this.element,{filter:a?["progid:DXImageTransform.Microsoft.Matrix(M11=",c,", M12=",-b,", M21=",b,", M22=",c,", sizingMethod='auto expand')"].join(""):$})},attr:function(a,b){var c,d,e,f=this.element||{},g=f.style,h=f.nodeName,i=this.renderer,k=this.symbolName,j,l=this.shadows,m,n=this.attrSetters,p=this;ja(a)&&t(b)&&(c=a,a={},a[c]=b);if(ja(a)){c=a,p=c==="strokeWidth"||c==="stroke-width"?this.strokeweight:this[c]}else{for(c in a){if(d=a[c],m=!1,e=n[c]&&n[c].call(this,d,c),e!==!1&&d!==null){e!==r&&(d=e);if(k&&/^(x|y|r|start|end|width|height|innerR|anchorX|anchorY)/.test(c)){j||(this.symbolAttr(a),j=!0),m=!0}else{if(c==="d"){d=d||[];this.d=d.join(" ");e=d.length;m=[];for(var o;e--;){if(ra(d[e])){m[e]=s(d[e]*10)-5}else{if(d[e]==="Z"){m[e]="x"}else{if(m[e]=d[e],d.isArc&&(d[e]==="wa"||d[e]==="at")){o=d[e]==="wa"?1:-1,m[e+5]===m[e+7]&&(m[e+7]-=o),m[e+6]===m[e+8]&&(m[e+8]-=o)}}}}d=m.join(" ")||"x";f.path=d;if(l){for(e=l.length;e--;){l[e].path=l[e].cutOff?this.cutOffPath(d,l[e].cutOff):d}}m=!0}else{if(c==="visibility"){if(l){for(e=l.length;e--;){l[e].style[c]=d}}h==="DIV"&&(d=d==="hidden"?"-999em":0,sb||(g[c]=d?"visible":"hidden"),c="top");g[c]=d;m=!0}else{if(c==="zIndex"){d&&(g[c]=d),m=!0}else{if(va(c,["x","y","width","height"])!==-1){this[c]=d,c==="x"||c==="y"?c={x:"left",y:"top"}[c]:d=u(0,d),this.updateClipping?(this[c]=d,this.updateClipping()):g[c]=d,m=!0}else{if(c==="class"&&h==="DIV"){f.className=d}else{if(c==="stroke"){d=i.color(d,f,c),c="strokecolor"}else{if(c==="stroke-width"||c==="strokeWidth"){f.stroked=d?!0:!1,c="strokeweight",this[c]=d,ra(d)&&(d+="px")}else{if(c==="dashstyle"){(f.getElementsByTagName("stroke")[0]||Z(i.prepVML(["<stroke/>"]),null,null,f))[c]=d||"solid",this.dashstyle=d,m=!0}else{if(c==="fill"){if(h==="SPAN"){g.color=d}else{if(h!=="IMG"){f.filled=d!==$?!0:!1,d=i.color(d,f,c,this),c="fillcolor"}}}else{if(c==="opacity"){m=!0}else{if(h==="shape"&&c==="rotation"){this[c]=f.style[c]=d,f.style.left=-s(ia(d*gb)+1)+"px",f.style.top=s(da(d*gb))+"px"}else{if(c==="translateX"||c==="translateY"||c==="rotation"){this[c]=d,this.updateTransform(),m=!0}else{if(c==="text"){this.bBox=null,f.innerHTML=d,m=!0}}}}}}}}}}}}}}m||(sb?f[c]=d:C(f,c,d))}}}return p},clip:function(a){var b=this,c;a?(c=a.members,la(c,b),c.push(b),b.destroyClip=function(){la(c,b)},a=a.getCSS(b)):(b.destroyClip&&b.destroyClip(),a={clip:sb?"inherit":"rect(auto)"});return b.css(a)},css:Ea.prototype.htmlCss,safeRemoveChild:function(a){a.parentNode&&Ya(a)},destroy:function(){this.destroyClip&&this.destroyClip();return Ea.prototype.destroy.apply(this)},on:function(a,b){this.element["on"+a]=function(){var a=X.event;a.target=a.srcElement;b(a)};return this},cutOffPath:function(a,b){var c,a=a.split(/[ ,]/);c=a.length;if(c===9||c===11){a[c-4]=a[c-2]=z(a[c-2])-10*b}return a.join(" ")},shadow:function(a,b,c){var d=[],e,f=this.element,g=this.renderer,h,i=f.style,k,j=f.path,l,m,n,p;j&&typeof j.value!=="string"&&(j="x");m=j;if(a){n=o(a.width,3);p=(a.opacity||0.15)/n;for(e=1;e<=3;e++){l=n*2+1-2*e;c&&(m=this.cutOffPath(j.value,l+0.5));k=['<shape isShadow="true" strokeweight="',l,'" filled="false" path="',m,'" coordsize="10 10" style="',f.style.cssText,'" />'];h=Z(g.prepVML(k),null,{left:z(i.left)+o(a.offsetX,1),top:z(i.top)+o(a.offsetY,1)});if(c){h.cutOff=l+1}k=['<stroke color="',a.color||"black",'" opacity="',p*e,'"/>'];Z(g.prepVML(k),null,null,h);b?b.element.appendChild(h):f.parentNode.insertBefore(h,f);d.push(h)}this.shadows=d}return this}},Y=ca(Ea,Y),Y={Element:Y,isIE8:Ua.indexOf("MSIE 8.0")>-1,init:function(a,b,c){var d,e;this.alignedObjects=[];d=this.createElement(Ra);e=d.element;e.style.position="relative";a.appendChild(d.element);this.isVML=!0;this.box=e;this.boxWrapper=d;this.setSize(b,c,!1);if(!G.namespaces.hcv){G.namespaces.add("hcv","urn:schemas-microsoft-com:vml"),G.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}},isHidden:function(){return !this.box.offsetWidth},clipRect:function(a,b,c,d){var e=this.createElement(),f=ba(a);return v(e,{members:[],left:f?a.x:a,top:f?a.y:b,width:f?a.width:c,height:f?a.height:d,getCSS:function(a){var b=a.element,c=b.nodeName,a=a.inverted,d=this.top-(c==="shape"?b.offsetTop:0),e=this.left,b=e+this.width,f=d+this.height,d={clip:"rect("+s(a?e:d)+"px,"+s(a?f:b)+"px,"+s(a?b:f)+"px,"+s(a?d:e)+"px)"};!a&&sb&&c==="DIV"&&v(d,{width:b+"px",height:f+"px"});return d},updateClipping:function(){q(e.members,function(a){a.css(e.getCSS(a))})}})},color:function(a,b,c,d){var e=this,f,g=/^rgba/,h,i,k=$;a&&a.linearGradient?i="gradient":a&&a.radialGradient&&(i="pattern");if(i){var j,l,m=a.linearGradient||a.radialGradient,n,p,o,y,w,M="",a=a.stops,aa,r=[],u=function(){h=['<fill colors="'+r.join(",")+'" opacity="',o,'" o:opacity2="',p,'" type="',i,'" ',M,'focus="100%" method="any" />'];Z(e.prepVML(h),null,null,b)};n=a[0];aa=a[a.length-1];n[0]>0&&a.unshift([0,n[1]]);aa[0]<1&&a.push([1,aa[1]]);q(a,function(a,b){g.test(a[1])?(f=wa(a[1]),j=f.get("rgb"),l=f.get("a")):(j=a[1],l=1);r.push(a[0]*100+"% "+j);b?(o=l,y=j):(p=l,w=j)});if(c==="fill"){if(i==="gradient"){c=m.x1||m[0]||0,a=m.y1||m[1]||0,n=m.x2||m[2]||0,m=m.y2||m[3]||0,M='angle="'+(90-S.atan((m-a)/(n-c))*180/ab)+'"',u()}else{var k=m.r,A=k*2,O=k*2,t=m.cx,s=m.cy,v=b.radialReference,x,k=function(){v&&(x=d.getBBox(),t+=(v[0]-x.x)/x.width-0.5,s+=(v[1]-x.y)/x.height-0.5,A*=v[2]/x.width,O*=v[2]/x.height);M='src="'+N.global.VMLRadialGradientURL+'" size="'+A+","+O+'" origin="0.5,0.5" position="'+t+","+s+'" color2="'+w+'" ';u()};d.added?k():E(d,"add",k);k=y}}else{k=j}}else{if(g.test(a)&&b.tagName!=="IMG"){f=wa(a),h=["<",c,' opacity="',f.get("a"),'"/>'],Z(this.prepVML(h),null,null,b),k=f.get("rgb")}else{k=b.getElementsByTagName(c);if(k.length){k[0].opacity=1,k[0].type="solid"}k=a}}return k},prepVML:function(a){var b=this.isIE8,a=a.join("");b?(a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),a=a.indexOf('style="')===-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')):a=a.replace("<","<hcv:");return a},text:Ha.prototype.html,path:function(a){var b={coordsize:"10 10"};Wa(a)?b.d=a:ba(a)&&v(b,a);return this.createElement("shape").attr(b)},circle:function(a,b,c){var d=this.symbol("circle");if(ba(a)){c=a.r,b=a.y,a=a.x}d.isCircle=!0;return d.attr({x:a,y:b,width:2*c,height:2*c})},g:function(a){var b;a&&(b={className:"highcharts-"+a,"class":"highcharts-"+a});return this.createElement(Ra).attr(b)},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});arguments.length>1&&f.attr({x:b,y:c,width:d,height:e});return f},rect:function(a,b,c,d,e,f){if(ba(a)){b=a.y,c=a.width,d=a.height,f=a.strokeWidth,a=a.x}var g=this.symbol("rect");g.r=e;return g.attr(g.crisp(f,a,b,u(c,0),u(d,0)))},invertChild:function(a,b){var c=b.style;F(a,{flip:"x",left:z(c.width)-1,top:z(c.height)-1,rotation:-90})},symbols:{arc:function(a,b,c,d,e){var f=e.start,g=e.end,h=e.r||c||d,c=e.innerR,d=da(f),i=ia(f),k=da(g),j=ia(g);if(g-f===0){return["x"]}f=["wa",a-h,b-h,a+h,b+h,a+h*d,b+h*i,a+h*k,b+h*j];e.open&&!c&&f.push("e","M",a,b);f.push("at",a-c,b-c,a+c,b+c,a+c*k,b+c*j,a+c*d,b+c*i,"x","e");f.isArc=!0;return f},circle:function(a,b,c,d,e){e&&e.isCircle&&(a-=c/2,b-=d/2);return["wa",a,b,a+c,b+d,a+c,b+d/2,a+c,b+d/2,"e"]},rect:function(a,b,c,d,e){var f=a+c,g=b+d,h;!t(e)||!e.r?f=Ha.prototype.symbols.square.apply(0,arguments):(h=D(e.r,c,d),f=["M",a+h,b,"L",f-h,b,"wa",f-2*h,b,f,b+2*h,f-h,b,f,b+h,"L",f,g-h,"wa",f-2*h,g-2*h,f,g,f,g-h,f-h,g,"L",a+h,g,"wa",a,g-2*h,a+2*h,g,a+h,g,a,g-h,"L",a,b+h,"wa",a,b,a+2*h,b+2*h,a,b+h,a+h,b,"x","e"]);return f}}},Highcharts.VMLRenderer=kb=function(){this.init.apply(this,arguments)},kb.prototype=x(Ha.prototype,Y),bb=kb}var $b;if(ga){Highcharts.CanVGRenderer=Y=function(){Fa="http://www.w3.org/1999/xhtml"},Y.prototype.symbols={},$b=function(){function a(){var a=b.length,d;for(d=0;d<a;d++){b[d]()}b=[]}var b=[];return{push:function(c,d){b.length===0&&dc(d,a);b.push(c)}}}(),bb=Y}$a.prototype={addLabel:function(){var a=this.axis,b=a.options,c=a.chart,d=a.horiz,e=a.categories,f=a.series[0]&&a.series[0].names,g=this.pos,h=b.labels,i=a.tickPositions,d=d&&e&&!h.step&&!h.staggerLines&&!h.rotation&&c.plotWidth/i.length||!d&&(c.optionsMarginLeft||c.chartWidth*0.33),k=g===i[0],j=g===i[i.length-1],f=e?o(e[g],f&&f[g],g):g,e=this.label,i=i.info,l;a.isDatetimeAxis&&i&&(l=b.dateTimeLabelFormats[i.higherRanks[g]||i.unitName]);this.isFirst=k;this.isLast=j;b=a.labelFormatter.call({axis:a,chart:c,isFirst:k,isLast:j,dateTimeLabelFormat:l,value:a.isLog?oa(ka(f)):f});g=d&&{width:u(1,s(d-2*(h.padding||10)))+"px"};g=v(g,h.style);if(t(e)){e&&e.attr({text:b}).css(g)}else{d={align:a.labelAlign};if(ra(h.rotation)){d.rotation=h.rotation}this.label=t(b)&&h.enabled?c.renderer.text(b,0,0,h.useHTML).attr(d).css(g).add(a.labelGroup):null}},getLabelSize:function(){var a=this.label,b=this.axis;return a?(this.labelBBox=a.getBBox())[b.horiz?"height":"width"]:0},getLabelSides:function(){var a=this.axis,b=this.labelBBox.width,a=b*{left:0,center:0.5,right:1}[a.labelAlign]-a.options.labels.x;return[-a,b-a]},handleOverflow:function(a,b){var c=!0,d=this.axis,e=d.chart,f=this.isFirst,g=this.isLast,h=b.x,i=d.reversed,k=d.tickPositions;if(f||g){var j=this.getLabelSides(),l=j[0],j=j[1],e=e.plotLeft,m=e+d.len,k=(d=d.ticks[k[a+(f?1:-1)]])&&d.label.xy&&d.label.xy.x+d.getLabelSides()[f?0:1];f&&!i||g&&i?h+l<e&&(h=e-l,d&&h+j>k&&(c=!1)):h+j>m&&(h=m-j,d&&h+l<k&&(c=!1));b.x=h}return c},getPosition:function(a,b,c,d){var e=this.axis,f=e.chart,g=d&&f.oldChartHeight||f.chartHeight;return{x:a?e.translate(b+c,null,null,d)+e.transB:e.left+e.offset+(e.opposite?(d&&f.oldChartWidth||f.chartWidth)-e.right-e.left:0),y:a?g-e.bottom+e.offset-(e.opposite?e.height:0):g-e.translate(b+c,null,null,d)-e.transB}},getLabelPosition:function(a,b,c,d,e,f,g,h){var i=this.axis,k=i.transA,j=i.reversed,l=i.staggerLines,m=i.chart.renderer.fontMetrics(e.style.fontSize).b,n=e.rotation,a=a+e.x-(f&&d?f*k*(j?-1:1):0),b=b+e.y-(f&&!d?f*k*(j?1:-1):0);n&&i.side===2&&(b-=m-m*da(n*gb));!t(e.y)&&!n&&(b+=m-c.getBBox().height/2);l&&(b+=g/(h||1)%l*(i.labelOffset/l));return{x:a,y:b}},getMarkPath:function(a,b,c,d,e,f){return f.crispLine(["M",a,b,"L",a+(e?0:-c),b+(e?c:0)],d)},render:function(a,b,c){var d=this.axis,e=d.options,f=d.chart.renderer,g=d.horiz,h=this.type,i=this.label,k=this.pos,j=e.labels,l=this.gridLine,m=h?h+"Grid":"grid",n=h?h+"Tick":"tick",p=e[m+"LineWidth"],K=e[m+"LineColor"],q=e[m+"LineDashStyle"],w=e[n+"Length"],m=e[n+"Width"]||0,M=e[n+"Color"],u=e[n+"Position"],n=this.mark,t=j.step,s=!0,A=d.tickmarkOffset,O=this.getPosition(g,k,A,b),x=O.x,O=O.y,v=g&&x===d.pos||!g&&O===d.pos+d.len?-1:1,db=d.staggerLines;this.isActive=!0;if(p){k=d.getPlotLinePath(k+A,p*v,b,!0);if(l===r){l={stroke:K,"stroke-width":p};if(q){l.dashstyle=q}if(!h){l.zIndex=1}if(b){l.opacity=0}this.gridLine=l=p?f.path(k).attr(l).add(d.gridGroup):null}if(!b&&l&&k){l[this.isNew?"attr":"animate"]({d:k,opacity:c})}}if(m&&w){u==="inside"&&(w=-w),d.opposite&&(w=-w),b=this.getMarkPath(x,O,w,m*v,g,f),n?n.animate({d:b,opacity:c}):this.mark=f.path(b).attr({stroke:M,"stroke-width":m,opacity:c}).add(d.axisGroup)}if(i&&!isNaN(x)){i.xy=O=this.getLabelPosition(x,O,i,g,j,A,a,t),this.isFirst&&!o(e.showFirstLabel,1)||this.isLast&&!o(e.showLastLabel,1)?s=!1:!db&&g&&j.overflow==="justify"&&!this.handleOverflow(a,O)&&(s=!1),t&&a%t&&(s=!1),s&&!isNaN(O.y)?(O.opacity=c,i[this.isNew?"attr":"animate"](O),this.isNew=!1):i.attr("y",-9999)}},destroy:function(){Ca(this,this.axis)}};Fb.prototype={render:function(){var a=this,b=a.axis,c=b.horiz,d=(b.pointRange||0)/2,e=a.options,f=e.label,g=a.label,h=e.width,i=e.to,k=e.from,j=t(k)&&t(i),l=e.value,m=e.dashStyle,n=a.svgElem,p=[],K,q=e.color,w=e.zIndex,M=e.events,r=b.chart.renderer;b.isLog&&(k=sa(k),i=sa(i),l=sa(l));if(h){if(p=b.getPlotLinePath(l,h),d={stroke:q,"stroke-width":h},m){d.dashstyle=m}}else{if(j){if(k=u(k,b.min-d),i=D(i,b.max+d),p=b.getPlotBandPath(k,i,e),d={fill:q},e.borderWidth){d.stroke=e.borderColor,d["stroke-width"]=e.borderWidth}}else{return}}if(t(w)){d.zIndex=w}if(n){p?n.animate({d:p},null,n.onGetPath):(n.hide(),n.onGetPath=function(){n.show()})}else{if(p&&p.length&&(a.svgElem=n=r.path(p).attr(d).add(),M)){for(K in e=function(b){n.on(b,function(c){M[b].apply(a,[c])})},M){e(K)}}}if(f&&t(f.text)&&p&&p.length&&b.width>0&&b.height>0){f=x({align:c&&j&&"center",x:c?!j&&4:10,verticalAlign:!c&&j&&"middle",y:c?j?16:10:j?6:-4,rotation:c&&!j&&90},f);if(!g){a.label=g=r.text(f.text,0,0,f.useHTML).attr({align:f.textAlign||f.align,rotation:f.rotation,zIndex:w}).css(f.style).add()}b=[p[1],p[4],o(p[6],p[1])];p=[p[2],p[5],o(p[7],p[2])];c=Qa(b);j=Qa(p);g.align(f,!1,{x:c,y:j,width:ta(b)-c,height:ta(p)-j});g.show()}else{g&&g.hide()}return a},destroy:function(){la(this.axis.plotLinesAndBands,this);delete this.axis;Ca(this)}};Ub.prototype={destroy:function(){Ca(this,this.axis)},setTotal:function(a){this.cum=this.total=a},addValue:function(a){this.setTotal(oa(this.total+a))},render:function(a){var b=this.options,c=b.format,c=c?Ma(c,this):b.formatter.call(this);this.label?this.label.attr({text:c,visibility:"hidden"}):this.label=this.axis.chart.renderer.text(c,0,0,b.useHTML).css(b.style).attr({align:this.textAlign,rotation:b.rotation,visibility:"hidden"}).add(a)},cacheExtremes:function(a,b){this.points[a.index]=b},setOffset:function(a,b){var c=this.axis,d=c.chart,e=d.inverted,f=this.isNegative,g=c.translate(this.percent?100:this.total,0,0,0,1),c=c.translate(0),c=T(g-c),h=d.xAxis[0].translate(this.x)+a,i=d.plotHeight,f={x:e?f?g:g-c:h,y:e?i-h-b:f?i-g-c:i-g,width:e?c:b,height:e?b:c};if(e=this.label){e.align(this.alignOptions,null,f),f=e.alignAttr,e.attr({visibility:this.options.crop===!1||d.isInsidePlot(f.x,f.y)?ea?"inherit":"visible":"hidden"})}}};ua.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#C0C0C0",labels:I,lineColor:"#C0D0E0",lineWidth:1,minPadding:0.01,maxPadding:0.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#4d759e",fontWeight:"bold"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{x:-8,y:3},lineWidth:0,maxPadding:0.05,minPadding:0.05,startOnTick:!0,tickWidth:0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return za(this.total,-1)},style:I.style}},defaultLeftAxisOptions:{labels:{x:-8,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{x:8,y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{x:0,y:14},title:{rotation:0}},defaultTopAxisOptions:{labels:{x:0,y:-5},title:{rotation:0}},init:function(a,b){var c=b.isX;this.horiz=a.inverted?!c:c;this.xOrY=(this.isXAxis=c)?"x":"y";this.opposite=b.opposite;this.side=this.horiz?this.opposite?0:2:this.opposite?1:3;this.setOptions(b);var d=this.options,e=d.type;this.labelFormatter=d.labels.formatter||this.defaultLabelFormatter;this.userOptions=b;this.minPixelPadding=0;this.chart=a;this.reversed=d.reversed;this.zoomEnabled=d.zoomEnabled!==!1;this.categories=d.categories||e==="category";this.isLog=e==="logarithmic";this.isDatetimeAxis=e==="datetime";this.isLinked=t(d.linkedTo);this.tickmarkOffset=this.categories&&d.tickmarkPlacement==="between"?0.5:0;this.ticks={};this.minorTicks={};this.plotLinesAndBands=[];this.alternateBands={};this.len=0;this.minRange=this.userMinRange=d.minRange||d.maxZoom;this.range=d.range;this.offset=d.offset||0;this.stacks={};this.oldStacks={};this.stacksMax={};this._stacksTouched=0;this.min=this.max=null;var f,d=this.options.events;va(this,a.axes)===-1&&(a.axes.push(this),a[c?"xAxis":"yAxis"].push(this));this.series=this.series||[];if(a.inverted&&c&&this.reversed===r){this.reversed=!0}this.removePlotLine=this.removePlotBand=this.removePlotBandOrLine;for(f in d){E(this,f,d[f])}if(this.isLog){this.val2lin=sa,this.lin2val=ka}},setOptions:function(a){this.options=x(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],x(N[this.isXAxis?"xAxis":"yAxis"],a))},update:function(a,b){var c=this.chart,a=c.options[this.xOrY+"Axis"][this.options.index]=x(this.userOptions,a);this.destroy(!0);this._addedPlotLB=!1;this.init(c,v(a,{events:r}));c.isDirtyBox=!0;o(b,!0)&&c.redraw()},remove:function(a){var b=this.chart,c=this.xOrY+"Axis";q(this.series,function(a){a.remove(!1)});la(b.axes,this);la(b[c],this);b.options[c].splice(this.options.index,1);q(b[c],function(a,b){a.options.index=b});this.destroy();b.isDirtyBox=!0;o(a,!0)&&b.redraw()},defaultLabelFormatter:function(){var a=this.axis,b=this.value,c=a.categories,d=this.dateTimeLabelFormat,e=N.lang.numericSymbols,f=e&&e.length,g,h=a.options.labels.format,a=a.isLog?b:a.tickInterval;if(h){g=Ma(h,this)}else{if(c){g=b}else{if(d){g=Aa(d,b)}else{if(f&&a>=1000){for(;f--&&g===r;){c=Math.pow(1000,f+1),a>=c&&e[f]!==null&&(g=za(b/c,-1)+e[f])}}}}}g===r&&(g=b>=1000?za(b,0):za(b,-1));return g},getSeriesExtremes:function(){var a=this,b=a.chart;a.hasVisibleSeries=!1;a.dataMin=a.dataMax=null;a.stacksMax={};a.buildStacks();q(a.series,function(c){if(c.visible||!b.options.chart.ignoreHiddenSeries){var d=c.options,e;e=d.threshold;a.hasVisibleSeries=!0;a.isLog&&e<=0&&(e=null);if(a.isXAxis){if(e=c.xData,e.length){a.dataMin=D(o(a.dataMin,e[0]),Qa(e)),a.dataMax=u(o(a.dataMax,e[0]),ta(e))}}else{d=d.stacking;a.usePercentage=d==="percent";if(a.usePercentage){a.dataMin=0,a.dataMax=99}c.getExtremes();d=c.dataMax;c=c.dataMin;if(!a.usePercentage&&t(c)&&t(d)){a.dataMin=D(o(a.dataMin,c),c),a.dataMax=u(o(a.dataMax,d),d)}if(t(e)){if(a.dataMin>=e){a.dataMin=e,a.ignoreMinPadding=!0}else{if(a.dataMax<e){a.dataMax=e,a.ignoreMaxPadding=!0}}}}}})},translate:function(a,b,c,d,e,f){var g=this.len,h=1,i=0,k=d?this.oldTransA:this.transA,d=d?this.oldMin:this.min,j=this.minPixelPadding,e=(this.options.ordinal||this.isLog&&e)&&this.lin2val;if(!k){k=this.transA}c&&(h*=-1,i=g);this.reversed&&(h*=-1,i-=h*g);b?(a=a*h+i,a-=j,a=a/k+d,e&&(a=this.lin2val(a))):(e&&(a=this.val2lin(a)),f==="between"&&(f=0.5),a=h*(a-d)*k+i+h*j+(ra(f)?k*f*this.pointRange:0));return a},toPixels:function(a,b){return this.translate(a,!1,!this.horiz,null,!0)+(b?0:this.pos)},toValue:function(a,b){return this.translate(a-(b?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(a,b,c,d){var e=this.chart,f=this.left,g=this.top,h,i,k,a=this.translate(a,null,null,c),j=c&&e.oldChartHeight||e.chartHeight,l=c&&e.oldChartWidth||e.chartWidth,m;h=this.transB;c=i=s(a+h);h=k=s(j-a-h);if(isNaN(a)){m=!0}else{if(this.horiz){if(h=g,k=j-this.bottom,c<f||c>f+this.width){m=!0}}else{if(c=f,i=l-this.right,h<g||h>g+this.height){m=!0}}}return m&&!d?null:e.renderer.crispLine(["M",c,h,"L",i,k],b||0)},getPlotBandPath:function(a,b){var c=this.getPlotLinePath(b),d=this.getPlotLinePath(a);d&&c?d.push(c[4],c[5],c[1],c[2]):d=null;return d},getLinearTickPositions:function(a,b,c){for(var d,b=oa(U(b/a)*a),c=oa(pa(c/a)*a),e=[];b<=c;){e.push(b);b=oa(b+a);if(b===d){break}d=b}return e},getLogTickPositions:function(a,b,c,d){var e=this.options,f=this.len,g=[];if(!d){this._minorAutoInterval=null}if(a>=0.5){a=s(a),g=this.getLinearTickPositions(a,b,c)}else{if(a>=0.08){for(var f=U(b),h,i,k,j,l,e=a>0.3?[1,2,4]:a>0.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9];f<c+1&&!l;f++){i=e.length;for(h=0;h<i&&!l;h++){k=sa(ka(f)*e[h]),k>b&&(!d||j<=c)&&g.push(j),j>c&&(l=!0),j=k}}}else{if(b=ka(b),c=ka(c),a=e[d?"minorTickInterval":"tickInterval"],a=o(a==="auto"?null:a,this._minorAutoInterval,(c-b)*(e.tickPixelInterval/(d?5:1))/((d?f/this.tickPositions.length:f)||1)),a=yb(a,null,xb(a)),g=Ga(this.getLinearTickPositions(a,b,c),sa),!d){this._minorAutoInterval=a/5}}}if(!d){this.tickInterval=a}return g},getMinorTickPositions:function(){var a=this.options,b=this.tickPositions,c=this.minorTickInterval,d=[],e;if(this.isLog){e=b.length;for(a=1;a<e;a++){d=d.concat(this.getLogTickPositions(c,b[a-1],b[a],!0))}}else{if(this.isDatetimeAxis&&a.minorTickInterval==="auto"){d=d.concat(fb(zb(c),this.min,this.max,a.startOfWeek)),d[0]<this.min&&d.shift()}else{for(b=this.min+(b[0]-this.min)%c;b<=this.max;b+=c){d.push(b)}}}return d},adjustForMinRange:function(){var a=this.options,b=this.min,c=this.max,d,e=this.dataMax-this.dataMin>=this.minRange,f,g,h,i,k;if(this.isXAxis&&this.minRange===r&&!this.isLog){t(a.min)||t(a.max)?this.minRange=null:(q(this.series,function(a){i=a.xData;for(g=k=a.xIncrement?1:i.length-1;g>0;g--){if(h=i[g]-i[g-1],f===r||h<f){f=h}}}),this.minRange=D(f*5,this.dataMax-this.dataMin))}if(c-b<this.minRange){var j=this.minRange;d=(j-c+b)/2;d=[b-d,o(a.min,b-d)];if(e){d[2]=this.dataMin}b=ta(d);c=[b+j,o(a.max,b+j)];if(e){c[2]=this.dataMax}c=Qa(c);c-b<j&&(d[0]=c-j,d[1]=o(a.min,c-j),b=ta(d))}this.min=b;this.max=c},setAxisTranslation:function(a){var b=this.max-this.min,c=0,d,e=0,f=0,g=this.linkedParent,h=this.transA;if(this.isXAxis){g?(e=g.minPointOffset,f=g.pointRangePadding):q(this.series,function(a){var g=a.pointRange,h=a.options.pointPlacement,l=a.closestPointRange;g>b&&(g=0);c=u(c,g);e=u(e,ja(h)?0:g/2);f=u(f,h==="on"?0:g);!a.noSharedTooltip&&t(l)&&(d=t(d)?D(d,l):l)}),g=this.ordinalSlope&&d?this.ordinalSlope/d:1,this.minPointOffset=e*=g,this.pointRangePadding=f*=g,this.pointRange=D(c,b),this.closestPointRange=d}if(a){this.oldTransA=h}this.translationSlope=this.transA=h=this.len/(b+f||1);this.transB=this.horiz?this.left:this.bottom;this.minPixelPadding=h*e},setTickPositions:function(a){var b=this,c=b.chart,d=b.options,e=b.isLog,f=b.isDatetimeAxis,g=b.isXAxis,h=b.isLinked,i=b.options.tickPositioner,k=d.maxPadding,j=d.minPadding,l=d.tickInterval,m=d.minTickInterval,n=d.tickPixelInterval,p=b.categories;h?(b.linkedParent=c[g?"xAxis":"yAxis"][d.linkedTo],c=b.linkedParent.getExtremes(),b.min=o(c.min,c.dataMin),b.max=o(c.max,c.dataMax),d.type!==b.linkedParent.options.type&&Da(11,1)):(b.min=o(b.userMin,d.min,b.dataMin),b.max=o(b.userMax,d.max,b.dataMax));if(e){!a&&D(b.min,o(b.dataMin,b.min))<=0&&Da(10,1),b.min=oa(sa(b.min)),b.max=oa(sa(b.max))}if(b.range&&(b.userMin=b.min=u(b.min,b.max-b.range),b.userMax=b.max,a)){b.range=null}b.beforePadding&&b.beforePadding();b.adjustForMinRange();if(!p&&!b.usePercentage&&!h&&t(b.min)&&t(b.max)&&(c=b.max-b.min)){if(!t(d.min)&&!t(b.userMin)&&j&&(b.dataMin<0||!b.ignoreMinPadding)){b.min-=c*j}if(!t(d.max)&&!t(b.userMax)&&k&&(b.dataMax>0||!b.ignoreMaxPadding)){b.max+=c*k}}b.tickInterval=b.min===b.max||b.min===void 0||b.max===void 0?1:h&&!l&&n===b.linkedParent.options.tickPixelInterval?b.linkedParent.tickInterval:o(l,p?1:(b.max-b.min)*n/(b.len||1));g&&!a&&q(b.series,function(a){a.processData(b.min!==b.oldMin||b.max!==b.oldMax)});b.setAxisTranslation(!0);b.beforeSetTickPositions&&b.beforeSetTickPositions();if(b.postProcessTickInterval){b.tickInterval=b.postProcessTickInterval(b.tickInterval)}if(b.pointRange){b.tickInterval=u(b.pointRange,b.tickInterval)}if(!l&&b.tickInterval<m){b.tickInterval=m}if(!f&&!e&&!l){b.tickInterval=yb(b.tickInterval,null,xb(b.tickInterval),d)}b.minorTickInterval=d.minorTickInterval==="auto"&&b.tickInterval?b.tickInterval/5:d.minorTickInterval;b.tickPositions=a=d.tickPositions?[].concat(d.tickPositions):i&&i.apply(b,[b.min,b.max]);if(!a){a=f?(b.getNonLinearTimeTicks||fb)(zb(b.tickInterval,d.units),b.min,b.max,d.startOfWeek,b.ordinalPositions,b.closestPointRange,!0):e?b.getLogTickPositions(b.tickInterval,b.min,b.max):b.getLinearTickPositions(b.tickInterval,b.min,b.max),b.tickPositions=a}if(!h){e=a[0],f=a[a.length-1],h=b.minPointOffset||0,d.startOnTick?b.min=e:b.min-h>e&&a.shift(),d.endOnTick?b.max=f:b.max+h<f&&a.pop(),a.length===1&&(b.min-=0.001,b.max+=0.001)}},setMaxTicks:function(){var a=this.chart,b=a.maxTicks||{},c=this.tickPositions,d=this._maxTicksKey=[this.xOrY,this.pos,this.len].join("-");if(!this.isLinked&&!this.isDatetimeAxis&&c&&c.length>(b[d]||0)&&this.options.alignTicks!==!1){b[d]=c.length}a.maxTicks=b},adjustTickAmount:function(){var a=this._maxTicksKey,b=this.tickPositions,c=this.chart.maxTicks;if(c&&c[a]&&!this.isDatetimeAxis&&!this.categories&&!this.isLinked&&this.options.alignTicks!==!1){var d=this.tickAmount,e=b.length;this.tickAmount=a=c[a];if(e<a){for(;b.length<a;){b.push(oa(b[b.length-1]+this.tickInterval))}this.transA*=(e-1)/(a-1);this.max=b[b.length-1]}if(t(d)&&a!==d){this.isDirty=!0}}},setScale:function(){var a=this.stacks,b,c,d,e;this.oldMin=this.min;this.oldMax=this.max;this.oldAxisLength=this.len;this.setAxisSize();e=this.len!==this.oldAxisLength;q(this.series,function(a){if(a.isDirtyData||a.isDirty||a.xAxis.isDirty){d=!0}});if(e||d||this.isLinked||this.forceRedraw||this.userMin!==this.oldUserMin||this.userMax!==this.oldUserMax){if(!this.isXAxis){for(b in a){for(c in a[b]){a[b][c].total=null}}}this.forceRedraw=!1;this.getSeriesExtremes();this.setTickPositions();this.oldUserMin=this.userMin;this.oldUserMax=this.userMax;if(!this.isDirty){this.isDirty=e||this.min!==this.oldMin||this.max!==this.oldMax}}else{if(!this.isXAxis){if(this.oldStacks){a=this.stacks=this.oldStacks}for(b in a){for(c in a[b]){a[b][c].cum=a[b][c].total}}}}this.setMaxTicks()},setExtremes:function(a,b,c,d,e){var f=this,g=f.chart,c=o(c,!0),e=v(e,{min:a,max:b});B(f,"setExtremes",e,function(){f.userMin=a;f.userMax=b;f.isDirtyExtremes=!0;c&&g.redraw(d)})},zoom:function(a,b){this.allowZoomOutside||(t(this.dataMin)&&a<=this.dataMin&&(a=r),t(this.dataMax)&&b>=this.dataMax&&(b=r));this.displayBtn=a!==r||b!==r;this.setExtremes(a,b,!1,r,{trigger:"zoom"});return !0},setAxisSize:function(){var a=this.chart,b=this.options,c=b.offsetLeft||0,d=b.offsetRight||0,e=this.horiz,f,g;this.left=g=o(b.left,a.plotLeft+c);this.top=f=o(b.top,a.plotTop);this.width=c=o(b.width,a.plotWidth-c+d);this.height=b=o(b.height,a.plotHeight);this.bottom=a.chartHeight-b-f;this.right=a.chartWidth-c-g;this.len=u(e?c:b,0);this.pos=e?g:f},getExtremes:function(){var a=this.isLog;return{min:a?oa(ka(this.min)):this.min,max:a?oa(ka(this.max)):this.max,dataMin:this.dataMin,dataMax:this.dataMax,userMin:this.userMin,userMax:this.userMax}},getThreshold:function(a){var b=this.isLog,c=b?ka(this.min):this.min,b=b?ka(this.max):this.max;c>a||a===null?a=c:b<a&&(a=b);return this.translate(a,0,1,0,1)},addPlotBand:function(a){this.addPlotBandOrLine(a,"plotBands")},addPlotLine:function(a){this.addPlotBandOrLine(a,"plotLines")},addPlotBandOrLine:function(a,b){var c=(new Fb(this,a)).render(),d=this.userOptions;b&&(d[b]=d[b]||[],d[b].push(a));this.plotLinesAndBands.push(c);return c},autoLabelAlign:function(a){a=(o(a,0)-this.side*90+720)%360;return a>15&&a<165?"right":a>195&&a<345?"left":"center"},getOffset:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.tickPositions,f=a.ticks,g=a.horiz,h=a.side,i=b.inverted?[1,0,3,2][h]:h,k,j=0,l,m=0,n=d.title,p=d.labels,K=0,y=b.axisOffset,w=b.clipOffset,M=[-1,1,1,-1][h],s,x=1,v=o(p.maxStaggerLines,5),A,O,xa,J;a.hasData=k=a.hasVisibleSeries||t(a.min)&&t(a.max)&&!!e;a.showAxis=b=k||o(d.showEmpty,!0);a.staggerLines=a.horiz&&p.staggerLines;if(!a.axisGroup){a.gridGroup=c.g("grid").attr({zIndex:d.gridZIndex||1}).add(),a.axisGroup=c.g("axis").attr({zIndex:d.zIndex||2}).add(),a.labelGroup=c.g("axis-labels").attr({zIndex:p.zIndex||7}).add()}if(k||a.isLinked){a.labelAlign=o(p.align||a.autoLabelAlign(p.rotation));q(e,function(b){f[b]?f[b].addLabel():f[b]=new $a(a,b)});if(a.horiz&&!a.staggerLines&&v&&!p.rotation){for(s=a.reversed?[].concat(e).reverse():e;x<v;){k=[];A=!1;for(p=0;p<s.length;p++){O=s[p],xa=(xa=f[O].label&&f[O].label.bBox)?xa.width:0,J=p%x,xa&&(O=a.translate(O),k[J]!==r&&O<k[J]&&(A=!0),k[J]=O+xa)}if(A){x++}else{break}}if(x>1){a.staggerLines=x}}q(e,function(b){if(h===0||h===2||{1:"left",3:"right"}[h]===a.labelAlign){K=u(f[b].getLabelSize(),K)}});if(a.staggerLines){K*=a.staggerLines,a.labelOffset=K}}else{for(s in f){f[s].destroy(),delete f[s]}}if(n&&n.text&&n.enabled!==!1){if(!a.axisTitle){a.axisTitle=c.text(n.text,0,0,n.useHTML).attr({zIndex:7,rotation:n.rotation||0,align:n.textAlign||{low:"left",middle:"center",high:"right"}[n.align]}).css(n.style).add(a.axisGroup),a.axisTitle.isNew=!0}if(b){j=a.axisTitle.getBBox()[g?"height":"width"],m=o(n.margin,g?5:10),l=n.offset}a.axisTitle[b?"show":"hide"]()}a.offset=M*o(d.offset,y[h]);a.axisTitleMargin=o(l,K+m+(h!==2&&K&&M*d.labels[g?"y":"x"]));y[h]=u(y[h],a.axisTitleMargin+j+M*a.offset);w[i]=u(w[i],d.lineWidth)},getLinePath:function(a){var b=this.chart,c=this.opposite,d=this.offset,e=this.horiz,f=this.left+(c?this.width:0)+d;this.lineTop=d=b.chartHeight-this.bottom-(c?this.height:0)+d;c||(a*=-1);return b.renderer.crispLine(["M",e?this.left:f,e?d:this.top,"L",e?b.chartWidth-this.right:f,e?d:b.chartHeight-this.bottom],a)},getTitlePosition:function(){var a=this.horiz,b=this.left,c=this.top,d=this.len,e=this.options.title,f=a?b:c,g=this.opposite,h=this.offset,i=z(e.style.fontSize||12),d={low:f+(a?0:d),middle:f+d/2,high:f+(a?d:0)}[e.align],b=(a?c+this.height:b)+(a?1:-1)*(g?-1:1)*this.axisTitleMargin+(this.side===2?i:0);return{x:a?d:b+(g?this.width:0)+h+(e.x||0),y:a?b-(g?this.height:0)+h:d+(e.y||0)}},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.options,e=a.isLog,f=a.isLinked,g=a.tickPositions,h=a.axisTitle,i=a.stacks,k=a.ticks,j=a.minorTicks,l=a.alternateBands,m=d.stackLabels,n=d.alternateGridColor,p=a.tickmarkOffset,o=d.lineWidth,y,w=b.hasRendered&&t(a.oldMin)&&!isNaN(a.oldMin);y=a.hasData;var M=a.showAxis,s,u;q([k,j,l],function(a){for(var b in a){a[b].isActive=!1}});if(y||f){if(a.minorTickInterval&&!a.categories&&q(a.getMinorTickPositions(),function(b){j[b]||(j[b]=new $a(a,b,"minor"));w&&j[b].isNew&&j[b].render(null,!0);j[b].render(null,!1,1)}),g.length&&(q(g.slice(1).concat([g[0]]),function(b,c){c=c===g.length-1?0:c+1;if(!f||b>=a.min&&b<=a.max){k[b]||(k[b]=new $a(a,b)),w&&k[b].isNew&&k[b].render(c,!0),k[b].render(c,!1,1)}}),p&&a.min===0&&(k[-1]||(k[-1]=new $a(a,-1,null,!0)),k[-1].render(-1))),n&&q(g,function(b,c){if(c%2===0&&b<a.max){l[b]||(l[b]=new Fb(a)),s=b+p,u=g[c+1]!==r?g[c+1]+p:a.max,l[b].options={from:e?ka(s):s,to:e?ka(u):u,color:n},l[b].render(),l[b].isActive=!0}}),!a._addedPlotLB){q((d.plotLines||[]).concat(d.plotBands||[]),function(b){a.addPlotBandOrLine(b)}),a._addedPlotLB=!0}}q([k,j,l],function(a){var c,d,e=[],f=Sa?Sa.duration||500:0,g=function(){for(d=e.length;d--;){a[e[d]]&&!a[e[d]].isActive&&(a[e[d]].destroy(),delete a[e[d]])}};for(c in a){if(!a[c].isActive){a[c].render(c,!1,0),a[c].isActive=!1,e.push(c)}}a===l||!b.hasRendered||!f?g():f&&setTimeout(g,f)});if(o){y=a.getLinePath(o),a.axisLine?a.axisLine.animate({d:y}):a.axisLine=c.path(y).attr({stroke:d.lineColor,"stroke-width":o,zIndex:7}).add(a.axisGroup),a.axisLine[M?"show":"hide"]()}if(h&&M){h[h.isNew?"attr":"animate"](a.getTitlePosition()),h.isNew=!1}if(m&&m.enabled){var x,A,d=a.stackTotalGroup;if(!d){a.stackTotalGroup=d=c.g("stack-labels").attr({visibility:"visible",zIndex:6}).add()}d.translate(b.plotLeft,b.plotTop);for(x in i){for(A in c=i[x],c){c[A].render(d)}}}a.isDirty=!1},removePlotBandOrLine:function(a){for(var b=this.plotLinesAndBands,c=this.options,d=this.userOptions,e=b.length;e--;){b[e].id===a&&b[e].destroy()}q([c.plotLines||[],d.plotLines||[],c.plotBands||[],d.plotBands||[]],function(b){for(e=b.length;e--;){b[e].id===a&&la(b,b[e])}})},setTitle:function(a,b){this.update({title:a},b)},redraw:function(){var a=this.chart.pointer;a.reset&&a.reset(!0);this.render();q(this.plotLinesAndBands,function(a){a.render()});q(this.series,function(a){a.isDirty=!0})},buildStacks:function(){this.isXAxis||q(this.series,function(a){a.setStackedPoints()})},setCategories:function(a,b){this.update({categories:a},b)},destroy:function(a){var b=this,c=b.stacks,d,e=b.plotLinesAndBands;a||V(b);for(d in c){Ca(c[d]),c[d]=null}q([b.ticks,b.minorTicks,b.alternateBands],function(a){Ca(a)});for(a=e.length;a--;){e[a].destroy()}q("stackTotalGroup,axisLine,axisGroup,gridGroup,labelGroup,axisTitle".split(","),function(a){b[a]&&(b[a]=b[a].destroy())})}};Gb.prototype={init:function(a,b){var c=b.borderWidth,d=b.style,e=z(d.padding);this.chart=a;this.options=b;this.crosshairs=[];this.now={x:0,y:0};this.isHidden=!0;this.label=a.renderer.label("",0,0,b.shape,null,null,b.useHTML,null,"tooltip").attr({padding:e,fill:b.backgroundColor,"stroke-width":c,r:b.borderRadius,zIndex:8}).css(d).css({padding:0}).hide().add();ga||this.label.shadow(b.shadow);this.shared=b.shared},destroy:function(){q(this.crosshairs,function(a){a&&a.destroy()});if(this.label){this.label=this.label.destroy()}clearTimeout(this.hideTimer);clearTimeout(this.tooltipTimeout)},move:function(a,b,c,d){var e=this,f=e.now,g=e.options.animation!==!1&&!e.isHidden;v(f,{x:g?(2*f.x+a)/3:a,y:g?(f.y+b)/2:b,anchorX:g?(2*f.anchorX+c)/3:c,anchorY:g?(f.anchorY+d)/2:d});e.label.attr(f);if(g&&(T(a-f.x)>1||T(b-f.y)>1)){clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){e&&e.move(a,b,c,d)},32)}},hide:function(){var a=this,b;clearTimeout(this.hideTimer);if(!this.isHidden){b=this.chart.hoverPoints,this.hideTimer=setTimeout(function(){a.label.fadeOut();a.isHidden=!0},o(this.options.hideDelay,500)),b&&q(b,function(a){a.setState()}),this.chart.hoverPoints=null}},hideCrosshairs:function(){q(this.crosshairs,function(a){a&&a.hide()})},getAnchor:function(a,b){var c,d=this.chart,e=d.inverted,f=d.plotTop,g=0,h=0,i,a=ha(a);c=a[0].tooltipPos;this.followPointer&&b&&(b.chartX===r&&(b=d.pointer.normalize(b)),c=[b.chartX-d.plotLeft,b.chartY-f]);c||(q(a,function(a){i=a.series.yAxis;g+=a.plotX;h+=(a.plotLow?(a.plotLow+a.plotHigh)/2:a.plotY)+(!e&&i?i.top-f:0)}),g/=a.length,h/=a.length,c=[e?d.plotWidth-h:g,this.shared&&!e&&a.length>1&&b?b.chartY-f:e?d.plotHeight-g:h]);return Ga(c,s)},getPosition:function(a,b,c){var d=this.chart,e=d.plotLeft,f=d.plotTop,g=d.plotWidth,h=d.plotHeight,i=o(this.options.distance,12),k=c.plotX,c=c.plotY,d=k+e+(d.inverted?i:-a-i),j=c-b+f+15,l;d<7&&(d=e+u(k,0)+i);d+a>e+g&&(d-=d+a-(e+g),j=c-b+f-i,l=!0);j<f+5&&(j=f+5,l&&c>=j&&c<=j+b&&(j=c+f+i));j+b>f+h&&(j=u(f,f+h-b-i));return{x:d,y:j}},defaultFormatter:function(a){var b=this.points||ha(this),c=b[0].series,d;d=[c.tooltipHeaderFormatter(b[0])];q(b,function(a){c=a.series;d.push(c.tooltipFormatter&&c.tooltipFormatter(a)||a.point.tooltipFormatter(c.tooltipOptions.pointFormat))});d.push(a.options.footerFormat||"");return d.join("")},refresh:function(a,b){var c=this.chart,d=this.label,e=this.options,f,g,h,i={},k,j=[];k=e.formatter||this.defaultFormatter;var i=c.hoverPoints,l,m=e.crosshairs;h=this.shared;clearTimeout(this.hideTimer);this.followPointer=ha(a)[0].series.tooltipOptions.followPointer;g=this.getAnchor(a,b);f=g[0];g=g[1];h&&(!a.series||!a.series.noSharedTooltip)?(c.hoverPoints=a,i&&q(i,function(a){a.setState()}),q(a,function(a){a.setState("hover");j.push(a.getLabelConfig())}),i={x:a[0].category,y:a[0].y},i.points=j,a=a[0]):i=a.getLabelConfig();k=k.call(i,this);i=a.series;h=h||!i.isCartesian||i.tooltipOutsidePlot||c.isInsidePlot(f,g);k===!1||!h?this.hide():(this.isHidden&&(jb(d),d.attr("opacity",1).show()),d.attr({text:k}),l=e.borderColor||a.color||i.color||"#606060",d.attr({stroke:l}),this.updatePosition({plotX:f,plotY:g}),this.isHidden=!1);if(m){m=ha(m);for(d=m.length;d--;){if(i=a.series,e=i[d?"yAxis":"xAxis"],m[d]&&e){if(h=d?o(a.stackY,a.y):a.x,e.isLog&&(h=sa(h)),i.modifyValue&&(h=i.modifyValue(h)),e=e.getPlotLinePath(h,1),this.crosshairs[d]){this.crosshairs[d].attr({d:e,visibility:"visible"})}else{h={"stroke-width":m[d].width||1,stroke:m[d].color||"#C0C0C0",zIndex:m[d].zIndex||2};if(m[d].dashStyle){h.dashstyle=m[d].dashStyle}this.crosshairs[d]=c.renderer.path(e).attr(h).add()}}}}B(c,"tooltipRefresh",{text:k,x:f+c.plotLeft,y:g+c.plotTop,borderColor:l})},updatePosition:function(a){var b=this.chart,c=this.label,c=(this.options.positioner||this.getPosition).call(this,c.width,c.height,a);this.move(s(c.x),s(c.y),a.plotX+b.plotLeft,a.plotY+b.plotTop)}};rb.prototype={init:function(a,b){var c=ga?"":b.chart.zoomType,d=a.inverted,e;this.options=b;this.chart=a;this.zoomX=e=/x/.test(c);this.zoomY=c=/y/.test(c);this.zoomHor=e&&!d||c&&d;this.zoomVert=c&&!d||e&&d;this.pinchDown=[];this.lastValidTouch={};if(b.tooltip.enabled){a.tooltip=new Gb(a,b.tooltip)}this.setDOMEvents()},normalize:function(a){var b,c,a=a||X.event;if(!a.target){a.target=a.srcElement}a=Zb(a);c=a.touches?a.touches.item(0):a;this.chartPosition=b=ec(this.chart.container);return v(a,{chartX:s(o(c.pageX,c.clientX)-b.left),chartY:s(o(c.pageY,c.clientY)-b.top)})},getCoordinates:function(a){var b={xAxis:[],yAxis:[]};q(this.chart.axes,function(c){b[c.isXAxis?"xAxis":"yAxis"].push({axis:c,value:c.toValue(a[c.horiz?"chartX":"chartY"])})});return b},getIndex:function(a){var b=this.chart;return b.inverted?b.plotHeight+b.plotTop-a.chartY:a.chartX-b.plotLeft},runPointActions:function(a){var b=this.chart,c=b.series,d=b.tooltip,e,f=b.hoverPoint,g=b.hoverSeries,h,i,k=b.chartWidth,j=this.getIndex(a);if(d&&this.options.tooltip.shared&&(!g||!g.noSharedTooltip)){e=[];h=c.length;for(i=0;i<h;i++){if(c[i].visible&&c[i].options.enableMouseTracking!==!1&&!c[i].noSharedTooltip&&c[i].tooltipPoints.length&&(b=c[i].tooltipPoints[j],b.series)){b._dist=T(j-b.clientX),k=D(k,b._dist),e.push(b)}}for(h=e.length;h--;){e[h]._dist>k&&e.splice(h,1)}if(e.length&&e[0].clientX!==this.hoverX){d.refresh(e,a),this.hoverX=e[0].clientX}}if(g&&g.tracker){if((b=g.tooltipPoints[j])&&b!==f){b.onMouseOver(a)}}else{d&&d.followPointer&&!d.isHidden&&(a=d.getAnchor([{}],a),d.updatePosition({plotX:a[0],plotY:a[1]}))}},reset:function(a){var b=this.chart,c=b.hoverSeries,d=b.hoverPoint,e=b.tooltip,b=e&&e.shared?b.hoverPoints:d;(a=a&&e&&b)&&ha(b)[0].plotX===r&&(a=!1);if(a){e.refresh(b)}else{if(d){d.onMouseOut()}if(c){c.onMouseOut()}e&&(e.hide(),e.hideCrosshairs());this.hoverX=null}},scaleGroups:function(a,b){var c=this.chart,d;q(c.series,function(e){d=a||e.getPlotBox();e.xAxis&&e.xAxis.zoomEnabled&&(e.group.attr(d),e.markerGroup&&(e.markerGroup.attr(d),e.markerGroup.clip(b?c.clipRect:null)),e.dataLabelsGroup&&e.dataLabelsGroup.attr(d))});c.clipRect.attr(b||c.clipBox)},pinchTranslateDirection:function(a,b,c,d,e,f,g){var h=this.chart,i=a?"x":"y",k=a?"X":"Y",j="chart"+k,l=a?"width":"height",m=h["plot"+(a?"Left":"Top")],n,p,o=1,q=h.inverted,w=h.bounds[a?"h":"v"],M=b.length===1,s=b[0][j],u=c[0][j],r=!M&&b[1][j],A=!M&&c[1][j],t,c=function(){!M&&T(s-r)>20&&(o=T(u-A)/T(s-r));p=(m-u)/o+s;n=h["plot"+(a?"Width":"Height")]/o};c();b=p;b<w.min?(b=w.min,t=!0):b+n>w.max&&(b=w.max-n,t=!0);t?(u-=0.8*(u-g[i][0]),M||(A-=0.8*(A-g[i][1])),c()):g[i]=[u,A];q||(f[i]=p-m,f[l]=n);f=q?1/o:o;e[l]=n;e[i]=b;d[q?a?"scaleY":"scaleX":"scale"+k]=o;d["translate"+k]=f*m+(u-f*s)},pinch:function(a){var b=this,c=b.chart,d=b.pinchDown,e=c.tooltip&&c.tooltip.options.followTouchMove,f=a.touches,g=f.length,h=b.lastValidTouch,i=b.zoomHor||b.pinchHor,k=b.zoomVert||b.pinchVert,j=i||k,l=b.selectionMarker,m={},n={};a.type==="touchstart"&&(e||j)&&a.preventDefault();Ga(f,function(a){return b.normalize(a)});if(a.type==="touchstart"){q(f,function(a,b){d[b]={chartX:a.chartX,chartY:a.chartY}}),h.x=[d[0].chartX,d[1]&&d[1].chartX],h.y=[d[0].chartY,d[1]&&d[1].chartY],q(c.axes,function(a){if(a.zoomEnabled){var b=c.bounds[a.horiz?"h":"v"],d=a.minPixelPadding,e=a.toPixels(a.dataMin),f=a.toPixels(a.dataMax),g=D(e,f),e=u(e,f);b.min=D(a.pos,g-d);b.max=u(a.pos+a.len,e+d)}})}else{if(d.length){if(!l){b.selectionMarker=l=v({destroy:qa},c.plotBox)}i&&b.pinchTranslateDirection(!0,d,f,m,l,n,h);k&&b.pinchTranslateDirection(!1,d,f,m,l,n,h);b.hasPinched=j;b.scaleGroups(m,n);!j&&e&&g===1&&this.runPointActions(b.normalize(a))}}},dragStart:function(a){var b=this.chart;b.mouseIsDown=a.type;b.cancelClick=!1;b.mouseDownX=this.mouseDownX=a.chartX;this.mouseDownY=a.chartY},drag:function(a){var b=this.chart,c=b.options.chart,d=a.chartX,a=a.chartY,e=this.zoomHor,f=this.zoomVert,g=b.plotLeft,h=b.plotTop,i=b.plotWidth,k=b.plotHeight,j,l=this.mouseDownX,m=this.mouseDownY;d<g?d=g:d>g+i&&(d=g+i);a<h?a=h:a>h+k&&(a=h+k);this.hasDragged=Math.sqrt(Math.pow(l-d,2)+Math.pow(m-a,2));if(this.hasDragged>10){j=b.isInsidePlot(l-g,m-h);if(b.hasCartesianSeries&&(this.zoomX||this.zoomY)&&j&&!this.selectionMarker){this.selectionMarker=b.renderer.rect(g,h,e?1:i,f?1:k,0).attr({fill:c.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add()}this.selectionMarker&&e&&(e=d-l,this.selectionMarker.attr({width:T(e),x:(e>0?0:e)+l}));this.selectionMarker&&f&&(e=a-m,this.selectionMarker.attr({height:T(e),y:(e>0?0:e)+m}));j&&!this.selectionMarker&&c.panning&&b.pan(d)}},drop:function(a){var b=this.chart,c=this.hasPinched;if(this.selectionMarker){var d={xAxis:[],yAxis:[],originalEvent:a.originalEvent||a},e=this.selectionMarker,f=e.x,g=e.y,h;if(this.hasDragged||c){q(b.axes,function(a){if(a.zoomEnabled){var b=a.horiz,c=a.toValue(b?f:g),b=a.toValue(b?f+e.width:g+e.height);!isNaN(c)&&!isNaN(b)&&(d[a.xOrY+"Axis"].push({axis:a,min:D(c,b),max:u(c,b)}),h=!0)}}),h&&B(b,"selection",d,function(a){b.zoom(v(a,c?{animation:!1}:null))})}this.selectionMarker=this.selectionMarker.destroy();c&&this.scaleGroups()}if(b){F(b.container,{cursor:b._cursor}),b.cancelClick=this.hasDragged>10,b.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[]}},onContainerMouseDown:function(a){a=this.normalize(a);a.preventDefault&&a.preventDefault();this.dragStart(a)},onDocumentMouseUp:function(a){this.drop(a)},onDocumentMouseMove:function(a){var b=this.chart,c=this.chartPosition,d=b.hoverSeries,a=Zb(a);c&&d&&d.isCartesian&&!b.isInsidePlot(a.pageX-c.left-b.plotLeft,a.pageY-c.top-b.plotTop)&&this.reset()},onContainerMouseLeave:function(){this.reset();this.chartPosition=null},onContainerMouseMove:function(a){var b=this.chart,a=this.normalize(a);a.returnValue=!1;b.mouseIsDown==="mousedown"&&this.drag(a);b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)&&!b.openMenu&&this.runPointActions(a)},inClass:function(a,b){for(var c;a;){if(c=C(a,"class")){if(c.indexOf(b)!==-1){return !0}else{if(c.indexOf("highcharts-container")!==-1){return !1}}}a=a.parentNode}},onTrackerMouseOut:function(a){var b=this.chart.hoverSeries;if(b&&!b.options.stickyTracking&&!this.inClass(a.toElement||a.relatedTarget,"highcharts-tooltip")){b.onMouseOut()}},onContainerClick:function(a){var b=this.chart,c=b.hoverPoint,d=b.plotLeft,e=b.plotTop,f=b.inverted,g,h,i,a=this.normalize(a);a.cancelBubble=!0;if(!b.cancelClick){c&&this.inClass(a.target,"highcharts-tracker")?(g=this.chartPosition,h=c.plotX,i=c.plotY,v(c,{pageX:g.left+d+(f?b.plotWidth-i:h),pageY:g.top+e+(f?b.plotHeight-h:i)}),B(c.series,"click",v(a,{point:c})),b.hoverPoint&&c.firePointEvent("click",a)):(v(a,this.getCoordinates(a)),b.isInsidePlot(a.chartX-d,a.chartY-e)&&B(b,"click",a))}},onContainerTouchStart:function(a){var b=this.chart;a.touches.length===1?(a=this.normalize(a),b.isInsidePlot(a.chartX-b.plotLeft,a.chartY-b.plotTop)?(this.runPointActions(a),this.pinch(a)):this.reset()):a.touches.length===2&&this.pinch(a)},onContainerTouchMove:function(a){(a.touches.length===1||a.touches.length===2)&&this.pinch(a)},onDocumentTouchEnd:function(a){this.drop(a)},setDOMEvents:function(){var a=this,b=a.chart.container,c;this._events=c=[[b,"onmousedown","onContainerMouseDown"],[b,"onmousemove","onContainerMouseMove"],[b,"onclick","onContainerClick"],[b,"mouseleave","onContainerMouseLeave"],[G,"mousemove","onDocumentMouseMove"],[G,"mouseup","onDocumentMouseUp"]];ib&&c.push([b,"ontouchstart","onContainerTouchStart"],[b,"ontouchmove","onContainerTouchMove"],[G,"touchend","onDocumentTouchEnd"]);q(c,function(b){a["_"+b[2]]=function(c){a[b[2]](c)};b[1].indexOf("on")===0?b[0][b[1]]=a["_"+b[2]]:E(b[0],b[1],a["_"+b[2]])})},destroy:function(){var a=this;q(a._events,function(b){b[1].indexOf("on")===0?b[0][b[1]]=null:V(b[0],b[1],a["_"+b[2]])});delete a._events;clearInterval(a.tooltipTimeout)}};Hb.prototype={init:function(a,b){var c=this,d=b.itemStyle,e=o(b.padding,8),f=b.itemMarginTop||0;this.options=b;if(b.enabled){c.baseline=z(d.fontSize)+3+f,c.itemStyle=d,c.itemHiddenStyle=x(d,b.itemHiddenStyle),c.itemMarginTop=f,c.padding=e,c.initialItemX=e,c.initialItemY=e-5,c.maxItemWidth=0,c.chart=a,c.itemHeight=0,c.lastLineHeight=0,c.render(),E(c.chart,"endResize",function(){c.positionCheckboxes()})}},colorizeItem:function(a,b){var c=this.options,d=a.legendItem,e=a.legendLine,f=a.legendSymbol,g=this.itemHiddenStyle.color,c=b?c.itemStyle.color:g,h=b?a.color:g,g=a.options&&a.options.marker,i={stroke:h,fill:h},k;d&&d.css({fill:c,color:c});e&&e.attr({stroke:h});if(f){if(g&&f.isMarker){for(k in g=a.convertAttribs(g),g){d=g[k],d!==r&&(i[k]=d)}}f.attr(i)}},positionItem:function(a){var b=this.options,c=b.symbolPadding,b=!b.rtl,d=a._legendItemPos,e=d[0],d=d[1],f=a.checkbox;a.legendGroup&&a.legendGroup.translate(b?e:this.legendWidth-e-2*c-4,d);if(f){f.x=e,f.y=d}},destroyItem:function(a){var b=a.checkbox;q(["legendItem","legendLine","legendSymbol","legendGroup"],function(b){a[b]&&(a[b]=a[b].destroy())});b&&Ya(a.checkbox)},destroy:function(){var a=this.group,b=this.box;if(b){this.box=b.destroy()}if(a){this.group=a.destroy()}},positionCheckboxes:function(a){var b=this.group.alignAttr,c,d=this.clipHeight||this.legendHeight;if(b){c=b.translateY,q(this.allItems,function(e){var f=e.checkbox,g;f&&(g=c+f.y+(a||0)+3,F(f,{left:b.translateX+e.legendItemWidth+f.x-20+"px",top:g+"px",display:g>c-6&&g<c+d-6?"":$}))})}},renderTitle:function(){var a=this.padding,b=this.options.title,c=0;if(b.text){if(!this.title){this.title=this.chart.renderer.label(b.text,a-3,a-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(b.style).add(this.group)}a=this.title.getBBox();c=a.height;this.offsetWidth=a.width;this.contentGroup.attr({translateY:c})}this.titleHeight=c},renderItem:function(a){var A;var b=this,c=b.chart,d=c.renderer,e=b.options,f=e.layout==="horizontal",g=e.symbolWidth,h=e.symbolPadding,i=b.itemStyle,k=b.itemHiddenStyle,j=b.padding,l=f?o(e.itemDistance,8):0,m=!e.rtl,n=e.width,p=e.itemMarginBottom||0,q=b.itemMarginTop,y=b.initialItemX,w=a.legendItem,M=a.series||a,s=M.options,r=s.showCheckbox,t=e.useHTML;if(!w&&(a.legendGroup=d.g("legend-item").attr({zIndex:1}).add(b.scrollGroup),M.drawLegendSymbol(b,a),a.legendItem=w=d.text(e.labelFormat?Ma(e.labelFormat,a):e.labelFormatter.call(a),m?g+h:-h,b.baseline,t).css(x(a.visible?i:k)).attr({align:m?"left":"right",zIndex:2}).add(a.legendGroup),(t?w:a.legendGroup).on("mouseover",function(){a.setState("hover");w.css(b.options.itemHoverStyle)}).on("mouseout",function(){w.css(a.visible?i:k);a.setState()}).on("click",function(b){var c=function(){a.setVisible()},b={browserEvent:b};a.firePointEvent?a.firePointEvent("legendItemClick",b,c):B(a,"legendItemClick",b,c)}),b.colorizeItem(a,a.visible),s&&r)){a.checkbox=Z("input",{type:"checkbox",checked:a.selected,defaultChecked:a.selected},e.itemCheckboxStyle,c.container),E(a.checkbox,"click",function(b){B(a,"checkboxClick",{checked:b.target.checked},function(){a.select()})})}d=w.getBBox();A=a.legendItemWidth=e.itemWidth||g+h+d.width+l+(r?20:0),e=A;b.itemHeight=g=d.height;if(f&&b.itemX-y+e>(n||c.chartWidth-2*j-y)){b.itemX=y,b.itemY+=q+b.lastLineHeight+p,b.lastLineHeight=0}b.maxItemWidth=u(b.maxItemWidth,e);b.lastItemY=q+b.itemY+p;b.lastLineHeight=u(g,b.lastLineHeight);a._legendItemPos=[b.itemX,b.itemY];f?b.itemX+=e:(b.itemY+=q+g+p,b.lastLineHeight=g);b.offsetWidth=n||u((f?b.itemX-y-l:e)+j,b.offsetWidth)},render:function(){var a=this,b=a.chart,c=b.renderer,d=a.group,e,f,g,h,i=a.box,k=a.options,j=a.padding,l=k.borderWidth,m=k.backgroundColor;a.itemX=a.initialItemX;a.itemY=a.initialItemY;a.offsetWidth=0;a.lastItemY=0;if(!d){a.group=d=c.g("legend").attr({zIndex:7}).add(),a.contentGroup=c.g().attr({zIndex:1}).add(d),a.scrollGroup=c.g().add(a.contentGroup)}a.renderTitle();e=[];q(b.series,function(a){var b=a.options;b.showInLegend&&!t(b.linkedTo)&&(e=e.concat(a.legendItems||(b.legendType==="point"?a.data:a)))});Sb(e,function(a,b){return(a.options&&a.options.legendIndex||0)-(b.options&&b.options.legendIndex||0)});k.reversed&&e.reverse();a.allItems=e;a.display=f=!!e.length;q(e,function(b){a.renderItem(b)});g=k.width||a.offsetWidth;h=a.lastItemY+a.lastLineHeight+a.titleHeight;h=a.handleOverflow(h);if(l||m){g+=j;h+=j;if(i){if(g>0&&h>0){i[i.isNew?"attr":"animate"](i.crisp(null,null,null,g,h)),i.isNew=!1}}else{a.box=i=c.rect(0,0,g,h,k.borderRadius,l||0).attr({stroke:k.borderColor,"stroke-width":l||0,fill:m||$}).add(d).shadow(k.shadow),i.isNew=!0}i[f?"show":"hide"]()}a.legendWidth=g;a.legendHeight=h;q(e,function(b){a.positionItem(b)});f&&d.align(v({width:g,height:h},k),!0,"spacingBox");b.isResizing||this.positionCheckboxes()},handleOverflow:function(a){var b=this,c=this.chart,d=c.renderer,e=this.options,f=e.y,f=c.spacingBox.height+(e.verticalAlign==="top"?-f:f)-this.padding,g=e.maxHeight,h=this.clipRect,i=e.navigation,k=o(i.animation,!0),j=i.arrowSize||12,l=this.nav;e.layout==="horizontal"&&(f/=2);g&&(f=D(f,g));if(a>f&&!e.useHTML){this.clipHeight=c=f-20-this.titleHeight;this.pageCount=pa(a/c);this.currentPage=o(this.currentPage,1);this.fullHeight=a;if(!h){h=b.clipRect=d.clipRect(0,0,9999,0),b.contentGroup.clip(h)}h.attr({height:c});if(!l){this.nav=l=d.g().attr({zIndex:1}).add(this.group),this.up=d.symbol("triangle",0,0,j,j).on("click",function(){b.scroll(-1,k)}).add(l),this.pager=d.text("",15,10).css(i.style).add(l),this.down=d.symbol("triangle-down",0,0,j,j).on("click",function(){b.scroll(1,k)}).add(l)}b.scroll(0);a=f}else{if(l){h.attr({height:c.chartHeight}),l.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0}}return a},scroll:function(a,b){var c=this.pageCount,d=this.currentPage+a,e=this.clipHeight,f=this.options.navigation,g=f.activeColor,h=f.inactiveColor,f=this.pager,i=this.padding;d>c&&(d=c);if(d>0){b!==r&&Za(b,this.chart),this.nav.attr({translateX:i,translateY:e+7+this.titleHeight,visibility:"visible"}),this.up.attr({fill:d===1?h:g}).css({cursor:d===1?"default":"pointer"}),f.attr({text:d+"/"+this.pageCount}),this.down.attr({x:18+this.pager.getBBox().width,fill:d===c?h:g}).css({cursor:d===c?"default":"pointer"}),e=-D(e*(d-1),this.fullHeight-e+i)+1,this.scrollGroup.animate({translateY:e}),f.attr({text:d+"/"+c}),this.currentPage=d,this.positionCheckboxes(e)}}};Ta.prototype={init:function(a,b){var c,d=a.series;a.series=null;c=x(N,a);c.series=a.series=d;var d=c.chart,e=d.margin,e=ba(e)?e:[e,e,e,e];this.optionsMarginTop=o(d.marginTop,e[0]);this.optionsMarginRight=o(d.marginRight,e[1]);this.optionsMarginBottom=o(d.marginBottom,e[2]);this.optionsMarginLeft=o(d.marginLeft,e[3]);e=d.events;this.bounds={h:{},v:{}};this.callback=b;this.isResizing=0;this.options=c;this.axes=[];this.series=[];this.hasCartesianSeries=d.showAxes;var f=this,g;f.index=Va.length;Va.push(f);d.reflow!==!1&&E(f,"load",function(){f.initReflow()});if(e){for(g in e){E(f,g,e[g])}}f.xAxis=[];f.yAxis=[];f.animation=ga?!1:o(d.animation,!0);f.pointCount=0;f.counters=new Rb;f.firstRender()},initSeries:function(a){var b=this.options.chart;(b=L[a.type||b.type||b.defaultSeriesType])||Da(17,!0);b=new b;b.init(this,a);return b},addSeries:function(a,b,c){var d,e=this;a&&(b=o(b,!0),B(e,"addSeries",{options:a},function(){d=e.initSeries(a);e.isDirtyLegend=!0;b&&e.redraw(c)}));return d},addAxis:function(a,b,c,d){var e=b?"xAxis":"yAxis",f=this.options;new ua(this,x(a,{index:this[e].length,isX:b}));f[e]=ha(f[e]||{});f[e].push(a);o(c,!0)&&this.redraw(d)},isInsidePlot:function(a,b,c){var d=c?b:a,a=c?a:b;return d>=0&&d<=this.plotWidth&&a>=0&&a<=this.plotHeight},adjustTickAmounts:function(){this.options.chart.alignTicks!==!1&&q(this.axes,function(a){a.adjustTickAmount()});this.maxTicks=null},redraw:function(a){var b=this.axes,c=this.series,d=this.pointer,e=this.legend,f=this.isDirtyLegend,g,h,i=this.isDirtyBox,k=c.length,j=k,l=this.renderer,m=l.isHidden(),n=[];Za(a,this);m&&this.cloneRenderTo();for(this.layOutTitles();j--;){if(a=c[j],a.options.stacking&&(g=!0,a.isDirty)){h=!0;break}}if(h){for(j=k;j--;){if(a=c[j],a.options.stacking){a.isDirty=!0}}}q(c,function(a){a.isDirty&&a.options.legendType==="point"&&(f=!0)});if(f&&e.options.enabled){e.render(),this.isDirtyLegend=!1}g&&this.getStacks();if(this.hasCartesianSeries){if(!this.isResizing){this.maxTicks=null,q(b,function(a){a.setScale()})}this.adjustTickAmounts();this.getMargins();q(b,function(a){if(a.isDirtyExtremes){a.isDirtyExtremes=!1,n.push(function(){B(a,"afterSetExtremes",a.getExtremes())})}if(a.isDirty||i||g){a.redraw(),i=!0}})}i&&this.drawChartBox();q(c,function(a){a.isDirty&&a.visible&&(!a.isCartesian||a.xAxis)&&a.redraw()});d&&d.reset&&d.reset(!0);l.draw();B(this,"redraw");m&&this.cloneRenderTo(!0);q(n,function(a){a.call()})},showLoading:function(a){var b=this.options,c=this.loadingDiv,d=b.loading;if(!c){this.loadingDiv=c=Z(Ra,{className:"highcharts-loading"},v(d.style,{zIndex:10,display:$}),this.container),this.loadingSpan=Z("span",null,d.labelStyle,c)}this.loadingSpan.innerHTML=a||b.lang.loading;if(!this.loadingShown){F(c,{opacity:0,display:"",left:this.plotLeft+"px",top:this.plotTop+"px",width:this.plotWidth+"px",height:this.plotHeight+"px"}),Mb(c,{opacity:d.style.opacity},{duration:d.showDuration||0}),this.loadingShown=!0}},hideLoading:function(){var a=this.options,b=this.loadingDiv;b&&Mb(b,{opacity:0},{duration:a.loading.hideDuration||100,complete:function(){F(b,{display:$})}});this.loadingShown=!1},get:function(a){var b=this.axes,c=this.series,d,e;for(d=0;d<b.length;d++){if(b[d].options.id===a){return b[d]}}for(d=0;d<c.length;d++){if(c[d].options.id===a){return c[d]}}for(d=0;d<c.length;d++){e=c[d].points||[];for(b=0;b<e.length;b++){if(e[b].id===a){return e[b]}}}return null},getAxes:function(){var a=this,b=this.options,c=b.xAxis=ha(b.xAxis||{}),b=b.yAxis=ha(b.yAxis||{});q(c,function(a,b){a.index=b;a.isX=!0});q(b,function(a,b){a.index=b});c=c.concat(b);q(c,function(b){new ua(a,b)});a.adjustTickAmounts()},getSelectedPoints:function(){var a=[];q(this.series,function(b){a=a.concat(Eb(b.points||[],function(a){return a.selected}))});return a},getSelectedSeries:function(){return Eb(this.series,function(a){return a.selected})},getStacks:function(){var a=this;q(a.yAxis,function(a){if(a.stacks&&a.hasVisibleSeries){a.oldStacks=a.stacks}});q(a.series,function(b){if(b.options.stacking&&(b.visible===!0||a.options.chart.ignoreHiddenSeries===!1)){b.stackKey=b.type+o(b.options.stack,"")}})},showResetZoom:function(){var a=this,b=N.lang,c=a.options.chart.resetZoomButton,d=c.theme,e=d.states,f=c.relativeTo==="chart"?null:"plotBox";this.resetZoomButton=a.renderer.button(b.resetZoom,null,null,function(){a.zoomOut()},d,e&&e.hover).attr({align:c.position.align,title:b.resetZoomTitle}).add().align(c.position,!1,f)},zoomOut:function(){var a=this;B(a,"selection",{resetSelection:!0},function(){a.zoom()})},zoom:function(a){var b,c=this.pointer,d=!1,e;!a||a.resetSelection?q(this.axes,function(a){b=a.zoom()}):q(a.xAxis.concat(a.yAxis),function(a){var e=a.axis,h=e.isXAxis;if(c[h?"zoomX":"zoomY"]||c[h?"pinchX":"pinchY"]){b=e.zoom(a.min,a.max),e.displayBtn&&(d=!0)}});e=this.resetZoomButton;if(d&&!e){this.showResetZoom()}else{if(!d&&ba(e)){this.resetZoomButton=e.destroy()}}b&&this.redraw(o(this.options.chart.animation,a&&a.animation,this.pointCount<100))},pan:function(a){var b=this.xAxis[0],c=this.mouseDownX,d=b.pointRange/2,e=b.getExtremes(),f=b.translate(c-a,!0)+d,c=b.translate(c+this.plotWidth-a,!0)-d;(d=this.hoverPoints)&&q(d,function(a){a.setState()});b.series.length&&f>D(e.dataMin,e.min)&&c<u(e.dataMax,e.max)&&b.setExtremes(f,c,!0,!1,{trigger:"pan"});this.mouseDownX=a;F(this.container,{cursor:"move"})},setTitle:function(a,b){var f;var c=this,d=c.options,e;e=d.title=x(d.title,a);f=d.subtitle=x(d.subtitle,b),d=f;q([["title",a,e],["subtitle",b,d]],function(a){var b=a[0],d=c[b],e=a[1],a=a[2];d&&e&&(c[b]=d=d.destroy());a&&a.text&&!d&&(c[b]=c.renderer.text(a.text,0,0,a.useHTML).attr({align:a.align,"class":"highcharts-"+b,zIndex:a.zIndex||4}).css(a.style).add())});c.layOutTitles()},layOutTitles:function(){var a=0,b=this.title,c=this.subtitle,d=this.options,e=d.title,d=d.subtitle,f=this.spacingBox.width-44;if(b&&(b.css({width:(e.width||f)+"px"}).align(v({y:15},e),!1,"spacingBox"),!e.floating&&!e.verticalAlign)){a=b.getBBox().height,a>=18&&a<=25&&(a=15)}c&&(c.css({width:(d.width||f)+"px"}).align(v({y:a+e.margin},d),!1,"spacingBox"),!d.floating&&!d.verticalAlign&&(a=pa(a+c.getBBox().height)));this.titleOffset=a},getChartSize:function(){var a=this.options.chart,b=this.renderToClone||this.renderTo;this.containerWidth=vb(b,"width");this.containerHeight=vb(b,"height");this.chartWidth=u(0,a.width||this.containerWidth||600);this.chartHeight=u(0,o(a.height,this.containerHeight>19?this.containerHeight:400))},cloneRenderTo:function(a){var b=this.renderToClone,c=this.container;a?b&&(this.renderTo.appendChild(c),Ya(b),delete this.renderToClone):(c&&c.parentNode===this.renderTo&&this.renderTo.removeChild(c),this.renderToClone=b=this.renderTo.cloneNode(0),F(b,{position:"absolute",top:"-9999px",display:"block"}),G.body.appendChild(b),c&&b.appendChild(c))},getContainer:function(){var a,b=this.options.chart,c,d,e;this.renderTo=a=b.renderTo;e="highcharts-"+Kb++;if(ja(a)){this.renderTo=a=G.getElementById(a)}a||Da(13,!0);c=z(C(a,"data-highcharts-chart"));!isNaN(c)&&Va[c]&&Va[c].destroy();C(a,"data-highcharts-chart",this.index);a.innerHTML="";a.offsetWidth||this.cloneRenderTo();this.getChartSize();c=this.chartWidth;d=this.chartHeight;this.container=a=Z(Ra,{className:"highcharts-container"+(b.className?" "+b.className:""),id:e},v({position:"relative",overflow:"hidden",width:c+"px",height:d+"px",textAlign:"left",lineHeight:"normal",zIndex:0,"-webkit-tap-highlight-color":"rgba(0,0,0,0)"},b.style),this.renderToClone||a);this._cursor=a.style.cursor;this.renderer=b.forExport?new Ha(a,c,d,!0):new bb(a,c,d);ga&&this.renderer.create(this,a,c,d)},getMargins:function(){var a=this.options.chart,b=a.spacingTop,c=a.spacingRight,d=a.spacingBottom,a=a.spacingLeft,e,f=this.legend,g=this.optionsMarginTop,h=this.optionsMarginLeft,i=this.optionsMarginRight,k=this.optionsMarginBottom,j=this.options.legend,l=o(j.margin,10),m=j.x,n=j.y,p=j.align,K=j.verticalAlign,y=this.titleOffset;this.resetMargins();e=this.axisOffset;if(y&&!t(g)){this.plotTop=u(this.plotTop,y+this.options.title.margin+b)}if(f.display&&!j.floating){if(p==="right"){if(!t(i)){this.marginRight=u(this.marginRight,f.legendWidth-m+l+c)}}else{if(p==="left"){if(!t(h)){this.plotLeft=u(this.plotLeft,f.legendWidth+m+l+a)}}else{if(K==="top"){if(!t(g)){this.plotTop=u(this.plotTop,f.legendHeight+n+l+b)}}else{if(K==="bottom"&&!t(k)){this.marginBottom=u(this.marginBottom,f.legendHeight-n+l+d)}}}}}this.extraBottomMargin&&(this.marginBottom+=this.extraBottomMargin);this.extraTopMargin&&(this.plotTop+=this.extraTopMargin);this.hasCartesianSeries&&q(this.axes,function(a){a.getOffset()});t(h)||(this.plotLeft+=e[3]);t(g)||(this.plotTop+=e[0]);t(k)||(this.marginBottom+=e[2]);t(i)||(this.marginRight+=e[1]);this.setChartSize()},initReflow:function(){function a(a){var g=c.width||vb(d,"width"),h=c.height||vb(d,"height"),a=a?a.target:X;if(!b.hasUserSize&&g&&h&&(a===X||a===G)){if(g!==b.containerWidth||h!==b.containerHeight){clearTimeout(e),b.reflowTimeout=e=setTimeout(function(){if(b.container){b.setSize(g,h,!1),b.hasUserSize=null}},100)}b.containerWidth=g;b.containerHeight=h}}var b=this,c=b.options.chart,d=b.renderTo,e;E(X,"resize",a);E(b,"destroy",function(){V(X,"resize",a)})},setSize:function(a,b,c){var d=this,e,f,g;d.isResizing+=1;g=function(){d&&B(d,"endResize",null,function(){d.isResizing-=1})};Za(c,d);d.oldChartHeight=d.chartHeight;d.oldChartWidth=d.chartWidth;if(t(a)){d.chartWidth=e=u(0,s(a)),d.hasUserSize=!!e}if(t(b)){d.chartHeight=f=u(0,s(b))}F(d.container,{width:e+"px",height:f+"px"});d.setChartSize(!0);d.renderer.setSize(e,f,c);d.maxTicks=null;q(d.axes,function(a){a.isDirty=!0;a.setScale()});q(d.series,function(a){a.isDirty=!0});d.isDirtyLegend=!0;d.isDirtyBox=!0;d.getMargins();d.redraw(c);d.oldChartHeight=null;B(d,"resize");Sa===!1?g():setTimeout(g,Sa&&Sa.duration||500)},setChartSize:function(a){var b=this.inverted,c=this.renderer,d=this.chartWidth,e=this.chartHeight,f=this.options.chart,g=f.spacingTop,h=f.spacingRight,i=f.spacingBottom,k=f.spacingLeft,j=this.clipOffset,l,m,n,p;this.plotLeft=l=s(this.plotLeft);this.plotTop=m=s(this.plotTop);this.plotWidth=n=u(0,s(d-l-this.marginRight));this.plotHeight=p=u(0,s(e-m-this.marginBottom));this.plotSizeX=b?p:n;this.plotSizeY=b?n:p;this.plotBorderWidth=b=f.plotBorderWidth||0;this.spacingBox=c.spacingBox={x:k,y:g,width:d-k-h,height:e-g-i};this.plotBox=c.plotBox={x:l,y:m,width:n,height:p};c=pa(u(b,j[3])/2);d=pa(u(b,j[0])/2);this.clipBox={x:c,y:d,width:U(this.plotSizeX-u(b,j[1])/2-c),height:U(this.plotSizeY-u(b,j[2])/2-d)};a||q(this.axes,function(a){a.setAxisSize();a.setAxisTranslation()})},resetMargins:function(){var a=this.options.chart,b=a.spacingRight,c=a.spacingBottom,d=a.spacingLeft;this.plotTop=o(this.optionsMarginTop,a.spacingTop);this.marginRight=o(this.optionsMarginRight,b);this.marginBottom=o(this.optionsMarginBottom,c);this.plotLeft=o(this.optionsMarginLeft,d);this.axisOffset=[0,0,0,0];this.clipOffset=[0,0,0,0]},drawChartBox:function(){var a=this.options.chart,b=this.renderer,c=this.chartWidth,d=this.chartHeight,e=this.chartBackground,f=this.plotBackground,g=this.plotBorder,h=this.plotBGImage,i=a.borderWidth||0,k=a.backgroundColor,j=a.plotBackgroundColor,l=a.plotBackgroundImage,m=a.plotBorderWidth||0,n,p=this.plotLeft,o=this.plotTop,q=this.plotWidth,w=this.plotHeight,s=this.plotBox,u=this.clipRect,r=this.clipBox;n=i+(a.shadow?8:0);if(i||k){if(e){e.animate(e.crisp(null,null,null,c-n,d-n))}else{e={fill:k||$};if(i){e.stroke=a.borderColor,e["stroke-width"]=i}this.chartBackground=b.rect(n/2,n/2,c-n,d-n,a.borderRadius,i).attr(e).add().shadow(a.shadow)}}if(j){f?f.animate(s):this.plotBackground=b.rect(p,o,q,w,0).attr({fill:j}).add().shadow(a.plotShadow)}if(l){h?h.animate(s):this.plotBGImage=b.image(l,p,o,q,w).add()}u?u.animate({width:r.width,height:r.height}):this.clipRect=b.clipRect(r);if(m){g?g.animate(g.crisp(null,p,o,q,w)):this.plotBorder=b.rect(p,o,q,w,0,m).attr({stroke:a.plotBorderColor,"stroke-width":m,zIndex:1}).add()}this.isDirtyBox=!1},propFromSeries:function(){var a=this,b=a.options.chart,c,d=a.options.series,e,f;q(["inverted","angular","polar"],function(g){c=L[b.type||b.defaultSeriesType];f=a[g]||b[g]||c&&c.prototype[g];for(e=d&&d.length;!f&&e--;){(c=L[d[e].type])&&c.prototype[g]&&(f=!0)}a[g]=f})},render:function(){var a=this,b=a.axes,c=a.renderer,d=a.options,e=d.labels,f=d.credits,g;a.setTitle();a.legend=new Hb(a,d.legend);a.getStacks();q(b,function(a){a.setScale()});a.getMargins();a.maxTicks=null;q(b,function(a){a.setTickPositions(!0);a.setMaxTicks()});a.adjustTickAmounts();a.getMargins();a.drawChartBox();a.hasCartesianSeries&&q(b,function(a){a.render()});if(!a.seriesGroup){a.seriesGroup=c.g("series-group").attr({zIndex:3}).add()}q(a.series,function(a){a.translate();a.setTooltipPoints();a.render()});e.items&&q(e.items,function(b){var d=v(e.style,b.style),f=z(d.left)+a.plotLeft,g=z(d.top)+a.plotTop+12;delete d.left;delete d.top;c.text(b.html,f,g).attr({zIndex:2}).css(d).add()});if(f.enabled&&!a.credits){g=f.href,a.credits=c.text(f.text,0,0).on("click",function(){if(g){location.href=g}}).attr({align:f.position.align,zIndex:8}).css(f.style).add().align(f.position)}a.hasRendered=!0},destroy:function(){var a=this,b=a.axes,c=a.series,d=a.container,e,f=d&&d.parentNode;B(a,"destroy");Va[a.index]=r;a.renderTo.removeAttribute("data-highcharts-chart");V(a);for(e=b.length;e--;){b[e]=b[e].destroy()}for(e=c.length;e--;){c[e]=c[e].destroy()}q("title,subtitle,chartBackground,plotBackground,plotBGImage,plotBorder,seriesGroup,clipRect,credits,pointer,scroller,rangeSelector,legend,resetZoomButton,tooltip,renderer".split(","),function(b){var c=a[b];c&&c.destroy&&(a[b]=c.destroy())});if(d){d.innerHTML="",V(d),f&&Ya(d)}for(e in a){delete a[e]}},isReadyToRender:function(){var a=this;return !ea&&X==X.top&&G.readyState!=="complete"||ga&&!X.canvg?(ga?$b.push(function(){a.firstRender()},a.options.global.canvasToolsURL):G.attachEvent("onreadystatechange",function(){G.detachEvent("onreadystatechange",a.firstRender);G.readyState==="complete"&&a.firstRender()}),!1):!0},firstRender:function(){var a=this,b=a.options,c=a.callback;if(a.isReadyToRender()){a.getContainer(),B(a,"init"),a.resetMargins(),a.setChartSize(),a.propFromSeries(),a.getAxes(),q(b.series||[],function(b){a.initSeries(b)}),B(a,"beforeRender"),a.pointer=new rb(a,b),a.render(),a.renderer.draw(),c&&c.apply(a,[a]),q(a.callbacks,function(b){b.apply(a,[a])}),a.cloneRenderTo(!0),B(a,"load")}}};Ta.prototype.callbacks=[];var Ia=function(){};Ia.prototype={init:function(a,b,c){this.series=a;this.applyOptions(b,c);this.pointAttr={};if(a.options.colorByPoint&&(b=a.options.colors||a.chart.options.colors,this.color=this.color||b[a.colorCounter++],a.colorCounter===b.length)){a.colorCounter=0}a.chart.pointCount++;return this},applyOptions:function(a,b){var c=this.series,d=c.pointValKey,a=Ia.prototype.optionsToObject.call(this,a);v(this,a);this.options=this.options?v(this.options,a):a;if(d){this.y=this[d]}if(this.x===r&&c){this.x=b===r?c.autoIncrement():b}return this},optionsToObject:function(a){var b,c=this.series,d=c.pointArrayMap||["y"],e=d.length,f=0,g=0;if(typeof a==="number"||a===null){b={y:a}}else{if(Wa(a)){b={};if(a.length>e){c=typeof a[0];if(c==="string"){b.name=a[0]}else{if(c==="number"){b.x=a[0]}}f++}for(;g<e;){b[d[g++]]=a[f++]}}else{if(typeof a==="object"){b=a;if(a.dataLabels){c._hasPointLabels=!0}if(a.marker){c._hasPointMarkers=!0}}}}return b},destroy:function(){var a=this.series.chart,b=a.hoverPoints,c;a.pointCount--;if(b&&(this.setState(),la(b,this),!b.length)){a.hoverPoints=null}if(this===a.hoverPoint){this.onMouseOut()}if(this.graphic||this.dataLabel){V(this),this.destroyElements()}this.legendItem&&a.legend.destroyItem(this);for(c in this){this[c]=null}},destroyElements:function(){for(var a="graphic,dataLabel,dataLabelUpper,group,connector,shadowGroup".split(","),b,c=6;c--;){b=a[c],this[b]&&(this[b]=this[b].destroy())}},getLabelConfig:function(){return{x:this.category,y:this.y,key:this.name||this.category,series:this.series,point:this,percentage:this.percentage,total:this.total||this.stackTotal}},select:function(a,b){var c=this,d=c.series,e=d.chart,a=o(a,!c.selected);c.firePointEvent(a?"select":"unselect",{accumulate:b},function(){c.selected=c.options.selected=a;d.options.data[va(c,d.data)]=c.options;c.setState(a&&"select");b||q(e.getSelectedPoints(),function(a){if(a.selected&&a!==c){a.selected=a.options.selected=!1,d.options.data[va(a,d.data)]=a.options,a.setState(""),a.firePointEvent("unselect")}})})},onMouseOver:function(a){var b=this.series,c=b.chart,d=c.tooltip,e=c.hoverPoint;if(e&&e!==this){e.onMouseOut()}this.firePointEvent("mouseOver");d&&(!d.shared||b.noSharedTooltip)&&d.refresh(this,a);this.setState("hover");c.hoverPoint=this},onMouseOut:function(){var a=this.series.chart,b=a.hoverPoints;if(!b||va(this,b)===-1){this.firePointEvent("mouseOut"),this.setState(),a.hoverPoint=null}},tooltipFormatter:function(a){var b=this.series,c=b.tooltipOptions,d=o(c.valueDecimals,""),e=c.valuePrefix||"",f=c.valueSuffix||"";q(b.pointArrayMap||["y"],function(b){b="{point."+b;if(e||f){a=a.replace(b+"}",e+b+"}"+f)}a=a.replace(b+"}",b+":,."+d+"f}")});return Ma(a,{point:this,series:this.series})},update:function(a,b,c){var d=this,e=d.series,f=d.graphic,g,h=e.data,i=e.chart,k=e.options,b=o(b,!0);d.firePointEvent("update",{options:a},function(){d.applyOptions(a);ba(a)&&(e.getAttribs(),f&&f.attr(d.pointAttr[e.state]));g=va(d,h);e.xData[g]=d.x;e.yData[g]=e.toYData?e.toYData(d):d.y;e.zData[g]=d.z;k.data[g]=d.options;e.isDirty=e.isDirtyData=i.isDirtyBox=!0;k.legendType==="point"&&i.legend.destroyItem(d);b&&i.redraw(c)})},remove:function(a,b){var c=this,d=c.series,e=d.chart,f,g=d.data;Za(b,e);a=o(a,!0);c.firePointEvent("remove",null,function(){f=va(c,g);g.splice(f,1);d.options.data.splice(f,1);d.xData.splice(f,1);d.yData.splice(f,1);d.zData.splice(f,1);c.destroy();d.isDirty=!0;d.isDirtyData=!0;a&&e.redraw()})},firePointEvent:function(a,b,c){var d=this,e=this.series.options;(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])&&this.importEvents();a==="click"&&e.allowPointSelect&&(c=function(a){d.select(null,a.ctrlKey||a.metaKey||a.shiftKey)});B(this,a,b,c)},importEvents:function(){if(!this.hasImportedEvents){var a=x(this.series.options.point,this.options).events,b;this.events=a;for(b in a){E(this,b,a[b])}this.hasImportedEvents=!0}},setState:function(a){var b=this.plotX,c=this.plotY,d=this.series,e=d.options.states,f=Q[d.type].marker&&d.options.marker,g=f&&!f.enabled,h=f&&f.states[a],i=h&&h.enabled===!1,k=d.stateMarkerGraphic,j=this.marker||{},l=d.chart,m=this.pointAttr,a=a||"";if(!(a===this.state||this.selected&&a!=="select"||e[a]&&e[a].enabled===!1||a&&(i||g&&!h.enabled))){if(this.graphic){e=f&&this.graphic.symbolName&&m[a].r,this.graphic.attr(x(m[a],e?{x:b-e,y:c-e,width:2*e,height:2*e}:{}))}else{if(a&&h){e=h.radius,j=j.symbol||d.symbol,k&&k.currentSymbol!==j&&(k=k.destroy()),k?k.attr({x:b-e,y:c-e}):(d.stateMarkerGraphic=k=l.renderer.symbol(j,b-e,c-e,2*e,2*e).attr(m[a]).add(d.markerGroup),k.currentSymbol=j)}if(k){k[a&&l.isInsidePlot(b,c)?"show":"hide"]()}}this.state=a}}};var W=function(){};W.prototype={isCartesian:!0,type:"line",pointClass:Ia,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},colorCounter:0,init:function(a,b){var c,d,e=a.series;this.chart=a;this.options=b=this.setOptions(b);this.bindAxes();v(this,{name:b.name,state:"",pointAttr:{},visible:b.visible!==!1,selected:b.selected===!0});if(ga){b.animation=!1}d=b.events;for(c in d){E(this,c,d[c])}if(d&&d.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect){a.runTrackerClick=!0}this.getColor();this.getSymbol();this.setData(b.data,!1);if(this.isCartesian){a.hasCartesianSeries=!0}e.push(this);this._i=e.length-1;Sb(e,function(a,b){return o(a.options.index,a._i)-o(b.options.index,a._i)});q(e,function(a,b){a.index=b;a.name=a.name||"Series "+(b+1)});c=b.linkedTo;this.linkedSeries=[];if(ja(c)&&(c=c===":previous"?e[this.index-1]:a.get(c))){c.linkedSeries.push(this),this.linkedParent=c}},bindAxes:function(){var a=this,b=a.options,c=a.chart,d;a.isCartesian&&q(["xAxis","yAxis"],function(e){q(c[e],function(c){d=c.options;if(b[e]===d.index||b[e]!==r&&b[e]===d.id||b[e]===r&&d.index===0){c.series.push(a),a[e]=c,c.isDirty=!0}});a[e]||Da(18,!0)})},autoIncrement:function(){var a=this.options,b=this.xIncrement,b=o(b,a.pointStart,0);this.pointInterval=o(this.pointInterval,a.pointInterval,1);this.xIncrement=b+this.pointInterval;return b},getSegments:function(){var a=-1,b=[],c,d=this.points,e=d.length;if(e){if(this.options.connectNulls){for(c=e;c--;){d[c].y===null&&d.splice(c,1)}d.length&&(b=[d])}else{q(d,function(c,g){c.y===null?(g>a+1&&b.push(d.slice(a+1,g)),a=g):g===e-1&&b.push(d.slice(a+1,g+1))})}}this.segments=b},setOptions:function(a){var b=this.chart.options,c=b.plotOptions,d=c[this.type];this.userOptions=a;a=x(d,c.series,a);this.tooltipOptions=x(b.tooltip,a.tooltip);d.marker===null&&delete a.marker;return a},getColor:function(){var a=this.options,b=this.userOptions,c=this.chart.options.colors,d=this.chart.counters,e;e=a.color||Q[this.type].color;if(!e&&!a.colorByPoint){t(b._colorIndex)?a=b._colorIndex:(b._colorIndex=d.color,a=d.color++),e=c[a]}this.color=e;d.wrapColor(c.length)},getSymbol:function(){var a=this.userOptions,b=this.options.marker,c=this.chart,d=c.options.symbols,c=c.counters;this.symbol=b.symbol;if(!this.symbol){t(a._symbolIndex)?a=a._symbolIndex:(a._symbolIndex=c.symbol,a=c.symbol++),this.symbol=d[a]}if(/^url/.test(this.symbol)){b.radius=0}c.wrapSymbol(d.length)},drawLegendSymbol:function(a){var b=this.options,c=b.marker,d=a.options,e;e=d.symbolWidth;var f=this.chart.renderer,g=this.legendGroup,a=a.baseline-s(f.fontMetrics(d.itemStyle.fontSize).b*0.3);if(b.lineWidth){d={"stroke-width":b.lineWidth};if(b.dashStyle){d.dashstyle=b.dashStyle}this.legendLine=f.path(["M",0,a,"L",e,a]).attr(d).add(g)}if(c&&c.enabled){b=c.radius,this.legendSymbol=e=f.symbol(this.symbol,e/2-b,a-b,2*b,2*b).add(g),e.isMarker=!0}},addPoint:function(a,b,c,d){var e=this.options,f=this.data,g=this.graph,h=this.area,i=this.chart,k=this.xData,j=this.yData,l=this.zData,m=this.names,n=g&&g.shift||0,p=e.data;Za(d,i);c&&q([g,h,this.graphNeg,this.areaNeg],function(a){if(a){a.shift=n+1}});if(h){h.isArea=!0}b=o(b,!0);d={series:this};this.pointClass.prototype.applyOptions.apply(d,[a]);k.push(d.x);j.push(this.toYData?this.toYData(d):d.y);l.push(d.z);if(m){m[d.x]=d.name}p.push(a);e.legendType==="point"&&this.generatePoints();c&&(f[0]&&f[0].remove?f[0].remove(!1):(f.shift(),k.shift(),j.shift(),l.shift(),p.shift()));this.isDirtyData=this.isDirty=!0;b&&(this.getAttribs(),i.redraw())},setData:function(a,b){var c=this.points,d=this.options,e=this.chart,f=null,g=this.xAxis,h=g&&g.categories&&!g.categories.length?[]:null,i;this.xIncrement=null;this.pointRange=g&&g.categories?1:d.pointRange;this.colorCounter=0;var k=[],j=[],l=[],m=a?a.length:[];i=o(d.turboThreshold,1000);var n=this.pointArrayMap,n=n&&n.length,p=!!this.toYData;if(i&&m>i){for(i=0;f===null&&i<m;){f=a[i],i++}if(ra(f)){f=o(d.pointStart,0);d=o(d.pointInterval,1);for(i=0;i<m;i++){k[i]=f,j[i]=a[i],f+=d}this.xIncrement=f}else{if(Wa(f)){if(n){for(i=0;i<m;i++){d=a[i],k[i]=d[0],j[i]=d.slice(1,n+1)}}else{for(i=0;i<m;i++){d=a[i],k[i]=d[0],j[i]=d[1]}}}}}else{for(i=0;i<m;i++){if(a[i]!==r&&(d={series:this},this.pointClass.prototype.applyOptions.apply(d,[a[i]]),k[i]=d.x,j[i]=p?this.toYData(d):d.y,l[i]=d.z,h&&d.name)){h[d.x]=d.name}}}ja(j[0])&&Da(14,!0);this.data=[];this.options.data=a;this.xData=k;this.yData=j;this.zData=l;this.names=h;for(i=c&&c.length||0;i--;){c[i]&&c[i].destroy&&c[i].destroy()}if(g){g.minRange=g.userMinRange}this.isDirty=this.isDirtyData=e.isDirtyBox=!0;o(b,!0)&&e.redraw(!1)},remove:function(a,b){var c=this,d=c.chart,a=o(a,!0);if(!c.isRemoving){c.isRemoving=!0,B(c,"remove",null,function(){c.destroy();d.isDirtyLegend=d.isDirtyBox=!0;a&&d.redraw(b)})}c.isRemoving=!1},processData:function(a){var b=this.xData,c=this.yData,d=b.length,e;e=0;var f,g,h=this.xAxis,i=this.options,k=i.cropThreshold,j=this.isCartesian;if(j&&!this.isDirty&&!h.isDirty&&!this.yAxis.isDirty&&!a){return !1}if(j&&this.sorted&&(!k||d>k||this.forceCrop)){if(a=h.min,h=h.max,b[d-1]<a||b[0]>h){b=[],c=[]}else{if(b[0]<a||b[d-1]>h){e=this.cropData(this.xData,this.yData,a,h),b=e.xData,c=e.yData,e=e.start,f=!0}}}for(h=b.length-1;h>=0;h--){d=b[h]-b[h-1],d>0&&(g===r||d<g)?g=d:d<0&&this.requireSorting&&Da(15)}this.cropped=f;this.cropStart=e;this.processedXData=b;this.processedYData=c;if(i.pointRange===null){this.pointRange=g||1}this.closestPointRange=g},cropData:function(a,b,c,d){var e=a.length,f=0,g=e,h;for(h=0;h<e;h++){if(a[h]>=c){f=u(0,h-1);break}}for(;h<e;h++){if(a[h]>d){g=h+1;break}}return{xData:a.slice(f,g),yData:b.slice(f,g),start:f,end:g}},generatePoints:function(){var a=this.options.data,b=this.data,c,d=this.processedXData,e=this.processedYData,f=this.pointClass,g=d.length,h=this.cropStart||0,i,k=this.hasGroupedData,j,l=[],m;if(!b&&!k){b=[],b.length=a.length,b=this.data=b}for(m=0;m<g;m++){i=h+m,k?l[m]=(new f).init(this,[d[m]].concat(ha(e[m]))):(b[i]?j=b[i]:a[i]!==r&&(b[i]=j=(new f).init(this,a[i],d[m])),l[m]=j)}if(b&&(g!==(c=b.length)||k)){for(m=0;m<c;m++){if(m===h&&!k&&(m+=g),b[m]){b[m].destroyElements(),b[m].plotX=r}}}this.data=b;this.points=l},setStackedPoints:function(){if(this.options.stacking&&!(this.visible!==!0&&this.chart.options.chart.ignoreHiddenSeries!==!1)){var a=this.processedXData,b=this.processedYData,c=b.length,d=this.options,e=d.threshold,f=d.stack,d=d.stacking,g=this.stackKey,h="-"+g,i=this.yAxis,k=i.stacks,j=i.oldStacks,l=i.stacksMax,m,n,p,o,q,w;for(q=0;q<c;q++){n=a[q];w=b[q];o=(m=w<e)?h:g;l[o]||(l[o]=w);k[o]||(k[o]={});if(!k[o][n]){j[o]&&j[o][n]?(k[o][n]=j[o][n],k[o][n].total=null):k[o][n]=new Ub(i,i.options.stackLabels,m,n,f,d)}p=k[o][n];n=p.total;p.addValue(w);p.cacheExtremes(this,[n,n+w]);if(p.total>l[o]&&!m){l[o]=p.total}else{if(p.total<l[o]&&m){l[o]=p.total}}}i.oldStacks={}}},getExtremes:function(){var a=this.xAxis,b=this.yAxis,c=this.stackKey,d=this.options,e=d.threshold,f=this.processedXData,g=this.processedYData,h=g.length,i=[],k=0,j=a.min,a=a.max,l,m,n;d.stacking&&(m=b.stacksMax["-"+c]||e,n=b.stacksMax[c]||e);if(!t(m)||!t(n)){for(d=0;d<h;d++){if(l=f[d],c=g[d],e=c!==null&&c!==r&&(!b.isLog||c.length||c>0),l=this.getExtremesFromAll||this.cropped||(f[d+1]||l)>=j&&(f[d-1]||l)<=a,e&&l){if(e=c.length){for(;e--;){c[e]!==null&&(i[k++]=c[e])}}else{i[k++]=c}}}m=o(m,Qa(i));n=o(n,ta(i))}this.dataMin=m;this.dataMax=n},translate:function(){this.processedXData||this.processData();this.generatePoints();for(var a=this.options,b=a.stacking,c=this.xAxis,d=c.categories,e=this.yAxis,f=this.points,g=f.length,h=!!this.modifyValue,i=a.pointPlacement,k=i==="between"||ra(i),j=a.threshold,a=0;a<g;a++){var l=f[a],m=l.x,n=l.y,p=l.low,q=e.stacks[(n<j?"-":"")+this.stackKey],y;if(e.isLog&&n<=0){l.y=n=null}l.plotX=c.translate(m,0,0,0,1,i);if(b&&this.visible&&q&&q[m]){q=q[m],y=q.total,q.cum=p=q.cum-n,n=p+n,q.cum===0&&(p=o(j,e.min)),e.isLog&&p<=0&&(p=null),b==="percent"&&(p=y?p*100/y:0,n=y?n*100/y:0),l.percentage=y?l.y*100/y:0,l.total=l.stackTotal=y,l.stackY=n,q.setOffset(this.pointXOffset||0,this.barW||0)}l.yBottom=t(p)?e.translate(p,0,1,0,1):null;h&&(n=this.modifyValue(n,l));l.plotY=typeof n==="number"&&n!==Infinity?s(e.translate(n,0,1,0,1)*10)/10:r;l.clientX=k?c.translate(m,0,0,0,1):l.plotX;l.negative=l.y<(j||0);l.category=d&&d[l.x]!==r?d[l.x]:l.x}this.getSegments()},setTooltipPoints:function(a){var b=[],c,d,e=(c=this.xAxis)?c.tooltipLen||c.len:this.chart.plotSizeX,f,g,h,i=[];if(this.options.enableMouseTracking!==!1){if(a){this.tooltipPoints=null}q(this.segments||this.points,function(a){b=b.concat(a)});c&&c.reversed&&(b=b.reverse());this.orderTooltipPoints&&this.orderTooltipPoints(b);a=b.length;for(h=0;h<a;h++){f=b[h];g=b[h+1];c=b[h-1]?d+1:0;for(d=b[h+1]?D(u(0,U((f.clientX+(g?g.wrappedClientX||g.clientX:e))/2)),e):e;c>=0&&c<=d;){i[c++]=f}}this.tooltipPoints=i}},tooltipHeaderFormatter:function(a){var b=this.tooltipOptions,c=b.xDateFormat,d=b.dateTimeLabelFormats,e=this.xAxis,f=e&&e.options.type==="datetime",b=b.headerFormat,e=e&&e.closestPointRange,g;if(f&&!c){if(e){for(g in H){if(H[g]>=e){c=d[g];break}}}else{c=d.day}}f&&c&&ra(a.key)&&(b=b.replace("{point.key}","{point.key:"+c+"}"));return Ma(b,{point:a,series:this})},onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(b&&b!==this){b.onMouseOut()}this.options.events.mouseOver&&B(this,"mouseOver");this.setState("hover");a.hoverSeries=this},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;if(d){d.onMouseOut()}this&&a.events.mouseOut&&B(this,"mouseOut");c&&!a.stickyTracking&&(!c.shared||this.noSharedTooltip)&&c.hide();this.setState();b.hoverSeries=null},animate:function(a){var b=this,c=b.chart,d=c.renderer,e;e=b.options.animation;var f=c.clipBox,g=c.inverted,h;if(e&&!ba(e)){e=Q[b.type].animation}h="_sharedClip"+e.duration+e.easing;if(a){a=c[h],e=c[h+"m"],a||(c[h]=a=d.clipRect(v(f,{width:0})),c[h+"m"]=e=d.clipRect(-99,g?-c.plotLeft:-c.plotTop,99,g?c.chartWidth:c.chartHeight)),b.group.clip(a),b.markerGroup.clip(e),b.sharedClipKey=h}else{if(a=c[h]){a.animate({width:c.plotSizeX},e),c[h+"m"].animate({width:c.plotSizeX+99},e)}b.animate=null;b.animationTimeout=setTimeout(function(){b.afterAnimate()},e.duration)}},afterAnimate:function(){var a=this.chart,b=this.sharedClipKey,c=this.group;c&&this.options.clip!==!1&&(c.clip(a.clipRect),this.markerGroup.clip());setTimeout(function(){b&&a[b]&&(a[b]=a[b].destroy(),a[b+"m"]=a[b+"m"].destroy())},100)},drawPoints:function(){var a,b=this.points,c=this.chart,d,e,f,g,h,i,k,j,l=this.options.marker,m,n=this.markerGroup;if(l.enabled||this._hasPointMarkers){for(f=b.length;f--;){if(g=b[f],d=U(g.plotX),e=g.plotY,j=g.graphic,i=g.marker||{},a=l.enabled&&i.enabled===r||i.enabled,m=c.isInsidePlot(s(d),e,c.inverted),a&&e!==r&&!isNaN(e)&&g.y!==null){if(a=g.pointAttr[g.selected?"select":""],h=a.r,i=o(i.symbol,this.symbol),k=i.indexOf("url")===0,j){j.attr({visibility:m?ea?"inherit":"visible":"hidden"}).animate(v({x:d-h,y:e-h},j.symbolName?{width:2*h,height:2*h}:{}))}else{if(m&&(h>0||k)){g.graphic=c.renderer.symbol(i,d-h,e-h,2*h,2*h).attr(a).add(n)}}}else{if(j){g.graphic=j.destroy()}}}}},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions,f,g,h={},a=a||{},b=b||{},c=c||{},d=d||{};for(f in e){g=e[f],h[f]=o(a[g],b[f],c[f],d[f])}return h},getAttribs:function(){var a=this,b=a.options,c=Q[a.type].marker?b.marker:b,d=c.states,e=d.hover,f,g=a.color,h={stroke:g,fill:g},i=a.points||[],k=[],j,l=a.pointAttrToOptions,m=b.negativeColor,n;b.marker?(e.radius=e.radius||c.radius+2,e.lineWidth=e.lineWidth||c.lineWidth+1):e.color=e.color||wa(e.color||g).brighten(e.brightness).get();k[""]=a.convertAttribs(c,h);q(["hover","select"],function(b){k[b]=a.convertAttribs(d[b],k[""])});a.pointAttr=k;for(g=i.length;g--;){h=i[g];if((c=h.options&&h.options.marker||h.options)&&c.enabled===!1){c.radius=0}if(h.negative&&m){h.color=h.fillColor=m}f=b.colorByPoint||h.color;if(h.options){for(n in l){t(c[l[n]])&&(f=!0)}}if(f){c=c||{};j=[];d=c.states||{};f=d.hover=d.hover||{};if(!b.marker){f.color=wa(f.color||h.color).brighten(f.brightness||e.brightness).get()}j[""]=a.convertAttribs(v({color:h.color},c),k[""]);j.hover=a.convertAttribs(d.hover,k.hover,j[""]);j.select=a.convertAttribs(d.select,k.select,j[""]);if(h.negative&&b.marker&&m){j[""].fill=j.hover.fill=j.select.fill=a.convertAttribs({fillColor:m}).fill}}else{j=k}h.pointAttr=j}},update:function(a,b){var c=this.chart,d=this.type,a=x(this.userOptions,{animation:!1,index:this.index,pointStart:this.xData[0]},{data:this.options.data},a);this.remove(!1);v(this,L[a.type||d].prototype);this.init(c,a);o(b,!0)&&c.redraw(!1)},destroy:function(){var a=this,b=a.chart,c=/AppleWebKit\/533/.test(Ua),d,e,f=a.data||[],g,h,i;B(a,"destroy");V(a);q(["xAxis","yAxis"],function(b){if(i=a[b]){la(i.series,a),i.isDirty=i.forceRedraw=!0}});a.legendItem&&a.chart.legend.destroyItem(a);for(e=f.length;e--;){(g=f[e])&&g.destroy&&g.destroy()}a.points=null;clearTimeout(a.animationTimeout);q("area,graph,dataLabelsGroup,group,markerGroup,tracker,graphNeg,areaNeg,posClip,negClip".split(","),function(b){a[b]&&(d=c&&b==="group"?"hide":"destroy",a[b][d]())});if(b.hoverSeries===a){b.hoverSeries=null}la(b.series,a);for(h in a){delete a[h]}},drawDataLabels:function(){var a=this,b=a.options.dataLabels,c=a.points,d,e,f,g;if(b.enabled||a._hasPointLabels){a.dlProcessOptions&&a.dlProcessOptions(b),g=a.plotGroup("dataLabelsGroup","data-labels",a.visible?"visible":"hidden",b.zIndex||6),e=b,q(c,function(c){var i,k=c.dataLabel,j,l,m=c.connector,n=!0;d=c.options&&c.options.dataLabels;i=e.enabled||d&&d.enabled;if(k&&!i){c.dataLabel=k.destroy()}else{if(i){b=x(e,d);i=b.rotation;j=c.getLabelConfig();f=b.format?Ma(b.format,j):b.formatter.call(j,b);b.style.color=o(b.color,b.style.color,a.color,"black");if(k){if(t(f)){k.attr({text:f}),n=!1}else{if(c.dataLabel=k=k.destroy(),m){c.connector=m.destroy()}}}else{if(t(f)){k={fill:b.backgroundColor,stroke:b.borderColor,"stroke-width":b.borderWidth,r:b.borderRadius||0,rotation:i,padding:b.padding,zIndex:1};for(l in k){k[l]===r&&delete k[l]}k=c.dataLabel=a.chart.renderer[i?"text":"label"](f,0,-999,null,null,null,b.useHTML).attr(k).css(b.style).add(g).shadow(b.shadow)}}k&&a.alignDataLabel(c,k,b,null,n)}}})}},alignDataLabel:function(a,b,c,d,e){var f=this.chart,g=f.inverted,h=o(a.plotX,-999),i=o(a.plotY,-999),a=b.getBBox(),d=v({x:g?f.plotWidth-i:h,y:s(g?f.plotHeight-h:i),width:0,height:0},d);v(c,{width:a.width,height:a.height});c.rotation?(d={align:c.align,x:d.x+c.x+d.width/2,y:d.y+c.y+d.height/2},b[e?"attr":"animate"](d)):(b.align(c,null,d),d=b.alignAttr);b.attr({visibility:c.crop===!1||f.isInsidePlot(d.x,d.y)&&f.isInsidePlot(d.x+a.width,d.y+a.height)?f.renderer.isSVG?"inherit":"visible":"hidden"})},getSegmentPath:function(a){var b=this,c=[],d=b.options.step;q(a,function(e,f){var g=e.plotX,h=e.plotY,i;b.getPointSpline?c.push.apply(c,b.getPointSpline(a,e,f)):(c.push(f?"L":"M"),d&&f&&(i=a[f-1],d==="right"?c.push(i.plotX,h):d==="center"?c.push((i.plotX+g)/2,i.plotY,(i.plotX+g)/2,h):c.push(g,i.plotY)),c.push(e.plotX,e.plotY))});return c},getGraphPath:function(){var a=this,b=[],c,d=[];q(a.segments,function(e){c=a.getSegmentPath(e);e.length>1?b=b.concat(c):d.push(e[0])});a.singlePoints=d;return a.graphPath=b},drawGraph:function(){var a=this,b=this.options,c=[["graph",b.lineColor||this.color]],d=b.lineWidth,e=b.dashStyle,f=this.getGraphPath(),g=b.negativeColor;g&&c.push(["graphNeg",g]);q(c,function(c,g){var k=c[0],j=a[k];if(j){jb(j),j.animate({d:f})}else{if(d&&f.length){j={stroke:c[1],"stroke-width":d,zIndex:1};if(e){j.dashstyle=e}a[k]=a.chart.renderer.path(f).attr(j).add(a.group).shadow(!g&&b.shadow)}}})},clipNeg:function(){var a=this.options,b=this.chart,c=b.renderer,d=a.negativeColor||a.negativeFillColor,e,f=this.graph,g=this.area,h=this.posClip,i=this.negClip;e=b.chartWidth;var k=b.chartHeight,j=u(e,k),l=this.yAxis;if(d&&(f||g)){d=s(l.toPixels(a.threshold||0,!0));a={x:0,y:0,width:j,height:d};j={x:0,y:d,width:j,height:j};if(b.inverted){a.height=j.y=b.plotWidth-d,c.isVML&&(a={x:b.plotWidth-d-b.plotLeft,y:0,width:e,height:k},j={x:d+b.plotLeft-e,y:0,width:b.plotLeft+d,height:e})}l.reversed?(b=j,e=a):(b=a,e=j);h?(h.animate(b),i.animate(e)):(this.posClip=h=c.clipRect(b),this.negClip=i=c.clipRect(e),f&&this.graphNeg&&(f.clip(h),this.graphNeg.clip(i)),g&&(g.clip(h),this.areaNeg.clip(i)))}},invertGroups:function(){function a(){var a={width:b.yAxis.len,height:b.xAxis.len};q(["group","markerGroup"],function(c){b[c]&&b[c].attr(a).invert()})}var b=this,c=b.chart;if(b.xAxis){E(c,"resize",a),E(b,"destroy",function(){V(c,"resize",a)}),a(),b.invertGroups=a}},plotGroup:function(a,b,c,d,e){var f=this[a],g=!f;g&&(this[a]=f=this.chart.renderer.g(b).attr({visibility:c,zIndex:d||0.1}).add(e));f[g?"attr":"animate"](this.getPlotBox());return f},getPlotBox:function(){return{translateX:this.xAxis?this.xAxis.left:this.chart.plotLeft,translateY:this.yAxis?this.yAxis.top:this.chart.plotTop,scaleX:1,scaleY:1}},render:function(){var a=this.chart,b,c=this.options,d=c.animation&&!!this.animate&&a.renderer.isSVG,e=this.visible?"visible":"hidden",f=c.zIndex,g=this.hasRendered,h=a.seriesGroup;b=this.plotGroup("group","series",e,f,h);this.markerGroup=this.plotGroup("markerGroup","markers",e,f,h);d&&this.animate(!0);this.getAttribs();b.inverted=this.isCartesian?a.inverted:!1;this.drawGraph&&(this.drawGraph(),this.clipNeg());this.drawDataLabels();this.drawPoints();this.options.enableMouseTracking!==!1&&this.drawTracker();a.inverted&&this.invertGroups();c.clip!==!1&&!this.sharedClipKey&&!g&&b.clip(a.clipRect);d?this.animate():g||this.afterAnimate();this.isDirty=this.isDirtyData=!1;this.hasRendered=!0},redraw:function(){var a=this.chart,b=this.isDirtyData,c=this.group,d=this.xAxis,e=this.yAxis;c&&(a.inverted&&c.attr({width:a.plotWidth,height:a.plotHeight}),c.animate({translateX:o(d&&d.left,a.plotLeft),translateY:o(e&&e.top,a.plotTop)}));this.translate();this.setTooltipPoints(!0);this.render();b&&B(this,"updatedData")},setState:function(a){var b=this.options,c=this.graph,d=this.graphNeg,e=b.states,b=b.lineWidth,a=a||"";if(this.state!==a){this.state=a,e[a]&&e[a].enabled===!1||(a&&(b=e[a].lineWidth||b+1),c&&!c.dashstyle&&(a={"stroke-width":b},c.attr(a),d&&d.attr(a)))}},setVisible:function(a,b){var c=this,d=c.chart,e=c.legendItem,f,g=d.options.chart.ignoreHiddenSeries,h=c.visible;f=(c.visible=a=c.userOptions.visible=a===r?!h:a)?"show":"hide";q(["group","dataLabelsGroup","markerGroup","tracker"],function(a){if(c[a]){c[a][f]()}});if(d.hoverSeries===c){c.onMouseOut()}e&&d.legend.colorizeItem(c,a);c.isDirty=!0;c.options.stacking&&q(d.series,function(a){if(a.options.stacking&&a.visible){a.isDirty=!0}});q(c.linkedSeries,function(b){b.setVisible(a,!1)});if(g){d.isDirtyBox=!0}b!==!1&&d.redraw();B(c,f)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(a){this.selected=a=a===r?!this.selected:a;if(this.checkbox){this.checkbox.checked=a}B(this,a?"select":"unselect")},drawTracker:function(){var a=this,b=a.options,c=b.trackByArea,d=[].concat(c?a.areaPath:a.graphPath),e=d.length,f=a.chart,g=f.pointer,h=f.renderer,i=f.options.tooltip.snap,k=a.tracker,j=b.cursor,j=j&&{cursor:j},l=a.singlePoints,m,n=function(){if(f.hoverSeries!==a){a.onMouseOver()}};if(e&&!c){for(m=e+1;m--;){d[m]==="M"&&d.splice(m+1,0,d[m+1]-i,d[m+2],"L"),(m&&d[m]==="M"||m===e)&&d.splice(m,0,"L",d[m-2]+i,d[m-1])}}for(m=0;m<l.length;m++){e=l[m],d.push("M",e.plotX-i,e.plotY,"L",e.plotX+i,e.plotY)}if(k){k.attr({d:d})}else{if(a.tracker=k=h.path(d).attr({"class":"highcharts-tracker","stroke-linejoin":"round",visibility:a.visible?"visible":"hidden",stroke:Xb,fill:c?Xb:$,"stroke-width":b.lineWidth+(c?0:2*i),zIndex:2}).addClass("highcharts-tracker").on("mouseover",n).on("mouseout",function(a){g.onTrackerMouseOut(a)}).css(j).add(a.markerGroup),ib){k.on("touchstart",n)}}}};I=ca(W);L.line=I;Q.area=x(P,{threshold:0});I=ca(W,{type:"area",getSegments:function(){var a=[],b=[],c=[],d=this.xAxis,e=this.yAxis,f=e.stacks[this.stackKey],g={},h,i,k=this.points,j,l,m;if(this.options.stacking&&!this.cropped){for(l=0;l<k.length;l++){g[k[l].x]=k[l]}for(m in f){c.push(+m)}c.sort(function(a,b){return a-b});q(c,function(a){g[a]?b.push(g[a]):(h=d.translate(a),j=f[a].percent?f[a].total?f[a].cum*100/f[a].total:0:f[a].cum,i=e.toPixels(j,!0),b.push({y:null,plotX:h,clientX:h,plotY:i,yBottom:i,onMouseOver:qa}))});b.length&&a.push(b)}else{W.prototype.getSegments.call(this),a=this.segments}this.segments=a},getSegmentPath:function(a){var b=W.prototype.getSegmentPath.call(this,a),c=[].concat(b),d,e=this.options;b.length===3&&c.push("L",b[1],b[2]);if(e.stacking&&!this.closedStacks){for(d=a.length-1;d>=0;d--){d<a.length-1&&e.step&&c.push(a[d+1].plotX,a[d].yBottom),c.push(a[d].plotX,a[d].yBottom)}}else{this.closeSegment(c,a)}this.areaPath=this.areaPath.concat(c);return b},closeSegment:function(a,b){var c=this.yAxis.getThreshold(this.options.threshold);a.push("L",b[b.length-1].plotX,c,"L",b[0].plotX,c)},drawGraph:function(){this.areaPath=[];W.prototype.drawGraph.apply(this);var a=this,b=this.areaPath,c=this.options,d=c.negativeColor,e=c.negativeFillColor,f=[["area",this.color,c.fillColor]];(d||e)&&f.push(["areaNeg",d,e]);q(f,function(d){var e=d[0],f=a[e];f?f.animate({d:b}):a[e]=a.chart.renderer.path(b).attr({fill:o(d[2],wa(d[1]).setOpacity(o(c.fillOpacity,0.75)).get()),zIndex:0}).add(a.group)})},drawLegendSymbol:function(a,b){b.legendSymbol=this.chart.renderer.rect(0,a.baseline-11,a.options.symbolWidth,12,2).attr({zIndex:3}).add(b.legendGroup)}});L.area=I;Q.spline=x(P);Y=ca(W,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-1],g=a[c+1],h,i,k,j;if(f&&g){a=f.plotY;k=g.plotX;var g=g.plotY,l;h=(1.5*d+f.plotX)/2.5;i=(1.5*e+a)/2.5;k=(1.5*d+k)/2.5;j=(1.5*e+g)/2.5;l=(j-i)*(k-d)/(k-h)+e-j;i+=l;j+=l;i>a&&i>e?(i=u(a,e),j=2*e-i):i<a&&i<e&&(i=D(a,e),j=2*e-i);j>g&&j>e?(j=u(g,e),i=2*e-j):j<g&&j<e&&(j=D(g,e),i=2*e-j);b.rightContX=k;b.rightContY=j}c?(b=["C",f.rightContX||f.plotX,f.rightContY||f.plotY,h||d,i||e,d,e],f.rightContX=f.rightContY=null):b=["M",d,e];return b}});L.spline=Y;Q.areaspline=x(Q.area);var Ja=I.prototype;Y=ca(Y,{type:"areaspline",closedStacks:!0,getSegmentPath:Ja.getSegmentPath,closeSegment:Ja.closeSegment,drawGraph:Ja.drawGraph,drawLegendSymbol:Ja.drawLegendSymbol});L.areaspline=Y;Q.column=x(P,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:0.1,shadow:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},stickyTracking:!1,threshold:0});Y=ca(W,{type:"column",tooltipOutsidePlot:!0,pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},trackerGroups:["group","dataLabelsGroup"],init:function(){W.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasRendered&&q(b.series,function(b){if(b.type===a.type){b.isDirty=!0}})},getColumnMetrics:function(){var a=this,b=a.options,c=a.xAxis,d=a.yAxis,e=c.reversed,f,g={},h,i=0;b.grouping===!1?i=1:q(a.chart.series,function(b){var c=b.options,e=b.yAxis;if(b.type===a.type&&b.visible&&d.len===e.len&&d.pos===e.pos){c.stacking?(f=b.stackKey,g[f]===r&&(g[f]=i++),h=g[f]):c.grouping!==!1&&(h=i++),b.columnIndex=h}});var c=D(T(c.transA)*(c.ordinalSlope||b.pointRange||c.closestPointRange||1),c.len),k=c*b.groupPadding,j=(c-2*k)/i,l=b.pointWidth,b=t(l)?(j-l)/2:j*b.pointPadding,l=o(l,j-2*b);return a.columnMetrics={width:l,offset:b+(k+((e?i-(a.columnIndex||0):a.columnIndex)||0)*j-c/2)*(e?-1:1)}},translate:function(){var a=this.chart,b=this.options,c=b.borderWidth,d=this.yAxis,e=this.translatedThreshold=d.getThreshold(b.threshold),f=o(b.minPointLength,5),b=this.getColumnMetrics(),g=b.width,h=this.barW=pa(u(g,1+2*c)),i=this.pointXOffset=b.offset;W.prototype.translate.apply(this);q(this.points,function(b){var j=D(u(-999,b.plotY),d.len+999),l=o(b.yBottom,e),m=b.plotX+i,n=pa(D(j,l)),j=pa(u(j,l)-n);T(j)<f&&f&&(j=f,n=s(T(n-e)>f?l-f:e-(d.translate(b.y,0,1,0,1)<=e?f:0)));b.barX=m;b.pointWidth=g;b.shapeType="rect";b.shapeArgs=b=a.renderer.Element.prototype.crisp.call(0,c,m,n,h,j);c%2&&(b.y-=1,b.height+=1)})},getSymbol:qa,drawLegendSymbol:I.prototype.drawLegendSymbol,drawGraph:qa,drawPoints:function(){var a=this,b=a.options,c=a.chart.renderer,d;q(a.points,function(e){var f=e.plotY,g=e.graphic;if(f!==r&&!isNaN(f)&&e.y!==null){d=e.shapeArgs,g?(jb(g),g.animate(x(d))):e.graphic=c[e.shapeType](d).attr(e.pointAttr[e.selected?"select":""]).add(a.group).shadow(b.shadow,null,b.stacking&&!b.borderRadius)}else{if(g){e.graphic=g.destroy()}}})},drawTracker:function(){var a=this,b=a.chart,c=b.pointer,d=a.options.cursor,e=d&&{cursor:d},f=function(c){var d=c.target,e;if(b.hoverSeries!==a){a.onMouseOver()}for(;d&&!e;){e=d.point,d=d.parentNode}if(e!==r&&e!==b.hoverPoint){e.onMouseOver(c)}};q(a.points,function(a){if(a.graphic){a.graphic.element.point=a}if(a.dataLabel){a.dataLabel.element.point=a}});a._hasTracking?a._hasTracking=!0:q(a.trackerGroups,function(b){if(a[b]&&(a[b].addClass("highcharts-tracker").on("mouseover",f).on("mouseout",function(a){c.onTrackerMouseOut(a)}).css(e),ib)){a[b].on("touchstart",f)}})},alignDataLabel:function(a,b,c,d,e){var f=this.chart,g=f.inverted,h=a.dlBox||a.shapeArgs,i=a.below||a.plotY>o(this.translatedThreshold,f.plotSizeY),k=o(c.inside,!!this.options.stacking);if(h&&(d=x(h),g&&(d={x:f.plotWidth-d.y-d.height,y:f.plotHeight-d.x-d.width,width:d.height,height:d.width}),!k)){g?(d.x+=i?0:d.width,d.width=0):(d.y+=i?d.height:0,d.height=0)}c.align=o(c.align,!g||k?"center":i?"right":"left");c.verticalAlign=o(c.verticalAlign,g||k?"middle":i?"top":"bottom");W.prototype.alignDataLabel.call(this,a,b,c,d,e)},animate:function(a){var b=this.yAxis,c=this.options,d=this.chart.inverted,e={};if(ea){a?(e.scaleY=0.001,a=D(b.pos+b.len,u(b.pos,b.toPixels(c.threshold))),d?e.translateX=a-b.len:e.translateY=a,this.group.attr(e)):(e.scaleY=1,e[d?"translateX":"translateY"]=b.pos,this.group.animate(e,this.options.animation),this.animate=null)}},remove:function(){var a=this,b=a.chart;b.hasRendered&&q(b.series,function(b){if(b.type===a.type){b.isDirty=!0}});W.prototype.remove.apply(a,arguments)}});L.column=Y;Q.bar=x(Q.column);Ja=ca(Y,{type:"bar",inverted:!0});L.bar=Ja;Q.scatter=x(P,{lineWidth:0,tooltip:{headerFormat:'<span style="font-size: 10px; color:{series.color}">{series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>",followPointer:!0},stickyTracking:!1});Ja=ca(W,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["markerGroup"],drawTracker:Y.prototype.drawTracker,setTooltipPoints:qa});L.scatter=Ja;Q.pie=x(P,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],clip:!1,colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.name}},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:0.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});P={type:"pie",isCartesian:!1,pointClass:ca(Ia,{init:function(){Ia.prototype.init.apply(this,arguments);var a=this,b;if(a.y<0){a.y=null}v(a,{visible:a.visible!==!1,name:o(a.name,"Slice")});b=function(b){a.slice(b.type==="select")};E(a,"select",b);E(a,"unselect",b);return a},setVisible:function(a){var b=this,c=b.series,d=c.chart,e;b.visible=b.options.visible=a=a===r?!b.visible:a;c.options.data[va(b,c.data)]=b.options;e=a?"show":"hide";q(["graphic","dataLabel","connector","shadowGroup"],function(a){if(b[a]){b[a][e]()}});b.legendItem&&d.legend.colorizeItem(b,a);if(!c.isDirty&&c.options.ignoreHiddenPoint){c.isDirty=!0,d.redraw()}},slice:function(a,b,c){var d=this.series;Za(c,d.chart);o(b,!0);this.sliced=this.options.sliced=a=t(a)?a:!this.sliced;d.options.data[va(this,d.data)]=this.options;a=a?this.slicedTranslation:{translateX:0,translateY:0};this.graphic.animate(a);this.shadowGroup&&this.shadowGroup.animate(a)}}),requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},getColor:qa,animate:function(a){var b=this,c=b.points,d=b.startAngleRad;if(!a){q(c,function(a){var c=a.graphic,a=a.shapeArgs;c&&(c.attr({r:b.center[3]/2,start:d,end:d}),c.animate({r:a.r,start:a.start,end:a.end},b.options.animation))}),b.animate=null}},setData:function(a,b){W.prototype.setData.call(this,a,!1);this.processData();this.generatePoints();o(b,!0)&&this.chart.redraw()},generatePoints:function(){var a,b=0,c,d,e,f=this.options.ignoreHiddenPoint;W.prototype.generatePoints.call(this);c=this.points;d=c.length;for(a=0;a<d;a++){e=c[a],b+=f&&!e.visible?0:e.y}this.total=b;for(a=0;a<d;a++){e=c[a],e.percentage=e.y/b*100,e.total=b}},getCenter:function(){var a=this.options,b=this.chart,c=2*(a.slicedOffset||0),d,e=b.plotWidth-2*c,f=b.plotHeight-2*c,b=a.center,a=[o(b[0],"50%"),o(b[1],"50%"),a.size||"100%",a.innerSize||0],g=D(e,f),h;return Ga(a,function(a,b){h=/%$/.test(a);d=b<2||b===2&&h;return(h?[e,f,g,g][b]*z(a)/100:a)+(d?c:0)})},translate:function(a){this.generatePoints();var b=0,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f,g,h,i=this.startAngleRad=ab/180*((c.startAngle||0)%360-90),k=this.points,j=2*ab,l=c.dataLabels.distance,c=c.ignoreHiddenPoint,m,n=k.length,p;if(!a){this.center=a=this.getCenter()}this.getX=function(b,c){h=S.asin((b-a[1])/(a[2]/2+l));return a[0]+(c?-1:1)*da(h)*(a[2]/2+l)};for(m=0;m<n;m++){p=k[m];f=s((i+b*j)*1000)/1000;if(!c||p.visible){b+=p.percentage/100}g=s((i+b*j)*1000)/1000;p.shapeType="arc";p.shapeArgs={x:a[0],y:a[1],r:a[2]/2,innerR:a[3]/2,start:f,end:g};h=(g+f)/2;h>0.75*j&&(h-=2*ab);p.slicedTranslation={translateX:s(da(h)*d),translateY:s(ia(h)*d)};f=da(h)*a[2]/2;g=ia(h)*a[2]/2;p.tooltipPos=[a[0]+f*0.7,a[1]+g*0.7];p.half=h<j/4?0:1;p.angle=h;e=D(e,l/2);p.labelPos=[a[0]+f+da(h)*l,a[1]+g+ia(h)*l,a[0]+f+da(h)*e,a[1]+g+ia(h)*e,a[0]+f,a[1]+g,l<0?"center":p.half?"right":"left",h]}this.setTooltipPoints()},drawGraph:null,drawPoints:function(){var a=this,b=a.chart.renderer,c,d,e=a.options.shadow,f,g;if(e&&!a.shadowGroup){a.shadowGroup=b.g("shadow").add(a.group)}q(a.points,function(h){d=h.graphic;g=h.shapeArgs;f=h.shadowGroup;if(e&&!f){f=h.shadowGroup=b.g("shadow").add(a.shadowGroup)}c=h.sliced?h.slicedTranslation:{translateX:0,translateY:0};f&&f.attr(c);d?d.animate(v(g,c)):h.graphic=d=b.arc(g).setRadialReference(a.center).attr(h.pointAttr[h.selected?"select":""]).attr({"stroke-linejoin":"round"}).attr(c).add(a.group).shadow(e,f);h.visible===!1&&h.setVisible(!1)})},drawDataLabels:function(){var a=this,b=a.data,c,d=a.chart,e=a.options.dataLabels,f=o(e.connectorPadding,10),g=o(e.connectorWidth,1),h=d.plotWidth,d=d.plotHeight,i,k,j=o(e.softConnector,!0),l=e.distance,m=a.center,n=m[2]/2,p=m[1],K=l>0,y,w,r,t,x=[[],[]],v,A,D,z,J,C=[0,0,0,0],E=function(a,b){return b.y-a.y},H=function(a,b){a.sort(function(a,c){return a.angle!==void 0&&(c.angle-a.angle)*b})};if(a.visible&&(e.enabled||a._hasPointLabels)){W.prototype.drawDataLabels.apply(a);q(b,function(a){a.dataLabel&&x[a.half].push(a)});for(z=0;!t&&b[z];){t=b[z]&&b[z].dataLabel&&(b[z].dataLabel.getBBox().height||21),z++}for(z=2;z--;){var b=[],G=[],I=x[z],F=I.length,B;H(I,z-0.5);if(l>0){for(J=p-n-l;J<=p+n+l;J+=t){b.push(J)}w=b.length;if(F>w){c=[].concat(I);c.sort(E);for(J=F;J--;){c[J].rank=J}for(J=F;J--;){I[J].rank>=w&&I.splice(J,1)}F=I.length}for(J=0;J<F;J++){c=I[J];r=c.labelPos;c=9999;var N,L;for(L=0;L<w;L++){N=T(b[L]-r[1]),N<c&&(c=N,B=L)}if(B<J&&b[J]!==null){B=J}else{for(w<F-J+B&&b[J]!==null&&(B=w-F+J);b[B]===null;){B++}}G.push({i:B,y:b[B]});b[B]=null}G.sort(E)}for(J=0;J<F;J++){c=I[J];r=c.labelPos;y=c.dataLabel;D=c.visible===!1?"hidden":"visible";c=r[1];if(l>0){if(w=G.pop(),B=w.i,A=w.y,c>A&&b[B+1]!==null||c<A&&b[B-1]!==null){A=c}}else{A=c}v=e.justify?m[0]+(z?-1:1)*(n+l):a.getX(B===0||B===b.length-1?c:A,z);y._attr={visibility:D,align:r[6]};y._pos={x:v+e.x+({left:f,right:-f}[r[6]]||0),y:A+e.y-10};y.connX=v;y.connY=A;if(this.options.size===null){w=y.width,v-w<f?C[3]=u(s(w-v+f),C[3]):v+w>h-f&&(C[1]=u(s(v+w-h+f),C[1])),A-t/2<0?C[0]=u(s(-A+t/2),C[0]):A+t/2>d&&(C[2]=u(s(A+t/2-d),C[2]))}}}if(ta(C)===0||this.verifyDataLabelOverflow(C)){this.placeDataLabels(),K&&g&&q(this.points,function(b){i=b.connector;r=b.labelPos;if((y=b.dataLabel)&&y._pos){D=y._attr.visibility,v=y.connX,A=y.connY,k=j?["M",v+(r[6]==="left"?5:-5),A,"C",v,A,2*r[2]-r[4],2*r[3]-r[5],r[2],r[3],"L",r[4],r[5]]:["M",v+(r[6]==="left"?5:-5),A,"L",r[2],r[3],"L",r[4],r[5]],i?(i.animate({d:k}),i.attr("visibility",D)):b.connector=i=a.chart.renderer.path(k).attr({"stroke-width":g,stroke:e.connectorColor||b.color||"#606060",visibility:D}).add(a.group)}else{if(i){b.connector=i.destroy()}}})}}},verifyDataLabelOverflow:function(a){var b=this.center,c=this.options,d=c.center,e=c=c.minSize||80,f;d[0]!==null?e=u(b[2]-u(a[1],a[3]),c):(e=u(b[2]-a[1]-a[3],c),b[0]+=(a[3]-a[1])/2);d[1]!==null?e=u(D(e,b[2]-u(a[0],a[2])),c):(e=u(D(e,b[2]-a[0]-a[2]),c),b[1]+=(a[0]-a[2])/2);e<b[2]?(b[2]=e,this.translate(b),q(this.points,function(a){if(a.dataLabel){a.dataLabel._pos=null}}),this.drawDataLabels()):f=!0;return f},placeDataLabels:function(){q(this.points,function(a){var a=a.dataLabel,b;if(a){(b=a._pos)?(a.attr(a._attr),a[a.moved?"animate":"attr"](b),a.moved=!0):a&&a.attr({y:-999})}})},alignDataLabel:qa,drawTracker:Y.prototype.drawTracker,drawLegendSymbol:I.prototype.drawLegendSymbol,getSymbol:qa};P=ca(W,P);L.pie=P;var R=W.prototype,fc=R.processData,gc=R.generatePoints,hc=R.destroy,ic=R.tooltipHeaderFormatter,jc={approximation:"average",groupPixelWidth:2,dateTimeLabelFormats:lb(mb,["%A, %b %e, %H:%M:%S.%L","%A, %b %e, %H:%M:%S.%L","-%H:%M:%S.%L"],eb,["%A, %b %e, %H:%M:%S","%A, %b %e, %H:%M:%S","-%H:%M:%S"],Xa,["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],Ba,["%A, %b %e, %H:%M","%A, %b %e, %H:%M","-%H:%M"],fa,["%A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],Na,["Week from %A, %b %e, %Y","%A, %b %e","-%A, %b %e, %Y"],Oa,["%B %Y","%B","-%B %Y"],na,["%Y","%Y","-%Y"])},ac={line:{},spline:{},area:{},areaspline:{},column:{approximation:"sum",groupPixelWidth:10},arearange:{approximation:"range"},areasplinerange:{approximation:"range"},columnrange:{approximation:"range",groupPixelWidth:10},candlestick:{approximation:"ohlc",groupPixelWidth:10},ohlc:{approximation:"ohlc",groupPixelWidth:5}},bc=[[mb,[1,2,5,10,20,25,50,100,200,500]],[eb,[1,2,5,10,15,30]],[Xa,[1,2,5,10,15,30]],[Ba,[1,2,3,4,6,8,12]],[fa,[1]],[Na,[1]],[Oa,[1,3,6]],[na,null]],Ka={sum:function(a){var b=a.length,c;if(!b&&a.hasNulls){c=null}else{if(b){for(c=0;b--;){c+=a[b]}}}return c},average:function(a){var b=a.length,a=Ka.sum(a);typeof a==="number"&&b&&(a/=b);return a},open:function(a){return a.length?a[0]:a.hasNulls?null:r},high:function(a){return a.length?ta(a):a.hasNulls?null:r},low:function(a){return a.length?Qa(a):a.hasNulls?null:r},close:function(a){return a.length?a[a.length-1]:a.hasNulls?null:r},ohlc:function(a,b,c,d){a=Ka.open(a);b=Ka.high(b);c=Ka.low(c);d=Ka.close(d);if(typeof a==="number"||typeof b==="number"||typeof c==="number"||typeof d==="number"){return[a,b,c,d]}},range:function(a,b){a=Ka.low(a);b=Ka.high(b);if(typeof a==="number"||typeof b==="number"){return[a,b]}}};R.groupData=function(a,b,c,d){var e=this.data,f=this.options.data,g=[],h=[],i=a.length,k,j,l=!!b,m=[[],[],[],[]],d=typeof d==="function"?d:Ka[d],n=this.pointArrayMap,p=n&&n.length,o;for(o=0;o<=i;o++){for(;c[1]!==r&&a[o]>=c[1]||o===i;){if(k=c.shift(),j=d.apply(0,m),j!==r&&(g.push(k),h.push(j)),m[0]=[],m[1]=[],m[2]=[],m[3]=[],o===i){break}}if(o===i){break}if(n){k=this.cropStart+o;k=e&&e[k]||this.pointClass.prototype.applyOptions.apply({series:this},[f[k]]);var q;for(j=0;j<p;j++){if(q=k[n[j]],typeof q==="number"){m[j].push(q)}else{if(q===null){m[j].hasNulls=!0}}}}else{if(k=l?b[o]:null,typeof k==="number"){m[0].push(k)}else{if(k===null){m[0].hasNulls=!0}}}}return[g,h]};R.processData=function(){var a=this.chart,b=this.options,c=b.dataGrouping,d=c&&o(c.enabled,a.options._stock),e;this.forceCrop=d;if(fc.apply(this,arguments)!==!1&&d){this.destroyGroupedData();var f=this.processedXData,g=this.processedYData,h=a.plotSizeX,i=this.xAxis,k=i.getGroupPixelWidth&&i.getGroupPixelWidth(),a=this.pointRange;if(k){e=!0;this.points=null;var d=i.getExtremes(),a=d.min,d=d.max,j=i.getGroupIntervalFactor&&i.getGroupIntervalFactor(a,d,f)||1,h=k*(d-a)/h*j,i=(i.getNonLinearTimeTicks||fb)(zb(h,c.units||bc),a,d,null,f,this.closestPointRange),g=R.groupData.apply(this,[f,g,i,c.approximation]),f=g[0],g=g[1];if(c.smoothed){c=f.length-1;for(f[c]=d;c--&&c>0;){f[c]+=h/2}f[0]=a}this.currentDataGrouping=i.info;if(b.pointRange===null){this.pointRange=i.info.totalRange}this.closestPointRange=i.info.totalRange;this.processedXData=f;this.processedYData=g}else{this.currentDataGrouping=null,this.pointRange=a}this.hasGroupedData=e}};R.destroyGroupedData=function(){var a=this.groupedData;q(a||[],function(b,c){b&&(a[c]=b.destroy?b.destroy():null)});this.groupedData=null};R.generatePoints=function(){gc.apply(this);this.destroyGroupedData();this.groupedData=this.hasGroupedData?this.points:null};R.tooltipHeaderFormatter=function(a){var b=this.tooltipOptions,c=this.options.dataGrouping,d=b.xDateFormat,e,f=this.xAxis,g,h;if(f&&f.options.type==="datetime"&&c&&ra(a.key)){g=this.currentDataGrouping;c=c.dateTimeLabelFormats;if(g){f=c[g.unitName],g.count===1?d=f[0]:(d=f[1],e=f[2])}else{if(!d&&c){for(h in H){if(H[h]>=f.closestPointRange){d=c[h][0];break}}}}d=Aa(d,a.key);e&&(d+=Aa(e,a.key+g.totalRange-1));a=b.headerFormat.replace("{point.key}",d)}else{a=ic.call(this,a)}return a};R.destroy=function(){for(var a=this.groupedData||[],b=a.length;b--;){a[b]&&a[b].destroy()}hc.apply(this)};ma(R,"setOptions",function(a,b){var c=a.call(this,b),d=this.type,e=this.chart.options.plotOptions,f=Q[d].dataGrouping;if(ac[d]){f||(f=x(jc,ac[d])),c.dataGrouping=x(f,e.series&&e.series.dataGrouping,e[d].dataGrouping,b.dataGrouping)}if(this.chart.options._stock){this.requireSorting=!0}return c});ua.prototype.getGroupPixelWidth=function(){var a=this.series,b=a.length,c,d=0,e=!1,f;for(c=b;c--;){(f=a[c].options.dataGrouping)&&(d=u(d,f.groupPixelWidth))}for(c=b;c--;){if(f=a[c].options.dataGrouping){if(b=(a[c].processedXData||a[c].data).length,a[c].hasGroupedData||b>this.chart.plotSizeX/d||b&&f.forced){e=!0}}}return e?d:0};Q.ohlc=x(Q.column,{lineWidth:1,tooltip:{pointFormat:'<span style="color:{series.color};font-weight:bold">{series.name}</span><br/>Open: {point.open}<br/>High: {point.high}<br/>Low: {point.low}<br/>Close: {point.close}<br/>'},states:{hover:{lineWidth:3}},threshold:null});P=ca(L.column,{type:"ohlc",pointArrayMap:["open","high","low","close"],toYData:function(a){return[a.open,a.high,a.low,a.close]},pointValKey:"high",pointAttrToOptions:{stroke:"color","stroke-width":"lineWidth"},upColorProp:"stroke",getAttribs:function(){L.column.prototype.getAttribs.apply(this,arguments);var a=this.options,b=a.states,a=a.upColor||this.color,c=x(this.pointAttr),d=this.upColorProp;c[""][d]=a;c.hover[d]=b.hover.upColor||a;c.select[d]=b.select.upColor||a;q(this.points,function(a){if(a.open<a.close){a.pointAttr=c}})},translate:function(){var a=this.yAxis;L.column.prototype.translate.apply(this);q(this.points,function(b){if(b.open!==null){b.plotOpen=a.translate(b.open,0,1,0,1)}if(b.close!==null){b.plotClose=a.translate(b.close,0,1,0,1)}})},drawPoints:function(){var a=this,b=a.chart,c,d,e,f,g,h,i,k;q(a.points,function(j){if(j.plotY!==r){i=j.graphic,c=j.pointAttr[j.selected?"selected":""],f=c["stroke-width"]%2/2,k=s(j.plotX)+f,g=s(j.shapeArgs.width/2),h=["M",k,s(j.yBottom),"L",k,s(j.plotY)],j.open!==null&&(d=s(j.plotOpen)+f,h.push("M",k,d,"L",k-g,d)),j.close!==null&&(e=s(j.plotClose)+f,h.push("M",k,e,"L",k+g,e)),i?i.animate({d:h}):j.graphic=b.renderer.path(h).attr(c).add(a.group)}})},animate:null});L.ohlc=P;Q.candlestick=x(Q.column,{lineColor:"black",lineWidth:1,states:{hover:{lineWidth:2}},tooltip:Q.ohlc.tooltip,threshold:null,upColor:"white"});P=ca(P,{type:"candlestick",pointAttrToOptions:{fill:"color",stroke:"lineColor","stroke-width":"lineWidth"},upColorProp:"fill",drawPoints:function(){var a=this,b=a.chart,c,d,e,f,g,h,i,k,j,l,m,n;q(a.points,function(p){l=p.graphic;if(p.plotY!==r){c=p.pointAttr[p.selected?"selected":""],k=c["stroke-width"]%2/2,j=s(p.plotX)+k,d=p.plotOpen,e=p.plotClose,f=S.min(d,e),g=S.max(d,e),n=s(p.shapeArgs.width/2),h=s(f)!==s(p.plotY),i=g!==p.yBottom,f=s(f)+k,g=s(g)+k,m=["M",j-n,g,"L",j-n,f,"L",j+n,f,"L",j+n,g,"L",j-n,g,"M",j,f,"L",j,h?s(p.plotY):f,"M",j,g,"L",j,i?s(p.yBottom):g,"Z"],l?l.animate({d:m}):p.graphic=b.renderer.path(m).attr(c).add(a.group).shadow(a.options.shadow)}})}});L.candlestick=P;var wb=Ha.prototype.symbols;Q.flags=x(Q.column,{dataGrouping:null,fillColor:"white",lineWidth:1,pointRange:0,shape:"flag",stackDistance:12,states:{hover:{lineColor:"black",fillColor:"#FCFFC5"}},style:{fontSize:"11px",fontWeight:"bold",textAlign:"center"},tooltip:{pointFormat:"{point.text}<br/>"},threshold:null,y:-30});L.flags=ca(L.column,{type:"flags",sorted:!1,noSharedTooltip:!0,takeOrdinalPosition:!1,forceCrop:!0,init:W.prototype.init,pointAttrToOptions:{fill:"fillColor",stroke:"color","stroke-width":"lineWidth",r:"radius"},translate:function(){L.column.prototype.translate.apply(this);var a=this.chart,b=this.points,c=b.length-1,d,e,f=this.options.onSeries,f=(d=f&&a.get(f))&&d.options.step,g=d&&d.points,h=g&&g.length,i=this.xAxis,k=i.getExtremes(),j,l,m;if(d&&d.visible&&h){l=g[h-1].x;for(b.sort(function(a,b){return a.x-b.x});h--&&b[c];){if(d=b[c],j=g[h],j.x<=d.x&&j.plotY!==r){if(d.x<=l){d.plotY=j.plotY,j.x<d.x&&!f&&(m=g[h+1])&&m.plotY!==r&&(d.plotY+=(d.x-j.x)/(m.x-j.x)*(m.plotY-j.plotY))}c--;h++;if(c<0){break}}}}q(b,function(c,d){if(c.plotY===r){c.x>=k.min&&c.x<=k.max?c.plotY=i.lineTop-a.plotTop:c.shapeArgs={}}if((e=b[d-1])&&e.plotX===c.plotX){if(e.stackIndex===r){e.stackIndex=0}c.stackIndex=e.stackIndex+1}})},drawPoints:function(){var a,b=this.points,c=this.chart.renderer,d,e,f=this.options,g=f.y,h,i,k,j,l,m=f.lineWidth%2/2,n;for(k=b.length;k--;){if(j=b[k],d=j.plotX+m,a=j.stackIndex,h=j.options.shape||f.shape,e=j.plotY,e!==r&&(e=j.plotY+g+m-(a!==r&&a*f.stackDistance)),i=a?r:j.plotX+m,n=a?r:j.plotY,l=j.graphic,e!==r){a=j.pointAttr[j.selected?"select":""],l?l.attr({x:d,y:e,r:a.r,anchorX:i,anchorY:n}):l=j.graphic=c.label(j.options.title||f.title||"A",d,e,h,i,n,f.useHTML).css(x(f.style,j.style)).attr(a).attr({align:h==="flag"?"left":"center",width:f.width,height:f.height}).add(this.group).shadow(f.shadow),i=l.box,a=i.getBBox(),j.shapeArgs=v(a,{x:d-(h==="flag"?0:i.attr("width")/2),y:e})}else{if(l){j.graphic=l.destroy()}}}},drawTracker:function(){var a=this.points;L.column.prototype.drawTracker.apply(this);q(a,function(b){var c=b.graphic;c&&E(c.element,"mouseover",function(){if(b.stackIndex>0&&!b.raised){b._y=c.y,c.attr({y:b._y-8}),b.raised=!0}q(a,function(a){if(a!==b&&a.raised&&a.graphic){a.graphic.attr({y:a._y}),a.raised=!1}})})})},animate:qa});wb.flag=function(a,b,c,d,e){var f=e&&e.anchorX||a,e=e&&e.anchorY||b;return["M",f,e,"L",a,b+d,a,b,a+c,b,a+c,b+d,a,b+d,"M",f,e,"Z"]};q(["circle","square"],function(a){wb[a+"pin"]=function(b,c,d,e,f){var g=f&&f.anchorX,f=f&&f.anchorY,b=wb[a](b,c,d,e);g&&f&&b.push("M",g,c>f?c:c+e,"L",g,f);return b}});bb===kb&&q(["flag","circlepin","squarepin"],function(a){kb.prototype.symbols[a]=wb[a]});P=lb("linearGradient",{x1:0,y1:0,x2:0,y2:1},"stops",[[0,"#FFF"],[1,"#CCC"]]);I=[].concat(bc);I[4]=[fa,[1,2,3,4]];I[5]=[Na,[1,2,3]];v(N,{navigator:{handles:{backgroundColor:"#FFF",borderColor:"#666"},height:40,margin:10,maskFill:"rgba(255, 255, 255, 0.75)",outlineColor:"#444",outlineWidth:1,series:{type:"areaspline",color:"#4572A7",compare:null,fillOpacity:0.4,dataGrouping:{approximation:"average",groupPixelWidth:2,smoothed:!0,units:I},dataLabels:{enabled:!1,zIndex:2},id:"highcharts-navigator-series",lineColor:"#4572A7",lineWidth:1,marker:{enabled:!1},pointRange:0,shadow:!1,threshold:null},xAxis:{tickWidth:0,lineWidth:0,gridLineWidth:1,tickPixelInterval:200,labels:{align:"left",x:3,y:-4}},yAxis:{gridLineWidth:0,startOnTick:!1,endOnTick:!1,minPadding:0.1,maxPadding:0.1,labels:{enabled:!1},title:{text:null},tickWidth:0}},scrollbar:{height:hb?20:14,barBackgroundColor:P,barBorderRadius:2,barBorderWidth:1,barBorderColor:"#666",buttonArrowColor:"#666",buttonBackgroundColor:P,buttonBorderColor:"#666",buttonBorderRadius:2,buttonBorderWidth:1,minWidth:6,rifleColor:"#666",trackBackgroundColor:lb("linearGradient",{x1:0,y1:0,x2:0,y2:1},"stops",[[0,"#EEE"],[1,"#FFF"]]),trackBorderColor:"#CCC",trackBorderWidth:1,liveRedraw:ea&&!hb}});Ib.prototype={drawHandle:function(a,b){var c=this.chart,d=c.renderer,e=this.elementsToDestroy,f=this.handles,g=this.navigatorOptions.handles,g={fill:g.backgroundColor,stroke:g.borderColor,"stroke-width":1},h;this.rendered||(f[b]=d.g().css({cursor:"e-resize"}).attr({zIndex:4-b}).add(),h=d.rect(-4.5,0,9,16,3,1).attr(g).add(f[b]),e.push(h),h=d.path(["M",-1.5,4,"L",-1.5,12,"M",0.5,4,"L",0.5,12]).attr(g).add(f[b]),e.push(h));f[b][c.isResizing?"animate":"attr"]({translateX:this.scrollerLeft+this.scrollbarHeight+parseInt(a,10),translateY:this.top+this.height/2-8})},drawScrollbarButton:function(a){var b=this.chart.renderer,c=this.elementsToDestroy,d=this.scrollbarButtons,e=this.scrollbarHeight,f=this.scrollbarOptions,g;this.rendered||(d[a]=b.g().add(this.scrollbarGroup),g=b.rect(-0.5,-0.5,e+1,e+1,f.buttonBorderRadius,f.buttonBorderWidth).attr({stroke:f.buttonBorderColor,"stroke-width":f.buttonBorderWidth,fill:f.buttonBackgroundColor}).add(d[a]),c.push(g),g=b.path(["M",e/2+(a?-1:1),e/2-3,"L",e/2+(a?-1:1),e/2+3,e/2+(a?2:-2),e/2]).attr({fill:f.buttonArrowColor}).add(d[a]),c.push(g));a&&d[a].attr({translateX:this.scrollerWidth-e})},render:function(a,b,c,d){var e=this.chart,f=e.renderer,g,h,i,k,j=this.scrollbarGroup,l=this.navigatorGroup,m=this.scrollbar,l=this.xAxis,n=this.scrollbarTrack,p=this.scrollbarHeight,q=this.scrollbarEnabled,y=this.navigatorOptions,w=this.scrollbarOptions,t=w.minWidth,x=this.height,v=this.top,C=this.navigatorEnabled,A=y.outlineWidth,B=A/2,E=0,J=this.outlineHeight,I=w.barBorderRadius,F=w.barBorderWidth,G=v+B;if(!isNaN(a)){this.navigatorLeft=g=o(l.left,e.plotLeft+p);this.navigatorWidth=h=o(l.len,e.plotWidth-2*p);this.scrollerLeft=i=g-p;this.scrollerWidth=k=k=h+2*p;if(l.getExtremes){var H=e.xAxis[0].getExtremes(),N=H.dataMin===null,L=l.getExtremes(),P=D(H.dataMin,L.dataMin),H=u(H.dataMax,L.dataMax);!N&&(P!==L.min||H!==L.max)&&l.setExtremes(P,H,!0,!1)}h===0||s(a)===s(b)&&c===r?(c=0,d=k):(c=o(c,l.translate(a)),d=o(d,l.translate(b)));this.zoomedMax=a=D(z(u(c,d)),h);this.zoomedMin=d=this.fixedWidth?a-this.fixedWidth:u(z(D(c,d)),0);this.range=c=a-d;if(!this.rendered){if(C){this.navigatorGroup=l=f.g("navigator").attr({zIndex:3}).add(),this.leftShade=f.rect().attr({fill:y.maskFill}).add(l),this.rightShade=f.rect().attr({fill:y.maskFill}).add(l),this.outline=f.path().attr({"stroke-width":A,stroke:y.outlineColor}).add(l)}if(q){this.scrollbarGroup=j=f.g("scrollbar").add(),m=w.trackBorderWidth,this.scrollbarTrack=n=f.rect().attr({y:-m%2/2,fill:w.trackBackgroundColor,stroke:w.trackBorderColor,"stroke-width":m,r:w.trackBorderRadius||0,height:p}).add(j),this.scrollbar=m=f.rect().attr({y:-F%2/2,height:p,fill:w.barBackgroundColor,stroke:w.barBorderColor,"stroke-width":F,r:I}).add(j),this.scrollbarRifles=f.path().attr({stroke:w.rifleColor,"stroke-width":1}).add(j)}}e=e.isResizing?"animate":"attr";C&&(this.leftShade[e]({x:g,y:v,width:d,height:x}),this.rightShade[e]({x:g+a,y:v,width:h-a,height:x}),this.outline[e]({d:["M",i,G,"L",g+d+B,G,g+d+B,G+J-p,"M",g+a-B,G+J-p,"L",g+a-B,G,i+k,G]}),this.drawHandle(d+B,0),this.drawHandle(a+B,1));if(q&&j){this.drawScrollbarButton(0),this.drawScrollbarButton(1),j[e]({translateX:i,translateY:s(G+x)}),n[e]({width:k}),g=p+d,h=c-F,h<t&&(E=(t-h)/2,h=t,g-=E),this.scrollbarPad=E,m[e]({x:U(g)+F%2/2,width:h}),t=p+d+c/2-0.5,this.scrollbarRifles.attr({visibility:c>12?"visible":"hidden"})[e]({d:["M",t-3,p/4,"L",t-3,2*p/3,"M",t,p/4,"L",t,2*p/3,"M",t+3,p/4,"L",t+3,2*p/3]})}this.scrollbarPad=E;this.rendered=!0}},addEvents:function(){var a=this.chart.container,b=this.mouseDownHandler,c=this.mouseMoveHandler,d=this.mouseUpHandler,e;e=[[a,"mousedown",b],[a,"mousemove",c],[document,"mouseup",d]];ib&&e.push([a,"touchstart",b],[a,"touchmove",c],[document,"touchend",d]);q(e,function(a){E.apply(null,a)});this._events=e},removeEvents:function(){q(this._events,function(a){V.apply(null,a)});this._events=r;this.navigatorEnabled&&this.baseSeries&&V(this.baseSeries,"updatedData",this.updatedDataHandler)},init:function(){var a=this,b=a.chart,c,d,e=a.scrollbarHeight,f=a.navigatorOptions,g=a.height,h=a.top,i,k,j=document.body.style,l,m=a.baseSeries;a.mouseDownHandler=function(d){var d=b.pointer.normalize(d),e=a.zoomedMin,f=a.zoomedMax,h=a.top,k=a.scrollbarHeight,m=a.scrollerLeft,n=a.scrollerWidth,p=a.navigatorLeft,o=a.navigatorWidth,q=a.scrollbarPad,r=a.range,t=d.chartX,s=d.chartY,d=b.xAxis[0],u=hb?10:7;if(s>h&&s<h+g+k){if((h=!a.scrollbarEnabled||s<h+g)&&S.abs(t-e-p)<u){a.grabbedLeft=!0,a.otherHandlePos=f}else{if(h&&S.abs(t-f-p)<u){a.grabbedRight=!0,a.otherHandlePos=e}else{if(t>p+e-q&&t<p+f+q){a.grabbedCenter=t;a.fixedWidth=r;if(b.renderer.isSVG){l=j.cursor,j.cursor="ew-resize"}i=t-e}else{if(t>m&&t<m+n&&(f=h?t-p-r/2:t<p?e-D(10,r):t>m+n-k?e+D(10,r):t<p+e?e-r:f,f<0?f=0:f+r>o&&(f=o-r),f!==e)){a.fixedWidth=r;if(!d.ordinalPositions){b.fixedRange=d.max-d.min}e=c.translate(f,!0);d.setExtremes(e,b.fixedRange?e+b.fixedRange:c.translate(f+r,!0),!0,!1,{trigger:"navigator"})}}}}}};a.mouseMoveHandler=function(c){var d=a.scrollbarHeight,e=a.navigatorLeft,f=a.navigatorWidth,g=a.scrollerLeft,h=a.scrollerWidth,j=a.range,l;if(c.pageX!==0){c=b.pointer.normalize(c),l=c.chartX,l<e?l=e:l>g+h-d&&(l=g+h-d),a.grabbedLeft?(k=!0,a.render(0,0,l-e,a.otherHandlePos)):a.grabbedRight?(k=!0,a.render(0,0,a.otherHandlePos,l-e)):a.grabbedCenter&&(k=!0,l<i?l=i:l>f+i-j&&(l=f+i-j),a.render(0,0,l-i,l-i+j)),k&&a.scrollbarOptions.liveRedraw&&setTimeout(function(){a.mouseUpHandler(c)},0)}};a.mouseUpHandler=function(d){k&&b.xAxis[0].setExtremes(c.translate(a.zoomedMin,!0),c.translate(a.zoomedMax,!0),!0,!1,{trigger:"navigator",DOMEvent:d});if(d.type!=="mousemove"){a.grabbedLeft=a.grabbedRight=a.grabbedCenter=a.fixedWidth=k=i=null,j.cursor=l||""}};var n=b.xAxis.length,p=b.yAxis.length;b.extraBottomMargin=a.outlineHeight+f.margin;a.navigatorEnabled?(a.xAxis=c=new ua(b,x({ordinal:m&&m.xAxis.options.ordinal},f.xAxis,{id:"navigator-x-axis",isX:!0,type:"datetime",index:n,height:g,offset:0,offsetLeft:e,offsetRight:-e,startOnTick:!1,endOnTick:!1,minPadding:0,maxPadding:0,zoomEnabled:!1})),a.yAxis=d=new ua(b,x(f.yAxis,{id:"navigator-y-axis",alignTicks:!1,height:g,offset:0,index:p,zoomEnabled:!1})),m||f.series.data?a.addBaseSeries():b.series.length===0&&ma(b,"redraw",function(c,d){if(b.series.length>0&&!a.series){a.setBaseSeries(),b.redraw=c}c.call(b,d)})):a.xAxis=c={translate:function(a,c){var d=b.xAxis[0].getExtremes(),f=b.plotWidth-2*e,g=d.dataMin,d=d.dataMax-g;return c?a*d/f+g:f*(a-g)/d}};ma(b,"getMargins",function(b){var e=this.legend,f=e.options;b.call(this);a.top=h=a.navigatorOptions.top||this.chartHeight-a.height-a.scrollbarHeight-this.options.chart.spacingBottom-(f.verticalAlign==="bottom"&&f.enabled&&!f.floating?e.legendHeight+o(f.margin,10):0);if(c&&d){c.options.top=d.options.top=h,c.setAxisSize(),d.setAxisSize()}});a.addEvents()},setBaseSeries:function(a){var b=this.chart,a=a||b.options.navigator.baseSeries;this.series&&this.series.remove();this.baseSeries=b.series[a]||typeof a==="string"&&b.get(a)||b.series[0];this.xAxis&&this.addBaseSeries()},addBaseSeries:function(){var a=this.baseSeries,b=a?a.options:{},c=b.data,d=this.navigatorOptions.series,e;e=d.data;this.hasNavigatorData=!!e;b=x(b,d,{clip:!1,enableMouseTracking:!1,group:"nav",padXAxis:!1,xAxis:"navigator-x-axis",yAxis:"navigator-y-axis",name:"Navigator",showInLegend:!1,isInternal:!0,visible:!0});b.data=e||c;this.series=this.chart.initSeries(b);if(a&&this.navigatorOptions.adaptToUpdatedData!==!1){E(a,"updatedData",this.updatedDataHandler),a.userOptions.events=v(a.userOptions.event,{updatedData:this.updatedDataHandler})}},updatedDataHandler:function(){var a=this.chart.scroller,b=a.baseSeries,c=b.xAxis,d=c.getExtremes(),e=d.min,f=d.max,g=d.dataMin,d=d.dataMax,h=f-e,i,k,j,l,m,n=a.series;i=n.xData;var p=!!c.setExtremes;k=f>=i[i.length-1]-(this.closestPointRange||0);i=e<=g;if(!a.hasNavigatorData){n.options.pointStart=b.xData[0],n.setData(b.options.data,!1),m=!0}i&&(l=g,j=l+h);k&&(j=d,i||(l=u(j-h,n.xData[0])));p&&(i||k)?isNaN(l)||c.setExtremes(l,j,!0,!1,{trigger:"updatedData"}):(m&&this.chart.redraw(!1),a.render(u(e,g),D(f,d)))},destroy:function(){this.removeEvents();q([this.xAxis,this.yAxis,this.leftShade,this.rightShade,this.outline,this.scrollbarTrack,this.scrollbarRifles,this.scrollbarGroup,this.scrollbar],function(a){a&&a.destroy&&a.destroy()});this.xAxis=this.yAxis=this.leftShade=this.rightShade=this.outline=this.scrollbarTrack=this.scrollbarRifles=this.scrollbarGroup=this.scrollbar=null;q([this.scrollbarButtons,this.handles,this.elementsToDestroy],function(a){Ca(a)})}};Highcharts.Scroller=Ib;ma(ua.prototype,"zoom",function(a,b,c){var d=this.chart,e=d.options,f=e.chart.zoomType,g=e.navigator,e=e.rangeSelector,h;if(this.isXAxis&&(g&&g.enabled||e&&e.enabled)){if(f==="x"){d.resetZoomButton="blocked"}else{if(f==="y"){h=!1}else{if(f==="xy"){d=this.previousZoom,t(b)?this.previousZoom=[this.min,this.max]:d&&(b=d[0],c=d[1],delete this.previousZoom)}}}}return h!==r?h:a.call(this,b,c)});ma(Ta.prototype,"init",function(a,b,c){E(this,"beforeRender",function(){var a=this.options;if(a.navigator.enabled||a.scrollbar.enabled){this.scroller=new Ib(this)}});a.call(this,b,c)});v(N,{rangeSelector:{buttonTheme:{width:28,height:16,padding:1,r:0,stroke:"#68A",zIndex:7},inputPosition:{align:"right"},labelStyle:{color:"#666"}}});N.lang=x(N.lang,{rangeSelectorZoom:"Zoom",rangeSelectorFrom:"From",rangeSelectorTo:"To"});Jb.prototype={clickButton:function(a,b,c){var d=this,e=d.selected,f=d.chart,g=d.buttons,h=f.xAxis[0],i=h&&h.getExtremes(),k=f.scroller&&f.scroller.xAxis,j=k&&k.getExtremes&&k.getExtremes(),k=j&&j.dataMin,j=j&&j.dataMax,l=i&&i.dataMin,m=i&&i.dataMax,n=(t(l)&&t(k)?D:o)(l,k),p=(t(m)&&t(j)?u:o)(m,j),s,i=h&&D(i.max,o(p,i.max)),k=new Date(i),j=b.type,l=b.count,y,w,m={millisecond:1,second:1000,minute:60000,hour:3600000,day:86400000,week:604800000};if(!(n===null||p===null||a===d.selected)){if(m[j]){y=m[j]*l,s=u(i-y,n)}else{if(j==="month"||j==="year"){y={month:"Month",year:"FullYear"}[j],k["set"+y](k["get"+y]()-l),s=u(k.getTime(),o(n,Number.MIN_VALUE)),y={month:30,year:365}[j]*86400000*l}else{if(j==="ytd"){if(h){if(p===r){n=Number.MAX_VALUE,p=Number.MIN_VALUE,q(f.series,function(a){a=a.xData;n=D(a[0],n);p=u(a[a.length-1],p)}),c=!1}i=new Date(p);w=i.getFullYear();s=w=u(n||0,Date.UTC(w,0,1));i=i.getTime();i=D(p||i,i)}else{E(f,"beforeRender",function(){d.clickButton(a,b)});return}}else{j==="all"&&h&&(s=n,i=p)}}}g[e]&&g[e].setState(0);g[a]&&g[a].setState(2);f.fixedRange=y;h?h.setExtremes(s,i,o(c,1),0,{trigger:"rangeSelectorButton",rangeSelectorButton:b}):(c=f.options.xAxis,c[0]=x(c[0],{range:y,min:w}));d.selected=a}},defaultButtons:[{type:"month",count:1,text:"1m"},{type:"month",count:3,text:"3m"},{type:"month",count:6,text:"6m"},{type:"ytd",text:"YTD"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],init:function(a){var b=this,c=a.options.rangeSelector,d=c.buttons||[].concat(b.defaultButtons),e=b.buttons=[],c=c.selected,f=b.blurInputs=function(){var a=b.minInput,c=b.maxInput;a&&a.blur();c&&c.blur()};b.chart=a;a.extraTopMargin=25;b.buttonOptions=d;E(a.container,"mousedown",f);E(a,"resize",f);c!==r&&d[c]&&this.clickButton(c,d[c],!1);E(a,"load",function(){E(a.xAxis[0],"afterSetExtremes",function(){if(a.fixedRange!==this.max-this.min){e[b.selected]&&!a.renderer.forExport&&e[b.selected].setState(0),b.selected=a.fixedRange=null}})})},setInputValue:function(a,b){var c=this.chart.options.rangeSelector;if(t(b)){this[a+"Input"].HCTime=b}this[a+"Input"].value=Aa(c.inputEditDateFormat||"%Y-%m-%d",this[a+"Input"].HCTime);this[a+"DateBox"].attr({text:Aa(c.inputDateFormat||"%b %e, %Y",this[a+"Input"].HCTime)})},drawInput:function(a){var b=this,c=b.chart,d=c.options.chart.style,e=c.renderer,f=c.options.rangeSelector,g=b.div,h=a==="min",i,k,j,l=this.inputGroup;this[a+"Label"]=k=e.label(N.lang[h?"rangeSelectorFrom":"rangeSelectorTo"],this.inputGroup.offset).attr({padding:1}).css(x(d,f.labelStyle)).add(l);l.offset+=k.width+5;this[a+"DateBox"]=j=e.label("",l.offset).attr({padding:1,width:90,height:16,stroke:"silver","stroke-width":1}).css(x({textAlign:"center"},d,f.inputStyle)).on("click",function(){b[a+"Input"].focus()}).add(l);l.offset+=j.width+(h?10:0);this[a+"Input"]=i=Z("input",{name:a,className:"highcharts-range-selector",type:"text"},v({position:"absolute",border:0,width:"1px",height:"1px",padding:0,textAlign:"center",fontSize:d.fontSize,fontFamily:d.fontFamily,top:c.plotTop+"px"},f.inputStyle),g);i.onfocus=function(){F(this,{left:l.translateX+j.x+"px",top:l.translateY+"px",width:j.width-2+"px",height:j.height-2+"px",border:"2px solid silver"})};i.onblur=function(){F(this,{border:0,width:"1px",height:"1px"});b.setInputValue(a)};i.onchange=function(){var a=i.value,d=(f.inputDateParser||Date.parse)(a),e=c.xAxis[0].getExtremes();isNaN(d)&&(d=a.split("-"),d=Date.UTC(z(d[0]),z(d[1])-1,z(d[2])));if(!isNaN(d)&&(N.global.useUTC||(d+=(new Date).getTimezoneOffset()*60000),h&&d>=e.dataMin&&d<=b.maxInput.HCTime||!h&&d<=e.dataMax&&d>=b.minInput.HCTime)){c.xAxis[0].setExtremes(h?d:e.min,h?e.max:d,r,r,{trigger:"rangeSelectorInput"})}}},render:function(a,b){var c=this,d=c.chart,e=d.renderer,f=d.container,g=d.options,h=g.exporting&&g.navigation&&g.navigation.buttonOptions,i=g.rangeSelector,k=c.buttons,j=N.lang,l=c.div,l=c.inputGroup,m=i.buttonTheme,n=i.inputEnabled!==!1,p=m&&m.states,o=d.plotLeft,r;if(!c.rendered&&(c.zoomText=e.text(j.rangeSelectorZoom,o,d.plotTop-10).css(i.labelStyle).add(),r=o+c.zoomText.getBBox().width+5,q(c.buttonOptions,function(a,b){k[b]=e.button(a.text,r,d.plotTop-25,function(){c.clickButton(b,a);c.isActive=!0},m,p&&p.hover,p&&p.select).css({textAlign:"center"}).add();r+=k[b].width+(i.buttonSpacing||0);c.selected===b&&k[b].setState(2)}),n)){c.div=l=Z("div",null,{position:"relative",height:0,zIndex:1}),f.parentNode.insertBefore(l,f),c.inputGroup=l=e.g("input-group").add(),l.offset=0,c.drawInput("min"),c.drawInput("max")}n&&(f=d.plotTop-35,l.align(v({y:f,width:l.offset,x:h&&f<(h.y||0)+h.height-g.chart.spacingTop?-40:0},i.inputPosition),!0,d.spacingBox),c.setInputValue("min",a),c.setInputValue("max",b));c.rendered=!0},destroy:function(){var a=this.minInput,b=this.maxInput,c=this.chart,d=this.blurInputs,e;V(c.container,"mousedown",d);V(c,"resize",d);Ca(this.buttons);if(a){a.onfocus=a.onblur=a.onchange=null}if(b){b.onfocus=b.onblur=b.onchange=null}for(e in this){this[e]&&e!=="chart"&&(this[e].destroy?this[e].destroy():this[e].nodeType&&Ya(this[e])),this[e]=null}}};ma(Ta.prototype,"init",function(a,b,c){E(this,"init",function(){if(this.options.rangeSelector.enabled){this.rangeSelector=new Jb(this)}});a.call(this,b,c)});Highcharts.RangeSelector=Jb;Ta.prototype.callbacks.push(function(a){function b(){f=a.xAxis[0].getExtremes();g.render(u(f.min,f.dataMin),D(f.max,o(f.dataMax,Number.MAX_VALUE)))}function c(){f=a.xAxis[0].getExtremes();isNaN(f.min)||h.render(f.min,f.max)}function d(a){g.render(a.min,a.max)}function e(a){h.render(a.min,a.max)}var f,g=a.scroller,h=a.rangeSelector;g&&(E(a.xAxis[0],"afterSetExtremes",d),ma(a,"drawChartBox",function(a){var c=this.isDirtyBox;a.call(this);c&&b()}),b());h&&(E(a.xAxis[0],"afterSetExtremes",e),E(a,"resize",c),c());E(a,"destroy",function(){g&&V(a.xAxis[0],"afterSetExtremes",d);h&&(V(a,"resize",c),V(a.xAxis[0],"afterSetExtremes",e))})});Highcharts.StockChart=function(a,b){var c=a.series,d,e={marker:{enabled:!1,states:{hover:{radius:5}}},states:{hover:{lineWidth:2}}},f={shadow:!1,borderWidth:0};a.xAxis=Ga(ha(a.xAxis||{}),function(a){return x({minPadding:0,maxPadding:0,ordinal:!0,title:{text:null},labels:{overflow:"justify"},showLastLabel:!0},a,{type:"datetime",categories:null})});a.yAxis=Ga(ha(a.yAxis||{}),function(a){d=a.opposite;return x({labels:{align:d?"right":"left",x:d?-2:2,y:-2},showLastLabel:!1,title:{text:null}},a)});a.series=null;a=x({chart:{panning:!0,pinchType:"x"},navigator:{enabled:!0},scrollbar:{enabled:!0},rangeSelector:{enabled:!0},title:{text:null},tooltip:{shared:!0,crosshairs:!0},legend:{enabled:!1},plotOptions:{line:e,spline:e,area:e,areaspline:e,arearange:e,areasplinerange:e,column:f,columnrange:f,candlestick:f,ohlc:f}},a,{_stock:!0,chart:{inverted:!1}});a.series=c;return new Ta(a,b)};ma(rb.prototype,"init",function(a,b,c){var d=c.chart.pinchType||"";a.call(this,b,c);this.pinchX=this.pinchHor=d.indexOf("x")!==-1;this.pinchY=this.pinchVert=d.indexOf("y")!==-1});var kc=R.init,lc=R.processData,mc=Ia.prototype.tooltipFormatter;R.init=function(){kc.apply(this,arguments);this.setCompare(this.options.compare)};R.setCompare=function(a){this.modifyValue=a==="value"||a==="percent"?function(b,c){var d=this.compareValue,b=a==="value"?b-d:b=100*(b/d)-100;if(c){c.change=b}return b}:null;if(this.chart.hasRendered){this.isDirty=!0}};R.processData=function(){var a=0,b,c,d;lc.apply(this,arguments);if(this.xAxis&&this.processedYData){b=this.processedXData;c=this.processedYData;for(d=c.length;a<d;a++){if(typeof c[a]==="number"&&b[a]>=this.xAxis.min){this.compareValue=c[a];break}}}};ma(R,"getExtremes",function(a){a.call(this);if(this.modifyValue){this.dataMax=this.modifyValue(this.dataMax),this.dataMin=this.modifyValue(this.dataMin)}});ua.prototype.setCompare=function(a,b){this.isXAxis||(q(this.series,function(b){b.setCompare(a)}),o(b,!0)&&this.chart.redraw())};Ia.prototype.tooltipFormatter=function(a){a=a.replace("{point.change}",(this.change>0?"+":"")+za(this.change,o(this.series.tooltipOptions.changeDecimals,2)));return mc.apply(this,[a])};(function(){var a=R.init,b=R.getSegments;R.init=function(){var b,d;a.apply(this,arguments);b=this.chart;(d=this.xAxis)&&d.options.ordinal&&E(this,"updatedData",function(){delete d.ordinalIndex});if(d&&d.options.ordinal&&!d.hasOrdinalExtension){d.hasOrdinalExtension=!0;d.beforeSetTickPositions=function(){var a,b=[],c=!1,e,k=this.getExtremes(),j=k.min,k=k.max,l;if(this.options.ordinal){q(this.series,function(c,d){if(c.visible!==!1&&c.takeOrdinalPosition!==!1&&(b=b.concat(c.processedXData),a=b.length,b.sort(function(a,b){return a-b}),a)){for(d=a-1;d--;){b[d]===b[d+1]&&b.splice(d,1)}}});a=b.length;if(a>2){e=b[1]-b[0];for(l=a-1;l--&&!c;){b[l+1]-b[l]!==e&&(c=!0)}}c?(this.ordinalPositions=b,c=d.val2lin(j,!0),e=d.val2lin(k,!0),this.ordinalSlope=k=(k-j)/(e-c),this.ordinalOffset=j-c*k):this.ordinalPositions=this.ordinalSlope=this.ordinalOffset=r}};d.val2lin=function(a,b){var c=this.ordinalPositions;if(c){var d=c.length,e,j;for(e=d;e--;){if(c[e]===a){j=e;break}}for(e=d-1;e--;){if(a>c[e]||e===0){c=(a-c[e])/(c[e+1]-c[e]);j=e+c;break}}return b?j:this.ordinalSlope*(j||0)+this.ordinalOffset}else{return a}};d.lin2val=function(a,b){var c=this.ordinalPositions;if(c){var d=this.ordinalSlope,e=this.ordinalOffset,j=c.length-1,l,m;if(b){a<0?a=c[0]:a>j?a=c[j]:(j=U(a),m=a-j)}else{for(;j--;){if(l=d*j+e,a>=l){d=d*(j+1)+e;m=(a-l)/(d-l);break}}}return m!==r&&c[j]!==r?c[j]+(m?m*(c[j+1]-c[j]):0):a}else{return a}};d.getExtendedPositions=function(){var a=d.series[0].currentDataGrouping,e=d.ordinalIndex,h=a?a.count+a.unitName:"raw",i=d.getExtremes(),k,j;if(!e){e=d.ordinalIndex={}}if(!e[h]){k={series:[],getExtremes:function(){return{min:i.dataMin,max:i.dataMax}},options:{ordinal:!0}},q(d.series,function(d){j={xAxis:k,xData:d.xData,chart:b,destroyGroupedData:qa};j.options={dataGrouping:a?{enabled:!0,forced:!0,approximation:"open",units:[[a.unitName,[a.count]]]}:{enabled:!1}};d.processData.apply(j);k.series.push(j)}),d.beforeSetTickPositions.apply(k),e[h]=k.ordinalPositions}return e[h]};d.getGroupIntervalFactor=function(a,b,c){for(var d=0,e=c.length,j=[];d<e-1;d++){j[d]=c[d+1]-c[d]}j.sort(function(a,b){return a-b});d=j[U(e/2)];a=u(a,c[0]);b=D(b,c[e-1]);return e*d/(b-a)};d.postProcessTickInterval=function(a){var b=this.ordinalSlope;return b?a/(b/d.closestPointRange):a};d.getNonLinearTimeTicks=function(a,b,c,e,k,j,l){var m=0,n=0,o,q={},s,u,x,v=[],z=-Number.MAX_VALUE,B=d.options.tickPixelInterval;if(!k||k.length<3||b===r){return fb(a,b,c,e)}for(u=k.length;n<u;n++){x=n&&k[n-1]>c;k[n]<b&&(m=n);if(n===u-1||k[n+1]-k[n]>j*5||x){if(k[n]>z){for(o=fb(a,k[m],k[n],e);o.length&&o[0]<=z;){o.shift()}o.length&&(z=o[o.length-1]);v=v.concat(o)}m=n+1}if(x){break}}a=o.info;if(l&&a.unitRange<=H[Ba]){n=v.length-1;for(m=1;m<n;m++){(new Date(v[m]))[Pa]()!==(new Date(v[m-1]))[Pa]()&&(q[v[m]]=fa,s=!0)}s&&(q[v[0]]=fa);a.higherRanks=q}v.info=a;if(l&&t(B)){var l=a=v.length,n=[],A;for(s=[];l--;){m=d.translate(v[l]),A&&(s[l]=A-m),n[l]=A=m}s.sort();s=s[U(s.length/2)];s<B*0.6&&(s=null);l=v[a-1]>c?a-1:a;for(A=void 0;l--;){m=n[l],c=A-m,A&&c<B*0.8&&(s===null||c<s*0.8)?(q[v[l]]&&!q[v[l+1]]?(c=l+1,A=m):c=l,v.splice(c,1)):A=m}}return v};var e=b.pan;b.pan=function(a){var d=b.xAxis[0],h=!1;if(d.options.ordinal&&d.series.length){var i=b.mouseDownX,k=d.getExtremes(),j=k.dataMax,l=k.min,m=k.max,n;n=b.hoverPoints;var o=d.closestPointRange,i=(i-a)/(d.translationSlope*(d.ordinalSlope||o)),r={ordinalPositions:d.getExtendedPositions()},s,o=d.lin2val,t=d.val2lin;if(r.ordinalPositions){if(T(i)>1){n&&q(n,function(a){a.setState()}),i<0?(n=r,r=d.ordinalPositions?d:r):n=d.ordinalPositions?d:r,s=r.ordinalPositions,j>s[s.length-1]&&s.push(j),n=o.apply(n,[t.apply(n,[l,!0])+i,!0]),i=o.apply(r,[t.apply(r,[m,!0])+i,!0]),n>D(k.dataMin,l)&&i<u(j,m)&&d.setExtremes(n,i,!0,!1,{trigger:"pan"}),b.mouseDownX=a,F(b.container,{cursor:"move"})}}else{h=!0}}else{h=!0}h&&e.apply(b,arguments)}}};R.getSegments=function(){var a,d=this.options.gapSize,e=this.xAxis;b.apply(this);if(e.options.ordinal&&d){a=this.segments,q(a,function(b,g){for(var h=b.length-1;h--;){b[h+1].x-b[h].x>e.closestPointRange*d&&a.splice(g+1,0,b.splice(h+1,b.length-h))}})}}})();v(Highcharts,{Axis:ua,Chart:Ta,Color:wa,Legend:Hb,Pointer:rb,Point:Ia,Tick:$a,Tooltip:Gb,Renderer:bb,Series:W,SVGElement:Ea,SVGRenderer:Ha,arrayMin:Qa,arrayMax:ta,charts:Va,dateFormat:Aa,format:Ma,pathAnim:Lb,getOptions:function(){return N},hasBidiBug:cc,isTouchDevice:hb,numberFormat:za,seriesTypes:L,setOptions:function(a){N=x(N,a);Tb();return N},addEvent:E,removeEvent:V,createElement:Z,discardElement:Ya,css:F,each:q,extend:v,map:Ga,merge:x,pick:o,splat:ha,extendClass:ca,pInt:z,wrap:ma,svg:ea,canvas:ga,vml:!ea&&!ga,product:"Highstock",version:"1.3.4"})})();(function(){var AbstractChosen;AbstractChosen=(function(){function AbstractChosen(form_field,options){this.form_field=form_field;this.options=options!=null?options:{};if(!AbstractChosen.browser_is_supported()){return}this.is_multiple=this.form_field.multiple;this.set_default_text();this.set_default_values();this.setup();this.set_up_html();this.register_observers()}AbstractChosen.prototype.set_default_values=function(){var _this=this;this.click_test_action=function(evt){return _this.test_active_click(evt)};this.activate_action=function(evt){return _this.activate_field(evt)};this.active_field=false;this.mouse_on_container=false;this.results_showing=false;this.result_highlighted=null;this.allow_single_deselect=(this.options.allow_single_deselect!=null)&&(this.form_field.options[0]!=null)&&this.form_field.options[0].text===""?this.options.allow_single_deselect:false;this.disable_search_threshold=this.options.disable_search_threshold||0;this.disable_search=this.options.disable_search||false;this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:true;this.group_search=this.options.group_search!=null?this.options.group_search:true;this.search_contains=this.options.search_contains||false;this.single_backstroke_delete=this.options.single_backstroke_delete!=null?this.options.single_backstroke_delete:true;this.max_selected_options=this.options.max_selected_options||Infinity;this.inherit_select_classes=this.options.inherit_select_classes||false;this.display_selected_options=this.options.display_selected_options!=null?this.options.display_selected_options:true;return this.display_disabled_options=this.options.display_disabled_options!=null?this.options.display_disabled_options:true};AbstractChosen.prototype.set_default_text=function(){if(this.form_field.getAttribute("data-placeholder")){this.default_text=this.form_field.getAttribute("data-placeholder")}else{if(this.is_multiple){this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||AbstractChosen.default_multiple_text}else{this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||AbstractChosen.default_single_text}}return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||AbstractChosen.default_no_result_text};AbstractChosen.prototype.mouse_enter=function(){return this.mouse_on_container=true};AbstractChosen.prototype.mouse_leave=function(){return this.mouse_on_container=false};AbstractChosen.prototype.input_focus=function(evt){var _this=this;if(this.is_multiple){if(!this.active_field){return setTimeout((function(){return _this.container_mousedown()}),50)}}else{if(!this.active_field){return this.activate_field()}}};AbstractChosen.prototype.input_blur=function(evt){var _this=this;if(!this.mouse_on_container){this.active_field=false;return setTimeout((function(){return _this.blur_test()}),100)}};AbstractChosen.prototype.results_option_build=function(options){var content,data,_i,_len,_ref;content="";_ref=this.results_data;for(_i=0,_len=_ref.length;_i<_len;_i++){data=_ref[_i];if(data.group){content+=this.result_add_group(data)}else{content+=this.result_add_option(data)}if(options!=null?options.first:void 0){if(data.selected&&this.is_multiple){this.choice_build(data)}else{if(data.selected&&!this.is_multiple){this.single_set_selected_text(data.text)}}}}return content};AbstractChosen.prototype.result_add_option=function(option){var classes,option_el;if(!option.search_match){return""}if(!this.include_option_in_results(option)){return""}classes=[];if(!option.disabled&&!(option.selected&&this.is_multiple)){classes.push("active-result")}if(option.disabled&&!(option.selected&&this.is_multiple)){classes.push("disabled-result")}if(option.selected){classes.push("result-selected")}if(option.group_array_index!=null){classes.push("group-option")}if(option.classes!==""){classes.push(option.classes)}option_el=document.createElement("li");option_el.className=classes.join(" ");option_el.style.cssText=option.style;option_el.setAttribute("data-option-array-index",option.array_index);option_el.innerHTML=option.search_text;return this.outerHTML(option_el)};AbstractChosen.prototype.result_add_group=function(group){var group_el;if(!(group.search_match||group.group_match)){return""}if(!(group.active_options>0)){return""}group_el=document.createElement("li");group_el.className="group-result";group_el.innerHTML=group.search_text;return this.outerHTML(group_el)};AbstractChosen.prototype.results_update_field=function(){this.set_default_text();if(!this.is_multiple){this.results_reset_cleanup()}this.result_clear_highlight();this.results_build();if(this.results_showing){return this.winnow_results()}};AbstractChosen.prototype.reset_single_select_options=function(){var result,_i,_len,_ref,_results;_ref=this.results_data;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){result=_ref[_i];if(result.selected){_results.push(result.selected=false)}else{_results.push(void 0)}}return _results};AbstractChosen.prototype.results_toggle=function(){if(this.results_showing){return this.results_hide()}else{return this.results_show()}};AbstractChosen.prototype.results_search=function(evt){if(this.results_showing){return this.winnow_results()}else{return this.results_show()}};AbstractChosen.prototype.winnow_results=function(){var escapedSearchText,option,regex,regexAnchor,results,results_group,searchText,startpos,text,zregex,_i,_len,_ref;this.no_results_clear();results=0;searchText=this.get_search_text();escapedSearchText=searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");regexAnchor=this.search_contains?"":"^";regex=new RegExp(regexAnchor+escapedSearchText,"i");zregex=new RegExp(escapedSearchText,"i");_ref=this.results_data;for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];option.search_match=false;results_group=null;if(this.include_option_in_results(option)){if(option.group){option.group_match=false;option.active_options=0}if((option.group_array_index!=null)&&this.results_data[option.group_array_index]){results_group=this.results_data[option.group_array_index];if(results_group.active_options===0&&results_group.search_match){results+=1}results_group.active_options+=1}if(!(option.group&&!this.group_search)){option.search_text=option.group?option.label:option.html;option.search_match=this.search_string_match(option.search_text,regex);if(option.search_match&&!option.group){results+=1}if(option.search_match){if(searchText.length){startpos=option.search_text.search(zregex);text=option.search_text.substr(0,startpos+searchText.length)+"</em>"+option.search_text.substr(startpos+searchText.length);option.search_text=text.substr(0,startpos)+"<em>"+text.substr(startpos)}if(results_group!=null){results_group.group_match=true}}else{if((option.group_array_index!=null)&&this.results_data[option.group_array_index].search_match){option.search_match=true}}}}}this.result_clear_highlight();if(results<1&&searchText.length){this.update_results_content("");return this.no_results(searchText)}else{this.update_results_content(this.results_option_build());return this.winnow_results_set_highlight()}};AbstractChosen.prototype.search_string_match=function(search_string,regex){var part,parts,_i,_len;if(regex.test(search_string)){return true}else{if(this.enable_split_word_search&&(search_string.indexOf(" ")>=0||search_string.indexOf("[")===0)){parts=search_string.replace(/\[|\]/g,"").split(" ");if(parts.length){for(_i=0,_len=parts.length;_i<_len;_i++){part=parts[_i];if(regex.test(part)){return true}}}}}};AbstractChosen.prototype.choices_count=function(){var option,_i,_len,_ref;if(this.selected_option_count!=null){return this.selected_option_count}this.selected_option_count=0;_ref=this.form_field.options;for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];if(option.selected){this.selected_option_count+=1}}return this.selected_option_count};AbstractChosen.prototype.choices_click=function(evt){evt.preventDefault();if(!(this.results_showing||this.is_disabled)){return this.results_show()}};AbstractChosen.prototype.keyup_checker=function(evt){var stroke,_ref;stroke=(_ref=evt.which)!=null?_ref:evt.keyCode;this.search_field_scale();switch(stroke){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0){return this.keydown_backstroke()}else{if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search()}}break;case 13:evt.preventDefault();if(this.results_showing){return this.result_select(evt)}break;case 27:if(this.results_showing){this.results_hide()}return true;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}};AbstractChosen.prototype.container_width=function(){if(this.options.width!=null){return this.options.width}else{return""+this.form_field.offsetWidth+"px"}};AbstractChosen.prototype.include_option_in_results=function(option){if(this.is_multiple&&(!this.display_selected_options&&option.selected)){return false}if(!this.display_disabled_options&&option.disabled){return false}if(option.empty){return false}return true};AbstractChosen.prototype.search_results_touchstart=function(evt){this.touch_started=true;return this.search_results_mouseover(evt)};AbstractChosen.prototype.search_results_touchmove=function(evt){this.touch_started=false;return this.search_results_mouseout(evt)};AbstractChosen.prototype.search_results_touchend=function(evt){if(this.touch_started){return this.search_results_mouseup(evt)}};AbstractChosen.prototype.outerHTML=function(element){var tmp;if(element.outerHTML){return element.outerHTML}tmp=document.createElement("div");tmp.appendChild(element);return tmp.innerHTML};AbstractChosen.browser_is_supported=function(){if(window.navigator.appName==="Microsoft Internet Explorer"){return document.documentMode>=8}if(/iP(od|hone)/i.test(window.navigator.userAgent)){return false}if(/Android/i.test(window.navigator.userAgent)){if(/Mobile/i.test(window.navigator.userAgent)){return false}}return true};AbstractChosen.default_multiple_text="Select Some Options";AbstractChosen.default_single_text="Select an Option";AbstractChosen.default_no_result_text="No results match";return AbstractChosen})();window.AbstractChosen=AbstractChosen}).call(this);(function(){var SelectParser;SelectParser=(function(){function SelectParser(){this.options_index=0;this.parsed=[]}SelectParser.prototype.add_node=function(child){if(child.nodeName.toUpperCase()==="OPTGROUP"){return this.add_group(child)}else{return this.add_option(child)}};SelectParser.prototype.add_group=function(group){var group_position,option,_i,_len,_ref,_results;group_position=this.parsed.length;this.parsed.push({array_index:group_position,group:true,label:this.escapeExpression(group.label),children:0,disabled:group.disabled});_ref=group.childNodes;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];_results.push(this.add_option(option,group_position,group.disabled))}return _results};SelectParser.prototype.add_option=function(option,group_position,group_disabled){if(option.nodeName.toUpperCase()==="OPTION"){if(option.text!==""){if(group_position!=null){this.parsed[group_position].children+=1}this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:option.value,text:option.text,html:option.innerHTML,selected:option.selected,disabled:group_disabled===true?group_disabled:option.disabled,group_array_index:group_position,classes:option.className,style:option.style.cssText})}else{this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:true})}return this.options_index+=1}};SelectParser.prototype.escapeExpression=function(text){var map,unsafe_chars;if((text==null)||text===false){return""}if(!/[\&\<\>\"\'\`]/.test(text)){return text}map={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};unsafe_chars=/&(?!\w+;)|[\<\>\"\'\`]/g;return text.replace(unsafe_chars,function(chr){return map[chr]||"&amp;"})};return SelectParser})();SelectParser.select_to_array=function(select){var child,parser,_i,_len,_ref;parser=new SelectParser();_ref=select.childNodes;for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];parser.add_node(child)}return parser.parsed};window.SelectParser=SelectParser}).call(this);(function(){var $,Chosen,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key)){child[key]=parent[key]}}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor();child.__super__=parent.prototype;return child};$=jQuery;$.fn.extend({chosen:function(options){if(!AbstractChosen.browser_is_supported()){return this}return this.each(function(input_field){var $this,chosen;$this=$(this);chosen=$this.data("chosen");if(options==="destroy"&&chosen){chosen.destroy()}else{if(!chosen){$this.data("chosen",new Chosen(this,options))}}})}});Chosen=(function(_super){__extends(Chosen,_super);function Chosen(){_ref=Chosen.__super__.constructor.apply(this,arguments);return _ref}Chosen.prototype.setup=function(){this.form_field_jq=$(this.form_field);this.current_selectedIndex=this.form_field.selectedIndex;return this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")};Chosen.prototype.set_up_html=function(){var container_classes,container_props;container_classes=["chosen-container"];container_classes.push("chosen-container-"+(this.is_multiple?"multi":"single"));if(this.inherit_select_classes&&this.form_field.className){container_classes.push(this.form_field.className)}if(this.is_rtl){container_classes.push("chosen-rtl")}container_props={"class":container_classes.join(" "),style:"width: "+(this.container_width())+";",title:this.form_field.title};if(this.form_field.id.length){container_props.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"}this.container=$("<div />",container_props);if(this.is_multiple){this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>')}else{this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>')}this.form_field_jq.hide().after(this.container);this.dropdown=this.container.find("div.chosen-drop").first();this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chosen-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chosen-choices").first();this.search_container=this.container.find("li.search-field").first()}else{this.search_container=this.container.find("div.chosen-search").first();this.selected_item=this.container.find(".chosen-single").first()}this.results_build();this.set_tab_index();this.set_label_behavior();return this.form_field_jq.trigger("chosen:ready",{chosen:this})};Chosen.prototype.register_observers=function(){var _this=this;this.container.bind("mousedown.chosen",function(evt){_this.container_mousedown(evt)});this.container.bind("mouseup.chosen",function(evt){_this.container_mouseup(evt)});this.container.bind("mouseenter.chosen",function(evt){_this.mouse_enter(evt)});this.container.bind("mouseleave.chosen",function(evt){_this.mouse_leave(evt)});this.search_results.bind("mouseup.chosen",function(evt){_this.search_results_mouseup(evt)});this.search_results.bind("mouseover.chosen",function(evt){_this.search_results_mouseover(evt)});this.search_results.bind("mouseout.chosen",function(evt){_this.search_results_mouseout(evt)});this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(evt){_this.search_results_mousewheel(evt)});this.search_results.bind("touchstart.chosen",function(evt){_this.search_results_touchstart(evt)});this.search_results.bind("touchmove.chosen",function(evt){_this.search_results_touchmove(evt)});this.search_results.bind("touchend.chosen",function(evt){_this.search_results_touchend(evt)});this.form_field_jq.bind("chosen:updated.chosen",function(evt){_this.results_update_field(evt)});this.form_field_jq.bind("chosen:activate.chosen",function(evt){_this.activate_field(evt)});this.form_field_jq.bind("chosen:open.chosen",function(evt){_this.container_mousedown(evt)});this.search_field.bind("blur.chosen",function(evt){_this.input_blur(evt)});this.search_field.bind("keyup.chosen",function(evt){_this.keyup_checker(evt)});this.search_field.bind("keydown.chosen",function(evt){_this.keydown_checker(evt)});this.search_field.bind("focus.chosen",function(evt){_this.input_focus(evt)});if(this.is_multiple){return this.search_choices.bind("click.chosen",function(evt){_this.choices_click(evt)})}else{return this.container.bind("click.chosen",function(evt){evt.preventDefault()})}};Chosen.prototype.destroy=function(){$(document).unbind("click.chosen",this.click_test_action);if(this.search_field[0].tabIndex){this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex}this.container.remove();this.form_field_jq.removeData("chosen");return this.form_field_jq.show()};Chosen.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq[0].disabled;if(this.is_disabled){this.container.addClass("chosen-disabled");this.search_field[0].disabled=true;if(!this.is_multiple){this.selected_item.unbind("focus.chosen",this.activate_action)}return this.close_field()}else{this.container.removeClass("chosen-disabled");this.search_field[0].disabled=false;if(!this.is_multiple){return this.selected_item.bind("focus.chosen",this.activate_action)}}};Chosen.prototype.container_mousedown=function(evt){if(!this.is_disabled){if(evt&&evt.type==="mousedown"&&!this.results_showing){evt.preventDefault()}if(!((evt!=null)&&($(evt.target)).hasClass("search-choice-close"))){if(!this.active_field){if(this.is_multiple){this.search_field.val("")}$(document).bind("click.chosen",this.click_test_action);this.results_show()}else{if(!this.is_multiple&&evt&&(($(evt.target)[0]===this.selected_item[0])||$(evt.target).parents("a.chosen-single").length)){evt.preventDefault();this.results_toggle()}}return this.activate_field()}}};Chosen.prototype.container_mouseup=function(evt){if(evt.target.nodeName==="ABBR"&&!this.is_disabled){return this.results_reset(evt)}};Chosen.prototype.search_results_mousewheel=function(evt){var delta;if(evt.originalEvent){delta=-evt.originalEvent.wheelDelta||evt.originalEvent.detail}if(delta!=null){evt.preventDefault();if(evt.type==="DOMMouseScroll"){delta=delta*40}return this.search_results.scrollTop(delta+this.search_results.scrollTop())}};Chosen.prototype.blur_test=function(evt){if(!this.active_field&&this.container.hasClass("chosen-container-active")){return this.close_field()}};Chosen.prototype.close_field=function(){$(document).unbind("click.chosen",this.click_test_action);this.active_field=false;this.results_hide();this.container.removeClass("chosen-container-active");this.clear_backstroke();this.show_search_field_default();return this.search_field_scale()};Chosen.prototype.activate_field=function(){this.container.addClass("chosen-container-active");this.active_field=true;this.search_field.val(this.search_field.val());return this.search_field.focus()};Chosen.prototype.test_active_click=function(evt){if(this.container.is($(evt.target).closest(".chosen-container"))){return this.active_field=true}else{return this.close_field()}};Chosen.prototype.results_build=function(){this.parsing=true;this.selected_option_count=null;this.results_data=SelectParser.select_to_array(this.form_field);if(this.is_multiple){this.search_choices.find("li.search-choice").remove()}else{if(!this.is_multiple){this.single_set_selected_text();if(this.disable_search||this.form_field.options.length<=this.disable_search_threshold){this.search_field[0].readOnly=true;this.container.addClass("chosen-container-single-nosearch")}else{this.search_field[0].readOnly=false;this.container.removeClass("chosen-container-single-nosearch")}}}this.update_results_content(this.results_option_build({first:true}));this.search_field_disabled();this.show_search_field_default();this.search_field_scale();return this.parsing=false};Chosen.prototype.result_do_highlight=function(el){var high_bottom,high_top,maxHeight,visible_bottom,visible_top;if(el.length){this.result_clear_highlight();this.result_highlight=el;this.result_highlight.addClass("highlighted");maxHeight=parseInt(this.search_results.css("maxHeight"),10);visible_top=this.search_results.scrollTop();visible_bottom=maxHeight+visible_top;high_top=this.result_highlight.position().top+this.search_results.scrollTop();high_bottom=high_top+this.result_highlight.outerHeight();if(high_bottom>=visible_bottom){return this.search_results.scrollTop((high_bottom-maxHeight)>0?high_bottom-maxHeight:0)}else{if(high_top<visible_top){return this.search_results.scrollTop(high_top)}}}};Chosen.prototype.result_clear_highlight=function(){if(this.result_highlight){this.result_highlight.removeClass("highlighted")}return this.result_highlight=null};Chosen.prototype.results_show=function(){if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false}this.container.addClass("chosen-with-drop");this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this});this.results_showing=true;this.search_field.focus();this.search_field.val(this.search_field.val());return this.winnow_results()};Chosen.prototype.update_results_content=function(content){return this.search_results.html(content)};Chosen.prototype.results_hide=function(){if(this.results_showing){this.result_clear_highlight();this.container.removeClass("chosen-with-drop");this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})}return this.results_showing=false};Chosen.prototype.set_tab_index=function(el){var ti;if(this.form_field.tabIndex){ti=this.form_field.tabIndex;this.form_field.tabIndex=-1;return this.search_field[0].tabIndex=ti}};Chosen.prototype.set_label_behavior=function(){var _this=this;this.form_field_label=this.form_field_jq.parents("label");if(!this.form_field_label.length&&this.form_field.id.length){this.form_field_label=$("label[for='"+this.form_field.id+"']")}if(this.form_field_label.length>0){return this.form_field_label.bind("click.chosen",function(evt){if(_this.is_multiple){return _this.container_mousedown(evt)}else{return _this.activate_field()}})}};Chosen.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices_count()<1&&!this.active_field){this.search_field.val(this.default_text);return this.search_field.addClass("default")}else{this.search_field.val("");return this.search_field.removeClass("default")}};Chosen.prototype.search_results_mouseup=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target.length){this.result_highlight=target;this.result_select(evt);return this.search_field.focus()}};Chosen.prototype.search_results_mouseover=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target){return this.result_do_highlight(target)}};Chosen.prototype.search_results_mouseout=function(evt){if($(evt.target).hasClass("active-result"||$(evt.target).parents(".active-result").first())){return this.result_clear_highlight()}};Chosen.prototype.choice_build=function(item){var choice,close_link,_this=this;choice=$("<li />",{"class":"search-choice"}).html("<span>"+item.html+"</span>");if(item.disabled){choice.addClass("search-choice-disabled")}else{close_link=$("<a />",{"class":"search-choice-close","data-option-array-index":item.array_index});close_link.bind("click.chosen",function(evt){return _this.choice_destroy_link_click(evt)});choice.append(close_link)}return this.search_container.before(choice)};Chosen.prototype.choice_destroy_link_click=function(evt){evt.preventDefault();evt.stopPropagation();if(!this.is_disabled){return this.choice_destroy($(evt.target))}};Chosen.prototype.choice_destroy=function(link){if(this.result_deselect(link[0].getAttribute("data-option-array-index"))){this.show_search_field_default();if(this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1){this.results_hide()}link.parents("li").first().remove();return this.search_field_scale()}};Chosen.prototype.results_reset=function(){this.reset_single_select_options();this.form_field.options[0].selected=true;this.single_set_selected_text();this.show_search_field_default();this.results_reset_cleanup();this.form_field_jq.trigger("change");if(this.active_field){return this.results_hide()}};Chosen.prototype.results_reset_cleanup=function(){this.current_selectedIndex=this.form_field.selectedIndex;return this.selected_item.find("abbr").remove()};Chosen.prototype.result_select=function(evt){var high,item;if(this.result_highlight){high=this.result_highlight;this.result_clear_highlight();if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return false}if(this.is_multiple){high.removeClass("active-result")}else{this.reset_single_select_options()}item=this.results_data[high[0].getAttribute("data-option-array-index")];item.selected=true;this.form_field.options[item.options_index].selected=true;this.selected_option_count=null;if(this.is_multiple){this.choice_build(item)}else{this.single_set_selected_text(item.text)}if(!((evt.metaKey||evt.ctrlKey)&&this.is_multiple)){this.results_hide()}this.search_field.val("");if(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex){this.form_field_jq.trigger("change",{selected:this.form_field.options[item.options_index].value})}this.current_selectedIndex=this.form_field.selectedIndex;return this.search_field_scale()}};Chosen.prototype.single_set_selected_text=function(text){if(text==null){text=this.default_text}if(text===this.default_text){this.selected_item.addClass("chosen-default")}else{this.single_deselect_control_build();this.selected_item.removeClass("chosen-default")}return this.selected_item.find("span").text(text)};Chosen.prototype.result_deselect=function(pos){var result_data;result_data=this.results_data[pos];if(!this.form_field.options[result_data.options_index].disabled){result_data.selected=false;this.form_field.options[result_data.options_index].selected=false;this.selected_option_count=null;this.result_clear_highlight();if(this.results_showing){this.winnow_results()}this.form_field_jq.trigger("change",{deselected:this.form_field.options[result_data.options_index].value});this.search_field_scale();return true}else{return false}};Chosen.prototype.single_deselect_control_build=function(){if(!this.allow_single_deselect){return}if(!this.selected_item.find("abbr").length){this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')}return this.selected_item.addClass("chosen-single-with-deselect")};Chosen.prototype.get_search_text=function(){if(this.search_field.val()===this.default_text){return""}else{return $("<div/>").text($.trim(this.search_field.val())).html()}};Chosen.prototype.winnow_results_set_highlight=function(){var do_high,selected_results;selected_results=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];do_high=selected_results.length?selected_results.first():this.search_results.find(".active-result").first();if(do_high!=null){return this.result_do_highlight(do_high)}};Chosen.prototype.no_results=function(terms){var no_results_html;no_results_html=$('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');no_results_html.find("span").first().html(terms);return this.search_results.append(no_results_html)};Chosen.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};Chosen.prototype.keydown_arrow=function(){var next_sib;if(this.results_showing&&this.result_highlight){next_sib=this.result_highlight.nextAll("li.active-result").first();if(next_sib){return this.result_do_highlight(next_sib)}}else{return this.results_show()}};Chosen.prototype.keyup_arrow=function(){var prev_sibs;if(!this.results_showing&&!this.is_multiple){return this.results_show()}else{if(this.result_highlight){prev_sibs=this.result_highlight.prevAll("li.active-result");if(prev_sibs.length){return this.result_do_highlight(prev_sibs.first())}else{if(this.choices_count()>0){this.results_hide()}return this.result_clear_highlight()}}}};Chosen.prototype.keydown_backstroke=function(){var next_available_destroy;if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke()}else{next_available_destroy=this.search_container.siblings("li.search-choice").last();if(next_available_destroy.length&&!next_available_destroy.hasClass("search-choice-disabled")){this.pending_backstroke=next_available_destroy;if(this.single_backstroke_delete){return this.keydown_backstroke()}else{return this.pending_backstroke.addClass("search-choice-focus")}}}};Chosen.prototype.clear_backstroke=function(){if(this.pending_backstroke){this.pending_backstroke.removeClass("search-choice-focus")}return this.pending_backstroke=null};Chosen.prototype.keydown_checker=function(evt){var stroke,_ref1;stroke=(_ref1=evt.which)!=null?_ref1:evt.keyCode;this.search_field_scale();if(stroke!==8&&this.pending_backstroke){this.clear_backstroke()}switch(stroke){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:if(this.results_showing&&!this.is_multiple){this.result_select(evt)}this.mouse_on_container=false;break;case 13:evt.preventDefault();break;case 38:evt.preventDefault();this.keyup_arrow();break;case 40:evt.preventDefault();this.keydown_arrow();break}};Chosen.prototype.search_field_scale=function(){var div,f_width,h,style,style_block,styles,w,_i,_len;if(this.is_multiple){h=0;w=0;style_block="position:absolute; left: -1000px; top: -1000px; display:none;";styles=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(_i=0,_len=styles.length;_i<_len;_i++){style=styles[_i];style_block+=style+":"+this.search_field.css(style)+";"}div=$("<div />",{style:style_block});div.text(this.search_field.val());$("body").append(div);w=div.width()+25;div.remove();f_width=this.container.outerWidth();if(w>f_width-10){w=f_width-10}return this.search_field.css({width:w+"px"})}};return Chosen})(AbstractChosen)}).call(this);window.tinymce=window.tinymce||{base:"/assets/tinymce",suffix:""};(function(exports,undefined){var modules={};function require(ids,callback){var module,defs=[];for(var i=0;i<ids.length;++i){module=modules[ids[i]]||resolve(ids[i]);if(!module){throw"module definition dependecy not found: "+ids[i]}defs.push(module)}callback.apply(null,defs)}function define(id,dependencies,definition){if(typeof id!=="string"){throw"invalid module definition, module id must be defined and be a string"}if(dependencies===undefined){throw"invalid module definition, dependencies must be specified"}if(definition===undefined){throw"invalid module definition, definition function must be specified"}require(dependencies,function(){modules[id]=definition.apply(null,arguments)})}function defined(id){return !!modules[id]}function resolve(id){var target=exports;var fragments=id.split(/[.\/]/);for(var fi=0;fi<fragments.length;++fi){if(!target[fragments[fi]]){return}target=target[fragments[fi]]}return target}function expose(ids){for(var i=0;i<ids.length;i++){var target=exports;var id=ids[i];var fragments=id.split(/[.\/]/);for(var fi=0;fi<fragments.length-1;++fi){if(target[fragments[fi]]===undefined){target[fragments[fi]]={}}target=target[fragments[fi]]}target[fragments[fragments.length-1]]=modules[id]}}define("tinymce/dom/Sizzle",[],function(){if(!window.jQuery){throw new Error("Load jQuery first")}return jQuery.find});define("tinymce/html/Styles",[],function(){return function(settings,schema){var rgbRegExp=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,urlOrStrRegExp=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,styleRegExp=/\s*([^:]+):\s*([^;]+);?/g,trimRightRegExp=/\s+$/,undef,i,encodingLookup={},encodingItems,invisibleChar="\uFEFF";settings=settings||{};encodingItems=("\\\" \\' \\; \\: ; : "+invisibleChar).split(" ");for(i=0;i<encodingItems.length;i++){encodingLookup[encodingItems[i]]=invisibleChar+i;encodingLookup[invisibleChar+i]=encodingItems[i]}function toHex(match,r,g,b){function hex(val){val=parseInt(val,10).toString(16);return val.length>1?val:"0"+val}return"#"+hex(r)+hex(g)+hex(b)}return{toHex:function(color){return color.replace(rgbRegExp,toHex)},parse:function(css){var styles={},matches,name,value,isEncoded,urlConverter=settings.url_converter;var urlConverterScope=settings.url_converter_scope||this;function compress(prefix,suffix,noJoin){var top,right,bottom,left;top=styles[prefix+"-top"+suffix];if(!top){return}right=styles[prefix+"-right"+suffix];if(!right){return}bottom=styles[prefix+"-bottom"+suffix];if(!bottom){return}left=styles[prefix+"-left"+suffix];if(!left){return}var box=[top,right,bottom,left];i=box.length-1;while(i--){if(box[i]!==box[i+1]){break}}if(i>-1&&noJoin){return}styles[prefix+suffix]=i==-1?box[0]:box.join(" ");delete styles[prefix+"-top"+suffix];delete styles[prefix+"-right"+suffix];delete styles[prefix+"-bottom"+suffix];delete styles[prefix+"-left"+suffix]}function canCompress(key){var value=styles[key],i;if(!value){return}value=value.split(" ");i=value.length;while(i--){if(value[i]!==value[0]){return false}}styles[key]=value[0];return true}function compress2(target,a,b,c){if(!canCompress(a)){return}if(!canCompress(b)){return}if(!canCompress(c)){return}styles[target]=styles[a]+" "+styles[b]+" "+styles[c];delete styles[a];delete styles[b];delete styles[c]}function encode(str){isEncoded=true;return encodingLookup[str]}function decode(str,keep_slashes){if(isEncoded){str=str.replace(/\uFEFF[0-9]/g,function(str){return encodingLookup[str]})}if(!keep_slashes){str=str.replace(/\\([\'\";:])/g,"$1")}return str}function processUrl(match,url,url2,url3,str,str2){str=str||str2;if(str){str=decode(str);return"'"+str.replace(/\'/g,"\\'")+"'"}url=decode(url||url2||url3);if(!settings.allow_script_urls&&/(java|vb)script:/i.test(url.replace(/[\s\r\n]+/,""))){return""}if(urlConverter){url=urlConverter.call(urlConverterScope,url,"style")}return"url('"+url.replace(/\'/g,"\\'")+"')"}if(css){css=css.replace(/[\u0000-\u001F]/g,"");css=css.replace(/\\[\"\';:\uFEFF]/g,encode).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(str){return str.replace(/[;:]/g,encode)});while((matches=styleRegExp.exec(css))){name=matches[1].replace(trimRightRegExp,"").toLowerCase();value=matches[2].replace(trimRightRegExp,"");if(name&&value.length>0){if(!settings.allow_script_urls&&(name=="behavior"||/expression\s*\(/.test(value))){continue}if(name==="font-weight"&&value==="700"){value="bold"}else{if(name==="color"||name==="background-color"){value=value.toLowerCase()}}value=value.replace(rgbRegExp,toHex);value=value.replace(urlOrStrRegExp,processUrl);styles[name]=isEncoded?decode(value,true):value}styleRegExp.lastIndex=matches.index+matches[0].length}compress("border","",true);compress("border","-width");compress("border","-color");compress("border","-style");compress("padding","");compress("margin","");compress2("border","border-width","border-style","border-color");if(styles.border==="medium none"){delete styles.border}if(styles["border-image"]==="none"){delete styles["border-image"]}}return styles},serialize:function(styles,element_name){var css="",name,value;function serializeStyles(name){var styleList,i,l,value;styleList=schema.styles[name];if(styleList){for(i=0,l=styleList.length;i<l;i++){name=styleList[i];value=styles[name];if(value!==undef&&value.length>0){css+=(css.length>0?" ":"")+name+": "+value+";"}}}}if(element_name&&schema&&schema.styles){serializeStyles("*");serializeStyles(element_name)}else{for(name in styles){value=styles[name];if(value!==undef&&value.length>0){css+=(css.length>0?" ":"")+name+": "+value+";"}}}return css}}}});define("tinymce/dom/EventUtils",[],function(){var eventExpandoPrefix="mce-data-";var mouseEventRe=/^(?:mouse|contextmenu)|click/;var deprecated={keyLocation:1,layerX:1,layerY:1,returnValue:1};function addEvent(target,name,callback,capture){if(target.addEventListener){target.addEventListener(name,callback,capture||false)}else{if(target.attachEvent){target.attachEvent("on"+name,callback)}}}function removeEvent(target,name,callback,capture){if(target.removeEventListener){target.removeEventListener(name,callback,capture||false)}else{if(target.detachEvent){target.detachEvent("on"+name,callback)}}}function fix(originalEvent,data){var name,event=data||{},undef;function returnFalse(){return false}function returnTrue(){return true}for(name in originalEvent){if(!deprecated[name]){event[name]=originalEvent[name]}}if(!event.target){event.target=event.srcElement||document}if(originalEvent&&mouseEventRe.test(originalEvent.type)&&originalEvent.pageX===undef&&originalEvent.clientX!==undef){var eventDoc=event.target.ownerDocument||document;var doc=eventDoc.documentElement;var body=eventDoc.body;event.pageX=originalEvent.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=originalEvent.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}event.preventDefault=function(){event.isDefaultPrevented=returnTrue;if(originalEvent){if(originalEvent.preventDefault){originalEvent.preventDefault()}else{originalEvent.returnValue=false}}};event.stopPropagation=function(){event.isPropagationStopped=returnTrue;if(originalEvent){if(originalEvent.stopPropagation){originalEvent.stopPropagation()}else{originalEvent.cancelBubble=true}}};event.stopImmediatePropagation=function(){event.isImmediatePropagationStopped=returnTrue;event.stopPropagation()};if(!event.isDefaultPrevented){event.isDefaultPrevented=returnFalse;event.isPropagationStopped=returnFalse;event.isImmediatePropagationStopped=returnFalse}return event}function bindOnReady(win,callback,eventUtils){var doc=win.document,event={type:"ready"};if(eventUtils.domLoaded){callback(event);return}function readyHandler(){if(!eventUtils.domLoaded){eventUtils.domLoaded=true;callback(event)}}function waitForDomLoaded(){if(doc.readyState==="complete"){removeEvent(doc,"readystatechange",waitForDomLoaded);readyHandler()}}function tryScroll(){try{doc.documentElement.doScroll("left")}catch(ex){setTimeout(tryScroll,0);return}readyHandler()}if(doc.addEventListener){if(doc.readyState==="complete"){readyHandler()}else{addEvent(win,"DOMContentLoaded",readyHandler)}}else{addEvent(doc,"readystatechange",waitForDomLoaded);if(doc.documentElement.doScroll&&win===win.top){tryScroll()}}addEvent(win,"load",readyHandler)}function EventUtils(){var self=this,events={},count,expando,hasFocusIn,hasMouseEnterLeave,mouseEnterLeave;expando=eventExpandoPrefix+(+new Date()).toString(32);hasMouseEnterLeave="onmouseenter" in document.documentElement;hasFocusIn="onfocusin" in document.documentElement;mouseEnterLeave={mouseenter:"mouseover",mouseleave:"mouseout"};count=1;self.domLoaded=false;self.events=events;function executeHandlers(evt,id){var callbackList,i,l,callback,container=events[id];callbackList=container&&container[evt.type];if(callbackList){for(i=0,l=callbackList.length;i<l;i++){callback=callbackList[i];if(callback&&callback.func.call(callback.scope,evt)===false){evt.preventDefault()}if(evt.isImmediatePropagationStopped()){return}}}}self.bind=function(target,names,callback,scope){var id,callbackList,i,name,fakeName,nativeHandler,capture,win=window;function defaultNativeHandler(evt){executeHandlers(fix(evt||win.event),id)}if(!target||target.nodeType===3||target.nodeType===8){return}if(!target[expando]){id=count++;target[expando]=id;events[id]={}}else{id=target[expando]}scope=scope||target;names=names.split(" ");i=names.length;while(i--){name=names[i];nativeHandler=defaultNativeHandler;fakeName=capture=false;if(name==="DOMContentLoaded"){name="ready"}if(self.domLoaded&&name==="ready"&&target.readyState=="complete"){callback.call(scope,fix({type:name}));continue}if(!hasMouseEnterLeave){fakeName=mouseEnterLeave[name];if(fakeName){nativeHandler=function(evt){var current,related;current=evt.currentTarget;related=evt.relatedTarget;if(related&&current.contains){related=current.contains(related)}else{while(related&&related!==current){related=related.parentNode}}if(!related){evt=fix(evt||win.event);evt.type=evt.type==="mouseout"?"mouseleave":"mouseenter";evt.target=current;executeHandlers(evt,id)}}}}if(!hasFocusIn&&(name==="focusin"||name==="focusout")){capture=true;fakeName=name==="focusin"?"focus":"blur";nativeHandler=function(evt){evt=fix(evt||win.event);evt.type=evt.type==="focus"?"focusin":"focusout";executeHandlers(evt,id)}}callbackList=events[id][name];if(!callbackList){events[id][name]=callbackList=[{func:callback,scope:scope}];callbackList.fakeName=fakeName;callbackList.capture=capture;callbackList.nativeHandler=nativeHandler;if(name==="ready"){bindOnReady(target,nativeHandler,self)}else{addEvent(target,fakeName||name,nativeHandler,capture)}}else{if(name==="ready"&&self.domLoaded){callback({type:name})}else{callbackList.push({func:callback,scope:scope})}}}target=callbackList=0;return callback};self.unbind=function(target,names,callback){var id,callbackList,i,ci,name,eventMap;if(!target||target.nodeType===3||target.nodeType===8){return self}id=target[expando];if(id){eventMap=events[id];if(names){names=names.split(" ");i=names.length;while(i--){name=names[i];callbackList=eventMap[name];if(callbackList){if(callback){ci=callbackList.length;while(ci--){if(callbackList[ci].func===callback){var nativeHandler=callbackList.nativeHandler;callbackList=callbackList.slice(0,ci).concat(callbackList.slice(ci+1));callbackList.nativeHandler=nativeHandler;eventMap[name]=callbackList}}}if(!callback||callbackList.length===0){delete eventMap[name];removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture)}}}}else{for(name in eventMap){callbackList=eventMap[name];removeEvent(target,callbackList.fakeName||name,callbackList.nativeHandler,callbackList.capture)}eventMap={}}for(name in eventMap){return self}delete events[id];try{delete target[expando]}catch(ex){target[expando]=null}}return self};self.fire=function(target,name,args){var id;if(!target||target.nodeType===3||target.nodeType===8){return self}args=fix(null,args);args.type=name;args.target=target;do{id=target[expando];if(id){executeHandlers(args,id)}target=target.parentNode||target.ownerDocument||target.defaultView||target.parentWindow}while(target&&!args.isPropagationStopped());return self};self.clean=function(target){var i,children,unbind=self.unbind;if(!target||target.nodeType===3||target.nodeType===8){return self}if(target[expando]){unbind(target)}if(!target.getElementsByTagName){target=target.document}if(target&&target.getElementsByTagName){unbind(target);children=target.getElementsByTagName("*");i=children.length;while(i--){target=children[i];if(target[expando]){unbind(target)}}}return self};self.destroy=function(){events={}};self.cancel=function(e){if(e){e.preventDefault();e.stopImmediatePropagation()}return false}}EventUtils.Event=new EventUtils();EventUtils.Event.bind(window,"ready",function(){});return EventUtils});define("tinymce/dom/TreeWalker",[],function(){return function(start_node,root_node){var node=start_node;function findSibling(node,start_name,sibling_name,shallow){var sibling,parent;if(node){if(!shallow&&node[start_name]){return node[start_name]}if(node!=root_node){sibling=node[sibling_name];if(sibling){return sibling}for(parent=node.parentNode;parent&&parent!=root_node;parent=parent.parentNode){sibling=parent[sibling_name];if(sibling){return sibling}}}}}this.current=function(){return node};this.next=function(shallow){node=findSibling(node,"firstChild","nextSibling",shallow);return node};this.prev=function(shallow){node=findSibling(node,"lastChild","previousSibling",shallow);return node}}});define("tinymce/util/Tools",[],function(){var whiteSpaceRegExp=/^\s*|\s*$/g;var trim=function(str){return(str===null||str===undefined)?"":(""+str).replace(whiteSpaceRegExp,"")};var isArray=Array.isArray||function(obj){return Object.prototype.toString.call(obj)==="[object Array]"};function is(o,t){if(!t){return o!==undefined}if(t=="array"&&isArray(o)){return true}return typeof(o)==t}function toArray(obj){var array=[],i,l;for(i=0,l=obj.length;i<l;i++){array[i]=obj[i]}return array}function makeMap(items,delim,map){var i;items=items||[];delim=delim||",";if(typeof(items)=="string"){items=items.split(delim)}map=map||{};i=items.length;while(i--){map[items[i]]={}}return map}function each(o,cb,s){var n,l;if(!o){return 0}s=s||o;if(o.length!==undefined){for(n=0,l=o.length;n<l;n++){if(cb.call(s,o[n],n,o)===false){return 0}}}else{for(n in o){if(o.hasOwnProperty(n)){if(cb.call(s,o[n],n,o)===false){return 0}}}}return 1}function map(a,f){var o=[];each(a,function(v){o.push(f(v))});return o}function grep(a,f){var o=[];each(a,function(v){if(!f||f(v)){o.push(v)}});return o}function create(s,p,root){var t=this,sp,ns,cn,scn,c,de=0;s=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(s);cn=s[3].match(/(^|\.)(\w+)$/i)[2];ns=t.createNS(s[3].replace(/\.\w+$/,""),root);if(ns[cn]){return}if(s[2]=="static"){ns[cn]=p;if(this.onCreate){this.onCreate(s[2],s[3],ns[cn])}return}if(!p[cn]){p[cn]=function(){};de=1}ns[cn]=p[cn];t.extend(ns[cn].prototype,p);if(s[5]){sp=t.resolve(s[5]).prototype;scn=s[5].match(/\.(\w+)$/i)[1];c=ns[cn];if(de){ns[cn]=function(){return sp[scn].apply(this,arguments)}}else{ns[cn]=function(){this.parent=sp[scn];return c.apply(this,arguments)}}ns[cn].prototype[cn]=ns[cn];t.each(sp,function(f,n){ns[cn].prototype[n]=sp[n]});t.each(p,function(f,n){if(sp[n]){ns[cn].prototype[n]=function(){this.parent=sp[n];return f.apply(this,arguments)}}else{if(n!=cn){ns[cn].prototype[n]=f}}})}t.each(p["static"],function(f,n){ns[cn][n]=f})}function inArray(a,v){var i,l;if(a){for(i=0,l=a.length;i<l;i++){if(a[i]===v){return i}}}return -1}function extend(obj,ext){var i,l,name,args=arguments,value;for(i=1,l=args.length;i<l;i++){ext=args[i];for(name in ext){if(ext.hasOwnProperty(name)){value=ext[name];if(value!==undefined){obj[name]=value}}}}return obj}function walk(o,f,n,s){s=s||this;if(o){if(n){o=o[n]}each(o,function(o,i){if(f.call(s,o,i,n)===false){return false}walk(o,f,n,s)})}}function createNS(n,o){var i,v;o=o||window;n=n.split(".");for(i=0;i<n.length;i++){v=n[i];if(!o[v]){o[v]={}}o=o[v]}return o}function resolve(n,o){var i,l;o=o||window;n=n.split(".");for(i=0,l=n.length;i<l;i++){o=o[n[i]];if(!o){break}}return o}function explode(s,d){if(!s||is(s,"array")){return s}return map(s.split(d||","),trim)}return{trim:trim,isArray:isArray,is:is,toArray:toArray,makeMap:makeMap,each:each,map:map,grep:grep,inArray:inArray,extend:extend,create:create,walk:walk,createNS:createNS,resolve:resolve,explode:explode}});define("tinymce/dom/Range",["tinymce/util/Tools"],function(Tools){function Range(dom){var t=this,doc=dom.doc,EXTRACT=0,CLONE=1,DELETE=2,TRUE=true,FALSE=false,START_OFFSET="startOffset",START_CONTAINER="startContainer",END_CONTAINER="endContainer",END_OFFSET="endOffset",extend=Tools.extend,nodeIndex=dom.nodeIndex;function createDocumentFragment(){return doc.createDocumentFragment()}function setStart(n,o){_setEndPoint(TRUE,n,o)}function setEnd(n,o){_setEndPoint(FALSE,n,o)}function setStartBefore(n){setStart(n.parentNode,nodeIndex(n))}function setStartAfter(n){setStart(n.parentNode,nodeIndex(n)+1)}function setEndBefore(n){setEnd(n.parentNode,nodeIndex(n))}function setEndAfter(n){setEnd(n.parentNode,nodeIndex(n)+1)}function collapse(ts){if(ts){t[END_CONTAINER]=t[START_CONTAINER];t[END_OFFSET]=t[START_OFFSET]}else{t[START_CONTAINER]=t[END_CONTAINER];t[START_OFFSET]=t[END_OFFSET]}t.collapsed=TRUE}function selectNode(n){setStartBefore(n);setEndAfter(n)}function selectNodeContents(n){setStart(n,0);setEnd(n,n.nodeType===1?n.childNodes.length:n.nodeValue.length)}function compareBoundaryPoints(h,r){var sc=t[START_CONTAINER],so=t[START_OFFSET],ec=t[END_CONTAINER],eo=t[END_OFFSET],rsc=r.startContainer,rso=r.startOffset,rec=r.endContainer,reo=r.endOffset;if(h===0){return _compareBoundaryPoints(sc,so,rsc,rso)}if(h===1){return _compareBoundaryPoints(ec,eo,rsc,rso)}if(h===2){return _compareBoundaryPoints(ec,eo,rec,reo)}if(h===3){return _compareBoundaryPoints(sc,so,rec,reo)}}function deleteContents(){_traverse(DELETE)}function extractContents(){return _traverse(EXTRACT)}function cloneContents(){return _traverse(CLONE)}function insertNode(n){var startContainer=this[START_CONTAINER],startOffset=this[START_OFFSET],nn,o;if((startContainer.nodeType===3||startContainer.nodeType===4)&&startContainer.nodeValue){if(!startOffset){startContainer.parentNode.insertBefore(n,startContainer)}else{if(startOffset>=startContainer.nodeValue.length){dom.insertAfter(n,startContainer)}else{nn=startContainer.splitText(startOffset);startContainer.parentNode.insertBefore(n,nn)}}}else{if(startContainer.childNodes.length>0){o=startContainer.childNodes[startOffset]}if(o){startContainer.insertBefore(n,o)}else{if(startContainer.nodeType==3){dom.insertAfter(n,startContainer)}else{startContainer.appendChild(n)}}}}function surroundContents(n){var f=t.extractContents();t.insertNode(n);n.appendChild(f);t.selectNode(n)}function cloneRange(){return extend(new Range(dom),{startContainer:t[START_CONTAINER],startOffset:t[START_OFFSET],endContainer:t[END_CONTAINER],endOffset:t[END_OFFSET],collapsed:t.collapsed,commonAncestorContainer:t.commonAncestorContainer})}function _getSelectedNode(container,offset){var child;if(container.nodeType==3){return container}if(offset<0){return container}child=container.firstChild;while(child&&offset>0){--offset;child=child.nextSibling}if(child){return child}return container}function _isCollapsed(){return(t[START_CONTAINER]==t[END_CONTAINER]&&t[START_OFFSET]==t[END_OFFSET])}function _compareBoundaryPoints(containerA,offsetA,containerB,offsetB){var c,offsetC,n,cmnRoot,childA,childB;if(containerA==containerB){if(offsetA==offsetB){return 0}if(offsetA<offsetB){return -1}return 1}c=containerB;while(c&&c.parentNode!=containerA){c=c.parentNode}if(c){offsetC=0;n=containerA.firstChild;while(n!=c&&offsetC<offsetA){offsetC++;n=n.nextSibling}if(offsetA<=offsetC){return -1}return 1}c=containerA;while(c&&c.parentNode!=containerB){c=c.parentNode}if(c){offsetC=0;n=containerB.firstChild;while(n!=c&&offsetC<offsetB){offsetC++;n=n.nextSibling}if(offsetC<offsetB){return -1}return 1}cmnRoot=dom.findCommonAncestor(containerA,containerB);childA=containerA;while(childA&&childA.parentNode!=cmnRoot){childA=childA.parentNode}if(!childA){childA=cmnRoot}childB=containerB;while(childB&&childB.parentNode!=cmnRoot){childB=childB.parentNode}if(!childB){childB=cmnRoot}if(childA==childB){return 0}n=cmnRoot.firstChild;while(n){if(n==childA){return -1}if(n==childB){return 1}n=n.nextSibling}}function _setEndPoint(st,n,o){var ec,sc;if(st){t[START_CONTAINER]=n;t[START_OFFSET]=o}else{t[END_CONTAINER]=n;t[END_OFFSET]=o}ec=t[END_CONTAINER];while(ec.parentNode){ec=ec.parentNode}sc=t[START_CONTAINER];while(sc.parentNode){sc=sc.parentNode}if(sc==ec){if(_compareBoundaryPoints(t[START_CONTAINER],t[START_OFFSET],t[END_CONTAINER],t[END_OFFSET])>0){t.collapse(st)}}else{t.collapse(st)}t.collapsed=_isCollapsed();t.commonAncestorContainer=dom.findCommonAncestor(t[START_CONTAINER],t[END_CONTAINER])}function _traverse(how){var c,endContainerDepth=0,startContainerDepth=0,p,depthDiff,startNode,endNode,sp,ep;if(t[START_CONTAINER]==t[END_CONTAINER]){return _traverseSameContainer(how)}for(c=t[END_CONTAINER],p=c.parentNode;p;c=p,p=p.parentNode){if(p==t[START_CONTAINER]){return _traverseCommonStartContainer(c,how)}++endContainerDepth}for(c=t[START_CONTAINER],p=c.parentNode;p;c=p,p=p.parentNode){if(p==t[END_CONTAINER]){return _traverseCommonEndContainer(c,how)}++startContainerDepth}depthDiff=startContainerDepth-endContainerDepth;startNode=t[START_CONTAINER];while(depthDiff>0){startNode=startNode.parentNode;depthDiff--}endNode=t[END_CONTAINER];while(depthDiff<0){endNode=endNode.parentNode;depthDiff++}for(sp=startNode.parentNode,ep=endNode.parentNode;sp!=ep;sp=sp.parentNode,ep=ep.parentNode){startNode=sp;endNode=ep}return _traverseCommonAncestors(startNode,endNode,how)}function _traverseSameContainer(how){var frag,s,sub,n,cnt,sibling,xferNode,start,len;if(how!=DELETE){frag=createDocumentFragment()}if(t[START_OFFSET]==t[END_OFFSET]){return frag}if(t[START_CONTAINER].nodeType==3){s=t[START_CONTAINER].nodeValue;sub=s.substring(t[START_OFFSET],t[END_OFFSET]);if(how!=CLONE){n=t[START_CONTAINER];start=t[START_OFFSET];len=t[END_OFFSET]-t[START_OFFSET];if(start===0&&len>=n.nodeValue.length-1){n.parentNode.removeChild(n)}else{n.deleteData(start,len)}t.collapse(TRUE)}if(how==DELETE){return}if(sub.length>0){frag.appendChild(doc.createTextNode(sub))}return frag}n=_getSelectedNode(t[START_CONTAINER],t[START_OFFSET]);cnt=t[END_OFFSET]-t[START_OFFSET];while(n&&cnt>0){sibling=n.nextSibling;xferNode=_traverseFullySelected(n,how);if(frag){frag.appendChild(xferNode)}--cnt;n=sibling}if(how!=CLONE){t.collapse(TRUE)}return frag}function _traverseCommonStartContainer(endAncestor,how){var frag,n,endIdx,cnt,sibling,xferNode;if(how!=DELETE){frag=createDocumentFragment()}n=_traverseRightBoundary(endAncestor,how);if(frag){frag.appendChild(n)}endIdx=nodeIndex(endAncestor);cnt=endIdx-t[START_OFFSET];if(cnt<=0){if(how!=CLONE){t.setEndBefore(endAncestor);t.collapse(FALSE)}return frag}n=endAncestor.previousSibling;while(cnt>0){sibling=n.previousSibling;xferNode=_traverseFullySelected(n,how);if(frag){frag.insertBefore(xferNode,frag.firstChild)}--cnt;n=sibling}if(how!=CLONE){t.setEndBefore(endAncestor);t.collapse(FALSE)}return frag}function _traverseCommonEndContainer(startAncestor,how){var frag,startIdx,n,cnt,sibling,xferNode;if(how!=DELETE){frag=createDocumentFragment()}n=_traverseLeftBoundary(startAncestor,how);if(frag){frag.appendChild(n)}startIdx=nodeIndex(startAncestor);++startIdx;cnt=t[END_OFFSET]-startIdx;n=startAncestor.nextSibling;while(n&&cnt>0){sibling=n.nextSibling;xferNode=_traverseFullySelected(n,how);if(frag){frag.appendChild(xferNode)}--cnt;n=sibling}if(how!=CLONE){t.setStartAfter(startAncestor);t.collapse(TRUE)}return frag}function _traverseCommonAncestors(startAncestor,endAncestor,how){var n,frag,commonParent,startOffset,endOffset,cnt,sibling,nextSibling;if(how!=DELETE){frag=createDocumentFragment()}n=_traverseLeftBoundary(startAncestor,how);if(frag){frag.appendChild(n)}commonParent=startAncestor.parentNode;startOffset=nodeIndex(startAncestor);endOffset=nodeIndex(endAncestor);++startOffset;cnt=endOffset-startOffset;sibling=startAncestor.nextSibling;while(cnt>0){nextSibling=sibling.nextSibling;n=_traverseFullySelected(sibling,how);if(frag){frag.appendChild(n)}sibling=nextSibling;--cnt}n=_traverseRightBoundary(endAncestor,how);if(frag){frag.appendChild(n)}if(how!=CLONE){t.setStartAfter(startAncestor);t.collapse(TRUE)}return frag}function _traverseRightBoundary(root,how){var next=_getSelectedNode(t[END_CONTAINER],t[END_OFFSET]-1),parent,clonedParent;var prevSibling,clonedChild,clonedGrandParent,isFullySelected=next!=t[END_CONTAINER];if(next==root){return _traverseNode(next,isFullySelected,FALSE,how)}parent=next.parentNode;clonedParent=_traverseNode(parent,FALSE,FALSE,how);while(parent){while(next){prevSibling=next.previousSibling;clonedChild=_traverseNode(next,isFullySelected,FALSE,how);if(how!=DELETE){clonedParent.insertBefore(clonedChild,clonedParent.firstChild)}isFullySelected=TRUE;next=prevSibling}if(parent==root){return clonedParent}next=parent.previousSibling;parent=parent.parentNode;clonedGrandParent=_traverseNode(parent,FALSE,FALSE,how);if(how!=DELETE){clonedGrandParent.appendChild(clonedParent)}clonedParent=clonedGrandParent}}function _traverseLeftBoundary(root,how){var next=_getSelectedNode(t[START_CONTAINER],t[START_OFFSET]),isFullySelected=next!=t[START_CONTAINER];var parent,clonedParent,nextSibling,clonedChild,clonedGrandParent;if(next==root){return _traverseNode(next,isFullySelected,TRUE,how)}parent=next.parentNode;clonedParent=_traverseNode(parent,FALSE,TRUE,how);while(parent){while(next){nextSibling=next.nextSibling;clonedChild=_traverseNode(next,isFullySelected,TRUE,how);if(how!=DELETE){clonedParent.appendChild(clonedChild)}isFullySelected=TRUE;next=nextSibling}if(parent==root){return clonedParent}next=parent.nextSibling;parent=parent.parentNode;clonedGrandParent=_traverseNode(parent,FALSE,TRUE,how);if(how!=DELETE){clonedGrandParent.appendChild(clonedParent)}clonedParent=clonedGrandParent}}function _traverseNode(n,isFullySelected,isLeft,how){var txtValue,newNodeValue,oldNodeValue,offset,newNode;if(isFullySelected){return _traverseFullySelected(n,how)}if(n.nodeType==3){txtValue=n.nodeValue;if(isLeft){offset=t[START_OFFSET];newNodeValue=txtValue.substring(offset);oldNodeValue=txtValue.substring(0,offset)}else{offset=t[END_OFFSET];newNodeValue=txtValue.substring(0,offset);oldNodeValue=txtValue.substring(offset)}if(how!=CLONE){n.nodeValue=oldNodeValue}if(how==DELETE){return}newNode=dom.clone(n,FALSE);newNode.nodeValue=newNodeValue;return newNode}if(how==DELETE){return}return dom.clone(n,FALSE)}function _traverseFullySelected(n,how){if(how!=DELETE){return how==CLONE?dom.clone(n,TRUE):n}n.parentNode.removeChild(n)}function toStringIE(){return dom.create("body",null,cloneContents()).outerText}extend(t,{startContainer:doc,startOffset:0,endContainer:doc,endOffset:0,collapsed:TRUE,commonAncestorContainer:doc,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:setStart,setEnd:setEnd,setStartBefore:setStartBefore,setStartAfter:setStartAfter,setEndBefore:setEndBefore,setEndAfter:setEndAfter,collapse:collapse,selectNode:selectNode,selectNodeContents:selectNodeContents,compareBoundaryPoints:compareBoundaryPoints,deleteContents:deleteContents,extractContents:extractContents,cloneContents:cloneContents,insertNode:insertNode,surroundContents:surroundContents,cloneRange:cloneRange,toStringIE:toStringIE});return t}Range.prototype.toString=function(){return this.toStringIE()};return Range});define("tinymce/html/Entities",["tinymce/util/Tools"],function(Tools){var makeMap=Tools.makeMap;var namedEntities,baseEntities,reverseEntities,attrsCharsRegExp=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,textCharsRegExp=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rawCharsRegExp=/[<>&\"\']/g,entityRegExp=/&(#x|#)?([\w]+);/g,asciiMap={128:"\u20AC",130:"\u201A",131:"\u0192",132:"\u201E",133:"\u2026",134:"\u2020",135:"\u2021",136:"\u02C6",137:"\u2030",138:"\u0160",139:"\u2039",140:"\u0152",142:"\u017D",145:"\u2018",146:"\u2019",147:"\u201C",148:"\u201D",149:"\u2022",150:"\u2013",151:"\u2014",152:"\u02DC",153:"\u2122",154:"\u0161",155:"\u203A",156:"\u0153",158:"\u017E",159:"\u0178"};baseEntities={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"};reverseEntities={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};function nativeDecode(text){var elm;elm=document.createElement("div");elm.innerHTML=text;return elm.textContent||elm.innerText||text}function buildEntitiesLookup(items,radix){var i,chr,entity,lookup={};if(items){items=items.split(",");radix=radix||10;for(i=0;i<items.length;i+=2){chr=String.fromCharCode(parseInt(items[i],radix));if(!baseEntities[chr]){entity="&"+items[i+1]+";";lookup[chr]=entity;lookup[entity]=chr}}return lookup}}namedEntities=buildEntitiesLookup("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);var Entities={encodeRaw:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeAllRaw:function(text){return(""+text).replace(rawCharsRegExp,function(chr){return baseEntities[chr]||chr})},encodeNumeric:function(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){if(chr.length>1){return"&#"+(((chr.charCodeAt(0)-55296)*1024)+(chr.charCodeAt(1)-56320)+65536)+";"}return baseEntities[chr]||"&#"+chr.charCodeAt(0)+";"})},encodeNamed:function(text,attr,entities){entities=entities||namedEntities;return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||chr})},getEncodeFunc:function(name,entities){entities=buildEntitiesLookup(entities)||namedEntities;function encodeNamedAndNumeric(text,attr){return text.replace(attr?attrsCharsRegExp:textCharsRegExp,function(chr){return baseEntities[chr]||entities[chr]||"&#"+chr.charCodeAt(0)+";"||chr})}function encodeCustomNamed(text,attr){return Entities.encodeNamed(text,attr,entities)}name=makeMap(name.replace(/\+/g,","));if(name.named&&name.numeric){return encodeNamedAndNumeric}if(name.named){if(entities){return encodeCustomNamed}return Entities.encodeNamed}if(name.numeric){return Entities.encodeNumeric}return Entities.encodeRaw},decode:function(text){return text.replace(entityRegExp,function(all,numeric,value){if(numeric){value=parseInt(value,numeric.length===2?16:10);if(value>65535){value-=65536;return String.fromCharCode(55296+(value>>10),56320+(value&1023))}else{return asciiMap[value]||String.fromCharCode(value)}}return reverseEntities[all]||namedEntities[all]||nativeDecode(all)})}};return Entities});define("tinymce/Env",[],function(){var nav=navigator,userAgent=nav.userAgent;var opera,webkit,ie,ie11,gecko,mac,iDevice;opera=window.opera&&window.opera.buildNumber;webkit=/WebKit/.test(userAgent);ie=!webkit&&!opera&&(/MSIE/gi).test(userAgent)&&(/Explorer/gi).test(nav.appName);ie=ie&&/MSIE (\w+)\./.exec(userAgent)[1];ie11=userAgent.indexOf("Trident/")!=-1&&(userAgent.indexOf("rv:")!=-1||nav.appName.indexOf("Netscape")!=-1)?11:false;ie=ie||ie11;gecko=!webkit&&!ie11&&/Gecko/.test(userAgent);mac=userAgent.indexOf("Mac")!=-1;iDevice=/(iPad|iPhone)/.test(userAgent);var contentEditable=!iDevice||userAgent.match(/AppleWebKit\/(\d*)/)[1]>=534;return{opera:opera,webkit:webkit,ie:ie,gecko:gecko,mac:mac,iOS:iDevice,contentEditable:contentEditable,transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",caretAfter:ie!=8,range:window.getSelection&&"Range" in window,documentMode:ie?(document.documentMode||7):10}});define("tinymce/dom/DOMUtils",["tinymce/dom/Sizzle","tinymce/html/Styles","tinymce/dom/EventUtils","tinymce/dom/TreeWalker","tinymce/dom/Range","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools"],function(Sizzle,Styles,EventUtils,TreeWalker,Range,Entities,Env,Tools){var each=Tools.each,is=Tools.is,grep=Tools.grep,trim=Tools.trim,extend=Tools.extend;var isWebKit=Env.webkit,isIE=Env.ie;var simpleSelectorRe=/^([a-z0-9],?)+$/i;var whiteSpaceRegExp=/^[ \t\r\n]*$/;var numericCssMap=Tools.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom"," ");function DOMUtils(doc,settings){var self=this,blockElementsMap;self.doc=doc;self.win=window;self.files={};self.counter=0;self.stdMode=!isIE||doc.documentMode>=8;self.boxModel=!isIE||doc.compatMode=="CSS1Compat"||self.stdMode;self.hasOuterHTML="outerHTML" in doc.createElement("a");this.boundEvents=[];self.settings=settings=extend({keep_values:false,hex_colors:1},settings);self.schema=settings.schema;self.styles=new Styles({url_converter:settings.url_converter,url_converter_scope:settings.url_converter_scope},settings.schema);self.fixDoc(doc);self.events=settings.ownEvents?new EventUtils(settings.proxy):EventUtils.Event;blockElementsMap=settings.schema?settings.schema.getBlockElements():{};self.isBlock=function(node){if(!node){return false}var type=node.nodeType;if(type){return !!(type===1&&blockElementsMap[node.nodeName])}return !!blockElementsMap[node]}}DOMUtils.prototype={root:null,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},fixDoc:function(doc){var settings=this.settings,name;if(isIE&&settings.schema){("abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video").replace(/\w+/g,function(name){doc.createElement(name)});for(name in settings.schema.getCustomElements()){doc.createElement(name)}}},clone:function(node,deep){var self=this,clone,doc;if(!isIE||node.nodeType!==1||deep){return node.cloneNode(deep)}doc=self.doc;if(!deep){clone=doc.createElement(node.nodeName);each(self.getAttribs(node),function(attr){self.setAttrib(clone,attr.nodeName,self.getAttrib(node,attr.nodeName))});return clone}return clone.firstChild},getRoot:function(){var self=this;return self.get(self.settings.root_element)||self.doc.body},getViewPort:function(win){var doc,rootElm;win=!win?this.win:win;doc=win.document;rootElm=this.boxModel?doc.documentElement:doc.body;return{x:win.pageXOffset||rootElm.scrollLeft,y:win.pageYOffset||rootElm.scrollTop,w:win.innerWidth||rootElm.clientWidth,h:win.innerHeight||rootElm.clientHeight}},getRect:function(elm){var self=this,pos,size;elm=self.get(elm);pos=self.getPos(elm);size=self.getSize(elm);return{x:pos.x,y:pos.y,w:size.w,h:size.h}},getSize:function(elm){var self=this,w,h;elm=self.get(elm);w=self.getStyle(elm,"width");h=self.getStyle(elm,"height");if(w.indexOf("px")===-1){w=0}if(h.indexOf("px")===-1){h=0}return{w:parseInt(w,10)||elm.offsetWidth||elm.clientWidth,h:parseInt(h,10)||elm.offsetHeight||elm.clientHeight}},getParent:function(node,selector,root){return this.getParents(node,selector,root,false)},getParents:function(node,selector,root,collect){var self=this,selectorVal,result=[];node=self.get(node);collect=collect===undefined;root=root||(self.getRoot().nodeName!="BODY"?self.getRoot().parentNode:null);if(is(selector,"string")){selectorVal=selector;if(selector==="*"){selector=function(node){return node.nodeType==1}}else{selector=function(node){return self.is(node,selectorVal)}}}while(node){if(node==root||!node.nodeType||node.nodeType===9){break}if(!selector||selector(node)){if(collect){result.push(node)}else{return node}}node=node.parentNode}return collect?result:null},get:function(elm){var name;if(elm&&this.doc&&typeof(elm)=="string"){name=elm;elm=this.doc.getElementById(elm);if(elm&&elm.id!==name){return this.doc.getElementsByName(name)[1]}}return elm},getNext:function(node,selector){return this._findSib(node,selector,"nextSibling")},getPrev:function(node,selector){return this._findSib(node,selector,"previousSibling")},select:function(selector,scope){var self=this;return Sizzle(selector,self.get(scope)||self.get(self.settings.root_element)||self.doc,[])},is:function(elm,selector){var i;if(elm.length===undefined){if(selector==="*"){return elm.nodeType==1}if(simpleSelectorRe.test(selector)){selector=selector.toLowerCase().split(/,/);elm=elm.nodeName.toLowerCase();for(i=selector.length-1;i>=0;i--){if(selector[i]==elm){return true}}return false}}if(elm.nodeType&&elm.nodeType!=1){return false}return Sizzle.matches(selector,elm.nodeType?[elm]:elm).length>0},add:function(parentElm,name,attrs,html,create){var self=this;return this.run(parentElm,function(parentElm){var newElm;newElm=is(name,"string")?self.doc.createElement(name):name;self.setAttribs(newElm,attrs);if(html){if(html.nodeType){newElm.appendChild(html)}else{self.setHTML(newElm,html)}}return !create?parentElm.appendChild(newElm):newElm})},create:function(name,attrs,html){return this.add(this.doc.createElement(name),name,attrs,html,1)},createHTML:function(name,attrs,html){var outHtml="",key;outHtml+="<"+name;for(key in attrs){if(attrs.hasOwnProperty(key)&&attrs[key]!==null){outHtml+=" "+key+'="'+this.encode(attrs[key])+'"'}}if(typeof(html)!="undefined"){return outHtml+">"+html+"</"+name+">"}return outHtml+" />"},createFragment:function(html){var frag,node,doc=this.doc,container;container=doc.createElement("div");frag=doc.createDocumentFragment();if(html){container.innerHTML=html}while((node=container.firstChild)){frag.appendChild(node)}return frag},remove:function(node,keep_children){return this.run(node,function(node){var child,parent=node.parentNode;if(!parent){return null}if(keep_children){while((child=node.firstChild)){if(!isIE||child.nodeType!==3||child.nodeValue){parent.insertBefore(child,node)}else{node.removeChild(child)}}}return parent.removeChild(node)})},setStyle:function(elm,name,value){return this.run(elm,function(elm){var self=this,style,key;if(name){if(typeof(name)==="string"){style=elm.style;name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});if(typeof(value)==="number"&&!numericCssMap[name]){value+="px"}if(name==="opacity"&&elm.runtimeStyle&&typeof(elm.runtimeStyle.opacity)==="undefined"){style.filter=value===""?"":"alpha(opacity="+(value*100)+")"}if(name=="float"){name="cssFloat" in elm.style?"cssFloat":"styleFloat"}try{style[name]=value}catch(ex){}if(self.settings.update_styles){elm.removeAttribute("data-mce-style")}}else{for(key in name){self.setStyle(elm,key,name[key])}}}})},getStyle:function(elm,name,computed){elm=this.get(elm);if(!elm){return}if(this.doc.defaultView&&computed){name=name.replace(/[A-Z]/g,function(a){return"-"+a});try{return this.doc.defaultView.getComputedStyle(elm,null).getPropertyValue(name)}catch(ex){return null}}name=name.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});if(name=="float"){name=isIE?"styleFloat":"cssFloat"}if(elm.currentStyle&&computed){return elm.currentStyle[name]}return elm.style?elm.style[name]:undefined},setStyles:function(elm,styles){this.setStyle(elm,styles)},css:function(elm,name,value){this.setStyle(elm,name,value)},removeAllAttribs:function(e){return this.run(e,function(e){var i,attrs=e.attributes;for(i=attrs.length-1;i>=0;i--){e.removeAttributeNode(attrs.item(i))}})},setAttrib:function(e,n,v){var t=this;if(!e||!n){return}return this.run(e,function(e){var s=t.settings;var originalValue=e.getAttribute(n);if(v!==null){switch(n){case"style":if(!is(v,"string")){each(v,function(v,n){t.setStyle(e,n,v)});return}if(s.keep_values){if(v){e.setAttribute("data-mce-style",v,2)}else{e.removeAttribute("data-mce-style",2)}}e.style.cssText=v;break;case"class":e.className=v||"";break;case"src":case"href":if(s.keep_values){if(s.url_converter){v=s.url_converter.call(s.url_converter_scope||t,v,n,e)}t.setAttrib(e,"data-mce-"+n,v,2)}break;case"shape":e.setAttribute("data-mce-style",v);break}}if(is(v)&&v!==null&&v.length!==0){e.setAttribute(n,""+v,2)}else{e.removeAttribute(n,2)}if(originalValue!=v&&s.onSetAttrib){s.onSetAttrib({attrElm:e,attrName:n,attrValue:v})}})},setAttribs:function(elm,attrs){var self=this;return this.run(elm,function(elm){each(attrs,function(value,name){self.setAttrib(elm,name,value)})})},getAttrib:function(elm,name,defaultVal){var value,self=this,undef;elm=self.get(elm);if(!elm||elm.nodeType!==1){return defaultVal===undef?false:defaultVal}if(!is(defaultVal)){defaultVal=""}if(/^(src|href|style|coords|shape)$/.test(name)){value=elm.getAttribute("data-mce-"+name);if(value){return value}}if(isIE&&self.props[name]){value=elm[self.props[name]];value=value&&value.nodeValue?value.nodeValue:value}if(!value){value=elm.getAttribute(name,2)}if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(name)){if(elm[self.props[name]]===true&&value===""){return name}return value?name:""}if(elm.nodeName==="FORM"&&elm.getAttributeNode(name)){return elm.getAttributeNode(name).nodeValue}if(name==="style"){value=value||elm.style.cssText;if(value){value=self.serializeStyle(self.parseStyle(value),elm.nodeName);if(self.settings.keep_values){elm.setAttribute("data-mce-style",value)}}}if(isWebKit&&name==="class"&&value){value=value.replace(/(apple|webkit)\-[a-z\-]+/gi,"")}if(isIE){switch(name){case"rowspan":case"colspan":if(value===1){value=""}break;case"size":if(value==="+0"||value===20||value===0){value=""}break;case"width":case"height":case"vspace":case"checked":case"disabled":case"readonly":if(value===0){value=""}break;case"hspace":if(value===-1){value=""}break;case"maxlength":case"tabindex":if(value===32768||value===2147483647||value==="32768"){value=""}break;case"multiple":case"compact":case"noshade":case"nowrap":if(value===65535){return name}return defaultVal;case"shape":value=value.toLowerCase();break;default:if(name.indexOf("on")===0&&value){value=(""+value).replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1")}}}return(value!==undef&&value!==null&&value!=="")?""+value:defaultVal},getPos:function(elm,rootElm){var self=this,x=0,y=0,offsetParent,doc=self.doc,pos;elm=self.get(elm);rootElm=rootElm||doc.body;if(elm){if(rootElm===doc.body&&elm.getBoundingClientRect){pos=elm.getBoundingClientRect();rootElm=self.boxModel?doc.documentElement:doc.body;x=pos.left+(doc.documentElement.scrollLeft||doc.body.scrollLeft)-rootElm.clientTop;y=pos.top+(doc.documentElement.scrollTop||doc.body.scrollTop)-rootElm.clientLeft;return{x:x,y:y}}offsetParent=elm;while(offsetParent&&offsetParent!=rootElm&&offsetParent.nodeType){x+=offsetParent.offsetLeft||0;y+=offsetParent.offsetTop||0;offsetParent=offsetParent.offsetParent}offsetParent=elm.parentNode;while(offsetParent&&offsetParent!=rootElm&&offsetParent.nodeType){x-=offsetParent.scrollLeft||0;y-=offsetParent.scrollTop||0;offsetParent=offsetParent.parentNode}}return{x:x,y:y}},parseStyle:function(cssText){return this.styles.parse(cssText)},serializeStyle:function(styles,name){return this.styles.serialize(styles,name)},addStyle:function(cssText){var self=this,doc=self.doc,head,styleElm;if(self!==DOMUtils.DOM&&doc===document){var addedStyles=DOMUtils.DOM.addedStyles;addedStyles=addedStyles||[];if(addedStyles[cssText]){return}addedStyles[cssText]=true;DOMUtils.DOM.addedStyles=addedStyles}styleElm=doc.getElementById("mceDefaultStyles");if(!styleElm){styleElm=doc.createElement("style");styleElm.id="mceDefaultStyles";styleElm.type="text/css";head=doc.getElementsByTagName("head")[0];if(head.firstChild){head.insertBefore(styleElm,head.firstChild)}else{head.appendChild(styleElm)}}if(styleElm.styleSheet){styleElm.styleSheet.cssText+=cssText}else{styleElm.appendChild(doc.createTextNode(cssText))}},loadCSS:function(url){var self=this,doc=self.doc,head;if(self!==DOMUtils.DOM&&doc===document){DOMUtils.DOM.loadCSS(url);return}if(!url){url=""}head=doc.getElementsByTagName("head")[0];each(url.split(","),function(url){var link;if(self.files[url]){return}self.files[url]=true;link=self.create("link",{rel:"stylesheet",href:url});if(isIE&&doc.documentMode&&doc.recalc){link.onload=function(){if(doc.recalc){doc.recalc()}link.onload=null}}head.appendChild(link)})},addClass:function(elm,cls){return this.run(elm,function(elm){var clsVal;if(!cls){return 0}if(this.hasClass(elm,cls)){return elm.className}clsVal=this.removeClass(elm,cls);elm.className=clsVal=(clsVal!==""?(clsVal+" "):"")+cls;return clsVal})},removeClass:function(elm,cls){var self=this,re;return self.run(elm,function(elm){var val;if(self.hasClass(elm,cls)){if(!re){re=new RegExp("(^|\\s+)"+cls+"(\\s+|$)","g")}val=elm.className.replace(re," ");val=trim(val!=" "?val:"");elm.className=val;if(!val){elm.removeAttribute("class");elm.removeAttribute("className")}return val}return elm.className})},hasClass:function(elm,cls){elm=this.get(elm);if(!elm||!cls){return false}return(" "+elm.className+" ").indexOf(" "+cls+" ")!==-1},toggleClass:function(elm,cls,state){state=state===undefined?!this.hasClass(elm,cls):state;if(this.hasClass(elm,cls)!==state){if(state){this.addClass(elm,cls)}else{this.removeClass(elm,cls)}}},show:function(elm){return this.setStyle(elm,"display","block")},hide:function(elm){return this.setStyle(elm,"display","none")},isHidden:function(elm){elm=this.get(elm);return !elm||elm.style.display=="none"||this.getStyle(elm,"display")=="none"},uniqueId:function(prefix){return(!prefix?"mce_":prefix)+(this.counter++)},setHTML:function(element,html){var self=this;return self.run(element,function(element){if(isIE){while(element.firstChild){element.removeChild(element.firstChild)}try{element.innerHTML="<br />"+html;element.removeChild(element.firstChild)}catch(ex){var newElement=self.create("div");newElement.innerHTML="<br />"+html;each(grep(newElement.childNodes),function(node,i){if(i&&element.canHaveHTML){element.appendChild(node)}})}}else{element.innerHTML=html}return html})},getOuterHTML:function(elm){var doc,self=this;elm=self.get(elm);if(!elm){return null}if(elm.nodeType===1&&self.hasOuterHTML){return elm.outerHTML}doc=(elm.ownerDocument||self.doc).createElement("body");doc.appendChild(elm.cloneNode(true));return doc.innerHTML},setOuterHTML:function(elm,html,doc){var self=this;return self.run(elm,function(elm){function set(){var node,tempElm;tempElm=doc.createElement("body");tempElm.innerHTML=html;node=tempElm.lastChild;while(node){self.insertAfter(node.cloneNode(true),elm);node=node.previousSibling}self.remove(elm)}if(elm.nodeType==1){doc=doc||elm.ownerDocument||self.doc;if(isIE){try{if(elm.nodeType==1&&self.hasOuterHTML){elm.outerHTML=html}else{set()}}catch(ex){set()}}else{set()}}})},decode:Entities.decode,encode:Entities.encodeAllRaw,insertAfter:function(node,reference_node){reference_node=this.get(reference_node);return this.run(node,function(node){var parent,nextSibling;parent=reference_node.parentNode;nextSibling=reference_node.nextSibling;if(nextSibling){parent.insertBefore(node,nextSibling)}else{parent.appendChild(node)}return node})},replace:function(newElm,oldElm,keepChildren){var self=this;return self.run(oldElm,function(oldElm){if(is(oldElm,"array")){newElm=newElm.cloneNode(true)}if(keepChildren){each(grep(oldElm.childNodes),function(node){newElm.appendChild(node)})}return oldElm.parentNode.replaceChild(newElm,oldElm)})},rename:function(elm,name){var self=this,newElm;if(elm.nodeName!=name.toUpperCase()){newElm=self.create(name);each(self.getAttribs(elm),function(attr_node){self.setAttrib(newElm,attr_node.nodeName,self.getAttrib(elm,attr_node.nodeName))});self.replace(newElm,elm,1)}return newElm||elm},findCommonAncestor:function(a,b){var ps=a,pe;while(ps){pe=b;while(pe&&ps!=pe){pe=pe.parentNode}if(ps==pe){break}ps=ps.parentNode}if(!ps&&a.ownerDocument){return a.ownerDocument.documentElement}return ps},toHex:function(rgbVal){return this.styles.toHex(Tools.trim(rgbVal))},run:function(elm,func,scope){var self=this,result;if(typeof(elm)==="string"){elm=self.get(elm)}if(!elm){return false}scope=scope||this;if(!elm.nodeType&&(elm.length||elm.length===0)){result=[];each(elm,function(elm,i){if(elm){if(typeof(elm)=="string"){elm=self.get(elm)}result.push(func.call(scope,elm,i))}});return result}return func.call(scope,elm)},getAttribs:function(elm){var attrs;elm=this.get(elm);if(!elm){return[]}if(isIE){attrs=[];if(elm.nodeName=="OBJECT"){return elm.attributes}if(elm.nodeName==="OPTION"&&this.getAttrib(elm,"selected")){attrs.push({specified:1,nodeName:"selected"})}var attrRegExp=/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi;elm.cloneNode(false).outerHTML.replace(attrRegExp,"").replace(/[\w:\-]+/gi,function(a){attrs.push({specified:1,nodeName:a})});return attrs}return elm.attributes},isEmpty:function(node,elements){var self=this,i,attributes,type,walker,name,brCount=0;node=node.firstChild;if(node){walker=new TreeWalker(node,node.parentNode);elements=elements||self.schema?self.schema.getNonEmptyElements():null;do{type=node.nodeType;if(type===1){if(node.getAttribute("data-mce-bogus")){continue}name=node.nodeName.toLowerCase();if(elements&&elements[name]){if(name==="br"){brCount++;continue}return false}attributes=self.getAttribs(node);i=node.attributes.length;while(i--){name=node.attributes[i].nodeName;if(name==="name"||name==="data-mce-bookmark"){return false}}}if(type==8){return false}if((type===3&&!whiteSpaceRegExp.test(node.nodeValue))){return false}}while((node=walker.next()))}return brCount<=1},createRng:function(){var doc=this.doc;return doc.createRange?doc.createRange():new Range(this)},nodeIndex:function(node,normalized){var idx=0,lastNodeType,lastNode,nodeType;if(node){for(lastNodeType=node.nodeType,node=node.previousSibling,lastNode=node;node;node=node.previousSibling){nodeType=node.nodeType;if(normalized&&nodeType==3){if(nodeType==lastNodeType||!node.nodeValue.length){continue}}idx++;lastNodeType=nodeType}}return idx},split:function(parentElm,splitElm,replacementElm){var self=this,r=self.createRng(),bef,aft,pa;function trimNode(node){var i,children=node.childNodes,type=node.nodeType;function surroundedBySpans(node){var previousIsSpan=node.previousSibling&&node.previousSibling.nodeName=="SPAN";var nextIsSpan=node.nextSibling&&node.nextSibling.nodeName=="SPAN";return previousIsSpan&&nextIsSpan}if(type==1&&node.getAttribute("data-mce-type")=="bookmark"){return}for(i=children.length-1;i>=0;i--){trimNode(children[i])}if(type!=9){if(type==3&&node.nodeValue.length>0){var trimmedLength=trim(node.nodeValue).length;if(!self.isBlock(node.parentNode)||trimmedLength>0||trimmedLength===0&&surroundedBySpans(node)){return}}else{if(type==1){children=node.childNodes;if(children.length==1&&children[0]&&children[0].nodeType==1&&children[0].getAttribute("data-mce-type")=="bookmark"){node.parentNode.insertBefore(children[0],node)}if(children.length||/^(br|hr|input|img)$/i.test(node.nodeName)){return}}}self.remove(node)}return node}if(parentElm&&splitElm){r.setStart(parentElm.parentNode,self.nodeIndex(parentElm));r.setEnd(splitElm.parentNode,self.nodeIndex(splitElm));bef=r.extractContents();r=self.createRng();r.setStart(splitElm.parentNode,self.nodeIndex(splitElm)+1);r.setEnd(parentElm.parentNode,self.nodeIndex(parentElm)+1);aft=r.extractContents();pa=parentElm.parentNode;pa.insertBefore(trimNode(bef),parentElm);if(replacementElm){pa.replaceChild(replacementElm,splitElm)}else{pa.insertBefore(splitElm,parentElm)}pa.insertBefore(trimNode(aft),parentElm);self.remove(parentElm);return replacementElm||splitElm}},bind:function(target,name,func,scope){var self=this;if(Tools.isArray(target)){var i=target.length;while(i--){target[i]=self.bind(target[i],name,func,scope)}return target}if(self.settings.collect&&(target===self.doc||target===self.win)){self.boundEvents.push([target,name,func,scope])}return self.events.bind(target,name,func,scope||self)},unbind:function(target,name,func){var self=this,i;if(Tools.isArray(target)){i=target.length;while(i--){target[i]=self.unbind(target[i],name,func)}return target}if(self.boundEvents&&(target===self.doc||target===self.win)){i=self.boundEvents.length;while(i--){var item=self.boundEvents[i];if(target==item[0]&&(!name||name==item[1])&&(!func||func==item[2])){this.events.unbind(item[0],item[1],item[2])}}}return this.events.unbind(target,name,func)},fire:function(target,name,evt){return this.events.fire(target,name,evt)},getContentEditable:function(node){var contentEditable;if(node.nodeType!=1){return null}contentEditable=node.getAttribute("data-mce-contenteditable");if(contentEditable&&contentEditable!=="inherit"){return contentEditable}return node.contentEditable!=="inherit"?node.contentEditable:null},destroy:function(){var self=this;if(self.boundEvents){var i=self.boundEvents.length;while(i--){var item=self.boundEvents[i];this.events.unbind(item[0],item[1],item[2])}self.boundEvents=null}if(Sizzle.setDocument){Sizzle.setDocument()}self.win=self.doc=self.root=self.events=self.frag=null},dumpRng:function(r){return("startContainer: "+r.startContainer.nodeName+", startOffset: "+r.startOffset+", endContainer: "+r.endContainer.nodeName+", endOffset: "+r.endOffset)},_findSib:function(node,selector,name){var self=this,func=selector;if(node){if(typeof(func)=="string"){func=function(node){return self.is(node,selector)}}for(node=node[name];node;node=node[name]){if(func(node)){return node}}}return null}};DOMUtils.DOM=new DOMUtils(document);return DOMUtils});define("tinymce/dom/ScriptLoader",["tinymce/dom/DOMUtils","tinymce/util/Tools"],function(DOMUtils,Tools){var DOM=DOMUtils.DOM;var each=Tools.each,grep=Tools.grep;function ScriptLoader(){var QUEUED=0,LOADING=1,LOADED=2,states={},queue=[],scriptLoadedCallbacks={},queueLoadedCallbacks=[],loading=0,undef;function loadScript(url,callback){var dom=DOM,elm,id;function done(){dom.remove(id);if(elm){elm.onreadystatechange=elm.onload=elm=null}callback()}function error(){if(typeof(console)!=="undefined"&&console.log){console.log("Failed to load: "+url)}}id=dom.uniqueId();elm=document.createElement("script");elm.id=id;elm.type="text/javascript";elm.src=url;if("onreadystatechange" in elm){elm.onreadystatechange=function(){if(/loaded|complete/.test(elm.readyState)){done()}}}else{elm.onload=done}elm.onerror=error;(document.getElementsByTagName("head")[0]||document.body).appendChild(elm)}this.isDone=function(url){return states[url]==LOADED};this.markDone=function(url){states[url]=LOADED};this.add=this.load=function(url,callback,scope){var state=states[url];if(state==undef){queue.push(url);states[url]=QUEUED}if(callback){if(!scriptLoadedCallbacks[url]){scriptLoadedCallbacks[url]=[]}scriptLoadedCallbacks[url].push({func:callback,scope:scope||this})}};this.loadQueue=function(callback,scope){this.loadScripts(queue,callback,scope)};this.loadScripts=function(scripts,callback,scope){var loadScripts;function execScriptLoadedCallbacks(url){each(scriptLoadedCallbacks[url],function(callback){callback.func.call(callback.scope)});scriptLoadedCallbacks[url]=undef}queueLoadedCallbacks.push({func:callback,scope:scope||this});loadScripts=function(){var loadingScripts=grep(scripts);scripts.length=0;each(loadingScripts,function(url){if(states[url]==LOADED){execScriptLoadedCallbacks(url);return}if(states[url]!=LOADING){states[url]=LOADING;loading++;loadScript(url,function(){states[url]=LOADED;loading--;execScriptLoadedCallbacks(url);loadScripts()})}});if(!loading){each(queueLoadedCallbacks,function(callback){callback.func.call(callback.scope)});queueLoadedCallbacks.length=0}};loadScripts()}}ScriptLoader.ScriptLoader=new ScriptLoader();return ScriptLoader});define("tinymce/AddOnManager",["tinymce/dom/ScriptLoader","tinymce/util/Tools"],function(ScriptLoader,Tools){var each=Tools.each;function AddOnManager(){var self=this;self.items=[];self.urls={};self.lookup={}}AddOnManager.prototype={get:function(name){if(this.lookup[name]){return this.lookup[name].instance}else{return undefined}},dependencies:function(name){var result;if(this.lookup[name]){result=this.lookup[name].dependencies}return result||[]},requireLangPack:function(name,languages){if(AddOnManager.language&&AddOnManager.languageLoad!==false){if(languages&&new RegExp("([, ]|\\b)"+AddOnManager.language+"([, ]|\\b)").test(languages)===false){return}ScriptLoader.ScriptLoader.add(this.urls[name]+"/langs/"+AddOnManager.language+".js")}},add:function(id,addOn,dependencies){this.items.push(addOn);this.lookup[id]={instance:addOn,dependencies:dependencies};return addOn},createUrl:function(baseUrl,dep){if(typeof dep==="object"){return dep}else{return{prefix:baseUrl.prefix,resource:dep,suffix:baseUrl.suffix}}},addComponents:function(pluginName,scripts){var pluginUrl=this.urls[pluginName];each(scripts,function(script){ScriptLoader.ScriptLoader.add(pluginUrl+"/"+script)})},load:function(n,u,cb,s){var t=this,url=u;function loadDependencies(){var dependencies=t.dependencies(n);each(dependencies,function(dep){var newUrl=t.createUrl(u,dep);t.load(newUrl.resource,newUrl,undefined,undefined)});if(cb){if(s){cb.call(s)}else{cb.call(ScriptLoader)}}}if(t.urls[n]){return}if(typeof u==="object"){url=u.prefix+u.resource+u.suffix}if(url.indexOf("/")!==0&&url.indexOf("://")==-1){url=AddOnManager.baseURL+"/"+url}t.urls[n]=url.substring(0,url.lastIndexOf("/"));if(t.lookup[n]){loadDependencies()}else{ScriptLoader.ScriptLoader.add(url,loadDependencies,s)}}};AddOnManager.PluginManager=new AddOnManager();AddOnManager.ThemeManager=new AddOnManager();return AddOnManager});define("tinymce/html/Node",[],function(){var whiteSpaceRegExp=/^[ \t\r\n]*$/,typeLookup={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};function walk(node,root_node,prev){var sibling,parent,startName=prev?"lastChild":"firstChild",siblingName=prev?"prev":"next";if(node[startName]){return node[startName]}if(node!==root_node){sibling=node[siblingName];if(sibling){return sibling}for(parent=node.parent;parent&&parent!==root_node;parent=parent.parent){sibling=parent[siblingName];if(sibling){return sibling}}}}function Node(name,type){this.name=name;this.type=type;if(type===1){this.attributes=[];this.attributes.map={}}}Node.prototype={replace:function(node){var self=this;if(node.parent){node.remove()}self.insert(node,self);self.remove();return self},attr:function(name,value){var self=this,attrs,i,undef;if(typeof name!=="string"){for(i in name){self.attr(i,name[i])}return self}if((attrs=self.attributes)){if(value!==undef){if(value===null){if(name in attrs.map){delete attrs.map[name];i=attrs.length;while(i--){if(attrs[i].name===name){attrs=attrs.splice(i,1);return self}}}return self}if(name in attrs.map){i=attrs.length;while(i--){if(attrs[i].name===name){attrs[i].value=value;break}}}else{attrs.push({name:name,value:value})}attrs.map[name]=value;return self}else{return attrs.map[name]}}},clone:function(){var self=this,clone=new Node(self.name,self.type),i,l,selfAttrs,selfAttr,cloneAttrs;if((selfAttrs=self.attributes)){cloneAttrs=[];cloneAttrs.map={};for(i=0,l=selfAttrs.length;i<l;i++){selfAttr=selfAttrs[i];if(selfAttr.name!=="id"){cloneAttrs[cloneAttrs.length]={name:selfAttr.name,value:selfAttr.value};cloneAttrs.map[selfAttr.name]=selfAttr.value}}clone.attributes=cloneAttrs}clone.value=self.value;clone.shortEnded=self.shortEnded;return clone},wrap:function(wrapper){var self=this;self.parent.insert(wrapper,self);wrapper.append(self);return self},unwrap:function(){var self=this,node,next;for(node=self.firstChild;node;){next=node.next;self.insert(node,self,true);node=next}self.remove()},remove:function(){var self=this,parent=self.parent,next=self.next,prev=self.prev;if(parent){if(parent.firstChild===self){parent.firstChild=next;if(next){next.prev=null}}else{prev.next=next}if(parent.lastChild===self){parent.lastChild=prev;if(prev){prev.next=null}}else{next.prev=prev}self.parent=self.next=self.prev=null}return self},append:function(node){var self=this,last;if(node.parent){node.remove()}last=self.lastChild;if(last){last.next=node;node.prev=last;self.lastChild=node}else{self.lastChild=self.firstChild=node}node.parent=self;return node},insert:function(node,ref_node,before){var parent;if(node.parent){node.remove()}parent=ref_node.parent||this;if(before){if(ref_node===parent.firstChild){parent.firstChild=node}else{ref_node.prev.next=node}node.prev=ref_node.prev;node.next=ref_node;ref_node.prev=node}else{if(ref_node===parent.lastChild){parent.lastChild=node}else{ref_node.next.prev=node}node.next=ref_node.next;node.prev=ref_node;ref_node.next=node}node.parent=parent;return node},getAll:function(name){var self=this,node,collection=[];for(node=self.firstChild;node;node=walk(node,self)){if(node.name===name){collection.push(node)}}return collection},empty:function(){var self=this,nodes,i,node;if(self.firstChild){nodes=[];for(node=self.firstChild;node;node=walk(node,self)){nodes.push(node)}i=nodes.length;while(i--){node=nodes[i];node.parent=node.firstChild=node.lastChild=node.next=node.prev=null}}self.firstChild=self.lastChild=null;return self},isEmpty:function(elements){var self=this,node=self.firstChild,i,name;if(node){do{if(node.type===1){if(node.attributes.map["data-mce-bogus"]){continue}if(elements[node.name]){return false}i=node.attributes.length;while(i--){name=node.attributes[i].name;if(name==="name"||name.indexOf("data-mce-")===0){return false}}}if(node.type===8){return false}if((node.type===3&&!whiteSpaceRegExp.test(node.value))){return false}}while((node=walk(node,self)))}return true},walk:function(prev){return walk(this,null,prev)}};Node.create=function(name,attrs){var node,attrName;node=new Node(name,typeLookup[name]||1);if(attrs){for(attrName in attrs){node.attr(attrName,attrs[attrName])}}return node};return Node});define("tinymce/html/Schema",["tinymce/util/Tools"],function(Tools){var mapCache={};var makeMap=Tools.makeMap,each=Tools.each,extend=Tools.extend,explode=Tools.explode,inArray=Tools.inArray;function split(items,delim){return items?items.split(delim||" "):[]}function compileSchema(type){var schema={},globalAttributes,eventAttributes,blockContent;var phrasingContent,flowContent,html4BlockContent,html4PhrasingContent;function add(name,attributes,children){var ni,i,attributesOrder,args=arguments;function arrayToMap(array){var map={},i,l;for(i=0,l=array.length;i<l;i++){map[array[i]]={}}return map}children=children||[];attributes=attributes||"";if(typeof(children)==="string"){children=split(children)}for(i=3;i<args.length;i++){if(typeof(args[i])==="string"){args[i]=split(args[i])}children.push.apply(children,args[i])}name=split(name);ni=name.length;while(ni--){attributesOrder=[].concat(globalAttributes,split(attributes));schema[name[ni]]={attributes:arrayToMap(attributesOrder),attributesOrder:attributesOrder,children:arrayToMap(children)}}}function addAttrs(name,attributes){var ni,schemaItem,i,l;name=split(name);ni=name.length;attributes=split(attributes);while(ni--){schemaItem=schema[name[ni]];for(i=0,l=attributes.length;i<l;i++){schemaItem.attributes[attributes[i]]={};schemaItem.attributesOrder.push(attributes[i])}}}if(mapCache[type]){return mapCache[type]}globalAttributes=split("id accesskey class dir lang style tabindex title");eventAttributes=split("onabort onblur oncancel oncanplay oncanplaythrough onchange onclick onclose oncontextmenu oncuechange ondblclick ondrag ondragend ondragenter ondragleave ondragover ondragstart ondrop ondurationchange onemptied onended onerror onfocus oninput oninvalid onkeydown onkeypress onkeyup onload onloadeddata onloadedmetadata onloadstart onmousedown onmousemove onmouseout onmouseover onmouseup onmousewheel onpause onplay onplaying onprogress onratechange onreset onscroll onseeked onseeking onseeking onselect onshow onstalled onsubmit onsuspend ontimeupdate onvolumechange onwaiting");blockContent=split("address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul");phrasingContent=split("a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment");if(type!="html4"){globalAttributes.push.apply(globalAttributes,split("contenteditable contextmenu draggable dropzone hidden spellcheck translate"));blockContent.push.apply(blockContent,split("article aside details dialog figure header footer hgroup section nav"));phrasingContent.push.apply(phrasingContent,split("audio canvas command datalist mark meter output progress time wbr video ruby bdi keygen"))}if(type!="html5-strict"){globalAttributes.push("xml:lang");html4PhrasingContent=split("acronym applet basefont big font strike tt");phrasingContent.push.apply(phrasingContent,html4PhrasingContent);each(html4PhrasingContent,function(name){add(name,"",phrasingContent)});html4BlockContent=split("center dir isindex noframes");blockContent.push.apply(blockContent,html4BlockContent);flowContent=[].concat(blockContent,phrasingContent);each(html4BlockContent,function(name){add(name,"",flowContent)})}flowContent=flowContent||[].concat(blockContent,phrasingContent);add("html","manifest","head body");add("head","","base command link meta noscript script style title");add("title hr noscript br");add("base","href target");add("link","href rel media hreflang type sizes hreflang");add("meta","name http-equiv content charset");add("style","media type scoped");add("script","src async defer type charset");add("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",flowContent);add("address dt dd div caption","",flowContent);add("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",phrasingContent);add("blockquote","cite",flowContent);add("ol","reversed start type","li");add("ul","","li");add("li","value",flowContent);add("dl","","dt dd");add("a","href target rel media hreflang type",phrasingContent);add("q","cite",phrasingContent);add("ins del","cite datetime",flowContent);add("img","src alt usemap ismap width height");add("iframe","src name width height",flowContent);add("embed","src type width height");add("object","data type typemustmatch name usemap form width height",flowContent,"param");add("param","name value");add("map","name",flowContent,"area");add("area","alt coords shape href target rel media hreflang type");add("table","border","caption colgroup thead tfoot tbody tr"+(type=="html4"?" col":""));add("colgroup","span","col");add("col","span");add("tbody thead tfoot","","tr");add("tr","","td th");add("td","colspan rowspan headers",flowContent);add("th","colspan rowspan headers scope abbr",flowContent);add("form","accept-charset action autocomplete enctype method name novalidate target",flowContent);add("fieldset","disabled form name",flowContent,"legend");add("label","form for",phrasingContent);add("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width");add("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",type=="html4"?flowContent:phrasingContent);add("select","disabled form multiple name required size","option optgroup");add("optgroup","disabled label","option");add("option","disabled label selected value");add("textarea","cols dirname disabled form maxlength name readonly required rows wrap");add("menu","type label",flowContent,"li");add("noscript","",flowContent);if(type!="html4"){add("wbr");add("ruby","",phrasingContent,"rt rp");add("figcaption","",flowContent);add("mark rt rp summary bdi","",phrasingContent);add("canvas","width height",flowContent);add("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height",flowContent,"track source");add("audio","src crossorigin preload autoplay mediagroup loop muted controls",flowContent,"track source");add("source","src type media");add("track","kind src srclang label default");add("datalist","",phrasingContent,"option");add("article section nav aside header footer","",flowContent);add("hgroup","","h1 h2 h3 h4 h5 h6");add("figure","",flowContent,"figcaption");add("time","datetime",phrasingContent);add("dialog","open",flowContent);add("command","type label icon disabled checked radiogroup command");add("output","for form name",phrasingContent);add("progress","value max",phrasingContent);add("meter","value min max low high optimum",phrasingContent);add("details","open",flowContent,"summary");add("keygen","autofocus challenge disabled form keytype name")}if(type!="html5-strict"){addAttrs("script","language xml:space");addAttrs("style","xml:space");addAttrs("object","declare classid codebase codetype archive standby align border hspace vspace");addAttrs("param","valuetype type");addAttrs("a","charset name rev shape coords");addAttrs("br","clear");addAttrs("applet","codebase archive code object alt name width height align hspace vspace");addAttrs("img","name longdesc align border hspace vspace");addAttrs("iframe","longdesc frameborder marginwidth marginheight scrolling align");addAttrs("font basefont","size color face");addAttrs("input","usemap align");addAttrs("select","onchange");addAttrs("textarea");addAttrs("h1 h2 h3 h4 h5 h6 div p legend caption","align");addAttrs("ul","type compact");addAttrs("li","type");addAttrs("ol dl menu dir","compact");addAttrs("pre","width xml:space");addAttrs("hr","align noshade size width");addAttrs("isindex","prompt");addAttrs("table","summary width frame rules cellspacing cellpadding align bgcolor");addAttrs("col","width align char charoff valign");addAttrs("colgroup","width align char charoff valign");addAttrs("thead","align char charoff valign");addAttrs("tr","align char charoff valign bgcolor");addAttrs("th","axis align char charoff valign nowrap bgcolor width height");addAttrs("form","accept");addAttrs("td","abbr axis scope align char charoff valign nowrap bgcolor width height");addAttrs("tfoot","align char charoff valign");addAttrs("tbody","align char charoff valign");addAttrs("area","nohref");addAttrs("body","background bgcolor text link vlink alink")}if(type!="html4"){addAttrs("input button select textarea","autofocus");addAttrs("input textarea","placeholder");addAttrs("a","download");addAttrs("link script img","crossorigin");addAttrs("iframe","srcdoc sandbox seamless allowfullscreen")}each(split("a form meter progress dfn"),function(name){if(schema[name]){delete schema[name].children[name]}});delete schema.caption.children.table;mapCache[type]=schema;return schema}return function(settings){var self=this,elements={},children={},patternElements=[],validStyles,schemaItems;var whiteSpaceElementsMap,selfClosingElementsMap,shortEndedElementsMap,boolAttrMap;var blockElementsMap,nonEmptyElementsMap,textBlockElementsMap,customElementsMap={},specialElements={};function createLookupTable(option,default_value,extendWith){var value=settings[option];if(!value){value=mapCache[option];if(!value){value=makeMap(default_value," ",makeMap(default_value.toUpperCase()," "));value=extend(value,extendWith);mapCache[option]=value}}else{value=makeMap(value,",",makeMap(value.toUpperCase()," "))}return value}settings=settings||{};schemaItems=compileSchema(settings.schema);if(settings.verify_html===false){settings.valid_elements="*[*]"}if(settings.valid_styles){validStyles={};each(settings.valid_styles,function(value,key){validStyles[key]=explode(value)})}whiteSpaceElementsMap=createLookupTable("whitespace_elements","pre script noscript style textarea video audio iframe object");selfClosingElementsMap=createLookupTable("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr");shortEndedElementsMap=createLookupTable("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track");boolAttrMap=createLookupTable("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls");nonEmptyElementsMap=createLookupTable("non_empty_elements","td th iframe video audio object",shortEndedElementsMap);textBlockElementsMap=createLookupTable("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure");blockElementsMap=createLookupTable("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex samp option datalist select optgroup",textBlockElementsMap);each((settings.special||"script noscript style textarea").split(" "),function(name){specialElements[name]=new RegExp("</"+name+"[^>]*>","gi")});function patternToRegExp(str){return new RegExp("^"+str.replace(/([?+*])/g,".$1")+"$")}function addValidElements(valid_elements){var ei,el,ai,al,matches,element,attr,attrData,elementName,attrName,attrType,attributes,attributesOrder,prefix,outputName,globalAttributes,globalAttributesOrder,key,value,elementRuleRegExp=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/,attrRuleRegExp=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,hasPatternsRegExp=/[*?+]/;if(valid_elements){valid_elements=split(valid_elements,",");if(elements["@"]){globalAttributes=elements["@"].attributes;globalAttributesOrder=elements["@"].attributesOrder}for(ei=0,el=valid_elements.length;ei<el;ei++){matches=elementRuleRegExp.exec(valid_elements[ei]);if(matches){prefix=matches[1];elementName=matches[2];outputName=matches[3];attrData=matches[5];attributes={};attributesOrder=[];element={attributes:attributes,attributesOrder:attributesOrder};if(prefix==="#"){element.paddEmpty=true}if(prefix==="-"){element.removeEmpty=true}if(matches[4]==="!"){element.removeEmptyAttrs=true}if(globalAttributes){for(key in globalAttributes){attributes[key]=globalAttributes[key]}attributesOrder.push.apply(attributesOrder,globalAttributesOrder)}if(attrData){attrData=split(attrData,"|");for(ai=0,al=attrData.length;ai<al;ai++){matches=attrRuleRegExp.exec(attrData[ai]);if(matches){attr={};attrType=matches[1];attrName=matches[2].replace(/::/g,":");prefix=matches[3];value=matches[4];if(attrType==="!"){element.attributesRequired=element.attributesRequired||[];element.attributesRequired.push(attrName);attr.required=true}if(attrType==="-"){delete attributes[attrName];attributesOrder.splice(inArray(attributesOrder,attrName),1);continue}if(prefix){if(prefix==="="){element.attributesDefault=element.attributesDefault||[];element.attributesDefault.push({name:attrName,value:value});attr.defaultValue=value}if(prefix===":"){element.attributesForced=element.attributesForced||[];element.attributesForced.push({name:attrName,value:value});attr.forcedValue=value}if(prefix==="<"){attr.validValues=makeMap(value,"?")}}if(hasPatternsRegExp.test(attrName)){element.attributePatterns=element.attributePatterns||[];attr.pattern=patternToRegExp(attrName);element.attributePatterns.push(attr)}else{if(!attributes[attrName]){attributesOrder.push(attrName)}attributes[attrName]=attr}}}}if(!globalAttributes&&elementName=="@"){globalAttributes=attributes;globalAttributesOrder=attributesOrder}if(outputName){element.outputName=elementName;elements[outputName]=element}if(hasPatternsRegExp.test(elementName)){element.pattern=patternToRegExp(elementName);patternElements.push(element)}else{elements[elementName]=element}}}}}function setValidElements(valid_elements){elements={};patternElements=[];addValidElements(valid_elements);each(schemaItems,function(element,name){children[name]=element.children})}function addCustomElements(custom_elements){var customElementRegExp=/^(~)?(.+)$/;if(custom_elements){each(split(custom_elements,","),function(rule){var matches=customElementRegExp.exec(rule),inline=matches[1]==="~",cloneName=inline?"span":"div",name=matches[2];children[name]=children[cloneName];customElementsMap[name]=cloneName;if(!inline){blockElementsMap[name.toUpperCase()]={};blockElementsMap[name]={}}if(!elements[name]){var customRule=elements[cloneName];customRule=extend({},customRule);delete customRule.removeEmptyAttrs;delete customRule.removeEmpty;elements[name]=customRule}each(children,function(element){if(element[cloneName]){element[name]=element[cloneName]}})})}}function addValidChildren(valid_children){var childRuleRegExp=/^([+\-]?)(\w+)\[([^\]]+)\]$/;if(valid_children){each(split(valid_children,","),function(rule){var matches=childRuleRegExp.exec(rule),parent,prefix;if(matches){prefix=matches[1];if(prefix){parent=children[matches[2]]}else{parent=children[matches[2]]={"#comment":{}}}parent=children[matches[2]];each(split(matches[3],"|"),function(child){if(prefix==="-"){delete parent[child]}else{parent[child]={}}})}})}}function getElementRule(name){var element=elements[name],i;if(element){return element}i=patternElements.length;while(i--){element=patternElements[i];if(element.pattern.test(name)){return element}}}if(!settings.valid_elements){each(schemaItems,function(element,name){elements[name]={attributes:element.attributes,attributesOrder:element.attributesOrder};children[name]=element.children});if(settings.schema!="html5"){each(split("strong/b em/i"),function(item){item=split(item,"/");elements[item[1]].outputName=item[0]})}elements.img.attributesDefault=[{name:"alt",value:""}];each(split("ol ul sub sup blockquote span font a table tbody tr strong em b i"),function(name){if(elements[name]){elements[name].removeEmpty=true}});each(split("p h1 h2 h3 h4 h5 h6 th td pre div address caption"),function(name){elements[name].paddEmpty=true});each(split("span"),function(name){elements[name].removeEmptyAttrs=true})}else{setValidElements(settings.valid_elements)}addCustomElements(settings.custom_elements);addValidChildren(settings.valid_children);addValidElements(settings.extended_valid_elements);addValidChildren("+ol[ul|ol],+ul[ul|ol]");if(settings.invalid_elements){each(explode(settings.invalid_elements),function(item){if(elements[item]){delete elements[item]}})}if(!getElementRule("span")){addValidElements("span[!data-mce-type|*]")}self.children=children;self.styles=validStyles;self.getBoolAttrs=function(){return boolAttrMap};self.getBlockElements=function(){return blockElementsMap};self.getTextBlockElements=function(){return textBlockElementsMap};self.getShortEndedElements=function(){return shortEndedElementsMap};self.getSelfClosingElements=function(){return selfClosingElementsMap};self.getNonEmptyElements=function(){return nonEmptyElementsMap};self.getWhiteSpaceElements=function(){return whiteSpaceElementsMap};self.getSpecialElements=function(){return specialElements};self.isValidChild=function(name,child){var parent=children[name];return !!(parent&&parent[child])};self.isValid=function(name,attr){var attrPatterns,i,rule=getElementRule(name);if(rule){if(attr){if(rule.attributes[attr]){return true}attrPatterns=rule.attributePatterns;if(attrPatterns){i=attrPatterns.length;while(i--){if(attrPatterns[i].pattern.test(name)){return true}}}}else{return true}}return false};self.getElementRule=getElementRule;self.getCustomElements=function(){return customElementsMap};self.addValidElements=addValidElements;self.setValidElements=setValidElements;self.addCustomElements=addCustomElements;self.addValidChildren=addValidChildren;self.elements=elements}});define("tinymce/html/SaxParser",["tinymce/html/Schema","tinymce/html/Entities","tinymce/util/Tools"],function(Schema,Entities,Tools){var each=Tools.each;return function(settings,schema){var self=this,noop=function(){};settings=settings||{};self.schema=schema=schema||new Schema();if(settings.fix_self_closing!==false){settings.fix_self_closing=true}each("comment cdata text start end pi doctype".split(" "),function(name){if(name){self[name]=settings[name]||noop}});self.parse=function(html){var self=this,matches,index=0,value,endRegExp,stack=[],attrList,i,text,name;var isInternalElement,removeInternalElements,shortEndedElements,fillAttrsMap,isShortEnded;var validate,elementRule,isValidElement,attr,attribsValue,validAttributesMap,validAttributePatterns;var attributesRequired,attributesDefault,attributesForced;var anyAttributesRequired,selfClosing,tokenRegExp,attrRegExp,specialElements,attrValue,idCount=0;var decode=Entities.decode,fixSelfClosing,filteredUrlAttrs=Tools.makeMap("src,href");var scriptUriRegExp=/(java|vb)script:/i;function processEndTag(name){var pos,i;pos=stack.length;while(pos--){if(stack[pos].name===name){break}}if(pos>=0){for(i=stack.length-1;i>=pos;i--){name=stack[i];if(name.valid){self.end(name.name)}}stack.length=pos}}function parseAttribute(match,name,value,val2,val3){var attrRule,i,trimRegExp=/[\s\u0000-\u001F]+/g;name=name.toLowerCase();value=name in fillAttrsMap?name:decode(value||val2||val3||"");if(validate&&!isInternalElement&&name.indexOf("data-")!==0){attrRule=validAttributesMap[name];if(!attrRule&&validAttributePatterns){i=validAttributePatterns.length;while(i--){attrRule=validAttributePatterns[i];if(attrRule.pattern.test(name)){break}}if(i===-1){attrRule=null}}if(!attrRule){return}if(attrRule.validValues&&!(value in attrRule.validValues)){return}}if(filteredUrlAttrs[name]&&!settings.allow_script_urls){var uri=value.replace(trimRegExp,"");try{uri=decodeURIComponent(uri);if(scriptUriRegExp.test(uri)){return}}catch(ex){uri=unescape(uri);if(scriptUriRegExp.test(uri)){return}}}attrList.map[name]=value;attrList.push({name:name,value:value})}tokenRegExp=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-\\:\\.]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g");attrRegExp=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g;shortEndedElements=schema.getShortEndedElements();selfClosing=settings.self_closing_elements||schema.getSelfClosingElements();fillAttrsMap=schema.getBoolAttrs();validate=settings.validate;removeInternalElements=settings.remove_internals;fixSelfClosing=settings.fix_self_closing;specialElements=schema.getSpecialElements();while((matches=tokenRegExp.exec(html))){if(index<matches.index){self.text(decode(html.substr(index,matches.index-index)))}if((value=matches[6])){value=value.toLowerCase();if(value.charAt(0)===":"){value=value.substr(1)}processEndTag(value)}else{if((value=matches[7])){value=value.toLowerCase();if(value.charAt(0)===":"){value=value.substr(1)}isShortEnded=value in shortEndedElements;if(fixSelfClosing&&selfClosing[value]&&stack.length>0&&stack[stack.length-1].name===value){processEndTag(value)}if(!validate||(elementRule=schema.getElementRule(value))){isValidElement=true;if(validate){validAttributesMap=elementRule.attributes;validAttributePatterns=elementRule.attributePatterns}if((attribsValue=matches[8])){isInternalElement=attribsValue.indexOf("data-mce-type")!==-1;if(isInternalElement&&removeInternalElements){isValidElement=false}attrList=[];attrList.map={};attribsValue.replace(attrRegExp,parseAttribute)}else{attrList=[];attrList.map={}}if(validate&&!isInternalElement){attributesRequired=elementRule.attributesRequired;attributesDefault=elementRule.attributesDefault;attributesForced=elementRule.attributesForced;anyAttributesRequired=elementRule.removeEmptyAttrs;if(anyAttributesRequired&&!attrList.length){isValidElement=false}if(attributesForced){i=attributesForced.length;while(i--){attr=attributesForced[i];name=attr.name;attrValue=attr.value;if(attrValue==="{$uid}"){attrValue="mce_"+idCount++}attrList.map[name]=attrValue;attrList.push({name:name,value:attrValue})}}if(attributesDefault){i=attributesDefault.length;while(i--){attr=attributesDefault[i];name=attr.name;if(!(name in attrList.map)){attrValue=attr.value;if(attrValue==="{$uid}"){attrValue="mce_"+idCount++}attrList.map[name]=attrValue;attrList.push({name:name,value:attrValue})}}}if(attributesRequired){i=attributesRequired.length;while(i--){if(attributesRequired[i] in attrList.map){break}}if(i===-1){isValidElement=false}}if(attrList.map["data-mce-bogus"]){isValidElement=false}}if(isValidElement){self.start(value,attrList,isShortEnded)}}else{isValidElement=false}if((endRegExp=specialElements[value])){endRegExp.lastIndex=index=matches.index+matches[0].length;if((matches=endRegExp.exec(html))){if(isValidElement){text=html.substr(index,matches.index-index)}index=matches.index+matches[0].length}else{text=html.substr(index);index=html.length}if(isValidElement){if(text.length>0){self.text(text,true)}self.end(value)}tokenRegExp.lastIndex=index;continue}if(!isShortEnded){if(!attribsValue||attribsValue.indexOf("/")!=attribsValue.length-1){stack.push({name:value,valid:isValidElement})}else{if(isValidElement){self.end(value)}}}}else{if((value=matches[1])){if(value.charAt(0)===">"){value=" "+value}if(!settings.allow_conditional_comments&&value.substr(0,3)==="[if"){value=" "+value}self.comment(value)}else{if((value=matches[2])){self.cdata(value)}else{if((value=matches[3])){self.doctype(value)}else{if((value=matches[4])){self.pi(value,matches[5])}}}}}}index=matches.index+matches[0].length}if(index<html.length){self.text(decode(html.substr(index)))}for(i=stack.length-1;i>=0;i--){value=stack[i];if(value.valid){self.end(value.name)}}}}});define("tinymce/html/DomParser",["tinymce/html/Node","tinymce/html/Schema","tinymce/html/SaxParser","tinymce/util/Tools"],function(Node,Schema,SaxParser,Tools){var makeMap=Tools.makeMap,each=Tools.each,explode=Tools.explode,extend=Tools.extend;return function(settings,schema){var self=this,nodeFilters={},attributeFilters=[],matchedNodes={},matchedAttributes={};settings=settings||{};settings.validate="validate" in settings?settings.validate:true;settings.root_name=settings.root_name||"body";self.schema=schema=schema||new Schema();function fixInvalidChildren(nodes){var ni,node,parent,parents,newParent,currentNode,tempNode,childNode,i;var nonEmptyElements,nonSplitableElements,textBlockElements,sibling,nextNode;nonSplitableElements=makeMap("tr,td,th,tbody,thead,tfoot,table");nonEmptyElements=schema.getNonEmptyElements();textBlockElements=schema.getTextBlockElements();for(ni=0;ni<nodes.length;ni++){node=nodes[ni];if(!node.parent||node.fixed){continue}if(textBlockElements[node.name]&&node.parent.name=="li"){sibling=node.next;while(sibling){if(textBlockElements[sibling.name]){sibling.name="li";sibling.fixed=true;node.parent.insert(sibling,node.parent)}else{break}sibling=sibling.next}node.unwrap(node);continue}parents=[node];for(parent=node.parent;parent&&!schema.isValidChild(parent.name,node.name)&&!nonSplitableElements[parent.name];parent=parent.parent){parents.push(parent)}if(parent&&parents.length>1){parents.reverse();newParent=currentNode=self.filterNode(parents[0].clone());for(i=0;i<parents.length-1;i++){if(schema.isValidChild(currentNode.name,parents[i].name)){tempNode=self.filterNode(parents[i].clone());currentNode.append(tempNode)}else{tempNode=currentNode}for(childNode=parents[i].firstChild;childNode&&childNode!=parents[i+1];){nextNode=childNode.next;tempNode.append(childNode);childNode=nextNode}currentNode=tempNode}if(!newParent.isEmpty(nonEmptyElements)){parent.insert(newParent,parents[0],true);parent.insert(node,newParent)}else{parent.insert(node,parents[0],true)}parent=parents[0];if(parent.isEmpty(nonEmptyElements)||parent.firstChild===parent.lastChild&&parent.firstChild.name==="br"){parent.empty().remove()}}else{if(node.parent){if(node.name==="li"){sibling=node.prev;if(sibling&&(sibling.name==="ul"||sibling.name==="ul")){sibling.append(node);continue}sibling=node.next;if(sibling&&(sibling.name==="ul"||sibling.name==="ul")){sibling.insert(node,sibling.firstChild,true);continue}node.wrap(self.filterNode(new Node("ul",1)));continue}if(schema.isValidChild(node.parent.name,"div")&&schema.isValidChild("div",node.name)){node.wrap(self.filterNode(new Node("div",1)))}else{if(node.name==="style"||node.name==="script"){node.empty().remove()}else{node.unwrap()}}}}}}self.filterNode=function(node){var i,name,list;if(name in nodeFilters){list=matchedNodes[name];if(list){list.push(node)}else{matchedNodes[name]=[node]}}i=attributeFilters.length;while(i--){name=attributeFilters[i].name;if(name in node.attributes.map){list=matchedAttributes[name];if(list){list.push(node)}else{matchedAttributes[name]=[node]}}}return node};self.addNodeFilter=function(name,callback){each(explode(name),function(name){var list=nodeFilters[name];if(!list){nodeFilters[name]=list=[]}list.push(callback)})};self.addAttributeFilter=function(name,callback){each(explode(name),function(name){var i;for(i=0;i<attributeFilters.length;i++){if(attributeFilters[i].name===name){attributeFilters[i].callbacks.push(callback);return}}attributeFilters.push({name:name,callbacks:[callback]})})};self.parse=function(html,args){var parser,rootNode,node,nodes,i,l,fi,fl,list,name,validate;var blockElements,startWhiteSpaceRegExp,invalidChildren=[],isInWhiteSpacePreservedElement;var endWhiteSpaceRegExp,allWhiteSpaceRegExp,isAllWhiteSpaceRegExp,whiteSpaceElements;var children,nonEmptyElements,rootBlockName;args=args||{};matchedNodes={};matchedAttributes={};blockElements=extend(makeMap("script,style,head,html,body,title,meta,param"),schema.getBlockElements());nonEmptyElements=schema.getNonEmptyElements();children=schema.children;validate=settings.validate;rootBlockName="forced_root_block" in args?args.forced_root_block:settings.forced_root_block;whiteSpaceElements=schema.getWhiteSpaceElements();startWhiteSpaceRegExp=/^[ \t\r\n]+/;endWhiteSpaceRegExp=/[ \t\r\n]+$/;allWhiteSpaceRegExp=/[ \t\r\n]+/g;isAllWhiteSpaceRegExp=/^[ \t\r\n]+$/;function addRootBlocks(){var node=rootNode.firstChild,next,rootBlockNode;function trim(rootBlockNode){if(rootBlockNode){node=rootBlockNode.firstChild;if(node&&node.type==3){node.value=node.value.replace(startWhiteSpaceRegExp,"")}node=rootBlockNode.lastChild;if(node&&node.type==3){node.value=node.value.replace(endWhiteSpaceRegExp,"")}}}if(!schema.isValidChild(rootNode.name,rootBlockName.toLowerCase())){return}while(node){next=node.next;if(node.type==3||(node.type==1&&node.name!=="p"&&!blockElements[node.name]&&!node.attr("data-mce-type"))){if(!rootBlockNode){rootBlockNode=createNode(rootBlockName,1);rootBlockNode.attr(settings.forced_root_block_attrs);rootNode.insert(rootBlockNode,node);rootBlockNode.append(node)}else{rootBlockNode.append(node)}}else{trim(rootBlockNode);rootBlockNode=null}node=next}trim(rootBlockNode)}function createNode(name,type){var node=new Node(name,type),list;if(name in nodeFilters){list=matchedNodes[name];if(list){list.push(node)}else{matchedNodes[name]=[node]}}return node}function removeWhitespaceBefore(node){var textNode,textVal,sibling;for(textNode=node.prev;textNode&&textNode.type===3;){textVal=textNode.value.replace(endWhiteSpaceRegExp,"");if(textVal.length>0){textNode.value=textVal;textNode=textNode.prev}else{sibling=textNode.prev;textNode.remove();textNode=sibling}}}function cloneAndExcludeBlocks(input){var name,output={};for(name in input){if(name!=="li"&&name!="p"){output[name]=input[name]}}return output}parser=new SaxParser({validate:validate,allow_script_urls:settings.allow_script_urls,allow_conditional_comments:settings.allow_conditional_comments,self_closing_elements:cloneAndExcludeBlocks(schema.getSelfClosingElements()),cdata:function(text){node.append(createNode("#cdata",4)).value=text},text:function(text,raw){var textNode;if(!isInWhiteSpacePreservedElement){text=text.replace(allWhiteSpaceRegExp," ");if(node.lastChild&&blockElements[node.lastChild.name]){text=text.replace(startWhiteSpaceRegExp,"")}}if(text.length!==0){textNode=createNode("#text",3);textNode.raw=!!raw;node.append(textNode).value=text}},comment:function(text){node.append(createNode("#comment",8)).value=text},pi:function(name,text){node.append(createNode(name,7)).value=text;removeWhitespaceBefore(node)},doctype:function(text){var newNode;newNode=node.append(createNode("#doctype",10));newNode.value=text;removeWhitespaceBefore(node)},start:function(name,attrs,empty){var newNode,attrFiltersLen,elementRule,attrName,parent;elementRule=validate?schema.getElementRule(name):{};if(elementRule){newNode=createNode(elementRule.outputName||name,1);newNode.attributes=attrs;newNode.shortEnded=empty;node.append(newNode);parent=children[node.name];if(parent&&children[newNode.name]&&!parent[newNode.name]){invalidChildren.push(newNode)}attrFiltersLen=attributeFilters.length;while(attrFiltersLen--){attrName=attributeFilters[attrFiltersLen].name;if(attrName in attrs.map){list=matchedAttributes[attrName];if(list){list.push(newNode)}else{matchedAttributes[attrName]=[newNode]}}}if(blockElements[name]){removeWhitespaceBefore(newNode)}if(!empty){node=newNode}if(!isInWhiteSpacePreservedElement&&whiteSpaceElements[name]){isInWhiteSpacePreservedElement=true}}},end:function(name){var textNode,elementRule,text,sibling,tempNode;elementRule=validate?schema.getElementRule(name):{};if(elementRule){if(blockElements[name]){if(!isInWhiteSpacePreservedElement){textNode=node.firstChild;if(textNode&&textNode.type===3){text=textNode.value.replace(startWhiteSpaceRegExp,"");if(text.length>0){textNode.value=text;textNode=textNode.next}else{sibling=textNode.next;textNode.remove();textNode=sibling;while(textNode&&textNode.type===3){text=textNode.value;sibling=textNode.next;if(text.length===0||isAllWhiteSpaceRegExp.test(text)){textNode.remove();textNode=sibling}textNode=sibling}}}textNode=node.lastChild;if(textNode&&textNode.type===3){text=textNode.value.replace(endWhiteSpaceRegExp,"");if(text.length>0){textNode.value=text;textNode=textNode.prev}else{sibling=textNode.prev;textNode.remove();textNode=sibling;while(textNode&&textNode.type===3){text=textNode.value;sibling=textNode.prev;if(text.length===0||isAllWhiteSpaceRegExp.test(text)){textNode.remove();textNode=sibling}textNode=sibling}}}}}if(isInWhiteSpacePreservedElement&&whiteSpaceElements[name]){isInWhiteSpacePreservedElement=false}if(elementRule.removeEmpty||elementRule.paddEmpty){if(node.isEmpty(nonEmptyElements)){if(elementRule.paddEmpty){node.empty().append(new Node("#text","3")).value="\u00a0"}else{if(!node.attributes.map.name&&!node.attributes.map.id){tempNode=node.parent;node.empty().remove();node=tempNode;return}}}}node=node.parent}}},schema);rootNode=node=new Node(args.context||settings.root_name,11);parser.parse(html);if(validate&&invalidChildren.length){if(!args.context){fixInvalidChildren(invalidChildren)}else{args.invalid=true}}if(rootBlockName&&(rootNode.name=="body"||args.isRootContent)){addRootBlocks()}if(!args.invalid){for(name in matchedNodes){list=nodeFilters[name];nodes=matchedNodes[name];fi=nodes.length;while(fi--){if(!nodes[fi].parent){nodes.splice(fi,1)}}for(i=0,l=list.length;i<l;i++){list[i](nodes,name,args)}}for(i=0,l=attributeFilters.length;i<l;i++){list=attributeFilters[i];if(list.name in matchedAttributes){nodes=matchedAttributes[list.name];fi=nodes.length;while(fi--){if(!nodes[fi].parent){nodes.splice(fi,1)}}for(fi=0,fl=list.callbacks.length;fi<fl;fi++){list.callbacks[fi](nodes,list.name,args)}}}}return rootNode};if(settings.remove_trailing_brs){self.addNodeFilter("br",function(nodes){var i,l=nodes.length,node,blockElements=extend({},schema.getBlockElements());var nonEmptyElements=schema.getNonEmptyElements(),parent,lastParent,prev,prevName;var elementRule,textNode;blockElements.body=1;for(i=0;i<l;i++){node=nodes[i];parent=node.parent;if(blockElements[node.parent.name]&&node===parent.lastChild){prev=node.prev;while(prev){prevName=prev.name;if(prevName!=="span"||prev.attr("data-mce-type")!=="bookmark"){if(prevName!=="br"){break}if(prevName==="br"){node=null;break}}prev=prev.prev}if(node){node.remove();if(parent.isEmpty(nonEmptyElements)){elementRule=schema.getElementRule(parent.name);if(elementRule){if(elementRule.removeEmpty){parent.remove()}else{if(elementRule.paddEmpty){parent.empty().append(new Node("#text",3)).value="\u00a0"}}}}}}else{lastParent=node;while(parent&&parent.firstChild===lastParent&&parent.lastChild===lastParent){lastParent=parent;if(blockElements[parent.name]){break}parent=parent.parent}if(lastParent===parent){textNode=new Node("#text",3);textNode.value="\u00a0";node.replace(textNode)}}}})}if(!settings.allow_html_in_named_anchor){self.addAttributeFilter("id,name",function(nodes){var i=nodes.length,sibling,prevSibling,parent,node;while(i--){node=nodes[i];if(node.name==="a"&&node.firstChild&&!node.attr("href")){parent=node.parent;sibling=node.lastChild;do{prevSibling=sibling.prev;parent.insert(sibling,node);sibling=prevSibling}while(sibling)}}})}}});define("tinymce/html/Writer",["tinymce/html/Entities","tinymce/util/Tools"],function(Entities,Tools){var makeMap=Tools.makeMap;return function(settings){var html=[],indent,indentBefore,indentAfter,encode,htmlOutput;settings=settings||{};indent=settings.indent;indentBefore=makeMap(settings.indent_before||"");indentAfter=makeMap(settings.indent_after||"");encode=Entities.getEncodeFunc(settings.entity_encoding||"raw",settings.entities);htmlOutput=settings.element_format=="html";return{start:function(name,attrs,empty){var i,l,attr,value;if(indent&&indentBefore[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=="\n"){html.push("\n")}}html.push("<",name);if(attrs){for(i=0,l=attrs.length;i<l;i++){attr=attrs[i];html.push(" ",attr.name,'="',encode(attr.value,true),'"')}}if(!empty||htmlOutput){html[html.length]=">"}else{html[html.length]=" />"}if(empty&&indent&&indentAfter[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=="\n"){html.push("\n")}}},end:function(name){var value;html.push("</",name,">");if(indent&&indentAfter[name]&&html.length>0){value=html[html.length-1];if(value.length>0&&value!=="\n"){html.push("\n")}}},text:function(text,raw){if(text.length>0){html[html.length]=raw?text:encode(text)}},cdata:function(text){html.push("<![CDATA[",text,"]]>")},comment:function(text){html.push("<!--",text,"-->")},pi:function(name,text){if(text){html.push("<?",name," ",text,"?>")}else{html.push("<?",name,"?>")}if(indent){html.push("\n")}},doctype:function(text){html.push("<!DOCTYPE",text,">",indent?"\n":"")},reset:function(){html.length=0},getContent:function(){return html.join("").replace(/\n$/,"")}}}});define("tinymce/html/Serializer",["tinymce/html/Writer","tinymce/html/Schema"],function(Writer,Schema){return function(settings,schema){var self=this,writer=new Writer(settings);settings=settings||{};settings.validate="validate" in settings?settings.validate:true;self.schema=schema=schema||new Schema();self.writer=writer;self.serialize=function(node){var handlers,validate;validate=settings.validate;handlers={3:function(node){writer.text(node.value,node.raw)},8:function(node){writer.comment(node.value)},7:function(node){writer.pi(node.name,node.value)},10:function(node){writer.doctype(node.value)},4:function(node){writer.cdata(node.value)},11:function(node){if((node=node.firstChild)){do{walk(node)}while((node=node.next))}}};writer.reset();function walk(node){var handler=handlers[node.type],name,isEmpty,attrs,attrName,attrValue,sortedAttrs,i,l,elementRule;if(!handler){name=node.name;isEmpty=node.shortEnded;attrs=node.attributes;if(validate&&attrs&&attrs.length>1){sortedAttrs=[];sortedAttrs.map={};elementRule=schema.getElementRule(node.name);for(i=0,l=elementRule.attributesOrder.length;i<l;i++){attrName=elementRule.attributesOrder[i];if(attrName in attrs.map){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue})}}for(i=0,l=attrs.length;i<l;i++){attrName=attrs[i].name;if(!(attrName in sortedAttrs.map)){attrValue=attrs.map[attrName];sortedAttrs.map[attrName]=attrValue;sortedAttrs.push({name:attrName,value:attrValue})}}attrs=sortedAttrs}writer.start(node.name,attrs,isEmpty);if(!isEmpty){if((node=node.firstChild)){do{walk(node)}while((node=node.next))}writer.end(name)}}else{handler(node)}}if(node.type==1&&!settings.inner){walk(node)}else{handlers[11](node)}return writer.getContent()}}});define("tinymce/dom/Serializer",["tinymce/dom/DOMUtils","tinymce/html/DomParser","tinymce/html/Entities","tinymce/html/Serializer","tinymce/html/Node","tinymce/html/Schema","tinymce/Env","tinymce/util/Tools"],function(DOMUtils,DomParser,Entities,Serializer,Node,Schema,Env,Tools){var each=Tools.each,trim=Tools.trim;var DOM=DOMUtils.DOM;return function(settings,editor){var dom,schema,htmlParser;if(editor){dom=editor.dom;schema=editor.schema}dom=dom||DOM;schema=schema||new Schema(settings);settings.entity_encoding=settings.entity_encoding||"named";settings.remove_trailing_brs="remove_trailing_brs" in settings?settings.remove_trailing_brs:true;htmlParser=new DomParser(settings,schema);htmlParser.addAttributeFilter("src,href,style",function(nodes,name){var i=nodes.length,node,value,internalName="data-mce-"+name;var urlConverter=settings.url_converter,urlConverterScope=settings.url_converter_scope,undef;while(i--){node=nodes[i];value=node.attributes.map[internalName];if(value!==undef){node.attr(name,value.length>0?value:null);node.attr(internalName,null)}else{value=node.attributes.map[name];if(name==="style"){value=dom.serializeStyle(dom.parseStyle(value),node.name)}else{if(urlConverter){value=urlConverter.call(urlConverterScope,value,name,node.name)}}node.attr(name,value.length>0?value:null)}}});htmlParser.addAttributeFilter("class",function(nodes){var i=nodes.length,node,value;while(i--){node=nodes[i];value=node.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g,"");node.attr("class",value.length>0?value:null)}});htmlParser.addAttributeFilter("data-mce-type",function(nodes,name,args){var i=nodes.length,node;while(i--){node=nodes[i];if(node.attributes.map["data-mce-type"]==="bookmark"&&!args.cleanup){node.remove()}}});htmlParser.addAttributeFilter("data-mce-expando",function(nodes,name){var i=nodes.length;while(i--){nodes[i].attr(name,null)}});htmlParser.addNodeFilter("noscript",function(nodes){var i=nodes.length,node;while(i--){node=nodes[i].firstChild;if(node){node.value=Entities.decode(node.value)}}});htmlParser.addNodeFilter("script,style",function(nodes,name){var i=nodes.length,node,value;function trim(value){return value.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")}while(i--){node=nodes[i];value=node.firstChild?node.firstChild.value:"";if(name==="script"){var type=(node.attr("type")||"text/javascript").replace(/^mce\-/,"");node.attr("type",type==="text/javascript"?null:type);if(value.length>0){node.firstChild.value="// <![CDATA[\n"+trim(value)+"\n// ]]>"}}else{if(value.length>0){node.firstChild.value="<!--\n"+trim(value)+"\n-->"}}}});htmlParser.addNodeFilter("#comment",function(nodes){var i=nodes.length,node;while(i--){node=nodes[i];if(node.value.indexOf("[CDATA[")===0){node.name="#cdata";node.type=4;node.value=node.value.replace(/^\[CDATA\[|\]\]$/g,"")}else{if(node.value.indexOf("mce:protected ")===0){node.name="#text";node.type=3;node.raw=true;node.value=unescape(node.value).substr(14)}}}});htmlParser.addNodeFilter("xml:namespace,input",function(nodes,name){var i=nodes.length,node;while(i--){node=nodes[i];if(node.type===7){node.remove()}else{if(node.type===1){if(name==="input"&&!("type" in node.attributes.map)){node.attr("type","text")}}}}});if(settings.fix_list_elements){htmlParser.addNodeFilter("ul,ol",function(nodes){var i=nodes.length,node,parentNode;while(i--){node=nodes[i];parentNode=node.parent;if(parentNode.name==="ul"||parentNode.name==="ol"){if(node.prev&&node.prev.name==="li"){node.prev.append(node)}}}})}htmlParser.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected",function(nodes,name){var i=nodes.length;while(i--){nodes[i].attr(name,null)}});return{schema:schema,addNodeFilter:htmlParser.addNodeFilter,addAttributeFilter:htmlParser.addAttributeFilter,serialize:function(node,args){var self=this,impl,doc,oldDoc,htmlSerializer,content;if(Env.ie&&dom.select("script,style,select,map").length>0){content=node.innerHTML;node=node.cloneNode(false);dom.setHTML(node,content)}else{node=node.cloneNode(true)}impl=node.ownerDocument.implementation;if(impl.createHTMLDocument){doc=impl.createHTMLDocument("");each(node.nodeName=="BODY"?node.childNodes:[node],function(node){doc.body.appendChild(doc.importNode(node,true))});if(node.nodeName!="BODY"){node=doc.body.firstChild}else{node=doc.body}oldDoc=dom.doc;dom.doc=doc}args=args||{};args.format=args.format||"html";if(args.selection){args.forced_root_block=""}if(!args.no_events){args.node=node;self.onPreProcess(args)}htmlSerializer=new Serializer(settings,schema);args.content=htmlSerializer.serialize(htmlParser.parse(trim(args.getInner?node.innerHTML:dom.getOuterHTML(node)),args));if(!args.cleanup){args.content=args.content.replace(/\uFEFF/g,"")}if(!args.no_events){self.onPostProcess(args)}if(oldDoc){dom.doc=oldDoc}args.node=null;return args.content},addRules:function(rules){schema.addValidElements(rules)},setRules:function(rules){schema.setValidElements(rules)},onPreProcess:function(args){if(editor){editor.fire("PreProcess",args)}},onPostProcess:function(args){if(editor){editor.fire("PostProcess",args)}}}}});define("tinymce/dom/TridentSelection",[],function(){function Selection(selection){var self=this,dom=selection.dom,FALSE=false;function getPosition(rng,start){var checkRng,startIndex=0,endIndex,inside,children,child,offset,index,position=-1,parent;checkRng=rng.duplicate();checkRng.collapse(start);parent=checkRng.parentElement();if(parent.ownerDocument!==selection.dom.doc){return}while(parent.contentEditable==="false"){parent=parent.parentNode}if(!parent.hasChildNodes()){return{node:parent,inside:1}}children=parent.children;endIndex=children.length-1;while(startIndex<=endIndex){index=Math.floor((startIndex+endIndex)/2);child=children[index];checkRng.moveToElementText(child);position=checkRng.compareEndPoints(start?"StartToStart":"EndToEnd",rng);if(position>0){endIndex=index-1}else{if(position<0){startIndex=index+1}else{return{node:child}}}}if(position<0){if(!child){checkRng.moveToElementText(parent);checkRng.collapse(true);child=parent;inside=true}else{checkRng.collapse(false)}offset=0;while(checkRng.compareEndPoints(start?"StartToStart":"StartToEnd",rng)!==0){if(checkRng.move("character",1)===0||parent!=checkRng.parentElement()){break}offset++}}else{checkRng.collapse(true);offset=0;while(checkRng.compareEndPoints(start?"StartToStart":"StartToEnd",rng)!==0){if(checkRng.move("character",-1)===0||parent!=checkRng.parentElement()){break}offset++}}return{node:child,position:position,offset:offset,inside:inside}}function getRange(){var ieRange=selection.getRng(),domRange=dom.createRng(),element,collapsed,tmpRange,element2,bookmark;element=ieRange.item?ieRange.item(0):ieRange.parentElement();if(element.ownerDocument!=dom.doc){return domRange}collapsed=selection.isCollapsed();if(ieRange.item){domRange.setStart(element.parentNode,dom.nodeIndex(element));domRange.setEnd(domRange.startContainer,domRange.startOffset+1);return domRange}function findEndPoint(start){var endPoint=getPosition(ieRange,start),container,offset,textNodeOffset=0,sibling,undef,nodeValue;container=endPoint.node;offset=endPoint.offset;if(endPoint.inside&&!container.hasChildNodes()){domRange[start?"setStart":"setEnd"](container,0);return}if(offset===undef){domRange[start?"setStartBefore":"setEndAfter"](container);return}if(endPoint.position<0){sibling=endPoint.inside?container.firstChild:container.nextSibling;if(!sibling){domRange[start?"setStartAfter":"setEndAfter"](container);return}if(!offset){if(sibling.nodeType==3){domRange[start?"setStart":"setEnd"](sibling,0)}else{domRange[start?"setStartBefore":"setEndBefore"](sibling)}return}while(sibling){nodeValue=sibling.nodeValue;textNodeOffset+=nodeValue.length;if(textNodeOffset>=offset){container=sibling;textNodeOffset-=offset;textNodeOffset=nodeValue.length-textNodeOffset;break}sibling=sibling.nextSibling}}else{sibling=container.previousSibling;if(!sibling){return domRange[start?"setStartBefore":"setEndBefore"](container)}if(!offset){if(container.nodeType==3){domRange[start?"setStart":"setEnd"](sibling,container.nodeValue.length)}else{domRange[start?"setStartAfter":"setEndAfter"](sibling)}return}while(sibling){textNodeOffset+=sibling.nodeValue.length;if(textNodeOffset>=offset){container=sibling;textNodeOffset-=offset;break}sibling=sibling.previousSibling}}domRange[start?"setStart":"setEnd"](container,textNodeOffset)}try{findEndPoint(true);if(!collapsed){findEndPoint()}}catch(ex){if(ex.number==-2147024809){bookmark=self.getBookmark(2);tmpRange=ieRange.duplicate();tmpRange.collapse(true);element=tmpRange.parentElement();if(!collapsed){tmpRange=ieRange.duplicate();tmpRange.collapse(false);element2=tmpRange.parentElement();element2.innerHTML=element2.innerHTML}element.innerHTML=element.innerHTML;self.moveToBookmark(bookmark);ieRange=selection.getRng();findEndPoint(true);if(!collapsed){findEndPoint()}}else{throw ex}}return domRange}this.getBookmark=function(type){var rng=selection.getRng(),bookmark={};function getIndexes(node){var parent,root,children,i,indexes=[];parent=node.parentNode;root=dom.getRoot().parentNode;while(parent!=root&&parent.nodeType!==9){children=parent.children;i=children.length;while(i--){if(node===children[i]){indexes.push(i);break}}node=parent;parent=parent.parentNode}return indexes}function getBookmarkEndPoint(start){var position;position=getPosition(rng,start);if(position){return{position:position.position,offset:position.offset,indexes:getIndexes(position.node),inside:position.inside}}}if(type===2){if(!rng.item){bookmark.start=getBookmarkEndPoint(true);if(!selection.isCollapsed()){bookmark.end=getBookmarkEndPoint()}}else{bookmark.start={ctrl:true,indexes:getIndexes(rng.item(0))}}}return bookmark};this.moveToBookmark=function(bookmark){var rng,body=dom.doc.body;function resolveIndexes(indexes){var node,i,idx,children;node=dom.getRoot();for(i=indexes.length-1;i>=0;i--){children=node.children;idx=indexes[i];if(idx<=children.length-1){node=children[idx]}}return node}function setBookmarkEndPoint(start){var endPoint=bookmark[start?"start":"end"],moveLeft,moveRng,undef,offset;if(endPoint){moveLeft=endPoint.position>0;moveRng=body.createTextRange();moveRng.moveToElementText(resolveIndexes(endPoint.indexes));offset=endPoint.offset;if(offset!==undef){moveRng.collapse(endPoint.inside||moveLeft);moveRng.moveStart("character",moveLeft?-offset:offset)}else{moveRng.collapse(start)}rng.setEndPoint(start?"StartToStart":"EndToStart",moveRng);if(start){rng.collapse(true)}}}if(bookmark.start){if(bookmark.start.ctrl){rng=body.createControlRange();rng.addElement(resolveIndexes(bookmark.start.indexes));rng.select()}else{rng=body.createTextRange();setBookmarkEndPoint(true);setBookmarkEndPoint();rng.select()}}};this.addRange=function(rng){var ieRng,ctrlRng,startContainer,startOffset,endContainer,endOffset,sibling,doc=selection.dom.doc,body=doc.body,nativeRng,ctrlElm;function setEndPoint(start){var container,offset,marker,tmpRng,nodes;marker=dom.create("a");container=start?startContainer:endContainer;offset=start?startOffset:endOffset;tmpRng=ieRng.duplicate();if(container==doc||container==doc.documentElement){container=body;offset=0}if(container.nodeType==3){container.parentNode.insertBefore(marker,container);tmpRng.moveToElementText(marker);tmpRng.moveStart("character",offset);dom.remove(marker);ieRng.setEndPoint(start?"StartToStart":"EndToEnd",tmpRng)}else{nodes=container.childNodes;if(nodes.length){if(offset>=nodes.length){dom.insertAfter(marker,nodes[nodes.length-1])}else{container.insertBefore(marker,nodes[offset])}tmpRng.moveToElementText(marker)}else{if(container.canHaveHTML){container.innerHTML="<span>&#xFEFF;</span>";marker=container.firstChild;tmpRng.moveToElementText(marker);tmpRng.collapse(FALSE)}}ieRng.setEndPoint(start?"StartToStart":"EndToEnd",tmpRng);dom.remove(marker)}}startContainer=rng.startContainer;startOffset=rng.startOffset;endContainer=rng.endContainer;endOffset=rng.endOffset;ieRng=body.createTextRange();if(startContainer==endContainer&&startContainer.nodeType==1){if(startOffset==endOffset&&!startContainer.hasChildNodes()){if(startContainer.canHaveHTML){sibling=startContainer.previousSibling;if(sibling&&!sibling.hasChildNodes()&&dom.isBlock(sibling)){sibling.innerHTML="&#xFEFF;"}else{sibling=null}startContainer.innerHTML="<span>&#xFEFF;</span><span>&#xFEFF;</span>";ieRng.moveToElementText(startContainer.lastChild);ieRng.select();dom.doc.selection.clear();startContainer.innerHTML="";if(sibling){sibling.innerHTML=""}return}else{startOffset=dom.nodeIndex(startContainer);startContainer=startContainer.parentNode}}if(startOffset==endOffset-1){try{ctrlElm=startContainer.childNodes[startOffset];ctrlRng=body.createControlRange();ctrlRng.addElement(ctrlElm);ctrlRng.select();nativeRng=selection.getRng();if(nativeRng.item&&ctrlElm===nativeRng.item(0)){return}}catch(ex){}}}setEndPoint(true);setEndPoint();ieRng.select()};this.getRangeAt=getRange}return Selection});define("tinymce/util/VK",["tinymce/Env"],function(Env){return{BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(e){return e.shiftKey||e.ctrlKey||e.altKey},metaKeyPressed:function(e){return(Env.mac?e.metaKey:e.ctrlKey)&&!e.altKey}}});define("tinymce/dom/ControlSelection",["tinymce/util/VK","tinymce/util/Tools","tinymce/Env"],function(VK,Tools,Env){return function(selection,editor){var dom=editor.dom,each=Tools.each;var selectedElm,selectedElmGhost,resizeHandles,selectedHandle,lastMouseDownEvent;var startX,startY,selectedElmX,selectedElmY,startW,startH,ratio,resizeStarted;var width,height,editableDoc=editor.getDoc(),rootDocument=document,isIE=Env.ie&&Env.ie<11;resizeHandles={n:[0.5,0,0,-1],e:[1,0.5,1,0],s:[0.5,1,0,1],w:[0,0.5,-1,0],nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]};var rootClass=".mce-content-body";editor.contentStyles.push(rootClass+" div.mce-resizehandle {position: absolute;border: 1px solid black;background: #FFF;width: 5px;height: 5px;z-index: 10000}"+rootClass+" .mce-resizehandle:hover {background: #000}"+rootClass+" img[data-mce-selected], hr[data-mce-selected] {outline: 1px solid black;resize: none}"+rootClass+" .mce-clonedresizable {position: absolute;"+(Env.gecko?"":"outline: 1px dashed black;")+"opacity: .5;filter: alpha(opacity=50);z-index: 10000}");function isResizable(elm){if(editor.settings.object_resizing===false){return false}if(!/TABLE|IMG|DIV/.test(elm.nodeName)){return false}if(elm.getAttribute("data-mce-resize")==="false"){return false}return true}function resizeGhostElement(e){var deltaX,deltaY;deltaX=e.screenX-startX;deltaY=e.screenY-startY;width=deltaX*selectedHandle[2]+startW;height=deltaY*selectedHandle[3]+startH;width=width<5?5:width;height=height<5?5:height;if(VK.modifierPressed(e)||(selectedElm.nodeName=="IMG"&&selectedHandle[2]*selectedHandle[3]!==0)){width=Math.round(height/ratio);height=Math.round(width*ratio)}dom.setStyles(selectedElmGhost,{width:width,height:height});if(selectedHandle[2]<0&&selectedElmGhost.clientWidth<=width){dom.setStyle(selectedElmGhost,"left",selectedElmX+(startW-width))}if(selectedHandle[3]<0&&selectedElmGhost.clientHeight<=height){dom.setStyle(selectedElmGhost,"top",selectedElmY+(startH-height))}if(!resizeStarted){editor.fire("ObjectResizeStart",{target:selectedElm,width:startW,height:startH});resizeStarted=true}}function endGhostResize(){resizeStarted=false;function setSizeProp(name,value){if(value){if(selectedElm.style[name]||!editor.schema.isValid(selectedElm.nodeName.toLowerCase(),name)){dom.setStyle(selectedElm,name,value)}else{dom.setAttrib(selectedElm,name,value)}}}setSizeProp("width",width);setSizeProp("height",height);dom.unbind(editableDoc,"mousemove",resizeGhostElement);dom.unbind(editableDoc,"mouseup",endGhostResize);if(rootDocument!=editableDoc){dom.unbind(rootDocument,"mousemove",resizeGhostElement);dom.unbind(rootDocument,"mouseup",endGhostResize)}dom.remove(selectedElmGhost);if(!isIE||selectedElm.nodeName=="TABLE"){showResizeRect(selectedElm)}editor.fire("ObjectResized",{target:selectedElm,width:width,height:height});editor.nodeChanged()}function showResizeRect(targetElm,mouseDownHandleName,mouseDownEvent){var position,targetWidth,targetHeight,e,rect,offsetParent=editor.getBody();position=dom.getPos(targetElm,offsetParent);selectedElmX=position.x;selectedElmY=position.y;rect=targetElm.getBoundingClientRect();targetWidth=rect.width||(rect.right-rect.left);targetHeight=rect.height||(rect.bottom-rect.top);if(selectedElm!=targetElm){detachResizeStartListener();selectedElm=targetElm;width=height=0}e=editor.fire("ObjectSelected",{target:targetElm});if(isResizable(targetElm)&&!e.isDefaultPrevented()){each(resizeHandles,function(handle,name){var handleElm,handlerContainerElm;function startDrag(e){resizeStarted=true;startX=e.screenX;startY=e.screenY;startW=selectedElm.clientWidth;startH=selectedElm.clientHeight;ratio=startH/startW;selectedHandle=handle;selectedElmGhost=selectedElm.cloneNode(true);dom.addClass(selectedElmGhost,"mce-clonedresizable");selectedElmGhost.contentEditable=false;selectedElmGhost.unSelectabe=true;dom.setStyles(selectedElmGhost,{left:selectedElmX,top:selectedElmY,margin:0});selectedElmGhost.removeAttribute("data-mce-selected");editor.getBody().appendChild(selectedElmGhost);dom.bind(editableDoc,"mousemove",resizeGhostElement);dom.bind(editableDoc,"mouseup",endGhostResize);if(rootDocument!=editableDoc){dom.bind(rootDocument,"mousemove",resizeGhostElement);dom.bind(rootDocument,"mouseup",endGhostResize)}}if(mouseDownHandleName){if(name==mouseDownHandleName){startDrag(mouseDownEvent)}return}handleElm=dom.get("mceResizeHandle"+name);if(!handleElm){handlerContainerElm=editor.getBody();handleElm=dom.add(handlerContainerElm,"div",{id:"mceResizeHandle"+name,"data-mce-bogus":true,"class":"mce-resizehandle",contentEditable:false,unSelectabe:true,style:"cursor:"+name+"-resize; margin:0; padding:0"});dom.bind(handleElm,"mousedown",function(e){e.preventDefault();startDrag(e)})}else{dom.show(handleElm)}dom.setStyles(handleElm,{left:(targetWidth*handle[0]+selectedElmX)-(handleElm.offsetWidth/2),top:(targetHeight*handle[1]+selectedElmY)-(handleElm.offsetHeight/2)})})}else{hideResizeRect()}selectedElm.setAttribute("data-mce-selected","1")}function hideResizeRect(){var name,handleElm;if(selectedElm){selectedElm.removeAttribute("data-mce-selected")}for(name in resizeHandles){handleElm=dom.get("mceResizeHandle"+name);if(handleElm){dom.unbind(handleElm);dom.remove(handleElm)}}}function updateResizeRect(e){var controlElm;function isChildOrEqual(node,parent){do{if(node===parent){return true}}while((node=node.parentNode))}each(dom.select("img[data-mce-selected],hr[data-mce-selected]"),function(img){img.removeAttribute("data-mce-selected")});controlElm=e.type=="mousedown"?e.target:selection.getNode();controlElm=dom.getParent(controlElm,isIE?"table":"table,img,hr");if(controlElm){disableGeckoResize();if(isChildOrEqual(selection.getStart(),controlElm)&&isChildOrEqual(selection.getEnd(),controlElm)){if(!isIE||(controlElm!=selection.getStart()&&selection.getStart().nodeName!=="IMG")){showResizeRect(controlElm);return}}}hideResizeRect()}function attachEvent(elm,name,func){if(elm&&elm.attachEvent){elm.attachEvent("on"+name,func)}}function detachEvent(elm,name,func){if(elm&&elm.detachEvent){elm.detachEvent("on"+name,func)}}function resizeNativeStart(e){var target=e.srcElement,pos,name,corner,cornerX,cornerY,relativeX,relativeY;pos=target.getBoundingClientRect();relativeX=lastMouseDownEvent.clientX-pos.left;relativeY=lastMouseDownEvent.clientY-pos.top;for(name in resizeHandles){corner=resizeHandles[name];cornerX=target.offsetWidth*corner[0];cornerY=target.offsetHeight*corner[1];if(Math.abs(cornerX-relativeX)<8&&Math.abs(cornerY-relativeY)<8){selectedHandle=corner;break}}resizeStarted=true;editor.getDoc().selection.empty();showResizeRect(target,name,lastMouseDownEvent)}function nativeControlSelect(e){var target=e.srcElement;if(target!=selectedElm){detachResizeStartListener();if(target.id.indexOf("mceResizeHandle")===0){e.returnValue=false;return}if(target.nodeName=="IMG"||target.nodeName=="TABLE"){hideResizeRect();selectedElm=target;attachEvent(target,"resizestart",resizeNativeStart)}}}function detachResizeStartListener(){detachEvent(selectedElm,"resizestart",resizeNativeStart)}function disableGeckoResize(){try{editor.getDoc().execCommand("enableObjectResizing",false,false)}catch(ex){}}function controlSelect(elm){var ctrlRng;if(!isIE){return}ctrlRng=editableDoc.body.createControlRange();try{ctrlRng.addElement(elm);ctrlRng.select();return true}catch(ex){}}editor.on("init",function(){if(isIE){editor.on("ObjectResized",function(e){if(e.target.nodeName!="TABLE"){hideResizeRect();controlSelect(e.target)}});attachEvent(editor.getBody(),"controlselect",nativeControlSelect);editor.on("mousedown",function(e){lastMouseDownEvent=e})}else{disableGeckoResize();if(Env.ie>=11){editor.on("mouseup",function(e){var nodeName=e.target.nodeName;if(/^(TABLE|IMG|HR)$/.test(nodeName)){editor.selection.select(e.target,nodeName=="TABLE");editor.nodeChanged()}});editor.dom.bind(editor.getBody(),"mscontrolselect",function(e){if(/^(TABLE|IMG|HR)$/.test(e.target.nodeName)){e.preventDefault()}})}}editor.on("nodechange mousedown mouseup ResizeEditor",updateResizeRect);editor.on("keydown keyup",function(e){if(selectedElm&&selectedElm.nodeName=="TABLE"){updateResizeRect(e)}})});function destroy(){selectedElm=selectedElmGhost=null;if(isIE){detachResizeStartListener();detachEvent(editor.getBody(),"controlselect",nativeControlSelect)}}return{controlSelect:controlSelect,destroy:destroy}}});define("tinymce/dom/Selection",["tinymce/dom/TreeWalker","tinymce/dom/TridentSelection","tinymce/dom/ControlSelection","tinymce/Env","tinymce/util/Tools"],function(TreeWalker,TridentSelection,ControlSelection,Env,Tools){var each=Tools.each,grep=Tools.grep,trim=Tools.trim;var isIE=Env.ie,isOpera=Env.opera;function Selection(dom,win,serializer,editor){var self=this;self.dom=dom;self.win=win;self.serializer=serializer;self.editor=editor;self.controlSelection=new ControlSelection(self,editor);if(!self.win.getSelection){self.tridentSel=new TridentSelection(self)}}Selection.prototype={setCursorLocation:function(node,offset){var self=this,rng=self.dom.createRng();if(!node){self._moveEndPoint(rng,self.editor.getBody(),true);self.setRng(rng)}else{rng.setStart(node,offset);rng.setEnd(node,offset);self.setRng(rng);self.collapse(false)}},getContent:function(args){var self=this,rng=self.getRng(),tmpElm=self.dom.create("body");var se=self.getSel(),whiteSpaceBefore,whiteSpaceAfter,fragment;args=args||{};whiteSpaceBefore=whiteSpaceAfter="";args.get=true;args.format=args.format||"html";args.selection=true;self.editor.fire("BeforeGetContent",args);if(args.format=="text"){return self.isCollapsed()?"":(rng.text||(se.toString?se.toString():""))}if(rng.cloneContents){fragment=rng.cloneContents();if(fragment){tmpElm.appendChild(fragment)}}else{if(rng.item!==undefined||rng.htmlText!==undefined){tmpElm.innerHTML="<br>"+(rng.item?rng.item(0).outerHTML:rng.htmlText);tmpElm.removeChild(tmpElm.firstChild)}else{tmpElm.innerHTML=rng.toString()}}if(/^\s/.test(tmpElm.innerHTML)){whiteSpaceBefore=" "}if(/\s+$/.test(tmpElm.innerHTML)){whiteSpaceAfter=" "}args.getInner=true;args.content=self.isCollapsed()?"":whiteSpaceBefore+self.serializer.serialize(tmpElm,args)+whiteSpaceAfter;self.editor.fire("GetContent",args);return args.content},setContent:function(content,args){var self=this,rng=self.getRng(),caretNode,doc=self.win.document,frag,temp;args=args||{format:"html"};args.set=true;args.selection=true;content=args.content=content;if(!args.no_events){self.editor.fire("BeforeSetContent",args)}content=args.content;if(rng.insertNode){content+='<span id="__caret">_</span>';if(rng.startContainer==doc&&rng.endContainer==doc){doc.body.innerHTML=content}else{rng.deleteContents();if(doc.body.childNodes.length===0){doc.body.innerHTML=content}else{if(rng.createContextualFragment){rng.insertNode(rng.createContextualFragment(content))}else{frag=doc.createDocumentFragment();temp=doc.createElement("div");frag.appendChild(temp);temp.outerHTML=content;rng.insertNode(frag)}}}caretNode=self.dom.get("__caret");rng=doc.createRange();rng.setStartBefore(caretNode);rng.setEndBefore(caretNode);self.setRng(rng);self.dom.remove("__caret");try{self.setRng(rng)}catch(ex){}}else{if(rng.item){doc.execCommand("Delete",false,null);rng=self.getRng()}if(/^\s+/.test(content)){rng.pasteHTML('<span id="__mce_tmp">_</span>'+content);self.dom.remove("__mce_tmp")}else{rng.pasteHTML(content)}}if(!args.no_events){self.editor.fire("SetContent",args)}},getStart:function(){var self=this,rng=self.getRng(),startElement,parentElement,checkRng,node;if(rng.duplicate||rng.item){if(rng.item){return rng.item(0)}checkRng=rng.duplicate();checkRng.collapse(1);startElement=checkRng.parentElement();if(startElement.ownerDocument!==self.dom.doc){startElement=self.dom.getRoot()}parentElement=node=rng.parentElement();while((node=node.parentNode)){if(node==startElement){startElement=parentElement;break}}return startElement}else{startElement=rng.startContainer;if(startElement.nodeType==1&&startElement.hasChildNodes()){startElement=startElement.childNodes[Math.min(startElement.childNodes.length-1,rng.startOffset)]}if(startElement&&startElement.nodeType==3){return startElement.parentNode}return startElement}},getEnd:function(){var self=this,rng=self.getRng(),endElement,endOffset;if(rng.duplicate||rng.item){if(rng.item){return rng.item(0)}rng=rng.duplicate();rng.collapse(0);endElement=rng.parentElement();if(endElement.ownerDocument!==self.dom.doc){endElement=self.dom.getRoot()}if(endElement&&endElement.nodeName=="BODY"){return endElement.lastChild||endElement}return endElement}else{endElement=rng.endContainer;endOffset=rng.endOffset;if(endElement.nodeType==1&&endElement.hasChildNodes()){endElement=endElement.childNodes[endOffset>0?endOffset-1:endOffset]}if(endElement&&endElement.nodeType==3){return endElement.parentNode}return endElement}},getBookmark:function(type,normalized){var t=this,dom=t.dom,rng,rng2,id,collapsed,name,element,chr="&#xFEFF;",styles;function findIndex(name,element){var index=0;each(dom.select(name),function(node,i){if(node==element){index=i}});return index}function normalizeTableCellSelection(rng){function moveEndPoint(start){var container,offset,childNodes,prefix=start?"start":"end";container=rng[prefix+"Container"];offset=rng[prefix+"Offset"];if(container.nodeType==1&&container.nodeName=="TR"){childNodes=container.childNodes;container=childNodes[Math.min(start?offset:offset-1,childNodes.length-1)];if(container){offset=start?0:container.childNodes.length;rng["set"+(start?"Start":"End")](container,offset)}}}moveEndPoint(true);moveEndPoint();return rng}function getLocation(){var rng=t.getRng(true),root=dom.getRoot(),bookmark={};function getPoint(rng,start){var container=rng[start?"startContainer":"endContainer"],offset=rng[start?"startOffset":"endOffset"],point=[],node,childNodes,after=0;if(container.nodeType==3){if(normalized){for(node=container.previousSibling;node&&node.nodeType==3;node=node.previousSibling){offset+=node.nodeValue.length}}point.push(offset)}else{childNodes=container.childNodes;if(offset>=childNodes.length&&childNodes.length){after=1;offset=Math.max(0,childNodes.length-1)}point.push(t.dom.nodeIndex(childNodes[offset],normalized)+after)}for(;container&&container!=root;container=container.parentNode){point.push(t.dom.nodeIndex(container,normalized))}return point}bookmark.start=getPoint(rng,true);if(!t.isCollapsed()){bookmark.end=getPoint(rng)}return bookmark}if(type==2){element=t.getNode();name=element.nodeName;if(name=="IMG"){return{name:name,index:findIndex(name,element)}}if(t.tridentSel){return t.tridentSel.getBookmark(type)}return getLocation()}if(type){return{rng:t.getRng()}}rng=t.getRng();id=dom.uniqueId();collapsed=t.isCollapsed();styles="overflow:hidden;line-height:0px";if(rng.duplicate||rng.item){if(!rng.item){rng2=rng.duplicate();try{rng.collapse();rng.pasteHTML('<span data-mce-type="bookmark" id="'+id+'_start" style="'+styles+'">'+chr+"</span>");if(!collapsed){rng2.collapse(false);rng.moveToElementText(rng2.parentElement());if(rng.compareEndPoints("StartToEnd",rng2)===0){rng2.move("character",-1)}rng2.pasteHTML('<span data-mce-type="bookmark" id="'+id+'_end" style="'+styles+'">'+chr+"</span>")}}catch(ex){return null}}else{element=rng.item(0);name=element.nodeName;return{name:name,index:findIndex(name,element)}}}else{element=t.getNode();name=element.nodeName;if(name=="IMG"){return{name:name,index:findIndex(name,element)}}rng2=normalizeTableCellSelection(rng.cloneRange());if(!collapsed){rng2.collapse(false);rng2.insertNode(dom.create("span",{"data-mce-type":"bookmark",id:id+"_end",style:styles},chr))}rng=normalizeTableCellSelection(rng);rng.collapse(true);rng.insertNode(dom.create("span",{"data-mce-type":"bookmark",id:id+"_start",style:styles},chr))}t.moveToBookmark({id:id,keep:1});return{id:id}},moveToBookmark:function(bookmark){var t=this,dom=t.dom,rng,root,startContainer,endContainer,startOffset,endOffset;function setEndPoint(start){var point=bookmark[start?"start":"end"],i,node,offset,children;if(point){offset=point[0];for(node=root,i=point.length-1;i>=1;i--){children=node.childNodes;if(point[i]>children.length-1){return}node=children[point[i]]}if(node.nodeType===3){offset=Math.min(point[0],node.nodeValue.length)}if(node.nodeType===1){offset=Math.min(point[0],node.childNodes.length)}if(start){rng.setStart(node,offset)}else{rng.setEnd(node,offset)}}return true}function restoreEndPoint(suffix){var marker=dom.get(bookmark.id+"_"+suffix),node,idx,next,prev,keep=bookmark.keep;if(marker){node=marker.parentNode;if(suffix=="start"){if(!keep){idx=dom.nodeIndex(marker)}else{node=marker.firstChild;idx=1}startContainer=endContainer=node;startOffset=endOffset=idx}else{if(!keep){idx=dom.nodeIndex(marker)}else{node=marker.firstChild;idx=1}endContainer=node;endOffset=idx}if(!keep){prev=marker.previousSibling;next=marker.nextSibling;each(grep(marker.childNodes),function(node){if(node.nodeType==3){node.nodeValue=node.nodeValue.replace(/\uFEFF/g,"")}});while((marker=dom.get(bookmark.id+"_"+suffix))){dom.remove(marker,1)}if(prev&&next&&prev.nodeType==next.nodeType&&prev.nodeType==3&&!isOpera){idx=prev.nodeValue.length;prev.appendData(next.nodeValue);dom.remove(next);if(suffix=="start"){startContainer=endContainer=prev;startOffset=endOffset=idx}else{endContainer=prev;endOffset=idx}}}}}function addBogus(node){if(dom.isBlock(node)&&!node.innerHTML&&!isIE){node.innerHTML='<br data-mce-bogus="1" />'}return node}if(bookmark){if(bookmark.start){rng=dom.createRng();root=dom.getRoot();if(t.tridentSel){return t.tridentSel.moveToBookmark(bookmark)}if(setEndPoint(true)&&setEndPoint()){t.setRng(rng)}}else{if(bookmark.id){restoreEndPoint("start");restoreEndPoint("end");if(startContainer){rng=dom.createRng();rng.setStart(addBogus(startContainer),startOffset);rng.setEnd(addBogus(endContainer),endOffset);t.setRng(rng)}}else{if(bookmark.name){t.select(dom.select(bookmark.name)[bookmark.index])}else{if(bookmark.rng){t.setRng(bookmark.rng)}}}}}},select:function(node,content){var self=this,dom=self.dom,rng=dom.createRng(),idx;self.lastFocusBookmark=null;if(node){if(!content&&self.controlSelection.controlSelect(node)){return}idx=dom.nodeIndex(node);rng.setStart(node.parentNode,idx);rng.setEnd(node.parentNode,idx+1);if(content){self._moveEndPoint(rng,node,true);self._moveEndPoint(rng,node)}self.setRng(rng)}return node},isCollapsed:function(){var self=this,rng=self.getRng(),sel=self.getSel();if(!rng||rng.item){return false}if(rng.compareEndPoints){return rng.compareEndPoints("StartToEnd",rng)===0}return !sel||rng.collapsed},collapse:function(to_start){var self=this,rng=self.getRng(),node;if(rng.item){node=rng.item(0);rng=self.win.document.body.createTextRange();rng.moveToElementText(node)}rng.collapse(!!to_start);self.setRng(rng)},getSel:function(){var win=this.win;return win.getSelection?win.getSelection():win.document.selection},getRng:function(w3c){var self=this,selection,rng,elm,doc=self.win.document,ieRng;if(!w3c&&self.lastFocusBookmark){var bookmark=self.lastFocusBookmark;if(bookmark.startContainer){rng=doc.createRange();rng.setStart(bookmark.startContainer,bookmark.startOffset);rng.setEnd(bookmark.endContainer,bookmark.endOffset)}else{rng=bookmark}return rng}if(w3c&&self.tridentSel){return self.tridentSel.getRangeAt(0)}try{if((selection=self.getSel())){if(selection.rangeCount>0){rng=selection.getRangeAt(0)}else{rng=selection.createRange?selection.createRange():doc.createRange()}}}catch(ex){}if(isIE&&rng&&rng.setStart){try{ieRng=doc.selection.createRange()}catch(ex){}if(ieRng&&ieRng.item){elm=ieRng.item(0);rng=doc.createRange();rng.setStartBefore(elm);rng.setEndAfter(elm)}}if(!rng){rng=doc.createRange?doc.createRange():doc.body.createTextRange()}if(rng.setStart&&rng.startContainer.nodeType===9&&rng.collapsed){elm=self.dom.getRoot();rng.setStart(elm,0);rng.setEnd(elm,0)}if(self.selectedRange&&self.explicitRange){if(rng.compareBoundaryPoints(rng.START_TO_START,self.selectedRange)===0&&rng.compareBoundaryPoints(rng.END_TO_END,self.selectedRange)===0){rng=self.explicitRange}else{self.selectedRange=null;self.explicitRange=null}}return rng},setRng:function(rng,forward){var self=this,sel;if(rng.select){try{rng.select()}catch(ex){}return}if(!self.tridentSel){sel=self.getSel();if(sel){self.explicitRange=rng;try{sel.removeAllRanges();sel.addRange(rng)}catch(ex){}if(forward===false&&sel.extend){sel.collapse(rng.endContainer,rng.endOffset);sel.extend(rng.startContainer,rng.startOffset)}self.selectedRange=sel.rangeCount>0?sel.getRangeAt(0):null}}else{if(rng.cloneRange){try{self.tridentSel.addRange(rng);return}catch(ex){}}}},setNode:function(elm){var self=this;self.setContent(self.dom.getOuterHTML(elm));return elm},getNode:function(){var self=this,rng=self.getRng(),elm;var startContainer=rng.startContainer,endContainer=rng.endContainer;var startOffset=rng.startOffset,endOffset=rng.endOffset,root=self.dom.getRoot();function skipEmptyTextNodes(node,forwards){var orig=node;while(node&&node.nodeType===3&&node.length===0){node=forwards?node.nextSibling:node.previousSibling}return node||orig}if(!rng){return root}if(rng.setStart){elm=rng.commonAncestorContainer;if(!rng.collapsed){if(startContainer==endContainer){if(endOffset-startOffset<2){if(startContainer.hasChildNodes()){elm=startContainer.childNodes[startOffset]}}}if(startContainer.nodeType===3&&endContainer.nodeType===3){if(startContainer.length===startOffset){startContainer=skipEmptyTextNodes(startContainer.nextSibling,true)}else{startContainer=startContainer.parentNode}if(endOffset===0){endContainer=skipEmptyTextNodes(endContainer.previousSibling,false)}else{endContainer=endContainer.parentNode}if(startContainer&&startContainer===endContainer){return startContainer}}}if(elm&&elm.nodeType==3){return elm.parentNode}return elm}elm=rng.item?rng.item(0):rng.parentElement();if(elm.ownerDocument!==self.win.document){elm=root}return elm},getSelectedBlocks:function(startElm,endElm){var self=this,dom=self.dom,node,root,selectedBlocks=[];root=dom.getRoot();startElm=dom.getParent(startElm||self.getStart(),dom.isBlock);endElm=dom.getParent(endElm||self.getEnd(),dom.isBlock);if(startElm&&startElm!=root){selectedBlocks.push(startElm)}if(startElm&&endElm&&startElm!=endElm){node=startElm;var walker=new TreeWalker(startElm,root);while((node=walker.next())&&node!=endElm){if(dom.isBlock(node)){selectedBlocks.push(node)}}}if(endElm&&startElm!=endElm&&endElm!=root){selectedBlocks.push(endElm)}return selectedBlocks},isForward:function(){var dom=this.dom,sel=this.getSel(),anchorRange,focusRange;if(!sel||!sel.anchorNode||!sel.focusNode){return true}anchorRange=dom.createRng();anchorRange.setStart(sel.anchorNode,sel.anchorOffset);anchorRange.collapse(true);focusRange=dom.createRng();focusRange.setStart(sel.focusNode,sel.focusOffset);focusRange.collapse(true);return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START,focusRange)<=0},normalize:function(){var self=this,rng,normalized,collapsed;function normalizeEndPoint(start){var container,offset,walker,dom=self.dom,body=dom.getRoot(),node,nonEmptyElementsMap,nodeName;function hasBrBeforeAfter(node,left){var walker=new TreeWalker(node,dom.getParent(node.parentNode,dom.isBlock)||body);while((node=walker[left?"prev":"next"]())){if(node.nodeName==="BR"){return true}}}function isPrevNode(node,name){return node.previousSibling&&node.previousSibling.nodeName==name}function findTextNodeRelative(left,startNode){var walker,lastInlineElement;startNode=startNode||container;walker=new TreeWalker(startNode,dom.getParent(startNode.parentNode,dom.isBlock)||body);while((node=walker[left?"prev":"next"]())){if(node.nodeType===3&&node.nodeValue.length>0){container=node;offset=left?node.nodeValue.length:0;normalized=true;return}if(dom.isBlock(node)||nonEmptyElementsMap[node.nodeName.toLowerCase()]){return}lastInlineElement=node}if(collapsed&&lastInlineElement){container=lastInlineElement;normalized=true;offset=0}}container=rng[(start?"start":"end")+"Container"];offset=rng[(start?"start":"end")+"Offset"];nonEmptyElementsMap=dom.schema.getNonEmptyElements();if(container.nodeType===9){container=dom.getRoot();offset=0}if(container===body){if(start){node=container.childNodes[offset>0?offset-1:0];if(node){nodeName=node.nodeName.toLowerCase();if(nonEmptyElementsMap[node.nodeName]||node.nodeName=="TABLE"){return}}}if(container.hasChildNodes()){offset=Math.min(!start&&offset>0?offset-1:offset,container.childNodes.length-1);container=container.childNodes[offset];offset=0;if(container.hasChildNodes()&&!/TABLE/.test(container.nodeName)){node=container;walker=new TreeWalker(container,body);do{if(node.nodeType===3&&node.nodeValue.length>0){offset=start?0:node.nodeValue.length;container=node;normalized=true;break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]){offset=dom.nodeIndex(node);container=node.parentNode;if(node.nodeName=="IMG"&&!start){offset++}normalized=true;break}}while((node=(start?walker.next():walker.prev())))}}}if(collapsed){if(container.nodeType===3&&offset===0){findTextNodeRelative(true)}if(container.nodeType===1){node=container.childNodes[offset];if(node&&node.nodeName==="BR"&&!isPrevNode(node,"A")&&!hasBrBeforeAfter(node)&&!hasBrBeforeAfter(node,true)){findTextNodeRelative(true,container.childNodes[offset])}}}if(start&&!collapsed&&container.nodeType===3&&offset===container.nodeValue.length){findTextNodeRelative(false)}if(normalized){rng["set"+(start?"Start":"End")](container,offset)}}if(isIE){return}rng=self.getRng();collapsed=rng.collapsed;normalizeEndPoint(true);if(!collapsed){normalizeEndPoint()}if(normalized){if(collapsed){rng.collapse(true)}self.setRng(rng,self.isForward())}},selectorChanged:function(selector,callback){var self=this,currentSelectors;if(!self.selectorChangedData){self.selectorChangedData={};currentSelectors={};self.editor.on("NodeChange",function(e){var node=e.element,dom=self.dom,parents=dom.getParents(node,null,dom.getRoot()),matchedSelectors={};each(self.selectorChangedData,function(callbacks,selector){each(parents,function(node){if(dom.is(node,selector)){if(!currentSelectors[selector]){each(callbacks,function(callback){callback(true,{node:node,selector:selector,parents:parents})});currentSelectors[selector]=callbacks}matchedSelectors[selector]=callbacks;return false}})});each(currentSelectors,function(callbacks,selector){if(!matchedSelectors[selector]){delete currentSelectors[selector];each(callbacks,function(callback){callback(false,{node:node,selector:selector,parents:parents})})}})})}if(!self.selectorChangedData[selector]){self.selectorChangedData[selector]=[]}self.selectorChangedData[selector].push(callback);return self},getScrollContainer:function(){var scrollContainer,node=this.dom.getRoot();while(node&&node.nodeName!="BODY"){if(node.scrollHeight>node.clientHeight){scrollContainer=node;break}node=node.parentNode}return scrollContainer},scrollIntoView:function(elm){var y,viewPort,self=this,dom=self.dom,root=dom.getRoot(),viewPortY,viewPortH;function getPos(elm){var x=0,y=0;var offsetParent=elm;while(offsetParent&&offsetParent.nodeType){x+=offsetParent.offsetLeft||0;y+=offsetParent.offsetTop||0;offsetParent=offsetParent.offsetParent}return{x:x,y:y}}if(root.nodeName!="BODY"){var scrollContainer=self.getScrollContainer();if(scrollContainer){y=getPos(elm).y-getPos(scrollContainer).y;viewPortH=scrollContainer.clientHeight;viewPortY=scrollContainer.scrollTop;if(y<viewPortY||y+25>viewPortY+viewPortH){scrollContainer.scrollTop=y<viewPortY?y:y-viewPortH+25}return}}viewPort=dom.getViewPort(self.editor.getWin());y=dom.getPos(elm).y;viewPortY=viewPort.y;viewPortH=viewPort.h;if(y<viewPort.y||y+25>viewPortY+viewPortH){self.editor.getWin().scrollTo(0,y<viewPortY?y:y-viewPortH+25)}},_moveEndPoint:function(rng,node,start){var root=node,walker=new TreeWalker(node,root);var nonEmptyElementsMap=this.dom.schema.getNonEmptyElements();do{if(node.nodeType==3&&trim(node.nodeValue).length!==0){if(start){rng.setStart(node,0)}else{rng.setEnd(node,node.nodeValue.length)}return}if(nonEmptyElementsMap[node.nodeName]){if(start){rng.setStartBefore(node)}else{if(node.nodeName=="BR"){rng.setEndBefore(node)}else{rng.setEndAfter(node)}}return}if(Env.ie&&Env.ie<11&&this.dom.isBlock(node)&&this.dom.isEmpty(node)){if(start){rng.setStart(node,0)}else{rng.setEnd(node,0)}return}}while((node=(start?walker.next():walker.prev())));if(root.nodeName=="BODY"){if(start){rng.setStart(root,0)}else{rng.setEnd(root,root.childNodes.length)}}},destroy:function(){this.win=null;this.controlSelection.destroy()}};return Selection});define("tinymce/dom/RangeUtils",["tinymce/util/Tools"],function(Tools){var each=Tools.each;function RangeUtils(dom){this.walk=function(rng,callback){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset,ancestor,startPoint,endPoint,node,parent,siblings,nodes;nodes=dom.select("td.mce-item-selected,th.mce-item-selected");if(nodes.length>0){each(nodes,function(node){callback([node])});return}function exclude(nodes){var node;node=nodes[0];if(node.nodeType===3&&node===startContainer&&startOffset>=node.nodeValue.length){nodes.splice(0,1)}node=nodes[nodes.length-1];if(endOffset===0&&nodes.length>0&&node===endContainer&&node.nodeType===3){nodes.splice(nodes.length-1,1)}return nodes}function collectSiblings(node,name,end_node){var siblings=[];for(;node&&node!=end_node;node=node[name]){siblings.push(node)}return siblings}function findEndPoint(node,root){do{if(node.parentNode==root){return node}node=node.parentNode}while(node)}function walkBoundary(start_node,end_node,next){var siblingName=next?"nextSibling":"previousSibling";for(node=start_node,parent=node.parentNode;node&&node!=end_node;node=parent){parent=node.parentNode;siblings=collectSiblings(node==start_node?node:node[siblingName],siblingName);if(siblings.length){if(!next){siblings.reverse()}callback(exclude(siblings))}}}if(startContainer.nodeType==1&&startContainer.hasChildNodes()){startContainer=startContainer.childNodes[startOffset]}if(endContainer.nodeType==1&&endContainer.hasChildNodes()){endContainer=endContainer.childNodes[Math.min(endOffset-1,endContainer.childNodes.length-1)]}if(startContainer==endContainer){return callback(exclude([startContainer]))}ancestor=dom.findCommonAncestor(startContainer,endContainer);for(node=startContainer;node;node=node.parentNode){if(node===endContainer){return walkBoundary(startContainer,ancestor,true)}if(node===ancestor){break}}for(node=endContainer;node;node=node.parentNode){if(node===startContainer){return walkBoundary(endContainer,ancestor)}if(node===ancestor){break}}startPoint=findEndPoint(startContainer,ancestor)||startContainer;endPoint=findEndPoint(endContainer,ancestor)||endContainer;walkBoundary(startContainer,startPoint,true);siblings=collectSiblings(startPoint==startContainer?startPoint:startPoint.nextSibling,"nextSibling",endPoint==endContainer?endPoint.nextSibling:endPoint);if(siblings.length){callback(exclude(siblings))}walkBoundary(endContainer,endPoint)};this.split=function(rng){var startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;function splitText(node,offset){return node.splitText(offset)}if(startContainer==endContainer&&startContainer.nodeType==3){if(startOffset>0&&startOffset<startContainer.nodeValue.length){endContainer=splitText(startContainer,startOffset);startContainer=endContainer.previousSibling;if(endOffset>startOffset){endOffset=endOffset-startOffset;startContainer=endContainer=splitText(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length;startOffset=0}else{endOffset=0}}}else{if(startContainer.nodeType==3&&startOffset>0&&startOffset<startContainer.nodeValue.length){startContainer=splitText(startContainer,startOffset);startOffset=0}if(endContainer.nodeType==3&&endOffset>0&&endOffset<endContainer.nodeValue.length){endContainer=splitText(endContainer,endOffset).previousSibling;endOffset=endContainer.nodeValue.length}}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}}}RangeUtils.compareRanges=function(rng1,rng2){if(rng1&&rng2){if(rng1.item||rng1.duplicate){if(rng1.item&&rng2.item&&rng1.item(0)===rng2.item(0)){return true}if(rng1.isEqual&&rng2.isEqual&&rng2.isEqual(rng1)){return true}}else{return rng1.startContainer==rng2.startContainer&&rng1.startOffset==rng2.startOffset}}return false};return RangeUtils});define("tinymce/Formatter",["tinymce/dom/TreeWalker","tinymce/dom/RangeUtils","tinymce/util/Tools"],function(TreeWalker,RangeUtils,Tools){return function(ed){var formats={},dom=ed.dom,selection=ed.selection,rangeUtils=new RangeUtils(dom),isValid=ed.schema.isValidChild,isBlock=dom.isBlock,forcedRootBlock=ed.settings.forced_root_block,nodeIndex=dom.nodeIndex,INVISIBLE_CHAR="\uFEFF",MCE_ATTR_RE=/^(src|href|style)$/,FALSE=false,TRUE=true,formatChangeData,undef,getContentEditable=dom.getContentEditable,disableCaretContainer,markCaretContainersBogus;var each=Tools.each,grep=Tools.grep,walk=Tools.walk,extend=Tools.extend;function isTextBlock(name){if(name.nodeType){name=name.nodeName}return !!ed.schema.getTextBlockElements()[name.toLowerCase()]}function getParents(node,selector){return dom.getParents(node,selector,dom.getRoot())}function isCaretNode(node){return node.nodeType===1&&node.id==="_mce_caret"}function defaultFormats(){register({alignleft:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{"float":"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},{selector:"img",collapsed:false,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:false,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:false,styles:{"float":"right"}}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:true},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:true},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:false},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:false},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:true,deep:true,onmatch:function(){return true},onformat:function(elm,fmt,vars){each(vars,function(value,key){dom.setAttrib(elm,key,value)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike,sub,sup",remove:"all",split:true,expand:false,block_expand:true,deep:true},{selector:"span",attributes:["style","class"],remove:"empty",split:true,expand:false,deep:true},{selector:"*",attributes:["style","class"],split:false,expand:false,deep:true}]});each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/),function(name){register(name,{block:name,remove:"all"})});register(ed.settings.formats)}function addKeyboardShortcuts(){ed.addShortcut("ctrl+b","bold_desc","Bold");ed.addShortcut("ctrl+i","italic_desc","Italic");ed.addShortcut("ctrl+u","underline_desc","Underline");for(var i=1;i<=6;i++){ed.addShortcut("ctrl+"+i,"",["FormatBlock",false,"h"+i])}ed.addShortcut("ctrl+7","",["FormatBlock",false,"p"]);ed.addShortcut("ctrl+8","",["FormatBlock",false,"div"]);ed.addShortcut("ctrl+9","",["FormatBlock",false,"address"])}function get(name){return name?formats[name]:formats}function register(name,format){if(name){if(typeof(name)!=="string"){each(name,function(format,name){register(name,format)})}else{format=format.length?format:[format];each(format,function(format){if(format.deep===undef){format.deep=!format.selector}if(format.split===undef){format.split=!format.selector||format.inline}if(format.remove===undef&&format.selector&&!format.inline){format.remove="none"}if(format.selector&&format.inline){format.mixed=true;format.block_expand=true}if(typeof(format.classes)==="string"){format.classes=format.classes.split(/\s+/)}});formats[name]=format}}}function getTextDecoration(node){var decoration;ed.dom.getParent(node,function(n){decoration=ed.dom.getStyle(n,"text-decoration");return decoration&&decoration!=="none"});return decoration}function processUnderlineAndColor(node){var textDecoration;if(node.nodeType===1&&node.parentNode&&node.parentNode.nodeType===1){textDecoration=getTextDecoration(node.parentNode);if(ed.dom.getStyle(node,"color")&&textDecoration){ed.dom.setStyle(node,"text-decoration",textDecoration)}else{if(ed.dom.getStyle(node,"textdecoration")===textDecoration){ed.dom.setStyle(node,"text-decoration",null)}}}}function apply(name,vars,node){var formatList=get(name),format=formatList[0],bookmark,rng,isCollapsed=!node&&selection.isCollapsed();function setElementFormat(elm,fmt){fmt=fmt||format;if(elm){if(fmt.onformat){fmt.onformat(elm,fmt,vars,node)}each(fmt.styles,function(value,name){dom.setStyle(elm,name,replaceVars(value,vars))});each(fmt.attributes,function(value,name){dom.setAttrib(elm,name,replaceVars(value,vars))});each(fmt.classes,function(value){value=replaceVars(value,vars);if(!dom.hasClass(elm,value)){dom.addClass(elm,value)}})}}function adjustSelectionToVisibleSelection(){function findSelectionEnd(start,end){var walker=new TreeWalker(end);for(node=walker.current();node;node=walker.prev()){if(node.childNodes.length>1||node==start||node.tagName=="BR"){return node}}}var rng=ed.selection.getRng();var start=rng.startContainer;var end=rng.endContainer;if(start!=end&&rng.endOffset===0){var newEnd=findSelectionEnd(start,end);var endOffset=newEnd.nodeType==3?newEnd.length:newEnd.childNodes.length;rng.setEnd(newEnd,endOffset)}return rng}function applyStyleToList(node,bookmark,wrapElm,newWrappers,process){var nodes=[],listIndex=-1,list,startIndex=-1,endIndex=-1,currentWrapElm;each(node.childNodes,function(n,index){if(n.nodeName==="UL"||n.nodeName==="OL"){listIndex=index;list=n;return false}});each(node.childNodes,function(n,index){if(n.nodeName==="SPAN"&&dom.getAttrib(n,"data-mce-type")=="bookmark"){if(n.id==bookmark.id+"_start"){startIndex=index}else{if(n.id==bookmark.id+"_end"){endIndex=index}}}});if(listIndex<=0||(startIndex<listIndex&&endIndex>listIndex)){each(grep(node.childNodes),process);return 0}else{currentWrapElm=dom.clone(wrapElm,FALSE);each(grep(node.childNodes),function(n,index){if((startIndex<listIndex&&index<listIndex)||(startIndex>listIndex&&index>listIndex)){nodes.push(n);n.parentNode.removeChild(n)}});if(startIndex<listIndex){node.insertBefore(currentWrapElm,list)}else{if(startIndex>listIndex){node.insertBefore(currentWrapElm,list.nextSibling)}}newWrappers.push(currentWrapElm);each(nodes,function(node){currentWrapElm.appendChild(node)});return currentWrapElm}}function applyRngStyle(rng,bookmark,node_specific){var newWrappers=[],wrapName,wrapElm,contentEditable=true;wrapName=format.inline||format.block;wrapElm=dom.create(wrapName);setElementFormat(wrapElm);rangeUtils.walk(rng,function(nodes){var currentWrapElm;function process(node){var nodeName,parentName,found,hasContentEditableState,lastContentEditable;lastContentEditable=contentEditable;nodeName=node.nodeName.toLowerCase();parentName=node.parentNode.nodeName.toLowerCase();if(node.nodeType===1&&getContentEditable(node)){lastContentEditable=contentEditable;contentEditable=getContentEditable(node)==="true";hasContentEditableState=true}if(isEq(nodeName,"br")){currentWrapElm=0;if(format.block){dom.remove(node)}return}if(format.wrapper&&matchNode(node,name,vars)){currentWrapElm=0;return}if(contentEditable&&!hasContentEditableState&&format.block&&!format.wrapper&&isTextBlock(nodeName)&&isValid(parentName,wrapName)){node=dom.rename(node,wrapName);setElementFormat(node);newWrappers.push(node);currentWrapElm=0;return}if(format.selector){each(formatList,function(format){if("collapsed" in format&&format.collapsed!==isCollapsed){return}if(dom.is(node,format.selector)&&!isCaretNode(node)){setElementFormat(node,format);found=true}});if(!format.inline||found){currentWrapElm=0;return}}if(contentEditable&&!hasContentEditableState&&isValid(wrapName,nodeName)&&isValid(parentName,wrapName)&&!(!node_specific&&node.nodeType===3&&node.nodeValue.length===1&&node.nodeValue.charCodeAt(0)===65279)&&!isCaretNode(node)&&(!format.inline||!isBlock(node))){if(!currentWrapElm){currentWrapElm=dom.clone(wrapElm,FALSE);node.parentNode.insertBefore(currentWrapElm,node);newWrappers.push(currentWrapElm)}currentWrapElm.appendChild(node)}else{if(nodeName=="li"&&bookmark){currentWrapElm=applyStyleToList(node,bookmark,wrapElm,newWrappers,process)}else{currentWrapElm=0;each(grep(node.childNodes),process);if(hasContentEditableState){contentEditable=lastContentEditable}currentWrapElm=0}}}each(nodes,process)});if(format.wrap_links===false){each(newWrappers,function(node){function process(node){var i,currentWrapElm,children;if(node.nodeName==="A"){currentWrapElm=dom.clone(wrapElm,FALSE);newWrappers.push(currentWrapElm);children=grep(node.childNodes);for(i=0;i<children.length;i++){currentWrapElm.appendChild(children[i])}node.appendChild(currentWrapElm)}each(grep(node.childNodes),process)}process(node)})}each(newWrappers,function(node){var childCount;function getChildCount(node){var count=0;each(node.childNodes,function(node){if(!isWhiteSpaceNode(node)&&!isBookmarkNode(node)){count++}});return count}function mergeStyles(node){var child,clone;each(node.childNodes,function(node){if(node.nodeType==1&&!isBookmarkNode(node)&&!isCaretNode(node)){child=node;return FALSE}});if(child&&matchName(child,format)){clone=dom.clone(child,FALSE);setElementFormat(clone);dom.replace(clone,node,TRUE);dom.remove(child,1)}return clone||node}childCount=getChildCount(node);if((newWrappers.length>1||!isBlock(node))&&childCount===0){dom.remove(node,1);return}if(format.inline||format.wrapper){if(!format.exact&&childCount===1){node=mergeStyles(node)}each(formatList,function(format){each(dom.select(format.inline,node),function(child){var parent;if(format.wrap_links===false){parent=child.parentNode;do{if(parent.nodeName==="A"){return}}while((parent=parent.parentNode))}removeFormat(format,vars,child,format.exact?child:null)})});if(matchNode(node.parentNode,name,vars)){dom.remove(node,1);node=0;return TRUE}if(format.merge_with_parents){dom.getParent(node.parentNode,function(parent){if(matchNode(parent,name,vars)){dom.remove(node,1);node=0;return TRUE}})}if(node&&format.merge_siblings!==false){node=mergeSiblings(getNonWhiteSpaceSibling(node),node);node=mergeSiblings(node,getNonWhiteSpaceSibling(node,TRUE))}}})}if(format){if(node){if(node.nodeType){rng=dom.createRng();rng.setStartBefore(node);rng.setEndAfter(node);applyRngStyle(expandRng(rng,formatList),null,true)}else{applyRngStyle(node,null,true)}}else{if(!isCollapsed||!format.inline||dom.select("td.mce-item-selected,th.mce-item-selected").length){var curSelNode=ed.selection.getNode();if(!forcedRootBlock&&formatList[0].defaultBlock&&!dom.getParent(curSelNode,dom.isBlock)){apply(formatList[0].defaultBlock)}ed.selection.setRng(adjustSelectionToVisibleSelection());bookmark=selection.getBookmark();applyRngStyle(expandRng(selection.getRng(TRUE),formatList),bookmark);if(format.styles&&(format.styles.color||format.styles.textDecoration)){walk(curSelNode,processUnderlineAndColor,"childNodes");processUnderlineAndColor(curSelNode)}selection.moveToBookmark(bookmark);moveStart(selection.getRng(TRUE));ed.nodeChanged()}else{performCaretAction("apply",name,vars)}}}}function remove(name,vars,node){var formatList=get(name),format=formatList[0],bookmark,rng,contentEditable=true;function process(node){var children,i,l,lastContentEditable,hasContentEditableState;if(node.nodeType===1&&getContentEditable(node)){lastContentEditable=contentEditable;contentEditable=getContentEditable(node)==="true";hasContentEditableState=true}children=grep(node.childNodes);if(contentEditable&&!hasContentEditableState){for(i=0,l=formatList.length;i<l;i++){if(removeFormat(formatList[i],vars,node,node)){break}}}if(format.deep){if(children.length){for(i=0,l=children.length;i<l;i++){process(children[i])}if(hasContentEditableState){contentEditable=lastContentEditable}}}}function findFormatRoot(container){var formatRoot;each(getParents(container.parentNode).reverse(),function(parent){var format;if(!formatRoot&&parent.id!="_start"&&parent.id!="_end"){format=matchNode(parent,name,vars);if(format&&format.split!==false){formatRoot=parent}}});return formatRoot}function wrapAndSplit(format_root,container,target,split){var parent,clone,lastClone,firstClone,i,formatRootParent;if(format_root){formatRootParent=format_root.parentNode;for(parent=container.parentNode;parent&&parent!=formatRootParent;parent=parent.parentNode){clone=dom.clone(parent,FALSE);for(i=0;i<formatList.length;i++){if(removeFormat(formatList[i],vars,clone,clone)){clone=0;break}}if(clone){if(lastClone){clone.appendChild(lastClone)}if(!firstClone){firstClone=clone}lastClone=clone}}if(split&&(!format.mixed||!isBlock(format_root))){container=dom.split(format_root,container)}if(lastClone){target.parentNode.insertBefore(lastClone,target);firstClone.appendChild(target)}}return container}function splitToFormatRoot(container){return wrapAndSplit(findFormatRoot(container),container,container,true)}function unwrap(start){var node=dom.get(start?"_start":"_end"),out=node[start?"firstChild":"lastChild"];if(isBookmarkNode(out)){out=out[start?"firstChild":"lastChild"]}dom.remove(node,true);return out}function removeRngStyle(rng){var startContainer,endContainer;var commonAncestorContainer=rng.commonAncestorContainer;rng=expandRng(rng,formatList,TRUE);if(format.split){startContainer=getContainer(rng,TRUE);endContainer=getContainer(rng);if(startContainer!=endContainer){if(/^(TR|TH|TD)$/.test(startContainer.nodeName)&&startContainer.firstChild){if(startContainer.nodeName=="TR"){startContainer=startContainer.firstChild.firstChild||startContainer}else{startContainer=startContainer.firstChild||startContainer}}if(commonAncestorContainer&&/^T(HEAD|BODY|FOOT|R)$/.test(commonAncestorContainer.nodeName)&&/^(TH|TD)$/.test(endContainer.nodeName)&&endContainer.firstChild){endContainer=endContainer.firstChild||endContainer}startContainer=wrap(startContainer,"span",{id:"_start","data-mce-type":"bookmark"});endContainer=wrap(endContainer,"span",{id:"_end","data-mce-type":"bookmark"});splitToFormatRoot(startContainer);splitToFormatRoot(endContainer);startContainer=unwrap(TRUE);endContainer=unwrap()}else{startContainer=endContainer=splitToFormatRoot(startContainer)}rng.startContainer=startContainer.parentNode;rng.startOffset=nodeIndex(startContainer);rng.endContainer=endContainer.parentNode;rng.endOffset=nodeIndex(endContainer)+1}rangeUtils.walk(rng,function(nodes){each(nodes,function(node){process(node);if(node.nodeType===1&&ed.dom.getStyle(node,"text-decoration")==="underline"&&node.parentNode&&getTextDecoration(node.parentNode)==="underline"){removeFormat({deep:false,exact:true,inline:"span",styles:{textDecoration:"underline"}},null,node)}})})}if(node){if(node.nodeType){rng=dom.createRng();rng.setStartBefore(node);rng.setEndAfter(node);removeRngStyle(rng)}else{removeRngStyle(node)}return}if(!selection.isCollapsed()||!format.inline||dom.select("td.mce-item-selected,th.mce-item-selected").length){bookmark=selection.getBookmark();removeRngStyle(selection.getRng(TRUE));selection.moveToBookmark(bookmark);if(format.inline&&match(name,vars,selection.getStart())){moveStart(selection.getRng(true))}ed.nodeChanged()}else{performCaretAction("remove",name,vars)}}function toggle(name,vars,node){var fmt=get(name);if(match(name,vars,node)&&(!("toggle" in fmt[0])||fmt[0].toggle)){remove(name,vars,node)}else{apply(name,vars,node)}}function matchNode(node,name,vars,similar){var formatList=get(name),format,i,classes;function matchItems(node,format,item_name){var key,value,items=format[item_name],i;if(format.onmatch){return format.onmatch(node,format,item_name)}if(items){if(items.length===undef){for(key in items){if(items.hasOwnProperty(key)){if(item_name==="attributes"){value=dom.getAttrib(node,key)}else{value=getStyle(node,key)}if(similar&&!value&&!format.exact){return}if((!similar||format.exact)&&!isEq(value,normalizeStyleValue(replaceVars(items[key],vars),key))){return}}}}else{for(i=0;i<items.length;i++){if(item_name==="attributes"?dom.getAttrib(node,items[i]):getStyle(node,items[i])){return format}}}}return format}if(formatList&&node){for(i=0;i<formatList.length;i++){format=formatList[i];if(matchName(node,format)&&matchItems(node,format,"attributes")&&matchItems(node,format,"styles")){if((classes=format.classes)){for(i=0;i<classes.length;i++){if(!dom.hasClass(node,classes[i])){return}}}return format}}}}function match(name,vars,node){var startNode;function matchParents(node){var root=dom.getRoot();node=dom.getParent(node,function(node){return node.parentNode===root||!!matchNode(node,name,vars,true)});return matchNode(node,name,vars)}if(node){return matchParents(node)}node=selection.getNode();if(matchParents(node)){return TRUE}startNode=selection.getStart();if(startNode!=node){if(matchParents(startNode)){return TRUE}}return FALSE}function matchAll(names,vars){var startElement,matchedFormatNames=[],checkedMap={};startElement=selection.getStart();dom.getParent(startElement,function(node){var i,name;for(i=0;i<names.length;i++){name=names[i];if(!checkedMap[name]&&matchNode(node,name,vars)){checkedMap[name]=true;matchedFormatNames.push(name)}}},dom.getRoot());return matchedFormatNames}function canApply(name){var formatList=get(name),startNode,parents,i,x,selector;if(formatList){startNode=selection.getStart();parents=getParents(startNode);for(x=formatList.length-1;x>=0;x--){selector=formatList[x].selector;if(!selector||formatList[x].defaultBlock){return TRUE}for(i=parents.length-1;i>=0;i--){if(dom.is(parents[i],selector)){return TRUE}}}}return FALSE}function formatChanged(formats,callback,similar){var currentFormats;if(!formatChangeData){formatChangeData={};currentFormats={};ed.on("NodeChange",function(e){var parents=getParents(e.element),matchedFormats={};each(formatChangeData,function(callbacks,format){each(parents,function(node){if(matchNode(node,format,{},callbacks.similar)){if(!currentFormats[format]){each(callbacks,function(callback){callback(true,{node:node,format:format,parents:parents})});currentFormats[format]=callbacks}matchedFormats[format]=callbacks;return false}})});each(currentFormats,function(callbacks,format){if(!matchedFormats[format]){delete currentFormats[format];each(callbacks,function(callback){callback(false,{node:e.element,format:format,parents:parents})})}})})}each(formats.split(","),function(format){if(!formatChangeData[format]){formatChangeData[format]=[];formatChangeData[format].similar=similar}formatChangeData[format].push(callback)});return this}extend(this,{get:get,register:register,apply:apply,remove:remove,toggle:toggle,match:match,matchAll:matchAll,matchNode:matchNode,canApply:canApply,formatChanged:formatChanged});defaultFormats();addKeyboardShortcuts();ed.on("BeforeGetContent",function(){if(markCaretContainersBogus){markCaretContainersBogus()}});ed.on("mouseup keydown",function(e){if(disableCaretContainer){disableCaretContainer(e)}});function matchName(node,format){if(isEq(node,format.inline)){return TRUE}if(isEq(node,format.block)){return TRUE}if(format.selector){return node.nodeType==1&&dom.is(node,format.selector)}}function isEq(str1,str2){str1=str1||"";str2=str2||"";str1=""+(str1.nodeName||str1);str2=""+(str2.nodeName||str2);return str1.toLowerCase()==str2.toLowerCase()}function getStyle(node,name){return normalizeStyleValue(dom.getStyle(node,name),name)}function normalizeStyleValue(value,name){if(name=="color"||name=="backgroundColor"){value=dom.toHex(value)}if(name=="fontWeight"&&value==700){value="bold"}if(name=="fontFamily"){value=value.replace(/[\'\"]/g,"").replace(/,\s+/g,",")}return""+value}function replaceVars(value,vars){if(typeof(value)!="string"){value=value(vars)}else{if(vars){value=value.replace(/%(\w+)/g,function(str,name){return vars[name]||str})}}return value}function isWhiteSpaceNode(node){return node&&node.nodeType===3&&/^([\t \r\n]+|)$/.test(node.nodeValue)}function wrap(node,name,attrs){var wrapper=dom.create(name,attrs);node.parentNode.insertBefore(wrapper,node);wrapper.appendChild(node);return wrapper}function expandRng(rng,format,remove){var lastIdx,leaf,endPoint,startContainer=rng.startContainer,startOffset=rng.startOffset,endContainer=rng.endContainer,endOffset=rng.endOffset;function findParentContainer(start){var container,parent,sibling,siblingName,root;container=parent=start?startContainer:endContainer;siblingName=start?"previousSibling":"nextSibling";root=dom.getRoot();function isBogusBr(node){return node.nodeName=="BR"&&node.getAttribute("data-mce-bogus")&&!node.nextSibling}if(container.nodeType==3&&!isWhiteSpaceNode(container)){if(start?startOffset>0:endOffset<container.nodeValue.length){return container}}for(;;){if(!format[0].block_expand&&isBlock(parent)){return parent}for(sibling=parent[siblingName];sibling;sibling=sibling[siblingName]){if(!isBookmarkNode(sibling)&&!isWhiteSpaceNode(sibling)&&!isBogusBr(sibling)){return parent}}if(parent.parentNode==root){container=parent;break}parent=parent.parentNode}return container}function findLeaf(node,offset){if(offset===undef){offset=node.nodeType===3?node.length:node.childNodes.length}while(node&&node.hasChildNodes()){node=node.childNodes[offset];if(node){offset=node.nodeType===3?node.length:node.childNodes.length}}return{node:node,offset:offset}}if(startContainer.nodeType==1&&startContainer.hasChildNodes()){lastIdx=startContainer.childNodes.length-1;startContainer=startContainer.childNodes[startOffset>lastIdx?lastIdx:startOffset];if(startContainer.nodeType==3){startOffset=0}}if(endContainer.nodeType==1&&endContainer.hasChildNodes()){lastIdx=endContainer.childNodes.length-1;endContainer=endContainer.childNodes[endOffset>lastIdx?lastIdx:endOffset-1];if(endContainer.nodeType==3){endOffset=endContainer.nodeValue.length}}function findParentContentEditable(node){var parent=node;while(parent){if(parent.nodeType===1&&getContentEditable(parent)){return getContentEditable(parent)==="false"?parent:node}parent=parent.parentNode}return node}function findWordEndPoint(container,offset,start){var walker,node,pos,lastTextNode;function findSpace(node,offset){var pos,pos2,str=node.nodeValue;if(typeof(offset)=="undefined"){offset=start?str.length:0}if(start){pos=str.lastIndexOf(" ",offset);pos2=str.lastIndexOf("\u00a0",offset);pos=pos>pos2?pos:pos2;if(pos!==-1&&!remove){pos++}}else{pos=str.indexOf(" ",offset);pos2=str.indexOf("\u00a0",offset);pos=pos!==-1&&(pos2===-1||pos<pos2)?pos:pos2}return pos}if(container.nodeType===3){pos=findSpace(container,offset);if(pos!==-1){return{container:container,offset:pos}}lastTextNode=container}walker=new TreeWalker(container,dom.getParent(container,isBlock)||ed.getBody());while((node=walker[start?"prev":"next"]())){if(node.nodeType===3){lastTextNode=node;pos=findSpace(node);if(pos!==-1){return{container:node,offset:pos}}}else{if(isBlock(node)){break}}}if(lastTextNode){if(start){offset=0}else{offset=lastTextNode.length}return{container:lastTextNode,offset:offset}}}function findSelectorEndPoint(container,sibling_name){var parents,i,y,curFormat;if(container.nodeType==3&&container.nodeValue.length===0&&container[sibling_name]){container=container[sibling_name]}parents=getParents(container);for(i=0;i<parents.length;i++){for(y=0;y<format.length;y++){curFormat=format[y];if("collapsed" in curFormat&&curFormat.collapsed!==rng.collapsed){continue}if(dom.is(parents[i],curFormat.selector)){return parents[i]}}}return container}function findBlockEndPoint(container,sibling_name){var node,root=dom.getRoot();if(!format[0].wrapper){node=dom.getParent(container,format[0].block)}if(!node){node=dom.getParent(container.nodeType==3?container.parentNode:container,function(node){return node!=root&&isTextBlock(node)})}if(node&&format[0].wrapper){node=getParents(node,"ul,ol").reverse()[0]||node}if(!node){node=container;while(node[sibling_name]&&!isBlock(node[sibling_name])){node=node[sibling_name];if(isEq(node,"br")){break}}}return node||container}startContainer=findParentContentEditable(startContainer);endContainer=findParentContentEditable(endContainer);if(isBookmarkNode(startContainer.parentNode)||isBookmarkNode(startContainer)){startContainer=isBookmarkNode(startContainer)?startContainer:startContainer.parentNode;startContainer=startContainer.nextSibling||startContainer;if(startContainer.nodeType==3){startOffset=0}}if(isBookmarkNode(endContainer.parentNode)||isBookmarkNode(endContainer)){endContainer=isBookmarkNode(endContainer)?endContainer:endContainer.parentNode;endContainer=endContainer.previousSibling||endContainer;if(endContainer.nodeType==3){endOffset=endContainer.length}}if(format[0].inline){if(rng.collapsed){endPoint=findWordEndPoint(startContainer,startOffset,true);if(endPoint){startContainer=endPoint.container;startOffset=endPoint.offset}endPoint=findWordEndPoint(endContainer,endOffset);if(endPoint){endContainer=endPoint.container;endOffset=endPoint.offset}}leaf=findLeaf(endContainer,endOffset);if(leaf.node){while(leaf.node&&leaf.offset===0&&leaf.node.previousSibling){leaf=findLeaf(leaf.node.previousSibling)}if(leaf.node&&leaf.offset>0&&leaf.node.nodeType===3&&leaf.node.nodeValue.charAt(leaf.offset-1)===" "){if(leaf.offset>1){endContainer=leaf.node;endContainer.splitText(leaf.offset-1)}}}}if(format[0].inline||format[0].block_expand){if(!format[0].inline||(startContainer.nodeType!=3||startOffset===0)){startContainer=findParentContainer(true)}if(!format[0].inline||(endContainer.nodeType!=3||endOffset===endContainer.nodeValue.length)){endContainer=findParentContainer()}}if(format[0].selector&&format[0].expand!==FALSE&&!format[0].inline){startContainer=findSelectorEndPoint(startContainer,"previousSibling");endContainer=findSelectorEndPoint(endContainer,"nextSibling")}if(format[0].block||format[0].selector){startContainer=findBlockEndPoint(startContainer,"previousSibling");endContainer=findBlockEndPoint(endContainer,"nextSibling");if(format[0].block){if(!isBlock(startContainer)){startContainer=findParentContainer(true)}if(!isBlock(endContainer)){endContainer=findParentContainer()}}}if(startContainer.nodeType==1){startOffset=nodeIndex(startContainer);startContainer=startContainer.parentNode}if(endContainer.nodeType==1){endOffset=nodeIndex(endContainer)+1;endContainer=endContainer.parentNode}return{startContainer:startContainer,startOffset:startOffset,endContainer:endContainer,endOffset:endOffset}}function removeFormat(format,vars,node,compare_node){var i,attrs,stylesModified;if(!matchName(node,format)){return FALSE}if(format.remove!="all"){each(format.styles,function(value,name){value=normalizeStyleValue(replaceVars(value,vars),name);if(typeof(name)==="number"){name=value;compare_node=0}if(!compare_node||isEq(getStyle(compare_node,name),value)){dom.setStyle(node,name,"")}stylesModified=1});if(stylesModified&&dom.getAttrib(node,"style")===""){node.removeAttribute("style");node.removeAttribute("data-mce-style")}each(format.attributes,function(value,name){var valueOut;value=replaceVars(value,vars);if(typeof(name)==="number"){name=value;compare_node=0}if(!compare_node||isEq(dom.getAttrib(compare_node,name),value)){if(name=="class"){value=dom.getAttrib(node,name);if(value){valueOut="";each(value.split(/\s+/),function(cls){if(/mce\w+/.test(cls)){valueOut+=(valueOut?" ":"")+cls}});if(valueOut){dom.setAttrib(node,name,valueOut);return}}}if(name=="class"){node.removeAttribute("className")}if(MCE_ATTR_RE.test(name)){node.removeAttribute("data-mce-"+name)}node.removeAttribute(name)}});each(format.classes,function(value){value=replaceVars(value,vars);if(!compare_node||dom.hasClass(compare_node,value)){dom.removeClass(node,value)}});attrs=dom.getAttribs(node);for(i=0;i<attrs.length;i++){if(attrs[i].nodeName.indexOf("_")!==0){return FALSE}}}if(format.remove!="none"){removeNode(node,format);return TRUE}}function removeNode(node,format){var parentNode=node.parentNode,rootBlockElm;function find(node,next,inc){node=getNonWhiteSpaceSibling(node,next,inc);return !node||(node.nodeName=="BR"||isBlock(node))}if(format.block){if(!forcedRootBlock){if(isBlock(node)&&!isBlock(parentNode)){if(!find(node,FALSE)&&!find(node.firstChild,TRUE,1)){node.insertBefore(dom.create("br"),node.firstChild)}if(!find(node,TRUE)&&!find(node.lastChild,FALSE,1)){node.appendChild(dom.create("br"))}}}else{if(parentNode==dom.getRoot()){if(!format.list_block||!isEq(node,format.list_block)){each(grep(node.childNodes),function(node){if(isValid(forcedRootBlock,node.nodeName.toLowerCase())){if(!rootBlockElm){rootBlockElm=wrap(node,forcedRootBlock);dom.setAttribs(rootBlockElm,ed.settings.forced_root_block_attrs)}else{rootBlockElm.appendChild(node)}}else{rootBlockElm=0}})}}}}if(format.selector&&format.inline&&!isEq(format.inline,node)){return}dom.remove(node,1)}function getNonWhiteSpaceSibling(node,next,inc){if(node){next=next?"nextSibling":"previousSibling";for(node=inc?node:node[next];node;node=node[next]){if(node.nodeType==1||!isWhiteSpaceNode(node)){return node}}}}function isBookmarkNode(node){return node&&node.nodeType==1&&node.getAttribute("data-mce-type")=="bookmark"}function mergeSiblings(prev,next){var sibling,tmpSibling;function compareElements(node1,node2){if(node1.nodeName!=node2.nodeName){return FALSE}function getAttribs(node){var attribs={};each(dom.getAttribs(node),function(attr){var name=attr.nodeName.toLowerCase();if(name.indexOf("_")!==0&&name!=="style"){attribs[name]=dom.getAttrib(node,name)}});return attribs}function compareObjects(obj1,obj2){var value,name;for(name in obj1){if(obj1.hasOwnProperty(name)){value=obj2[name];if(value===undef){return FALSE}if(obj1[name]!=value){return FALSE}delete obj2[name]}}for(name in obj2){if(obj2.hasOwnProperty(name)){return FALSE}}return TRUE}if(!compareObjects(getAttribs(node1),getAttribs(node2))){return FALSE}if(!compareObjects(dom.parseStyle(dom.getAttrib(node1,"style")),dom.parseStyle(dom.getAttrib(node2,"style")))){return FALSE}return TRUE}function findElementSibling(node,sibling_name){for(sibling=node;sibling;sibling=sibling[sibling_name]){if(sibling.nodeType==3&&sibling.nodeValue.length!==0){return node}if(sibling.nodeType==1&&!isBookmarkNode(sibling)){return sibling}}return node}if(prev&&next){prev=findElementSibling(prev,"previousSibling");next=findElementSibling(next,"nextSibling");if(compareElements(prev,next)){for(sibling=prev.nextSibling;sibling&&sibling!=next;){tmpSibling=sibling;sibling=sibling.nextSibling;prev.appendChild(tmpSibling)}dom.remove(next);each(grep(next.childNodes),function(node){prev.appendChild(node)});return prev}}return next}function getContainer(rng,start){var container,offset,lastIdx;container=rng[start?"startContainer":"endContainer"];offset=rng[start?"startOffset":"endOffset"];if(container.nodeType==1){lastIdx=container.childNodes.length-1;if(!start&&offset){offset--}container=container.childNodes[offset>lastIdx?lastIdx:offset]}if(container.nodeType===3&&start&&offset>=container.nodeValue.length){container=new TreeWalker(container,ed.getBody()).next()||container}if(container.nodeType===3&&!start&&offset===0){container=new TreeWalker(container,ed.getBody()).prev()||container}return container}function performCaretAction(type,name,vars){var caretContainerId="_mce_caret",debug=ed.settings.caret_debug;function createCaretContainer(fill){var caretContainer=dom.create("span",{id:caretContainerId,"data-mce-bogus":true,style:debug?"color:red":""});if(fill){caretContainer.appendChild(ed.getDoc().createTextNode(INVISIBLE_CHAR))}return caretContainer}function isCaretContainerEmpty(node,nodes){while(node){if((node.nodeType===3&&node.nodeValue!==INVISIBLE_CHAR)||node.childNodes.length>1){return false}if(nodes&&node.nodeType===1){nodes.push(node)}node=node.firstChild}return true}function getParentCaretContainer(node){while(node){if(node.id===caretContainerId){return node}node=node.parentNode}}function findFirstTextNode(node){var walker;if(node){walker=new TreeWalker(node,node);for(node=walker.current();node;node=walker.next()){if(node.nodeType===3){return node}}}}function removeCaretContainer(node,move_caret){var child,rng;if(!node){node=getParentCaretContainer(selection.getStart());if(!node){while((node=dom.get(caretContainerId))){removeCaretContainer(node,false)}}}else{rng=selection.getRng(true);if(isCaretContainerEmpty(node)){if(move_caret!==false){rng.setStartBefore(node);rng.setEndBefore(node)}dom.remove(node)}else{child=findFirstTextNode(node);if(child.nodeValue.charAt(0)===INVISIBLE_CHAR){child=child.deleteData(0,1)}dom.remove(node,1)}selection.setRng(rng)}}function applyCaretFormat(){var rng,caretContainer,textNode,offset,bookmark,container,text;rng=selection.getRng(true);offset=rng.startOffset;container=rng.startContainer;text=container.nodeValue;caretContainer=getParentCaretContainer(selection.getStart());if(caretContainer){textNode=findFirstTextNode(caretContainer)}if(text&&offset>0&&offset<text.length&&/\w/.test(text.charAt(offset))&&/\w/.test(text.charAt(offset-1))){bookmark=selection.getBookmark();rng.collapse(true);rng=expandRng(rng,get(name));rng=rangeUtils.split(rng);apply(name,vars,rng);selection.moveToBookmark(bookmark)}else{if(!caretContainer||textNode.nodeValue!==INVISIBLE_CHAR){caretContainer=createCaretContainer(true);textNode=caretContainer.firstChild;rng.insertNode(caretContainer);offset=1;apply(name,vars,caretContainer)}else{apply(name,vars,caretContainer)}selection.setCursorLocation(textNode,offset)}}function removeCaretFormat(){var rng=selection.getRng(true),container,offset,bookmark,hasContentAfter,node,formatNode,parents=[],i,caretContainer;container=rng.startContainer;offset=rng.startOffset;node=container;if(container.nodeType==3){if(offset!=container.nodeValue.length||container.nodeValue===INVISIBLE_CHAR){hasContentAfter=true}node=node.parentNode}while(node){if(matchNode(node,name,vars)){formatNode=node;break}if(node.nextSibling){hasContentAfter=true}parents.push(node);node=node.parentNode}if(!formatNode){return}if(hasContentAfter){bookmark=selection.getBookmark();rng.collapse(true);rng=expandRng(rng,get(name),true);rng=rangeUtils.split(rng);remove(name,vars,rng);selection.moveToBookmark(bookmark)}else{caretContainer=createCaretContainer();node=caretContainer;for(i=parents.length-1;i>=0;i--){node.appendChild(dom.clone(parents[i],false));node=node.firstChild}node.appendChild(dom.doc.createTextNode(INVISIBLE_CHAR));node=node.firstChild;var block=dom.getParent(formatNode,isTextBlock);if(block&&dom.isEmpty(block)){formatNode.parentNode.replaceChild(caretContainer,formatNode)}else{dom.insertAfter(caretContainer,formatNode)}selection.setCursorLocation(node,1);if(dom.isEmpty(formatNode)){dom.remove(formatNode)}}}function unmarkBogusCaretParents(){var caretContainer;caretContainer=getParentCaretContainer(selection.getStart());if(caretContainer&&!dom.isEmpty(caretContainer)){walk(caretContainer,function(node){if(node.nodeType==1&&node.id!==caretContainerId&&!dom.isEmpty(node)){dom.setAttrib(node,"data-mce-bogus",null)}},"childNodes")}}if(!ed._hasCaretEvents){markCaretContainersBogus=function(){var nodes=[],i;if(isCaretContainerEmpty(getParentCaretContainer(selection.getStart()),nodes)){i=nodes.length;while(i--){dom.setAttrib(nodes[i],"data-mce-bogus","1")}}};disableCaretContainer=function(e){var keyCode=e.keyCode;removeCaretContainer();if(keyCode==8||keyCode==37||keyCode==39){removeCaretContainer(getParentCaretContainer(selection.getStart()))}unmarkBogusCaretParents()};ed.on("SetContent",function(e){if(e.selection){unmarkBogusCaretParents()}});ed._hasCaretEvents=true}if(type=="apply"){applyCaretFormat()}else{removeCaretFormat()}}function moveStart(rng){var container=rng.startContainer,offset=rng.startOffset,isAtEndOfText,walker,node,nodes,tmpNode;if(container.nodeType==3&&offset>=container.nodeValue.length){offset=nodeIndex(container);container=container.parentNode;isAtEndOfText=true}if(container.nodeType==1){nodes=container.childNodes;container=nodes[Math.min(offset,nodes.length-1)];walker=new TreeWalker(container,dom.getParent(container,dom.isBlock));if(offset>nodes.length-1||isAtEndOfText){walker.next()}for(node=walker.current();node;node=walker.next()){if(node.nodeType==3&&!isWhiteSpaceNode(node)){tmpNode=dom.create("a",null,INVISIBLE_CHAR);node.parentNode.insertBefore(tmpNode,node);rng.setStart(node,0);selection.setRng(rng);dom.remove(tmpNode);return}}}}}});define("tinymce/UndoManager",["tinymce/Env","tinymce/util/Tools"],function(Env,Tools){var trim=Tools.trim,trimContentRegExp;trimContentRegExp=new RegExp(["<span[^>]+data-mce-bogus[^>]+>[\u200B\uFEFF]+<\\/span>","<div[^>]+data-mce-bogus[^>]+><\\/div>",'\\s?data-mce-selected="[^"]+"'].join("|"),"gi");return function(editor){var self,index=0,data=[],beforeBookmark,isFirstTypedCharacter,lock;function getContent(){return trim(editor.getContent({format:"raw",no_events:1}).replace(trimContentRegExp,""))}function addNonTypingUndoLevel(){self.typing=false;self.add()}editor.on("init",function(){self.add()});editor.on("BeforeExecCommand",function(e){var cmd=e.command;if(cmd!="Undo"&&cmd!="Redo"&&cmd!="mceRepaint"){self.beforeChange()}});editor.on("ExecCommand",function(e){var cmd=e.command;if(cmd!="Undo"&&cmd!="Redo"&&cmd!="mceRepaint"){self.add()}});editor.on("ObjectResizeStart",function(){self.beforeChange()});editor.on("SaveContent ObjectResized",addNonTypingUndoLevel);editor.dom.bind(editor.dom.getRoot(),"dragend",addNonTypingUndoLevel);editor.dom.bind(editor.getBody(),"focusout",function(){if(!editor.removed&&self.typing){addNonTypingUndoLevel()}});editor.on("KeyUp",function(e){var keyCode=e.keyCode;if((keyCode>=33&&keyCode<=36)||(keyCode>=37&&keyCode<=40)||keyCode==45||keyCode==13||e.ctrlKey){addNonTypingUndoLevel();editor.nodeChanged()}if(keyCode==46||keyCode==8||(Env.mac&&(keyCode==91||keyCode==93))){editor.nodeChanged()}if(isFirstTypedCharacter&&self.typing){if(!editor.isDirty()){editor.isNotDirty=!data[0]||getContent()==data[0].content;if(!editor.isNotDirty){editor.fire("change",{level:data[0],lastLevel:null})}}editor.fire("TypingUndo");isFirstTypedCharacter=false;editor.nodeChanged()}});editor.on("KeyDown",function(e){var keyCode=e.keyCode;if((keyCode>=33&&keyCode<=36)||(keyCode>=37&&keyCode<=40)||keyCode==45){if(self.typing){addNonTypingUndoLevel()}return}if((keyCode<16||keyCode>20)&&keyCode!=224&&keyCode!=91&&!self.typing){self.beforeChange();self.typing=true;self.add();isFirstTypedCharacter=true}});editor.on("MouseDown",function(){if(self.typing){addNonTypingUndoLevel()}});editor.addShortcut("ctrl+z","","Undo");editor.addShortcut("ctrl+y,ctrl+shift+z","","Redo");editor.on("AddUndo Undo Redo ClearUndos MouseUp",function(e){if(!e.isDefaultPrevented()){editor.nodeChanged()}});self={data:data,typing:false,beforeChange:function(){if(!lock){beforeBookmark=editor.selection.getBookmark(2,true)}},add:function(level){var i,settings=editor.settings,lastLevel;level=level||{};level.content=getContent();if(lock||editor.fire("BeforeAddUndo",{level:level}).isDefaultPrevented()){return null}lastLevel=data[index];if(lastLevel&&lastLevel.content==level.content){return null}if(data[index]){data[index].beforeBookmark=beforeBookmark}if(settings.custom_undo_redo_levels){if(data.length>settings.custom_undo_redo_levels){for(i=0;i<data.length-1;i++){data[i]=data[i+1]}data.length--;index=data.length}}level.bookmark=editor.selection.getBookmark(2,true);if(index<data.length-1){data.length=index+1}data.push(level);index=data.length-1;var args={level:level,lastLevel:lastLevel};editor.fire("AddUndo",args);if(index>0){editor.fire("change",args);editor.isNotDirty=false}return level},undo:function(){var level;if(self.typing){self.add();self.typing=false}if(index>0){level=data[--index];if(index===0){editor.isNotDirty=true}editor.setContent(level.content,{format:"raw"});editor.selection.moveToBookmark(level.beforeBookmark);editor.fire("undo",{level:level})}return level},redo:function(){var level;if(index<data.length-1){level=data[++index];editor.setContent(level.content,{format:"raw"});editor.selection.moveToBookmark(level.bookmark);editor.fire("redo",{level:level})}return level},clear:function(){data=[];index=0;self.typing=false;editor.fire("ClearUndos")},hasUndo:function(){return index>0||(self.typing&&data[0]&&getContent()!=data[0].content)},hasRedo:function(){return index<data.length-1&&!this.typing},transact:function(callback){self.beforeChange();lock=true;callback();lock=false;self.add()}};return self}});define("tinymce/EnterKey",["tinymce/dom/TreeWalker","tinymce/Env"],function(TreeWalker,Env){var isIE=Env.ie&&Env.ie<11;return function(editor){var dom=editor.dom,selection=editor.selection,settings=editor.settings;var undoManager=editor.undoManager,schema=editor.schema,nonEmptyElementsMap=schema.getNonEmptyElements();function handleEnterKey(evt){var rng=selection.getRng(true),tmpRng,editableRoot,container,offset,parentBlock,documentMode,shiftKey,newBlock,fragment,containerBlock,parentBlockName,containerBlockName,newBlockName,isAfterLastNodeInContainer;function canSplitBlock(node){return node&&dom.isBlock(node)&&!/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName)&&!/^(fixed|absolute)/i.test(node.style.position)&&dom.getContentEditable(node)!=="true"}function renderBlockOnIE(block){var oldRng;if(dom.isBlock(block)){oldRng=selection.getRng();block.appendChild(dom.create("span",null,"\u00a0"));selection.select(block);block.lastChild.outerHTML="";selection.setRng(oldRng)}}function trimInlineElementsOnLeftSideOfBlock(block){var node=block,firstChilds=[],i;while((node=node.firstChild)){if(dom.isBlock(node)){return}if(node.nodeType==1&&!nonEmptyElementsMap[node.nodeName.toLowerCase()]){firstChilds.push(node)}}i=firstChilds.length;while(i--){node=firstChilds[i];if(!node.hasChildNodes()||(node.firstChild==node.lastChild&&node.firstChild.nodeValue==="")){dom.remove(node)}else{if(node.nodeName=="A"&&(node.innerText||node.textContent)===" "){dom.remove(node)}}}}function moveToCaretPosition(root){var walker,node,rng,lastNode=root,tempElm;function firstNonWhiteSpaceNodeSibling(node){while(node){if(node.nodeType==1||(node.nodeType==3&&node.data&&/[\r\n\s]/.test(node.data))){return node}node=node.nextSibling}}if(Env.ie&&Env.ie<9&&parentBlock&&parentBlock.firstChild){if(parentBlock.firstChild==parentBlock.lastChild&&parentBlock.firstChild.tagName=="BR"){dom.remove(parentBlock.firstChild)}}if(root.nodeName=="LI"){var firstChild=firstNonWhiteSpaceNodeSibling(root.firstChild);if(firstChild&&/^(UL|OL)$/.test(firstChild.nodeName)){root.insertBefore(dom.doc.createTextNode("\u00a0"),root.firstChild)}}rng=dom.createRng();if(root.hasChildNodes()){walker=new TreeWalker(root,root);while((node=walker.current())){if(node.nodeType==3){rng.setStart(node,0);rng.setEnd(node,0);break}if(nonEmptyElementsMap[node.nodeName.toLowerCase()]){rng.setStartBefore(node);rng.setEndBefore(node);break}lastNode=node;node=walker.next()}if(!node){rng.setStart(lastNode,0);rng.setEnd(lastNode,0)}}else{if(root.nodeName=="BR"){if(root.nextSibling&&dom.isBlock(root.nextSibling)){if(!documentMode||documentMode<9){tempElm=dom.create("br");root.parentNode.insertBefore(tempElm,root)}rng.setStartBefore(root);rng.setEndBefore(root)}else{rng.setStartAfter(root);rng.setEndAfter(root)}}else{rng.setStart(root,0);rng.setEnd(root,0)}}selection.setRng(rng);dom.remove(tempElm);selection.scrollIntoView(root)}function setForcedBlockAttrs(node){var forcedRootBlockName=settings.forced_root_block;if(forcedRootBlockName&&forcedRootBlockName.toLowerCase()===node.tagName.toLowerCase()){dom.setAttribs(node,settings.forced_root_block_attrs)}}function createNewBlock(name){var node=container,block,clonedNode,caretNode;if(name||parentBlockName=="TABLE"){block=dom.create(name||newBlockName);setForcedBlockAttrs(block)}else{block=parentBlock.cloneNode(false)}caretNode=block;if(settings.keep_styles!==false){do{if(/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(node.nodeName)){if(node.id=="_mce_caret"){continue}clonedNode=node.cloneNode(false);dom.setAttrib(clonedNode,"id","");if(block.hasChildNodes()){clonedNode.appendChild(block.firstChild);block.appendChild(clonedNode)}else{caretNode=clonedNode;block.appendChild(clonedNode)}}}while((node=node.parentNode))}if(!isIE){caretNode.innerHTML='<br data-mce-bogus="1">'}return block}function isCaretAtStartOrEndOfBlock(start){var walker,node,name;if(container.nodeType==3&&(start?offset>0:offset<container.nodeValue.length)){return false}if(container.parentNode==parentBlock&&isAfterLastNodeInContainer&&!start){return true}if(start&&container.nodeType==1&&container==parentBlock.firstChild){return true}if(container.nodeName==="TABLE"||(container.previousSibling&&container.previousSibling.nodeName=="TABLE")){return(isAfterLastNodeInContainer&&!start)||(!isAfterLastNodeInContainer&&start)}walker=new TreeWalker(container,parentBlock);if(container.nodeType==3){if(start&&offset===0){walker.prev()}else{if(!start&&offset==container.nodeValue.length){walker.next()}}}while((node=walker.current())){if(node.nodeType===1){if(!node.getAttribute("data-mce-bogus")){name=node.nodeName.toLowerCase();if(nonEmptyElementsMap[name]&&name!=="br"){return false}}}else{if(node.nodeType===3&&!/^[ \t\r\n]*$/.test(node.nodeValue)){return false}}if(start){walker.prev()}else{walker.next()}}return true}function wrapSelfAndSiblingsInDefaultBlock(container,offset){var newBlock,parentBlock,startNode,node,next,rootBlockName,blockName=newBlockName||"P";parentBlock=dom.getParent(container,dom.isBlock);rootBlockName=editor.getBody().nodeName.toLowerCase();if(!parentBlock||!canSplitBlock(parentBlock)){parentBlock=parentBlock||editableRoot;if(!parentBlock.hasChildNodes()){newBlock=dom.create(blockName);setForcedBlockAttrs(newBlock);parentBlock.appendChild(newBlock);rng.setStart(newBlock,0);rng.setEnd(newBlock,0);return newBlock}node=container;while(node.parentNode!=parentBlock){node=node.parentNode}while(node&&!dom.isBlock(node)){startNode=node;node=node.previousSibling}if(startNode&&schema.isValidChild(rootBlockName,blockName.toLowerCase())){newBlock=dom.create(blockName);setForcedBlockAttrs(newBlock);startNode.parentNode.insertBefore(newBlock,startNode);node=startNode;while(node&&!dom.isBlock(node)){next=node.nextSibling;newBlock.appendChild(node);node=next}rng.setStart(container,offset);rng.setEnd(container,offset)}}return container}function handleEmptyListItem(){function isFirstOrLastLi(first){var node=containerBlock[first?"firstChild":"lastChild"];while(node){if(node.nodeType==1){break}node=node[first?"nextSibling":"previousSibling"]}return node===parentBlock}function getContainerBlock(){var containerBlockParent=containerBlock.parentNode;if(containerBlockParent.nodeName=="LI"){return containerBlockParent}return containerBlock}var containerBlockParentName=containerBlock.parentNode.nodeName;if(/^(OL|UL|LI)$/.test(containerBlockParentName)){newBlockName="LI"}newBlock=newBlockName?createNewBlock(newBlockName):dom.create("BR");if(isFirstOrLastLi(true)&&isFirstOrLastLi()){if(containerBlockParentName=="LI"){dom.insertAfter(newBlock,getContainerBlock())}else{dom.replace(newBlock,containerBlock)}}else{if(isFirstOrLastLi(true)){if(containerBlockParentName=="LI"){dom.insertAfter(newBlock,getContainerBlock());newBlock.appendChild(dom.doc.createTextNode(" "));newBlock.appendChild(containerBlock)}else{containerBlock.parentNode.insertBefore(newBlock,containerBlock)}}else{if(isFirstOrLastLi()){dom.insertAfter(newBlock,getContainerBlock());renderBlockOnIE(newBlock)}else{containerBlock=getContainerBlock();tmpRng=rng.cloneRange();tmpRng.setStartAfter(parentBlock);tmpRng.setEndAfter(containerBlock);fragment=tmpRng.extractContents();if(newBlockName=="LI"&&fragment.firstChild.nodeName=="LI"){newBlock=fragment.firstChild;dom.insertAfter(fragment,containerBlock)}else{dom.insertAfter(fragment,containerBlock);dom.insertAfter(newBlock,containerBlock)}}}}dom.remove(parentBlock);moveToCaretPosition(newBlock);undoManager.add()}function hasRightSideContent(){var walker=new TreeWalker(container,parentBlock),node;while((node=walker.next())){if(nonEmptyElementsMap[node.nodeName.toLowerCase()]||node.length>0){return true}}}function insertBr(){var brElm,extraBr,marker;if(container&&container.nodeType==3&&offset>=container.nodeValue.length){if(!isIE&&!hasRightSideContent()){brElm=dom.create("br");rng.insertNode(brElm);rng.setStartAfter(brElm);rng.setEndAfter(brElm);extraBr=true}}brElm=dom.create("br");rng.insertNode(brElm);if(isIE&&parentBlockName=="PRE"&&(!documentMode||documentMode<8)){brElm.parentNode.insertBefore(dom.doc.createTextNode("\r"),brElm)}marker=dom.create("span",{},"&nbsp;");brElm.parentNode.insertBefore(marker,brElm);selection.scrollIntoView(marker);dom.remove(marker);if(!extraBr){rng.setStartAfter(brElm);rng.setEndAfter(brElm)}else{rng.setStartBefore(brElm);rng.setEndBefore(brElm)}selection.setRng(rng);undoManager.add()}function trimLeadingLineBreaks(node){do{if(node.nodeType===3){node.nodeValue=node.nodeValue.replace(/^[\r\n]+/,"")}node=node.firstChild}while(node)}function getEditableRoot(node){var root=dom.getRoot(),parent,editableRoot;parent=node;while(parent!==root&&dom.getContentEditable(parent)!=="false"){if(dom.getContentEditable(parent)==="true"){editableRoot=parent}parent=parent.parentNode}return parent!==root?editableRoot:root}function addBrToBlockIfNeeded(block){var lastChild;if(!isIE){block.normalize();lastChild=block.lastChild;if(!lastChild||(/^(left|right)$/gi.test(dom.getStyle(lastChild,"float",true)))){dom.add(block,"br")}}}if(!rng.collapsed){editor.execCommand("Delete");return}if(evt.isDefaultPrevented()){return}container=rng.startContainer;offset=rng.startOffset;newBlockName=(settings.force_p_newlines?"p":"")||settings.forced_root_block;newBlockName=newBlockName?newBlockName.toUpperCase():"";documentMode=dom.doc.documentMode;shiftKey=evt.shiftKey;if(container.nodeType==1&&container.hasChildNodes()){isAfterLastNodeInContainer=offset>container.childNodes.length-1;container=container.childNodes[Math.min(offset,container.childNodes.length-1)]||container;if(isAfterLastNodeInContainer&&container.nodeType==3){offset=container.nodeValue.length}else{offset=0}}editableRoot=getEditableRoot(container);if(!editableRoot){return}undoManager.beforeChange();if(!dom.isBlock(editableRoot)&&editableRoot!=dom.getRoot()){if(!newBlockName||shiftKey){insertBr()}return}if((newBlockName&&!shiftKey)||(!newBlockName&&shiftKey)){container=wrapSelfAndSiblingsInDefaultBlock(container,offset)}parentBlock=dom.getParent(container,dom.isBlock);containerBlock=parentBlock?dom.getParent(parentBlock.parentNode,dom.isBlock):null;parentBlockName=parentBlock?parentBlock.nodeName.toUpperCase():"";containerBlockName=containerBlock?containerBlock.nodeName.toUpperCase():"";if(containerBlockName=="LI"&&!evt.ctrlKey){parentBlock=containerBlock;parentBlockName=containerBlockName}if(parentBlockName=="LI"){if(!newBlockName&&shiftKey){insertBr();return}if(dom.isEmpty(parentBlock)){handleEmptyListItem();return}}if(parentBlockName=="PRE"&&settings.br_in_pre!==false){if(!shiftKey){insertBr();return}}else{if((!newBlockName&&!shiftKey&&parentBlockName!="LI")||(newBlockName&&shiftKey)){insertBr();return}}if(newBlockName&&parentBlock===editor.getBody()){return}newBlockName=newBlockName||"P";if(isCaretAtStartOrEndOfBlock()){if(/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName)&&containerBlockName!="HGROUP"){newBlock=createNewBlock(newBlockName)}else{newBlock=createNewBlock()}if(settings.end_container_on_empty_block&&canSplitBlock(containerBlock)&&dom.isEmpty(parentBlock)){newBlock=dom.split(containerBlock,parentBlock)}else{dom.insertAfter(newBlock,parentBlock)}moveToCaretPosition(newBlock)}else{if(isCaretAtStartOrEndOfBlock(true)){newBlock=parentBlock.parentNode.insertBefore(createNewBlock(),parentBlock);renderBlockOnIE(newBlock);moveToCaretPosition(parentBlock)}else{tmpRng=rng.cloneRange();tmpRng.setEndAfter(parentBlock);fragment=tmpRng.extractContents();trimLeadingLineBreaks(fragment);newBlock=fragment.firstChild;dom.insertAfter(fragment,parentBlock);trimInlineElementsOnLeftSideOfBlock(newBlock);addBrToBlockIfNeeded(parentBlock);moveToCaretPosition(newBlock)}}dom.setAttrib(newBlock,"id","");editor.fire("NewBlock",{newBlock:newBlock});undoManager.add()}editor.on("keydown",function(evt){if(evt.keyCode==13){if(handleEnterKey(evt)!==false){evt.preventDefault()}}})}});define("tinymce/ForceBlocks",[],function(){return function(editor){var settings=editor.settings,dom=editor.dom,selection=editor.selection;var schema=editor.schema,blockElements=schema.getBlockElements();function addRootBlocks(){var node=selection.getStart(),rootNode=editor.getBody(),rng;var startContainer,startOffset,endContainer,endOffset,rootBlockNode;var tempNode,offset=-16777215,wrapped,restoreSelection;var tmpRng,rootNodeName,forcedRootBlock;forcedRootBlock=settings.forced_root_block;if(!node||node.nodeType!==1||!forcedRootBlock){return}while(node&&node!=rootNode){if(blockElements[node.nodeName]){return}node=node.parentNode}rng=selection.getRng();if(rng.setStart){startContainer=rng.startContainer;startOffset=rng.startOffset;endContainer=rng.endContainer;endOffset=rng.endOffset;try{restoreSelection=editor.getDoc().activeElement===rootNode}catch(ex){}}else{if(rng.item){node=rng.item(0);rng=editor.getDoc().body.createTextRange();rng.moveToElementText(node)}restoreSelection=rng.parentElement().ownerDocument===editor.getDoc();tmpRng=rng.duplicate();tmpRng.collapse(true);startOffset=tmpRng.move("character",offset)*-1;if(!tmpRng.collapsed){tmpRng=rng.duplicate();tmpRng.collapse(false);endOffset=(tmpRng.move("character",offset)*-1)-startOffset}}node=rootNode.firstChild;rootNodeName=rootNode.nodeName.toLowerCase();while(node){if(((node.nodeType===3||(node.nodeType==1&&!blockElements[node.nodeName])))&&schema.isValidChild(rootNodeName,forcedRootBlock.toLowerCase())){if(node.nodeType===3&&node.nodeValue.length===0){tempNode=node;node=node.nextSibling;dom.remove(tempNode);continue}if(!rootBlockNode){rootBlockNode=dom.create(forcedRootBlock,editor.settings.forced_root_block_attrs);node.parentNode.insertBefore(rootBlockNode,node);wrapped=true}tempNode=node;node=node.nextSibling;rootBlockNode.appendChild(tempNode)}else{rootBlockNode=null;node=node.nextSibling}}if(wrapped&&restoreSelection){if(rng.setStart){rng.setStart(startContainer,startOffset);rng.setEnd(endContainer,endOffset);selection.setRng(rng)}else{try{rng=editor.getDoc().body.createTextRange();rng.moveToElementText(rootNode);rng.collapse(true);rng.moveStart("character",startOffset);if(endOffset>0){rng.moveEnd("character",endOffset)}rng.select()}catch(ex){}}editor.nodeChanged()}}if(settings.forced_root_block){editor.on("NodeChange",addRootBlocks)}}});define("tinymce/EditorCommands",["tinymce/html/Serializer","tinymce/Env","tinymce/util/Tools"],function(Serializer,Env,Tools){var each=Tools.each,extend=Tools.extend;var map=Tools.map,inArray=Tools.inArray,explode=Tools.explode;var isGecko=Env.gecko,isIE=Env.ie;var TRUE=true,FALSE=false;return function(editor){var dom=editor.dom,selection=editor.selection,commands={state:{},exec:{},value:{}},settings=editor.settings,formatter=editor.formatter,bookmark;function execCommand(command,ui,value){var func;command=command.toLowerCase();if((func=commands.exec[command])){func(command,ui,value);return TRUE}return FALSE}function queryCommandState(command){var func;command=command.toLowerCase();if((func=commands.state[command])){return func(command)}return -1}function queryCommandValue(command){var func;command=command.toLowerCase();if((func=commands.value[command])){return func(command)}return FALSE}function addCommands(command_list,type){type=type||"exec";each(command_list,function(callback,command){each(command.toLowerCase().split(","),function(command){commands[type][command]=callback})})}extend(this,{execCommand:execCommand,queryCommandState:queryCommandState,queryCommandValue:queryCommandValue,addCommands:addCommands});function execNativeCommand(command,ui,value){if(ui===undefined){ui=FALSE}if(value===undefined){value=null}return editor.getDoc().execCommand(command,ui,value)}function isFormatMatch(name){return formatter.match(name)}function toggleFormat(name,value){formatter.toggle(name,value?{value:value}:undefined);editor.nodeChanged()}function storeSelection(type){bookmark=selection.getBookmark(type)}function restoreSelection(){selection.moveToBookmark(bookmark)}addCommands({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){editor.undoManager.add()},"Cut,Copy,Paste":function(command){var doc=editor.getDoc(),failed;try{execNativeCommand(command)}catch(ex){failed=TRUE}if(failed||!doc.queryCommandSupported(command)){var msg=editor.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");if(Env.mac){msg=msg.replace(/Ctrl\+/g,"\u2318+")}editor.windowManager.alert(msg)}},unlink:function(command){if(selection.isCollapsed()){var elm=selection.getNode();if(elm.tagName=="A"){editor.dom.remove(elm,true)}return}execNativeCommand(command);selection.collapse(FALSE)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(command){var align=command.substring(7);if(align=="full"){align="justify"}each("left,center,right,justify".split(","),function(name){if(align!=name){formatter.remove("align"+name)}});toggleFormat("align"+align);execCommand("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(command){var listElm,listParent;execNativeCommand(command);listElm=dom.getParent(selection.getNode(),"ol,ul");if(listElm){listParent=listElm.parentNode;if(/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)){storeSelection();dom.split(listParent,listElm);restoreSelection()}}},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){toggleFormat(command)},"ForeColor,HiliteColor,FontName":function(command,ui,value){toggleFormat(command,value)},FontSize:function(command,ui,value){var fontClasses,fontSizes;if(value>=1&&value<=7){fontSizes=explode(settings.font_size_style_values);fontClasses=explode(settings.font_size_classes);if(fontClasses){value=fontClasses[value-1]||value}else{value=fontSizes[value-1]||value}}toggleFormat(command,value)},RemoveFormat:function(command){formatter.remove(command)},mceBlockQuote:function(){toggleFormat("blockquote")},FormatBlock:function(command,ui,value){return toggleFormat(value||"p")},mceCleanup:function(){var bookmark=selection.getBookmark();editor.setContent(editor.getContent({cleanup:TRUE}),{cleanup:TRUE});selection.moveToBookmark(bookmark)},mceRemoveNode:function(command,ui,value){var node=value||selection.getNode();if(node!=editor.getBody()){storeSelection();editor.dom.remove(node,TRUE);restoreSelection()}},mceSelectNodeDepth:function(command,ui,value){var counter=0;dom.getParent(selection.getNode(),function(node){if(node.nodeType==1&&counter++==value){selection.select(node);return FALSE}},editor.getBody())},mceSelectNode:function(command,ui,value){selection.select(value)},mceInsertContent:function(command,ui,value){var parser,serializer,parentNode,rootNode,fragment,args;var marker,rng,node,node2,bookmarkHtml;function trimOrPaddLeftRight(html){var rng,container,offset;rng=selection.getRng(true);container=rng.startContainer;offset=rng.startOffset;function hasSiblingText(siblingName){return container[siblingName]&&container[siblingName].nodeType==3}if(container.nodeType==3){if(offset>0){html=html.replace(/^&nbsp;/," ")}else{if(!hasSiblingText("previousSibling")){html=html.replace(/^ /,"&nbsp;")}}if(offset<container.length){html=html.replace(/&nbsp;(<br>|)$/," ")}else{if(!hasSiblingText("nextSibling")){html=html.replace(/(&nbsp;| )(<br>|)$/,"&nbsp;")}}}return html}if(/^ | $/.test(value)){value=trimOrPaddLeftRight(value)}parser=editor.parser;serializer=new Serializer({},editor.schema);bookmarkHtml='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#200B;</span>';args={content:value,format:"html",selection:true};editor.fire("BeforeSetContent",args);value=args.content;if(value.indexOf("{$caret}")==-1){value+="{$caret}"}value=value.replace(/\{\$caret\}/,bookmarkHtml);rng=selection.getRng();var caretElement=rng.startContainer||(rng.parentElement?rng.parentElement():null);var body=editor.getBody();if(caretElement===body&&selection.isCollapsed()){if(dom.isBlock(body.firstChild)&&dom.isEmpty(body.firstChild)){rng=dom.createRng();rng.setStart(body.firstChild,0);rng.setEnd(body.firstChild,0);selection.setRng(rng)}}if(!selection.isCollapsed()){editor.getDoc().execCommand("Delete",false,null)}parentNode=selection.getNode();var parserArgs={context:parentNode.nodeName.toLowerCase()};fragment=parser.parse(value,parserArgs);node=fragment.lastChild;if(node.attr("id")=="mce_marker"){marker=node;for(node=node.prev;node;node=node.walk(true)){if(node.type==3||!dom.isBlock(node.name)){node.parent.insert(marker,node,node.name==="br");break}}}if(!parserArgs.invalid){value=serializer.serialize(fragment);node=parentNode.firstChild;node2=parentNode.lastChild;if(!node||(node===node2&&node.nodeName==="BR")){dom.setHTML(parentNode,value)}else{selection.setContent(value)}}else{selection.setContent(bookmarkHtml);parentNode=selection.getNode();rootNode=editor.getBody();if(parentNode.nodeType==9){parentNode=node=rootNode}else{node=parentNode}while(node!==rootNode){parentNode=node;node=node.parentNode}value=parentNode==rootNode?rootNode.innerHTML:dom.getOuterHTML(parentNode);value=serializer.serialize(parser.parse(value.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return serializer.serialize(fragment)})));if(parentNode==rootNode){dom.setHTML(rootNode,value)}else{dom.setOuterHTML(parentNode,value)}}marker=dom.get("mce_marker");selection.scrollIntoView(marker);rng=dom.createRng();node=marker.previousSibling;if(node&&node.nodeType==3){rng.setStart(node,node.nodeValue.length);if(!isIE){node2=marker.nextSibling;if(node2&&node2.nodeType==3){node.appendData(node2.data);node2.parentNode.removeChild(node2)}}}else{rng.setStartBefore(marker);rng.setEndBefore(marker)}dom.remove(marker);selection.setRng(rng);editor.fire("SetContent",args);editor.addVisual()},mceInsertRawHTML:function(command,ui,value){selection.setContent("tiny_mce_marker");editor.setContent(editor.getContent().replace(/tiny_mce_marker/g,function(){return value}))},mceToggleFormat:function(command,ui,value){toggleFormat(value)},mceSetContent:function(command,ui,value){editor.setContent(value)},"Indent,Outdent":function(command){var intentValue,indentUnit,value;intentValue=settings.indentation;indentUnit=/[a-z%]+$/i.exec(intentValue);intentValue=parseInt(intentValue,10);if(!queryCommandState("InsertUnorderedList")&&!queryCommandState("InsertOrderedList")){if(!settings.forced_root_block&&!dom.getParent(selection.getNode(),dom.isBlock)){formatter.apply("div")}each(selection.getSelectedBlocks(),function(element){var indentStyleName;if(element.nodeName!="LI"){indentStyleName=dom.getStyle(element,"direction",true)=="rtl"?"paddingRight":"paddingLeft";if(command=="outdent"){value=Math.max(0,parseInt(element.style[indentStyleName]||0,10)-intentValue);dom.setStyle(element,indentStyleName,value?value+indentUnit:"")}else{value=(parseInt(element.style[indentStyleName]||0,10)+intentValue)+indentUnit;dom.setStyle(element,indentStyleName,value)}}})}else{execNativeCommand(command)}},mceRepaint:function(){if(isGecko){try{storeSelection(TRUE);if(selection.getSel()){selection.getSel().selectAllChildren(editor.getBody())}selection.collapse(TRUE);restoreSelection()}catch(ex){}}},InsertHorizontalRule:function(){editor.execCommand("mceInsertContent",false,"<hr />")},mceToggleVisualAid:function(){editor.hasVisual=!editor.hasVisual;editor.addVisual()},mceReplaceContent:function(command,ui,value){editor.execCommand("mceInsertContent",false,value.replace(/\{\$selection\}/g,selection.getContent({format:"text"})))},mceInsertLink:function(command,ui,value){var anchor;if(typeof(value)=="string"){value={href:value}}anchor=dom.getParent(selection.getNode(),"a");value.href=value.href.replace(" ","%20");if(!anchor||!value.href){formatter.remove("link")}if(value.href){formatter.apply("link",value,anchor)}},selectAll:function(){var root=dom.getRoot(),rng;if(selection.getRng().setStart){rng=dom.createRng();rng.setStart(root,0);rng.setEnd(root,root.childNodes.length);selection.setRng(rng)}else{rng=selection.getRng();if(!rng.item){rng.moveToElementText(root);rng.select()}}},"delete":function(){execNativeCommand("Delete");var body=editor.getBody();if(dom.isEmpty(body)){editor.setContent("");if(body.firstChild&&dom.isBlock(body.firstChild)){editor.selection.setCursorLocation(body.firstChild,0)}else{editor.selection.setCursorLocation(body,0)}}},mceNewDocument:function(){editor.setContent("")}});addCommands({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(command){var name="align"+command.substring(7);var nodes=selection.isCollapsed()?[dom.getParent(selection.getNode(),dom.isBlock)]:selection.getSelectedBlocks();var matches=map(nodes,function(node){return !!formatter.matchNode(node,name)});return inArray(matches,TRUE)!==-1},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(command){return isFormatMatch(command)},mceBlockQuote:function(){return isFormatMatch("blockquote")},Outdent:function(){var node;if(settings.inline_styles){if((node=dom.getParent(selection.getStart(),dom.isBlock))&&parseInt(node.style.paddingLeft,10)>0){return TRUE}if((node=dom.getParent(selection.getEnd(),dom.isBlock))&&parseInt(node.style.paddingLeft,10)>0){return TRUE}}return(queryCommandState("InsertUnorderedList")||queryCommandState("InsertOrderedList")||(!settings.inline_styles&&!!dom.getParent(selection.getNode(),"BLOCKQUOTE")))},"InsertUnorderedList,InsertOrderedList":function(command){var list=dom.getParent(selection.getNode(),"ul,ol");return list&&(command==="insertunorderedlist"&&list.tagName==="UL"||command==="insertorderedlist"&&list.tagName==="OL")}},"state");addCommands({"FontSize,FontName":function(command){var value=0,parent;if((parent=dom.getParent(selection.getNode(),"span"))){if(command=="fontsize"){value=parent.style.fontSize}else{value=parent.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase()}}return value}},"value");addCommands({Undo:function(){editor.undoManager.undo()},Redo:function(){editor.undoManager.redo()}})}});define("tinymce/util/URI",["tinymce/util/Tools"],function(Tools){var each=Tools.each,trim=Tools.trim;function URI(url,settings){var self=this,baseUri,base_url;url=trim(url);settings=self.settings=settings||{};if(/^([\w\-]+):([^\/]{2})/i.test(url)||/^\s*#/.test(url)){self.source=url;return}var isProtocolRelative=url.indexOf("//")===0;if(url.indexOf("/")===0&&!isProtocolRelative){url=(settings.base_uri?settings.base_uri.protocol||"http":"http")+"://mce_host"+url}if(!/^[\w\-]*:?\/\//.test(url)){base_url=settings.base_uri?settings.base_uri.path:new URI(location.href).directory;if(settings.base_uri.protocol===""){url="//mce_host"+self.toAbsPath(base_url,url)}else{url=((settings.base_uri&&settings.base_uri.protocol)||"http")+"://mce_host"+self.toAbsPath(base_url,url)}}url=url.replace(/@@/g,"(mce_at)");url=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(url);each(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(v,i){var part=url[i];if(part){part=part.replace(/\(mce_at\)/g,"@@")}self[v]=part});baseUri=settings.base_uri;if(baseUri){if(!self.protocol){self.protocol=baseUri.protocol}if(!self.userInfo){self.userInfo=baseUri.userInfo}if(!self.port&&self.host==="mce_host"){self.port=baseUri.port}if(!self.host||self.host==="mce_host"){self.host=baseUri.host}self.source=""}if(isProtocolRelative){self.protocol=""}}URI.prototype={setPath:function(path){var self=this;path=/^(.*?)\/?(\w+)?$/.exec(path);self.path=path[0];self.directory=path[1];self.file=path[2];self.source="";self.getURI()},toRelative:function(uri){var self=this,output;if(uri==="./"){return uri}uri=new URI(uri,{base_uri:self});if((uri.host!="mce_host"&&self.host!=uri.host&&uri.host)||self.port!=uri.port||(self.protocol!=uri.protocol&&uri.protocol!=="")){return uri.getURI()}var tu=self.getURI(),uu=uri.getURI();if(tu==uu||(tu.charAt(tu.length-1)=="/"&&tu.substr(0,tu.length-1)==uu)){return tu}output=self.toRelPath(self.path,uri.path);if(uri.query){output+="?"+uri.query}if(uri.anchor){output+="#"+uri.anchor}return output},toAbsolute:function(uri,noHost){uri=new URI(uri,{base_uri:this});return uri.getURI(this.host==uri.host&&this.protocol==uri.protocol?noHost:0)},toRelPath:function(base,path){var items,breakPoint=0,out="",i,l;base=base.substring(0,base.lastIndexOf("/"));base=base.split("/");items=path.split("/");if(base.length>=items.length){for(i=0,l=base.length;i<l;i++){if(i>=items.length||base[i]!=items[i]){breakPoint=i+1;break}}}if(base.length<items.length){for(i=0,l=items.length;i<l;i++){if(i>=base.length||base[i]!=items[i]){breakPoint=i+1;break}}}if(breakPoint===1){return path}for(i=0,l=base.length-(breakPoint-1);i<l;i++){out+="../"}for(i=breakPoint-1,l=items.length;i<l;i++){if(i!=breakPoint-1){out+="/"+items[i]}else{out+=items[i]}}return out},toAbsPath:function(base,path){var i,nb=0,o=[],tr,outPath;tr=/\/$/.test(path)?"/":"";base=base.split("/");path=path.split("/");each(base,function(k){if(k){o.push(k)}});base=o;for(i=path.length-1,o=[];i>=0;i--){if(path[i].length===0||path[i]==="."){continue}if(path[i]===".."){nb++;continue}if(nb>0){nb--;continue}o.push(path[i])}i=base.length-nb;if(i<=0){outPath=o.reverse().join("/")}else{outPath=base.slice(0,i).join("/")+"/"+o.reverse().join("/")}if(outPath.indexOf("/")!==0){outPath="/"+outPath}if(tr&&outPath.lastIndexOf("/")!==outPath.length-1){outPath+=tr}return outPath},getURI:function(noProtoHost){var s,self=this;if(!self.source||noProtoHost){s="";if(!noProtoHost){if(self.protocol){s+=self.protocol+"://"}else{s+="//"}if(self.userInfo){s+=self.userInfo+"@"}if(self.host){s+=self.host}if(self.port){s+=":"+self.port}}if(self.path){s+=self.path}if(self.query){s+="?"+self.query}if(self.anchor){s+="#"+self.anchor}self.source=s}return self.source}};return URI});define("tinymce/util/Class",["tinymce/util/Tools"],function(Tools){var each=Tools.each,extend=Tools.extend;var extendClass,initializing;function Class(){}Class.extend=extendClass=function(prop){var Self=this,_super=Self.prototype,prototype,name,member;function Class(){var i,mixins,mixin,self;if(!initializing){self=this;if(self.init){self.init.apply(self,arguments)}mixins=self.Mixins;if(mixins){i=mixins.length;while(i--){mixin=mixins[i];if(mixin.init){mixin.init.apply(self,arguments)}}}}}function dummy(){return this}function createMethod(name,fn){return function(){var self=this,tmp=self._super,ret;self._super=_super[name];ret=fn.apply(self,arguments);self._super=tmp;return ret}}initializing=true;prototype=new Self();initializing=false;if(prop.Mixins){each(prop.Mixins,function(mixin){mixin=mixin;for(var name in mixin){if(name!=="init"){prop[name]=mixin[name]}}});if(_super.Mixins){prop.Mixins=_super.Mixins.concat(prop.Mixins)}}if(prop.Methods){each(prop.Methods.split(","),function(name){prop[name]=dummy})}if(prop.Properties){each(prop.Properties.split(","),function(name){var fieldName="_"+name;prop[name]=function(value){var self=this,undef;if(value!==undef){self[fieldName]=value;return self}return self[fieldName]}})}if(prop.Statics){each(prop.Statics,function(func,name){Class[name]=func})}if(prop.Defaults&&_super.Defaults){prop.Defaults=extend({},_super.Defaults,prop.Defaults)}for(name in prop){member=prop[name];if(typeof member=="function"&&_super[name]){prototype[name]=createMethod(name,member)}else{prototype[name]=member}}Class.prototype=prototype;Class.constructor=Class;Class.extend=extendClass;return Class};return Class});define("tinymce/ui/Selector",["tinymce/util/Class"],function(Class){function unique(array){var uniqueItems=[],i=array.length,item;while(i--){item=array[i];if(!item.__checked){uniqueItems.push(item);item.__checked=1}}i=uniqueItems.length;while(i--){delete uniqueItems[i].__checked}return uniqueItems}var expression=/^([\w\\*]+)?(?:#([\w\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i;var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,whiteSpace=/^\s*|\s*$/g,Collection;var Selector=Class.extend({init:function(selector){var match=this.match;function compileNameFilter(name){if(name){name=name.toLowerCase();return function(item){return name==="*"||item.type===name}}}function compileIdFilter(id){if(id){return function(item){return item._name===id}}}function compileClassesFilter(classes){if(classes){classes=classes.split(".");return function(item){var i=classes.length;while(i--){if(!item.hasClass(classes[i])){return false}}return true}}}function compileAttrFilter(name,cmp,check){if(name){return function(item){var value=item[name]?item[name]():"";return !cmp?!!check:cmp==="="?value===check:cmp==="*="?value.indexOf(check)>=0:cmp==="~="?(" "+value+" ").indexOf(" "+check+" ")>=0:cmp==="!="?value!=check:cmp==="^="?value.indexOf(check)===0:cmp==="$="?value.substr(value.length-check.length)===check:false}}}function compilePsuedoFilter(name){var notSelectors;if(name){name=/(?:not\((.+)\))|(.+)/i.exec(name);if(!name[1]){name=name[2];return function(item,index,length){return name==="first"?index===0:name==="last"?index===length-1:name==="even"?index%2===0:name==="odd"?index%2===1:item[name]?item[name]():false}}else{notSelectors=parseChunks(name[1],[]);return function(item){return !match(item,notSelectors)}}}}function compile(selector,filters,direct){var parts;function add(filter){if(filter){filters.push(filter)}}parts=expression.exec(selector.replace(whiteSpace,""));add(compileNameFilter(parts[1]));add(compileIdFilter(parts[2]));add(compileClassesFilter(parts[3]));add(compileAttrFilter(parts[4],parts[5],parts[6]));add(compilePsuedoFilter(parts[7]));filters.psuedo=!!parts[7];filters.direct=direct;return filters}function parseChunks(selector,selectors){var parts=[],extra,matches,i;do{chunker.exec("");matches=chunker.exec(selector);if(matches){selector=matches[3];parts.push(matches[1]);if(matches[2]){extra=matches[3];break}}}while(matches);if(extra){parseChunks(extra,selectors)}selector=[];for(i=0;i<parts.length;i++){if(parts[i]!=">"){selector.push(compile(parts[i],[],parts[i-1]===">"))}}selectors.push(selector);return selectors}this._selectors=parseChunks(selector,[])},match:function(control,selectors){var i,l,si,sl,selector,fi,fl,filters,index,length,siblings,count,item;selectors=selectors||this._selectors;for(i=0,l=selectors.length;i<l;i++){selector=selectors[i];sl=selector.length;item=control;count=0;for(si=sl-1;si>=0;si--){filters=selector[si];while(item){if(filters.psuedo){siblings=item.parent().items();index=length=siblings.length;while(index--){if(siblings[index]===item){break}}}for(fi=0,fl=filters.length;fi<fl;fi++){if(!filters[fi](item,index,length)){fi=fl+1;break}}if(fi===fl){count++;break}else{if(si===sl-1){break}}item=item.parent()}}if(count===sl){return true}}return false},find:function(container){var matches=[],i,l,selectors=this._selectors;function collect(items,selector,index){var i,l,fi,fl,item,filters=selector[index];for(i=0,l=items.length;i<l;i++){item=items[i];for(fi=0,fl=filters.length;fi<fl;fi++){if(!filters[fi](item,i,l)){fi=fl+1;break}}if(fi===fl){if(index==selector.length-1){matches.push(item)}else{if(item.items){collect(item.items(),selector,index+1)}}}else{if(filters.direct){return}}if(item.items){collect(item.items(),selector,index)}}}if(container.items){for(i=0,l=selectors.length;i<l;i++){collect(container.items(),selectors[i],0)}if(l>1){matches=unique(matches)}}if(!Collection){Collection=Selector.Collection}return new Collection(matches)}});return Selector});define("tinymce/ui/Collection",["tinymce/util/Tools","tinymce/ui/Selector","tinymce/util/Class"],function(Tools,Selector,Class){var Collection,proto,push=Array.prototype.push,slice=Array.prototype.slice;proto={length:0,init:function(items){if(items){this.add(items)}},add:function(items){var self=this;if(!Tools.isArray(items)){if(items instanceof Collection){self.add(items.toArray())}else{push.call(self,items)}}else{push.apply(self,items)}return self},set:function(items){var self=this,len=self.length,i;self.length=0;self.add(items);for(i=self.length;i<len;i++){delete self[i]}return self},filter:function(selector){var self=this,i,l,matches=[],item,match;if(typeof(selector)==="string"){selector=new Selector(selector);match=function(item){return selector.match(item)}}else{match=selector}for(i=0,l=self.length;i<l;i++){item=self[i];if(match(item)){matches.push(item)}}return new Collection(matches)},slice:function(){return new Collection(slice.apply(this,arguments))},eq:function(index){return index===-1?this.slice(index):this.slice(index,+index+1)},each:function(callback){Tools.each(this,callback);return this},toArray:function(){return Tools.toArray(this)},indexOf:function(ctrl){var self=this,i=self.length;while(i--){if(self[i]===ctrl){break}}return i},reverse:function(){return new Collection(Tools.toArray(this).reverse())},hasClass:function(cls){return this[0]?this[0].hasClass(cls):false},prop:function(name,value){var self=this,undef,item;if(value!==undef){self.each(function(item){if(item[name]){item[name](value)}});return self}item=self[0];if(item&&item[name]){return item[name]()}},exec:function(name){var self=this,args=Tools.toArray(arguments).slice(1);self.each(function(item){if(item[name]){item[name].apply(item,args)}});return self},remove:function(){var i=this.length;while(i--){this[i].remove()}return this}};Tools.each("fire on off show hide addClass removeClass append prepend before after reflow".split(" "),function(name){proto[name]=function(){var args=Tools.toArray(arguments);this.each(function(ctrl){if(name in ctrl){ctrl[name].apply(ctrl,args)}});return this}});Tools.each("text name disabled active selected checked visible parent value data".split(" "),function(name){proto[name]=function(value){return this.prop(name,value)}});Collection=Class.extend(proto);Selector.Collection=Collection;return Collection});define("tinymce/ui/DomUtils",["tinymce/util/Tools","tinymce/dom/DOMUtils"],function(Tools,DOMUtils){return{id:function(){return DOMUtils.DOM.uniqueId()},createFragment:function(html){return DOMUtils.DOM.createFragment(html)},getWindowSize:function(){return DOMUtils.DOM.getViewPort()},getSize:function(elm){var width,height;if(elm.getBoundingClientRect){var rect=elm.getBoundingClientRect();width=Math.max(rect.width||(rect.right-rect.left),elm.offsetWidth);height=Math.max(rect.height||(rect.bottom-rect.bottom),elm.offsetHeight)}else{width=elm.offsetWidth;height=elm.offsetHeight}return{width:width,height:height}},getPos:function(elm,root){return DOMUtils.DOM.getPos(elm,root)},getViewPort:function(win){return DOMUtils.DOM.getViewPort(win)},get:function(id){return document.getElementById(id)},addClass:function(elm,cls){return DOMUtils.DOM.addClass(elm,cls)},removeClass:function(elm,cls){return DOMUtils.DOM.removeClass(elm,cls)},hasClass:function(elm,cls){return DOMUtils.DOM.hasClass(elm,cls)},toggleClass:function(elm,cls,state){return DOMUtils.DOM.toggleClass(elm,cls,state)},css:function(elm,name,value){return DOMUtils.DOM.setStyle(elm,name,value)},on:function(target,name,callback,scope){return DOMUtils.DOM.bind(target,name,callback,scope)},off:function(target,name,callback){return DOMUtils.DOM.unbind(target,name,callback)},fire:function(target,name,args){return DOMUtils.DOM.fire(target,name,args)},innerHtml:function(elm,html){DOMUtils.DOM.setHTML(elm,html)}}});define("tinymce/ui/Control",["tinymce/util/Class","tinymce/util/Tools","tinymce/ui/Collection","tinymce/ui/DomUtils"],function(Class,Tools,Collection,DomUtils){var nativeEvents=Tools.makeMap("focusin focusout scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave wheel keydown keypress keyup contextmenu"," ");var elementIdCache={};var hasMouseWheelEventSupport="onmousewheel" in document;var hasWheelEventSupport=false;var Control=Class.extend({Statics:{controlIdLookup:{},elementIdCache:elementIdCache},isRtl:function(){return Control.rtl},classPrefix:"mce-",init:function(settings){var self=this,classes,i;self.settings=settings=Tools.extend({},self.Defaults,settings);self._id=DomUtils.id();self._text=self._name="";self._width=self._height=0;self._aria={role:settings.role};classes=settings.classes;if(classes){classes=classes.split(" ");classes.map={};i=classes.length;while(i--){classes.map[classes[i]]=true}}self._classes=classes||[];self.visible(true);Tools.each("title text width height name classes visible disabled active value".split(" "),function(name){var value=settings[name],undef;if(value!==undef){self[name](value)}else{if(self["_"+name]===undef){self["_"+name]=false}}});self.on("click",function(){if(self.disabled()){return false}});if(settings.classes){Tools.each(settings.classes.split(" "),function(cls){self.addClass(cls)})}self.settings=settings;self._borderBox=self.parseBox(settings.border);self._paddingBox=self.parseBox(settings.padding);self._marginBox=self.parseBox(settings.margin);if(settings.hidden){self.hide()}},Properties:"parent,title,text,width,height,disabled,active,name,value",Methods:"renderHtml",getContainerElm:function(){return document.body},getParentCtrl:function(elm){var ctrl;while(elm){ctrl=Control.controlIdLookup[elm.id];if(ctrl){break}elm=elm.parentNode}return ctrl},parseBox:function(value){var len,radix=10;if(!value){return}if(typeof(value)==="number"){value=value||0;return{top:value,left:value,bottom:value,right:value}}value=value.split(" ");len=value.length;if(len===1){value[1]=value[2]=value[3]=value[0]}else{if(len===2){value[2]=value[0];value[3]=value[1]}else{if(len===3){value[3]=value[1]}}}return{top:parseInt(value[0],radix)||0,right:parseInt(value[1],radix)||0,bottom:parseInt(value[2],radix)||0,left:parseInt(value[3],radix)||0}},borderBox:function(){return this._borderBox},paddingBox:function(){return this._paddingBox},marginBox:function(){return this._marginBox},measureBox:function(elm,prefix){function getStyle(name){var defaultView=document.defaultView;if(defaultView){name=name.replace(/[A-Z]/g,function(a){return"-"+a});return defaultView.getComputedStyle(elm,null).getPropertyValue(name)}return elm.currentStyle[name]}function getSide(name){var val=parseFloat(getStyle(name),10);return isNaN(val)?0:val}return{top:getSide(prefix+"TopWidth"),right:getSide(prefix+"RightWidth"),bottom:getSide(prefix+"BottomWidth"),left:getSide(prefix+"LeftWidth")}},initLayoutRect:function(){var self=this,settings=self.settings,borderBox,layoutRect;var elm=self.getEl(),width,height,minWidth,minHeight,autoResize;var startMinWidth,startMinHeight,initialSize;borderBox=self._borderBox=self._borderBox||self.measureBox(elm,"border");self._paddingBox=self._paddingBox||self.measureBox(elm,"padding");self._marginBox=self._marginBox||self.measureBox(elm,"margin");initialSize=DomUtils.getSize(elm);startMinWidth=settings.minWidth;startMinHeight=settings.minHeight;minWidth=startMinWidth||initialSize.width;minHeight=startMinHeight||initialSize.height;width=settings.width;height=settings.height;autoResize=settings.autoResize;autoResize=typeof(autoResize)!="undefined"?autoResize:!width&&!height;width=width||minWidth;height=height||minHeight;var deltaW=borderBox.left+borderBox.right;var deltaH=borderBox.top+borderBox.bottom;var maxW=settings.maxWidth||65535;var maxH=settings.maxHeight||65535;self._layoutRect=layoutRect={x:settings.x||0,y:settings.y||0,w:width,h:height,deltaW:deltaW,deltaH:deltaH,contentW:width-deltaW,contentH:height-deltaH,innerW:width-deltaW,innerH:height-deltaH,startMinWidth:startMinWidth||0,startMinHeight:startMinHeight||0,minW:Math.min(minWidth,maxW),minH:Math.min(minHeight,maxH),maxW:maxW,maxH:maxH,autoResize:autoResize,scrollW:0};self._lastLayoutRect={};return layoutRect},layoutRect:function(newRect){var self=this,curRect=self._layoutRect,lastLayoutRect,size,deltaWidth,deltaHeight,undef,repaintControls;if(!curRect){curRect=self.initLayoutRect()}if(newRect){deltaWidth=curRect.deltaW;deltaHeight=curRect.deltaH;if(newRect.x!==undef){curRect.x=newRect.x}if(newRect.y!==undef){curRect.y=newRect.y}if(newRect.minW!==undef){curRect.minW=newRect.minW}if(newRect.minH!==undef){curRect.minH=newRect.minH}size=newRect.w;if(size!==undef){size=size<curRect.minW?curRect.minW:size;size=size>curRect.maxW?curRect.maxW:size;curRect.w=size;curRect.innerW=size-deltaWidth}size=newRect.h;if(size!==undef){size=size<curRect.minH?curRect.minH:size;size=size>curRect.maxH?curRect.maxH:size;curRect.h=size;curRect.innerH=size-deltaHeight}size=newRect.innerW;if(size!==undef){size=size<curRect.minW-deltaWidth?curRect.minW-deltaWidth:size;size=size>curRect.maxW-deltaWidth?curRect.maxW-deltaWidth:size;curRect.innerW=size;curRect.w=size+deltaWidth}size=newRect.innerH;if(size!==undef){size=size<curRect.minH-deltaHeight?curRect.minH-deltaHeight:size;size=size>curRect.maxH-deltaHeight?curRect.maxH-deltaHeight:size;curRect.innerH=size;curRect.h=size+deltaHeight}if(newRect.contentW!==undef){curRect.contentW=newRect.contentW}if(newRect.contentH!==undef){curRect.contentH=newRect.contentH}lastLayoutRect=self._lastLayoutRect;if(lastLayoutRect.x!==curRect.x||lastLayoutRect.y!==curRect.y||lastLayoutRect.w!==curRect.w||lastLayoutRect.h!==curRect.h){repaintControls=Control.repaintControls;if(repaintControls){if(repaintControls.map&&!repaintControls.map[self._id]){repaintControls.push(self);repaintControls.map[self._id]=true}}lastLayoutRect.x=curRect.x;lastLayoutRect.y=curRect.y;lastLayoutRect.w=curRect.w;lastLayoutRect.h=curRect.h}return self}return curRect},repaint:function(){var self=this,style,bodyStyle,rect,borderBox,borderW=0,borderH=0,lastRepaintRect,round;round=!document.createRange?Math.round:function(value){return value};style=self.getEl().style;rect=self._layoutRect;lastRepaintRect=self._lastRepaintRect||{};borderBox=self._borderBox;borderW=borderBox.left+borderBox.right;borderH=borderBox.top+borderBox.bottom;if(rect.x!==lastRepaintRect.x){style.left=round(rect.x)+"px";lastRepaintRect.x=rect.x}if(rect.y!==lastRepaintRect.y){style.top=round(rect.y)+"px";lastRepaintRect.y=rect.y}if(rect.w!==lastRepaintRect.w){style.width=round(rect.w-borderW)+"px";lastRepaintRect.w=rect.w}if(rect.h!==lastRepaintRect.h){style.height=round(rect.h-borderH)+"px";lastRepaintRect.h=rect.h}if(self._hasBody&&rect.innerW!==lastRepaintRect.innerW){bodyStyle=self.getEl("body").style;bodyStyle.width=round(rect.innerW)+"px";lastRepaintRect.innerW=rect.innerW}if(self._hasBody&&rect.innerH!==lastRepaintRect.innerH){bodyStyle=bodyStyle||self.getEl("body").style;bodyStyle.height=round(rect.innerH)+"px";lastRepaintRect.innerH=rect.innerH}self._lastRepaintRect=lastRepaintRect;self.fire("repaint",{},false)},on:function(name,callback){var self=this,bindings,handlers,names,i;function resolveCallbackName(name){var callback,scope;return function(e){if(!callback){self.parents().each(function(ctrl){var callbacks=ctrl.settings.callbacks;if(callbacks&&(callback=callbacks[name])){scope=ctrl;return false}})}return callback.call(scope,e)}}if(callback){if(typeof(callback)=="string"){callback=resolveCallbackName(callback)}names=name.toLowerCase().split(" ");i=names.length;while(i--){name=names[i];bindings=self._bindings;if(!bindings){bindings=self._bindings={}}handlers=bindings[name];if(!handlers){handlers=bindings[name]=[]}handlers.push(callback);if(nativeEvents[name]){if(!self._nativeEvents){self._nativeEvents={name:true}}else{self._nativeEvents[name]=true}if(self._rendered){self.bindPendingEvents()}}}}return self},off:function(name,callback){var self=this,i,bindings=self._bindings,handlers,bindingName,names,hi;if(bindings){if(name){names=name.toLowerCase().split(" ");i=names.length;while(i--){name=names[i];handlers=bindings[name];if(!name){for(bindingName in bindings){bindings[bindingName].length=0}return self}if(handlers){if(!callback){handlers.length=0}else{hi=handlers.length;while(hi--){if(handlers[hi]===callback){handlers.splice(hi,1)}}}}}}else{self._bindings=[]}}return self},fire:function(name,args,bubble){var self=this,i,l,handlers,parentCtrl;name=name.toLowerCase();function returnFalse(){return false}function returnTrue(){return true}args=args||{};if(!args.type){args.type=name}if(!args.control){args.control=self}if(!args.preventDefault){args.preventDefault=function(){args.isDefaultPrevented=returnTrue};args.stopPropagation=function(){args.isPropagationStopped=returnTrue};args.stopImmediatePropagation=function(){args.isImmediatePropagationStopped=returnTrue};args.isDefaultPrevented=returnFalse;args.isPropagationStopped=returnFalse;args.isImmediatePropagationStopped=returnFalse}if(self._bindings){handlers=self._bindings[name];if(handlers){for(i=0,l=handlers.length;i<l;i++){if(!args.isImmediatePropagationStopped()&&handlers[i].call(self,args)===false){break}}}}if(bubble!==false){parentCtrl=self.parent();while(parentCtrl&&!args.isPropagationStopped()){parentCtrl.fire(name,args,false);parentCtrl=parentCtrl.parent()}}return args},hasEventListeners:function(name){return name in this._bindings},parents:function(selector){var ctrl=this,parents=new Collection();for(ctrl=ctrl.parent();ctrl;ctrl=ctrl.parent()){parents.add(ctrl)}if(selector){parents=parents.filter(selector)}return parents},next:function(){var parentControls=this.parent().items();return parentControls[parentControls.indexOf(this)+1]},prev:function(){var parentControls=this.parent().items();return parentControls[parentControls.indexOf(this)-1]},findCommonAncestor:function(ctrl1,ctrl2){var parentCtrl;while(ctrl1){parentCtrl=ctrl2;while(parentCtrl&&ctrl1!=parentCtrl){parentCtrl=parentCtrl.parent()}if(ctrl1==parentCtrl){break}ctrl1=ctrl1.parent()}return ctrl1},hasClass:function(cls,group){var classes=this._classes[group||"control"];cls=this.classPrefix+cls;return classes&&!!classes.map[cls]},addClass:function(cls,group){var self=this,classes,elm;cls=this.classPrefix+cls;classes=self._classes[group||"control"];if(!classes){classes=[];classes.map={};self._classes[group||"control"]=classes}if(!classes.map[cls]){classes.map[cls]=cls;classes.push(cls);if(self._rendered){elm=self.getEl(group);if(elm){elm.className=classes.join(" ")}}}return self},removeClass:function(cls,group){var self=this,classes,i,elm;cls=this.classPrefix+cls;classes=self._classes[group||"control"];if(classes&&classes.map[cls]){delete classes.map[cls];i=classes.length;while(i--){if(classes[i]===cls){classes.splice(i,1)}}}if(self._rendered){elm=self.getEl(group);if(elm){elm.className=classes.join(" ")}}return self},toggleClass:function(cls,state,group){var self=this;if(state){self.addClass(cls,group)}else{self.removeClass(cls,group)}return self},classes:function(group){var classes=this._classes[group||"control"];return classes?classes.join(" "):""},innerHtml:function(html){DomUtils.innerHtml(this.getEl(),html);return this},getEl:function(suffix,dropCache){var elm,id=suffix?this._id+"-"+suffix:this._id;elm=elementIdCache[id]=(dropCache===true?null:elementIdCache[id])||DomUtils.get(id);return elm},visible:function(state){var self=this,parentCtrl;if(typeof(state)!=="undefined"){if(self._visible!==state){if(self._rendered){self.getEl().style.display=state?"":"none"}self._visible=state;parentCtrl=self.parent();if(parentCtrl){parentCtrl._lastRect=null}self.fire(state?"show":"hide")}return self}return self._visible},show:function(){return this.visible(true)},hide:function(){return this.visible(false)},focus:function(){try{this.getEl().focus()}catch(ex){}return this},blur:function(){this.getEl().blur();return this},aria:function(name,value){var self=this,elm=self.getEl();if(typeof(value)==="undefined"){return self._aria[name]}else{self._aria[name]=value}if(self._rendered){if(name=="label"){elm.setAttribute("aria-labeledby",self._id)}elm.setAttribute(name=="role"?name:"aria-"+name,value)}return self},encode:function(text,translate){if(translate!==false&&Control.translate){text=Control.translate(text)}return(text||"").replace(/[&<>"]/g,function(match){return"&#"+match.charCodeAt(0)+";"})},before:function(items){var self=this,parent=self.parent();if(parent){parent.insert(items,parent.items().indexOf(self),true)}return self},after:function(items){var self=this,parent=self.parent();if(parent){parent.insert(items,parent.items().indexOf(self))}return self},remove:function(){var self=this,elm=self.getEl(),parent=self.parent(),newItems,i;if(self.items){var controls=self.items().toArray();i=controls.length;while(i--){controls[i].remove()}}if(parent&&parent.items){newItems=[];parent.items().each(function(item){if(item!==self){newItems.push(item)}});parent.items().set(newItems);parent._lastRect=null}if(self._eventsRoot&&self._eventsRoot==self){DomUtils.off(elm)}delete Control.controlIdLookup[self._id];delete elementIdCache[self._id];if(elm&&elm.parentNode){var nodes=elm.getElementsByTagName("*");i=nodes.length;while(i--){delete elementIdCache[nodes[i].id]}elm.parentNode.removeChild(elm)}return self},renderBefore:function(elm){var self=this;elm.parentNode.insertBefore(DomUtils.createFragment(self.renderHtml()),elm);self.postRender();return self},renderTo:function(elm){var self=this;elm=elm||self.getContainerElm();elm.appendChild(DomUtils.createFragment(self.renderHtml()));self.postRender();return self},postRender:function(){var self=this,settings=self.settings,elm,box,parent,name,parentEventsRoot;for(name in settings){if(name.indexOf("on")===0){self.on(name.substr(2),settings[name])}}if(self._eventsRoot){for(parent=self.parent();!parentEventsRoot&&parent;parent=parent.parent()){parentEventsRoot=parent._eventsRoot}if(parentEventsRoot){for(name in parentEventsRoot._nativeEvents){self._nativeEvents[name]=true}}}self.bindPendingEvents();if(settings.style){elm=self.getEl();if(elm){elm.setAttribute("style",settings.style);elm.style.cssText=settings.style}}if(!self._visible){DomUtils.css(self.getEl(),"display","none")}if(self.settings.border){box=self.borderBox();DomUtils.css(self.getEl(),{"border-top-width":box.top,"border-right-width":box.right,"border-bottom-width":box.bottom,"border-left-width":box.left})}Control.controlIdLookup[self._id]=self;for(var key in self._aria){self.aria(key,self._aria[key])}self.fire("postrender",{},false)},scrollIntoView:function(align){function getOffset(elm,rootElm){var x,y,parent=elm;x=y=0;while(parent&&parent!=rootElm&&parent.nodeType){x+=parent.offsetLeft||0;y+=parent.offsetTop||0;parent=parent.offsetParent}return{x:x,y:y}}var elm=this.getEl(),parentElm=elm.parentNode;var x,y,width,height,parentWidth,parentHeight;var pos=getOffset(elm,parentElm);x=pos.x;y=pos.y;width=elm.offsetWidth;height=elm.offsetHeight;parentWidth=parentElm.clientWidth;parentHeight=parentElm.clientHeight;if(align=="end"){x-=parentWidth-width;y-=parentHeight-height}else{if(align=="center"){x-=(parentWidth/2)-(width/2);y-=(parentHeight/2)-(height/2)}}parentElm.scrollLeft=x;parentElm.scrollTop=y;return this},bindPendingEvents:function(){var self=this,i,l,parents,eventRootCtrl,nativeEvents,name;function delegate(e){var control=self.getParentCtrl(e.target);if(control){control.fire(e.type,e)}}function mouseLeaveHandler(){var ctrl=eventRootCtrl._lastHoverCtrl;if(ctrl){ctrl.fire("mouseleave",{target:ctrl.getEl()});ctrl.parents().each(function(ctrl){ctrl.fire("mouseleave",{target:ctrl.getEl()})});eventRootCtrl._lastHoverCtrl=null}}function mouseEnterHandler(e){var ctrl=self.getParentCtrl(e.target),lastCtrl=eventRootCtrl._lastHoverCtrl,idx=0,i,parents,lastParents;if(ctrl!==lastCtrl){eventRootCtrl._lastHoverCtrl=ctrl;parents=ctrl.parents().toArray().reverse();parents.push(ctrl);if(lastCtrl){lastParents=lastCtrl.parents().toArray().reverse();lastParents.push(lastCtrl);for(idx=0;idx<lastParents.length;idx++){if(parents[idx]!==lastParents[idx]){break}}for(i=lastParents.length-1;i>=idx;i--){lastCtrl=lastParents[i];lastCtrl.fire("mouseleave",{target:lastCtrl.getEl()})}}for(i=idx;i<parents.length;i++){ctrl=parents[i];ctrl.fire("mouseenter",{target:ctrl.getEl()})}}}function fixWheelEvent(e){e.preventDefault();if(e.type=="mousewheel"){e.deltaY=-1/40*e.wheelDelta;if(e.wheelDeltaX){e.deltaX=-1/40*e.wheelDeltaX}}else{e.deltaX=0;e.deltaY=e.detail}e=self.fire("wheel",e)}self._rendered=true;nativeEvents=self._nativeEvents;if(nativeEvents){parents=self.parents().toArray();parents.unshift(self);for(i=0,l=parents.length;!eventRootCtrl&&i<l;i++){eventRootCtrl=parents[i]._eventsRoot}if(!eventRootCtrl){eventRootCtrl=parents[parents.length-1]||self}self._eventsRoot=eventRootCtrl;for(l=i,i=0;i<l;i++){parents[i]._eventsRoot=eventRootCtrl}for(name in nativeEvents){if(!nativeEvents){return false}if(name==="wheel"&&!hasWheelEventSupport){if(hasMouseWheelEventSupport){DomUtils.on(self.getEl(),"mousewheel",fixWheelEvent)}else{DomUtils.on(self.getEl(),"DOMMouseScroll",fixWheelEvent)}continue}if(name==="mouseenter"||name==="mouseleave"){if(!eventRootCtrl._hasMouseEnter){DomUtils.on(eventRootCtrl.getEl(),"mouseleave",mouseLeaveHandler);DomUtils.on(eventRootCtrl.getEl(),"mouseover",mouseEnterHandler);eventRootCtrl._hasMouseEnter=1}}else{if(!eventRootCtrl[name]){DomUtils.on(eventRootCtrl.getEl(),name,delegate);eventRootCtrl[name]=true}}nativeEvents[name]=false}}},reflow:function(){this.repaint();return this}});return Control});define("tinymce/ui/Factory",[],function(){var types={},namespaceInit;return{add:function(type,typeClass){types[type.toLowerCase()]=typeClass},has:function(type){return !!types[type.toLowerCase()]},create:function(type,settings){var ControlType,name,namespace;if(!namespaceInit){namespace=tinymce.ui;for(name in namespace){types[name.toLowerCase()]=namespace[name]}namespaceInit=true}if(typeof(type)=="string"){settings=settings||{};settings.type=type}else{settings=type;type=settings.type}type=type.toLowerCase();ControlType=types[type];if(!ControlType){throw new Error("Could not find control by type: "+type)}ControlType=new ControlType(settings);ControlType.type=type;return ControlType}}});define("tinymce/ui/Container",["tinymce/ui/Control","tinymce/ui/Collection","tinymce/ui/Selector","tinymce/ui/Factory","tinymce/util/Tools","tinymce/ui/DomUtils"],function(Control,Collection,Selector,Factory,Tools,DomUtils){var selectorCache={};return Control.extend({layout:"",innerClass:"container-inner",init:function(settings){var self=this;self._super(settings);settings=self.settings;self._fixed=settings.fixed;self._items=new Collection();if(self.isRtl()){self.addClass("rtl")}self.addClass("container");self.addClass("container-body","body");if(settings.containerCls){self.addClass(settings.containerCls)}self._layout=Factory.create((settings.layout||self.layout)+"layout");if(self.settings.items){self.add(self.settings.items)}self._hasBody=true},items:function(){return this._items},find:function(selector){selector=selectorCache[selector]=selectorCache[selector]||new Selector(selector);return selector.find(this)},add:function(items){var self=this;self.items().add(self.create(items)).parent(self);return self},focus:function(){var self=this;if(self.keyNav){self.keyNav.focusFirst()}else{self._super()}return self},replace:function(oldItem,newItem){var ctrlElm,items=this.items(),i=items.length;while(i--){if(items[i]===oldItem){items[i]=newItem;break}}if(i>=0){ctrlElm=newItem.getEl();if(ctrlElm){ctrlElm.parentNode.removeChild(ctrlElm)}ctrlElm=oldItem.getEl();if(ctrlElm){ctrlElm.parentNode.removeChild(ctrlElm)}}newItem.parent(this)},create:function(items){var self=this,settings,ctrlItems=[];if(!Tools.isArray(items)){items=[items]}Tools.each(items,function(item){if(item){if(!(item instanceof Control)){if(typeof(item)=="string"){item={type:item}}settings=Tools.extend({},self.settings.defaults,item);item.type=settings.type=settings.type||item.type||self.settings.defaultType||(settings.defaults?settings.defaults.type:null);item=Factory.create(settings)}ctrlItems.push(item)}});return ctrlItems},renderNew:function(){var self=this;self.items().each(function(ctrl,index){var containerElm,fragment;ctrl.parent(self);if(!ctrl._rendered){containerElm=self.getEl("body");fragment=DomUtils.createFragment(ctrl.renderHtml());if(containerElm.hasChildNodes()&&index<=containerElm.childNodes.length-1){containerElm.insertBefore(fragment,containerElm.childNodes[index])}else{containerElm.appendChild(fragment)}ctrl.postRender()}});self._layout.applyClasses(self);self._lastRect=null;return self},append:function(items){return this.add(items).renderNew()},prepend:function(items){var self=this;self.items().set(self.create(items).concat(self.items().toArray()));return self.renderNew()},insert:function(items,index,before){var self=this,curItems,beforeItems,afterItems;items=self.create(items);curItems=self.items();if(!before&&index<curItems.length-1){index+=1}if(index>=0&&index<curItems.length){beforeItems=curItems.slice(0,index).toArray();afterItems=curItems.slice(index).toArray();curItems.set(beforeItems.concat(items,afterItems))}return self.renderNew()},fromJSON:function(data){var self=this;for(var name in data){self.find("#"+name).value(data[name])}return self},toJSON:function(){var self=this,data={};self.find("*").each(function(ctrl){var name=ctrl.name(),value=ctrl.value();if(name&&typeof(value)!="undefined"){data[name]=value}});return data},preRender:function(){},renderHtml:function(){var self=this,layout=self._layout;self.preRender();layout.preRender(self);return('<div id="'+self._id+'" class="'+self.classes()+'" role="'+this.settings.role+'"><div id="'+self._id+'-body" class="'+self.classes("body")+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></div>")},postRender:function(){var self=this,box;self.items().exec("postRender");self._super();self._layout.postRender(self);self._rendered=true;if(self.settings.style){DomUtils.css(self.getEl(),self.settings.style)}if(self.settings.border){box=self.borderBox();DomUtils.css(self.getEl(),{"border-top-width":box.top,"border-right-width":box.right,"border-bottom-width":box.bottom,"border-left-width":box.left})}return self},initLayoutRect:function(){var self=this,layoutRect=self._super();self._layout.recalc(self);return layoutRect},recalc:function(){var self=this,rect=self._layoutRect,lastRect=self._lastRect;if(!lastRect||lastRect.w!=rect.w||lastRect.h!=rect.h){self._layout.recalc(self);rect=self.layoutRect();self._lastRect={x:rect.x,y:rect.y,w:rect.w,h:rect.h};return true}},reflow:function(){var i,items;if(this.visible()){Control.repaintControls=[];Control.repaintControls.map={};items=this.recalc();i=Control.repaintControls.length;while(i--){Control.repaintControls[i].repaint()}if(this.settings.layout!=="flow"&&this.settings.layout!=="stack"){this.repaint()}Control.repaintControls=[]}return this}})});define("tinymce/ui/DragHelper",["tinymce/ui/DomUtils"],function(DomUtils){function getDocumentSize(){var doc=document,documentElement,body,scrollWidth,clientWidth;var offsetWidth,scrollHeight,clientHeight,offsetHeight,max=Math.max;documentElement=doc.documentElement;body=doc.body;scrollWidth=max(documentElement.scrollWidth,body.scrollWidth);clientWidth=max(documentElement.clientWidth,body.clientWidth);offsetWidth=max(documentElement.offsetWidth,body.offsetWidth);scrollHeight=max(documentElement.scrollHeight,body.scrollHeight);clientHeight=max(documentElement.clientHeight,body.clientHeight);offsetHeight=max(documentElement.offsetHeight,body.offsetHeight);return{width:scrollWidth<offsetWidth?clientWidth:scrollWidth,height:scrollHeight<offsetHeight?clientHeight:scrollHeight}}return function(id,settings){var eventOverlayElm,doc=document,downButton,start,stop,drag,startX,startY;settings=settings||{};function getHandleElm(){return doc.getElementById(settings.handle||id)}start=function(e){var docSize=getDocumentSize(),handleElm,cursor;e.preventDefault();downButton=e.button;handleElm=getHandleElm();startX=e.screenX;startY=e.screenY;if(window.getComputedStyle){cursor=window.getComputedStyle(handleElm,null).getPropertyValue("cursor")}else{cursor=handleElm.runtimeStyle.cursor}eventOverlayElm=doc.createElement("div");DomUtils.css(eventOverlayElm,{position:"absolute",top:0,left:0,width:docSize.width,height:docSize.height,zIndex:2147483647,opacity:0.0001,background:"red",cursor:cursor});doc.body.appendChild(eventOverlayElm);DomUtils.on(doc,"mousemove",drag);DomUtils.on(doc,"mouseup",stop);settings.start(e)};drag=function(e){if(e.button!==downButton){return stop(e)}e.deltaX=e.screenX-startX;e.deltaY=e.screenY-startY;e.preventDefault();settings.drag(e)};stop=function(e){DomUtils.off(doc,"mousemove",drag);DomUtils.off(doc,"mouseup",stop);eventOverlayElm.parentNode.removeChild(eventOverlayElm);if(settings.stop){settings.stop(e)}};this.destroy=function(){DomUtils.off(getHandleElm())};DomUtils.on(getHandleElm(),"mousedown",start)}});define("tinymce/ui/Scrollable",["tinymce/ui/DomUtils","tinymce/ui/DragHelper"],function(DomUtils,DragHelper){return{init:function(){var self=this;self.on("repaint",self.renderScroll)},renderScroll:function(){var self=this,margin=2;function repaintScroll(){var hasScrollH,hasScrollV,bodyElm;function repaintAxis(axisName,posName,sizeName,contentSizeName,hasScroll,ax){var containerElm,scrollBarElm,scrollThumbElm;var containerSize,scrollSize,ratio,rect;var posNameLower,sizeNameLower;scrollBarElm=self.getEl("scroll"+axisName);if(scrollBarElm){posNameLower=posName.toLowerCase();sizeNameLower=sizeName.toLowerCase();if(self.getEl("absend")){DomUtils.css(self.getEl("absend"),posNameLower,self.layoutRect()[contentSizeName]-1)}if(!hasScroll){DomUtils.css(scrollBarElm,"display","none");return}DomUtils.css(scrollBarElm,"display","block");containerElm=self.getEl("body");scrollThumbElm=self.getEl("scroll"+axisName+"t");containerSize=containerElm["client"+sizeName]-(margin*2);containerSize-=hasScrollH&&hasScrollV?scrollBarElm["client"+ax]:0;scrollSize=containerElm["scroll"+sizeName];ratio=containerSize/scrollSize;rect={};rect[posNameLower]=containerElm["offset"+posName]+margin;rect[sizeNameLower]=containerSize;DomUtils.css(scrollBarElm,rect);rect={};rect[posNameLower]=containerElm["scroll"+posName]*ratio;rect[sizeNameLower]=containerSize*ratio;DomUtils.css(scrollThumbElm,rect)}}bodyElm=self.getEl("body");hasScrollH=bodyElm.scrollWidth>bodyElm.clientWidth;hasScrollV=bodyElm.scrollHeight>bodyElm.clientHeight;repaintAxis("h","Left","Width","contentW",hasScrollH,"Height");repaintAxis("v","Top","Height","contentH",hasScrollV,"Width")}function addScroll(){function addScrollAxis(axisName,posName,sizeName,deltaPosName,ax){var scrollStart,axisId=self._id+"-scroll"+axisName,prefix=self.classPrefix;self.getEl().appendChild(DomUtils.createFragment('<div id="'+axisId+'" class="'+prefix+"scrollbar "+prefix+"scrollbar-"+axisName+'"><div id="'+axisId+'t" class="'+prefix+'scrollbar-thumb"></div></div>'));self.draghelper=new DragHelper(axisId+"t",{start:function(){scrollStart=self.getEl("body")["scroll"+posName];DomUtils.addClass(DomUtils.get(axisId),prefix+"active")},drag:function(e){var ratio,hasScrollH,hasScrollV,containerSize,layoutRect=self.layoutRect();hasScrollH=layoutRect.contentW>layoutRect.innerW;hasScrollV=layoutRect.contentH>layoutRect.innerH;containerSize=self.getEl("body")["client"+sizeName]-(margin*2);containerSize-=hasScrollH&&hasScrollV?self.getEl("scroll"+axisName)["client"+ax]:0;ratio=containerSize/self.getEl("body")["scroll"+sizeName];self.getEl("body")["scroll"+posName]=scrollStart+(e["delta"+deltaPosName]/ratio)},stop:function(){DomUtils.removeClass(DomUtils.get(axisId),prefix+"active")}})}self.addClass("scroll");addScrollAxis("v","Top","Height","Y","Width");addScrollAxis("h","Left","Width","X","Height")}if(self.settings.autoScroll){if(!self._hasScroll){self._hasScroll=true;addScroll();self.on("wheel",function(e){var bodyEl=self.getEl("body");bodyEl.scrollLeft+=(e.deltaX||0)*10;bodyEl.scrollTop+=e.deltaY*10;repaintScroll()});DomUtils.on(self.getEl("body"),"scroll",repaintScroll)}repaintScroll()}}}});define("tinymce/ui/Panel",["tinymce/ui/Container","tinymce/ui/Scrollable"],function(Container,Scrollable){return Container.extend({Defaults:{layout:"fit",containerCls:"panel"},Mixins:[Scrollable],renderHtml:function(){var self=this,layout=self._layout,innerHtml=self.settings.html;self.preRender();layout.preRender(self);if(typeof(innerHtml)=="undefined"){innerHtml=('<div id="'+self._id+'-body" class="'+self.classes("body")+'">'+layout.renderHtml(self)+"</div>")}else{if(typeof(innerHtml)=="function"){innerHtml=innerHtml.call(self)}self._hasBody=false}return('<div id="'+self._id+'" class="'+self.classes()+'" hideFocus="1" tabIndex="-1">'+(self._preBodyHtml||"")+innerHtml+"</div>")}})});define("tinymce/ui/Movable",["tinymce/ui/DomUtils"],function(DomUtils){function calculateRelativePosition(ctrl,targetElm,rel){var ctrlElm,pos,x,y,selfW,selfH,targetW,targetH,viewport,size;viewport=DomUtils.getViewPort();pos=DomUtils.getPos(targetElm);x=pos.x;y=pos.y;if(ctrl._fixed){x-=viewport.x;y-=viewport.y}ctrlElm=ctrl.getEl();size=DomUtils.getSize(ctrlElm);selfW=size.width;selfH=size.height;size=DomUtils.getSize(targetElm);targetW=size.width;targetH=size.height;rel=(rel||"").split("");if(rel[0]==="b"){y+=targetH}if(rel[1]==="r"){x+=targetW}if(rel[0]==="c"){y+=Math.round(targetH/2)}if(rel[1]==="c"){x+=Math.round(targetW/2)}if(rel[3]==="b"){y-=selfH}if(rel[4]==="r"){x-=selfW}if(rel[3]==="c"){y-=Math.round(selfH/2)}if(rel[4]==="c"){x-=Math.round(selfW/2)}return{x:x,y:y,w:selfW,h:selfH}}return{testMoveRel:function(elm,rels){var viewPortRect=DomUtils.getViewPort();for(var i=0;i<rels.length;i++){var pos=calculateRelativePosition(this,elm,rels[i]);if(this._fixed){if(pos.x>0&&pos.x+pos.w<viewPortRect.w&&pos.y>0&&pos.y+pos.h<viewPortRect.h){return rels[i]}}else{if(pos.x>viewPortRect.x&&pos.x+pos.w<viewPortRect.w+viewPortRect.x&&pos.y>viewPortRect.y&&pos.y+pos.h<viewPortRect.h+viewPortRect.y){return rels[i]}}}return rels[0]},moveRel:function(elm,rel){if(typeof(rel)!="string"){rel=this.testMoveRel(elm,rel)}var pos=calculateRelativePosition(this,elm,rel);return this.moveTo(pos.x,pos.y)},moveBy:function(dx,dy){var self=this,rect=self.layoutRect();self.moveTo(rect.x+dx,rect.y+dy);return self},moveTo:function(x,y){var self=this;function contrain(value,max,size){if(value<0){return 0}if(value+size>max){value=max-size;return value<0?0:value}return value}if(self.settings.constrainToViewport){var viewPortRect=DomUtils.getViewPort(window);var layoutRect=self.layoutRect();x=contrain(x,viewPortRect.w+viewPortRect.x,layoutRect.w);y=contrain(y,viewPortRect.h+viewPortRect.y,layoutRect.h)}if(self._rendered){self.layoutRect({x:x,y:y}).repaint()}else{self.settings.x=x;self.settings.y=y}self.fire("move",{x:x,y:y});return self}}});define("tinymce/ui/Resizable",["tinymce/ui/DomUtils"],function(DomUtils){return{resizeToContent:function(){this._layoutRect.autoResize=true;this._lastRect=null;this.reflow()},resizeTo:function(w,h){if(w<=1||h<=1){var rect=DomUtils.getWindowSize();w=w<=1?w*rect.w:w;h=h<=1?h*rect.h:h}this._layoutRect.autoResize=false;return this.layoutRect({minW:w,minH:h,w:w,h:h}).reflow()},resizeBy:function(dw,dh){var self=this,rect=self.layoutRect();return self.resizeTo(rect.w+dw,rect.h+dh)}}});define("tinymce/ui/FloatPanel",["tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/DomUtils"],function(Panel,Movable,Resizable,DomUtils){var documentClickHandler,documentScrollHandler,visiblePanels=[];var zOrder=[],hasModal;var FloatPanel=Panel.extend({Mixins:[Movable,Resizable],init:function(settings){var self=this;function reorder(){var i,zIndex=FloatPanel.zIndex||65535,topModal;if(zOrder.length){for(i=0;i<zOrder.length;i++){if(zOrder[i].modal){zIndex++;topModal=zOrder[i]}zOrder[i].getEl().style.zIndex=zIndex;zOrder[i].zIndex=zIndex;zIndex++}}var modalBlockEl=document.getElementById(self.classPrefix+"modal-block");if(topModal){DomUtils.css(modalBlockEl,"z-index",topModal.zIndex-1)}else{if(modalBlockEl){modalBlockEl.parentNode.removeChild(modalBlockEl);hasModal=false}}FloatPanel.currentZIndex=zIndex}function isChildOf(ctrl,parent){while(ctrl){if(ctrl==parent){return true}ctrl=ctrl.parent()}}function repositionPanel(panel){var scrollY=DomUtils.getViewPort().y;function toggleFixedChildPanels(fixed,deltaY){var parent;for(var i=0;i<visiblePanels.length;i++){if(visiblePanels[i]!=panel){parent=visiblePanels[i].parent();while(parent&&(parent=parent.parent())){if(parent==panel){visiblePanels[i].fixed(fixed).moveBy(0,deltaY).repaint()}}}}}if(panel.settings.autofix){if(!panel._fixed){panel._autoFixY=panel.layoutRect().y;if(panel._autoFixY<scrollY){panel.fixed(true).layoutRect({y:0}).repaint();toggleFixedChildPanels(true,scrollY-panel._autoFixY)}}else{if(panel._autoFixY>scrollY){panel.fixed(false).layoutRect({y:panel._autoFixY}).repaint();toggleFixedChildPanels(false,panel._autoFixY-scrollY)}}}}self._super(settings);self._eventsRoot=self;self.addClass("floatpanel");if(settings.autohide){if(!documentClickHandler){documentClickHandler=function(e){var i,clickCtrl=self.getParentCtrl(e.target);i=visiblePanels.length;while(i--){var panel=visiblePanels[i];if(panel.settings.autohide){if(clickCtrl){if(isChildOf(clickCtrl,panel)||panel.parent()===clickCtrl){continue}}e=panel.fire("autohide",{target:e.target});if(!e.isDefaultPrevented()){panel.hide()}}}};DomUtils.on(document,"click",documentClickHandler)}visiblePanels.push(self)}if(settings.autofix){if(!documentScrollHandler){documentScrollHandler=function(){var i;i=visiblePanels.length;while(i--){repositionPanel(visiblePanels[i])}};DomUtils.on(window,"scroll",documentScrollHandler)}self.on("move",function(){repositionPanel(this)})}self.on("postrender show",function(e){if(e.control==self){var modalBlockEl,prefix=self.classPrefix;if(self.modal&&!hasModal){modalBlockEl=DomUtils.createFragment('<div id="'+prefix+'modal-block" class="'+prefix+"reset "+prefix+'fade"></div>');modalBlockEl=modalBlockEl.firstChild;self.getContainerElm().appendChild(modalBlockEl);setTimeout(function(){DomUtils.addClass(modalBlockEl,prefix+"in");DomUtils.addClass(self.getEl(),prefix+"in")},0);hasModal=true}zOrder.push(self);reorder()}});self.on("close hide",function(e){if(e.control==self){var i=zOrder.length;while(i--){if(zOrder[i]===self){zOrder.splice(i,1)}}reorder()}});self.on("show",function(){self.parents().each(function(ctrl){if(ctrl._fixed){self.fixed(true);return false}})});if(settings.popover){self._preBodyHtml='<div class="'+self.classPrefix+'arrow"></div>';self.addClass("popover").addClass("bottom").addClass(self.isRtl()?"end":"start")}},fixed:function(state){var self=this;if(self._fixed!=state){if(self._rendered){var viewport=DomUtils.getViewPort();if(state){self.layoutRect().y-=viewport.y}else{self.layoutRect().y+=viewport.y}}self.toggleClass("fixed",state);self._fixed=state}return self},show:function(){var self=this,i,state=self._super();i=visiblePanels.length;while(i--){if(visiblePanels[i]===self){break}}if(i===-1){visiblePanels.push(self)}return state},hide:function(){removeVisiblePanel(this);return this._super()},hideAll:function(){FloatPanel.hideAll()},close:function(){var self=this;self.fire("close");return self.remove()},remove:function(){removeVisiblePanel(this);this._super()}});FloatPanel.hideAll=function(){var i=visiblePanels.length;while(i--){var panel=visiblePanels[i];if(panel.settings.autohide){panel.fire("cancel",{},false);panel.hide();visiblePanels.splice(i,1)}}};function removeVisiblePanel(panel){var i;i=visiblePanels.length;while(i--){if(visiblePanels[i]===panel){visiblePanels.splice(i,1)}}i=zOrder.length;while(i--){if(zOrder[i]===panel){zOrder.splice(i,1)}}}return FloatPanel});define("tinymce/ui/KeyboardNavigation",["tinymce/ui/DomUtils"],function(DomUtils){return function(settings){var root=settings.root,enableUpDown=settings.enableUpDown!==false;var enableLeftRight=settings.enableLeftRight!==false;var items=settings.items,focussedId;function initItems(){if(!items){items=[];if(root.find){root.find("*").each(function(ctrl){if(ctrl.canFocus){items.push(ctrl.getEl())}})}else{var elements=root.getEl().getElementsByTagName("*");for(var i=0;i<elements.length;i++){if(elements[i].id&&elements[i]){items.push(elements[i])}}}}}function getFocusElement(){return document.getElementById(focussedId)}function getRole(elm){elm=elm||getFocusElement();return elm&&elm.getAttribute("role")}function getParentRole(elm){var role,parent=elm||getFocusElement();while((parent=parent.parentNode)){if((role=getRole(parent))){return role}}}function getAriaProp(name){var elm=document.getElementById(focussedId);if(elm){return elm.getAttribute("aria-"+name)}}function action(){var focusElm=getFocusElement();if(focusElm&&(focusElm.nodeName=="TEXTAREA"||focusElm.type=="text")){return}if(settings.onAction){settings.onAction(focussedId)}else{DomUtils.fire(getFocusElement(),"click",{keyboard:true})}return true}function cancel(){var focusElm;if(settings.onCancel){if((focusElm=getFocusElement())){focusElm.blur()}settings.onCancel()}else{settings.root.fire("cancel")}}function moveFocus(dir){var idx=-1,focusElm,i;var visibleItems=[];function isVisible(elm){var rootElm=root?root.getEl():document.body;while(elm&&elm!=rootElm){if(elm.style.display=="none"){return false}elm=elm.parentNode}return true}initItems();i=visibleItems.length;for(i=0;i<items.length;i++){if(isVisible(items[i])){visibleItems.push(items[i])}}i=visibleItems.length;while(i--){if(visibleItems[i].id===focussedId){idx=i;break}}idx+=dir;if(idx<0){idx=visibleItems.length-1}else{if(idx>=visibleItems.length){idx=0}}focusElm=visibleItems[idx];focusElm.focus();focussedId=focusElm.id;if(settings.actOnFocus){action()}}function focusFirst(){var i,rootRole;rootRole=getRole(settings.root.getEl());initItems();i=items.length;while(i--){if(rootRole=="toolbar"&&items[i].id===focussedId){items[i].focus();return}}items[0].focus()}root.on("keydown",function(e){var DOM_VK_LEFT=37,DOM_VK_RIGHT=39,DOM_VK_UP=38,DOM_VK_DOWN=40;var DOM_VK_ESCAPE=27,DOM_VK_ENTER=14,DOM_VK_RETURN=13,DOM_VK_SPACE=32,DOM_VK_TAB=9;var preventDefault;switch(e.keyCode){case DOM_VK_LEFT:if(enableLeftRight){if(settings.leftAction){settings.leftAction()}else{moveFocus(-1)}preventDefault=true}break;case DOM_VK_RIGHT:if(enableLeftRight){if(getRole()=="menuitem"&&getParentRole()=="menu"){if(getAriaProp("haspopup")){action()}}else{moveFocus(1)}preventDefault=true}break;case DOM_VK_UP:if(enableUpDown){moveFocus(-1);preventDefault=true}break;case DOM_VK_DOWN:if(enableUpDown){if(getRole()=="menuitem"&&getParentRole()=="menubar"){action()}else{if(getRole()=="button"&&getAriaProp("haspopup")){action()}else{moveFocus(1)}}preventDefault=true}break;case DOM_VK_TAB:preventDefault=true;if(e.shiftKey){moveFocus(-1)}else{moveFocus(1)}break;case DOM_VK_ESCAPE:preventDefault=true;cancel();break;case DOM_VK_ENTER:case DOM_VK_RETURN:case DOM_VK_SPACE:preventDefault=action();break}if(preventDefault){e.stopPropagation();e.preventDefault()}});root.on("focusin",function(e){initItems();focussedId=e.target.id});return{moveFocus:moveFocus,focusFirst:focusFirst,cancel:cancel}}});define("tinymce/ui/Window",["tinymce/ui/FloatPanel","tinymce/ui/Panel","tinymce/ui/DomUtils","tinymce/ui/KeyboardNavigation","tinymce/ui/DragHelper"],function(FloatPanel,Panel,DomUtils,KeyboardNavigation,DragHelper){var Window=FloatPanel.extend({modal:true,Defaults:{border:1,layout:"flex",containerCls:"panel",role:"dialog",callbacks:{submit:function(){this.fire("submit",{data:this.toJSON()})},close:function(){this.close()}}},init:function(settings){var self=this;self._super(settings);if(self.isRtl()){self.addClass("rtl")}self.addClass("window");self._fixed=true;if(settings.buttons){self.statusbar=new Panel({layout:"flex",border:"1 0 0 0",spacing:3,padding:10,align:"center",pack:self.isRtl()?"start":"end",defaults:{type:"button"},items:settings.buttons});self.statusbar.addClass("foot");self.statusbar.parent(self)}self.on("click",function(e){if(e.target.className.indexOf(self.classPrefix+"close")!=-1){self.close()}});self.aria("label",settings.title);self._fullscreen=false},recalc:function(){var self=this,statusbar=self.statusbar,layoutRect,width,x,needsRecalc;if(self._fullscreen){self.layoutRect(DomUtils.getWindowSize());self.layoutRect().contentH=self.layoutRect().innerH}self._super();layoutRect=self.layoutRect();if(self.settings.title&&!self._fullscreen){width=layoutRect.headerW;if(width>layoutRect.w){x=layoutRect.x-Math.max(0,width/2);self.layoutRect({w:width,x:x});needsRecalc=true}}if(statusbar){statusbar.layoutRect({w:self.layoutRect().innerW}).recalc();width=statusbar.layoutRect().minW+layoutRect.deltaW;if(width>layoutRect.w){x=layoutRect.x-Math.max(0,width-layoutRect.w);self.layoutRect({w:width,x:x});needsRecalc=true}}if(needsRecalc){self.recalc()}},initLayoutRect:function(){var self=this,layoutRect=self._super(),deltaH=0,headEl;if(self.settings.title&&!self._fullscreen){headEl=self.getEl("head");var size=DomUtils.getSize(headEl);layoutRect.headerW=size.width;layoutRect.headerH=size.height;deltaH+=layoutRect.headerH}if(self.statusbar){deltaH+=self.statusbar.layoutRect().h}layoutRect.deltaH+=deltaH;layoutRect.minH+=deltaH;layoutRect.h+=deltaH;var rect=DomUtils.getWindowSize();layoutRect.x=Math.max(0,rect.w/2-layoutRect.w/2);layoutRect.y=Math.max(0,rect.h/2-layoutRect.h/2);return layoutRect},renderHtml:function(){var self=this,layout=self._layout,id=self._id,prefix=self.classPrefix;var settings=self.settings,headerHtml="",footerHtml="",html=settings.html;self.preRender();layout.preRender(self);if(settings.title){headerHtml=('<div id="'+id+'-head" class="'+prefix+'window-head"><div class="'+prefix+'title">'+self.encode(settings.title)+'</div><button type="button" class="'+prefix+'close" aria-hidden="true">&times;</button><div id="'+id+'-dragh" class="'+prefix+'dragh"></div></div>')}if(settings.url){html='<iframe src="'+settings.url+'" tabindex="-1"></iframe>'}if(typeof(html)=="undefined"){html=layout.renderHtml(self)}if(self.statusbar){footerHtml=self.statusbar.renderHtml()}return('<div id="'+id+'" class="'+self.classes()+'" hideFocus="1" tabIndex="-1">'+headerHtml+'<div id="'+id+'-body" class="'+self.classes("body")+'">'+html+"</div>"+footerHtml+"</div>")},fullscreen:function(state){var self=this,documentElement=document.documentElement,slowRendering,prefix=self.classPrefix,layoutRect;if(state!=self._fullscreen){DomUtils.on(window,"resize",function(){var time;if(self._fullscreen){if(!slowRendering){time=new Date().getTime();var rect=DomUtils.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h);if((new Date().getTime())-time>50){slowRendering=true}}else{if(!self._timer){self._timer=setTimeout(function(){var rect=DomUtils.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h);self._timer=0},50)}}}});layoutRect=self.layoutRect();self._fullscreen=state;if(!state){self._borderBox=self.parseBox(self.settings.border);self.getEl("head").style.display="";layoutRect.deltaH+=layoutRect.headerH;DomUtils.removeClass(documentElement,prefix+"fullscreen");DomUtils.removeClass(document.body,prefix+"fullscreen");self.removeClass("fullscreen");self.moveTo(self._initial.x,self._initial.y).resizeTo(self._initial.w,self._initial.h)}else{self._initial={x:layoutRect.x,y:layoutRect.y,w:layoutRect.w,h:layoutRect.h};self._borderBox=self.parseBox("0");self.getEl("head").style.display="none";layoutRect.deltaH-=layoutRect.headerH+2;DomUtils.addClass(documentElement,prefix+"fullscreen");DomUtils.addClass(document.body,prefix+"fullscreen");self.addClass("fullscreen");var rect=DomUtils.getWindowSize();self.moveTo(0,0).resizeTo(rect.w,rect.h)}}return self.reflow()},postRender:function(){var self=this,items=[],focusCtrl,autoFocusFound,startPos;setTimeout(function(){self.addClass("in")},0);self.keyboardNavigation=new KeyboardNavigation({root:self,enableLeftRight:false,enableUpDown:false,items:items,onCancel:function(){self.close()}});self.find("*").each(function(ctrl){if(ctrl.canFocus){autoFocusFound=autoFocusFound||ctrl.settings.autofocus;focusCtrl=focusCtrl||ctrl;if(ctrl.type=="filepicker"){items.push(ctrl.getEl("inp"));if(ctrl.getEl("open")){items.push(ctrl.getEl("open"))}}else{items.push(ctrl.getEl())}}});if(self.statusbar){self.statusbar.find("*").each(function(ctrl){if(ctrl.canFocus){autoFocusFound=autoFocusFound||ctrl.settings.autofocus;focusCtrl=focusCtrl||ctrl;items.push(ctrl.getEl())}})}self._super();if(self.statusbar){self.statusbar.postRender()}if(!autoFocusFound&&focusCtrl){focusCtrl.focus()}this.dragHelper=new DragHelper(self._id+"-dragh",{start:function(){startPos={x:self.layoutRect().x,y:self.layoutRect().y}},drag:function(e){self.moveTo(startPos.x+e.deltaX,startPos.y+e.deltaY)}});self.on("submit",function(e){if(!e.isDefaultPrevented()){self.close()}})},submit:function(){return this.fire("submit",{data:this.toJSON()})},remove:function(){var self=this,prefix=self.classPrefix;self.dragHelper.destroy();self._super();if(self.statusbar){this.statusbar.remove()}if(self._fullscreen){DomUtils.removeClass(document.documentElement,prefix+"fullscreen");DomUtils.removeClass(document.body,prefix+"fullscreen")}}});return Window});define("tinymce/ui/MessageBox",["tinymce/ui/Window"],function(Window){var MessageBox=Window.extend({init:function(settings){settings={border:1,padding:20,layout:"flex",pack:"center",align:"center",containerCls:"panel",autoScroll:true,buttons:{type:"button",text:"Ok",action:"ok"},items:{type:"label",multiline:true,maxWidth:500,maxHeight:200}};this._super(settings)},Statics:{OK:1,OK_CANCEL:2,YES_NO:3,YES_NO_CANCEL:4,msgBox:function(settings){var buttons,callback=settings.callback||function(){};switch(settings.buttons){case MessageBox.OK_CANCEL:buttons=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close();callback(true)}},{type:"button",text:"Cancel",onClick:function(e){e.control.parents()[1].close();callback(false)}}];break;case MessageBox.YES_NO:buttons=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close();callback(true)}}];break;case MessageBox.YES_NO_CANCEL:buttons=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close()}}];break;default:buttons=[{type:"button",text:"Ok",subtype:"primary",onClick:function(e){e.control.parents()[1].close();callback(true)}}];break}return new Window({padding:20,x:settings.x,y:settings.y,minWidth:300,minHeight:100,layout:"flex",pack:"center",align:"center",buttons:buttons,title:settings.title,items:{type:"label",multiline:true,maxWidth:500,maxHeight:200,text:settings.text},onClose:settings.onClose}).renderTo(document.body).reflow()},alert:function(settings,callback){if(typeof(settings)=="string"){settings={text:settings}}settings.callback=callback;return MessageBox.msgBox(settings)},confirm:function(settings,callback){if(typeof(settings)=="string"){settings={text:settings}}settings.callback=callback;settings.buttons=MessageBox.OK_CANCEL;return MessageBox.msgBox(settings)}}});return MessageBox});define("tinymce/WindowManager",["tinymce/ui/Window","tinymce/ui/MessageBox"],function(Window,MessageBox){return function(editor){var self=this,windows=[];function getTopMostWindow(){if(windows.length){return windows[windows.length-1]}}self.windows=windows;self.open=function(args,params){var win;editor.editorManager.activeEditor=editor;args.title=args.title||" ";args.url=args.url||args.file;if(args.url){args.width=parseInt(args.width||320,10);args.height=parseInt(args.height||240,10)}if(args.body){args.items={defaults:args.defaults,type:args.bodyType||"form",items:args.body}}if(!args.url&&!args.buttons){args.buttons=[{text:"Ok",subtype:"primary",onclick:function(){win.find("form")[0].submit();win.close()}},{text:"Cancel",onclick:function(){win.close()}}]}win=new Window(args);windows.push(win);win.on("close",function(){var i=windows.length;while(i--){if(windows[i]===win){windows.splice(i,1)}}editor.focus()});if(args.data){win.on("postRender",function(){this.find("*").each(function(ctrl){var name=ctrl.name();if(name in args.data){ctrl.value(args.data[name])}})})}win.features=args||{};win.params=params||{};editor.nodeChanged();return win.renderTo(document.body).reflow()};self.alert=function(message,callback,scope){MessageBox.alert(message,function(){if(callback){callback.call(scope||this)}})};self.confirm=function(message,callback,scope){MessageBox.confirm(message,function(state){callback.call(scope||this,state)})};self.close=function(){if(getTopMostWindow()){getTopMostWindow().close()}};self.getParams=function(){return getTopMostWindow()?getTopMostWindow().params:null};self.setParams=function(params){if(getTopMostWindow()){getTopMostWindow().params=params}}}});define("tinymce/util/Quirks",["tinymce/util/VK","tinymce/dom/RangeUtils","tinymce/html/Node","tinymce/html/Entities","tinymce/Env","tinymce/util/Tools"],function(VK,RangeUtils,Node,Entities,Env,Tools){return function(editor){var each=Tools.each;var BACKSPACE=VK.BACKSPACE,DELETE=VK.DELETE,dom=editor.dom,selection=editor.selection,settings=editor.settings,parser=editor.parser,serializer=editor.serializer;var isGecko=Env.gecko,isIE=Env.ie,isWebKit=Env.webkit;function setEditorCommandState(cmd,state){try{editor.getDoc().execCommand(cmd,false,state)}catch(ex){}}function getDocumentMode(){var documentMode=editor.getDoc().documentMode;return documentMode?documentMode:6}function isDefaultPrevented(e){return e.isDefaultPrevented()}function cleanupStylesWhenDeleting(){function removeMergedFormatSpans(isDelete){var rng,blockElm,wrapperElm,bookmark,container,offset,elm;function isAtStartOrEndOfElm(){if(container.nodeType==3){if(isDelete&&offset==container.length){return true}if(!isDelete&&offset===0){return true}}}rng=selection.getRng();var tmpRng=[rng.startContainer,rng.startOffset,rng.endContainer,rng.endOffset];if(!rng.collapsed){isDelete=true}container=rng[(isDelete?"start":"end")+"Container"];offset=rng[(isDelete?"start":"end")+"Offset"];if(container.nodeType==3){blockElm=dom.getParent(rng.startContainer,dom.isBlock);if(isDelete){blockElm=dom.getNext(blockElm,dom.isBlock)}if(blockElm&&(isAtStartOrEndOfElm()||!rng.collapsed)){wrapperElm=dom.create("em",{id:"__mceDel"});each(Tools.grep(blockElm.childNodes),function(node){wrapperElm.appendChild(node)});blockElm.appendChild(wrapperElm)}}rng=dom.createRng();rng.setStart(tmpRng[0],tmpRng[1]);rng.setEnd(tmpRng[2],tmpRng[3]);selection.setRng(rng);editor.getDoc().execCommand(isDelete?"ForwardDelete":"Delete",false,null);if(wrapperElm){bookmark=selection.getBookmark();while((elm=dom.get("__mceDel"))){dom.remove(elm,true)}selection.moveToBookmark(bookmark)}}editor.on("keydown",function(e){var isDelete;isDelete=e.keyCode==DELETE;if(!isDefaultPrevented(e)&&(isDelete||e.keyCode==BACKSPACE)&&!VK.modifierPressed(e)){e.preventDefault();removeMergedFormatSpans(isDelete)}});editor.addCommand("Delete",function(){removeMergedFormatSpans()})}function emptyEditorWhenDeleting(){function serializeRng(rng){var body=dom.create("body");var contents=rng.cloneContents();body.appendChild(contents);return selection.serializer.serialize(body,{format:"html"})}function allContentsSelected(rng){if(!rng.setStart){if(rng.item){return false}var bodyRng=rng.duplicate();bodyRng.moveToElementText(editor.getBody());return RangeUtils.compareRanges(rng,bodyRng)}var selection=serializeRng(rng);var allRng=dom.createRng();allRng.selectNode(editor.getBody());var allSelection=serializeRng(allRng);return selection===allSelection}editor.on("keydown",function(e){var keyCode=e.keyCode,isCollapsed,body;if(!isDefaultPrevented(e)&&(keyCode==DELETE||keyCode==BACKSPACE)){isCollapsed=editor.selection.isCollapsed();body=editor.getBody();if(isCollapsed&&!dom.isEmpty(body)){return}if(!isCollapsed&&!allContentsSelected(editor.selection.getRng())){return}e.preventDefault();editor.setContent("");if(body.firstChild&&dom.isBlock(body.firstChild)){editor.selection.setCursorLocation(body.firstChild,0)}else{editor.selection.setCursorLocation(body,0)}editor.nodeChanged()}})}function selectAll(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode==65&&VK.metaKeyPressed(e)){e.preventDefault();editor.execCommand("SelectAll")}})}function inputMethodFocus(){if(!editor.settings.content_editable){dom.bind(editor.getDoc(),"focusin",function(){selection.setRng(selection.getRng())});dom.bind(editor.getDoc(),"mousedown",function(e){if(e.target==editor.getDoc().documentElement){editor.getWin().focus();selection.setRng(selection.getRng())}})}}function removeHrOnBackspace(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE){if(selection.isCollapsed()&&selection.getRng(true).startOffset===0){var node=selection.getNode();var previousSibling=node.previousSibling;if(node.nodeName=="HR"){dom.remove(node);e.preventDefault();return}if(previousSibling&&previousSibling.nodeName&&previousSibling.nodeName.toLowerCase()==="hr"){dom.remove(previousSibling);e.preventDefault()}}}})}function focusBody(){if(!window.Range.prototype.getClientRects){editor.on("mousedown",function(e){if(!isDefaultPrevented(e)&&e.target.nodeName==="HTML"){var body=editor.getBody();body.blur();setTimeout(function(){body.focus()},0)}})}}function selectControlElements(){editor.on("click",function(e){e=e.target;if(/^(IMG|HR)$/.test(e.nodeName)){selection.getSel().setBaseAndExtent(e,0,e,1)}if(e.nodeName=="A"&&dom.hasClass(e,"mce-item-anchor")){selection.select(e)}editor.nodeChanged()})}function removeStylesWhenDeletingAcrossBlockElements(){function getAttributeApplyFunction(){var template=dom.getAttribs(selection.getStart().cloneNode(false));return function(){var target=selection.getStart();if(target!==editor.getBody()){dom.setAttrib(target,"style",null);each(template,function(attr){target.setAttributeNode(attr.cloneNode(true))})}}}function isSelectionAcrossElements(){return !selection.isCollapsed()&&dom.getParent(selection.getStart(),dom.isBlock)!=dom.getParent(selection.getEnd(),dom.isBlock)}editor.on("keypress",function(e){var applyAttributes;if(!isDefaultPrevented(e)&&(e.keyCode==8||e.keyCode==46)&&isSelectionAcrossElements()){applyAttributes=getAttributeApplyFunction();editor.getDoc().execCommand("delete",false,null);applyAttributes();e.preventDefault();return false}});dom.bind(editor.getDoc(),"cut",function(e){var applyAttributes;if(!isDefaultPrevented(e)&&isSelectionAcrossElements()){applyAttributes=getAttributeApplyFunction();setTimeout(function(){applyAttributes()},0)}})}function selectionChangeNodeChanged(){var lastRng,selectionTimer;editor.on("selectionchange",function(){if(selectionTimer){clearTimeout(selectionTimer);selectionTimer=0}selectionTimer=window.setTimeout(function(){var rng=selection.getRng();if(!lastRng||!RangeUtils.compareRanges(rng,lastRng)){editor.nodeChanged();lastRng=rng}},50)})}function ensureBodyHasRoleApplication(){document.body.setAttribute("role","application")}function disableBackspaceIntoATable(){editor.on("keydown",function(e){if(!isDefaultPrevented(e)&&e.keyCode===BACKSPACE){if(selection.isCollapsed()&&selection.getRng(true).startOffset===0){var previousSibling=selection.getNode().previousSibling;if(previousSibling&&previousSibling.nodeName&&previousSibling.nodeName.toLowerCase()==="table"){e.preventDefault();return false}}}})}function addNewLinesBeforeBrInPre(){if(getDocumentMode()>7){return}setEditorCommandState("RespectVisibilityInDesign",true);editor.contentStyles.push(".mceHideBrInPre pre br {display: none}");dom.addClass(editor.getBody(),"mceHideBrInPre");parser.addNodeFilter("pre",function(nodes){var i=nodes.length,brNodes,j,brElm,sibling;while(i--){brNodes=nodes[i].getAll("br");j=brNodes.length;while(j--){brElm=brNodes[j];sibling=brElm.prev;if(sibling&&sibling.type===3&&sibling.value.charAt(sibling.value-1)!="\n"){sibling.value+="\n"}else{brElm.parent.insert(new Node("#text",3),brElm,true).value="\n"}}}});serializer.addNodeFilter("pre",function(nodes){var i=nodes.length,brNodes,j,brElm,sibling;while(i--){brNodes=nodes[i].getAll("br");j=brNodes.length;while(j--){brElm=brNodes[j];sibling=brElm.prev;if(sibling&&sibling.type==3){sibling.value=sibling.value.replace(/\r?\n$/,"")}}}})}function removePreSerializedStylesWhenSelectingControls(){dom.bind(editor.getBody(),"mouseup",function(){var value,node=selection.getNode();if(node.nodeName=="IMG"){if((value=dom.getStyle(node,"width"))){dom.setAttrib(node,"width",value.replace(/[^0-9%]+/g,""));dom.setStyle(node,"width","")}if((value=dom.getStyle(node,"height"))){dom.setAttrib(node,"height",value.replace(/[^0-9%]+/g,""));dom.setStyle(node,"height","")}}})}function keepInlineElementOnDeleteBackspace(){editor.on("keydown",function(e){var isDelete,rng,container,offset,brElm,sibling,collapsed,nonEmptyElements;isDelete=e.keyCode==DELETE;if(!isDefaultPrevented(e)&&(isDelete||e.keyCode==BACKSPACE)&&!VK.modifierPressed(e)){rng=selection.getRng();container=rng.startContainer;offset=rng.startOffset;collapsed=rng.collapsed;if(container.nodeType==3&&container.nodeValue.length>0&&((offset===0&&!collapsed)||(collapsed&&offset===(isDelete?0:1)))){sibling=container.previousSibling;if(sibling&&sibling.nodeName=="IMG"){return}nonEmptyElements=editor.schema.getNonEmptyElements();e.preventDefault();brElm=dom.create("br",{id:"__tmp"});container.parentNode.insertBefore(brElm,container);editor.getDoc().execCommand(isDelete?"ForwardDelete":"Delete",false,null);container=selection.getRng().startContainer;sibling=container.previousSibling;if(sibling&&sibling.nodeType==1&&!dom.isBlock(sibling)&&dom.isEmpty(sibling)&&!nonEmptyElements[sibling.nodeName.toLowerCase()]){dom.remove(sibling)}dom.remove("__tmp")}}})}function removeBlockQuoteOnBackSpace(){editor.on("keydown",function(e){var rng,container,offset,root,parent;if(isDefaultPrevented(e)||e.keyCode!=VK.BACKSPACE){return}rng=selection.getRng();container=rng.startContainer;offset=rng.startOffset;root=dom.getRoot();parent=container;if(!rng.collapsed||offset!==0){return}while(parent&&parent.parentNode&&parent.parentNode.firstChild==parent&&parent.parentNode!=root){parent=parent.parentNode}if(parent.tagName==="BLOCKQUOTE"){editor.formatter.toggle("blockquote",null,parent);rng=dom.createRng();rng.setStart(container,0);rng.setEnd(container,0);selection.setRng(rng)}})}function setGeckoEditingOptions(){function setOpts(){editor._refreshContentEditable();setEditorCommandState("StyleWithCSS",false);setEditorCommandState("enableInlineTableEditing",false);if(!settings.object_resizing){setEditorCommandState("enableObjectResizing",false)}}if(!settings.readonly){editor.on("BeforeExecCommand MouseDown",setOpts)}}function addBrAfterLastLinks(){function fixLinks(){each(dom.select("a"),function(node){var parentNode=node.parentNode,root=dom.getRoot();if(parentNode.lastChild===node){while(parentNode&&!dom.isBlock(parentNode)){if(parentNode.parentNode.lastChild!==parentNode||parentNode===root){return}parentNode=parentNode.parentNode}dom.add(parentNode,"br",{"data-mce-bogus":1})}})}editor.on("SetContent ExecCommand",function(e){if(e.type=="setcontent"||e.command==="mceInsertLink"){fixLinks()}})}function setDefaultBlockType(){if(settings.forced_root_block){editor.on("init",function(){setEditorCommandState("DefaultParagraphSeparator",settings.forced_root_block)})}}function removeGhostSelection(){editor.on("Undo Redo SetContent",function(e){if(!e.initial){editor.execCommand("mceRepaint")}})}function deleteControlItemOnBackSpace(){editor.on("keydown",function(e){var rng;if(!isDefaultPrevented(e)&&e.keyCode==BACKSPACE){rng=editor.getDoc().selection.createRange();if(rng&&rng.item){e.preventDefault();editor.undoManager.beforeChange();dom.remove(rng.item(0));editor.undoManager.add()}}})}function renderEmptyBlocksFix(){var emptyBlocksCSS;if(getDocumentMode()>=10){emptyBlocksCSS="";each("p div h1 h2 h3 h4 h5 h6".split(" "),function(name,i){emptyBlocksCSS+=(i>0?",":"")+name+":empty"});editor.contentStyles.push(emptyBlocksCSS+"{padding-right: 1px !important}")}}function keepNoScriptContents(){if(getDocumentMode()<9){parser.addNodeFilter("noscript",function(nodes){var i=nodes.length,node,textNode;while(i--){node=nodes[i];textNode=node.firstChild;if(textNode){node.attr("data-mce-innertext",textNode.value)}}});serializer.addNodeFilter("noscript",function(nodes){var i=nodes.length,node,textNode,value;while(i--){node=nodes[i];textNode=nodes[i].firstChild;if(textNode){textNode.value=Entities.decode(textNode.value)}else{value=node.attributes.map["data-mce-innertext"];if(value){node.attr("data-mce-innertext",null);textNode=new Node("#text",3);textNode.value=value;textNode.raw=true;node.append(textNode)}}}})}}function fixCaretSelectionOfDocumentElementOnIe(){var doc=dom.doc,body=doc.body,started,startRng,htmlElm;function rngFromPoint(x,y){var rng=body.createTextRange();try{rng.moveToPoint(x,y)}catch(ex){rng=null}return rng}function selectionChange(e){var pointRng;if(e.button){pointRng=rngFromPoint(e.x,e.y);if(pointRng){if(pointRng.compareEndPoints("StartToStart",startRng)>0){pointRng.setEndPoint("StartToStart",startRng)}else{pointRng.setEndPoint("EndToEnd",startRng)}pointRng.select()}}else{endSelection()}}function endSelection(){var rng=doc.selection.createRange();if(startRng&&!rng.item&&rng.compareEndPoints("StartToEnd",rng)===0){startRng.select()}dom.unbind(doc,"mouseup",endSelection);dom.unbind(doc,"mousemove",selectionChange);startRng=started=0}doc.documentElement.unselectable=true;dom.bind(doc,"mousedown contextmenu",function(e){if(e.target.nodeName==="HTML"){if(started){endSelection()}htmlElm=doc.documentElement;if(htmlElm.scrollHeight>htmlElm.clientHeight){return}started=1;startRng=rngFromPoint(e.x,e.y);if(startRng){dom.bind(doc,"mouseup",endSelection);dom.bind(doc,"mousemove",selectionChange);dom.win.focus();startRng.select()}}})}function normalizeSelection(){editor.on("keyup focusin",function(e){if(e.keyCode!=65||!VK.metaKeyPressed(e)){selection.normalize()}})}function showBrokenImageIcon(){editor.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")}function restoreFocusOnKeyDown(){if(!editor.inline){editor.on("keydown",function(){if(document.activeElement==document.body){editor.getWin().focus()}})}}function bodyHeight(){if(!editor.inline){editor.contentStyles.push("body {min-height: 150px}");editor.on("click",function(e){if(e.target.nodeName=="HTML"){editor.execCommand("SelectAll");editor.selection.collapse(true);editor.nodeChanged()}})}}function blockCmdArrowNavigation(){if(Env.mac){editor.on("keydown",function(e){if(VK.metaKeyPressed(e)&&(e.keyCode==37||e.keyCode==39)){e.preventDefault();editor.selection.getSel().modify("move",e.keyCode==37?"backward":"forward","word")}})}}disableBackspaceIntoATable();removeBlockQuoteOnBackSpace();emptyEditorWhenDeleting();normalizeSelection();if(isWebKit){keepInlineElementOnDeleteBackspace();cleanupStylesWhenDeleting();inputMethodFocus();selectControlElements();setDefaultBlockType();if(Env.iOS){selectionChangeNodeChanged();restoreFocusOnKeyDown();bodyHeight()}else{selectAll()}}if(isIE&&Env.ie<11){removeHrOnBackspace();ensureBodyHasRoleApplication();addNewLinesBeforeBrInPre();removePreSerializedStylesWhenSelectingControls();deleteControlItemOnBackSpace();renderEmptyBlocksFix();keepNoScriptContents();fixCaretSelectionOfDocumentElementOnIe()}if(Env.ie>=11){bodyHeight()}if(Env.ie){selectAll()}if(isGecko){removeHrOnBackspace();focusBody();removeStylesWhenDeletingAcrossBlockElements();setGeckoEditingOptions();addBrAfterLastLinks();removeGhostSelection();showBrokenImageIcon();blockCmdArrowNavigation()}}});define("tinymce/util/Observable",["tinymce/util/Tools"],function(Tools){var bindingsName="__bindings";var nativeEvents=Tools.makeMap("focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave keydown keypress keyup contextmenu dragend dragover draggesture dragdrop drop drag"," ");function returnFalse(){return false}function returnTrue(){return true}return{fire:function(name,args,bubble){var self=this,handlers,i,l,callback,parent;name=name.toLowerCase();args=args||{};args.type=name;if(!args.target){args.target=self}if(!args.preventDefault){args.preventDefault=function(){args.isDefaultPrevented=returnTrue};args.stopPropagation=function(){args.isPropagationStopped=returnTrue};args.stopImmediatePropagation=function(){args.isImmediatePropagationStopped=returnTrue};args.isDefaultPrevented=returnFalse;args.isPropagationStopped=returnFalse;args.isImmediatePropagationStopped=returnFalse}if(self[bindingsName]){handlers=self[bindingsName][name];if(handlers){for(i=0,l=handlers.length;i<l;i++){handlers[i]=callback=handlers[i];if(args.isImmediatePropagationStopped()){break}if(callback.call(self,args)===false){args.preventDefault();return args}}}}if(bubble!==false&&self.parent){parent=self.parent();while(parent&&!args.isPropagationStopped()){parent.fire(name,args,false);parent=parent.parent()}}return args},on:function(name,callback){var self=this,bindings,handlers,names,i;if(callback===false){callback=function(){return false}}if(callback){names=name.toLowerCase().split(" ");i=names.length;while(i--){name=names[i];bindings=self[bindingsName];if(!bindings){bindings=self[bindingsName]={}}handlers=bindings[name];if(!handlers){handlers=bindings[name]=[];if(self.bindNative&&nativeEvents[name]){self.bindNative(name)}}handlers.push(callback)}}return self},off:function(name,callback){var self=this,i,bindings=self[bindingsName],handlers,bindingName,names,hi;if(bindings){if(name){names=name.toLowerCase().split(" ");i=names.length;while(i--){name=names[i];handlers=bindings[name];if(!name){for(bindingName in bindings){bindings[name].length=0}return self}if(handlers){if(!callback){handlers.length=0}else{hi=handlers.length;while(hi--){if(handlers[hi]===callback){handlers.splice(hi,1)}}}if(!handlers.length&&self.unbindNative&&nativeEvents[name]){self.unbindNative(name);delete bindings[name]}}}}else{if(self.unbindNative){for(name in bindings){self.unbindNative(name)}}self[bindingsName]=[]}}return self},hasEventListeners:function(name){var bindings=this[bindingsName];name=name.toLowerCase();return !(!bindings||!bindings[name]||bindings[name].length===0)}}});define("tinymce/Shortcuts",["tinymce/util/Tools","tinymce/Env"],function(Tools,Env){var each=Tools.each,explode=Tools.explode;var keyCodeLookup={f9:120,f10:121,f11:122};return function(editor){var self=this,shortcuts={};editor.on("keyup keypress keydown",function(e){if(e.altKey||e.ctrlKey||e.metaKey){each(shortcuts,function(shortcut){var ctrlKey=Env.mac?e.metaKey:e.ctrlKey;if(shortcut.ctrl!=ctrlKey||shortcut.alt!=e.altKey||shortcut.shift!=e.shiftKey){return}if(e.keyCode==shortcut.keyCode||(e.charCode&&e.charCode==shortcut.charCode)){e.preventDefault();if(e.type=="keydown"){shortcut.func.call(shortcut.scope)}return true}})}});self.add=function(pattern,desc,cmdFunc,scope){var cmd;cmd=cmdFunc;if(typeof(cmdFunc)==="string"){cmdFunc=function(){editor.execCommand(cmd,false,null)}}else{if(Tools.isArray(cmd)){cmdFunc=function(){editor.execCommand(cmd[0],cmd[1],cmd[2])}}}each(explode(pattern.toLowerCase()),function(pattern){var shortcut={func:cmdFunc,scope:scope||editor,desc:editor.translate(desc),alt:false,ctrl:false,shift:false};each(explode(pattern,"+"),function(value){switch(value){case"alt":case"ctrl":case"shift":shortcut[value]=true;break;default:shortcut.charCode=value.charCodeAt(0);shortcut.keyCode=keyCodeLookup[value]||value.toUpperCase().charCodeAt(0)}});shortcuts[(shortcut.ctrl?"ctrl":"")+","+(shortcut.alt?"alt":"")+","+(shortcut.shift?"shift":"")+","+shortcut.keyCode]=shortcut});return true}}});define("tinymce/Editor",["tinymce/dom/DOMUtils","tinymce/AddOnManager","tinymce/html/Node","tinymce/dom/Serializer","tinymce/html/Serializer","tinymce/dom/Selection","tinymce/Formatter","tinymce/UndoManager","tinymce/EnterKey","tinymce/ForceBlocks","tinymce/EditorCommands","tinymce/util/URI","tinymce/dom/ScriptLoader","tinymce/dom/EventUtils","tinymce/WindowManager","tinymce/html/Schema","tinymce/html/DomParser","tinymce/util/Quirks","tinymce/Env","tinymce/util/Tools","tinymce/util/Observable","tinymce/Shortcuts"],function(DOMUtils,AddOnManager,Node,DomSerializer,Serializer,Selection,Formatter,UndoManager,EnterKey,ForceBlocks,EditorCommands,URI,ScriptLoader,EventUtils,WindowManager,Schema,DomParser,Quirks,Env,Tools,Observable,Shortcuts){var DOM=DOMUtils.DOM,ThemeManager=AddOnManager.ThemeManager,PluginManager=AddOnManager.PluginManager;var extend=Tools.extend,each=Tools.each,explode=Tools.explode;var inArray=Tools.inArray,trim=Tools.trim,resolve=Tools.resolve;var Event=EventUtils.Event;var isGecko=Env.gecko,ie=Env.ie;function getEventTarget(editor,eventName){if(eventName=="selectionchange"||eventName=="drop"){return editor.getDoc()}if(!editor.inline&&/^mouse|click|contextmenu/.test(eventName)){return editor.getDoc()}return editor.getBody()}function Editor(id,settings,editorManager){var self=this,documentBaseUrl,baseUri;documentBaseUrl=self.documentBaseUrl=editorManager.documentBaseURL;baseUri=editorManager.baseURI;self.settings=settings=extend({id:id,theme:"modern",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:documentBaseUrl,add_form_submit_trigger:true,submit_patch:true,add_unload_trigger:true,convert_urls:true,relative_urls:true,remove_script_host:true,object_resizing:true,doctype:"<!DOCTYPE html>",visual:true,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",forced_root_block:"p",hidden_input:true,padd_empty_editor:true,render_ui:true,indentation:"30px",inline_styles:true,convert_fonts_to_spans:true,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,option,optgroup,datalist",validate:true,entity_encoding:"named",url_converter:self.convertURL,url_converter_scope:self,ie7_compat:true},settings);AddOnManager.language=settings.language||"en";AddOnManager.languageLoad=settings.language_load;AddOnManager.baseURL=editorManager.baseURL;self.id=settings.id=id;self.isNotDirty=true;self.plugins={};self.documentBaseURI=new URI(settings.document_base_url||documentBaseUrl,{base_uri:baseUri});self.baseURI=baseUri;self.contentCSS=[];self.contentStyles=[];self.shortcuts=new Shortcuts(self);self.execCommands={};self.queryStateCommands={};self.queryValueCommands={};self.loadedCSS={};self.suffix=editorManager.suffix;self.editorManager=editorManager;self.inline=settings.inline;self.execCallback("setup",self);editorManager.fire("SetupEditor",self)}Editor.prototype={render:function(){var self=this,settings=self.settings,id=self.id,suffix=self.suffix;function readyHandler(){DOM.unbind(window,"ready",readyHandler);self.render()}if(!Event.domLoaded){DOM.bind(window,"ready",readyHandler);return}if(!self.getElement()){return}if(!Env.contentEditable){return}if(!settings.inline){self.orgVisibility=self.getElement().style.visibility;self.getElement().style.visibility="hidden"}else{self.inline=true}var form=self.getElement().form||DOM.getParent(id,"form");if(form){self.formElement=form;if(settings.hidden_input&&!/TEXTAREA|INPUT/i.test(self.getElement().nodeName)){DOM.insertAfter(DOM.create("input",{type:"hidden",name:id}),id);self.hasHiddenInput=true}self.formEventDelegate=function(e){self.fire(e.type,e)};DOM.bind(form,"submit reset",self.formEventDelegate);self.on("reset",function(){self.setContent(self.startContent,{format:"raw"})});if(settings.submit_patch&&!form.submit.nodeType&&!form.submit.length&&!form._mceOldSubmit){form._mceOldSubmit=form.submit;form.submit=function(){self.editorManager.triggerSave();self.isNotDirty=true;return form._mceOldSubmit(form)}}}self.windowManager=new WindowManager(self);if(settings.encoding=="xml"){self.on("GetContent",function(e){if(e.save){e.content=DOM.encode(e.content)}})}if(settings.add_form_submit_trigger){self.on("submit",function(){if(self.initialized){self.save()}})}if(settings.add_unload_trigger){self._beforeUnload=function(){if(self.initialized&&!self.destroyed&&!self.isHidden()){self.save({format:"raw",no_events:true,set_dirty:false})}};self.editorManager.on("BeforeUnload",self._beforeUnload)}function loadScripts(){var scriptLoader=ScriptLoader.ScriptLoader;if(settings.language&&settings.language!="en"){settings.language_url=self.editorManager.baseURL+"/langs/"+settings.language+".js"}if(settings.language_url){scriptLoader.add(settings.language_url)}if(settings.theme&&typeof settings.theme!="function"&&settings.theme.charAt(0)!="-"&&!ThemeManager.urls[settings.theme]){var themeUrl=settings.theme_url;if(themeUrl){themeUrl=self.documentBaseURI.toAbsolute(themeUrl)}else{themeUrl="themes/"+settings.theme+"/theme"+suffix+".js"}ThemeManager.load(settings.theme,themeUrl)}if(Tools.isArray(settings.plugins)){settings.plugins=settings.plugins.join(" ")}each(settings.external_plugins,function(url,name){PluginManager.load(name,url);settings.plugins+=" "+name});each(settings.plugins.split(/[ ,]/),function(plugin){plugin=trim(plugin);if(plugin&&!PluginManager.urls[plugin]){if(plugin.charAt(0)=="-"){plugin=plugin.substr(1,plugin.length);var dependencies=PluginManager.dependencies(plugin);each(dependencies,function(dep){var defaultSettings={prefix:"plugins/",resource:dep,suffix:"/plugin"+suffix+".js"};dep=PluginManager.createUrl(defaultSettings,dep);PluginManager.load(dep.resource,dep)})}else{PluginManager.load(plugin,{prefix:"plugins/",resource:plugin,suffix:"/plugin"+suffix+".js"})}}});scriptLoader.loadQueue(function(){if(!self.removed){self.init()}})}loadScripts()},init:function(){var self=this,settings=self.settings,elm=self.getElement();var w,h,minHeight,n,o,url,bodyId,bodyClass,re,i,initializedPlugins=[];self.rtl=this.editorManager.i18n.rtl;self.editorManager.add(self);settings.aria_label=settings.aria_label||DOM.getAttrib(elm,"aria-label",self.getLang("aria.rich_text_area"));if(settings.theme){if(typeof settings.theme!="function"){settings.theme=settings.theme.replace(/-/,"");o=ThemeManager.get(settings.theme);self.theme=new o(self,ThemeManager.urls[settings.theme]);if(self.theme.init){self.theme.init(self,ThemeManager.urls[settings.theme]||self.documentBaseUrl.replace(/\/$/,""))}}else{self.theme=settings.theme}}function initPlugin(plugin){var constr=PluginManager.get(plugin),url,pluginInstance;url=PluginManager.urls[plugin]||self.documentBaseUrl.replace(/\/$/,"");plugin=trim(plugin);if(constr&&inArray(initializedPlugins,plugin)===-1){each(PluginManager.dependencies(plugin),function(dep){initPlugin(dep)});pluginInstance=new constr(self,url);self.plugins[plugin]=pluginInstance;if(pluginInstance.init){pluginInstance.init(self,url);initializedPlugins.push(plugin)}}}each(settings.plugins.replace(/\-/g,"").split(/[ ,]/),initPlugin);if(settings.render_ui&&self.theme){self.orgDisplay=elm.style.display;if(typeof settings.theme!="function"){w=settings.width||elm.style.width||elm.offsetWidth;h=settings.height||elm.style.height||elm.offsetHeight;minHeight=settings.min_height||100;re=/^[0-9\.]+(|px)$/i;if(re.test(""+w)){w=Math.max(parseInt(w,10)+(o.deltaWidth||0),100)}if(re.test(""+h)){h=Math.max(parseInt(h,10)+(o.deltaHeight||0),minHeight)}o=self.theme.renderUI({targetNode:elm,width:w,height:h,deltaWidth:settings.delta_width,deltaHeight:settings.delta_height});if(!settings.content_editable){DOM.setStyles(o.sizeContainer||o.editorContainer,{wi2dth:w,h2eight:h});h=(o.iframeHeight||h)+(typeof(h)=="number"?(o.deltaHeight||0):"");if(h<minHeight){h=minHeight}}}else{o=settings.theme(self,elm);if(o.editorContainer.nodeType){o.editorContainer=o.editorContainer.id=o.editorContainer.id||self.id+"_parent"}if(o.iframeContainer.nodeType){o.iframeContainer=o.iframeContainer.id=o.iframeContainer.id||self.id+"_iframecontainer"}h=o.iframeHeight||elm.offsetHeight}self.editorContainer=o.editorContainer}if(settings.content_css){each(explode(settings.content_css),function(u){self.contentCSS.push(self.documentBaseURI.toAbsolute(u))})}if(settings.content_style){self.contentStyles.push(settings.content_style)}if(settings.content_editable){elm=n=o=null;return self.initContentBody()}self.iframeHTML=settings.doctype+"<html><head>";if(settings.document_base_url!=self.documentBaseUrl){self.iframeHTML+='<base href="'+self.documentBaseURI.getURI()+'" />'}if(!Env.caretAfter&&settings.ie7_compat){self.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />'}self.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';for(i=0;i<self.contentCSS.length;i++){var cssUrl=self.contentCSS[i];self.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+cssUrl+'" />';self.loadedCSS[cssUrl]=true}bodyId=settings.body_id||"tinymce";if(bodyId.indexOf("=")!=-1){bodyId=self.getParam("body_id","","hash");bodyId=bodyId[self.id]||bodyId}bodyClass=settings.body_class||"";if(bodyClass.indexOf("=")!=-1){bodyClass=self.getParam("body_class","","hash");bodyClass=bodyClass[self.id]||""}self.iframeHTML+='</head><body id="'+bodyId+'" class="mce-content-body '+bodyClass+'" onload="window.parent.tinymce.get(\''+self.id+"').fire('load');\"><br></body></html>";var domainRelaxUrl='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinymce.get("'+self.id+'");document.write(ed.iframeHTML);document.close();ed.initContentBody(true);})()';if(document.domain!=location.hostname){url=domainRelaxUrl}n=DOM.add(o.iframeContainer,"iframe",{id:self.id+"_ifr",src:url||'javascript:""',frameBorder:"0",allowTransparency:"true",title:self.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"),style:{width:"100%",height:h,display:"block"}});if(ie){try{self.getDoc()}catch(e){n.src=url=domainRelaxUrl}}self.contentAreaContainer=o.iframeContainer;if(o.editorContainer){DOM.get(o.editorContainer).style.display=self.orgDisplay}DOM.get(self.id).style.display="none";DOM.setAttrib(self.id,"aria-hidden",true);if(!url){self.initContentBody()}elm=n=o=null},initContentBody:function(skipWrite){var self=this,settings=self.settings,targetElm=DOM.get(self.id),doc=self.getDoc(),body,contentCssText;if(!settings.inline){self.getElement().style.visibility=self.orgVisibility}if(!skipWrite&&!settings.content_editable){doc.open();doc.write(self.iframeHTML);doc.close()}if(settings.content_editable){self.on("remove",function(){var body=this.getBody();DOM.removeClass(body,"mce-content-body");DOM.removeClass(body,"mce-edit-focus");DOM.setAttrib(body,"tabIndex",null);DOM.setAttrib(body,"contentEditable",null)});DOM.addClass(targetElm,"mce-content-body");targetElm.tabIndex=-1;self.contentDocument=doc=settings.content_document||document;self.contentWindow=settings.content_window||window;self.bodyElement=targetElm;settings.content_document=settings.content_window=null;settings.root_name=targetElm.nodeName.toLowerCase()}body=self.getBody();body.disabled=true;if(!settings.readonly){if(self.inline&&DOM.getStyle(body,"position",true)=="static"){body.style.position="relative"}body.contentEditable=self.getParam("content_editable_state",true)}body.disabled=false;self.schema=new Schema(settings);self.dom=new DOMUtils(doc,{keep_values:true,url_converter:self.convertURL,url_converter_scope:self,hex_colors:settings.force_hex_style_colors,class_filter:settings.class_filter,update_styles:true,root_element:settings.content_editable?self.id:null,collect:settings.content_editable,schema:self.schema,onSetAttrib:function(e){self.fire("SetAttrib",e)}});self.parser=new DomParser(settings,self.schema);self.parser.addAttributeFilter("src,href,style",function(nodes,name){var i=nodes.length,node,dom=self.dom,value,internalName;while(i--){node=nodes[i];value=node.attr(name);internalName="data-mce-"+name;if(!node.attributes.map[internalName]){if(name==="style"){node.attr(internalName,dom.serializeStyle(dom.parseStyle(value),node.name))}else{node.attr(internalName,self.convertURL(value,name,node.name))}}}});self.parser.addNodeFilter("script",function(nodes){var i=nodes.length,node;while(i--){node=nodes[i];node.attr("type","mce-"+(node.attr("type")||"text/javascript"))}});self.parser.addNodeFilter("#cdata",function(nodes){var i=nodes.length,node;while(i--){node=nodes[i];node.type=8;node.name="#comment";node.value="[CDATA["+node.value+"]]"}});self.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(nodes){var i=nodes.length,node,nonEmptyElements=self.schema.getNonEmptyElements();while(i--){node=nodes[i];if(node.isEmpty(nonEmptyElements)){node.empty().append(new Node("br",1)).shortEnded=true}}});self.serializer=new DomSerializer(settings,self);self.selection=new Selection(self.dom,self.getWin(),self.serializer,self);self.formatter=new Formatter(self);self.undoManager=new UndoManager(self);self.forceBlocks=new ForceBlocks(self);self.enterKey=new EnterKey(self);self.editorCommands=new EditorCommands(self);self.fire("PreInit");if(!settings.browser_spellcheck&&!settings.gecko_spellcheck){doc.body.spellcheck=false;DOM.setAttrib(body,"spellcheck","false")}self.fire("PostRender");self.quirks=Quirks(self);if(settings.directionality){body.dir=settings.directionality}if(settings.nowrap){body.style.whiteSpace="nowrap"}if(settings.protect){self.on("BeforeSetContent",function(e){each(settings.protect,function(pattern){e.content=e.content.replace(pattern,function(str){return"<!--mce:protected "+escape(str)+"-->"})})})}self.on("SetContent",function(){self.addVisual(self.getBody())});if(settings.padd_empty_editor){self.on("PostProcess",function(e){e.content=e.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")})}self.load({initial:true,format:"html"});self.startContent=self.getContent({format:"raw"});self.initialized=true;each(self._pendingNativeEvents,function(name){self.dom.bind(getEventTarget(self,name),name,function(e){self.fire(e.type,e)})});self.fire("init");self.focus(true);self.nodeChanged({initial:true});self.execCallback("init_instance_callback",self);if(self.contentStyles.length>0){contentCssText="";each(self.contentStyles,function(style){contentCssText+=style+"\r\n"});self.dom.addStyle(contentCssText)}each(self.contentCSS,function(cssUrl){if(!self.loadedCSS[cssUrl]){self.dom.loadCSS(cssUrl);self.loadedCSS[cssUrl]=true}});if(settings.auto_focus){setTimeout(function(){var ed=self.editorManager.get(settings.auto_focus);ed.selection.select(ed.getBody(),1);ed.selection.collapse(1);ed.getBody().focus();ed.getWin().focus()},100)}targetElm=doc=body=null},focus:function(skip_focus){var oed,self=this,selection=self.selection,contentEditable=self.settings.content_editable,rng;var controlElm,doc=self.getDoc(),body;if(!skip_focus){rng=selection.getRng();if(rng.item){controlElm=rng.item(0)}self._refreshContentEditable();if(!contentEditable){if(!Env.opera){self.getBody().focus()}self.getWin().focus()}if(isGecko||contentEditable){body=self.getBody();if(body.setActive&&Env.ie<11){body.setActive()}else{body.focus()}if(contentEditable){selection.normalize()}}if(controlElm&&controlElm.ownerDocument==doc){rng=doc.body.createControlRange();rng.addElement(controlElm);rng.select()}}if(self.editorManager.activeEditor!=self){if((oed=self.editorManager.activeEditor)){oed.fire("deactivate",{relatedTarget:self})}self.fire("activate",{relatedTarget:oed})}self.editorManager.activeEditor=self},execCallback:function(name){var self=this,callback=self.settings[name],scope;if(!callback){return}if(self.callbackLookup&&(scope=self.callbackLookup[name])){callback=scope.func;scope=scope.scope}if(typeof(callback)==="string"){scope=callback.replace(/\.\w+$/,"");scope=scope?resolve(scope):0;callback=resolve(callback);self.callbackLookup=self.callbackLookup||{};self.callbackLookup[name]={func:callback,scope:scope}}return callback.apply(scope||self,Array.prototype.slice.call(arguments,1))},translate:function(text){var lang=this.settings.language||"en",i18n=this.editorManager.i18n;if(!text){return""}return i18n.data[lang+"."+text]||text.replace(/\{\#([^\}]+)\}/g,function(a,b){return i18n.data[lang+"."+b]||"{#"+b+"}"})},getLang:function(name,defaultVal){return(this.editorManager.i18n.data[(this.settings.language||"en")+"."+name]||(defaultVal!==undefined?defaultVal:"{#"+name+"}"))},getParam:function(name,defaultVal,type){var value=name in this.settings?this.settings[name]:defaultVal,output;if(type==="hash"){output={};if(typeof(value)==="string"){each(value.indexOf("=")>0?value.split(/[;,](?![^=;,]*(?:[;,]|$))/):value.split(","),function(value){value=value.split("=");if(value.length>1){output[trim(value[0])]=trim(value[1])}else{output[trim(value[0])]=trim(value)}})}else{output=value}return output}return value},nodeChanged:function(){var self=this,selection=self.selection,node,parents,root;if(self.initialized&&!self.settings.disable_nodechange){root=self.getBody();node=selection.getStart()||root;node=ie&&node.ownerDocument!=self.getDoc()?self.getBody():node;if(node.nodeName=="IMG"&&selection.isCollapsed()){node=node.parentNode}parents=[];self.dom.getParent(node,function(node){if(node===root){return true}parents.push(node)});self.fire("NodeChange",{element:node,parents:parents})}},addButton:function(name,settings){var self=this;if(settings.cmd){settings.onclick=function(){self.execCommand(settings.cmd)}}if(!settings.text&&!settings.icon){settings.icon=name}self.buttons=self.buttons||{};settings.tooltip=settings.tooltip||settings.title;self.buttons[name]=settings},addMenuItem:function(name,settings){var self=this;if(settings.cmd){settings.onclick=function(){self.execCommand(settings.cmd)}}self.menuItems=self.menuItems||{};self.menuItems[name]=settings},addCommand:function(name,callback,scope){this.execCommands[name]={func:callback,scope:scope||this}},addQueryStateHandler:function(name,callback,scope){this.queryStateCommands[name]={func:callback,scope:scope||this}},addQueryValueHandler:function(name,callback,scope){this.queryValueCommands[name]={func:callback,scope:scope||this}},addShortcut:function(pattern,desc,cmdFunc,scope){this.shortcuts.add(pattern,desc,cmdFunc,scope)},execCommand:function(cmd,ui,value,args){var self=this,state=0,cmdItem;if(!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(cmd)&&(!args||!args.skip_focus)){self.focus()}args=extend({},args);args=self.fire("BeforeExecCommand",{command:cmd,ui:ui,value:value});if(args.isDefaultPrevented()){return false}if((cmdItem=self.execCommands[cmd])){if(cmdItem.func.call(cmdItem.scope,ui,value)!==true){self.fire("ExecCommand",{command:cmd,ui:ui,value:value});return true}}each(self.plugins,function(p){if(p.execCommand&&p.execCommand(cmd,ui,value)){self.fire("ExecCommand",{command:cmd,ui:ui,value:value});state=true;return false}});if(state){return state}if(self.theme&&self.theme.execCommand&&self.theme.execCommand(cmd,ui,value)){self.fire("ExecCommand",{command:cmd,ui:ui,value:value});return true}if(self.editorCommands.execCommand(cmd,ui,value)){self.fire("ExecCommand",{command:cmd,ui:ui,value:value});return true}self.getDoc().execCommand(cmd,ui,value);self.fire("ExecCommand",{command:cmd,ui:ui,value:value})},queryCommandState:function(cmd){var self=this,queryItem,returnVal;if(self._isHidden()){return}if((queryItem=self.queryStateCommands[cmd])){returnVal=queryItem.func.call(queryItem.scope);if(returnVal!==true){return returnVal}}returnVal=self.editorCommands.queryCommandState(cmd);if(returnVal!==-1){return returnVal}try{return self.getDoc().queryCommandState(cmd)}catch(ex){}},queryCommandValue:function(cmd){var self=this,queryItem,returnVal;if(self._isHidden()){return}if((queryItem=self.queryValueCommands[cmd])){returnVal=queryItem.func.call(queryItem.scope);if(returnVal!==true){return returnVal}}returnVal=self.editorCommands.queryCommandValue(cmd);if(returnVal!==undefined){return returnVal}try{return self.getDoc().queryCommandValue(cmd)}catch(ex){}},show:function(){var self=this;DOM.show(self.getContainer());DOM.hide(self.id);self.load();self.fire("show")},hide:function(){var self=this,doc=self.getDoc();if(ie&&doc&&!self.inline){doc.execCommand("SelectAll")}self.save();DOM.hide(self.getContainer());DOM.setStyle(self.id,"display",self.orgDisplay);self.fire("hide")},isHidden:function(){return !DOM.isHidden(this.id)},setProgressState:function(state,time){this.fire("ProgressState",{state:state,time:time})},load:function(args){var self=this,elm=self.getElement(),html;if(elm){args=args||{};args.load=true;html=self.setContent(elm.value!==undefined?elm.value:elm.innerHTML,args);args.element=elm;if(!args.no_events){self.fire("LoadContent",args)}args.element=elm=null;return html}},save:function(args){var self=this,elm=self.getElement(),html,form;if(!elm||!self.initialized){return}args=args||{};args.save=true;args.element=elm;html=args.content=self.getContent(args);if(!args.no_events){self.fire("SaveContent",args)}html=args.content;if(!/TEXTAREA|INPUT/i.test(elm.nodeName)){elm.innerHTML=html;if((form=DOM.getParent(self.id,"form"))){each(form.elements,function(elm){if(elm.name==self.id){elm.value=html;return false}})}}else{elm.value=html}args.element=elm=null;if(args.set_dirty!==false){self.isNotDirty=true}return html},setContent:function(content,args){var self=this,body=self.getBody(),forcedRootBlockName;args=args||{};args.format=args.format||"html";args.set=true;args.content=content;if(!args.no_events){self.fire("BeforeSetContent",args)}content=args.content;if(content.length===0||/^\s+$/.test(content)){forcedRootBlockName=self.settings.forced_root_block;if(forcedRootBlockName&&self.schema.isValidChild(body.nodeName.toLowerCase(),forcedRootBlockName.toLowerCase())){content=ie&&ie<11?"":'<br data-mce-bogus="1">';content=self.dom.createHTML(forcedRootBlockName,self.settings.forced_root_block_attrs,content)}else{if(!ie||ie<11){content='<br data-mce-bogus="1">'}}body.innerHTML=content;self.fire("SetContent",args)}else{if(args.format!=="raw"){content=new Serializer({},self.schema).serialize(self.parser.parse(content,{isRootContent:true}))}args.content=trim(content);self.dom.setHTML(body,args.content);if(!args.no_events){self.fire("SetContent",args)}}return args.content},getContent:function(args){var self=this,content,body=self.getBody();args=args||{};args.format=args.format||"html";args.get=true;args.getInner=true;if(!args.no_events){self.fire("BeforeGetContent",args)}if(args.format=="raw"){content=body.innerHTML}else{if(args.format=="text"){content=body.innerText||body.textContent}else{content=self.serializer.serialize(body,args)}}if(args.format!="text"){args.content=trim(content)}else{args.content=content}if(!args.no_events){self.fire("GetContent",args)}return args.content},insertContent:function(content){this.execCommand("mceInsertContent",false,content)},isDirty:function(){return !this.isNotDirty},getContainer:function(){var self=this;if(!self.container){self.container=DOM.get(self.editorContainer||self.id+"_parent")}return self.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return DOM.get(this.settings.content_element||this.id)},getWin:function(){var self=this,elm;if(!self.contentWindow){elm=DOM.get(self.id+"_ifr");if(elm){self.contentWindow=elm.contentWindow}}return self.contentWindow},getDoc:function(){var self=this,win;if(!self.contentDocument){win=self.getWin();if(win){self.contentDocument=win.document}}return self.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(url,name,elm){var self=this,settings=self.settings;if(settings.urlconverter_callback){return self.execCallback("urlconverter_callback",url,elm,true,name)}if(!settings.convert_urls||(elm&&elm.nodeName=="LINK")||url.indexOf("file:")===0||url.length===0){return url}if(settings.relative_urls){return self.documentBaseURI.toRelative(url)}url=self.documentBaseURI.toAbsolute(url,settings.remove_script_host);return url},addVisual:function(elm){var self=this,settings=self.settings,dom=self.dom,cls;elm=elm||self.getBody();if(self.hasVisual===undefined){self.hasVisual=settings.visual}each(dom.select("table,a",elm),function(elm){var value;switch(elm.nodeName){case"TABLE":cls=settings.visual_table_class||"mce-item-table";value=dom.getAttrib(elm,"border");if(!value||value=="0"){if(self.hasVisual){dom.addClass(elm,cls)}else{dom.removeClass(elm,cls)}}return;case"A":if(!dom.getAttrib(elm,"href",false)){value=dom.getAttrib(elm,"name")||elm.id;cls="mce-item-anchor";if(value){if(self.hasVisual){dom.addClass(elm,cls)}else{dom.removeClass(elm,cls)}}}return}});self.fire("VisualAid",{element:elm,hasVisual:self.hasVisual})},remove:function(){var self=this;if(!self.removed){self.removed=1;if(self.hasHiddenInput){DOM.remove(self.getElement().nextSibling)}var doc=self.getDoc();if(ie&&doc&&!self.inline){doc.execCommand("SelectAll")}self.save();DOM.setStyle(self.id,"display",self.orgDisplay);if(!self.settings.content_editable){Event.unbind(self.getWin());Event.unbind(self.getDoc())}var elm=self.getContainer();Event.unbind(self.getBody());Event.unbind(elm);self.fire("remove");self.editorManager.remove(self);DOM.remove(elm);self.destroy()}},bindNative:function(name){var self=this;if(self.settings.readonly){return}if(self.initialized){self.dom.bind(getEventTarget(self,name),name,function(e){self.fire(name,e)})}else{if(!self._pendingNativeEvents){self._pendingNativeEvents=[name]}else{self._pendingNativeEvents.push(name)}}},unbindNative:function(name){var self=this;if(self.initialized){self.dom.unbind(name)}},destroy:function(automatic){var self=this,form;if(self.destroyed){return}if(!automatic&&!self.removed){self.remove();return}if(automatic&&isGecko){Event.unbind(self.getDoc());Event.unbind(self.getWin());Event.unbind(self.getBody())}if(!automatic){self.editorManager.off("beforeunload",self._beforeUnload);if(self.theme&&self.theme.destroy){self.theme.destroy()}self.selection.destroy();self.dom.destroy()}form=self.formElement;if(form){if(form._mceOldSubmit){form.submit=form._mceOldSubmit;form._mceOldSubmit=null}DOM.unbind(form,"submit reset",self.formEventDelegate)}self.contentAreaContainer=self.formElement=self.container=null;self.settings.content_element=self.bodyElement=self.contentDocument=self.contentWindow=null;if(self.selection){self.selection=self.selection.win=self.selection.dom=self.selection.dom.doc=null}self.destroyed=1},_refreshContentEditable:function(){var self=this,body,parent;if(self._isHidden()){body=self.getBody();parent=body.parentNode;parent.removeChild(body);parent.appendChild(body);body.focus()}},_isHidden:function(){var sel;if(!isGecko){return 0}sel=this.selection.getSel();return(!sel||!sel.rangeCount||sel.rangeCount===0)}};extend(Editor.prototype,Observable);return Editor});define("tinymce/util/I18n",[],function(){var data={};return{rtl:false,add:function(code,items){for(var name in items){data[name]=items[name]}this.rtl=this.rtl||data._dir==="rtl"},translate:function(text){if(typeof(text)=="undefined"){return text}if(typeof(text)!="string"&&text.raw){return text.raw}if(text.push){var values=text.slice(1);text=(data[text[0]]||text[0]).replace(/\{([^\}]+)\}/g,function(match1,match2){return values[match2]})}return data[text]||text},data:data}});define("tinymce/FocusManager",["tinymce/dom/DOMUtils","tinymce/Env"],function(DOMUtils,Env){function FocusManager(editorManager){function getActiveElement(){try{return document.activeElement}catch(ex){return document.body}}function createBookmark(rng){if(rng&&rng.startContainer){return{startContainer:rng.startContainer,startOffset:rng.startOffset,endContainer:rng.endContainer,endOffset:rng.endOffset}}return rng}function bookmarkToRng(editor,bookmark){var rng;if(bookmark.startContainer){rng=editor.getDoc().createRange();rng.setStart(bookmark.startContainer,bookmark.startOffset);rng.setEnd(bookmark.endContainer,bookmark.endOffset)}else{rng=bookmark}return rng}function registerEvents(e){var editor=e.editor,lastRng,selectionChangeHandler;function isUIElement(elm){return !!DOMUtils.DOM.getParent(elm,FocusManager.isEditorUIElement)}function isNodeInBody(node){var body=editor.getBody();while(node){if(node==body){return true}node=node.parentNode}}editor.on("init",function(){if("onbeforedeactivate" in document&&Env.ie<11){editor.dom.bind(editor.getBody(),"beforedeactivate",function(){var ieSelection=editor.getDoc().selection;try{lastRng=ieSelection&&ieSelection.createRange?ieSelection.createRange():editor.selection.getRng()}catch(ex){}})}else{if(editor.inline||Env.ie>10){editor.on("nodechange keyup",function(){var node=document.activeElement;if(node&&node.id==editor.id+"_ifr"){node=editor.getBody()}if(isNodeInBody(node)){lastRng=editor.selection.getRng()}});if(Env.webkit){selectionChangeHandler=function(){var rng=editor.selection.getRng();if(!rng.collapsed){lastRng=rng}};DOMUtils.DOM.bind(document,"selectionchange",selectionChangeHandler);editor.on("remove",function(){DOMUtils.DOM.unbind(document,"selectionchange",selectionChangeHandler)})}}}});editor.on("setcontent",function(){lastRng=null});editor.on("mousedown",function(){editor.selection.lastFocusBookmark=null});editor.on("focusin",function(){var focusedEditor=editorManager.focusedEditor;if(editor.selection.lastFocusBookmark){editor.selection.setRng(bookmarkToRng(editor,editor.selection.lastFocusBookmark));editor.selection.lastFocusBookmark=null}if(focusedEditor!=editor){if(focusedEditor){focusedEditor.fire("blur",{focusedEditor:editor})}editorManager.activeEditor=editor;editor.fire("focus",{blurredEditor:focusedEditor});editor.focus(false);editorManager.focusedEditor=editor}lastRng=null});editor.on("focusout",function(e){if(e.target!==editor.getBody()&&isNodeInBody(e.target)){return}editor.selection.lastFocusBookmark=createBookmark(lastRng);window.setTimeout(function(){var focusedEditor=editorManager.focusedEditor;if(focusedEditor!=editor){editor.selection.lastFocusBookmark=null}if(!isUIElement(getActiveElement())&&focusedEditor==editor){editor.fire("blur",{focusedEditor:null});editorManager.focusedEditor=null;editor.selection.lastFocusBookmark=null}},0)})}editorManager.on("AddEditor",registerEvents)}FocusManager.isEditorUIElement=function(elm){return elm.className.indexOf("mce-")!==-1};return FocusManager});define("tinymce/EditorManager",["tinymce/Editor","tinymce/dom/DOMUtils","tinymce/util/URI","tinymce/Env","tinymce/util/Tools","tinymce/util/Observable","tinymce/util/I18n","tinymce/FocusManager"],function(Editor,DOMUtils,URI,Env,Tools,Observable,I18n,FocusManager){var DOM=DOMUtils.DOM;var explode=Tools.explode,each=Tools.each,extend=Tools.extend;var instanceCounter=0,beforeUnloadDelegate;var EditorManager={majorVersion:"4",minorVersion:"0.11",releaseDate:"2013-11-20",editors:[],i18n:I18n,activeEditor:null,setup:function(){var self=this,baseURL,documentBaseURL,suffix="",preInit;documentBaseURL=document.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,"");if(!/[\/\\]$/.test(documentBaseURL)){documentBaseURL+="/"}preInit=window.tinymce||window.tinyMCEPreInit;if(preInit){baseURL=preInit.base||preInit.baseURL;suffix=preInit.suffix}else{var scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;i++){var src=scripts[i].src;if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(src)){if(src.indexOf(".min")!=-1){suffix=".min"}baseURL=src.substring(0,src.lastIndexOf("/"));break}}}self.baseURL=new URI(documentBaseURL).toAbsolute(baseURL);self.documentBaseURL=documentBaseURL;self.baseURI=new URI(self.baseURL);self.suffix=suffix;self.focusManager=new FocusManager(self)},init:function(settings){var self=this,editors=[],editor;function createId(elm){var id=elm.id;if(!id){id=elm.name;if(id&&!DOM.get(id)){id=elm.name}else{id=DOM.uniqueId()}elm.setAttribute("id",id)}return id}function execCallback(se,n,s){var f=se[n];if(!f){return}return f.apply(s||this,Array.prototype.slice.call(arguments,2))}function hasClass(n,c){return c.constructor===RegExp?c.test(n.className):DOM.hasClass(n,c)}function readyHandler(){var l,co;DOM.unbind(window,"ready",readyHandler);execCallback(settings,"onpageload");if(settings.types){each(settings.types,function(type){each(DOM.select(type.selector),function(elm){var editor=new Editor(createId(elm),extend({},settings,type),self);editors.push(editor);editor.render(1)})});return}else{if(settings.selector){each(DOM.select(settings.selector),function(elm){var editor=new Editor(createId(elm),settings,self);editors.push(editor);editor.render(1)});return}}switch(settings.mode){case"exact":l=settings.elements||"";if(l.length>0){each(explode(l),function(v){if(DOM.get(v)){editor=new Editor(v,settings,self);editors.push(editor);editor.render(true)}else{each(document.forms,function(f){each(f.elements,function(e){if(e.name===v){v="mce_editor_"+instanceCounter++;DOM.setAttrib(e,"id",v);editor=new Editor(v,settings,self);editors.push(editor);editor.render(1)}})})}})}break;case"textareas":case"specific_textareas":each(DOM.select("textarea"),function(elm){if(settings.editor_deselector&&hasClass(elm,settings.editor_deselector)){return}if(!settings.editor_selector||hasClass(elm,settings.editor_selector)){editor=new Editor(createId(elm),settings,self);editors.push(editor);editor.render(true)}});break}if(settings.oninit){l=co=0;each(editors,function(ed){co++;if(!ed.initialized){ed.on("init",function(){l++;if(l==co){execCallback(settings,"oninit")}})}else{l++}if(l==co){execCallback(settings,"oninit")}})}}self.settings=settings;DOM.bind(window,"ready",readyHandler)},get:function(id){if(id===undefined){return this.editors}return this.editors[id]},add:function(editor){var self=this,editors=self.editors;editors[editor.id]=editor;editors.push(editor);self.activeEditor=editor;self.fire("AddEditor",{editor:editor});if(!beforeUnloadDelegate){beforeUnloadDelegate=function(){self.fire("BeforeUnload")};DOM.bind(window,"beforeunload",beforeUnloadDelegate)}return editor},createEditor:function(id,settings){return this.add(new Editor(id,settings,this))},remove:function(selector){var self=this,i,editors=self.editors,editor,removedFromList;if(!selector){for(i=editors.length-1;i>=0;i--){self.remove(editors[i])}return}if(typeof(selector)=="string"){selector=selector.selector||selector;each(DOM.select(selector),function(elm){self.remove(editors[elm.id])});return}editor=selector;if(!editors[editor.id]){return null}delete editors[editor.id];for(i=0;i<editors.length;i++){if(editors[i]==editor){editors.splice(i,1);removedFromList=true;break}}if(self.activeEditor==editor){self.activeEditor=editors[0]}if(removedFromList){self.fire("RemoveEditor",{editor:editor})}if(!editors.length){DOM.unbind(window,"beforeunload",beforeUnloadDelegate)}editor.remove();return editor},execCommand:function(cmd,ui,value){var self=this,editor=self.get(value);switch(cmd){case"mceAddEditor":if(!self.get(value)){new Editor(value,self.settings,self).render()}return true;case"mceRemoveEditor":if(editor){editor.remove()}return true;case"mceToggleEditor":if(!editor){self.execCommand("mceAddEditor",0,value);return true}if(editor.isHidden()){editor.show()}else{editor.hide()}return true}if(self.activeEditor){return self.activeEditor.execCommand(cmd,ui,value)}return false},triggerSave:function(){each(this.editors,function(editor){editor.save()})},addI18n:function(code,items){I18n.add(code,items)},translate:function(text){return I18n.translate(text)}};extend(EditorManager,Observable);EditorManager.setup();window.tinymce=window.tinyMCE=EditorManager;return EditorManager});define("tinymce/LegacyInput",["tinymce/EditorManager","tinymce/util/Tools"],function(EditorManager,Tools){var each=Tools.each,explode=Tools.explode;EditorManager.on("AddEditor",function(e){var editor=e.editor;editor.on("preInit",function(){var filters,fontSizes,dom,settings=editor.settings;function replaceWithSpan(node,styles){each(styles,function(value,name){if(value){dom.setStyle(node,name,value)}});dom.rename(node,"span")}function convert(e){dom=editor.dom;if(settings.convert_fonts_to_spans){each(dom.select("font,u,strike",e.node),function(node){filters[node.nodeName.toLowerCase()](dom,node)})}}if(settings.inline_styles){fontSizes=explode(settings.font_size_legacy_values);filters={font:function(dom,node){replaceWithSpan(node,{backgroundColor:node.style.backgroundColor,color:node.color,fontFamily:node.face,fontSize:fontSizes[parseInt(node.size,10)-1]})},u:function(dom,node){replaceWithSpan(node,{textDecoration:"underline"})},strike:function(dom,node){replaceWithSpan(node,{textDecoration:"line-through"})}};editor.on("PreProcess SetContent",convert)}})})});define("tinymce/util/XHR",[],function(){return{send:function(settings){var xhr,count=0;function ready(){if(!settings.async||xhr.readyState==4||count++>10000){if(settings.success&&count<10000&&xhr.status==200){settings.success.call(settings.success_scope,""+xhr.responseText,xhr,settings)}else{if(settings.error){settings.error.call(settings.error_scope,count>10000?"TIMED_OUT":"GENERAL",xhr,settings)}}xhr=null}else{setTimeout(ready,10)}}settings.scope=settings.scope||this;settings.success_scope=settings.success_scope||settings.scope;settings.error_scope=settings.error_scope||settings.scope;settings.async=settings.async===false?false:true;settings.data=settings.data||"";xhr=new XMLHttpRequest();if(xhr){if(xhr.overrideMimeType){xhr.overrideMimeType(settings.content_type)}xhr.open(settings.type||(settings.data?"POST":"GET"),settings.url,settings.async);if(settings.content_type){xhr.setRequestHeader("Content-Type",settings.content_type)}xhr.setRequestHeader("X-Requested-With","XMLHttpRequest");xhr.send(settings.data);if(!settings.async){return ready()}setTimeout(ready,10)}}}});define("tinymce/util/JSON",[],function(){function serialize(o,quote){var i,v,t,name;quote=quote||'"';if(o===null){return"null"}t=typeof o;if(t=="string"){v="\bb\tt\nn\ff\rr\"\"''\\\\";return quote+o.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,b){if(quote==='"'&&a==="'"){return a}i=v.indexOf(b);if(i+1){return"\\"+v.charAt(i+1)}a=b.charCodeAt().toString(16);return"\\u"+"0000".substring(a.length)+a})+quote}if(t=="object"){if(o.hasOwnProperty&&Object.prototype.toString.call(o)==="[object Array]"){for(i=0,v="[";i<o.length;i++){v+=(i>0?",":"")+serialize(o[i],quote)}return v+"]"}v="{";for(name in o){if(o.hasOwnProperty(name)){v+=typeof o[name]!="function"?(v.length>1?","+quote:quote)+name+quote+":"+serialize(o[name],quote):""}}return v+"}"}return""+o}return{serialize:serialize,parse:function(text){try{return window[String.fromCharCode(101)+"val"]("("+text+")")}catch(ex){}}}});define("tinymce/util/JSONRequest",["tinymce/util/JSON","tinymce/util/XHR","tinymce/util/Tools"],function(JSON,XHR,Tools){var extend=Tools.extend;function JSONRequest(settings){this.settings=extend({},settings);this.count=0}JSONRequest.sendRPC=function(o){return new JSONRequest().send(o)};JSONRequest.prototype={send:function(args){var ecb=args.error,scb=args.success;args=extend(this.settings,args);args.success=function(c,x){c=JSON.parse(c);if(typeof(c)=="undefined"){c={error:"JSON Parse error."}}if(c.error){ecb.call(args.error_scope||args.scope,c.error,x)}else{scb.call(args.success_scope||args.scope,c.result)}};args.error=function(ty,x){if(ecb){ecb.call(args.error_scope||args.scope,ty,x)}};args.data=JSON.serialize({id:args.id||"c"+(this.count++),method:args.method,params:args.params});args.content_type="application/json";XHR.send(args)}};return JSONRequest});define("tinymce/util/JSONP",["tinymce/dom/DOMUtils"],function(DOMUtils){return{callbacks:{},count:0,send:function(settings){var self=this,dom=DOMUtils.DOM,count=settings.count!==undefined?settings.count:self.count;var id="tinymce_jsonp_"+count;self.callbacks[count]=function(json){dom.remove(id);delete self.callbacks[count];settings.callback(json)};dom.add(dom.doc.body,"script",{id:id,src:settings.url,type:"text/javascript"});self.count++}}});define("tinymce/util/LocalStorage",[],function(){var LocalStorage,storageElm,items,keys,userDataKey,hasOldIEDataSupport;try{if(window.localStorage){return localStorage}}catch(ex){}userDataKey="tinymce";storageElm=document.documentElement;hasOldIEDataSupport=!!storageElm.addBehavior;if(hasOldIEDataSupport){storageElm.addBehavior("#default#userData")}function updateKeys(){keys=[];for(var key in items){keys.push(key)}LocalStorage.length=keys.length}function load(){var key,data,value,pos=0;items={};if(!hasOldIEDataSupport){return}function next(end){var value,nextPos;nextPos=end!==undefined?pos+end:data.indexOf(",",pos);if(nextPos===-1||nextPos>data.length){return null}value=data.substring(pos,nextPos);pos=nextPos+1;return value}storageElm.load(userDataKey);data=storageElm.getAttribute(userDataKey)||"";do{var offset=next();if(offset===null){break}key=next(parseInt(offset,32)||0);if(key!==null){offset=next();if(offset===null){break}value=next(parseInt(offset,32)||0);if(key){items[key]=value}}}while(key!==null);updateKeys()}function save(){var value,data="";if(!hasOldIEDataSupport){return}for(var key in items){value=items[key];data+=(data?",":"")+key.length.toString(32)+","+key+","+value.length.toString(32)+","+value}storageElm.setAttribute(userDataKey,data);try{storageElm.save(userDataKey)}catch(ex){}updateKeys()}LocalStorage={key:function(index){return keys[index]},getItem:function(key){return key in items?items[key]:null},setItem:function(key,value){items[key]=""+value;save()},removeItem:function(key){delete items[key];save()},clear:function(){items={};save()}};load();return LocalStorage});define("tinymce/Compat",["tinymce/dom/DOMUtils","tinymce/dom/EventUtils","tinymce/dom/ScriptLoader","tinymce/AddOnManager","tinymce/util/Tools","tinymce/Env"],function(DOMUtils,EventUtils,ScriptLoader,AddOnManager,Tools,Env){var tinymce=window.tinymce;tinymce.DOM=DOMUtils.DOM;tinymce.ScriptLoader=ScriptLoader.ScriptLoader;tinymce.PluginManager=AddOnManager.PluginManager;tinymce.ThemeManager=AddOnManager.ThemeManager;tinymce.dom=tinymce.dom||{};tinymce.dom.Event=EventUtils.Event;Tools.each(Tools,function(func,key){tinymce[key]=func});Tools.each("isOpera isWebKit isIE isGecko isMac".split(" "),function(name){tinymce[name]=Env[name.substr(2).toLowerCase()]});return{}});define("tinymce/ui/Layout",["tinymce/util/Class","tinymce/util/Tools"],function(Class,Tools){return Class.extend({Defaults:{firstControlClass:"first",lastControlClass:"last"},init:function(settings){this.settings=Tools.extend({},this.Defaults,settings)},preRender:function(container){container.addClass(this.settings.containerClass,"body")},applyClasses:function(container){var self=this,settings=self.settings,items,firstClass,lastClass;items=container.items().filter(":visible");firstClass=settings.firstControlClass;lastClass=settings.lastControlClass;items.each(function(item){item.removeClass(firstClass).removeClass(lastClass);if(settings.controlClass){item.addClass(settings.controlClass)}});items.eq(0).addClass(firstClass);items.eq(-1).addClass(lastClass)},renderHtml:function(container){var self=this,settings=self.settings,items,html="";items=container.items();items.eq(0).addClass(settings.firstControlClass);items.eq(-1).addClass(settings.lastControlClass);items.each(function(item){if(settings.controlClass){item.addClass(settings.controlClass)}html+=item.renderHtml()});return html},recalc:function(){},postRender:function(){}})});define("tinymce/ui/AbsoluteLayout",["tinymce/ui/Layout"],function(Layout){return Layout.extend({Defaults:{containerClass:"abs-layout",controlClass:"abs-layout-item"},recalc:function(container){container.items().filter(":visible").each(function(ctrl){var settings=ctrl.settings;ctrl.layoutRect({x:settings.x,y:settings.y,w:settings.w,h:settings.h});if(ctrl.recalc){ctrl.recalc()}})},renderHtml:function(container){return'<div id="'+container._id+'-absend" class="'+container.classPrefix+'abs-end"></div>'+this._super(container)}})});define("tinymce/ui/Tooltip",["tinymce/ui/Control","tinymce/ui/Movable"],function(Control,Movable){return Control.extend({Mixins:[Movable],Defaults:{classes:"widget tooltip tooltip-n"},text:function(value){var self=this;if(typeof(value)!="undefined"){self._value=value;if(self._rendered){self.getEl().lastChild.innerHTML=self.encode(value)}return self}return self._value},renderHtml:function(){var self=this,prefix=self.classPrefix;return('<div id="'+self._id+'" class="'+self.classes()+'" role="presentation"><div class="'+prefix+'tooltip-arrow"></div><div class="'+prefix+'tooltip-inner">'+self.encode(self._text)+"</div></div>")},repaint:function(){var self=this,style,rect;style=self.getEl().style;rect=self._layoutRect;style.left=rect.x+"px";style.top=rect.y+"px";style.zIndex=65535+65535}})});define("tinymce/ui/Widget",["tinymce/ui/Control","tinymce/ui/Tooltip"],function(Control,Tooltip){var tooltip;var Widget=Control.extend({init:function(settings){var self=this;self._super(settings);self.canFocus=true;if(settings.tooltip&&Widget.tooltips!==false){self.on("mouseenter mouseleave",function(e){var tooltip=self.tooltip().moveTo(-65535);if(e.control==self&&e.type=="mouseenter"){var rel=tooltip.text(settings.tooltip).show().testMoveRel(self.getEl(),["bc-tc","bc-tl","bc-tr"]);tooltip.toggleClass("tooltip-n",rel=="bc-tc");tooltip.toggleClass("tooltip-nw",rel=="bc-tl");tooltip.toggleClass("tooltip-ne",rel=="bc-tr");tooltip.moveRel(self.getEl(),rel)}else{tooltip.hide()}})}self.aria("label",settings.tooltip)},tooltip:function(){var self=this;if(!tooltip){tooltip=new Tooltip({type:"tooltip"});tooltip.renderTo(self.getContainerElm())}return tooltip},active:function(state){var self=this,undef;if(state!==undef){self.aria("pressed",state);self.toggleClass("active",state)}return self._super(state)},disabled:function(state){var self=this,undef;if(state!==undef){self.aria("disabled",state);self.toggleClass("disabled",state)}return self._super(state)},postRender:function(){var self=this,settings=self.settings;self._rendered=true;self._super();if(!self.parent()&&(settings.width||settings.height)){self.initLayoutRect();self.repaint()}if(settings.autofocus){setTimeout(function(){self.focus()},0)}},remove:function(){this._super();if(tooltip){tooltip.remove();tooltip=null}}});return Widget});define("tinymce/ui/Button",["tinymce/ui/Widget"],function(Widget){return Widget.extend({Defaults:{classes:"widget btn",role:"button"},init:function(settings){var self=this,size;self.on("click mousedown",function(e){e.preventDefault()});self._super(settings);size=settings.size;if(settings.subtype){self.addClass(settings.subtype)}if(size){self.addClass("btn-"+size)}},icon:function(icon){var self=this,prefix=self.classPrefix;if(typeof(icon)=="undefined"){return self.settings.icon}self.settings.icon=icon;icon=icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"";if(self._rendered){var btnElm=self.getEl().firstChild,iconElm=btnElm.getElementsByTagName("i")[0];if(icon){if(!iconElm||iconElm!=btnElm.firstChild){iconElm=document.createElement("i");btnElm.insertBefore(iconElm,btnElm.firstChild)}iconElm.className=icon}else{if(iconElm){btnElm.removeChild(iconElm)}}self.text(self._text)}return self},repaint:function(){var btnStyle=this.getEl().firstChild.style;btnStyle.width=btnStyle.height="100%";this._super()},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix;var icon=self.settings.icon,image="";if(self.settings.image){icon="none";image=" style=\"background-image: url('"+self.settings.image+"')\""}icon=self.settings.icon?prefix+"ico "+prefix+"i-"+icon:"";return('<div id="'+id+'" class="'+self.classes()+'" tabindex="-1"><button role="presentation" type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+(self._text?(icon?"\u00a0":"")+self.encode(self._text):"")+"</button></div>")}})});define("tinymce/ui/ButtonGroup",["tinymce/ui/Container"],function(Container){return Container.extend({Defaults:{defaultType:"button",role:"toolbar"},renderHtml:function(){var self=this,layout=self._layout;self.addClass("btn-group");self.preRender();layout.preRender(self);return('<div id="'+self._id+'" class="'+self.classes()+'"><div id="'+self._id+'-body">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></div>")}})});define("tinymce/ui/Checkbox",["tinymce/ui/Widget"],function(Widget){return Widget.extend({Defaults:{classes:"checkbox",role:"checkbox",checked:false},init:function(settings){var self=this;self._super(settings);self.on("click mousedown",function(e){e.preventDefault()});self.on("click",function(e){e.preventDefault();if(!self.disabled()){self.checked(!self.checked())}});self.checked(self.settings.checked)},checked:function(state){var self=this;if(typeof state!="undefined"){if(state){self.addClass("checked")}else{self.removeClass("checked")}self._checked=state;self.aria("checked",state);return self}return self._checked},value:function(state){return this.checked(state)},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix;return('<div id="'+id+'" class="'+self.classes()+'" unselectable="on" aria-labeledby="'+id+'-al" tabindex="-1"><i class="'+prefix+"ico "+prefix+'i-checkbox"></i><span id="'+id+'-al" class="'+prefix+'label">'+self.encode(self._text)+"</span></div>")}})});define("tinymce/ui/PanelButton",["tinymce/ui/Button","tinymce/ui/FloatPanel"],function(Button,FloatPanel){return Button.extend({showPanel:function(){var self=this,settings=self.settings;self.active(true);if(!self.panel){var panelSettings=settings.panel;if(panelSettings.type){panelSettings={layout:"grid",items:panelSettings}}panelSettings.popover=true;panelSettings.autohide=true;self.panel=new FloatPanel(panelSettings).on("hide",function(){self.active(false)}).parent(self).renderTo(self.getContainerElm());self.panel.fire("show");self.panel.reflow()}else{self.panel.show()}self.panel.moveRel(self.getEl(),settings.popoverAlign||(self.isRtl()?["bc-tr","bc-tc"]:["bc-tl","bc-tc"]))},hidePanel:function(){var self=this;if(self.panel){self.panel.hide()}},postRender:function(){var self=this;self.on("click",function(e){if(e.control===self){if(self.panel&&self.panel.visible()){self.hidePanel()}else{self.showPanel()}}});return self._super()}})});define("tinymce/ui/ColorButton",["tinymce/ui/PanelButton","tinymce/dom/DOMUtils"],function(PanelButton,DomUtils){var DOM=DomUtils.DOM;return PanelButton.extend({init:function(settings){this._super(settings);this.addClass("colorbutton")},color:function(color){if(color){this._color=color;this.getEl("preview").style.backgroundColor=color;return this}return this._color},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix;var icon=self.settings.icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"";var image=self.settings.image?" style=\"background-image: url('"+self.settings.image+"')\"":"";return('<div id="'+id+'" class="'+self.classes()+'"><button role="presentation" hidefocus type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"'+image+"></i>":"")+'<span id="'+id+'-preview" class="'+prefix+'preview"></span>'+(self._text?(icon?" ":"")+(self._text):"")+'</button><button type="button" class="'+prefix+'open" hidefocus tabindex="-1"> <i class="'+prefix+'caret"></i></button></div>')},postRender:function(){var self=this,onClickHandler=self.settings.onclick;self.on("click",function(e){if(e.control==self&&!DOM.getParent(e.target,"."+self.classPrefix+"open")){e.stopImmediatePropagation();onClickHandler.call(self,e)}});delete self.settings.onclick;return self._super()}})});define("tinymce/ui/ComboBox",["tinymce/ui/Widget","tinymce/ui/DomUtils"],function(Widget,DomUtils){return Widget.extend({init:function(settings){var self=this;self._super(settings);self.addClass("combobox");self.on("click",function(e){var elm=e.target;while(elm){if(elm.id&&elm.id.indexOf("-open")!=-1){self.fire("action")}elm=elm.parentNode}});self.on("keydown",function(e){if(e.target.nodeName=="INPUT"&&e.keyCode==13){self.parents().reverse().each(function(ctrl){e.preventDefault();self.fire("change");if(ctrl.hasEventListeners("submit")&&ctrl.toJSON){ctrl.fire("submit",{data:ctrl.toJSON()});return false}})}});if(settings.placeholder){self.addClass("placeholder");self.on("focusin",function(){if(!self._hasOnChange){DomUtils.on(self.getEl("inp"),"change",function(){self.fire("change")});self._hasOnChange=true}if(self.hasClass("placeholder")){self.getEl("inp").value="";self.removeClass("placeholder")}});self.on("focusout",function(){if(self.value().length===0){self.getEl("inp").value=settings.placeholder;self.addClass("placeholder")}})}},value:function(value){var self=this;if(typeof(value)!="undefined"){self._value=value;self.removeClass("placeholder");if(self._rendered){self.getEl("inp").value=value}return self}if(self._rendered){value=self.getEl("inp").value;if(value!=self.settings.placeholder){return value}return""}return self._value},disabled:function(state){var self=this;if(self._rendered&&typeof(state)!="undefined"){self.getEl("inp").disabled=state}return self._super(state)},focus:function(){this.getEl("inp").focus()},repaint:function(){var self=this,elm=self.getEl(),openElm=self.getEl("open"),rect=self.layoutRect();var width,lineHeight;if(openElm){width=rect.w-DomUtils.getSize(openElm).width-10}else{width=rect.w-10}var doc=document;if(doc.all&&(!doc.documentMode||doc.documentMode<=8)){lineHeight=(self.layoutRect().h-2)+"px"}DomUtils.css(elm.firstChild,{width:width,lineHeight:lineHeight});self._super();return self},postRender:function(){var self=this;DomUtils.on(this.getEl("inp"),"change",function(){self.fire("change")});return self._super()},remove:function(){DomUtils.off(this.getEl("inp"));this._super()},renderHtml:function(){var self=this,id=self._id,settings=self.settings,prefix=self.classPrefix;var value=settings.value||settings.placeholder||"";var icon,text,openBtnHtml="";icon=settings.icon?prefix+"ico "+prefix+"i-"+settings.icon:"";text=self._text;if(icon||text){openBtnHtml=('<div id="'+id+'-open" class="'+prefix+"btn "+prefix+'open" tabIndex="-1"><button id="'+id+'-action" type="button" hidefocus tabindex="-1">'+(icon?'<i class="'+icon+'"></i>':'<i class="'+prefix+'caret"></i>')+(text?(icon?" ":"")+text:"")+"</button></div>");self.addClass("has-open")}return('<div id="'+id+'" class="'+self.classes()+'"><input id="'+id+'-inp" class="'+prefix+"textbox "+prefix+'placeholder" value="'+value+'" hidefocus="true"'+(self.disabled()?' disabled="disabled"':"")+">"+openBtnHtml+"</div>")}})});define("tinymce/ui/Path",["tinymce/ui/Widget","tinymce/ui/KeyboardNavigation"],function(Widget,KeyboardNavigation){return Widget.extend({init:function(settings){var self=this;if(!settings.delimiter){settings.delimiter="\u00BB"}self._super(settings);self.addClass("path");self.canFocus=true;self.on("click",function(e){var index,target=e.target;if((index=target.getAttribute("data-index"))){self.fire("select",{value:self.data()[index],index:index})}})},focus:function(){var self=this;self.keyNav=new KeyboardNavigation({root:self,enableLeftRight:true});self.keyNav.focusFirst();return self},data:function(data){var self=this;if(typeof(data)!=="undefined"){self._data=data;self.update();return self}return self._data},update:function(){this.innerHtml(this._getPathHtml())},postRender:function(){var self=this;self._super();self.data(self.settings.data)},renderHtml:function(){var self=this;return('<div id="'+self._id+'" class="'+self.classes()+'">'+self._getPathHtml()+"</div>")},_getPathHtml:function(){var self=this,parts=self._data||[],i,l,html="",prefix=self.classPrefix;for(i=0,l=parts.length;i<l;i++){html+=((i>0?'<div class="'+prefix+'divider" aria-hidden="true"> '+self.settings.delimiter+" </div>":"")+'<div role="button" class="'+prefix+"path-item"+(i==l-1?" "+prefix+"last":"")+'" data-index="'+i+'" tabindex="-1" id="'+self._id+"-"+i+'">'+parts[i].name+"</div>")}if(!html){html='<div class="'+prefix+'path-item">&nbsp;</div>'}return html}})});define("tinymce/ui/ElementPath",["tinymce/ui/Path","tinymce/EditorManager"],function(Path,EditorManager){return Path.extend({postRender:function(){var self=this,editor=EditorManager.activeEditor;function isHidden(elm){if(elm.nodeType===1){if(elm.nodeName=="BR"||!!elm.getAttribute("data-mce-bogus")){return true}if(elm.getAttribute("data-mce-type")==="bookmark"){return true}}return false}self.on("select",function(e){var parents=[],node,body=editor.getBody();editor.focus();node=editor.selection.getStart();while(node&&node!=body){if(!isHidden(node)){parents.push(node)}node=node.parentNode}editor.selection.select(parents[parents.length-1-e.index]);editor.nodeChanged()});editor.on("nodeChange",function(e){var parents=[],selectionParents=e.parents,i=selectionParents.length;while(i--){if(selectionParents[i].nodeType==1&&!isHidden(selectionParents[i])){var args=editor.fire("ResolveName",{name:selectionParents[i].nodeName.toLowerCase(),target:selectionParents[i]});parents.push({name:args.name})}}self.data(parents)});return self._super()}})});define("tinymce/ui/FormItem",["tinymce/ui/Container"],function(Container){return Container.extend({Defaults:{layout:"flex",align:"center",defaults:{flex:1}},renderHtml:function(){var self=this,layout=self._layout,prefix=self.classPrefix;self.addClass("formitem");layout.preRender(self);return('<div id="'+self._id+'" class="'+self.classes()+'" hideFocus="1" tabIndex="-1">'+(self.settings.title?('<div id="'+self._id+'-title" class="'+prefix+'title">'+self.settings.title+"</div>"):"")+'<div id="'+self._id+'-body" class="'+self.classes("body")+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></div>")}})});define("tinymce/ui/Form",["tinymce/ui/Container","tinymce/ui/FormItem"],function(Container,FormItem){return Container.extend({Defaults:{containerCls:"form",layout:"flex",direction:"column",align:"stretch",flex:1,padding:20,labelGap:30,spacing:10,callbacks:{submit:function(){this.submit()}}},preRender:function(){var self=this,items=self.items();items.each(function(ctrl){var formItem,label=ctrl.settings.label;if(label){formItem=new FormItem({layout:"flex",autoResize:"overflow",defaults:{flex:1},items:[{type:"label",text:label,flex:0,forId:ctrl._id}]});formItem.type="formitem";if(typeof(ctrl.settings.flex)=="undefined"){ctrl.settings.flex=1}self.replace(ctrl,formItem);formItem.add(ctrl)}})},recalcLabels:function(){var self=this,maxLabelWidth=0,labels=[],i,labelGap;if(self.settings.labelGapCalc===false){return}self.items().filter("formitem").each(function(item){var labelCtrl=item.items()[0],labelWidth=labelCtrl.getEl().clientWidth;maxLabelWidth=labelWidth>maxLabelWidth?labelWidth:maxLabelWidth;labels.push(labelCtrl)});labelGap=self.settings.labelGap||0;i=labels.length;while(i--){labels[i].settings.minWidth=maxLabelWidth+labelGap}},visible:function(state){var val=this._super(state);if(state===true&&this._rendered){this.recalcLabels()}return val},submit:function(){return this.fire("submit",{data:this.toJSON()})},postRender:function(){var self=this;self._super();self.recalcLabels();self.fromJSON(self.settings.data)}})});define("tinymce/ui/FieldSet",["tinymce/ui/Form"],function(Form){return Form.extend({Defaults:{containerCls:"fieldset",layout:"flex",direction:"column",align:"stretch",flex:1,padding:"25 15 5 15",labelGap:30,spacing:10,border:1},renderHtml:function(){var self=this,layout=self._layout,prefix=self.classPrefix;self.preRender();layout.preRender(self);return('<fieldset id="'+self._id+'" class="'+self.classes()+'" hideFocus="1" tabIndex="-1">'+(self.settings.title?('<legend id="'+self._id+'-title" class="'+prefix+'fieldset-title">'+self.settings.title+"</legend>"):"")+'<div id="'+self._id+'-body" class="'+self.classes("body")+'">'+(self.settings.html||"")+layout.renderHtml(self)+"</div></fieldset>")}})});define("tinymce/ui/FilePicker",["tinymce/ui/ComboBox"],function(ComboBox){return ComboBox.extend({init:function(settings){var self=this,editor=tinymce.activeEditor,fileBrowserCallback;settings.spellcheck=false;fileBrowserCallback=editor.settings.file_browser_callback;if(fileBrowserCallback){settings.icon="browse";settings.onaction=function(){fileBrowserCallback(self.getEl("inp").id,self.getEl("inp").value,settings.filetype,window)}}self._super(settings)}})});define("tinymce/ui/FitLayout",["tinymce/ui/AbsoluteLayout"],function(AbsoluteLayout){return AbsoluteLayout.extend({recalc:function(container){var contLayoutRect=container.layoutRect(),paddingBox=container.paddingBox();container.items().filter(":visible").each(function(ctrl){ctrl.layoutRect({x:paddingBox.left,y:paddingBox.top,w:contLayoutRect.innerW-paddingBox.right-paddingBox.left,h:contLayoutRect.innerH-paddingBox.top-paddingBox.bottom});if(ctrl.recalc){ctrl.recalc()}})}})});define("tinymce/ui/FlexLayout",["tinymce/ui/AbsoluteLayout"],function(AbsoluteLayout){return AbsoluteLayout.extend({recalc:function(container){var i,l,items,contLayoutRect,contPaddingBox,contSettings,align,pack,spacing,totalFlex,availableSpace,direction;var ctrl,ctrlLayoutRect,ctrlSettings,flex,maxSizeItems=[],size,maxSize,ratio,rect,pos,maxAlignEndPos;var sizeName,minSizeName,posName,maxSizeName,beforeName,innerSizeName,afterName,deltaSizeName,contentSizeName;var alignAxisName,alignInnerSizeName,alignSizeName,alignMinSizeName,alignMaxSizeName,alignBeforeName,alignAfterName;var alignDeltaSizeName,alignContentSizeName;var max=Math.max,min=Math.min;items=container.items().filter(":visible");contLayoutRect=container.layoutRect();contPaddingBox=container._paddingBox;contSettings=container.settings;direction=container.isRtl()?(contSettings.direction||"row-reversed"):contSettings.direction;align=contSettings.align;pack=container.isRtl()?(contSettings.pack||"end"):contSettings.pack;spacing=contSettings.spacing||0;if(direction=="row-reversed"||direction=="column-reverse"){items=items.set(items.toArray().reverse());direction=direction.split("-")[0]}if(direction=="column"){posName="y";sizeName="h";minSizeName="minH";maxSizeName="maxH";innerSizeName="innerH";beforeName="top";afterName="bottom";deltaSizeName="deltaH";contentSizeName="contentH";alignBeforeName="left";alignSizeName="w";alignAxisName="x";alignInnerSizeName="innerW";alignMinSizeName="minW";alignMaxSizeName="maxW";alignAfterName="right";alignDeltaSizeName="deltaW";alignContentSizeName="contentW"}else{posName="x";sizeName="w";minSizeName="minW";maxSizeName="maxW";innerSizeName="innerW";beforeName="left";afterName="right";deltaSizeName="deltaW";contentSizeName="contentW";alignBeforeName="top";alignSizeName="h";alignAxisName="y";alignInnerSizeName="innerH";alignMinSizeName="minH";alignMaxSizeName="maxH";alignAfterName="bottom";alignDeltaSizeName="deltaH";alignContentSizeName="contentH"}availableSpace=contLayoutRect[innerSizeName]-contPaddingBox[beforeName]-contPaddingBox[beforeName];maxAlignEndPos=totalFlex=0;for(i=0,l=items.length;i<l;i++){ctrl=items[i];ctrlLayoutRect=ctrl.layoutRect();ctrlSettings=ctrl.settings;flex=ctrlSettings.flex;availableSpace-=(i<l-1?spacing:0);if(flex>0){totalFlex+=flex;if(ctrlLayoutRect[maxSizeName]){maxSizeItems.push(ctrl)}ctrlLayoutRect.flex=flex}availableSpace-=ctrlLayoutRect[minSizeName];size=contPaddingBox[alignBeforeName]+ctrlLayoutRect[alignMinSizeName]+contPaddingBox[alignAfterName];if(size>maxAlignEndPos){maxAlignEndPos=size}}rect={};if(availableSpace<0){rect[minSizeName]=contLayoutRect[minSizeName]-availableSpace+contLayoutRect[deltaSizeName]}else{rect[minSizeName]=contLayoutRect[innerSizeName]-availableSpace+contLayoutRect[deltaSizeName]}rect[alignMinSizeName]=maxAlignEndPos+contLayoutRect[alignDeltaSizeName];rect[contentSizeName]=contLayoutRect[innerSizeName]-availableSpace;rect[alignContentSizeName]=maxAlignEndPos;rect.minW=min(rect.minW,contLayoutRect.maxW);rect.minH=min(rect.minH,contLayoutRect.maxH);rect.minW=max(rect.minW,contLayoutRect.startMinWidth);rect.minH=max(rect.minH,contLayoutRect.startMinHeight);if(contLayoutRect.autoResize&&(rect.minW!=contLayoutRect.minW||rect.minH!=contLayoutRect.minH)){rect.w=rect.minW;rect.h=rect.minH;container.layoutRect(rect);this.recalc(container);if(container._lastRect===null){var parentCtrl=container.parent();if(parentCtrl){parentCtrl._lastRect=null;parentCtrl.recalc()}}return}ratio=availableSpace/totalFlex;for(i=0,l=maxSizeItems.length;i<l;i++){ctrl=maxSizeItems[i];ctrlLayoutRect=ctrl.layoutRect();maxSize=ctrlLayoutRect[maxSizeName];size=ctrlLayoutRect[minSizeName]+ctrlLayoutRect.flex*ratio;if(size>maxSize){availableSpace-=(ctrlLayoutRect[maxSizeName]-ctrlLayoutRect[minSizeName]);totalFlex-=ctrlLayoutRect.flex;ctrlLayoutRect.flex=0;ctrlLayoutRect.maxFlexSize=maxSize}else{ctrlLayoutRect.maxFlexSize=0}}ratio=availableSpace/totalFlex;pos=contPaddingBox[beforeName];rect={};if(totalFlex===0){if(pack=="end"){pos=availableSpace+contPaddingBox[beforeName]}else{if(pack=="center"){pos=Math.round((contLayoutRect[innerSizeName]/2)-((contLayoutRect[innerSizeName]-availableSpace)/2))+contPaddingBox[beforeName];if(pos<0){pos=contPaddingBox[beforeName]}}else{if(pack=="justify"){pos=contPaddingBox[beforeName];spacing=Math.floor(availableSpace/(items.length-1))}}}}rect[alignAxisName]=contPaddingBox[alignBeforeName];for(i=0,l=items.length;i<l;i++){ctrl=items[i];ctrlLayoutRect=ctrl.layoutRect();size=ctrlLayoutRect.maxFlexSize||ctrlLayoutRect[minSizeName];if(align==="center"){rect[alignAxisName]=Math.round((contLayoutRect[alignInnerSizeName]/2)-(ctrlLayoutRect[alignSizeName]/2))}else{if(align==="stretch"){rect[alignSizeName]=max(ctrlLayoutRect[alignMinSizeName]||0,contLayoutRect[alignInnerSizeName]-contPaddingBox[alignBeforeName]-contPaddingBox[alignAfterName]);rect[alignAxisName]=contPaddingBox[alignBeforeName]}else{if(align==="end"){rect[alignAxisName]=contLayoutRect[alignInnerSizeName]-ctrlLayoutRect[alignSizeName]-contPaddingBox.top}}}if(ctrlLayoutRect.flex>0){size+=ctrlLayoutRect.flex*ratio}rect[sizeName]=size;rect[posName]=pos;ctrl.layoutRect(rect);if(ctrl.recalc){ctrl.recalc()}pos+=size+spacing}}})});define("tinymce/ui/FlowLayout",["tinymce/ui/Layout"],function(Layout){return Layout.extend({Defaults:{containerClass:"flow-layout",controlClass:"flow-layout-item",endClass:"break"},recalc:function(container){container.items().filter(":visible").each(function(ctrl){if(ctrl.recalc){ctrl.recalc()}})}})});define("tinymce/ui/FormatControls",["tinymce/ui/Control","tinymce/ui/Widget","tinymce/ui/FloatPanel","tinymce/util/Tools","tinymce/EditorManager","tinymce/Env"],function(Control,Widget,FloatPanel,Tools,EditorManager,Env){var each=Tools.each;EditorManager.on("AddEditor",function(e){if(e.editor.rtl){Control.rtl=true}registerControls(e.editor)});Control.translate=function(text){return EditorManager.translate(text)};Widget.tooltips=!Env.iOS;function registerControls(editor){var formatMenu;function getPreviewCss(format){var name,previewElm,dom=editor.dom;var previewCss="",parentFontSize,previewStyles;previewStyles=editor.settings.preview_styles;if(previewStyles===false){return""}if(!previewStyles){previewStyles="font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius"}function removeVars(val){return val.replace(/%(\w+)/g,"")}format=editor.formatter.get(format);if(!format){return}format=format[0];name=format.block||format.inline||"span";previewElm=dom.create(name);each(format.styles,function(value,name){value=removeVars(value);if(value){dom.setStyle(previewElm,name,value)}});each(format.attributes,function(value,name){value=removeVars(value);if(value){dom.setAttrib(previewElm,name,value)}});each(format.classes,function(value){value=removeVars(value);if(!dom.hasClass(previewElm,value)){dom.addClass(previewElm,value)}});editor.fire("PreviewFormats");dom.setStyles(previewElm,{position:"absolute",left:-65535});editor.getBody().appendChild(previewElm);parentFontSize=dom.getStyle(editor.getBody(),"fontSize",true);parentFontSize=/px$/.test(parentFontSize)?parseInt(parentFontSize,10):0;each(previewStyles.split(" "),function(name){var value=dom.getStyle(previewElm,name,true);if(name=="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(value)){value=dom.getStyle(editor.getBody(),name,true);if(dom.toHex(value).toLowerCase()=="#ffffff"){return}}if(name=="color"){if(dom.toHex(value).toLowerCase()=="#000000"){return}}if(name=="font-size"){if(/em|%$/.test(value)){if(parentFontSize===0){return}value=parseFloat(value,10)/(/%$/.test(value)?100:1);value=(value*parentFontSize)+"px"}}if(name=="border"&&value){previewCss+="padding:0 2px;"}previewCss+=name+":"+value+";"});editor.fire("AfterPreviewFormats");dom.remove(previewElm);return previewCss}function createListBoxChangeHandler(items,formatName){return function(){var self=this;editor.on("nodeChange",function(e){var formatter=editor.formatter;var value=null;each(e.parents,function(node){each(items,function(item){if(formatName){if(formatter.matchNode(node,formatName,{value:item.value})){value=item.value}}else{if(formatter.matchNode(node,item.value)){value=item.value}}if(value){return false}});if(value){return false}});self.value(value)})}}function createFormats(formats){formats=formats.split(";");var i=formats.length;while(i--){formats[i]=formats[i].split("=")}return formats}function createFormatMenu(){var count=0,newFormats=[];var defaultStyleFormats=[{title:"Headers",items:[{title:"Header 1",format:"h1"},{title:"Header 2",format:"h2"},{title:"Header 3",format:"h3"},{title:"Header 4",format:"h4"},{title:"Header 5",format:"h5"},{title:"Header 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strikethrough",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Alignment",items:[{title:"Left",icon:"alignleft",format:"alignleft"},{title:"Center",icon:"aligncenter",format:"aligncenter"},{title:"Right",icon:"alignright",format:"alignright"},{title:"Justify",icon:"alignjustify",format:"alignjustify"}]}];function createMenu(formats){var menu=[];if(!formats){return}each(formats,function(format){var menuItem={text:format.title,icon:format.icon};if(format.items){menuItem.menu=createMenu(format.items)}else{var formatName=format.format||"custom"+count++;if(!format.format){format.name=formatName;newFormats.push(format)}menuItem.format=formatName}menu.push(menuItem)});return menu}editor.on("init",function(){each(newFormats,function(format){editor.formatter.register(format.name,format)})});var menu=createMenu(editor.settings.style_formats||defaultStyleFormats);menu={type:"menu",items:menu,onPostRender:function(e){editor.fire("renderFormatsMenu",{control:e.control})},itemDefaults:{preview:true,textStyle:function(){if(this.settings.format){return getPreviewCss(this.settings.format)}},onPostRender:function(){var self=this,formatName=this.settings.format;if(formatName){self.parent().on("show",function(){self.disabled(!editor.formatter.canApply(formatName));self.active(editor.formatter.match(formatName))})}},onclick:function(){if(this.settings.format){toggleFormat(this.settings.format)}}}};return menu}formatMenu=createFormatMenu();each({bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",subscript:"Subscript",superscript:"Superscript"},function(text,name){editor.addButton(name,{tooltip:text,onPostRender:function(){var self=this;if(editor.formatter){editor.formatter.formatChanged(name,function(state){self.active(state)})}else{editor.on("init",function(){editor.formatter.formatChanged(name,function(state){self.active(state)})})}},onclick:function(){toggleFormat(name)}})});each({outdent:["Decrease indent","Outdent"],indent:["Increase indent","Indent"],cut:["Cut","Cut"],copy:["Copy","Copy"],paste:["Paste","Paste"],help:["Help","mceHelp"],selectall:["Select all","SelectAll"],hr:["Insert horizontal rule","InsertHorizontalRule"],removeformat:["Clear formatting","RemoveFormat"],visualaid:["Visual aids","mceToggleVisualAid"],newdocument:["New document","mceNewDocument"]},function(item,name){editor.addButton(name,{tooltip:item[0],cmd:item[1]})});each({blockquote:["Toggle blockquote","mceBlockQuote"],numlist:["Numbered list","InsertOrderedList"],bullist:["Bullet list","InsertUnorderedList"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],alignleft:["Align left","JustifyLeft"],aligncenter:["Align center","JustifyCenter"],alignright:["Align right","JustifyRight"],alignjustify:["Justify","JustifyFull"]},function(item,name){editor.addButton(name,{tooltip:item[0],cmd:item[1],onPostRender:function(){var self=this;if(editor.formatter){editor.formatter.formatChanged(name,function(state){self.active(state)})}else{editor.on("init",function(){editor.formatter.formatChanged(name,function(state){self.active(state)})})}}})});function hasUndo(){return editor.undoManager?editor.undoManager.hasUndo():false}function hasRedo(){return editor.undoManager?editor.undoManager.hasRedo():false}function toggleUndoState(){var self=this;self.disabled(!hasUndo());editor.on("Undo Redo AddUndo TypingUndo",function(){self.disabled(!hasUndo())})}function toggleRedoState(){var self=this;self.disabled(!hasRedo());editor.on("Undo Redo AddUndo TypingUndo",function(){self.disabled(!hasRedo())})}function toggleVisualAidState(){var self=this;editor.on("VisualAid",function(e){self.active(e.hasVisual)});self.active(editor.hasVisual)}editor.addButton("undo",{tooltip:"Undo",onPostRender:toggleUndoState,cmd:"undo"});editor.addButton("redo",{tooltip:"Redo",onPostRender:toggleRedoState,cmd:"redo"});editor.addMenuItem("newdocument",{text:"New document",shortcut:"Ctrl+N",icon:"newdocument",cmd:"mceNewDocument"});editor.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Ctrl+Z",onPostRender:toggleUndoState,cmd:"undo"});editor.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Ctrl+Y",onPostRender:toggleRedoState,cmd:"redo"});editor.addMenuItem("visualaid",{text:"Visual aids",selectable:true,onPostRender:toggleVisualAidState,cmd:"mceToggleVisualAid"});each({cut:["Cut","Cut","Ctrl+X"],copy:["Copy","Copy","Ctrl+C"],paste:["Paste","Paste","Ctrl+V"],selectall:["Select all","SelectAll","Ctrl+A"],bold:["Bold","Bold","Ctrl+B"],italic:["Italic","Italic","Ctrl+I"],underline:["Underline","Underline"],strikethrough:["Strikethrough","Strikethrough"],subscript:["Subscript","Subscript"],superscript:["Superscript","Superscript"],removeformat:["Clear formatting","RemoveFormat"]},function(item,name){editor.addMenuItem(name,{text:item[0],icon:name,shortcut:item[2],cmd:item[1]})});editor.on("mousedown",function(){FloatPanel.hideAll()});function toggleFormat(fmt){if(fmt.control){fmt=fmt.control.value()}if(fmt){editor.execCommand("mceToggleFormat",false,fmt)}}editor.addButton("styleselect",{type:"menubutton",text:"Formats",menu:formatMenu});editor.addButton("formatselect",function(){var items=[],blocks=createFormats(editor.settings.block_formats||"Paragraph=p;Address=address;Pre=pre;Header 1=h1;Header 2=h2;Header 3=h3;Header 4=h4;Header 5=h5;Header 6=h6");each(blocks,function(block){items.push({text:block[0],value:block[1],textStyle:function(){return getPreviewCss(block[1])}})});return{type:"listbox",text:{raw:blocks[0][0]},values:items,fixedWidth:true,onselect:toggleFormat,onPostRender:createListBoxChangeHandler(items)}});editor.addButton("fontselect",function(){var defaultFontsFormats="Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats";var items=[],fonts=createFormats(editor.settings.font_formats||defaultFontsFormats);each(fonts,function(font){items.push({text:{raw:font[0]},value:font[1],textStyle:font[1].indexOf("dings")==-1?"font-family:"+font[1]:""})});return{type:"listbox",text:"Font Family",tooltip:"Font Family",values:items,fixedWidth:true,onPostRender:createListBoxChangeHandler(items,"fontname"),onselect:function(e){if(e.control.settings.value){editor.execCommand("FontName",false,e.control.settings.value)}}}});editor.addButton("fontsizeselect",function(){var items=[],defaultFontsizeFormats="8pt 10pt 12pt 14pt 18pt 24pt 36pt";var fontsize_formats=editor.settings.fontsize_formats||defaultFontsizeFormats;each(fontsize_formats.split(" "),function(item){items.push({text:item,value:item})});return{type:"listbox",text:"Font Sizes",tooltip:"Font Sizes",values:items,fixedWidth:true,onPostRender:createListBoxChangeHandler(items,"fontsize"),onclick:function(e){if(e.control.settings.value){editor.execCommand("FontSize",false,e.control.settings.value)}}}});editor.addMenuItem("formats",{text:"Formats",menu:formatMenu})}});define("tinymce/ui/GridLayout",["tinymce/ui/AbsoluteLayout"],function(AbsoluteLayout){return AbsoluteLayout.extend({recalc:function(container){var settings=container.settings,rows,cols,items,contLayoutRect,width,height,rect,ctrlLayoutRect,ctrl,x,y,posX,posY,ctrlSettings,contPaddingBox,align,spacingH,spacingV,alignH,alignV,maxX,maxY,colWidths=[],rowHeights=[],ctrlMinWidth,ctrlMinHeight,alignX,alignY,availableWidth,availableHeight;settings=container.settings;items=container.items().filter(":visible");contLayoutRect=container.layoutRect();cols=settings.columns||Math.ceil(Math.sqrt(items.length));rows=Math.ceil(items.length/cols);spacingH=settings.spacingH||settings.spacing||0;spacingV=settings.spacingV||settings.spacing||0;alignH=settings.alignH||settings.align;alignV=settings.alignV||settings.align;contPaddingBox=container._paddingBox;if(alignH&&typeof(alignH)=="string"){alignH=[alignH]}if(alignV&&typeof(alignV)=="string"){alignV=[alignV]}for(x=0;x<cols;x++){colWidths.push(0)}for(y=0;y<rows;y++){rowHeights.push(0)}for(y=0;y<rows;y++){for(x=0;x<cols;x++){ctrl=items[y*cols+x];if(!ctrl){break}ctrlLayoutRect=ctrl.layoutRect();ctrlMinWidth=ctrlLayoutRect.minW;ctrlMinHeight=ctrlLayoutRect.minH;colWidths[x]=ctrlMinWidth>colWidths[x]?ctrlMinWidth:colWidths[x];rowHeights[y]=ctrlMinHeight>rowHeights[y]?ctrlMinHeight:rowHeights[y]}}availableWidth=contLayoutRect.innerW-contPaddingBox.left-contPaddingBox.right;for(maxX=0,x=0;x<cols;x++){maxX+=colWidths[x]+(x>0?spacingH:0);availableWidth-=(x>0?spacingH:0)+colWidths[x]}availableHeight=contLayoutRect.innerH-contPaddingBox.top-contPaddingBox.bottom;for(maxY=0,y=0;y<rows;y++){maxY+=rowHeights[y]+(y>0?spacingV:0);availableHeight-=(y>0?spacingV:0)+rowHeights[y]}maxX+=contPaddingBox.left+contPaddingBox.right;maxY+=contPaddingBox.top+contPaddingBox.bottom;rect={};rect.minW=maxX+(contLayoutRect.w-contLayoutRect.innerW);rect.minH=maxY+(contLayoutRect.h-contLayoutRect.innerH);rect.contentW=rect.minW-contLayoutRect.deltaW;rect.contentH=rect.minH-contLayoutRect.deltaH;rect.minW=Math.min(rect.minW,contLayoutRect.maxW);rect.minH=Math.min(rect.minH,contLayoutRect.maxH);rect.minW=Math.max(rect.minW,contLayoutRect.startMinWidth);rect.minH=Math.max(rect.minH,contLayoutRect.startMinHeight);if(contLayoutRect.autoResize&&(rect.minW!=contLayoutRect.minW||rect.minH!=contLayoutRect.minH)){rect.w=rect.minW;rect.h=rect.minH;container.layoutRect(rect);this.recalc(container);if(container._lastRect===null){var parentCtrl=container.parent();if(parentCtrl){parentCtrl._lastRect=null;parentCtrl.recalc()}}return}if(contLayoutRect.autoResize){rect=container.layoutRect(rect);rect.contentW=rect.minW-contLayoutRect.deltaW;rect.contentH=rect.minH-contLayoutRect.deltaH}var flexV;if(settings.packV=="start"){flexV=0}else{flexV=availableHeight>0?Math.floor(availableHeight/rows):0}var totalFlex=0;var flexWidths=settings.flexWidths;if(flexWidths){for(x=0;x<flexWidths.length;x++){totalFlex+=flexWidths[x]}}else{totalFlex=cols}var ratio=availableWidth/totalFlex;for(x=0;x<cols;x++){colWidths[x]+=flexWidths?flexWidths[x]*ratio:ratio}posY=contPaddingBox.top;for(y=0;y<rows;y++){posX=contPaddingBox.left;height=rowHeights[y]+flexV;for(x=0;x<cols;x++){ctrl=items[y*cols+x];if(!ctrl){break}ctrlSettings=ctrl.settings;ctrlLayoutRect=ctrl.layoutRect();width=Math.max(colWidths[x],ctrlLayoutRect.startMinWidth);alignX=alignY=0;ctrlLayoutRect.x=posX;ctrlLayoutRect.y=posY;align=ctrlSettings.alignH||(alignH?(alignH[x]||alignH[0]):null);if(align=="center"){ctrlLayoutRect.x=posX+(width/2)-(ctrlLayoutRect.w/2)}else{if(align=="right"){ctrlLayoutRect.x=posX+width-ctrlLayoutRect.w}else{if(align=="stretch"){ctrlLayoutRect.w=width}}}align=ctrlSettings.alignV||(alignV?(alignV[x]||alignV[0]):null);if(align=="center"){ctrlLayoutRect.y=posY+(height/2)-(ctrlLayoutRect.h/2)}else{if(align=="bottom"){ctrlLayoutRect.y=posY+height-ctrlLayoutRect.h}else{if(align=="stretch"){ctrlLayoutRect.h=height}}}ctrl.layoutRect(ctrlLayoutRect);posX+=width+spacingH;if(ctrl.recalc){ctrl.recalc()}}posY+=height+spacingV}}})});define("tinymce/ui/Iframe",["tinymce/ui/Widget"],function(Widget){return Widget.extend({renderHtml:function(){var self=this;self.addClass("iframe");self.canFocus=false;return('<iframe id="'+self._id+'" class="'+self.classes()+'" tabindex="-1" src="'+(self.settings.url||"javascript:''")+'" frameborder="0"></iframe>')},src:function(src){this.getEl().src=src},html:function(html,callback){var self=this,body=this.getEl().contentWindow.document.body;if(!body){setTimeout(function(){self.html(html)},0)}else{body.innerHTML=html;if(callback){callback()}}return this}})});define("tinymce/ui/Label",["tinymce/ui/Widget","tinymce/ui/DomUtils"],function(Widget,DomUtils){return Widget.extend({init:function(settings){var self=this;self._super(settings);self.addClass("widget");self.addClass("label");self.canFocus=false;if(settings.multiline){self.addClass("autoscroll")}if(settings.strong){self.addClass("strong")}},initLayoutRect:function(){var self=this,layoutRect=self._super();if(self.settings.multiline){var size=DomUtils.getSize(self.getEl());if(size.width>layoutRect.maxW){layoutRect.minW=layoutRect.maxW;self.addClass("multiline")}self.getEl().style.width=layoutRect.minW+"px";layoutRect.startMinH=layoutRect.h=layoutRect.minH=Math.min(layoutRect.maxH,DomUtils.getSize(self.getEl()).height)}return layoutRect},repaint:function(){var self=this;if(!self.settings.multiline){self.getEl().style.lineHeight=self.layoutRect().h+"px"}return self._super()},text:function(text){var self=this;if(self._rendered&&text){this.innerHtml(self.encode(text))}return self._super(text)},renderHtml:function(){var self=this,forId=self.settings.forId;return('<label id="'+self._id+'" class="'+self.classes()+'"'+(forId?' for="'+forId:"")+'">'+self.encode(self._text)+"</label>")}})});define("tinymce/ui/Toolbar",["tinymce/ui/Container","tinymce/ui/KeyboardNavigation"],function(Container,KeyboardNavigation){return Container.extend({Defaults:{role:"toolbar",layout:"flow"},init:function(settings){var self=this;self._super(settings);self.addClass("toolbar")},postRender:function(){var self=this;self.items().addClass("toolbar-item");self.keyNav=new KeyboardNavigation({root:self,enableLeftRight:true});return self._super()}})});define("tinymce/ui/MenuBar",["tinymce/ui/Toolbar"],function(Toolbar){return Toolbar.extend({Defaults:{role:"menubar",containerCls:"menubar",defaults:{type:"menubutton"}}})});define("tinymce/ui/MenuButton",["tinymce/ui/Button","tinymce/ui/Factory","tinymce/ui/MenuBar"],function(Button,Factory,MenuBar){function isChildOf(node,parent){while(node){if(parent===node){return true}node=node.parentNode}return false}var MenuButton=Button.extend({init:function(settings){var self=this;self._renderOpen=true;self._super(settings);self.addClass("menubtn");if(settings.fixedWidth){self.addClass("fixed-width")}self.aria("haspopup",true);self.hasPopup=true},showMenu:function(){var self=this,settings=self.settings,menu;if(self.menu&&self.menu.visible()){return self.hideMenu()}if(!self.menu){menu=settings.menu||[];if(menu.length){menu={type:"menu",items:menu}}else{menu.type=menu.type||"menu"}self.menu=Factory.create(menu).parent(self).renderTo(self.getContainerElm());self.fire("createmenu");self.menu.reflow();self.menu.on("cancel",function(e){if(e.control===self.menu){self.focus()}});self.menu.on("show hide",function(e){if(e.control==self.menu){self.activeMenu(e.type=="show")}}).fire("show");self.aria("expanded",true)}self.menu.show();self.menu.layoutRect({w:self.layoutRect().w});self.menu.moveRel(self.getEl(),self.isRtl()?["br-tr","tr-br"]:["bl-tl","tl-bl"])},hideMenu:function(){var self=this;if(self.menu){self.menu.items().each(function(item){if(item.hideMenu){item.hideMenu()}});self.menu.hide();self.aria("expanded",false)}},activeMenu:function(state){this.toggleClass("active",state)},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix;var icon=self.settings.icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"";self.aria("role",self.parent() instanceof MenuBar?"menuitem":"button");return('<div id="'+id+'" class="'+self.classes()+'" tabindex="-1"><button id="'+id+'-open" role="presentation" type="button" tabindex="-1">'+(icon?'<i class="'+icon+'"></i>':"")+"<span>"+(self._text?(icon?"\u00a0":"")+self.encode(self._text):"")+'</span> <i class="'+prefix+'caret"></i></button></div>')},postRender:function(){var self=this;self.on("click",function(e){if(e.control===self&&isChildOf(e.target,self.getEl())){self.showMenu();if(e.keyboard){self.menu.items()[0].focus()}}});self.on("mouseenter",function(e){var overCtrl=e.control,parent=self.parent(),hasVisibleSiblingMenu;if(overCtrl&&parent&&overCtrl instanceof MenuButton&&overCtrl.parent()==parent){parent.items().filter("MenuButton").each(function(ctrl){if(ctrl.hideMenu&&ctrl!=overCtrl){if(ctrl.menu&&ctrl.menu.visible()){hasVisibleSiblingMenu=true}ctrl.hideMenu()}});if(hasVisibleSiblingMenu){overCtrl.focus();overCtrl.showMenu()}}});return self._super()},text:function(text){var self=this,i,children;if(self._rendered){children=self.getEl("open").getElementsByTagName("span");for(i=0;i<children.length;i++){children[i].innerHTML=(self.settings.icon&&text?"\u00a0":"")+self.encode(text)}}return this._super(text)},remove:function(){this._super();if(this.menu){this.menu.remove()}}});return MenuButton});define("tinymce/ui/ListBox",["tinymce/ui/MenuButton"],function(MenuButton){return MenuButton.extend({init:function(settings){var self=this,values,i,selected,selectedText,lastItemCtrl;self._values=values=settings.values;if(values){for(i=0;i<values.length;i++){selected=values[i].selected||settings.value===values[i].value;if(selected){selectedText=selectedText||values[i].text;self._value=values[i].value}}settings.menu=values}settings.text=settings.text||selectedText||values[0].text;self._super(settings);self.addClass("listbox");self.on("select",function(e){var ctrl=e.control;if(lastItemCtrl){e.lastControl=lastItemCtrl}if(settings.multiple){ctrl.active(!ctrl.active())}else{self.value(e.control.settings.value)}lastItemCtrl=ctrl})},value:function(value){var self=this,active,selectedText,menu,i;function activateByValue(menu,value){menu.items().each(function(ctrl){active=ctrl.value()===value;if(active){selectedText=selectedText||ctrl.text()}ctrl.active(active);if(ctrl.menu){activateByValue(ctrl.menu,value)}})}if(typeof(value)!="undefined"){if(self.menu){activateByValue(self.menu,value)}else{menu=self.settings.menu;for(i=0;i<menu.length;i++){active=menu[i].value==value;if(active){selectedText=selectedText||menu[i].text}menu[i].active=active}}self.text(selectedText||this.settings.text)}return self._super(value)}})});define("tinymce/ui/MenuItem",["tinymce/ui/Widget","tinymce/ui/Factory","tinymce/Env"],function(Widget,Factory,Env){return Widget.extend({Defaults:{border:0,role:"menuitem"},init:function(settings){var self=this;self.hasPopup=true;self._super(settings);settings=self.settings;self.addClass("menu-item");if(settings.menu){self.addClass("menu-item-expand")}if(settings.preview){self.addClass("menu-item-preview")}if(self._text==="-"||self._text==="|"){self.addClass("menu-item-sep");self.aria("role","separator");self.canFocus=false;self._text="-"}if(settings.selectable){self.aria("role","menuitemcheckbox");self.aria("checked",true);self.addClass("menu-item-checkbox");settings.icon="selected"}if(!settings.preview&&!settings.selectable){self.addClass("menu-item-normal")}self.on("mousedown",function(e){e.preventDefault()});self.on("mouseenter click",function(e){if(e.control===self){if(!settings.menu&&e.type==="click"){self.parent().hideAll();self.fire("cancel");self.fire("select")}else{self.showMenu();if(e.keyboard){setTimeout(function(){self.menu.items()[0].focus()},0)}}}});if(settings.menu){self.aria("haspopup",true)}},hasMenus:function(){return !!this.settings.menu},showMenu:function(){var self=this,settings=self.settings,menu,parent=self.parent();parent.items().each(function(ctrl){if(ctrl!==self){ctrl.hideMenu()}});if(settings.menu){menu=self.menu;if(!menu){menu=settings.menu;if(menu.length){menu={type:"menu",items:menu}}else{menu.type=menu.type||"menu"}if(parent.settings.itemDefaults){menu.itemDefaults=parent.settings.itemDefaults}menu=self.menu=Factory.create(menu).parent(self).renderTo(self.getContainerElm());menu.reflow();menu.fire("show");menu.on("cancel",function(){self.focus()});menu.on("hide",function(e){if(e.control===menu){self.removeClass("selected")}})}else{menu.show()}menu._parentMenu=parent;menu.addClass("menu-sub");var rel=menu.testMoveRel(self.getEl(),self.isRtl()?["tl-tr","bl-br","tr-tl","br-bl"]:["tr-tl","br-bl","tl-tr","bl-br"]);menu.moveRel(self.getEl(),rel);menu.rel=rel;rel="menu-sub-"+rel;menu.removeClass(menu._lastRel);menu.addClass(rel);menu._lastRel=rel;self.addClass("selected");self.aria("expanded",true)}},hideMenu:function(){var self=this;if(self.menu){self.menu.items().each(function(item){if(item.hideMenu){item.hideMenu()}});self.menu.hide();self.aria("expanded",false)}return self},renderHtml:function(){var self=this,id=self._id,settings=self.settings,prefix=self.classPrefix,text=self.encode(self._text);var icon=self.settings.icon,image="",shortcut=settings.shortcut;if(icon){self.parent().addClass("menu-has-icons")}if(settings.image){icon="none";image=" style=\"background-image: url('"+settings.image+"')\""}if(shortcut&&Env.mac){shortcut=shortcut.replace(/ctrl\+alt\+/i,"&#x2325;&#x2318;");shortcut=shortcut.replace(/ctrl\+/i,"&#x2318;");shortcut=shortcut.replace(/alt\+/i,"&#x2325;");shortcut=shortcut.replace(/shift\+/i,"&#x21E7;")}icon=prefix+"ico "+prefix+"i-"+(self.settings.icon||"none");return('<div id="'+id+'" class="'+self.classes()+'" tabindex="-1">'+(text!=="-"?'<i class="'+icon+'"'+image+"></i>&nbsp;":"")+(text!=="-"?'<span id="'+id+'-text" class="'+prefix+'text">'+text+"</span>":"")+(shortcut?'<div id="'+id+'-shortcut" class="'+prefix+'menu-shortcut">'+shortcut+"</div>":"")+(settings.menu?'<div class="'+prefix+'caret"></div>':"")+"</div>")},postRender:function(){var self=this,settings=self.settings;var textStyle=settings.textStyle;if(typeof(textStyle)=="function"){textStyle=textStyle.call(this)}if(textStyle){var textElm=self.getEl("text");if(textElm){textElm.setAttribute("style",textStyle)}}return self._super()},remove:function(){this._super();if(this.menu){this.menu.remove()}}})});define("tinymce/ui/Menu",["tinymce/ui/FloatPanel","tinymce/ui/KeyboardNavigation","tinymce/ui/MenuItem","tinymce/util/Tools"],function(FloatPanel,KeyboardNavigation,MenuItem,Tools){var Menu=FloatPanel.extend({Defaults:{defaultType:"menuitem",border:1,layout:"stack",role:"menu"},init:function(settings){var self=this;settings.autohide=true;settings.constrainToViewport=true;if(settings.itemDefaults){var items=settings.items,i=items.length;while(i--){items[i]=Tools.extend({},settings.itemDefaults,items[i])}}self._super(settings);self.addClass("menu");self.keyNav=new KeyboardNavigation({root:self,enableUpDown:true,enableLeftRight:true,leftAction:function(){if(self.parent() instanceof MenuItem){self.keyNav.cancel()}},onCancel:function(){self.fire("cancel",{},false);self.hide()}})},repaint:function(){this.toggleClass("menu-align",true);this._super();this.getEl().style.height="";this.getEl("body").style.height="";return this},cancel:function(){var self=this;self.hideAll();self.fire("cancel");self.fire("select")},hideAll:function(){var self=this;this.find("menuitem").exec("hideMenu");return self._super()},preRender:function(){var self=this;self.items().each(function(ctrl){var settings=ctrl.settings;if(settings.icon||settings.selectable){self._hasIcons=true;return false}});return self._super()}});return Menu});define("tinymce/ui/Radio",["tinymce/ui/Checkbox"],function(Checkbox){return Checkbox.extend({Defaults:{classes:"radio",role:"radio"}})});define("tinymce/ui/ResizeHandle",["tinymce/ui/Widget","tinymce/ui/DragHelper"],function(Widget,DragHelper){return Widget.extend({renderHtml:function(){var self=this,prefix=self.classPrefix;self.addClass("resizehandle");if(self.settings.direction=="both"){self.addClass("resizehandle-both")}self.canFocus=false;return('<div id="'+self._id+'" class="'+self.classes()+'"><i class="'+prefix+"ico "+prefix+'i-resize"></i></div>')},postRender:function(){var self=this;self._super();self.resizeDragHelper=new DragHelper(this._id,{start:function(){self.fire("ResizeStart")},drag:function(e){if(self.settings.direction!="both"){e.deltaX=0}self.fire("Resize",e)},end:function(){self.fire("ResizeEnd")}})},remove:function(){if(this.resizeDragHelper){this.resizeDragHelper.destroy()}return this._super()}})});define("tinymce/ui/Spacer",["tinymce/ui/Widget"],function(Widget){return Widget.extend({renderHtml:function(){var self=this;self.addClass("spacer");self.canFocus=false;return'<div id="'+self._id+'" class="'+self.classes()+'"></div>'}})});define("tinymce/ui/SplitButton",["tinymce/ui/MenuButton","tinymce/ui/DomUtils"],function(MenuButton,DomUtils){return MenuButton.extend({Defaults:{classes:"widget btn splitbtn",role:"splitbutton"},repaint:function(){var self=this,elm=self.getEl(),rect=self.layoutRect(),mainButtonElm,menuButtonElm;self._super();mainButtonElm=elm.firstChild;menuButtonElm=elm.lastChild;DomUtils.css(mainButtonElm,{width:rect.w-DomUtils.getSize(menuButtonElm).width,height:rect.h-2});DomUtils.css(menuButtonElm,{height:rect.h-2});return self},activeMenu:function(state){var self=this;DomUtils.toggleClass(self.getEl().lastChild,self.classPrefix+"active",state)},renderHtml:function(){var self=this,id=self._id,prefix=self.classPrefix;var icon=self.settings.icon?prefix+"ico "+prefix+"i-"+self.settings.icon:"";return('<div id="'+id+'" class="'+self.classes()+'"><button type="button" hidefocus tabindex="-1">'+(icon?'<i class="'+icon+'"></i>':"")+(self._text?(icon?" ":"")+self._text:"")+'</button><button type="button" class="'+prefix+'open" hidefocus tabindex="-1">'+(self._menuBtnText?(icon?"\u00a0":"")+self._menuBtnText:"")+' <i class="'+prefix+'caret"></i></button></div>')},postRender:function(){var self=this,onClickHandler=self.settings.onclick;self.on("click",function(e){var node=e.target;if(e.control==this){while(node){if(node.nodeName=="BUTTON"&&node.className.indexOf("open")==-1){e.stopImmediatePropagation();onClickHandler.call(this,e);return}node=node.parentNode}}});delete self.settings.onclick;return self._super()}})});define("tinymce/ui/StackLayout",["tinymce/ui/FlowLayout"],function(FlowLayout){return FlowLayout.extend({Defaults:{containerClass:"stack-layout",controlClass:"stack-layout-item",endClass:"break"}})});define("tinymce/ui/TabPanel",["tinymce/ui/Panel","tinymce/ui/DomUtils"],function(Panel,DomUtils){return Panel.extend({lastIdx:0,Defaults:{layout:"absolute",defaults:{type:"panel"}},activateTab:function(idx){if(this.activeTabId){DomUtils.removeClass(this.getEl(this.activeTabId),this.classPrefix+"active")}this.activeTabId="t"+idx;DomUtils.addClass(this.getEl("t"+idx),this.classPrefix+"active");if(idx!=this.lastIdx){this.items()[this.lastIdx].hide();this.lastIdx=idx}this.items()[idx].show().fire("showtab");this.reflow()},renderHtml:function(){var self=this,layout=self._layout,tabsHtml="",prefix=self.classPrefix;self.preRender();layout.preRender(self);self.items().each(function(ctrl,i){tabsHtml+=('<div id="'+self._id+"-t"+i+'" class="'+prefix+'tab" unselectable="on">'+self.encode(ctrl.settings.title)+"</div>")});return('<div id="'+self._id+'" class="'+self.classes()+'" hideFocus="1" tabIndex="-1"><div id="'+self._id+'-head" class="'+prefix+'tabs">'+tabsHtml+'</div><div id="'+self._id+'-body" class="'+self.classes("body")+'">'+layout.renderHtml(self)+"</div></div>")},postRender:function(){var self=this;self._super();self.settings.activeTab=self.settings.activeTab||0;self.activateTab(self.settings.activeTab);this.on("click",function(e){var targetParent=e.target.parentNode;if(e.target.parentNode.id==self._id+"-head"){var i=targetParent.childNodes.length;while(i--){if(targetParent.childNodes[i]==e.target){self.activateTab(i)}}}})},initLayoutRect:function(){var self=this,rect,minW,minH;minW=DomUtils.getSize(self.getEl("head")).width;minW=minW<0?0:minW;minH=0;self.items().each(function(item,i){minW=Math.max(minW,item.layoutRect().minW);minH=Math.max(minH,item.layoutRect().minH);if(self.settings.activeTab!=i){item.hide()}});self.items().each(function(ctrl){ctrl.settings.x=0;ctrl.settings.y=0;ctrl.settings.w=minW;ctrl.settings.h=minH;ctrl.layoutRect({x:0,y:0,w:minW,h:minH})});var headH=DomUtils.getSize(self.getEl("head")).height;self.settings.minWidth=minW;self.settings.minHeight=minH+headH;rect=self._super();rect.deltaH+=headH;rect.innerH=rect.h-rect.deltaH;return rect}})});define("tinymce/ui/TextBox",["tinymce/ui/Widget","tinymce/ui/DomUtils"],function(Widget,DomUtils){return Widget.extend({init:function(settings){var self=this;self._super(settings);self._value=settings.value||"";self.addClass("textbox");if(settings.multiline){self.addClass("multiline")}else{self.on("keydown",function(e){if(e.keyCode==13){self.parents().reverse().each(function(ctrl){e.preventDefault();if(ctrl.hasEventListeners("submit")&&ctrl.toJSON){ctrl.fire("submit",{data:ctrl.toJSON()});return false}})}})}},disabled:function(state){var self=this;if(self._rendered&&typeof(state)!="undefined"){self.getEl().disabled=state}return self._super(state)},value:function(value){var self=this;if(typeof(value)!="undefined"){self._value=value;if(self._rendered){self.getEl().value=value}return self}if(self._rendered){return self.getEl().value}return self._value},repaint:function(){var self=this,style,rect,borderBox,borderW=0,borderH=0,lastRepaintRect;style=self.getEl().style;rect=self._layoutRect;lastRepaintRect=self._lastRepaintRect||{};var doc=document;if(!self.settings.multiline&&doc.all&&(!doc.documentMode||doc.documentMode<=8)){style.lineHeight=(rect.h-borderH)+"px"}borderBox=self._borderBox;borderW=borderBox.left+borderBox.right+8;borderH=borderBox.top+borderBox.bottom+(self.settings.multiline?8:0);if(rect.x!==lastRepaintRect.x){style.left=rect.x+"px";lastRepaintRect.x=rect.x}if(rect.y!==lastRepaintRect.y){style.top=rect.y+"px";lastRepaintRect.y=rect.y}if(rect.w!==lastRepaintRect.w){style.width=(rect.w-borderW)+"px";lastRepaintRect.w=rect.w}if(rect.h!==lastRepaintRect.h){style.height=(rect.h-borderH)+"px";lastRepaintRect.h=rect.h}self._lastRepaintRect=lastRepaintRect;self.fire("repaint",{},false);return self},renderHtml:function(){var self=this,id=self._id,settings=self.settings,value=self.encode(self._value,false),extraAttrs="";if("spellcheck" in settings){extraAttrs+=' spellcheck="'+settings.spellcheck+'"'}if(settings.maxLength){extraAttrs+=' maxlength="'+settings.maxLength+'"'}if(settings.size){extraAttrs+=' size="'+settings.size+'"'}if(settings.subtype){extraAttrs+=' type="'+settings.subtype+'"'}if(self.disabled()){extraAttrs+=' disabled="disabled"'}if(settings.multiline){return('<textarea id="'+id+'" class="'+self.classes()+'" '+(settings.rows?' rows="'+settings.rows+'"':"")+' hidefocus="true"'+extraAttrs+">"+value+"</textarea>")}return'<input id="'+id+'" class="'+self.classes()+'" value="'+value+'" hidefocus="true"'+extraAttrs+">"},postRender:function(){var self=this;DomUtils.on(self.getEl(),"change",function(e){self.fire("change",e)});return self._super()},remove:function(){DomUtils.off(this.getEl());this._super()}})});define("tinymce/ui/Throbber",["tinymce/ui/DomUtils"],function(DomUtils){return function(elm){var self=this,state;self.show=function(time){self.hide();state=true;window.setTimeout(function(){if(state){elm.appendChild(DomUtils.createFragment('<div class="mce-throbber"></div>'))}},time||0);return self};self.hide=function(){var child=elm.lastChild;if(child&&child.className.indexOf("throbber")!=-1){child.parentNode.removeChild(child)}state=false;return self}}});expose(["tinymce/dom/Sizzle","tinymce/html/Styles","tinymce/dom/EventUtils","tinymce/dom/TreeWalker","tinymce/util/Tools","tinymce/dom/Range","tinymce/html/Entities","tinymce/Env","tinymce/dom/DOMUtils","tinymce/dom/ScriptLoader","tinymce/AddOnManager","tinymce/html/Node","tinymce/html/Schema","tinymce/html/SaxParser","tinymce/html/DomParser","tinymce/html/Writer","tinymce/html/Serializer","tinymce/dom/Serializer","tinymce/dom/TridentSelection","tinymce/util/VK","tinymce/dom/ControlSelection","tinymce/dom/Selection","tinymce/dom/RangeUtils","tinymce/Formatter","tinymce/UndoManager","tinymce/EnterKey","tinymce/ForceBlocks","tinymce/EditorCommands","tinymce/util/URI","tinymce/util/Class","tinymce/ui/Selector","tinymce/ui/Collection","tinymce/ui/DomUtils","tinymce/ui/Control","tinymce/ui/Factory","tinymce/ui/Container","tinymce/ui/DragHelper","tinymce/ui/Scrollable","tinymce/ui/Panel","tinymce/ui/Movable","tinymce/ui/Resizable","tinymce/ui/FloatPanel","tinymce/ui/KeyboardNavigation","tinymce/ui/Window","tinymce/ui/MessageBox","tinymce/WindowManager","tinymce/util/Quirks","tinymce/util/Observable","tinymce/Shortcuts","tinymce/Editor","tinymce/util/I18n","tinymce/FocusManager","tinymce/EditorManager","tinymce/LegacyInput","tinymce/util/XHR","tinymce/util/JSON","tinymce/util/JSONRequest","tinymce/util/JSONP","tinymce/util/LocalStorage","tinymce/Compat","tinymce/ui/Layout","tinymce/ui/AbsoluteLayout","tinymce/ui/Tooltip","tinymce/ui/Widget","tinymce/ui/Button","tinymce/ui/ButtonGroup","tinymce/ui/Checkbox","tinymce/ui/PanelButton","tinymce/ui/ColorButton","tinymce/ui/ComboBox","tinymce/ui/Path","tinymce/ui/ElementPath","tinymce/ui/FormItem","tinymce/ui/Form","tinymce/ui/FieldSet","tinymce/ui/FilePicker","tinymce/ui/FitLayout","tinymce/ui/FlexLayout","tinymce/ui/FlowLayout","tinymce/ui/FormatControls","tinymce/ui/GridLayout","tinymce/ui/Iframe","tinymce/ui/Label","tinymce/ui/Toolbar","tinymce/ui/MenuBar","tinymce/ui/MenuButton","tinymce/ui/ListBox","tinymce/ui/MenuItem","tinymce/ui/Menu","tinymce/ui/Radio","tinymce/ui/ResizeHandle","tinymce/ui/Spacer","tinymce/ui/SplitButton","tinymce/ui/StackLayout","tinymce/ui/TabPanel","tinymce/ui/TextBox","tinymce/ui/Throbber"])})(this);!function(e){function t(){function t(e){"remove"===e&&this.each(function(e,t){var n=r(t);n&&n.remove()}),this.find("span.mceEditor,div.mceEditor").each(function(e,t){var n=tinymce.get(t.id.replace(/_parent$/,""));n&&n.remove()})}function i(e){var n,i=this;if(null!=e){t.call(i),i.each(function(t,n){var i;(i=tinymce.get(n.id))&&i.setContent(e)})}else{if(i.length>0&&(n=tinymce.get(i[0].id))){return n.getContent()}}}function r(e){var t=null;return e&&e.id&&a.tinymce&&(t=tinymce.get(e.id)),t}function c(e){return !!(e&&e.length&&a.tinymce&&e.is(":tinymce"))}var u={};e.each(["text","html","val"],function(t,a){var o=u[a]=e.fn[a],s="text"===a;e.fn[a]=function(t){var a=this;if(!c(a)){return o.apply(a,arguments)}if(t!==n){return i.call(a.filter(":tinymce"),t),o.apply(a.not(":tinymce"),arguments),a}var u="",l=arguments;return(s?a:a.eq(0)).each(function(t,n){var i=r(n);u+=i?s?i.getContent().replace(/<(?:"[^"]*"|'[^']*'|[^'">])*>/g,""):i.getContent({save:!0}):o.apply(e(n),l)}),u}}),e.each(["append","prepend"],function(t,i){var a=u[i]=e.fn[i],o="prepend"===i;e.fn[i]=function(e){var t=this;return c(t)?e!==n?(t.filter(":tinymce").each(function(t,n){var i=r(n);i&&i.setContent(o?e+i.getContent():i.getContent()+e)}),a.apply(t.not(":tinymce"),arguments),t):void 0:a.apply(t,arguments)}}),e.each(["remove","replaceWith","replaceAll","empty"],function(n,i){var r=u[i]=e.fn[i];e.fn[i]=function(){return t.call(this,i),r.apply(this,arguments)}}),u.attr=e.fn.attr,e.fn.attr=function(t,a){var o=this,s=arguments;if(!t||"value"!==t||!c(o)){return a!==n?u.attr.apply(o,s):u.attr.apply(o,s)}if(a!==n){return i.call(o.filter(":tinymce"),a),u.attr.apply(o.not(":tinymce"),s),o}var l=o[0],m=r(l);return m?m.getContent({save:!0}):u.attr.apply(e(l),s)}}var n,i,r=[],a=window;e.fn.tinymce=function(n){function c(){var i=[],r=0;t&&(t(),t=null),l.each(function(e,t){var a,c=t.id,u=n.oninit;c||(t.id=c=tinymce.DOM.uniqueId()),tinymce.get(c)||(a=new tinymce.Editor(c,n,tinymce.EditorManager),i.push(a),a.on("init",function(){var e,t=u;l.css("visibility",""),u&&++r==i.length&&("string"==typeof t&&(e=-1===t.indexOf(".")?null:tinymce.resolve(t.replace(/\.\w+$/,"")),t=tinymce.resolve(t)),t.apply(e||tinymce,i))}))}),e.each(i,function(e,t){t.render()})}var u,o,s,l=this,m="";if(!l.length){return l}if(!n){return tinymce.get(l[0].id)}if(l.css("visibility","hidden"),a.tinymce||i||!(u=n.script_url)){1===i?r.push(c):c()}else{i=1,o=u.substring(0,u.lastIndexOf("/")),-1!=u.indexOf(".min")&&(m=".min"),a.tinymce=a.tinyMCEPreInit||{base:o,suffix:m},-1!=u.indexOf("gzip")&&(s=n.language||"en",u=u+(/\?/.test(u)?"&":"?")+"js=true&core=true&suffix="+escape(m)+"&themes="+escape(n.theme||"modern")+"&plugins="+escape(n.plugins||"")+"&languages="+(s||""),a.tinyMCE_GZ||(a.tinyMCE_GZ={start:function(){function t(e){tinymce.ScriptLoader.markDone(tinymce.baseURI.toAbsolute(e))}t("langs/"+s+".js"),t("themes/"+n.theme+"/theme"+m+".js"),t("themes/"+n.theme+"/langs/"+s+".js"),e.each(n.plugins.split(","),function(e,n){n&&(t("plugins/"+n+"/plugin"+m+".js"),t("plugins/"+n+"/langs/"+s+".js"))})},end:function(){}}));var p=document.createElement("script");p.type="text/javascript",p.onload=p.onreadystatechange=function(t){t=t||event,2===i||"load"!=t.type&&!/complete|loaded/.test(p.readyState)||(tinymce.dom.Event.domLoaded=1,i=2,n.script_loaded&&n.script_loaded(),c(),e.each(r,function(e,t){t()}))},p.src=u,document.body.appendChild(p)}return l},e.extend(e.expr[":"],{tinymce:function(e){return !!(e.id&&"tinymce" in window&&tinymce.get(e.id))}})}(jQuery);var Handsontable={extension:{},helper:{}};(function($,window,Handsontable){Handsontable.activeGuid=null;Handsontable.Core=function(rootElement,userSettings){var priv,datamap,grid,selection,editorManager,autofill,instance=this,GridSettings=function(){};Handsontable.helper.extend(GridSettings.prototype,DefaultSettings.prototype);Handsontable.helper.extend(GridSettings.prototype,userSettings);Handsontable.helper.extend(GridSettings.prototype,expandType(userSettings));this.rootElement=rootElement;var $document=$(document.documentElement);var $body=$(document.body);this.guid="ht_"+Handsontable.helper.randomString();if(!this.rootElement[0].id){this.rootElement[0].id=this.guid}priv={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new GridSettings(),settingsFromDOM:{},selStart:new Handsontable.SelectionPoint(),selEnd:new Handsontable.SelectionPoint(),isPopulated:null,scrollable:null,extensions:{},colToProp:null,propToCol:null,dataSchema:null,dataType:"array",firstRun:true};datamap={recursiveDuckSchema:function(obj){var schema;if($.isPlainObject(obj)){schema={};for(var i in obj){if(obj.hasOwnProperty(i)){if($.isPlainObject(obj[i])){schema[i]=datamap.recursiveDuckSchema(obj[i])}else{schema[i]=null}}}}else{schema=[]}return schema},recursiveDuckColumns:function(schema,lastCol,parent){var prop,i;if(typeof lastCol==="undefined"){lastCol=0;parent=""}if($.isPlainObject(schema)){for(i in schema){if(schema.hasOwnProperty(i)){if(schema[i]===null){prop=parent+i;priv.colToProp.push(prop);priv.propToCol[prop]=lastCol;lastCol++}else{lastCol=datamap.recursiveDuckColumns(schema[i],lastCol,i+".")}}}}return lastCol},createMap:function(){if(typeof datamap.getSchema()==="undefined"){throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`")}var i,ilen,schema=datamap.getSchema();priv.colToProp=[];priv.propToCol={};if(priv.settings.columns){for(i=0,ilen=priv.settings.columns.length;i<ilen;i++){priv.colToProp[i]=priv.settings.columns[i].data;priv.propToCol[priv.settings.columns[i].data]=i}}else{datamap.recursiveDuckColumns(schema)}},colToProp:function(col){col=Handsontable.PluginHooks.execute(instance,"modifyCol",col);if(priv.colToProp&&typeof priv.colToProp[col]!=="undefined"){return priv.colToProp[col]}else{return col}},propToCol:function(prop){var col;if(typeof priv.propToCol[prop]!=="undefined"){col=priv.propToCol[prop]}else{col=prop}col=Handsontable.PluginHooks.execute(instance,"modifyCol",col);return col},getSchema:function(){if(priv.settings.dataSchema){if(typeof priv.settings.dataSchema==="function"){return priv.settings.dataSchema()}return priv.settings.dataSchema}return priv.duckDataSchema},createRow:function(index,amount){var row,colCount=instance.countCols(),numberOfCreatedRows=0,currentIndex;if(!amount){amount=1}if(typeof index!=="number"||index>=instance.countRows()){index=instance.countRows()}currentIndex=index;while(numberOfCreatedRows<amount&&instance.countRows()<priv.settings.maxRows){if(priv.dataType==="array"){row=[];for(var c=0;c<colCount;c++){row.push(null)}}else{if(priv.dataType==="function"){row=priv.settings.dataSchema(index)}else{row=$.extend(true,{},datamap.getSchema())}}if(index===instance.countRows()){GridSettings.prototype.data.push(row)}else{GridSettings.prototype.data.splice(index,0,row)}numberOfCreatedRows++;currentIndex++}instance.PluginHooks.run("afterCreateRow",index,numberOfCreatedRows);instance.forceFullRender=true;return numberOfCreatedRows},createCol:function(index,amount){if(priv.dataType==="object"||priv.settings.columns){throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting")}var rlen=instance.countRows(),data=GridSettings.prototype.data,constructor,numberOfCreatedCols=0,currentIndex;if(!amount){amount=1}currentIndex=index;while(numberOfCreatedCols<amount&&instance.countCols()<priv.settings.maxCols){constructor=Handsontable.helper.columnFactory(GridSettings,priv.columnsSettingConflicts);if(typeof index!=="number"||index>=instance.countCols()){for(var r=0;r<rlen;r++){if(typeof data[r]==="undefined"){data[r]=[]}data[r].push(null)}priv.columnSettings.push(constructor)}else{for(var r=0;r<rlen;r++){data[r].splice(currentIndex,0,null)}priv.columnSettings.splice(currentIndex,0,constructor)}numberOfCreatedCols++;currentIndex++}instance.PluginHooks.run("afterCreateCol",index,numberOfCreatedCols);instance.forceFullRender=true;return numberOfCreatedCols},removeRow:function(index,amount){if(!amount){amount=1}if(typeof index!=="number"){index=-amount}index=(instance.countRows()+index)%instance.countRows();var logicRows=this.physicalRowsToLogical(index,amount);var actionWasNotCancelled=instance.PluginHooks.execute("beforeRemoveRow",index,amount);if(actionWasNotCancelled===false){return}var newData=GridSettings.prototype.data.filter(function(row,index){return logicRows.indexOf(index)==-1});GridSettings.prototype.data.length=0;Array.prototype.push.apply(GridSettings.prototype.data,newData);instance.PluginHooks.run("afterRemoveRow",index,amount);instance.forceFullRender=true},removeCol:function(index,amount){if(priv.dataType==="object"||priv.settings.columns){throw new Error("cannot remove column with object data source or columns option specified")}if(!amount){amount=1}if(typeof index!=="number"){index=-amount}index=(instance.countCols()+index)%instance.countCols();var actionWasNotCancelled=instance.PluginHooks.execute("beforeRemoveCol",index,amount);if(actionWasNotCancelled===false){return}var data=GridSettings.prototype.data;for(var r=0,rlen=instance.countRows();r<rlen;r++){data[r].splice(index,amount)}priv.columnSettings.splice(index,amount);instance.PluginHooks.run("afterRemoveCol",index,amount);instance.forceFullRender=true},spliceCol:function(col,index,amount){var elements=4<=arguments.length?[].slice.call(arguments,3):[];var colData=instance.getDataAtCol(col);var removed=colData.slice(index,index+amount);var after=colData.slice(index+amount);Handsontable.helper.extendArray(elements,after);var i=0;while(i<amount){elements.push(null);i++}Handsontable.helper.to2dArray(elements);instance.populateFromArray(index,col,elements,null,null,"spliceCol");return removed},spliceRow:function(row,index,amount){var elements=4<=arguments.length?[].slice.call(arguments,3):[];var rowData=instance.getDataAtRow(row);var removed=rowData.slice(index,index+amount);var after=rowData.slice(index+amount);Handsontable.helper.extendArray(elements,after);var i=0;while(i<amount){elements.push(null);i++}instance.populateFromArray(row,index,[elements],null,null,"spliceRow");return removed},getVars:{},get:function(row,prop){datamap.getVars.row=row;datamap.getVars.prop=prop;instance.PluginHooks.run("beforeGet",datamap.getVars);if(typeof datamap.getVars.prop==="string"&&datamap.getVars.prop.indexOf(".")>-1){var sliced=datamap.getVars.prop.split(".");var out=priv.settings.data[datamap.getVars.row];if(!out){return null}for(var i=0,ilen=sliced.length;i<ilen;i++){out=out[sliced[i]];if(typeof out==="undefined"){return null}}return out}else{if(typeof datamap.getVars.prop==="function"){return datamap.getVars.prop(priv.settings.data.slice(datamap.getVars.row,datamap.getVars.row+1)[0])}else{return priv.settings.data[datamap.getVars.row]?priv.settings.data[datamap.getVars.row][datamap.getVars.prop]:null}}},setVars:{},set:function(row,prop,value,source){datamap.setVars.row=row;datamap.setVars.prop=prop;datamap.setVars.value=value;instance.PluginHooks.run("beforeSet",datamap.setVars,source||"datamapGet");if(typeof datamap.setVars.prop==="string"&&datamap.setVars.prop.indexOf(".")>-1){var sliced=datamap.setVars.prop.split(".");var out=priv.settings.data[datamap.setVars.row];for(var i=0,ilen=sliced.length-1;i<ilen;i++){out=out[sliced[i]]}out[sliced[i]]=datamap.setVars.value}else{if(typeof datamap.setVars.prop==="function"){datamap.setVars.prop(priv.settings.data.slice(datamap.setVars.row,datamap.setVars.row+1)[0],datamap.setVars.value)}else{priv.settings.data[datamap.setVars.row][datamap.setVars.prop]=datamap.setVars.value}}},physicalRowsToLogical:function(index,amount){var physicRow=(GridSettings.prototype.data.length+index)%GridSettings.prototype.data.length;var logicRows=[];var rowsToRemove=amount;while(physicRow<GridSettings.prototype.data.length&&rowsToRemove){this.get(physicRow,0);logicRows.push(this.getVars.row);rowsToRemove--;physicRow++}return logicRows},clear:function(){for(var r=0;r<instance.countRows();r++){for(var c=0;c<instance.countCols();c++){datamap.set(r,datamap.colToProp(c),"")}}},getAll:function(){return priv.settings.data},getRange:function(start,end){var r,rlen,c,clen,output=[],row;rlen=Math.max(start.row,end.row);clen=Math.max(start.col,end.col);for(r=Math.min(start.row,end.row);r<=rlen;r++){row=[];for(c=Math.min(start.col,end.col);c<=clen;c++){row.push(datamap.get(r,datamap.colToProp(c)))}output.push(row)}return output},getText:function(start,end){return SheetClip.stringify(datamap.getRange(start,end))}};grid={alter:function(action,index,amount,source,keepEmptyRows){var delta;amount=amount||1;switch(action){case"insert_row":delta=datamap.createRow(index,amount);if(delta){if(priv.selStart.exists()&&priv.selStart.row()>=index){priv.selStart.row(priv.selStart.row()+delta);selection.transformEnd(delta,0)}else{selection.refreshBorders()}}break;case"insert_col":delta=datamap.createCol(index,amount);if(delta){if(Handsontable.helper.isArray(instance.getSettings().colHeaders)){var spliceArray=[index,0];spliceArray.length+=delta;Array.prototype.splice.apply(instance.getSettings().colHeaders,spliceArray)}if(priv.selStart.exists()&&priv.selStart.col()>=index){priv.selStart.col(priv.selStart.col()+delta);selection.transformEnd(0,delta)}else{selection.refreshBorders()}}break;case"remove_row":datamap.removeRow(index,amount);priv.cellSettings.splice(index,amount);grid.adjustRowsAndCols();selection.refreshBorders();break;case"remove_col":datamap.removeCol(index,amount);for(var row=0,len=datamap.getAll().length;row<len;row++){if(row in priv.cellSettings){priv.cellSettings[row].splice(index,amount)}}if(Handsontable.helper.isArray(instance.getSettings().colHeaders)){if(typeof index=="undefined"){index=-1}instance.getSettings().colHeaders.splice(index,amount)}priv.columnSettings.splice(index,amount);grid.adjustRowsAndCols();selection.refreshBorders();break;default:throw new Error('There is no such action "'+action+'"');break}if(!keepEmptyRows){grid.adjustRowsAndCols()}},adjustRowsAndCols:function(){var r,rlen,emptyRows=instance.countEmptyRows(true),emptyCols;rlen=instance.countRows();if(rlen<priv.settings.minRows){for(r=0;r<priv.settings.minRows-rlen;r++){datamap.createRow()}}if(emptyRows<priv.settings.minSpareRows){for(;emptyRows<priv.settings.minSpareRows&&instance.countRows()<priv.settings.maxRows;emptyRows++){datamap.createRow()}}emptyCols=instance.countEmptyCols(true);if(!priv.settings.columns&&instance.countCols()<priv.settings.minCols){for(;instance.countCols()<priv.settings.minCols;emptyCols++){datamap.createCol()}}if(!priv.settings.columns&&priv.dataType==="array"&&emptyCols<priv.settings.minSpareCols){for(;emptyCols<priv.settings.minSpareCols&&instance.countCols()<priv.settings.maxCols;emptyCols++){datamap.createCol()}}if(priv.settings.enterBeginsEditing){for(;(((priv.settings.minRows||priv.settings.minSpareRows)&&instance.countRows()>priv.settings.minRows)&&(priv.settings.minSpareRows&&emptyRows>priv.settings.minSpareRows));emptyRows--){datamap.removeRow()}}if(priv.settings.enterBeginsEditing&&!priv.settings.columns){for(;(((priv.settings.minCols||priv.settings.minSpareCols)&&instance.countCols()>priv.settings.minCols)&&(priv.settings.minSpareCols&&emptyCols>priv.settings.minSpareCols));emptyCols--){datamap.removeCol()}}var rowCount=instance.countRows();var colCount=instance.countCols();if(rowCount===0||colCount===0){selection.deselect()}if(priv.selStart.exists()){var selectionChanged;var fromRow=priv.selStart.row();var fromCol=priv.selStart.col();var toRow=priv.selEnd.row();var toCol=priv.selEnd.col();if(fromRow>rowCount-1){fromRow=rowCount-1;selectionChanged=true;if(toRow>fromRow){toRow=fromRow}}else{if(toRow>rowCount-1){toRow=rowCount-1;selectionChanged=true;if(fromRow>toRow){fromRow=toRow}}}if(fromCol>colCount-1){fromCol=colCount-1;selectionChanged=true;if(toCol>fromCol){toCol=fromCol}}else{if(toCol>colCount-1){toCol=colCount-1;selectionChanged=true;if(fromCol>toCol){fromCol=toCol}}}if(selectionChanged){instance.selectCell(fromRow,fromCol,toRow,toCol)}}},populateFromArray:function(start,input,end,source,method){var r,rlen,c,clen,setData=[],current={};rlen=input.length;if(rlen===0){return false}var repeatCol,repeatRow,cmax,rmax;switch(method){case"shift_down":repeatCol=end?end.col-start.col+1:0;repeatRow=end?end.row-start.row+1:0;input=Handsontable.helper.translateRowsToColumns(input);for(c=0,clen=input.length,cmax=Math.max(clen,repeatCol);c<cmax;c++){if(c<clen){for(r=0,rlen=input[c].length;r<repeatRow-rlen;r++){input[c].push(input[c][r%rlen])}input[c].unshift(start.col+c,start.row,0);instance.spliceCol.apply(instance,input[c])}else{input[c%clen][0]=start.col+c;instance.spliceCol.apply(instance,input[c%clen])}}break;case"shift_right":repeatCol=end?end.col-start.col+1:0;repeatRow=end?end.row-start.row+1:0;for(r=0,rlen=input.length,rmax=Math.max(rlen,repeatRow);r<rmax;r++){if(r<rlen){for(c=0,clen=input[r].length;c<repeatCol-clen;c++){input[r].push(input[r][c%clen])}input[r].unshift(start.row+r,start.col,0);instance.spliceRow.apply(instance,input[r])}else{input[r%rlen][0]=start.row+r;instance.spliceRow.apply(instance,input[r%rlen])}}break;case"overwrite":default:current.row=start.row;current.col=start.col;for(r=0;r<rlen;r++){if((end&&current.row>end.row)||(!priv.settings.minSpareRows&&current.row>instance.countRows()-1)||(current.row>=priv.settings.maxRows)){break}current.col=start.col;clen=input[r]?input[r].length:0;for(c=0;c<clen;c++){if((end&&current.col>end.col)||(!priv.settings.minSpareCols&&current.col>instance.countCols()-1)||(current.col>=priv.settings.maxCols)){break}if(!instance.getCellMeta(current.row,current.col).readOnly){setData.push([current.row,current.col,input[r][c]])}current.col++;if(end&&c===clen-1){c=-1}}current.row++;if(end&&r===rlen-1){r=-1}}instance.setDataAtCell(setData,null,null,source||"populateFromArray");break}},getCornerCoords:function(coordsArr){function mapProp(func,array,prop){function getProp(el){return el[prop]}if(Array.prototype.map){return func.apply(Math,array.map(getProp))}return func.apply(Math,$.map(array,getProp))}return{TL:{row:mapProp(Math.min,coordsArr,"row"),col:mapProp(Math.min,coordsArr,"col")},BR:{row:mapProp(Math.max,coordsArr,"row"),col:mapProp(Math.max,coordsArr,"col")}}},getCellsAtCoords:function(start,end){var corners=grid.getCornerCoords([start,end]);var r,c,output=[];for(r=corners.TL.row;r<=corners.BR.row;r++){for(c=corners.TL.col;c<=corners.BR.col;c++){output.push(instance.view.getCellAtCoords({row:r,col:c}))}}return output}};this.selection=selection={inProgress:false,begin:function(){instance.selection.inProgress=true},finish:function(){var sel=instance.getSelected();instance.PluginHooks.run("afterSelectionEnd",sel[0],sel[1],sel[2],sel[3]);instance.PluginHooks.run("afterSelectionEndByProp",sel[0],instance.colToProp(sel[1]),sel[2],instance.colToProp(sel[3]));instance.selection.inProgress=false},isInProgress:function(){return instance.selection.inProgress},setRangeStart:function(coords){priv.selStart.coords(coords);selection.setRangeEnd(coords)},setRangeEnd:function(coords,scrollToCell){instance.selection.begin();priv.selEnd.coords(coords);if(!priv.settings.multiSelect){priv.selStart.coords(coords)}instance.view.wt.selections.current.clear();instance.view.wt.selections.current.add(priv.selStart.arr());instance.view.wt.selections.area.clear();if(selection.isMultiple()){instance.view.wt.selections.area.add(priv.selStart.arr());instance.view.wt.selections.area.add(priv.selEnd.arr())}if(priv.settings.currentRowClassName||priv.settings.currentColClassName){instance.view.wt.selections.highlight.clear();instance.view.wt.selections.highlight.add(priv.selStart.arr());instance.view.wt.selections.highlight.add(priv.selEnd.arr())}instance.PluginHooks.run("afterSelection",priv.selStart.row(),priv.selStart.col(),priv.selEnd.row(),priv.selEnd.col());instance.PluginHooks.run("afterSelectionByProp",priv.selStart.row(),datamap.colToProp(priv.selStart.col()),priv.selEnd.row(),datamap.colToProp(priv.selEnd.col()));if(scrollToCell!==false){instance.view.scrollViewport(coords)}selection.refreshBorders()},refreshBorders:function(revertOriginal,keepEditor){if(!keepEditor){editorManager.destroyEditor(revertOriginal)}instance.view.render();if(selection.isSelected()&&!keepEditor){editorManager.prepareEditor()}},isMultiple:function(){return !(priv.selEnd.col()===priv.selStart.col()&&priv.selEnd.row()===priv.selStart.row())},transformStart:function(rowDelta,colDelta,force){if(priv.selStart.row()+rowDelta>instance.countRows()-1){if(force&&priv.settings.minSpareRows>0){instance.alter("insert_row",instance.countRows())}else{if(priv.settings.autoWrapCol){rowDelta=1-instance.countRows();colDelta=priv.selStart.col()+colDelta==instance.countCols()-1?1-instance.countCols():1}}}else{if(priv.settings.autoWrapCol&&priv.selStart.row()+rowDelta<0&&priv.selStart.col()+colDelta>=0){rowDelta=instance.countRows()-1;colDelta=priv.selStart.col()+colDelta==0?instance.countCols()-1:-1}}if(priv.selStart.col()+colDelta>instance.countCols()-1){if(force&&priv.settings.minSpareCols>0){instance.alter("insert_col",instance.countCols())}else{if(priv.settings.autoWrapRow){rowDelta=priv.selStart.row()+rowDelta==instance.countRows()-1?1-instance.countRows():1;colDelta=1-instance.countCols()}}}else{if(priv.settings.autoWrapRow&&priv.selStart.col()+colDelta<0&&priv.selStart.row()+rowDelta>=0){rowDelta=priv.selStart.row()+rowDelta==0?instance.countRows()-1:-1;colDelta=instance.countCols()-1}}var totalRows=instance.countRows();var totalCols=instance.countCols();var coords={row:priv.selStart.row()+rowDelta,col:priv.selStart.col()+colDelta};if(coords.row<0){coords.row=0}else{if(coords.row>0&&coords.row>=totalRows){coords.row=totalRows-1}}if(coords.col<0){coords.col=0}else{if(coords.col>0&&coords.col>=totalCols){coords.col=totalCols-1}}selection.setRangeStart(coords)},transformEnd:function(rowDelta,colDelta){if(priv.selEnd.exists()){var totalRows=instance.countRows();var totalCols=instance.countCols();var coords={row:priv.selEnd.row()+rowDelta,col:priv.selEnd.col()+colDelta};if(coords.row<0){coords.row=0}else{if(coords.row>0&&coords.row>=totalRows){coords.row=totalRows-1}}if(coords.col<0){coords.col=0}else{if(coords.col>0&&coords.col>=totalCols){coords.col=totalCols-1}}selection.setRangeEnd(coords)}},isSelected:function(){return priv.selEnd.exists()},inInSelection:function(coords){if(!selection.isSelected()){return false}var sel=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);return(sel.TL.row<=coords.row&&sel.BR.row>=coords.row&&sel.TL.col<=coords.col&&sel.BR.col>=coords.col)},deselect:function(){if(!selection.isSelected()){return}instance.selection.inProgress=false;priv.selEnd=new Handsontable.SelectionPoint();instance.view.wt.selections.current.clear();instance.view.wt.selections.area.clear();editorManager.destroyEditor();selection.refreshBorders();instance.PluginHooks.run("afterDeselect")},selectAll:function(){if(!priv.settings.multiSelect){return}selection.setRangeStart({row:0,col:0});selection.setRangeEnd({row:instance.countRows()-1,col:instance.countCols()-1},false)},empty:function(){if(!selection.isSelected()){return}var corners=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);var r,c,changes=[];for(r=corners.TL.row;r<=corners.BR.row;r++){for(c=corners.TL.col;c<=corners.BR.col;c++){if(!instance.getCellMeta(r,c).readOnly){changes.push([r,c,""])}}}instance.setDataAtCell(changes)}};this.autofill=autofill={handle:null,init:function(){if(!autofill.handle){autofill.handle={}}else{autofill.handle.disabled=false}},disable:function(){autofill.handle.disabled=true},selectAdjacent:function(){var select,data,r,maxR,c;if(selection.isMultiple()){select=instance.view.wt.selections.area.getCorners()}else{select=instance.view.wt.selections.current.getCorners()}data=datamap.getAll();rows:for(r=select[2]+1;r<instance.countRows();r++){for(c=select[1];c<=select[3];c++){if(data[r][c]){break rows}}if(!!data[r][select[1]-1]||!!data[r][select[3]+1]){maxR=r}}if(maxR){instance.view.wt.selections.fill.clear();instance.view.wt.selections.fill.add([select[0],select[1]]);instance.view.wt.selections.fill.add([maxR,select[3]]);autofill.apply()}},apply:function(){var drag,select,start,end,_data;autofill.handle.isDragged=0;drag=instance.view.wt.selections.fill.getCorners();if(!drag){return}instance.view.wt.selections.fill.clear();if(selection.isMultiple()){select=instance.view.wt.selections.area.getCorners()}else{select=instance.view.wt.selections.current.getCorners()}if(drag[0]===select[0]&&drag[1]<select[1]){start={row:drag[0],col:drag[1]};end={row:drag[2],col:select[1]-1}}else{if(drag[0]===select[0]&&drag[3]>select[3]){start={row:drag[0],col:select[3]+1};end={row:drag[2],col:drag[3]}}else{if(drag[0]<select[0]&&drag[1]===select[1]){start={row:drag[0],col:drag[1]};end={row:select[0]-1,col:drag[3]}}else{if(drag[2]>select[2]&&drag[1]===select[1]){start={row:select[2]+1,col:drag[1]};end={row:drag[2],col:drag[3]}}}}}if(start){_data=SheetClip.parse(datamap.getText(priv.selStart.coords(),priv.selEnd.coords()));instance.PluginHooks.run("beforeAutofill",start,end,_data);grid.populateFromArray(start,_data,end,"autofill");selection.setRangeStart({row:drag[0],col:drag[1]});selection.setRangeEnd({row:drag[2],col:drag[3]})}},showBorder:function(coords){coords.row=coords[0];coords.col=coords[1];var corners=grid.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]);if(priv.settings.fillHandle!=="horizontal"&&(corners.BR.row<coords.row||corners.TL.row>coords.row)){coords=[coords.row,corners.BR.col]}else{if(priv.settings.fillHandle!=="vertical"){coords=[corners.BR.row,coords.col]}else{return}}instance.view.wt.selections.fill.clear();instance.view.wt.selections.fill.add([priv.selStart.coords().row,priv.selStart.coords().col]);instance.view.wt.selections.fill.add([priv.selEnd.coords().row,priv.selEnd.coords().col]);instance.view.wt.selections.fill.add(coords);instance.view.render()}};this.init=function(){instance.PluginHooks.run("beforeInit");this.view=new Handsontable.TableView(this);editorManager=new Handsontable.EditorManager(instance,priv,selection,datamap);this.updateSettings(priv.settings,true);this.parseSettingsFromDOM();this.forceFullRender=true;this.view.render();if(typeof priv.firstRun==="object"){instance.PluginHooks.run("afterChange",priv.firstRun[0],priv.firstRun[1]);priv.firstRun=false}instance.PluginHooks.run("afterInit")};function ValidatorsQueue(){var resolved=false;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++;resolved=false},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1;this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){if(this.validatorsInQueue==0&&resolved==false){resolved=true;this.onQueueEmpty()}}}}function validateChanges(changes,source,callback){var waitingForValidator=new ValidatorsQueue();waitingForValidator.onQueueEmpty=resolve;for(var i=changes.length-1;i>=0;i--){if(changes[i]===null){changes.splice(i,1)}else{var row=changes[i][0];var col=datamap.propToCol(changes[i][1]);var logicalCol=instance.runHooksAndReturn("modifyCol",col);var cellProperties=instance.getCellMeta(row,logicalCol);if(cellProperties.type==="numeric"&&typeof changes[i][3]==="string"){if(changes[i][3].length>0&&/^-?[\d\s]*\.?\d*$/.test(changes[i][3])){changes[i][3]=numeral().unformat(changes[i][3]||"0")}}if(instance.getCellValidator(cellProperties)){waitingForValidator.addValidatorToQueue();instance.validateCell(changes[i][3],cellProperties,(function(i,cellProperties){return function(result){if(typeof result!=="boolean"){throw new Error("Validation error: result is not boolean")}if(result===false&&cellProperties.allowInvalid===false){changes.splice(i,1);cellProperties.valid=true;--i}waitingForValidator.removeValidatorFormQueue()}})(i,cellProperties),source)}}}waitingForValidator.checkIfQueueIsEmpty();function resolve(){var beforeChangeResult;if(changes.length){beforeChangeResult=instance.PluginHooks.execute("beforeChange",changes,source);if(typeof beforeChangeResult==="function"){$.when(result).then(function(){callback()})}else{if(beforeChangeResult===false){changes.splice(0,changes.length)}}}if(typeof beforeChangeResult!=="function"){callback()}}}function applyChanges(changes,source){var i=changes.length-1;if(i<0){return}for(;0<=i;i--){if(changes[i]===null){changes.splice(i,1);continue}if(priv.settings.minSpareRows){while(changes[i][0]>instance.countRows()-1){datamap.createRow()}}if(priv.dataType==="array"&&priv.settings.minSpareCols){while(datamap.propToCol(changes[i][1])>instance.countCols()-1){datamap.createCol()}}datamap.set(changes[i][0],changes[i][1],changes[i][3])}instance.forceFullRender=true;grid.adjustRowsAndCols();selection.refreshBorders(null,true);instance.PluginHooks.run("afterChange",changes,source||"edit")}this.validateCell=function(value,cellProperties,callback,source){var validator=instance.getCellValidator(cellProperties);if(Object.prototype.toString.call(validator)==="[object RegExp]"){validator=(function(validator){return function(value,callback){callback(validator.test(value))}})(validator)}if(typeof validator=="function"){value=instance.PluginHooks.execute("beforeValidate",value,cellProperties.row,cellProperties.prop,source);setTimeout(function(){validator.call(cellProperties,value,function(valid){cellProperties.valid=valid;valid=instance.PluginHooks.execute("afterValidate",valid,value,cellProperties.row,cellProperties.prop,source);callback(valid)})})}else{cellProperties.valid=true;callback(true)}};function setDataInputToArray(row,prop_or_col,value){if(typeof row==="object"){return row}else{if($.isPlainObject(value)){return value}else{return[[row,prop_or_col,value]]}}}this.setDataAtCell=function(row,col,value,source){var input=setDataInputToArray(row,col,value),i,ilen,changes=[],prop;for(i=0,ilen=input.length;i<ilen;i++){if(typeof input[i]!=="object"){throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter")}if(typeof input[i][1]!=="number"){throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`")}prop=datamap.colToProp(input[i][1]);changes.push([input[i][0],prop,datamap.get(input[i][0],prop),input[i][2]])}if(!source&&typeof row==="object"){source=col}validateChanges(changes,source,function(){applyChanges(changes,source)})};this.setDataAtRowProp=function(row,prop,value,source){var input=setDataInputToArray(row,prop,value),i,ilen,changes=[];for(i=0,ilen=input.length;i<ilen;i++){changes.push([input[i][0],input[i][1],datamap.get(input[i][0],input[i][1]),input[i][2]])}if(!source&&typeof row==="object"){source=prop}validateChanges(changes,source,function(){applyChanges(changes,source)})};this.listen=function(){Handsontable.activeGuid=instance.guid;if(document.activeElement&&document.activeElement!==document.body){document.activeElement.blur()}else{if(!document.activeElement){document.body.focus()}}};this.unlisten=function(){Handsontable.activeGuid=null};this.isListening=function(){return Handsontable.activeGuid===instance.guid};this.destroyEditor=function(revertOriginal){selection.refreshBorders(revertOriginal)};this.populateFromArray=function(row,col,input,endRow,endCol,source,method){if(!(typeof input==="object"&&typeof input[0]==="object")){throw new Error("populateFromArray parameter `input` must be an array of arrays")}return grid.populateFromArray({row:row,col:col},input,typeof endRow==="number"?{row:endRow,col:endCol}:null,source,method)};this.spliceCol=function(col,index,amount){return datamap.spliceCol.apply(null,arguments)};this.spliceRow=function(row,index,amount){return datamap.spliceRow.apply(null,arguments)};this.getCornerCoords=function(coordsArr){return grid.getCornerCoords(coordsArr)};this.getSelected=function(){if(selection.isSelected()){return[priv.selStart.row(),priv.selStart.col(),priv.selEnd.row(),priv.selEnd.col()]}};this.parseSettingsFromDOM=function(){var overflow=this.rootElement.css("overflow");if(overflow==="scroll"||overflow==="auto"){this.rootElement[0].style.overflow="visible";priv.settingsFromDOM.overflow=overflow}else{if(priv.settings.width===void 0||priv.settings.height===void 0){priv.settingsFromDOM.overflow="auto"}}if(priv.settings.width===void 0){priv.settingsFromDOM.width=this.rootElement.width()}else{priv.settingsFromDOM.width=void 0}priv.settingsFromDOM.height=void 0;if(priv.settings.height===void 0){if(priv.settingsFromDOM.overflow==="scroll"||priv.settingsFromDOM.overflow==="auto"){var clone=this.rootElement[0].cloneNode(false);var parent=this.rootElement[0].parentNode;if(parent){clone.removeAttribute("id");parent.appendChild(clone);var computedHeight=parseInt(window.getComputedStyle(clone,null).getPropertyValue("height"),10);if(isNaN(computedHeight)&&clone.currentStyle){computedHeight=parseInt(clone.currentStyle.height,10)}if(computedHeight>0){priv.settingsFromDOM.height=computedHeight}parent.removeChild(clone)}}}};this.render=function(){if(instance.view){instance.forceFullRender=true;instance.parseSettingsFromDOM();selection.refreshBorders(null,true)}};this.loadData=function(data){if(typeof data==="object"&&data!==null){if(!(data.push&&data.splice)){data=[data]}}else{if(data===null){data=[];var row;for(var r=0,rlen=priv.settings.startRows;r<rlen;r++){row=[];for(var c=0,clen=priv.settings.startCols;c<clen;c++){row.push(null)}data.push(row)}}else{throw new Error("loadData only accepts array of objects or array of arrays ("+typeof data+" given)")}}priv.isPopulated=false;GridSettings.prototype.data=data;if(priv.settings.dataSchema instanceof Array||data[0] instanceof Array){priv.dataType="array"}else{if(typeof priv.settings.dataSchema==="function"){priv.dataType="function"}else{priv.dataType="object"}}if(data[0]){priv.duckDataSchema=datamap.recursiveDuckSchema(data[0])}else{priv.duckDataSchema={}}datamap.createMap();grid.adjustRowsAndCols();instance.PluginHooks.run("afterLoadData");if(priv.firstRun){priv.firstRun=[null,"loadData"]}else{instance.PluginHooks.run("afterChange",null,"loadData");instance.render()}priv.isPopulated=true};this.getData=function(r,c,r2,c2){if(typeof r==="undefined"){return datamap.getAll()}else{return datamap.getRange({row:r,col:c},{row:r2,col:c2})}};this.updateSettings=function(settings,init){var i,clen;if(typeof settings.rows!=="undefined"){throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?")}if(typeof settings.cols!=="undefined"){throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?")}for(i in settings){if(i==="data"){continue}else{if(instance.PluginHooks.hooks[i]!==void 0||instance.PluginHooks.legacy[i]!==void 0){instance.PluginHooks.add(i,settings[i])}else{if(!init&&settings.hasOwnProperty(i)){GridSettings.prototype[i]=settings[i]}if(Handsontable.extension[i]){priv.extensions[i]=new Handsontable.extension[i](instance,settings[i])}}}}if(settings.data===void 0&&priv.settings.data===void 0){instance.loadData(null)}else{if(settings.data!==void 0){instance.loadData(settings.data)}else{if(settings.columns!==void 0){datamap.createMap()}}}clen=instance.countCols();priv.cellSettings.length=0;if(clen>0){var proto,column;for(i=0;i<clen;i++){priv.columnSettings[i]=Handsontable.helper.columnFactory(GridSettings,priv.columnsSettingConflicts);proto=priv.columnSettings[i].prototype;if(GridSettings.prototype.columns){column=GridSettings.prototype.columns[i];Handsontable.helper.extend(proto,column);Handsontable.helper.extend(proto,expandType(column))}}}if(typeof settings.fillHandle!=="undefined"){if(autofill.handle&&settings.fillHandle===false){autofill.disable()}else{if(!autofill.handle&&settings.fillHandle!==false){autofill.init()}}}if(typeof settings.className!=="undefined"){if(GridSettings.prototype.className){instance.rootElement.removeClass(GridSettings.prototype.className)}if(settings.className){instance.rootElement.addClass(settings.className)}}if(!init){instance.PluginHooks.run("afterUpdateSettings")}grid.adjustRowsAndCols();if(instance.view&&!priv.firstRun){instance.forceFullRender=true;selection.refreshBorders(null,true)}};this.getValue=function(){var sel=instance.getSelected();if(GridSettings.prototype.getValue){if(typeof GridSettings.prototype.getValue==="function"){return GridSettings.prototype.getValue.call(instance)}else{if(sel){return instance.getData()[sel[0]][GridSettings.prototype.getValue]}}}else{if(sel){return instance.getDataAtCell(sel[0],sel[1])}}};function expandType(obj){if(!obj.hasOwnProperty("type")){return}var type,expandedType={};if(typeof obj.type==="object"){type=obj.type}else{if(typeof obj.type==="string"){type=Handsontable.cellTypes[obj.type];if(type===void 0){throw new Error('You declared cell type "'+obj.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}}}for(var i in type){if(type.hasOwnProperty(i)&&!obj.hasOwnProperty(i)){expandedType[i]=type[i]}}return expandedType}this.getSettings=function(){return priv.settings};this.getSettingsFromDOM=function(){return priv.settingsFromDOM};this.clear=function(){selection.selectAll();selection.empty()};this.alter=function(action,index,amount,source,keepEmptyRows){grid.alter(action,index,amount,source,keepEmptyRows)};this.getCell=function(row,col){return instance.view.getCellAtCoords({row:row,col:col})};this.colToProp=function(col){return datamap.colToProp(col)};this.propToCol=function(prop){return datamap.propToCol(prop)};this.getDataAtCell=function(row,col){return datamap.get(row,datamap.colToProp(col))};this.getDataAtRowProp=function(row,prop){return datamap.get(row,prop)};this.getDataAtCol=function(col){return[].concat.apply([],datamap.getRange({row:0,col:col},{row:priv.settings.data.length-1,col:col}))};this.getDataAtProp=function(prop){return[].concat.apply([],datamap.getRange({row:0,col:datamap.propToCol(prop)},{row:priv.settings.data.length-1,col:datamap.propToCol(prop)}))};this.getDataAtRow=function(row){return priv.settings.data[row]};this.getCellMeta=function(row,col){var prop=datamap.colToProp(col),cellProperties;row=translateRowIndex(row);col=translateColIndex(col);if("undefined"===typeof priv.columnSettings[col]){priv.columnSettings[col]=Handsontable.helper.columnFactory(GridSettings,priv.columnsSettingConflicts)}if(!priv.cellSettings[row]){priv.cellSettings[row]=[]}if(!priv.cellSettings[row][col]){priv.cellSettings[row][col]=new priv.columnSettings[col]()}cellProperties=priv.cellSettings[row][col];cellProperties.row=row;cellProperties.col=col;cellProperties.prop=prop;cellProperties.instance=instance;instance.PluginHooks.run("beforeGetCellMeta",row,col,cellProperties);Handsontable.helper.extend(cellProperties,expandType(cellProperties));if(cellProperties.cells){var settings=cellProperties.cells.call(cellProperties,row,col,prop);if(settings){Handsontable.helper.extend(cellProperties,settings);Handsontable.helper.extend(cellProperties,expandType(settings))}}instance.PluginHooks.run("afterGetCellMeta",row,col,cellProperties);return cellProperties;function translateRowIndex(row){var getVars={row:row};instance.PluginHooks.execute("beforeGet",getVars);return getVars.row}function translateColIndex(col){return Handsontable.PluginHooks.execute(instance,"modifyCol",col)}};this.getCellRenderer=function(row,col){var renderer=Handsontable.helper.cellMethodLookupFactory("renderer").call(this,row,col);if(typeof renderer=="string"){renderer=Handsontable.cellLookup.renderer[renderer]}return renderer};this.getCellEditor=Handsontable.helper.cellMethodLookupFactory("editor");this.getCellValidator=Handsontable.helper.cellMethodLookupFactory("validator");this.validateCells=function(callback){var waitingForValidator=new ValidatorsQueue();waitingForValidator.onQueueEmpty=callback;var i=instance.countRows()-1;while(i>=0){var j=instance.countCols()-1;while(j>=0){waitingForValidator.addValidatorToQueue();instance.validateCell(instance.getDataAtCell(i,j),instance.getCellMeta(i,j),function(){waitingForValidator.removeValidatorFormQueue()},"validateCells");j--}i--}waitingForValidator.checkIfQueueIsEmpty()};this.getRowHeader=function(row){if(row===void 0){var out=[];for(var i=0,ilen=instance.countRows();i<ilen;i++){out.push(instance.getRowHeader(i))}return out}else{if(Object.prototype.toString.call(priv.settings.rowHeaders)==="[object Array]"&&priv.settings.rowHeaders[row]!==void 0){return priv.settings.rowHeaders[row]}else{if(typeof priv.settings.rowHeaders==="function"){return priv.settings.rowHeaders(row)}else{if(priv.settings.rowHeaders&&typeof priv.settings.rowHeaders!=="string"&&typeof priv.settings.rowHeaders!=="number"){return row+1}else{return priv.settings.rowHeaders}}}}};this.hasRowHeaders=function(){return !!priv.settings.rowHeaders};this.hasColHeaders=function(){if(priv.settings.colHeaders!==void 0){return !!priv.settings.colHeaders}for(var i=0,ilen=instance.countCols();i<ilen;i++){if(instance.getColHeader(i)){return true}}return false};this.getColHeader=function(col){if(col===void 0){var out=[];for(var i=0,ilen=instance.countCols();i<ilen;i++){out.push(instance.getColHeader(i))}return out}else{col=Handsontable.PluginHooks.execute(instance,"modifyCol",col);if(priv.settings.columns&&priv.settings.columns[col]&&priv.settings.columns[col].title){return priv.settings.columns[col].title}else{if(Object.prototype.toString.call(priv.settings.colHeaders)==="[object Array]"&&priv.settings.colHeaders[col]!==void 0){return priv.settings.colHeaders[col]}else{if(typeof priv.settings.colHeaders==="function"){return priv.settings.colHeaders(col)}else{if(priv.settings.colHeaders&&typeof priv.settings.colHeaders!=="string"&&typeof priv.settings.colHeaders!=="number"){return Handsontable.helper.spreadsheetColumnLabel(col)}else{return priv.settings.colHeaders}}}}}};this._getColWidthFromSettings=function(col){var cellProperties=instance.getCellMeta(0,col);var width=cellProperties.width;if(width===void 0||width===priv.settings.width){width=cellProperties.colWidths}if(width!==void 0){switch(typeof width){case"object":width=width[col];break;case"function":width=width(col);break}if(typeof width==="string"){width=parseInt(width,10)}}return width};this.getColWidth=function(col){col=Handsontable.PluginHooks.execute(instance,"modifyCol",col);var response={width:instance._getColWidthFromSettings(col)};if(!response.width){response.width=50}instance.PluginHooks.run("afterGetColWidth",col,response);return response.width};this.countRows=function(){return priv.settings.data.length};this.countCols=function(){if(priv.dataType==="object"||priv.dataType==="function"){if(priv.settings.columns&&priv.settings.columns.length){return priv.settings.columns.length}else{return priv.colToProp.length}}else{if(priv.dataType==="array"){if(priv.settings.columns&&priv.settings.columns.length){return priv.settings.columns.length}else{if(priv.settings.data&&priv.settings.data[0]&&priv.settings.data[0].length){return priv.settings.data[0].length}else{return 0}}}}};this.rowOffset=function(){return instance.view.wt.getSetting("offsetRow")};this.colOffset=function(){return instance.view.wt.getSetting("offsetColumn")};this.countVisibleRows=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.rowStrategy.countVisible():-1};this.countVisibleCols=function(){return instance.view.wt.drawn?instance.view.wt.wtTable.columnStrategy.countVisible():-1};this.countEmptyRows=function(ending){var i=instance.countRows()-1,empty=0;while(i>=0){datamap.get(i,0);if(instance.isEmptyRow(datamap.getVars.row)){empty++}else{if(ending){break}}i--}return empty};this.countEmptyCols=function(ending){if(instance.countRows()<1){return 0}var i=instance.countCols()-1,empty=0;while(i>=0){if(instance.isEmptyCol(i)){empty++}else{if(ending){break}}i--}return empty};this.isEmptyRow=function(r){if(priv.settings.isEmptyRow){return priv.settings.isEmptyRow.call(instance,r)}var val;for(var c=0,clen=instance.countCols();c<clen;c++){val=instance.getDataAtCell(r,c);if(val!==""&&val!==null&&typeof val!=="undefined"){return false}}return true};this.isEmptyCol=function(c){if(priv.settings.isEmptyCol){return priv.settings.isEmptyCol.call(instance,c)}var val;for(var r=0,rlen=instance.countRows();r<rlen;r++){val=instance.getDataAtCell(r,c);if(val!==""&&val!==null&&typeof val!=="undefined"){return false}}return true};this.selectCell=function(row,col,endRow,endCol,scrollToCell){if(typeof row!=="number"||row<0||row>=instance.countRows()){return false}if(typeof col!=="number"||col<0||col>=instance.countCols()){return false}if(typeof endRow!=="undefined"){if(typeof endRow!=="number"||endRow<0||endRow>=instance.countRows()){return false}if(typeof endCol!=="number"||endCol<0||endCol>=instance.countCols()){return false}}priv.selStart.coords({row:row,col:col});if(document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body){document.activeElement.blur()}instance.listen();if(typeof endRow==="undefined"){selection.setRangeEnd({row:row,col:col},scrollToCell)}else{selection.setRangeEnd({row:endRow,col:endCol},scrollToCell)}instance.selection.finish();return true};this.selectCellByProp=function(row,prop,endRow,endProp,scrollToCell){arguments[1]=datamap.propToCol(arguments[1]);if(typeof arguments[3]!=="undefined"){arguments[3]=datamap.propToCol(arguments[3])}return instance.selectCell.apply(instance,arguments)};this.deselectCell=function(){selection.deselect()};this.destroy=function(){instance.clearTimeouts();if(instance.view){instance.view.wt.destroy()}instance.rootElement.empty();instance.rootElement.removeData("handsontable");instance.rootElement.off(".handsontable");$(window).off("."+instance.guid);$document.off("."+instance.guid);$body.off("."+instance.guid);instance.copyPaste.removeCallback(priv.onCut);instance.copyPaste.removeCallback(priv.onPaste);instance.PluginHooks.run("afterDestroy")};this.getActiveEditor=function(){return editorManager.getActiveEditor()};this.getInstance=function(){return instance.rootElement.data("handsontable")};(function(){instance.PluginHooks=new Handsontable.PluginHookClass();var _run=instance.PluginHooks.run,_exe=instance.PluginHooks.execute;instance.PluginHooks.run=function(key,p1,p2,p3,p4,p5){_run.call(this,instance,key,p1,p2,p3,p4,p5);Handsontable.PluginHooks.run(instance,key,p1,p2,p3,p4,p5)};instance.PluginHooks.execute=function(key,p1,p2,p3,p4,p5){var globalHandlerResult=Handsontable.PluginHooks.execute(instance,key,p1,p2,p3,p4,p5);var localHandlerResult=_exe.call(this,instance,key,globalHandlerResult,p2,p3,p4,p5);return typeof localHandlerResult=="undefined"?globalHandlerResult:localHandlerResult};instance.addHook=function(){instance.PluginHooks.add.apply(instance.PluginHooks,arguments)};instance.addHookOnce=function(){instance.PluginHooks.once.apply(instance.PluginHooks,arguments)};instance.removeHook=function(){instance.PluginHooks.remove.apply(instance.PluginHooks,arguments)};instance.runHooks=function(){instance.PluginHooks.run.apply(instance.PluginHooks,arguments)};instance.runHooksAndReturn=function(){return instance.PluginHooks.execute.apply(instance.PluginHooks,arguments)}})();this.timeouts={};this.registerTimeout=function(key,handle,ms){clearTimeout(this.timeouts[key]);this.timeouts[key]=setTimeout(handle,ms||0)};this.clearTimeouts=function(){for(var key in this.timeouts){if(this.timeouts.hasOwnProperty(key)){clearTimeout(this.timeouts[key])}}};this.version="0.10.0-beta4"};var DefaultSettings=function(){};DefaultSettings.prototype={data:void 0,width:void 0,height:void 0,startRows:5,startCols:5,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,multiSelect:true,fillHandle:true,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:false,autoWrapCol:false,copyRowsLimit:1000,copyColsLimit:1000,pasteMode:"overwrite",currentRowClassName:void 0,currentColClassName:void 0,stretchH:"hybrid",isEmptyRow:void 0,isEmptyCol:void 0,observeDOMVisibility:true,allowInvalid:true,invalidCellClassName:"htInvalid",fragmentSelection:false,readOnly:false,nativeScrollbars:false,type:"text"};Handsontable.DefaultSettings=DefaultSettings;$.fn.handsontable=function(action){var i,ilen,args,output,userSettings,$this=this.first(),instance=$this.data("handsontable");if(typeof action!=="string"){userSettings=action||{};if(instance){instance.updateSettings(userSettings)}else{instance=new Handsontable.Core($this,userSettings);$this.data("handsontable",instance);instance.init()}return $this}else{args=[];if(arguments.length>1){for(i=1,ilen=arguments.length;i<ilen;i++){args.push(arguments[i])}}if(instance){if(typeof instance[action]!=="undefined"){output=instance[action].apply(instance,args)}else{throw new Error("Handsontable do not provide action: "+action)}}return output}};Handsontable.TableView=function(instance){var that=this,$window=$(window),$documentElement=$(document.documentElement);this.instance=instance;this.settings=instance.getSettings();this.settingsFromDOM=instance.getSettingsFromDOM();instance.rootElement.data("originalStyle",instance.rootElement[0].getAttribute("style"));instance.rootElement.addClass("handsontable");var table=document.createElement("TABLE");table.className="htCore";this.THEAD=document.createElement("THEAD");table.appendChild(this.THEAD);this.TBODY=document.createElement("TBODY");table.appendChild(this.TBODY);instance.$table=$(table);instance.rootElement.prepend(instance.$table);instance.rootElement.on("mousedown.handsontable",function(event){if(!that.isTextSelectionAllowed(event.target)){clearTextSelection();event.preventDefault();window.focus()}});$documentElement.on("keyup."+instance.guid,function(event){if(instance.selection.isInProgress()&&!event.shiftKey){instance.selection.finish()}});var isMouseDown;$documentElement.on("mouseup."+instance.guid,function(event){if(instance.selection.isInProgress()&&event.which===1){instance.selection.finish()}isMouseDown=false;if(instance.autofill.handle&&instance.autofill.handle.isDragged){if(instance.autofill.handle.isDragged>1){instance.autofill.apply()}instance.autofill.handle.isDragged=0}if(Handsontable.helper.isOutsideInput(document.activeElement)){instance.unlisten()}});$documentElement.on("mousedown."+instance.guid,function(event){var next=event.target;if(next!==that.wt.wtTable.spreader){while(next!==document.documentElement){if(next===null){return}if(next===instance.rootElement[0]||next.nodeName==="HANDSONTABLE-TABLE"){return}next=next.parentNode}}if(that.settings.outsideClickDeselects){instance.deselectCell()}else{instance.destroyEditor()}});instance.rootElement.on("mousedown.handsontable",".dragdealer",function(){instance.destroyEditor()});instance.$table.on("selectstart",function(event){if(that.settings.fragmentSelection){return}event.preventDefault()});var clearTextSelection=function(){if(window.getSelection){if(window.getSelection().empty){window.getSelection().empty()}else{if(window.getSelection().removeAllRanges){window.getSelection().removeAllRanges()}}}else{if(document.selection){document.selection.empty()}}};var walkontableConfig={table:table,stretchH:this.settings.stretchH,data:instance.getDataAtCell,totalRows:instance.countRows,totalColumns:instance.countCols,nativeScrollbars:this.settings.nativeScrollbars,offsetRow:0,offsetColumn:0,width:this.getWidth(),height:this.getHeight(),fixedColumnsLeft:function(){return that.settings.fixedColumnsLeft},fixedRowsTop:function(){return that.settings.fixedRowsTop},rowHeaders:function(){return instance.hasRowHeaders()?[function(index,TH){that.appendRowHeader(index,TH)}]:[]},columnHeaders:function(){return instance.hasColHeaders()?[function(index,TH){that.appendColHeader(index,TH)}]:[]},columnWidth:instance.getColWidth,cellRenderer:function(row,col,TD){var prop=that.instance.colToProp(col),cellProperties=that.instance.getCellMeta(row,col),renderer=that.instance.getCellRenderer(cellProperties);var value=that.instance.getDataAtRowProp(row,prop);renderer(that.instance,TD,row,col,prop,value,cellProperties);that.instance.PluginHooks.run("afterRenderer",TD,row,col,prop,value,cellProperties)},selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return that.settings.fillHandle&&!that.isCellEdited()&&!instance.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return that.settings.fillHandle&&!that.isCellEdited()&&instance.selection.isMultiple()}}},highlight:{highlightRowClassName:that.settings.currentRowClassName,highlightColumnClassName:that.settings.currentColClassName},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},hideBorderOnMouseDownOver:function(){return that.settings.fragmentSelection},onCellMouseDown:function(event,coords,TD){instance.listen();isMouseDown=true;var coordsObj={row:coords[0],col:coords[1]};if(event.button===2&&instance.selection.inInSelection(coordsObj)){}else{if(event.shiftKey){instance.selection.setRangeEnd(coordsObj)}else{instance.selection.setRangeStart(coordsObj)}}instance.PluginHooks.run("afterOnCellMouseDown",event,coords,TD)},onCellMouseOver:function(event,coords){var coordsObj={row:coords[0],col:coords[1]};if(isMouseDown){instance.selection.setRangeEnd(coordsObj)}else{if(instance.autofill.handle&&instance.autofill.handle.isDragged){instance.autofill.handle.isDragged++;instance.autofill.showBorder(coords)}}},onCellCornerMouseDown:function(event){instance.autofill.handle.isDragged=1;event.preventDefault();instance.PluginHooks.run("afterOnCellCornerMouseDown",event)},onCellCornerDblClick:function(){instance.autofill.selectAdjacent()},beforeDraw:function(force){that.beforeRender(force)},onDraw:function(force){that.onDraw(force)}};instance.PluginHooks.run("beforeInitWalkontable",walkontableConfig);this.wt=new Walkontable(walkontableConfig);$window.on("resize."+instance.guid,function(){instance.registerTimeout("resizeTimeout",function(){instance.parseSettingsFromDOM();var newWidth=that.getWidth();var newHeight=that.getHeight();if(walkontableConfig.width!==newWidth||walkontableConfig.height!==newHeight){instance.forceFullRender=true;that.render();walkontableConfig.width=newWidth;walkontableConfig.height=newHeight}},60)});$(that.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(event){if(event.target===that.wt.wtTable.spreader&&event.which===3){event.stopPropagation()}});$documentElement.on("click."+instance.guid,function(){if(that.settings.observeDOMVisibility){if(that.wt.drawInterrupted){that.instance.forceFullRender=true;that.render()}}})};Handsontable.TableView.prototype.isTextSelectionAllowed=function(el){if(el.nodeName==="TEXTAREA"){return(true)}if(this.settings.fragmentSelection&&this.wt.wtDom.isChildOf(el,this.TBODY)){return(true)}return false};Handsontable.TableView.prototype.isCellEdited=function(){var activeEditor=this.instance.getActiveEditor();return activeEditor&&activeEditor.isOpened()};Handsontable.TableView.prototype.getWidth=function(){var val=this.settings.width!==void 0?this.settings.width:this.settingsFromDOM.width;return typeof val==="function"?val():val};Handsontable.TableView.prototype.getHeight=function(){var val=this.settings.height!==void 0?this.settings.height:this.settingsFromDOM.height;return typeof val==="function"?val():val};Handsontable.TableView.prototype.beforeRender=function(force){if(force){this.instance.PluginHooks.run("beforeRender",this.instance.forceFullRender);this.wt.update("width",this.getWidth());this.wt.update("height",this.getHeight())}};Handsontable.TableView.prototype.onDraw=function(force){if(force){this.instance.PluginHooks.run("afterRender",this.instance.forceFullRender)}};Handsontable.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender);this.instance.forceFullRender=false;this.instance.rootElement.triggerHandler("render.handsontable")};Handsontable.TableView.prototype.getCellAtCoords=function(coords){var td=this.wt.wtTable.getCell([coords.row,coords.col]);if(td<0){return null}else{return td}};Handsontable.TableView.prototype.scrollViewport=function(coords){this.wt.scrollViewport([coords.row,coords.col])};Handsontable.TableView.prototype.appendRowHeader=function(row,TH){if(row>-1){this.wt.wtDom.fastInnerHTML(TH,this.instance.getRowHeader(row))}else{var DIV=document.createElement("DIV");DIV.className="relative";this.wt.wtDom.fastInnerText(DIV,"\u00A0");this.wt.wtDom.empty(TH);TH.appendChild(DIV)}};Handsontable.TableView.prototype.appendColHeader=function(col,TH){var DIV=document.createElement("DIV"),SPAN=document.createElement("SPAN");DIV.className="relative";SPAN.className="colHeader";this.wt.wtDom.fastInnerHTML(SPAN,this.instance.getColHeader(col));DIV.appendChild(SPAN);this.wt.wtDom.empty(TH);TH.appendChild(DIV);this.instance.PluginHooks.run("afterGetColHeader",col,TH)};Handsontable.TableView.prototype.maximumVisibleElementWidth=function(left){var rootWidth=this.wt.wtViewport.getWorkspaceWidth();if(this.settings.nativeScrollbars){return rootWidth}return rootWidth-left};Handsontable.TableView.prototype.maximumVisibleElementHeight=function(top){var rootHeight=this.wt.wtViewport.getWorkspaceHeight();if(this.settings.nativeScrollbars){return rootHeight}return rootHeight-top};(function(Handsontable){function RegisteredEditor(editorClass){var clazz,instances;instances={};clazz=editorClass;this.getInstance=function(hotInstance){if(!(hotInstance.guid in instances)){instances[hotInstance.guid]=new clazz(hotInstance)}return instances[hotInstance.guid]}}var registeredEditors={};Handsontable.editors={registerEditor:function(editorName,editorClass){registeredEditors[editorName]=new RegisteredEditor(editorClass)},getEditor:function(editorName,hotInstance){if(typeof editorName=="function"){var editorClass=editorName;editorName=editorClass.toString();this.registerEditor(editorName,editorClass)}if(typeof editorName!="string"){throw Error('Only strings and functions can be passed as "editor" parameter ')}if(!(editorName in registeredEditors)){throw Error('No editor registered under name "'+editorName+'"')}return registeredEditors[editorName].getInstance(hotInstance)}}})(Handsontable);(function(Handsontable){Handsontable.EditorManager=function(instance,priv,selection,datamap){var that=this;var $document=$(document);var keyCodes=Handsontable.helper.keyCode;var activeEditor;var init=function(){priv.onCut=function onCut(){if(!instance.isListening()){return}selection.empty()};priv.onPaste=function onPaste(str){if(!instance.isListening()||!selection.isSelected()){return}var input=str.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),inputArray=SheetClip.parse(input),coords=instance.getCornerCoords([priv.selStart.coords(),priv.selEnd.coords()]),areaStart=coords.TL,areaEnd={row:Math.max(coords.BR.row,inputArray.length-1+coords.TL.row),col:Math.max(coords.BR.col,inputArray[0].length-1+coords.TL.col)};instance.PluginHooks.once("afterChange",function(changes,source){if(changes&&changes.length){instance.selectCell(areaStart.row,areaStart.col,areaEnd.row,areaEnd.col)}});instance.populateFromArray(areaStart.row,areaStart.col,inputArray,areaEnd.row,areaEnd.col,"paste",priv.settings.pasteMode)};function onKeyDown(event){if(!instance.isListening()){return}if(priv.settings.beforeOnKeyDown){priv.settings.beforeOnKeyDown.call(instance,event)}if(Handsontable.helper.isCtrlKey(event.keyCode)){that.setCopyableText();return}instance.PluginHooks.run("beforeKeyDown",event);if(!event.isImmediatePropagationStopped()){priv.lastKeyCode=event.keyCode;if(selection.isSelected()){var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(Handsontable.helper.isPrintableChar(event.keyCode)&&ctrlDown){if(event.keyCode===65){selection.selectAll();that.setCopyableText();event.preventDefault();event.stopImmediatePropagation()}}if(!activeEditor.isWaiting()){if(!Handsontable.helper.isMetaKey(event.keyCode)&&!ctrlDown){that.openEditor("");event.stopPropagation();return}}var rangeModifier=event.shiftKey?selection.setRangeEnd:selection.setRangeStart;switch(event.keyCode){case keyCodes.ARROW_UP:if(that.isEditorOpened()&&!activeEditor.isWaiting()){that.closeEditorAndSaveChanges(ctrlDown)}moveSelectionUp(event.shiftKey);event.preventDefault();event.stopPropagation();break;case keyCodes.ARROW_DOWN:if(that.isEditorOpened()&&!activeEditor.isWaiting()){that.closeEditorAndSaveChanges(ctrlDown)}moveSelectionDown(event.shiftKey);event.preventDefault();event.stopPropagation();break;case keyCodes.ARROW_RIGHT:if(that.isEditorOpened()&&!activeEditor.isWaiting()){that.closeEditorAndSaveChanges(ctrlDown)}moveSelectionRight(event.shiftKey);event.preventDefault();event.stopPropagation();break;case keyCodes.ARROW_LEFT:if(that.isEditorOpened()&&!activeEditor.isWaiting()){that.closeEditorAndSaveChanges(ctrlDown)}moveSelectionLeft(event.shiftKey);event.preventDefault();event.stopPropagation();break;case keyCodes.TAB:var tabMoves=typeof priv.settings.tabMoves==="function"?priv.settings.tabMoves(event):priv.settings.tabMoves;if(event.shiftKey){selection.transformStart(-tabMoves.row,-tabMoves.col)}else{selection.transformStart(tabMoves.row,tabMoves.col,true)}event.preventDefault();event.stopPropagation();break;case keyCodes.BACKSPACE:case keyCodes.DELETE:selection.empty(event);that.prepareEditor();event.preventDefault();break;case keyCodes.F2:that.openEditor();event.preventDefault();break;case keyCodes.ENTER:if(that.isEditorOpened()){if(activeEditor.state!==Handsontable.EditorState.WAITING){that.closeEditorAndSaveChanges(ctrlDown)}moveSelectionAfterEnter(event.shiftKey)}else{if(instance.getSettings().enterBeginsEditing){that.openEditor()}else{moveSelectionAfterEnter(event.shiftKey)}}event.preventDefault();event.stopImmediatePropagation();break;case keyCodes.ESCAPE:if(that.isEditorOpened()){that.closeEditorAndRestoreOriginalValue(ctrlDown)}event.preventDefault();break;case keyCodes.HOME:if(event.ctrlKey||event.metaKey){rangeModifier({row:0,col:priv.selStart.col()})}else{rangeModifier({row:priv.selStart.row(),col:0})}event.preventDefault();event.stopPropagation();break;case keyCodes.END:if(event.ctrlKey||event.metaKey){rangeModifier({row:instance.countRows()-1,col:priv.selStart.col()})}else{rangeModifier({row:priv.selStart.row(),col:instance.countCols()-1})}event.preventDefault();event.stopPropagation();break;case keyCodes.PAGE_UP:selection.transformStart(-instance.countVisibleRows(),0);instance.view.wt.scrollVertical(-instance.countVisibleRows());instance.view.render();event.preventDefault();event.stopPropagation();break;case keyCodes.PAGE_DOWN:selection.transformStart(instance.countVisibleRows(),0);instance.view.wt.scrollVertical(instance.countVisibleRows());instance.view.render();event.preventDefault();event.stopPropagation();break;default:break}}}}$document.on("keydown.handsontable."+instance.guid,onKeyDown);function onDblClick(){that.openEditor()}instance.view.wt.update("onCellDblClick",onDblClick);instance.copyPaste=CopyPaste.getInstance();instance.copyPaste.onCut(priv.onCut);instance.copyPaste.onPaste(priv.onPaste);instance.addHook("afterDestroy",function(){$document.off("keydown.handsontable."+instance.guid)});function moveSelectionAfterEnter(shiftKey){var enterMoves=typeof priv.settings.enterMoves==="function"?priv.settings.enterMoves(event):priv.settings.enterMoves;if(shiftKey){selection.transformStart(-enterMoves.row,-enterMoves.col)}else{selection.transformStart(enterMoves.row,enterMoves.col,true)}}function moveSelectionUp(shiftKey){if(shiftKey){selection.transformEnd(-1,0)}else{selection.transformStart(-1,0)}}function moveSelectionDown(shiftKey){if(shiftKey){selection.transformEnd(1,0)}else{selection.transformStart(1,0)}}function moveSelectionRight(shiftKey){if(shiftKey){selection.transformEnd(0,1)}else{selection.transformStart(0,1)}}function moveSelectionLeft(shiftKey){if(shiftKey){selection.transformEnd(0,-1)}else{selection.transformStart(0,-1)}}};this.destroyEditor=function(revertOriginal){this.closeEditor(revertOriginal)};this.getActiveEditor=function(){return activeEditor};this.setCopyableText=function(){var selection=instance.getSelected();var settings=instance.getSettings();var copyRowsLimit=settings.copyRowsLimit;var copyColsLimit=settings.copyColsLimit;var startRow=Math.min(selection[0],selection[2]);var startCol=Math.min(selection[1],selection[3]);var endRow=Math.max(selection[0],selection[2]);var endCol=Math.max(selection[1],selection[3]);var finalEndRow=Math.min(endRow,startRow+copyRowsLimit-1);var finalEndCol=Math.min(endCol,startCol+copyColsLimit-1);instance.copyPaste.copyable(datamap.getText({row:startRow,col:startCol},{row:finalEndRow,col:finalEndCol}));if(endRow!==finalEndRow||endCol!==finalEndCol){instance.PluginHooks.run("afterCopyLimit",endRow-startRow+1,endCol-startCol+1,copyRowsLimit,copyColsLimit)}};var pendingPrepare=false;this.prepareEditor=function(){if(activeEditor&&activeEditor.state===Handsontable.EditorState.WAITING){if(!pendingPrepare){pendingPrepare=true;this.closeEditor(false,false,function(){pendingPrepare=false;that.prepareEditor()})}return}var row=priv.selStart.row();var col=priv.selStart.col();var prop=instance.colToProp(col);var td=instance.getCell(row,col);var originalValue=instance.getDataAtCell(row,col);var cellProperties=instance.getCellMeta(row,col);var editorClass=instance.getCellEditor(cellProperties);activeEditor=Handsontable.editors.getEditor(editorClass,instance);activeEditor.prepare(row,col,prop,td,originalValue,cellProperties)};this.isEditorOpened=function(){return activeEditor.isOpened()};this.openEditor=function(initialValue){activeEditor.beginEditing(initialValue)};this.closeEditor=function(restoreOriginalValue,ctrlDown,callback){if(!activeEditor){if(callback){callback(false)}}else{activeEditor.finishEditing(restoreOriginalValue,ctrlDown,callback)}};this.closeEditorAndSaveChanges=function(ctrlDown){return this.closeEditor(false,ctrlDown)};this.closeEditorAndRestoreOriginalValue=function(ctrlDown){return this.closeEditor(true,ctrlDown)};init()}})(Handsontable);Handsontable.Dom=new WalkontableDom();Handsontable.helper.isPrintableChar=function(keyCode){return((keyCode==32)||(keyCode>=48&&keyCode<=57)||(keyCode>=96&&keyCode<=111)||(keyCode>=186&&keyCode<=192)||(keyCode>=219&&keyCode<=222)||keyCode>=226||(keyCode>=65&&keyCode<=90))};Handsontable.helper.isMetaKey=function(keyCode){var keyCodes=Handsontable.helper.keyCode;var metaKeys=[keyCodes.ARROW_DOWN,keyCodes.ARROW_UP,keyCodes.ARROW_LEFT,keyCodes.ARROW_RIGHT,keyCodes.HOME,keyCodes.END,keyCodes.DELETE,keyCodes.BACKSPACE,keyCodes.F1,keyCodes.F2,keyCodes.F3,keyCodes.F4,keyCodes.F5,keyCodes.F6,keyCodes.F7,keyCodes.F8,keyCodes.F9,keyCodes.F10,keyCodes.F11,keyCodes.F12,keyCodes.TAB,keyCodes.PAGE_DOWN,keyCodes.PAGE_UP,keyCodes.ENTER,keyCodes.ESCAPE,keyCodes.SHIFT];return metaKeys.indexOf(keyCode)!=-1};Handsontable.helper.isCtrlKey=function(keyCode){return[17,224,91,93].indexOf(keyCode)!=-1};Handsontable.helper.stringify=function(value){switch(typeof value){case"string":case"number":return value+"";break;case"object":if(value===null){return""}else{return value.toString()}break;case"undefined":return"";break;default:return value.toString()}};Handsontable.helper.spreadsheetColumnLabel=function(index){var dividend=index+1;var columnLabel="";var modulo;while(dividend>0){modulo=(dividend-1)%26;columnLabel=String.fromCharCode(65+modulo)+columnLabel;dividend=parseInt((dividend-modulo)/26,10)}return columnLabel};Handsontable.helper.isNumeric=function(n){var t=typeof n;return t=="number"?!isNaN(n)&&isFinite(n):t=="string"?!n.length?false:n.length==1?/\d/.test(n):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(n):t=="object"?!!n&&typeof n.valueOf()=="number"&&!(n instanceof Date):false};Handsontable.helper.isArray=function(obj){return Object.prototype.toString.call(obj).match(/array/i)!==null};Handsontable.helper.isDescendant=function(parent,child){var node=child.parentNode;while(node!=null){if(node==parent){return true}node=node.parentNode}return false};Handsontable.helper.randomString=function(){return walkontableRandomString()};Handsontable.helper.inherit=function(Child,Parent){Parent.prototype.constructor=Parent;Child.prototype=new Parent();Child.prototype.constructor=Child;return Child};Handsontable.helper.extend=function(target,extension){for(var i in extension){if(extension.hasOwnProperty(i)){target[i]=extension[i]}}};Handsontable.helper.getPrototypeOf=function(obj){var prototype;if(typeof obj.__proto__=="object"){prototype=obj.__proto__}else{var oldConstructor,constructor=obj.constructor;if(typeof obj.constructor=="function"){oldConstructor=constructor;if(delete obj.constructor){constructor=obj.constructor;obj.constructor=oldConstructor}}prototype=constructor?constructor.prototype:null}return prototype};Handsontable.helper.columnFactory=function(GridSettings,conflictList){function ColumnSettings(){}Handsontable.helper.inherit(ColumnSettings,GridSettings);for(var i=0,len=conflictList.length;i<len;i++){ColumnSettings.prototype[conflictList[i]]=void 0}return ColumnSettings};Handsontable.helper.translateRowsToColumns=function(input){var i,ilen,j,jlen,output=[],olen=0;for(i=0,ilen=input.length;i<ilen;i++){for(j=0,jlen=input[i].length;j<jlen;j++){if(j==olen){output.push([]);olen++}output[j].push(input[i][j])}}return output};Handsontable.helper.to2dArray=function(arr){var i=0,ilen=arr.length;while(i<ilen){arr[i]=[arr[i]];i++}};Handsontable.helper.extendArray=function(arr,extension){var i=0,ilen=extension.length;while(i<ilen){arr.push(extension[i]);i++}};Handsontable.helper.isOutsideInput=function(element){var inputs=["INPUT","SELECT","TEXTAREA"];return inputs.indexOf(element.nodeName)>-1&&element.className.indexOf("handsontableInput")==-1};Handsontable.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,DELETE:46,END:35,ENTER:13,ESCAPE:27,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86};Handsontable.helper.isObject=function(obj){return Object.prototype.toString.call(obj)=="[object Object]"};Handsontable.helper.isArray=function(obj){return Array.isArray?Array.isArray(obj):Object.prototype.toString.call(obj)=="[object Array]"};Handsontable.helper.pivot=function(arr){var pivotedArr=[];if(!arr||arr.length==0||!arr[0]||arr[0].length==0){return pivotedArr}var rowCount=arr.length;var colCount=arr[0].length;for(var i=0;i<rowCount;i++){for(var j=0;j<colCount;j++){if(!pivotedArr[j]){pivotedArr[j]=[]}pivotedArr[j][i]=arr[i][j]}}return pivotedArr};Handsontable.helper.proxy=function(fun,context){return function(){return fun.apply(context,arguments)}};Handsontable.helper.cellMethodLookupFactory=function(methodName){return function cellMethodLookup(row,col){return(function getMethodFromProperties(properties){if(!properties){return}else{if(properties.hasOwnProperty(methodName)){return properties[methodName]}else{if(properties.hasOwnProperty("type")){var type;if(typeof properties.type!="string"){throw new Error("Cell type must be a string ")}type=translateTypeNameToObject(properties.type);return type[methodName]}}}return getMethodFromProperties(Handsontable.helper.getPrototypeOf(properties))})(typeof row=="number"?this.getCellMeta(row,col):row)};function translateTypeNameToObject(typeName){var type=Handsontable.cellTypes[typeName];if(typeof type=="undefined"){throw new Error('You declared cell type "'+typeName+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes')}return type}};Handsontable.SelectionPoint=function(){this._row=null;this._col=null};Handsontable.SelectionPoint.prototype.exists=function(){return(this._row!==null)};Handsontable.SelectionPoint.prototype.row=function(val){if(val!==void 0){this._row=val}return this._row};Handsontable.SelectionPoint.prototype.col=function(val){if(val!==void 0){this._col=val}return this._col};Handsontable.SelectionPoint.prototype.coords=function(coords){if(coords!==void 0){this._row=coords.row;this._col=coords.col}return{row:this._row,col:this._col}};Handsontable.SelectionPoint.prototype.arr=function(arr){if(arr!==void 0){this._row=arr[0];this._col=arr[1]}return[this._row,this._col]};Handsontable.TextRenderer=function(instance,TD,row,col,prop,value,cellProperties){if(!value&&cellProperties.placeholder){value=cellProperties.placeholder;instance.view.wt.wtDom.addClass(TD,"htPlaceholder")}var escaped=Handsontable.helper.stringify(value);if(cellProperties.rendererTemplate){instance.view.wt.wtDom.empty(TD);var TEMPLATE=document.createElement("TEMPLATE");TEMPLATE.setAttribute("bind","{{}}");TEMPLATE.innerHTML=cellProperties.rendererTemplate;HTMLTemplateElement.decorate(TEMPLATE);TEMPLATE.model=instance.getDataAtRow(row);TD.appendChild(TEMPLATE)}else{instance.view.wt.wtDom.fastInnerText(TD,escaped)}if(cellProperties.readOnly){instance.view.wt.wtDom.addClass(TD,"htDimmed")}if(cellProperties.valid===false&&cellProperties.invalidCellClassName){instance.view.wt.wtDom.addClass(TD,cellProperties.invalidCellClassName)}};(function(Handsontable){var clonableWRAPPER=document.createElement("DIV");clonableWRAPPER.className="htAutocompleteWrapper";var clonableARROW=document.createElement("DIV");clonableARROW.className="htAutocompleteArrow";clonableARROW.appendChild(document.createTextNode("\u25BC"));var wrapTdContentWithWrapper=function(TD,WRAPPER){WRAPPER.innerHTML=TD.innerHTML;Handsontable.Dom.empty(TD);TD.appendChild(WRAPPER)};Handsontable.AutocompleteRenderer=function(instance,TD,row,col,prop,value,cellProperties){var WRAPPER=clonableWRAPPER.cloneNode(true);var ARROW=clonableARROW.cloneNode(true);Handsontable.TextRenderer(instance,TD,row,col,prop,value,cellProperties);TD.appendChild(ARROW);Handsontable.Dom.addClass(TD,"htAutocomplete");if(!TD.firstChild){TD.appendChild(document.createTextNode("\u00A0"))}if(!instance.acArrowListener){instance.acArrowListener=function(){instance.view.wt.getSetting("onCellDblClick")};instance.rootElement.on("mousedown",".htAutocompleteArrow",instance.acArrowListener)}}})(Handsontable);var clonableINPUT=document.createElement("INPUT");clonableINPUT.className="htCheckboxRendererInput";clonableINPUT.type="checkbox";clonableINPUT.setAttribute("autocomplete","off");Handsontable.CheckboxRenderer=function(instance,TD,row,col,prop,value,cellProperties){if(typeof cellProperties.checkedTemplate==="undefined"){cellProperties.checkedTemplate=true}if(typeof cellProperties.uncheckedTemplate==="undefined"){cellProperties.uncheckedTemplate=false}instance.view.wt.wtDom.empty(TD);var INPUT=clonableINPUT.cloneNode(false);if(value===cellProperties.checkedTemplate||value===Handsontable.helper.stringify(cellProperties.checkedTemplate)){INPUT.checked=true;TD.appendChild(INPUT)}else{if(value===cellProperties.uncheckedTemplate||value===Handsontable.helper.stringify(cellProperties.uncheckedTemplate)){TD.appendChild(INPUT)}else{if(value===null){INPUT.className+=" noValue";TD.appendChild(INPUT)}else{instance.view.wt.wtDom.fastInnerText(TD,"#bad value#")}}}var $input=$(INPUT);if(cellProperties.readOnly){$input.on("click",function(event){event.preventDefault()})}else{$input.on("mousedown",function(event){event.stopPropagation()});$input.on("mouseup",function(event){event.stopPropagation()});$input.on("change",function(){if(this.checked){instance.setDataAtRowProp(row,prop,cellProperties.checkedTemplate)}else{instance.setDataAtRowProp(row,prop,cellProperties.uncheckedTemplate)}})}if(!instance.CheckboxRenderer||!instance.CheckboxRenderer.beforeKeyDownHookBound){instance.CheckboxRenderer={beforeKeyDownHookBound:true};instance.addHook("beforeKeyDown",function(event){if(event.keyCode==32){event.stopImmediatePropagation();event.preventDefault();var selection=instance.getSelected();var cell,checkbox,cellProperties;var selStart={row:Math.min(selection[0],selection[2]),col:Math.min(selection[1],selection[3])};var selEnd={row:Math.max(selection[0],selection[2]),col:Math.max(selection[1],selection[3])};for(var row=selStart.row;row<=selEnd.row;row++){for(var col=selEnd.col;col<=selEnd.col;col++){cell=instance.getCell(row,col);cellProperties=instance.getCellMeta(row,col);checkbox=cell.querySelectorAll("input[type=checkbox]");if(checkbox.length>0&&!cellProperties.readOnly){for(var i=0,len=checkbox.length;i<len;i++){checkbox[i].checked=!checkbox[i].checked;$(checkbox[i]).trigger("change")}}}}}})}return TD};Handsontable.NumericRenderer=function(instance,TD,row,col,prop,value,cellProperties){if(Handsontable.helper.isNumeric(value)){if(typeof cellProperties.language!=="undefined"){numeral.language(cellProperties.language)}value=numeral(value).format(cellProperties.format||"0");instance.view.wt.wtDom.addClass(TD,"htNumeric")}Handsontable.TextRenderer(instance,TD,row,col,prop,value,cellProperties)};(function(Handosntable){Handsontable.PasswordRenderer=function(instance,TD,row,col,prop,value,cellProperties){Handsontable.TextRenderer.apply(this,arguments);value=TD.innerHTML;var hash;var hashLength=cellProperties.hashLength||value.length;var hashSymbol=cellProperties.hashSymbol||"*";for(hash="";hash.split(hashSymbol).length-1<hashLength;hash+=hashSymbol){}instance.view.wt.wtDom.fastInnerHTML(TD,hash)}})(Handsontable);(function(Handsontable){Handsontable.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};function BaseEditor(instance){this.instance=instance;this.state=Handsontable.EditorState.VIRGIN;this._opened=false;this._closeCallback=function(){};this.init()}BaseEditor.prototype._fireCallbacks=function(result){this._closeCallback(result)};BaseEditor.prototype.init=function(){};BaseEditor.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")};BaseEditor.prototype.setValue=function(newValue){throw Error("Editor setValue() method unimplemented")};BaseEditor.prototype.open=function(){throw Error("Editor open() method unimplemented")};BaseEditor.prototype.close=function(){throw Error("Editor close() method unimplemented")};BaseEditor.prototype.prepare=function(row,col,prop,td,originalValue,cellProperties){this.TD=td;this.row=row;this.col=col;this.prop=prop;this.originalValue=originalValue;this.cellProperties=cellProperties;this.state=Handsontable.EditorState.VIRGIN};BaseEditor.prototype.extend=function(){var baseClass=this.constructor;function Editor(){baseClass.apply(this,arguments)}function inherit(Child,Parent){function Bridge(){}Bridge.prototype=Parent.prototype;Child.prototype=new Bridge();Child.prototype.constructor=Child;return Child}return inherit(Editor,baseClass)};BaseEditor.prototype.saveValue=function(val,ctrlDown){if(ctrlDown){var sel=this.instance.getSelected();this.instance.populateFromArray(sel[0],sel[1],val,sel[2],sel[3],"edit")}else{this.instance.populateFromArray(this.row,this.col,val,null,null,"edit")}};BaseEditor.prototype.beginEditing=function(initialValue){if(this.state!=Handsontable.EditorState.VIRGIN){return}if(this.cellProperties.readOnly){return}this.instance.view.scrollViewport({row:this.row,col:this.col});this.instance.view.render();this.state=Handsontable.EditorState.EDITING;initialValue=typeof initialValue=="string"?initialValue:this.originalValue;this.setValue(Handsontable.helper.stringify(initialValue));this.open();this._opened=true;this.instance.view.render()};BaseEditor.prototype.finishEditing=function(restoreOriginalValue,ctrlDown,callback){if(callback){var old=this._closeCallback;this._closeCallback=function(result){old(result);callback(result)}}if(this.isWaiting()){return}this._closeCallback=function(){};if(this.state==Handsontable.EditorState.VIRGIN){var that=this;setTimeout(function(){that._fireCallbacks(true)});return}if(this.state==Handsontable.EditorState.EDITING){var val;if(restoreOriginalValue){val=[[this.originalValue]]}else{val=[[String.prototype.trim.call(this.getValue())]]}this.state=Handsontable.EditorState.WAITING;this.saveValue(val,ctrlDown);if(this.instance.getCellValidator(this.cellProperties)){var that=this;this.instance.addHookOnce("afterValidate",function(result){that.state=Handsontable.EditorState.FINISHED;that.discardEditor(result)})}else{this.state=Handsontable.EditorState.FINISHED;this.discardEditor(true)}}};BaseEditor.prototype.discardEditor=function(result){if(this.state!==Handsontable.EditorState.FINISHED){return}if(result===false&&this.cellProperties.allowInvalid!==true){this.instance.selectCell(this.row,this.col);this.focus();this.state=Handsontable.EditorState.EDITING;this._fireCallbacks(false)}else{this.close();this._opened=false;this.state=Handsontable.EditorState.VIRGIN;this._fireCallbacks(true)}};BaseEditor.prototype.isOpened=function(){return this._opened};BaseEditor.prototype.isWaiting=function(){return this.state===Handsontable.EditorState.WAITING};Handsontable.editors.BaseEditor=BaseEditor})(Handsontable);(function(Handsontable){var TextEditor=Handsontable.editors.BaseEditor.prototype.extend();TextEditor.prototype.init=function(){this.createElements();this.bindEvents()};TextEditor.prototype.getValue=function(){return this.TEXTAREA.value};TextEditor.prototype.setValue=function(newValue){this.TEXTAREA.value=newValue};var onBeforeKeyDown=function onBeforeKeyDown(event){var instance=this;var that=instance.getActiveEditor();var keyCodes=Handsontable.helper.keyCode;var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(event.target!==that.TEXTAREA||event.isImmediatePropagationStopped()){return}if(event.keyCode===17||event.keyCode===224||event.keyCode===91||event.keyCode===93){event.stopImmediatePropagation();return}switch(event.keyCode){case keyCodes.ARROW_RIGHT:if(that.wtDom.getCaretPosition(that.TEXTAREA)!==that.TEXTAREA.value.length){event.stopImmediatePropagation()}break;case keyCodes.ARROW_LEFT:if(that.wtDom.getCaretPosition(that.TEXTAREA)!==0){event.stopImmediatePropagation()}break;case keyCodes.ENTER:var selected=that.instance.getSelected();var isMultipleSelection=!(selected[0]===selected[2]&&selected[1]===selected[3]);if((ctrlDown&&!isMultipleSelection)||event.altKey){if(that.isOpened()){that.setValue(that.getValue()+"\n");that.focus()}else{that.beginEditing(that.originalValue+"\n")}event.stopImmediatePropagation()}event.preventDefault();break;case keyCodes.A:case keyCodes.X:case keyCodes.C:case keyCodes.V:if(ctrlDown){event.stopImmediatePropagation();break}case keyCodes.BACKSPACE:case keyCodes.DELETE:case keyCodes.HOME:case keyCodes.END:event.stopImmediatePropagation();break}};TextEditor.prototype.open=function(){this.refreshDimensions();this.TEXTAREA.focus();this.wtDom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length);this.instance.addHook("beforeKeyDown",onBeforeKeyDown)};TextEditor.prototype.close=function(){this.textareaParentStyle.display="none";if(document.activeElement===this.TEXTAREA){this.instance.listen()}this.instance.removeHook("beforeKeyDown",onBeforeKeyDown)};TextEditor.prototype.focus=function(){this.TEXTAREA.focus()};TextEditor.prototype.createElements=function(){this.$body=$(document.body);this.wtDom=new WalkontableDom();this.TEXTAREA=document.createElement("TEXTAREA");this.$textarea=$(this.TEXTAREA);this.wtDom.addClass(this.TEXTAREA,"handsontableInput");this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.TEXTAREA_PARENT=document.createElement("DIV");this.wtDom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder");this.textareaParentStyle=this.TEXTAREA_PARENT.style;this.textareaParentStyle.top=0;this.textareaParentStyle.left=0;this.textareaParentStyle.display="none";this.TEXTAREA_PARENT.appendChild(this.TEXTAREA);this.instance.rootElement[0].appendChild(this.TEXTAREA_PARENT);var that=this;Handsontable.PluginHooks.add("afterRender",function(){that.instance.registerTimeout("refresh_editor_dimensions",function(){that.refreshDimensions()},0)})};TextEditor.prototype.refreshDimensions=function(){if(this.state!==Handsontable.EditorState.EDITING){return}this.TD=this.instance.getCell(this.row,this.col);if(!this.TD){return}var $td=$(this.TD);var currentOffset=this.wtDom.offset(this.TD);var containerOffset=this.wtDom.offset(this.instance.rootElement[0]);var scrollTop=this.instance.rootElement.scrollTop();var scrollLeft=this.instance.rootElement.scrollLeft();var editTop=currentOffset.top-containerOffset.top+scrollTop-1;var editLeft=currentOffset.left-containerOffset.left+scrollLeft-1;var settings=this.instance.getSettings();var rowHeadersCount=settings.rowHeaders===false?0:1;var colHeadersCount=settings.colHeaders===false?0:1;if(editTop<0){editTop=0}if(editLeft<0){editLeft=0}if(rowHeadersCount>0&&parseInt($td.css("border-top-width"),10)>0){editTop+=1}if(colHeadersCount>0&&parseInt($td.css("border-left-width"),10)>0){editLeft+=1}this.textareaParentStyle.top=editTop+"px";this.textareaParentStyle.left=editLeft+"px";var width=$td.width(),maxWidth=this.instance.view.maximumVisibleElementWidth(editLeft)-10,height=$td.outerHeight()-4,maxHeight=this.instance.view.maximumVisibleElementHeight(editTop)-5;if(parseInt($td.css("border-top-width"),10)>0){height-=1}if(parseInt($td.css("border-left-width"),10)>0){if(rowHeadersCount>0){width-=1}}this.$textarea.autoResize({minHeight:Math.min(height,maxHeight),maxHeight:maxHeight,minWidth:Math.min(width,maxWidth),maxWidth:maxWidth,animate:false,extraSpace:0});this.textareaParentStyle.display="block"};TextEditor.prototype.bindEvents=function(){this.$textarea.on("cut.editor",function(event){event.stopPropagation()});this.$textarea.on("paste.editor",function(event){event.stopPropagation()})};Handsontable.editors.TextEditor=TextEditor;Handsontable.editors.registerEditor("text",Handsontable.editors.TextEditor)})(Handsontable);(function(Handsontable){var CheckboxEditor=Handsontable.editors.BaseEditor.prototype.extend();CheckboxEditor.prototype.beginEditing=function(){this.saveValue([[!this.originalValue]])};CheckboxEditor.prototype.finishEditing=function(){};CheckboxEditor.prototype.init=function(){};CheckboxEditor.prototype.open=function(){};CheckboxEditor.prototype.close=function(){};CheckboxEditor.prototype.getValue=function(){};CheckboxEditor.prototype.setValue=function(){};CheckboxEditor.prototype.focus=function(){};Handsontable.editors.CheckboxEditor=CheckboxEditor;Handsontable.editors.registerEditor("checkbox",CheckboxEditor)})(Handsontable);(function(Handsontable){var DateEditor=Handsontable.editors.TextEditor.prototype.extend();DateEditor.prototype.init=function(){if(!$.datepicker){throw new Error("jQuery UI Datepicker dependency not found. Did you forget to include jquery-ui.custom.js or its substitute?")}Handsontable.editors.TextEditor.prototype.init.apply(this,arguments);this.isCellEdited=false;var that=this;this.instance.addHook("afterDestroy",function(){that.destroyElements()})};DateEditor.prototype.createElements=function(){Handsontable.editors.TextEditor.prototype.createElements.apply(this,arguments);this.datePicker=document.createElement("DIV");this.instance.view.wt.wtDom.addClass(this.datePicker,"htDatepickerHolder");this.datePickerStyle=this.datePicker.style;this.datePickerStyle.position="absolute";this.datePickerStyle.top=0;this.datePickerStyle.left=0;this.datePickerStyle.zIndex=99;document.body.appendChild(this.datePicker);this.$datePicker=$(this.datePicker);var that=this;var defaultOptions={dateFormat:"yy-mm-dd",showButtonPanel:true,changeMonth:true,changeYear:true,altField:this.$textarea,onSelect:function(){that.finishEditing(false)}};this.$datePicker.datepicker(defaultOptions);this.$datePicker.on("mousedown",function(event){event.stopPropagation()});this.hideDatepicker()};DateEditor.prototype.destroyElements=function(){this.$datePicker.datepicker("destroy");this.$datePicker.remove()};DateEditor.prototype.beginEditing=function(row,col,prop,useOriginalValue,suffix){Handsontable.editors.TextEditor.prototype.beginEditing.apply(this,arguments);this.showDatepicker()};DateEditor.prototype.finishEditing=function(isCancelled,ctrlDown){this.hideDatepicker();Handsontable.editors.TextEditor.prototype.finishEditing.apply(this,arguments)};DateEditor.prototype.showDatepicker=function(){var $td=$(this.TD);var offset=$td.offset();this.datePickerStyle.top=(offset.top+$td.height())+"px";this.datePickerStyle.left=offset.left+"px";var dateOptions={defaultDate:this.originalValue||void 0};$.extend(dateOptions,this.cellProperties);this.$datePicker.datepicker("option",dateOptions);if(this.originalValue){this.$datePicker.datepicker("setDate",this.originalValue)}this.datePickerStyle.display="block"};DateEditor.prototype.hideDatepicker=function(){this.datePickerStyle.display="none"};Handsontable.editors.DateEditor=DateEditor;Handsontable.editors.registerEditor("date",DateEditor)})(Handsontable);(function(Handsontable){var HandsontableEditor=Handsontable.editors.TextEditor.prototype.extend();HandsontableEditor.prototype.createElements=function(){Handsontable.editors.TextEditor.prototype.createElements.apply(this,arguments);var DIV=document.createElement("DIV");DIV.className="handsontableEditor";this.TEXTAREA_PARENT.appendChild(DIV);this.$htContainer=$(DIV);this.$htContainer.handsontable()};HandsontableEditor.prototype.prepare=function(td,row,col,prop,value,cellProperties){Handsontable.editors.TextEditor.prototype.prepare.apply(this,arguments);var parent=this;var options={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",cells:function(){return{readOnly:true}},fillHandle:false,afterOnCellMouseDown:function(){parent.setValue(this.getValue());parent.instance.destroyEditor()},beforeOnKeyDown:function(event){var instance=this;switch(event.keyCode){case Handsontable.helper.keyCode.ESCAPE:parent.instance.destroyEditor(true);event.stopImmediatePropagation();event.preventDefault();break;case Handsontable.helper.keyCode.ENTER:var sel=instance.getSelected();parent.setValue(this.getDataAtCell(sel[0],sel[1]));parent.instance.destroyEditor();break;case Handsontable.helper.keyCode.ARROW_UP:if(instance.getSelected()&&instance.getSelected()[0]==0&&!parent.cellProperties.strict){instance.deselectCell();parent.instance.listen();parent.focus();event.preventDefault();event.stopImmediatePropagation()}break}}};if(this.cellProperties.handsontable){options=$.extend(options,cellProperties.handsontable)}this.$htContainer.handsontable("destroy");this.$htContainer.handsontable(options)};var onBeforeKeyDown=function(event){if(event.isImmediatePropagationStopped()){return}var editor=this.getActiveEditor();var innerHOT=editor.$htContainer.handsontable("getInstance");if(event.keyCode==Handsontable.helper.keyCode.ARROW_DOWN){if(!innerHOT.getSelected()){innerHOT.selectCell(0,0)}else{var selectedRow=innerHOT.getSelected()[0];var rowToSelect=selectedRow<innerHOT.countRows()-1?selectedRow+1:selectedRow;innerHOT.selectCell(rowToSelect,0)}event.preventDefault();event.stopImmediatePropagation()}};HandsontableEditor.prototype.open=function(){this.instance.addHook("beforeKeyDown",onBeforeKeyDown);Handsontable.editors.TextEditor.prototype.open.apply(this,arguments);this.$htContainer.handsontable("render");if(this.cellProperties.strict){this.$htContainer.handsontable("selectCell",0,0);this.$textarea[0].style.visibility="hidden"}else{this.$htContainer.handsontable("deselectCell");this.$textarea[0].style.visibility="visible"}this.wtDom.setCaretPosition(this.$textarea[0],0,this.$textarea[0].value.length)};HandsontableEditor.prototype.close=function(){this.instance.removeHook("beforeKeyDown",onBeforeKeyDown);this.instance.listen();Handsontable.editors.TextEditor.prototype.close.apply(this,arguments)};HandsontableEditor.prototype.focus=function(){this.instance.listen();Handsontable.editors.TextEditor.prototype.focus.apply(this,arguments)};HandsontableEditor.prototype.beginEditing=function(initialValue){var onBeginEditing=this.instance.getSettings().onBeginEditing;if(onBeginEditing&&onBeginEditing()===false){return}Handsontable.editors.TextEditor.prototype.beginEditing.apply(this,arguments)};HandsontableEditor.prototype.finishEditing=function(isCancelled,ctrlDown){if(this.$htContainer.handsontable("isListening")){this.instance.listen()}if(this.$htContainer.handsontable("getSelected")){this.setValue(this.$htContainer.handsontable("getInstance").getValue())}return Handsontable.editors.TextEditor.prototype.finishEditing.apply(this,arguments)};Handsontable.editors.HandsontableEditor=HandsontableEditor;Handsontable.editors.registerEditor("handsontable",HandsontableEditor)})(Handsontable);(function(Handsontable){var AutocompleteEditor=Handsontable.editors.HandsontableEditor.prototype.extend();AutocompleteEditor.prototype.init=function(){Handsontable.editors.HandsontableEditor.prototype.init.apply(this,arguments);this.query=null};AutocompleteEditor.prototype.createElements=function(){Handsontable.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);this.$htContainer.addClass("autocompleteEditor")};AutocompleteEditor.prototype.bindEvents=function(){var that=this;this.$textarea.on("keydown.autocompleteEditor",function(event){if(!Handsontable.helper.isMetaKey(event.keyCode)||[Handsontable.helper.keyCode.BACKSPACE,Handsontable.helper.keyCode.DELETE].indexOf(event.keyCode)!=-1){setTimeout(function(){that.queryChoices(that.$textarea.val())})}else{if(event.keyCode==Handsontable.helper.keyCode.ENTER&&that.cellProperties.strict!==true){that.$htContainer.handsontable("deselectCell")}}});this.$htContainer.on("mouseenter",function(){that.$htContainer.handsontable("deselectCell")});this.$htContainer.on("mouseleave",function(){that.queryChoices(that.query)});Handsontable.editors.HandsontableEditor.prototype.bindEvents.apply(this,arguments)};AutocompleteEditor.prototype.beginEditing=function(){Handsontable.editors.HandsontableEditor.prototype.beginEditing.apply(this,arguments);var that=this;setTimeout(function(){that.queryChoices(that.TEXTAREA.value)});var hot=this.$htContainer.handsontable("getInstance");hot.updateSettings({colWidths:[this.wtDom.outerWidth(this.TEXTAREA)-2],renderer:function(instance,TD,row,col,prop,value,cellProperties){Handsontable.TextRenderer.apply(this,arguments);var match=TD.innerHTML.match(new RegExp(that.query,"i"));if(match){TD.innerHTML=value.replace(match[0],"<strong>"+match[0]+"</strong>")}}})};var onBeforeKeyDownInner;AutocompleteEditor.prototype.open=function(){var parent=this;onBeforeKeyDownInner=function(event){var instance=this;if(event.keyCode==Handsontable.helper.keyCode.ARROW_UP){if(instance.getSelected()&&instance.getSelected()[0]==0){if(!parent.cellProperties.strict){instance.deselectCell()}parent.instance.listen();parent.focus();event.preventDefault();event.stopImmediatePropagation()}}};this.$htContainer.handsontable("getInstance").addHook("beforeKeyDown",onBeforeKeyDownInner);Handsontable.editors.HandsontableEditor.prototype.open.apply(this,arguments);this.$textarea[0].style.visibility="visible";parent.focus()};AutocompleteEditor.prototype.close=function(){this.$htContainer.handsontable("getInstance").removeHook("beforeKeyDown",onBeforeKeyDownInner);Handsontable.editors.HandsontableEditor.prototype.close.apply(this,arguments)};AutocompleteEditor.prototype.queryChoices=function(query){this.query=query;if(typeof this.cellProperties.source=="function"){var that=this;this.cellProperties.source(query,function(choices){that.updateChoicesList(choices)})}else{if(Handsontable.helper.isArray(this.cellProperties.source)){var choices;if(!query||this.cellProperties.filter===false){choices=this.cellProperties.source}else{choices=this.cellProperties.source.filter(function(choice){return choice.indexOf(query)!=-1})}this.updateChoicesList(choices)}else{this.updateChoicesList([])}}};function findItemIndexToHighlight(items,value){var bestMatch={};var valueLength=value.length;var currentItem;var indexOfValue;var charsLeft;for(var i=0,len=items.length;i<len;i++){currentItem=items[i];if(valueLength>0){indexOfValue=currentItem.indexOf(value)}else{indexOfValue=currentItem===value?0:-1}if(indexOfValue==-1){continue}charsLeft=currentItem.length-indexOfValue-valueLength;if(typeof bestMatch.indexOfValue=="undefined"||bestMatch.indexOfValue>indexOfValue||(bestMatch.indexOfValue==indexOfValue&&bestMatch.charsLeft>charsLeft)){bestMatch.indexOfValue=indexOfValue;bestMatch.charsLeft=charsLeft;bestMatch.index=i}}return bestMatch.index}AutocompleteEditor.prototype.updateChoicesList=function(choices){this.$htContainer.handsontable("loadData",Handsontable.helper.pivot([choices]));var value=this.getValue();var rowToHighlight;if(this.cellProperties.strict===true){rowToHighlight=findItemIndexToHighlight(choices,value);if(typeof rowToHighlight=="undefined"){rowToHighlight=0}}if(typeof rowToHighlight=="undefined"){this.$htContainer.handsontable("deselectCell")}else{this.$htContainer.handsontable("selectCell",rowToHighlight,0)}this.focus()};Handsontable.editors.AutocompleteEditor=AutocompleteEditor;Handsontable.editors.registerEditor("autocomplete",AutocompleteEditor)})(Handsontable);(function(Handsontable){var PasswordEditor=Handsontable.editors.TextEditor.prototype.extend();var wtDom=new WalkontableDom();PasswordEditor.prototype.createElements=function(){Handsontable.editors.TextEditor.prototype.createElements.apply(this,arguments);this.TEXTAREA=document.createElement("input");this.TEXTAREA.setAttribute("type","password");this.TEXTAREA.className="handsontableInput";this.textareaStyle=this.TEXTAREA.style;this.textareaStyle.width=0;this.textareaStyle.height=0;this.$textarea=$(this.TEXTAREA);wtDom.empty(this.TEXTAREA_PARENT);this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)};Handsontable.editors.PasswordEditor=PasswordEditor;Handsontable.editors.registerEditor("password",PasswordEditor)})(Handsontable);(function(Handsontable){var SelectEditor=Handsontable.editors.BaseEditor.prototype.extend();SelectEditor.prototype.init=function(){this.select=$("<select />").addClass("htSelectEditor").hide();this.instance.rootElement.append(this.select)};SelectEditor.prototype.prepare=function(){Handsontable.editors.BaseEditor.prototype.prepare.apply(this,arguments);var selectOptions=this.cellProperties.selectOptions;var options;if(typeof selectOptions=="function"){options=this.prepareOptions(selectOptions(this.row,this.col,this.prop))}else{options=this.prepareOptions(selectOptions)}var optionElements=[];for(var option in options){if(options.hasOwnProperty(option)){var optionElement=$("<option />");optionElement.val(option);optionElement.html(options[option]);optionElements.push(optionElement)}}this.select.empty();this.select.append(optionElements)};SelectEditor.prototype.prepareOptions=function(optionsToPrepare){var preparedOptions={};if(Handsontable.helper.isArray(optionsToPrepare)){for(var i=0,len=optionsToPrepare.length;i<len;i++){preparedOptions[optionsToPrepare[i]]=optionsToPrepare[i]}}else{if(typeof optionsToPrepare=="object"){preparedOptions=optionsToPrepare}}return preparedOptions};SelectEditor.prototype.getValue=function(){return this.select.val()};SelectEditor.prototype.setValue=function(value){this.select.val(value)};var onBeforeKeyDown=function(event){var instance=this;var editor=instance.getActiveEditor();switch(event.keyCode){case Handsontable.helper.keyCode.ARROW_UP:var previousOption=editor.select.find("option:selected").prev();if(previousOption.length==1){previousOption.prop("selected",true)}event.stopImmediatePropagation();event.preventDefault();break;case Handsontable.helper.keyCode.ARROW_DOWN:var nextOption=editor.select.find("option:selected").next();if(nextOption.length==1){nextOption.prop("selected",true)}event.stopImmediatePropagation();event.preventDefault();break}};SelectEditor.prototype.open=function(){this.select.css({height:$(this.TD).height(),"min-width":$(this.TD).outerWidth()});this.select.show();this.select.offset($(this.TD).offset());this.instance.addHook("beforeKeyDown",onBeforeKeyDown)};SelectEditor.prototype.close=function(){this.select.hide();this.instance.removeHook("beforeKeyDown",onBeforeKeyDown)};Handsontable.editors.SelectEditor=SelectEditor;Handsontable.editors.registerEditor("select",SelectEditor)})(Handsontable);(function(Handsontable){var DropdownEditor=Handsontable.editors.AutocompleteEditor.prototype.extend();DropdownEditor.prototype.prepare=function(){Handsontable.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments);this.cellProperties.filter=false;this.cellProperties.strict=true};Handsontable.editors.DropdownEditod=DropdownEditor;Handsontable.editors.registerEditor("dropdown",DropdownEditor)})(Handsontable);Handsontable.NumericValidator=function(value,callback){if(value===null){value=""}callback(/^-?\d*\.?\d*$/.test(value))};var process=function(value,callback){var originalVal=value;var lowercaseVal=typeof originalVal==="string"?originalVal.toLowerCase():null;return function(source){var found=false;for(var s=0,slen=source.length;s<slen;s++){if(originalVal===source[s]){found=true;break}else{if(lowercaseVal===source[s].toLowerCase()){found=true;break}}}callback(found)}};Handsontable.AutocompleteValidator=function(value,callback){if(this.strict&&this.source){typeof this.source==="function"?this.source(value,process(value,callback)):process(value,callback)(this.source)}else{callback(true)}};Handsontable.AutocompleteCell={editor:"autocomplete",renderer:Handsontable.AutocompleteRenderer,validator:Handsontable.AutocompleteValidator};Handsontable.CheckboxCell={editor:"checkbox",renderer:Handsontable.CheckboxRenderer};Handsontable.TextCell={editor:"text",renderer:Handsontable.TextRenderer};Handsontable.NumericCell={editor:"text",renderer:Handsontable.NumericRenderer,validator:Handsontable.NumericValidator,dataType:"number"};Handsontable.DateCell={editor:"date",renderer:Handsontable.AutocompleteRenderer};Handsontable.HandsontableCell={editor:"handsontable",renderer:Handsontable.AutocompleteRenderer};Handsontable.PasswordCell={editor:"password",renderer:Handsontable.PasswordRenderer};Handsontable.DropdownCell={editor:"dropdown",renderer:Handsontable.AutocompleteRenderer,validator:Handsontable.AutocompleteValidator};Handsontable.cellTypes={text:Handsontable.TextCell,date:Handsontable.DateCell,numeric:Handsontable.NumericCell,checkbox:Handsontable.CheckboxCell,autocomplete:Handsontable.AutocompleteCell,handsontable:Handsontable.HandsontableCell,password:Handsontable.PasswordCell,dropdown:Handsontable.DropdownCell};Handsontable.cellLookup={renderer:{text:Handsontable.TextRenderer,numeric:Handsontable.NumericRenderer,checkbox:Handsontable.CheckboxRenderer,autocomplete:Handsontable.AutocompleteRenderer,password:Handsontable.PasswordRenderer},validator:{numeric:Handsontable.NumericValidator,autocomplete:Handsontable.AutocompleteValidator}};Handsontable.PluginHookClass=(function(){var Hooks=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeChange:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGet:[],beforeSet:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeColumnSort:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterColumnResize:[],afterColumnMove:[],afterColumnSort:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterCopyLimit:[],afterOnCellMouseDown:[],afterOnCellCornerMouseDown:[],modifyCol:[]}};var legacy={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};function PluginHookClass(){this.hooks=Hooks();this.legacy=legacy}PluginHookClass.prototype.add=function(key,fn){if(key in legacy){key=legacy[key]}if(typeof this.hooks[key]==="undefined"){this.hooks[key]=[]}if(Handsontable.helper.isArray(fn)){for(var i=0,len=fn.length;i<len;i++){this.hooks[key].push(fn[i])}}else{this.hooks[key].push(fn)}return this};PluginHookClass.prototype.once=function(key,fn){if(Handsontable.helper.isArray(fn)){for(var i=0,len=fn.length;i<len;i++){fn[i].runOnce=true;this.add(key,fn[i])}}else{fn.runOnce=true;this.add(key,fn)}};PluginHookClass.prototype.remove=function(key,fn){var status=false;if(key in legacy){key=legacy[key]}if(typeof this.hooks[key]!=="undefined"){for(var i=0,leni=this.hooks[key].length;i<leni;i++){if(this.hooks[key][i]==fn){delete this.hooks[key][i].runOnce;this.hooks[key].splice(i,1);status=true;break}}}return status};PluginHookClass.prototype.run=function(instance,key,p1,p2,p3,p4,p5){if(key in legacy){key=legacy[key]}if(typeof this.hooks[key]!=="undefined"){var handlers=Array.prototype.slice.call(this.hooks[key]);for(var i=0,leni=handlers.length;i<leni;i++){handlers[i].call(instance,p1,p2,p3,p4,p5);if(handlers[i].runOnce){this.remove(key,handlers[i])}}}};PluginHookClass.prototype.execute=function(instance,key,p1,p2,p3,p4,p5){var res,handlers;if(key in legacy){key=legacy[key]}if(typeof this.hooks[key]!=="undefined"){handlers=Array.prototype.slice.call(this.hooks[key]);for(var i=0,leni=handlers.length;i<leni;i++){res=handlers[i].call(instance,p1,p2,p3,p4,p5);if(res!==void 0){p1=res}if(handlers[i].runOnce){this.remove(key,handlers[i])}if(res===false){return false}}}return p1};return PluginHookClass})();Handsontable.PluginHooks=new Handsontable.PluginHookClass();(function(Handsontable){function HandsontableAutoColumnSize(){var plugin=this,sampleCount=5;this.beforeInit=function(){var instance=this;instance.autoColumnWidths=[];if(instance.getSettings().autoColumnSize!==false){if(!instance.autoColumnSizeTmp){instance.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:true}}instance.addHook("beforeRender",htAutoColumnSize.determineIfChanged);instance.addHook("afterGetColWidth",htAutoColumnSize.getColWidth);instance.addHook("afterDestroy",htAutoColumnSize.afterDestroy);instance.determineColumnWidth=plugin.determineColumnWidth}else{instance.removeHook("beforeRender",htAutoColumnSize.determineIfChanged);instance.removeHook("afterGetColWidth",htAutoColumnSize.getColWidth);instance.removeHook("afterDestroy",htAutoColumnSize.afterDestroy);delete instance.determineColumnWidth;plugin.afterDestroy.call(instance)}};this.determineIfChanged=function(force){if(force){htAutoColumnSize.determineColumnsWidth.apply(this,arguments)}};this.determineColumnWidth=function(col){var instance=this,tmp=instance.autoColumnSizeTmp;if(!tmp.container){createTmpContainer.call(tmp,instance)}tmp.container.className=instance.rootElement[0].className+" htAutoColumnSize";tmp.table.className=instance.$table[0].className;var rows=instance.countRows();var samples={};var maxLen=0;for(var r=0;r<rows;r++){var value=Handsontable.helper.stringify(instance.getDataAtCell(r,col));var len=value.length;if(len>maxLen){maxLen=len}if(!samples[len]){samples[len]={needed:sampleCount,strings:[]}}if(samples[len].needed){samples[len].strings.push({value:value,row:r});samples[len].needed--}}var settings=instance.getSettings();if(settings.colHeaders){instance.view.appendColHeader(col,tmp.theadTh)}instance.view.wt.wtDom.empty(tmp.tbody);var cellProperties=instance.getCellMeta(0,col);var renderer=instance.getCellRenderer(cellProperties);for(var i in samples){if(samples.hasOwnProperty(i)){for(var j=0,jlen=samples[i].strings.length;j<jlen;j++){var tr=document.createElement("tr");var td=document.createElement("td");renderer(instance,td,samples[i].strings[j].row,col,instance.colToProp(col),samples[i].strings[j].value,cellProperties);r++;tr.appendChild(td);tmp.tbody.appendChild(tr)}}}var parent=instance.rootElement[0].parentNode;parent.appendChild(tmp.container);var width=instance.view.wt.wtDom.outerWidth(tmp.table);parent.removeChild(tmp.container);var maxWidth=instance.view.wt.wtViewport.getViewportWidth()-2;if(width>maxWidth){width=maxWidth}return width};this.determineColumnsWidth=function(){var instance=this;var settings=this.getSettings();if(settings.autoColumnSize||!settings.colWidths){var cols=this.countCols();for(var c=0;c<cols;c++){if(!instance._getColWidthFromSettings(c)){this.autoColumnWidths[c]=plugin.determineColumnWidth.call(instance,c)}}}};this.getColWidth=function(col,response){if(this.autoColumnWidths[col]&&this.autoColumnWidths[col]>response.width){response.width=this.autoColumnWidths[col]}};this.afterDestroy=function(){var instance=this;if(instance.autoColumnSizeTmp&&instance.autoColumnSizeTmp.container&&instance.autoColumnSizeTmp.container.parentNode){instance.autoColumnSizeTmp.container.parentNode.removeChild(instance.autoColumnSizeTmp.container)}};function createTmpContainer(instance){var d=document,tmp=this;tmp.table=d.createElement("table");tmp.theadTh=d.createElement("th");tmp.table.appendChild(d.createElement("thead")).appendChild(d.createElement("tr")).appendChild(tmp.theadTh);tmp.tableStyle=tmp.table.style;tmp.tableStyle.tableLayout="auto";tmp.tableStyle.width="auto";tmp.tbody=d.createElement("tbody");tmp.table.appendChild(tmp.tbody);tmp.container=d.createElement("div");tmp.container.className=instance.rootElement[0].className+" hidden";tmp.containerStyle=tmp.container.style;tmp.container.appendChild(tmp.table)}}var htAutoColumnSize=new HandsontableAutoColumnSize();Handsontable.PluginHooks.add("beforeInit",htAutoColumnSize.beforeInit);Handsontable.PluginHooks.add("afterUpdateSettings",htAutoColumnSize.beforeInit)})(Handsontable);function HandsontableColumnSorting(){var plugin=this;this.init=function(source){var instance=this;var sortingSettings=instance.getSettings().columnSorting;var sortingColumn,sortingOrder;instance.sortingEnabled=!!(sortingSettings);if(instance.sortingEnabled){instance.sortIndex=[];var loadedSortingState=loadSortingState.call(instance);if(typeof loadedSortingState!="undefined"){sortingColumn=loadedSortingState.sortColumn;sortingOrder=loadedSortingState.sortOrder}else{sortingColumn=sortingSettings.column;sortingOrder=sortingSettings.sortOrder}plugin.sortByColumn.call(instance,sortingColumn,sortingOrder);instance.sort=function(){var args=Array.prototype.slice.call(arguments);return plugin.sortByColumn.apply(instance,args)};if(typeof instance.getSettings().observeChanges=="undefined"){enableObserveChangesPlugin.call(instance)}if(source=="afterInit"){bindColumnSortingAfterClick.call(instance);instance.addHook("afterCreateRow",plugin.afterCreateRow);instance.addHook("afterRemoveRow",plugin.afterRemoveRow);instance.addHook("afterLoadData",plugin.init)}}else{delete instance.sort;instance.removeHook("afterCreateRow",plugin.afterCreateRow);instance.removeHook("afterRemoveRow",plugin.afterRemoveRow);instance.removeHook("afterLoadData",plugin.init)}};this.setSortingColumn=function(col,order){var instance=this;if(typeof col=="undefined"){delete instance.sortColumn;delete instance.sortOrder;return}else{if(instance.sortColumn===col&&typeof order=="undefined"){instance.sortOrder=!instance.sortOrder}else{instance.sortOrder=typeof order!="undefined"?order:true}}instance.sortColumn=col};this.sortByColumn=function(col,order){var instance=this;plugin.setSortingColumn.call(instance,col,order);if(typeof instance.sortColumn=="undefined"){return}instance.PluginHooks.run("beforeColumnSort",instance.sortColumn,instance.sortOrder);plugin.sort.call(instance);instance.render();saveSortingState.call(instance);instance.PluginHooks.run("afterColumnSort",instance.sortColumn,instance.sortOrder)};var saveSortingState=function(){var instance=this;var sortingState={};if(typeof instance.sortColumn!="undefined"){sortingState.sortColumn=instance.sortColumn}if(typeof instance.sortOrder!="undefined"){sortingState.sortOrder=instance.sortOrder}if(sortingState.hasOwnProperty("sortColumn")||sortingState.hasOwnProperty("sortOrder")){instance.PluginHooks.run("persistentStateSave","columnSorting",sortingState)}};var loadSortingState=function(){var instance=this;var storedState={};instance.PluginHooks.run("persistentStateLoad","columnSorting",storedState);return storedState.value};var bindColumnSortingAfterClick=function(){var instance=this;instance.rootElement.on("click.handsontable",".columnSorting",function(e){if(instance.view.wt.wtDom.hasClass(e.target,"columnSorting")){var col=getColumn(e.target);plugin.sortByColumn.call(instance,col)}});function countRowHeaders(){var THs=instance.view.TBODY.querySelector("tr").querySelectorAll("th");return THs.length}function getColumn(target){var TH=instance.view.wt.wtDom.closest(target,"TH");return instance.view.wt.wtDom.index(TH)-countRowHeaders()}};function enableObserveChangesPlugin(){var instance=this;instance.registerTimeout("enableObserveChanges",function(){instance.updateSettings({observeChanges:true})},0)}function defaultSort(sortOrder){return function(a,b){if(a[1]===b[1]){return 0}if(a[1]===null){return 1}if(b[1]===null){return -1}if(a[1]<b[1]){return sortOrder?-1:1}if(a[1]>b[1]){return sortOrder?1:-1}return 0}}function dateSort(sortOrder){return function(a,b){if(a[1]===b[1]){return 0}if(a[1]===null){return 1}if(b[1]===null){return -1}var aDate=new Date(a[1]);var bDate=new Date(b[1]);if(aDate<bDate){return sortOrder?-1:1}if(aDate>bDate){return sortOrder?1:-1}return 0}}this.sort=function(){var instance=this;if(typeof instance.sortOrder=="undefined"){return}instance.sortingEnabled=false;instance.sortIndex.length=0;var colOffset=this.colOffset();for(var i=0,ilen=this.countRows()-instance.getSettings()["minSpareRows"];i<ilen;i++){this.sortIndex.push([i,instance.getDataAtCell(i,this.sortColumn+colOffset)])}var colMeta=instance.getCellMeta(0,instance.sortColumn);var sortFunction;switch(colMeta.type){case"date":sortFunction=dateSort;break;default:sortFunction=defaultSort}this.sortIndex.sort(sortFunction(instance.sortOrder));for(var i=this.sortIndex.length;i<instance.countRows();i++){this.sortIndex.push([i,instance.getDataAtCell(i,this.sortColumn+colOffset)])}instance.sortingEnabled=true};this.translateRow=function(row){var instance=this;if(instance.sortingEnabled&&instance.sortIndex&&instance.sortIndex.length&&instance.sortIndex[row]){return instance.sortIndex[row][0]}return row};this.onBeforeGetSet=function(getVars){var instance=this;getVars.row=plugin.translateRow.call(instance,getVars.row)};this.untranslateRow=function(row){var instance=this;if(instance.sortingEnabled&&instance.sortIndex&&instance.sortIndex.length){for(var i=0;i<instance.sortIndex.length;i++){if(instance.sortIndex[i][0]==row){return i}}}};this.getColHeader=function(col,TH){if(this.getSettings().columnSorting){this.view.wt.wtDom.addClass(TH.querySelector(".colHeader"),"columnSorting")}};function isSorted(instance){return typeof instance.sortColumn!="undefined"}this.afterCreateRow=function(index,amount){var instance=this;if(!isSorted(instance)){return}for(var i=0;i<instance.sortIndex.length;i++){if(instance.sortIndex[i][0]>=index){instance.sortIndex[i][0]+=amount}}for(var i=0;i<amount;i++){instance.sortIndex.splice(index+i,0,[index+i,instance.getData()[index+i][instance.sortColumn+instance.colOffset()]])}saveSortingState.call(instance)};this.afterRemoveRow=function(index,amount){var instance=this;if(!isSorted(instance)){return}var physicalRemovedIndex=plugin.untranslateRow.call(instance,index);instance.sortIndex.splice(index,amount);for(var i=0;i<instance.sortIndex.length;i++){if(instance.sortIndex[i][0]>physicalRemovedIndex){instance.sortIndex[i][0]-=amount}}saveSortingState.call(instance)};this.afterChangeSort=function(changes){var instance=this;var sortColumnChanged=false;var selection={};if(!changes){return}for(var i=0;i<changes.length;i++){if(changes[i][1]==instance.sortColumn){sortColumnChanged=true;selection.row=plugin.translateRow.call(instance,changes[i][0]);selection.col=changes[i][1];break}}if(sortColumnChanged){setTimeout(function(){plugin.sort.call(instance);instance.render();instance.selectCell(plugin.untranslateRow.call(instance,selection.row),selection.col)},0)}}}var htSortColumn=new HandsontableColumnSorting();Handsontable.PluginHooks.add("afterInit",function(){htSortColumn.init.call(this,"afterInit")});Handsontable.PluginHooks.add("afterUpdateSettings",function(){htSortColumn.init.call(this,"afterUpdateSettings")});Handsontable.PluginHooks.add("beforeGet",htSortColumn.onBeforeGetSet);Handsontable.PluginHooks.add("beforeSet",htSortColumn.onBeforeGetSet);Handsontable.PluginHooks.add("afterGetColHeader",htSortColumn.getColHeader);(function(Handsontable){function ContextMenu(instance,customOptions){this.instance=instance;var contextMenu=this;this.menu=createMenu();this.enabled=true;this.bindMouseEvents();this.instance.addHook("afterDestroy",function(){contextMenu.destroy()});this.defaultOptions={items:{row_above:{name:"Insert row above",callback:function(key,selection){this.alter("insert_row",selection.start.row())},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},row_below:{name:"Insert row below",callback:function(key,selection){this.alter("insert_row",selection.end.row()+1)},disabled:function(){return this.countRows()>=this.getSettings().maxRows}},hsep1:ContextMenu.SEPARATOR,col_left:{name:"Insert column on the left",callback:function(key,selection){this.alter("insert_col",selection.start.col())},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},col_right:{name:"Insert column on the right",callback:function(key,selection){this.alter("insert_col",selection.end.col()+1)},disabled:function(){return this.countCols()>=this.getSettings().maxCols}},hsep2:ContextMenu.SEPARATOR,remove_row:{name:"Remove row",callback:function(key,selection){var amount=selection.end.row()-selection.start.row()+1;this.alter("remove_row",selection.start.row(),amount)}},remove_col:{name:"Remove column",callback:function(key,selection){var amount=selection.end.col()-selection.start.col()+1;this.alter("remove_col",selection.start.col(),amount)}},hsep3:ContextMenu.SEPARATOR,undo:{name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},redo:{name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}};this.options={};Handsontable.helper.extend(this.options,this.defaultOptions);this.updateOptions(customOptions);function createMenu(){var menu=document.createElement("DIV");Handsontable.Dom.addClass(menu,"htContextMenu");instance.rootElement[0].appendChild(menu);return menu}}ContextMenu.prototype.bindMouseEvents=function(){function contextMenuOpenListener(event){event.preventDefault();if(event.target.nodeName!="TD"&&!(Handsontable.Dom.hasClass(event.target,"current")&&Handsontable.Dom.hasClass(event.target,"wtBorder"))){return}this.show(event.pageY,event.pageX);$(document).on("mousedown.htContextMenu",Handsontable.helper.proxy(ContextMenu.prototype.close,this))}this.instance.rootElement.on("contextmenu.htContextMenu",Handsontable.helper.proxy(contextMenuOpenListener,this));$(this.menu).on("mousedown",Handsontable.helper.proxy(this.performAction,this))};ContextMenu.prototype.performAction=function(){var hot=$(this.menu).handsontable("getInstance");var selectedItemIndex=hot.getSelected()[0];var selectedItem=hot.getData()[selectedItemIndex];if(selectedItem.disabled===true||(typeof selectedItem.disabled=="function"&&selectedItem.disabled.call(this.instance)===true)){return}if(typeof selectedItem.callback!="function"){return}var corners=this.instance.getSelected();var normalizedSelection=ContextMenu.utils.normalizeSelection(corners);selectedItem.callback.call(this.instance,selectedItem.key,normalizedSelection)};ContextMenu.prototype.unbindMouseEvents=function(){this.instance.rootElement.off("contextmenu.htContextMenu");$(document).off("mousedown.htContextMenu")};ContextMenu.prototype.show=function(top,left){this.menu.style.display="block";$(this.menu).handsontable({data:ContextMenu.utils.convertItemsToArray(this.getItems()),colHeaders:false,colWidths:[160],readOnly:true,columns:[{data:"name",renderer:Handsontable.helper.proxy(this.renderer,this)}],beforeKeyDown:Handsontable.helper.proxy(this.onBeforeKeyDown,this)});this.setMenuPosition(top,left);$(this.menu).handsontable("listen")};ContextMenu.prototype.renderer=function(instance,TD,row,col,prop,value,cellProperties){var contextMenu=this;var item=instance.getData()[row];var wrapper=document.createElement("DIV");Handsontable.Dom.empty(TD);TD.appendChild(wrapper);if(itemIsSeparator(item)){Handsontable.Dom.addClass(TD,"htSeparator")}else{Handsontable.Dom.fastInnerText(wrapper,value)}if(itemIsDisabled(item,contextMenu.instance)){Handsontable.Dom.addClass(TD,"htDisabled");$(wrapper).on("mouseenter",function(){instance.deselectCell()})}else{Handsontable.Dom.removeClass(TD,"htDisabled");$(wrapper).on("mouseenter",function(){instance.selectCell(row,col)})}function itemIsSeparator(item){return new RegExp(ContextMenu.SEPARATOR,"i").test(item.name)}function itemIsDisabled(item,instance){return item.disabled===true||(typeof item.disabled=="function"&&item.disabled.call(contextMenu.instance)===true)}};ContextMenu.prototype.onBeforeKeyDown=function(event){var contextMenu=this;var instance=$(contextMenu.menu).handsontable("getInstance");var selection=instance.getSelected();switch(event.keyCode){case Handsontable.helper.keyCode.ESCAPE:contextMenu.close();event.preventDefault();event.stopImmediatePropagation();break;case Handsontable.helper.keyCode.ENTER:if(instance.getSelected()){contextMenu.performAction();contextMenu.close()}break;case Handsontable.helper.keyCode.ARROW_DOWN:if(!selection){selectFirstCell(instance)}else{selectNextCell(selection[0],selection[1],instance)}event.preventDefault();event.stopImmediatePropagation();break;case Handsontable.helper.keyCode.ARROW_UP:if(!selection){selectLastCell(instance)}else{selectPrevCell(selection[0],selection[1],instance)}event.preventDefault();event.stopImmediatePropagation();break}function selectFirstCell(instance){var firstCell=instance.getCell(0,0);if(ContextMenu.utils.isSeparator(firstCell)||ContextMenu.utils.isDisabled(firstCell)){selectNextCell(0,0,instance)}else{instance.selectCell(0,0)}}function selectLastCell(instance){var lastRow=instance.countRows()-1;var lastCell=instance.getCell(lastRow,0);if(ContextMenu.utils.isSeparator(lastCell)||ContextMenu.utils.isDisabled(lastCell)){selectPrevCell(lastRow,0,instance)}else{instance.selectCell(lastRow,0)}}function selectNextCell(row,col,instance){var nextRow=row+1;var nextCell=nextRow<instance.countRows()?instance.getCell(nextRow,col):null;if(!nextCell){return}if(ContextMenu.utils.isSeparator(nextCell)||ContextMenu.utils.isDisabled(nextCell)){selectNextCell(nextRow,col,instance)}else{instance.selectCell(nextRow,col)}}function selectPrevCell(row,col,instance){var prevRow=row-1;var prevCell=prevRow>=0?instance.getCell(prevRow,col):null;if(!prevCell){return}if(ContextMenu.utils.isSeparator(prevCell)||ContextMenu.utils.isDisabled(prevCell)){selectPrevCell(prevRow,col,instance)}else{instance.selectCell(prevRow,col)}}};ContextMenu.prototype.getItems=function(){var items={};function Item(rawItem){if(typeof rawItem=="string"){this.name=rawItem}else{Handsontable.helper.extend(this,rawItem)}}Item.prototype=this.options;for(var itemName in this.options.items){if(this.options.items.hasOwnProperty(itemName)&&(!this.itemsFilter||this.itemsFilter.indexOf(itemName)!=-1)){items[itemName]=new Item(this.options.items[itemName])}}return items};ContextMenu.prototype.updateOptions=function(newOptions){newOptions=newOptions||{};if(newOptions.items){for(var itemName in newOptions.items){var item={};if(newOptions.items.hasOwnProperty(itemName)){if(this.defaultOptions.items.hasOwnProperty(itemName)&&Handsontable.helper.isObject(newOptions.items[itemName])){Handsontable.helper.extend(item,this.defaultOptions.items[itemName]);Handsontable.helper.extend(item,newOptions.items[itemName]);newOptions.items[itemName]=item}}}}Handsontable.helper.extend(this.options,newOptions)};ContextMenu.prototype.setMenuPosition=function(cursorY,cursorX){var cursor={top:cursorY,topRelative:cursorY-window.pageYOffset,left:cursorX,leftRelative:cursorX-window.pageXOffset};if(this.menuFitsBelowCursor(cursor)){this.positionMenuBelowCursor(cursor)}else{this.positionMenuAboveCursor(cursor)}if(this.menuFitsOnRightOfCursor(cursor)){this.positionMenuOnRightOfCursor(cursor)}else{this.positionMenuOnLeftOfCursor(cursor)}};ContextMenu.prototype.menuFitsBelowCursor=function(cursor){return cursor.topRelative+this.menu.offsetHeight<=document.documentElement.scrollTop+document.documentElement.clientHeight};ContextMenu.prototype.menuFitsOnRightOfCursor=function(cursor){return cursor.leftRelative+this.menu.offsetWidth<=document.documentElement.scrollLeft+document.documentElement.clientWidth};ContextMenu.prototype.positionMenuBelowCursor=function(cursor){this.menu.style.top=this.getCursorRelativeToContainer(cursor).top+"px"};ContextMenu.prototype.positionMenuAboveCursor=function(cursor){this.menu.style.top=(this.getCursorRelativeToContainer(cursor).top-this.menu.offsetHeight)+"px"};ContextMenu.prototype.positionMenuOnRightOfCursor=function(cursor){this.menu.style.left=this.getCursorRelativeToContainer(cursor).left+"px"};ContextMenu.prototype.positionMenuOnLeftOfCursor=function(cursor){this.menu.style.left=(this.getCursorRelativeToContainer(cursor).left-this.menu.offsetWidth)+"px"};ContextMenu.prototype.getCursorRelativeToContainer=function(cursor){var containerOffset=Handsontable.Dom.offset(this.instance.rootElement[0]);return{left:cursor.left-containerOffset.left,top:cursor.top-containerOffset.top}};ContextMenu.utils={};ContextMenu.utils.convertItemsToArray=function(items){var itemArray=[];var item;for(var itemName in items){if(items.hasOwnProperty(itemName)){if(typeof items[itemName]=="string"){item={name:items[itemName]}}else{if(items[itemName].visible!==false){item=items[itemName]}else{continue}}item.key=itemName;itemArray.push(item)}}return itemArray};ContextMenu.utils.normalizeSelection=function(corners){var selection={start:new Handsontable.SelectionPoint(),end:new Handsontable.SelectionPoint()};selection.start.row(Math.min(corners[0],corners[2]));selection.start.col(Math.min(corners[1],corners[3]));selection.end.row(Math.max(corners[0],corners[2]));selection.end.col(Math.max(corners[1],corners[3]));return selection};ContextMenu.utils.isSeparator=function(cell){return Handsontable.Dom.hasClass(cell,"htSeparator")};ContextMenu.utils.isDisabled=function(cell){return Handsontable.Dom.hasClass(cell,"htDisabled")};ContextMenu.prototype.close=function(){this.hide();$(document).off("mousedown.htContextMenu");this.instance.listen()};ContextMenu.prototype.hide=function(){this.menu.style.display="none";$(this.menu).handsontable("destroy")};ContextMenu.prototype.enable=function(){if(!this.enabled){this.enabled=true;this.bindMouseEvents()}};ContextMenu.prototype.disable=function(){if(this.enabled){this.enabled=false;this.close();this.unbindMouseEvents()}};ContextMenu.prototype.destroy=function(){this.close();this.unbindMouseEvents();if(this.menu.parentNode){this.menu.parentNode.removeChild(this.menu)}};ContextMenu.prototype.filterItems=function(itemsToLeave){this.itemsFilter=itemsToLeave};ContextMenu.SEPARATOR="---------";function init(){var instance=this;var contextMenuSetting=instance.getSettings().contextMenu;var customOptions=Handsontable.helper.isObject(contextMenuSetting)?contextMenuSetting:{};if(contextMenuSetting){if(!instance.contextMenu){instance.contextMenu=new ContextMenu(instance,customOptions)}instance.contextMenu.enable();if(Handsontable.helper.isArray(contextMenuSetting)){instance.contextMenu.filterItems(contextMenuSetting)}}else{if(instance.contextMenu){instance.contextMenu.destroy();delete instance.contextMenu}}}Handsontable.PluginHooks.add("afterInit",init);Handsontable.PluginHooks.add("afterUpdateSettings",init);Handsontable.ContextMenu=ContextMenu})(Handsontable);Handsontable.PluginHooks.add("beforeGetCellMeta",function(row,col,cellProperties){var settings=this.getSettings(),data=this.getData(),i,ilen,a;cellProperties.isWritable=!cellProperties.readOnly;if(settings.autoComplete){for(i=0,ilen=settings.autoComplete.length;i<ilen;i++){if(settings.autoComplete[i].match(row,col,data)){if(typeof cellProperties.type==="undefined"){cellProperties.type=Handsontable.AutocompleteCell}else{if(typeof cellProperties.type.renderer==="undefined"){cellProperties.type.renderer=Handsontable.AutocompleteCell.renderer}if(typeof cellProperties.type.editor==="undefined"){cellProperties.type.editor=Handsontable.AutocompleteCell.editor}}for(a in settings.autoComplete[i]){if(settings.autoComplete[i].hasOwnProperty(a)&&a!=="match"&&typeof cellProperties[i]==="undefined"){if(a==="source"){cellProperties[a]=settings.autoComplete[i][a](row,col)}else{cellProperties[a]=settings.autoComplete[i][a]}}}break}}}});function HandsontableManualColumnMove(){var pressed,startCol,endCol,startX,startOffset;var ghost=document.createElement("DIV"),ghostStyle=ghost.style;ghost.className="ghost";ghostStyle.position="absolute";ghostStyle.top="25px";ghostStyle.left=0;ghostStyle.width="10px";ghostStyle.height="10px";ghostStyle.backgroundColor="#CCC";ghostStyle.opacity=0.7;var saveManualColumnPositions=function(){var instance=this;instance.PluginHooks.run("persistentStateSave","manualColumnPositions",instance.manualColumnPositions)};var loadManualColumnPositions=function(){var instance=this;var storedState={};instance.PluginHooks.run("persistentStateLoad","manualColumnPositions",storedState);return storedState.value};var bindMoveColEvents=function(){var instance=this;instance.rootElement.on("mousemove.manualColumnMove",function(e){if(pressed){ghostStyle.left=startOffset+e.pageX-startX+6+"px";if(ghostStyle.display==="none"){ghostStyle.display="block"}}});instance.rootElement.on("mouseup.manualColumnMove",function(){if(pressed){if(startCol<endCol){endCol--}if(instance.getSettings().rowHeaders){startCol--;endCol--}instance.manualColumnPositions.splice(endCol,0,instance.manualColumnPositions.splice(startCol,1)[0]);$(".manualColumnMover.active").removeClass("active");pressed=false;instance.forceFullRender=true;instance.view.render();ghostStyle.display="none";saveManualColumnPositions.call(instance);instance.PluginHooks.run("afterColumnMove",startCol,endCol)}});instance.rootElement.on("mousedown.manualColumnMove",".manualColumnMover",function(e){var mover=e.currentTarget;var TH=instance.view.wt.wtDom.closest(mover,"TH");startCol=instance.view.wt.wtDom.index(TH)+instance.colOffset();endCol=startCol;pressed=true;startX=e.pageX;var TABLE=instance.$table[0];TABLE.parentNode.appendChild(ghost);ghostStyle.width=instance.view.wt.wtDom.outerWidth(TH)+"px";ghostStyle.height=instance.view.wt.wtDom.outerHeight(TABLE)+"px";startOffset=parseInt(instance.view.wt.wtDom.offset(TH).left-instance.view.wt.wtDom.offset(TABLE).left,10);ghostStyle.left=startOffset+6+"px"});instance.rootElement.on("mouseenter.manualColumnMove","td, th",function(){if(pressed){var active=instance.view.THEAD.querySelector(".manualColumnMover.active");if(active){instance.view.wt.wtDom.removeClass(active,"active")}endCol=instance.view.wt.wtDom.index(this)+instance.colOffset();var THs=instance.view.THEAD.querySelectorAll("th");var mover=THs[endCol].querySelector(".manualColumnMover");instance.view.wt.wtDom.addClass(mover,"active")}});instance.addHook("afterDestroy",unbindMoveColEvents)};var unbindMoveColEvents=function(){var instance=this;instance.rootElement.off("mouseup.manualColumnMove");instance.rootElement.off("mousemove.manualColumnMove");instance.rootElement.off("mousedown.manualColumnMove");instance.rootElement.off("mouseenter.manualColumnMove")};this.beforeInit=function(){this.manualColumnPositions=[]};this.init=function(source){var instance=this;var manualColMoveEnabled=!!(this.getSettings().manualColumnMove);if(manualColMoveEnabled){var initialManualColumnPositions=this.getSettings().manualColumnMove;var loadedManualColumnPositions=loadManualColumnPositions.call(instance);if(typeof loadedManualColumnPositions!="undefined"){this.manualColumnPositions=loadedManualColumnPositions}else{if(initialManualColumnPositions instanceof Array){this.manualColumnPositions=initialManualColumnPositions}else{this.manualColumnPositions=[]}}instance.forceFullRender=true;if(source=="afterInit"){bindMoveColEvents.call(this);if(this.manualColumnPositions.length>0){this.forceFullRender=true;this.render()}}}else{unbindMoveColEvents.call(this);this.manualColumnPositions=[]}};this.modifyCol=function(col){if(this.getSettings().manualColumnMove){if(typeof this.manualColumnPositions[col]==="undefined"){this.manualColumnPositions[col]=col}return this.manualColumnPositions[col]}return col};this.getColHeader=function(col,TH){if(this.getSettings().manualColumnMove){var DIV=document.createElement("DIV");DIV.className="manualColumnMover";TH.firstChild.appendChild(DIV)}}}var htManualColumnMove=new HandsontableManualColumnMove();Handsontable.PluginHooks.add("beforeInit",htManualColumnMove.beforeInit);Handsontable.PluginHooks.add("afterInit",function(){htManualColumnMove.init.call(this,"afterInit")});Handsontable.PluginHooks.add("afterUpdateSettings",function(){htManualColumnMove.init.call(this,"afterUpdateSettings")});Handsontable.PluginHooks.add("afterGetColHeader",htManualColumnMove.getColHeader);Handsontable.PluginHooks.add("modifyCol",htManualColumnMove.modifyCol);function HandsontableManualColumnResize(){var pressed,currentTH,currentCol,currentWidth,instance,newSize,startX,startWidth,startOffset,resizer=document.createElement("DIV"),handle=document.createElement("DIV"),line=document.createElement("DIV"),lineStyle=line.style;resizer.className="manualColumnResizer";handle.className="manualColumnResizerHandle";resizer.appendChild(handle);line.className="manualColumnResizerLine";resizer.appendChild(line);var $document=$(document);$document.mousemove(function(e){if(pressed){currentWidth=startWidth+(e.pageX-startX);newSize=setManualSize(currentCol,currentWidth);resizer.style.left=startOffset+currentWidth+"px"}});$document.mouseup(function(){if(pressed){instance.view.wt.wtDom.removeClass(resizer,"active");pressed=false;if(newSize!=startWidth){instance.forceFullRender=true;instance.view.render();saveManualColumnWidths.call(instance);instance.PluginHooks.run("afterColumnResize",currentCol,newSize)}refreshResizerPosition.call(instance,currentTH)}});var saveManualColumnWidths=function(){var instance=this;instance.PluginHooks.run("persistentStateSave","manualColumnWidths",instance.manualColumnWidths)};var loadManualColumnWidths=function(){var instance=this;var storedState={};instance.PluginHooks.run("persistentStateLoad","manualColumnWidths",storedState);return storedState.value};function refreshResizerPosition(TH){instance=this;currentTH=TH;var col=this.view.wt.wtTable.getCoords(TH)[1];if(col>=0){currentCol=col;var rootOffset=this.view.wt.wtDom.offset(this.rootElement[0]).left;var thOffset=this.view.wt.wtDom.offset(TH).left;startOffset=(thOffset-rootOffset)-6;resizer.style.left=startOffset+parseInt(this.view.wt.wtDom.outerWidth(TH),10)+"px";this.rootElement[0].appendChild(resizer)}}function refreshLinePosition(){var instance=this;startWidth=parseInt(this.view.wt.wtDom.outerWidth(currentTH),10);instance.view.wt.wtDom.addClass(resizer,"active");lineStyle.height=instance.view.wt.wtDom.outerHeight(instance.$table[0])+"px";pressed=instance}var bindManualColumnWidthEvents=function(){var instance=this;var dblclick=0;var autoresizeTimeout=null;this.rootElement.on("mouseenter.handsontable","th",function(e){if(!pressed){refreshResizerPosition.call(instance,e.currentTarget)}});this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(){if(autoresizeTimeout==null){autoresizeTimeout=setTimeout(function(){if(dblclick>=2){newSize=instance.determineColumnWidth.call(instance,currentCol);setManualSize(currentCol,newSize);instance.forceFullRender=true;instance.view.render();instance.PluginHooks.run("afterColumnResize",currentCol,newSize)}dblclick=0;autoresizeTimeout=null},500)}dblclick++});this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(e){startX=e.pageX;refreshLinePosition.call(instance);newSize=startWidth})};this.beforeInit=function(){this.manualColumnWidths=[]};this.init=function(source){var instance=this;var manualColumnWidthEnabled=!!(this.getSettings().manualColumnResize);if(manualColumnWidthEnabled){var initialColumnWidths=this.getSettings().manualColumnResize;var loadedManualColumnWidths=loadManualColumnWidths.call(instance);if(typeof loadedManualColumnWidths!="undefined"){this.manualColumnWidths=loadedManualColumnWidths}else{if(initialColumnWidths instanceof Array){this.manualColumnWidths=initialColumnWidths}else{this.manualColumnWidths=[]}}if(source=="afterInit"){bindManualColumnWidthEvents.call(this);instance.forceFullRender=true;instance.render()}}};var setManualSize=function(col,width){width=Math.max(width,20);col=instance.PluginHooks.execute("modifyCol",col);instance.manualColumnWidths[col]=width;return width};this.getColWidth=function(col,response){if(this.getSettings().manualColumnResize&&this.manualColumnWidths[col]){response.width=this.manualColumnWidths[col]}}}var htManualColumnResize=new HandsontableManualColumnResize();Handsontable.PluginHooks.add("beforeInit",htManualColumnResize.beforeInit);Handsontable.PluginHooks.add("afterInit",function(){htManualColumnResize.init.call(this,"afterInit")});Handsontable.PluginHooks.add("afterUpdateSettings",function(){htManualColumnResize.init.call(this,"afterUpdateSettings")});Handsontable.PluginHooks.add("afterGetColWidth",htManualColumnResize.getColWidth);(function HandsontableObserveChanges(){Handsontable.PluginHooks.add("afterLoadData",init);Handsontable.PluginHooks.add("afterUpdateSettings",init);function init(){var instance=this;var pluginEnabled=instance.getSettings().observeChanges;if(!instance.observer&&pluginEnabled){createObserver.call(instance);bindEvents.call(instance)}else{if(!pluginEnabled){destroy.call(instance)}}}function createObserver(){var instance=this;instance.observeChangesActive=true;instance.pauseObservingChanges=function(){instance.observeChangesActive=false};instance.resumeObservingChanges=function(){instance.observeChangesActive=true};instance.observer=jsonpatch.observe(instance.getData(),function(patches){if(instance.observeChangesActive){runHookForOperation.call(instance,patches);instance.render()}instance.runHooks("afterChangesObserved")})}function runHookForOperation(rawPatches){var instance=this;var patches=cleanPatches(rawPatches);for(var i=0,len=patches.length;i<len;i++){var patch=patches[i];var parsedPath=parsePath(patch.path);switch(patch.op){case"add":if(isNaN(parsedPath.col)){instance.runHooks("afterCreateRow",parsedPath.row)}else{instance.runHooks("afterCreateCol",parsedPath.col)}break;case"remove":if(isNaN(parsedPath.col)){instance.runHooks("afterRemoveRow",parsedPath.row,1)}else{instance.runHooks("afterRemoveCol",parsedPath.col,1)}break;case"replace":instance.runHooks("afterChange",[parsedPath.row,parsedPath.col,null,patch.value],"external");break}}function cleanPatches(rawPatches){var patches;patches=removeLengthRelatedPatches(rawPatches);patches=removeMultipleAddOrRemoveColPatches(patches);return patches}function removeMultipleAddOrRemoveColPatches(rawPatches){var newOrRemovedColumns=[];return rawPatches.filter(function(patch){var parsedPath=parsePath(patch.path);if(["add","remove"].indexOf(patch.op)!=-1&&!isNaN(parsedPath.col)){if(newOrRemovedColumns.indexOf(parsedPath.col)!=-1){return false}else{newOrRemovedColumns.push(parsedPath.col)}}return true})}function removeLengthRelatedPatches(rawPatches){return rawPatches.filter(function(patch){return !/[/]length/ig.test(patch.path)})}function parsePath(path){var match=path.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(match[1],10),col:/^\d*$/.test(match[2])?parseInt(match[2],10):match[2]}}}function destroy(){var instance=this;if(instance.observer){destroyObserver.call(instance);unbindEvents.call(instance)}}function destroyObserver(){var instance=this;jsonpatch.unobserve(instance.getData(),instance.observer);delete instance.observeChangesActive;delete instance.pauseObservingChanges;delete instance.resumeObservingChanges}function bindEvents(){var instance=this;instance.addHook("afterDestroy",destroy);instance.addHook("afterCreateRow",afterTableAlter);instance.addHook("afterRemoveRow",afterTableAlter);instance.addHook("afterCreateCol",afterTableAlter);instance.addHook("afterRemoveCol",afterTableAlter);instance.addHook("afterChange",function(changes,source){if(source!="loadData"){afterTableAlter.call(this)}})}function unbindEvents(){var instance=this;instance.removeHook("afterDestroy",destroy);instance.removeHook("afterCreateRow",afterTableAlter);instance.removeHook("afterRemoveRow",afterTableAlter);instance.removeHook("afterCreateCol",afterTableAlter);instance.removeHook("afterRemoveCol",afterTableAlter);instance.removeHook("afterChange",afterTableAlter)}function afterTableAlter(){var instance=this;instance.pauseObservingChanges();instance.addHookOnce("afterChangesObserved",function(){instance.resumeObservingChanges()})}})();function Storage(prefix){var savedKeys;var saveSavedKeys=function(){window.localStorage[prefix+"__persistentStateKeys"]=JSON.stringify(savedKeys)};var loadSavedKeys=function(){var keysJSON=window.localStorage[prefix+"__persistentStateKeys"];var keys=typeof keysJSON=="string"?JSON.parse(keysJSON):void 0;savedKeys=keys?keys:[]};var clearSavedKeys=function(){savedKeys=[];saveSavedKeys()};loadSavedKeys();this.saveValue=function(key,value){window.localStorage[prefix+"_"+key]=JSON.stringify(value);if(savedKeys.indexOf(key)==-1){savedKeys.push(key);saveSavedKeys()}};this.loadValue=function(key,defaultValue){key=typeof key!="undefined"?key:defaultValue;var value=window.localStorage[prefix+"_"+key];return typeof value=="undefined"?void 0:JSON.parse(value)};this.reset=function(key){window.localStorage.removeItem(prefix+"_"+key)};this.resetAll=function(){for(var index=0;index<savedKeys.length;index++){window.localStorage.removeItem(prefix+"_"+savedKeys[index])}clearSavedKeys()}}(function(StorageClass){function HandsontablePersistentState(){var plugin=this;this.init=function(){var instance=this,pluginSettings=instance.getSettings()["persistentState"];plugin.enabled=!!(pluginSettings);if(!plugin.enabled){removeHooks.call(instance);return}if(!instance.storage){instance.storage=new StorageClass(instance.rootElement[0].id)}instance.resetState=plugin.resetValue;addHooks.call(instance)};this.saveValue=function(key,value){var instance=this;instance.storage.saveValue(key,value)};this.loadValue=function(key,saveTo){var instance=this;saveTo.value=instance.storage.loadValue(key)};this.resetValue=function(key){var instance=this;if(typeof key!="undefined"){instance.storage.reset(key)}else{instance.storage.resetAll()}};var hooks={persistentStateSave:plugin.saveValue,persistentStateLoad:plugin.loadValue,persistentStateReset:plugin.resetValue};function addHooks(){var instance=this;for(var hookName in hooks){if(hooks.hasOwnProperty(hookName)&&!hookExists.call(instance,hookName)){instance.PluginHooks.add(hookName,hooks[hookName])}}}function removeHooks(){var instance=this;for(var hookName in hooks){if(hooks.hasOwnProperty(hookName)&&hookExists.call(instance,hookName)){instance.PluginHooks.remove(hookName,hooks[hookName])}}}function hookExists(hookName){var instance=this;return instance.PluginHooks.hooks.hasOwnProperty(hookName)}}var htPersistentState=new HandsontablePersistentState();Handsontable.PluginHooks.add("beforeInit",htPersistentState.init);Handsontable.PluginHooks.add("afterUpdateSettings",htPersistentState.init)})(Storage);(function(Handsontable){Handsontable.UndoRedo=function(instance){var plugin=this;this.instance=instance;this.doneActions=[];this.undoneActions=[];this.ignoreNewActions=false;instance.addHook("afterChange",function(changes,origin){if(changes){var action=new Handsontable.UndoRedo.ChangeAction(changes);plugin.done(action)}});instance.addHook("afterCreateRow",function(index,amount){var action=new Handsontable.UndoRedo.CreateRowAction(index,amount);plugin.done(action)});instance.addHook("beforeRemoveRow",function(index,amount){var originalData=plugin.instance.getData();index=(originalData.length+index)%originalData.length;var removedData=originalData.slice(index,index+amount);var action=new Handsontable.UndoRedo.RemoveRowAction(index,removedData);plugin.done(action)});instance.addHook("afterCreateCol",function(index,amount){var action=new Handsontable.UndoRedo.CreateColumnAction(index,amount);plugin.done(action)});instance.addHook("beforeRemoveCol",function(index,amount){var originalData=plugin.instance.getData();index=(plugin.instance.countCols()+index)%plugin.instance.countCols();var removedData=[];for(var i=0,len=originalData.length;i<len;i++){removedData[i]=originalData[i].slice(index,index+amount)}var headers;if(Handsontable.helper.isArray(instance.getSettings().colHeaders)){headers=instance.getSettings().colHeaders.slice(index,index+removedData.length)}var action=new Handsontable.UndoRedo.RemoveColumnAction(index,removedData,headers);plugin.done(action)})};Handsontable.UndoRedo.prototype.done=function(action){if(!this.ignoreNewActions){this.doneActions.push(action);this.undoneActions.length=0}};Handsontable.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var action=this.doneActions.pop();this.ignoreNewActions=true;action.undo(this.instance);this.ignoreNewActions=false;this.undoneActions.push(action)}};Handsontable.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var action=this.undoneActions.pop();this.ignoreNewActions=true;action.redo(this.instance);this.ignoreNewActions=true;this.doneActions.push(action)}};Handsontable.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Handsontable.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Handsontable.UndoRedo.prototype.clear=function(){this.doneActions.length=0;this.undoneActions.length=0};Handsontable.UndoRedo.Action=function(){};Handsontable.UndoRedo.Action.prototype.undo=function(){};Handsontable.UndoRedo.Action.prototype.redo=function(){};Handsontable.UndoRedo.ChangeAction=function(changes){this.changes=changes};Handsontable.helper.inherit(Handsontable.UndoRedo.ChangeAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.ChangeAction.prototype.undo=function(instance){var data=$.extend(true,[],this.changes);for(var i=0,len=data.length;i<len;i++){data[i].splice(3,1)}instance.setDataAtRowProp(data,null,null,"undo")};Handsontable.UndoRedo.ChangeAction.prototype.redo=function(instance){var data=$.extend(true,[],this.changes);for(var i=0,len=data.length;i<len;i++){data[i].splice(2,1)}instance.setDataAtRowProp(data,null,null,"redo")};Handsontable.UndoRedo.CreateRowAction=function(index,amount){this.index=index;this.amount=amount};Handsontable.helper.inherit(Handsontable.UndoRedo.CreateRowAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateRowAction.prototype.undo=function(instance){instance.alter("remove_row",this.index,this.amount)};Handsontable.UndoRedo.CreateRowAction.prototype.redo=function(instance){instance.alter("insert_row",this.index+1,this.amount)};Handsontable.UndoRedo.RemoveRowAction=function(index,data){this.index=index;this.data=data};Handsontable.helper.inherit(Handsontable.UndoRedo.RemoveRowAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveRowAction.prototype.undo=function(instance){var spliceArgs=[this.index,0];Array.prototype.push.apply(spliceArgs,this.data);Array.prototype.splice.apply(instance.getData(),spliceArgs);instance.render()};Handsontable.UndoRedo.RemoveRowAction.prototype.redo=function(instance){instance.alter("remove_row",this.index,this.data.length)};Handsontable.UndoRedo.CreateColumnAction=function(index,amount){this.index=index;this.amount=amount};Handsontable.helper.inherit(Handsontable.UndoRedo.CreateColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.CreateColumnAction.prototype.undo=function(instance){instance.alter("remove_col",this.index,this.amount)};Handsontable.UndoRedo.CreateColumnAction.prototype.redo=function(instance){instance.alter("insert_col",this.index+1,this.amount)};Handsontable.UndoRedo.RemoveColumnAction=function(index,data,headers){this.index=index;this.data=data;this.amount=this.data[0].length;this.headers=headers};Handsontable.helper.inherit(Handsontable.UndoRedo.RemoveColumnAction,Handsontable.UndoRedo.Action);Handsontable.UndoRedo.RemoveColumnAction.prototype.undo=function(instance){var row,spliceArgs;for(var i=0,len=instance.getData().length;i<len;i++){row=instance.getDataAtRow(i);spliceArgs=[this.index,0];Array.prototype.push.apply(spliceArgs,this.data[i]);Array.prototype.splice.apply(row,spliceArgs)}if(typeof this.headers!="undefined"){spliceArgs=[this.index,0];Array.prototype.push.apply(spliceArgs,this.headers);Array.prototype.splice.apply(instance.getSettings().colHeaders,spliceArgs)}instance.render()};Handsontable.UndoRedo.RemoveColumnAction.prototype.redo=function(instance){instance.alter("remove_col",this.index,this.amount)}})(Handsontable);(function(Handsontable){function init(){var instance=this;var pluginEnabled=typeof instance.getSettings().undo=="undefined"||instance.getSettings().undo;if(pluginEnabled){if(!instance.undoRedo){instance.undoRedo=new Handsontable.UndoRedo(instance);exposeUndoRedoMethods(instance);instance.addHook("beforeKeyDown",onBeforeKeyDown);instance.addHook("afterChange",onAfterChange)}}else{if(instance.undoRedo){delete instance.undoRedo;removeExposedUndoRedoMethods(instance);instance.removeHook("beforeKeyDown",onBeforeKeyDown);instance.removeHook("afterChange",onAfterChange)}}}function onBeforeKeyDown(event){var instance=this;var ctrlDown=(event.ctrlKey||event.metaKey)&&!event.altKey;if(ctrlDown){if(event.keyCode===89||(event.shiftKey&&event.keyCode===90)){instance.undoRedo.redo();event.stopImmediatePropagation()}else{if(event.keyCode===90){instance.undoRedo.undo();event.stopImmediatePropagation()}}}}function onAfterChange(changes,source){var instance=this;if(source=="loadData"){return instance.undoRedo.clear()}}function exposeUndoRedoMethods(instance){instance.undo=function(){return instance.undoRedo.undo()};instance.redo=function(){return instance.undoRedo.redo()};instance.isUndoAvailable=function(){return instance.undoRedo.isUndoAvailable()};instance.isRedoAvailable=function(){return instance.undoRedo.isRedoAvailable()};instance.clearUndo=function(){return instance.undoRedo.clear()}}function removeExposedUndoRedoMethods(instance){delete instance.undo;delete instance.redo;delete instance.isUndoAvailable;delete instance.isRedoAvailable;delete instance.clearUndo}Handsontable.PluginHooks.add("afterInit",init);Handsontable.PluginHooks.add("afterUpdateSettings",init)})(Handsontable);function DragToScroll(){this.boundaries=null;this.callback=null}DragToScroll.prototype.setBoundaries=function(boundaries){this.boundaries=boundaries};DragToScroll.prototype.setCallback=function(callback){this.callback=callback};DragToScroll.prototype.check=function(x,y){var diffX=0;var diffY=0;if(y<this.boundaries.top){diffY=y-this.boundaries.top}else{if(y>this.boundaries.bottom){diffY=y-this.boundaries.bottom}}if(x<this.boundaries.left){diffX=x-this.boundaries.left}else{if(x>this.boundaries.right){diffX=x-this.boundaries.right}}this.callback(diffX,diffY)};var listening=false;var dragToScroll;var instance;if(typeof Handsontable!=="undefined"){var setupListening=function(instance){var scrollHandler=instance.view.wt.wtScrollbars.vertical.scrollHandler;dragToScroll=new DragToScroll();if(scrollHandler===window){return}else{if(scrollHandler){dragToScroll.setBoundaries(scrollHandler.getBoundingClientRect())}else{dragToScroll.setBoundaries(instance.$table[0].getBoundingClientRect())}}dragToScroll.setCallback(function(scrollX,scrollY){if(scrollX<0){if(scrollHandler){scrollHandler.scrollLeft-=50}else{instance.view.wt.scrollHorizontal(-1).draw()}}else{if(scrollX>0){if(scrollHandler){scrollHandler.scrollLeft+=50}else{instance.view.wt.scrollHorizontal(1).draw()}}}if(scrollY<0){if(scrollHandler){scrollHandler.scrollTop-=20}else{instance.view.wt.scrollVertical(-1).draw()}}else{if(scrollY>0){if(scrollHandler){scrollHandler.scrollTop+=20}else{instance.view.wt.scrollVertical(1).draw()}}}})};Handsontable.PluginHooks.add("afterInit",function(){$(document).on("mouseup."+this.guid,function(){listening=false});$(document).on("mousemove."+this.guid,function(event){if(listening){dragToScroll.check(event.clientX,event.clientY)}})});Handsontable.PluginHooks.add("destroy",function(){$(document).off("."+this.guid)});Handsontable.PluginHooks.add("afterOnCellMouseDown",function(){listening=true;setupListening(this)});Handsontable.PluginHooks.add("afterOnCellCornerMouseDown",function(){listening=true;setupListening(this)})}(function($){autoResize.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};autoResize.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"];autoResize.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",overflowX:"hidden",overflowY:"hidden",border:"1px solid black",padding:"0.49em"};autoResize.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]";autoResize.AutoResizer=AutoResizer;$.fn.autoResize=autoResize;function autoResize(config){this.filter(autoResize.resizableFilterSelector).each(function(){new AutoResizer($(this),config)});return this}function AutoResizer(el,config){if(this.clones){return}this.config=$.extend({},autoResize.defaults,config);this.el=el;this.nodeName=el[0].nodeName.toLowerCase();this.previousScrollTop=null;if(config.maxWidth==="original"){config.maxWidth=el.width()}if(config.minWidth==="original"){config.minWidth=el.width()}if(config.maxHeight==="original"){config.maxHeight=el.height()}if(config.minHeight==="original"){config.minHeight=el.height()}if(this.nodeName==="textarea"){el.css({resize:"none",overflowY:"none"})}el.data("AutoResizer",this);this.createClone();this.injectClone();this.bind()}AutoResizer.prototype={bind:function(){var check=$.proxy(function(){this.check();return true},this);this.unbind();this.el.bind("keyup.autoResize",check).bind("change.autoResize",check);this.check(null,true)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var el=this.el,self=this,config=this.config;this.clones=$();if(config.minHeight!=="original"||config.maxHeight!=="original"){this.hClone=el.clone().height("auto");this.clones=this.clones.add(this.hClone)}if(config.minWidth!=="original"||config.maxWidth!=="original"){this.wClone=$("<div/>").width("auto").css({whiteSpace:"nowrap","float":"left"});this.clones=this.clones.add(this.wClone)}$.each(autoResize.cloneCSSProperties,function(i,p){self.clones.css(p,el.css(p))});this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(autoResize.cloneCSSValues).css("overflowY","scroll")},check:function(e,immediate){var config=this.config,wClone=this.wClone,hClone=this.hClone,el=this.el,value=el.val();if(wClone){wClone.text(value);var cloneWidth=wClone.outerWidth(),newWidth=(cloneWidth+config.extraSpace)>=config.minWidth?cloneWidth+config.extraSpace:config.minWidth,currentWidth=el.width();newWidth=Math.min(newWidth,config.maxWidth);if((newWidth<currentWidth&&newWidth>=config.minWidth)||(newWidth>=config.minWidth&&newWidth<=config.maxWidth)){config.onResize.call(el);el.scrollLeft(0);config.animate&&!immediate?el.stop(1,1).animate({width:newWidth},config.animate):el.width(newWidth)}}if(hClone){if(newWidth){hClone.width(newWidth)}hClone.height(0).val(value).scrollTop(10000);var scrollTop=hClone[0].scrollTop+config.extraSpace;if(this.previousScrollTop===scrollTop){return}this.previousScrollTop=scrollTop;if(scrollTop>=config.maxHeight){scrollTop=config.maxHeight}if(scrollTop<config.minHeight){scrollTop=config.minHeight}if(scrollTop==config.maxHeight&&newWidth==config.maxWidth){el.css("overflowY","scroll")}else{el.css("overflowY","hidden")}config.onResize.call(el);config.animate&&!immediate?el.stop(1,1).animate({height:scrollTop},config.animate):el.height(scrollTop)}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clones.remove();delete this.el;delete this.hClone;delete this.wClone;delete this.clones},injectClone:function(){(autoResize.cloneContainer||(autoResize.cloneContainer=$("<arclones/>").appendTo("body"))).empty().append(this.clones)}}})(jQuery);(function(global){function countQuotes(str){return str.split('"').length-1}global.SheetClip={parse:function(str){var r,rlen,rows,arr=[],a=0,c,clen,multiline,last;rows=str.split("\n");if(rows.length>1&&rows[rows.length-1]===""){rows.pop()}for(r=0,rlen=rows.length;r<rlen;r+=1){rows[r]=rows[r].split("\t");for(c=0,clen=rows[r].length;c<clen;c+=1){if(!arr[a]){arr[a]=[]}if(multiline&&c===0){last=arr[a].length-1;arr[a][last]=arr[a][last]+"\n"+rows[r][0];if(multiline&&(countQuotes(rows[r][0])&1)){multiline=false;arr[a][last]=arr[a][last].substring(0,arr[a][last].length-1).replace(/""/g,'"')}}else{if(c===clen-1&&rows[r][c].indexOf('"')===0){arr[a].push(rows[r][c].substring(1).replace(/""/g,'"'));multiline=true}else{arr[a].push(rows[r][c].replace(/""/g,'"'));multiline=false}}}if(!multiline){a+=1}}return arr},stringify:function(arr){var r,rlen,c,clen,str="",val;for(r=0,rlen=arr.length;r<rlen;r+=1){for(c=0,clen=arr[r].length;c<clen;c+=1){if(c>0){str+="\t"}val=arr[r][c];if(typeof val==="string"){if(val.indexOf("\n")>-1){str+='"'+val.replace(/"/g,'""')+'"'}else{str+=val}}else{if(val===null||val===void 0){str+=""}else{str+=val}}}str+="\n"}return str}}}(window));var CopyPaste=(function(){var instance;return{getInstance:function(){if(!instance){instance=new CopyPasteClass()}return instance}}})();function CopyPasteClass(){var that=this,style,parent;this.copyCallbacks=[];this.cutCallbacks=[];this.pasteCallbacks=[];var listenerElement=document.documentElement;parent=document.body;if(document.getElementById("CopyPasteDiv")){this.elDiv=document.getElementById("CopyPasteDiv");this.elTextarea=this.elDiv.firstChild}else{this.elDiv=document.createElement("DIV");this.elDiv.id="CopyPasteDiv";style=this.elDiv.style;style.position="fixed";style.top=0;style.left=0;parent.appendChild(this.elDiv);this.elTextarea=document.createElement("TEXTAREA");this.elTextarea.className="copyPaste";style=this.elTextarea.style;style.width="1px";style.height="1px";this.elDiv.appendChild(this.elTextarea);if(typeof style.opacity!=="undefined"){style.opacity=0}else{
/*@cc_on @if (@_jscript)
       if(typeof style.filter === 'string') {
       style.filter = 'alpha(opacity=0)';
       }
       @end @*/
}}this._bindEvent(listenerElement,"keydown",function(event){var isCtrlDown=false;if(event.metaKey){isCtrlDown=true}else{if(event.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1){isCtrlDown=true}}if(isCtrlDown){if(document.activeElement!==that.elTextarea&&(that.getSelectionText()!=""||["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)!=-1)){return}that.selectNodeText(that.elTextarea);setTimeout(function(){that.selectNodeText(that.elTextarea)},0)}if(isCtrlDown&&(event.keyCode===67||event.keyCode===86||event.keyCode===88)){if(event.keyCode===88){setTimeout(function(){that.triggerCut(event)},0)}else{if(event.keyCode===86){setTimeout(function(){that.triggerPaste(event)},0)}}}})}CopyPasteClass.prototype.selectNodeText=function(el){el.select()};CopyPasteClass.prototype.getSelectionText=function(){var text="";if(window.getSelection){text=window.getSelection().toString()}else{if(document.selection&&document.selection.type!="Control"){text=document.selection.createRange().text}}return text};CopyPasteClass.prototype.copyable=function(str){if(typeof str!=="string"&&str.toString===void 0){throw new Error("copyable requires string parameter")}this.elTextarea.value=str};CopyPasteClass.prototype.onCut=function(fn){this.cutCallbacks.push(fn)};CopyPasteClass.prototype.onPaste=function(fn){this.pasteCallbacks.push(fn)};CopyPasteClass.prototype.removeCallback=function(fn){var i,ilen;for(i=0,ilen=this.copyCallbacks.length;i<ilen;i++){if(this.copyCallbacks[i]===fn){this.copyCallbacks.splice(i,1);return true}}for(i=0,ilen=this.cutCallbacks.length;i<ilen;i++){if(this.cutCallbacks[i]===fn){this.cutCallbacks.splice(i,1);return true}}for(i=0,ilen=this.pasteCallbacks.length;i<ilen;i++){if(this.pasteCallbacks[i]===fn){this.pasteCallbacks.splice(i,1);return true}}return false};CopyPasteClass.prototype.triggerCut=function(event){var that=this;if(that.cutCallbacks){setTimeout(function(){for(var i=0,ilen=that.cutCallbacks.length;i<ilen;i++){that.cutCallbacks[i](event)}},50)}};CopyPasteClass.prototype.triggerPaste=function(event,str){var that=this;if(that.pasteCallbacks){setTimeout(function(){var val=(str||that.elTextarea.value).replace(/\n$/,"");for(var i=0,ilen=that.pasteCallbacks.length;i<ilen;i++){that.pasteCallbacks[i](val,event)}},50)}};CopyPasteClass.prototype._bindEvent=(function(){if(window.jQuery){return function(elem,type,cb){$(elem).on(type+".copypaste",cb)}}else{return function(elem,type,cb){elem.addEventListener(type,cb,false)}}})();var jsonpatch;(function(jsonpatch){var objOps={add:function(obj,key){obj[key]=this.value;return true},remove:function(obj,key){delete obj[key];return true},replace:function(obj,key){obj[key]=this.value;return true},move:function(obj,key,tree){var temp={op:"_get",path:this.from};apply(tree,[temp]);apply(tree,[{op:"remove",path:this.from}]);apply(tree,[{op:"add",path:this.path,value:temp.value}]);return true},copy:function(obj,key,tree){var temp={op:"_get",path:this.from};apply(tree,[temp]);apply(tree,[{op:"add",path:this.path,value:temp.value}]);return true},test:function(obj,key){return(JSON.stringify(obj[key])===JSON.stringify(this.value))},_get:function(obj,key){this.value=obj[key]}};var arrOps={add:function(arr,i){arr.splice(i,0,this.value);return true},remove:function(arr,i){arr.splice(i,1);return true},replace:function(arr,i){arr[i]=this.value;return true},move:objOps.move,copy:objOps.copy,test:objOps.test,_get:objOps._get};var observeOps={"new":function(patches,path){var patch={op:"add",path:path+escapePathComponent(this.name),value:this.object[this.name]};patches.push(patch)},deleted:function(patches,path){var patch={op:"remove",path:path+escapePathComponent(this.name)};patches.push(patch)},updated:function(patches,path){var patch={op:"replace",path:path+escapePathComponent(this.name),value:this.object[this.name]};patches.push(patch)}};function escapePathComponent(str){if(str.indexOf("/")===-1&&str.indexOf("~")===-1){return str}return str.replace(/~/g,"~0").replace(/\//g,"~1")}function _getPathRecursive(root,obj){var found;for(var key in root){if(root.hasOwnProperty(key)){if(root[key]===obj){return escapePathComponent(key)+"/"}else{if(typeof root[key]==="object"){found=_getPathRecursive(root[key],obj);if(found!=""){return escapePathComponent(key)+"/"+found}}}}}return""}function getPath(root,obj){if(root===obj){return"/"}var path=_getPathRecursive(root,obj);if(path===""){throw new Error("Object not found in root")}return"/"+path}var beforeDict=[];jsonpatch.intervals;var Mirror=(function(){function Mirror(obj){this.observers=[];this.obj=obj}return Mirror})();var ObserverInfo=(function(){function ObserverInfo(callback,observer){this.callback=callback;this.observer=observer}return ObserverInfo})();function getMirror(obj){for(var i=0,ilen=beforeDict.length;i<ilen;i++){if(beforeDict[i].obj===obj){return beforeDict[i]}}}function getObserverFromMirror(mirror,callback){for(var j=0,jlen=mirror.observers.length;j<jlen;j++){if(mirror.observers[j].callback===callback){return mirror.observers[j].observer}}}function removeObserverFromMirror(mirror,observer){for(var j=0,jlen=mirror.observers.length;j<jlen;j++){if(mirror.observers[j].observer===observer){mirror.observers.splice(j,1);return}}}function unobserve(root,observer){generate(observer);if(Object.observe){_unobserve(observer,root)}else{clearTimeout(observer.next)}var mirror=getMirror(root);removeObserverFromMirror(mirror,observer)}jsonpatch.unobserve=unobserve;function observe(obj,callback){var patches=[];var root=obj;var observer;var mirror=getMirror(obj);if(!mirror){mirror=new Mirror(obj);beforeDict.push(mirror)}else{observer=getObserverFromMirror(mirror,callback)}if(observer){return observer}if(Object.observe){observer=function(arr){_unobserve(observer,obj);_observe(observer,obj);var a=0,alen=arr.length;while(a<alen){if(!(arr[a].name==="length"&&_isArray(arr[a].object))&&!(arr[a].name==="__Jasmine_been_here_before__")){observeOps[arr[a].type].call(arr[a],patches,getPath(root,arr[a].object))}a++}if(patches){if(callback){callback(patches)}}observer.patches=patches;patches=[]}}else{observer={};mirror.value=JSON.parse(JSON.stringify(obj));if(callback){observer.callback=callback;observer.next=null;var intervals=this.intervals||[100,1000,10000,60000];var currentInterval=0;var dirtyCheck=function(){generate(observer)};var fastCheck=function(){clearTimeout(observer.next);observer.next=setTimeout(function(){dirtyCheck();currentInterval=0;observer.next=setTimeout(slowCheck,intervals[currentInterval++])},0)};var slowCheck=function(){dirtyCheck();if(currentInterval==intervals.length){currentInterval=intervals.length-1}observer.next=setTimeout(slowCheck,intervals[currentInterval++])};if(typeof window!=="undefined"){if(window.addEventListener){window.addEventListener("mousedown",fastCheck);window.addEventListener("mouseup",fastCheck);window.addEventListener("keydown",fastCheck)}else{window.attachEvent("onmousedown",fastCheck);window.attachEvent("onmouseup",fastCheck);window.attachEvent("onkeydown",fastCheck)}}observer.next=setTimeout(slowCheck,intervals[currentInterval++])}}observer.patches=patches;observer.object=obj;mirror.observers.push(new ObserverInfo(callback,observer));return _observe(observer,obj)}jsonpatch.observe=observe;function _observe(observer,obj){if(Object.observe){Object.observe(obj,observer);for(var key in obj){if(obj.hasOwnProperty(key)){var v=obj[key];if(v&&typeof(v)==="object"){_observe(observer,v)}}}}return observer}function _unobserve(observer,obj){if(Object.observe){Object.unobserve(obj,observer);for(var key in obj){if(obj.hasOwnProperty(key)){var v=obj[key];if(v&&typeof(v)==="object"){_unobserve(observer,v)}}}}return observer}function generate(observer){if(Object.observe){Object.deliverChangeRecords(observer)}else{var mirror;for(var i=0,ilen=beforeDict.length;i<ilen;i++){if(beforeDict[i].obj===observer.object){mirror=beforeDict[i];break}}_generate(mirror.value,observer.object,observer.patches,"")}var temp=observer.patches;if(temp.length>0){observer.patches=[];if(observer.callback){observer.callback(temp)}}return temp}jsonpatch.generate=generate;var _objectKeys;if(Object.keys){_objectKeys=Object.keys}else{_objectKeys=function(obj){var keys=[];for(var o in obj){if(obj.hasOwnProperty(o)){keys.push(o)}}return keys}}function _generate(mirror,obj,patches,path){var newKeys=_objectKeys(obj);var oldKeys=_objectKeys(mirror);var changed=false;var deleted=false;for(var t=oldKeys.length-1;t>=0;t--){var key=oldKeys[t];var oldVal=mirror[key];if(obj.hasOwnProperty(key)){var newVal=obj[key];if(oldVal instanceof Object){_generate(oldVal,newVal,patches,path+"/"+escapePathComponent(key))}else{if(oldVal!=newVal){changed=true;patches.push({op:"replace",path:path+"/"+escapePathComponent(key),value:newVal});mirror[key]=newVal}}}else{patches.push({op:"remove",path:path+"/"+escapePathComponent(key)});delete mirror[key];deleted=true}}if(!deleted&&newKeys.length==oldKeys.length){return}for(var t=0;t<newKeys.length;t++){var key=newKeys[t];if(!mirror.hasOwnProperty(key)){patches.push({op:"add",path:path+"/"+escapePathComponent(key),value:obj[key]});mirror[key]=JSON.parse(JSON.stringify(obj[key]))}}}var _isArray;if(Array.isArray){_isArray=Array.isArray}else{_isArray=function(obj){return obj.push&&typeof obj.length==="number"}}function apply(tree,patches){var result=false,p=0,plen=patches.length,patch;while(p<plen){patch=patches[p];var keys=patch.path.split("/");var obj=tree;var t=1;var len=keys.length;while(true){if(_isArray(obj)){var index=parseInt(keys[t],10);t++;if(t>=len){result=arrOps[patch.op].call(patch,obj,index,tree);break}obj=obj[index]}else{var key=keys[t];if(key.indexOf("~")!=-1){key=key.replace(/~1/g,"/").replace(/~0/g,"~")}t++;if(t>=len){result=objOps[patch.op].call(patch,obj,key,tree);break}obj=obj[key]}}p++}return result}jsonpatch.apply=apply})(jsonpatch||(jsonpatch={}));if(typeof exports!=="undefined"){exports.apply=jsonpatch.apply;exports.observe=jsonpatch.observe;exports.unobserve=jsonpatch.unobserve;exports.generate=jsonpatch.generate}function WalkontableBorder(instance,settings){var style;this.instance=instance;this.settings=settings;this.wtDom=this.instance.wtDom;this.main=document.createElement("div");style=this.main.style;style.position="absolute";style.top=0;style.left=0;for(var i=0;i<5;i++){var DIV=document.createElement("DIV");DIV.className="wtBorder "+(settings.className||"");style=DIV.style;style.backgroundColor=settings.border.color;style.height=settings.border.width+"px";style.width=settings.border.width+"px";this.main.appendChild(DIV)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.topStyle=this.top.style;this.leftStyle=this.left.style;this.bottomStyle=this.bottom.style;this.rightStyle=this.right.style;this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.cornerStyle=this.corner.style;this.cornerStyle.width="5px";this.cornerStyle.height="5px";this.cornerStyle.border="2px solid #FFF";this.disappear();if(!instance.wtTable.bordersHolder){instance.wtTable.bordersHolder=document.createElement("div");instance.wtTable.bordersHolder.className="htBorders";instance.wtTable.hider.appendChild(instance.wtTable.bordersHolder)}instance.wtTable.bordersHolder.appendChild(this.main);var down=false;var $body=$(document.body);$body.on("mousedown.walkontable."+instance.guid,function(){down=true});$body.on("mouseup.walkontable."+instance.guid,function(){down=false});$(this.main.childNodes).on("mouseenter",function(event){if(!down||!instance.getSetting("hideBorderOnMouseDownOver")){return}event.preventDefault();event.stopImmediatePropagation();var bounds=this.getBoundingClientRect();var $this=$(this);$this.hide();var isOutside=function(event){if(event.clientY<Math.floor(bounds.top)){return true}if(event.clientY>Math.ceil(bounds.top+bounds.height)){return true}if(event.clientX<Math.floor(bounds.left)){return true}if(event.clientX>Math.ceil(bounds.left+bounds.width)){return true}};$body.on("mousemove.border."+instance.guid,function(event){if(isOutside(event)){$body.off("mousemove.border."+instance.guid);$this.show()}})})}WalkontableBorder.prototype.appear=function(corners){var isMultiple,fromTD,toTD,fromOffset,toOffset,containerOffset,top,minTop,left,minLeft,height,width;if(this.disabled){return}var instance=this.instance,fromRow,fromColumn,toRow,toColumn,hideTop=false,hideLeft=false,hideBottom=false,hideRight=false,i,ilen,s;if(!instance.wtTable.isRowInViewport(corners[0])){hideTop=true}if(!instance.wtTable.isRowInViewport(corners[2])){hideBottom=true}ilen=instance.wtTable.rowStrategy.countVisible();for(i=0;i<ilen;i++){s=instance.wtTable.rowFilter.visibleToSource(i);if(s>=corners[0]&&s<=corners[2]){fromRow=s;break}}for(i=ilen-1;i>=0;i--){s=instance.wtTable.rowFilter.visibleToSource(i);if(s>=corners[0]&&s<=corners[2]){toRow=s;break}}if(hideTop&&hideBottom){hideLeft=true;hideRight=true}else{if(!instance.wtTable.isColumnInViewport(corners[1])){hideLeft=true}if(!instance.wtTable.isColumnInViewport(corners[3])){hideRight=true}ilen=instance.wtTable.columnStrategy.countVisible();for(i=0;i<ilen;i++){s=instance.wtTable.columnFilter.visibleToSource(i);if(s>=corners[1]&&s<=corners[3]){fromColumn=s;break}}for(i=ilen-1;i>=0;i--){s=instance.wtTable.columnFilter.visibleToSource(i);if(s>=corners[1]&&s<=corners[3]){toColumn=s;break}}}if(fromRow!==void 0&&fromColumn!==void 0){isMultiple=(fromRow!==toRow||fromColumn!==toColumn);fromTD=instance.wtTable.getCell([fromRow,fromColumn]);toTD=isMultiple?instance.wtTable.getCell([toRow,toColumn]):fromTD;fromOffset=this.wtDom.offset(fromTD);toOffset=isMultiple?this.wtDom.offset(toTD):fromOffset;containerOffset=this.wtDom.offset(instance.wtTable.TABLE);minTop=fromOffset.top;height=toOffset.top+this.wtDom.outerHeight(toTD)-minTop;minLeft=fromOffset.left;width=toOffset.left+this.wtDom.outerWidth(toTD)-minLeft;top=minTop-containerOffset.top-1;left=minLeft-containerOffset.left-1;var style=this.wtDom.getComputedStyle(fromTD);if(parseInt(style.borderTopWidth,10)>0){top+=1;height=height>0?height-1:0}if(parseInt(style.borderLeftWidth,10)>0){left+=1;width=width>0?width-1:0}}else{this.disappear();return}if(hideTop){this.topStyle.display="none"}else{this.topStyle.top=top+"px";this.topStyle.left=left+"px";this.topStyle.width=width+"px";this.topStyle.display="block"}if(hideLeft){this.leftStyle.display="none"}else{this.leftStyle.top=top+"px";this.leftStyle.left=left+"px";this.leftStyle.height=height+"px";this.leftStyle.display="block"}var delta=Math.floor(this.settings.border.width/2);if(hideBottom){this.bottomStyle.display="none"}else{this.bottomStyle.top=top+height-delta+"px";this.bottomStyle.left=left+"px";this.bottomStyle.width=width+"px";this.bottomStyle.display="block"}if(hideRight){this.rightStyle.display="none"}else{this.rightStyle.top=top+"px";this.rightStyle.left=left+width-delta+"px";this.rightStyle.height=height+1+"px";this.rightStyle.display="block"}if(hideBottom||hideRight||!this.hasSetting(this.settings.border.cornerVisible)){this.cornerStyle.display="none"}else{this.cornerStyle.top=top+height-4+"px";this.cornerStyle.left=left+width-4+"px";this.cornerStyle.display="block"}};WalkontableBorder.prototype.disappear=function(){this.topStyle.display="none";this.leftStyle.display="none";this.bottomStyle.display="none";this.rightStyle.display="none";this.cornerStyle.display="none"};WalkontableBorder.prototype.hasSetting=function(setting){if(typeof setting==="function"){return setting()}return !!setting};function WalkontableCellFilter(){this.offset=0;this.total=0;this.fixedCount=0}WalkontableCellFilter.prototype.source=function(n){return n};WalkontableCellFilter.prototype.offsetted=function(n){return n+this.offset};WalkontableCellFilter.prototype.unOffsetted=function(n){return n-this.offset};WalkontableCellFilter.prototype.fixed=function(n){if(n<this.fixedCount){return n-this.offset}else{return n}};WalkontableCellFilter.prototype.unFixed=function(n){if(n<this.fixedCount){return n+this.offset}else{return n}};WalkontableCellFilter.prototype.visibleToSource=function(n){return this.source(this.offsetted(this.fixed(n)))};WalkontableCellFilter.prototype.sourceToVisible=function(n){return this.source(this.unOffsetted(this.unFixed(n)))};function WalkontableCellStrategy(){}WalkontableCellStrategy.prototype.getSize=function(index){return this.cellSizes[index]};WalkontableCellStrategy.prototype.getContainerSize=function(proposedSize){return typeof this.containerSizeFn==="function"?this.containerSizeFn(proposedSize):this.containerSizeFn};WalkontableCellStrategy.prototype.countVisible=function(){return this.cellCount};WalkontableCellStrategy.prototype.isLastIncomplete=function(){return this.remainingSize>=0};function WalkontableClassNameCache(){this.cache=[]}WalkontableClassNameCache.prototype.add=function(r,c,cls){if(!this.cache[r]){this.cache[r]=[]}if(!this.cache[r][c]){this.cache[r][c]=[]}this.cache[r][c][cls]=true};WalkontableClassNameCache.prototype.test=function(r,c,cls){return(this.cache[r]&&this.cache[r][c]&&this.cache[r][c][cls])};function WalkontableColumnFilter(){this.countTH=0}WalkontableColumnFilter.prototype=new WalkontableCellFilter();WalkontableColumnFilter.prototype.readSettings=function(instance){this.offset=instance.wtSettings.settings.offsetColumn;this.total=instance.getSetting("totalColumns");this.fixedCount=instance.getSetting("fixedColumnsLeft");this.countTH=instance.getSetting("rowHeaders").length};WalkontableColumnFilter.prototype.offsettedTH=function(n){return n-this.countTH};WalkontableColumnFilter.prototype.unOffsettedTH=function(n){return n+this.countTH};WalkontableColumnFilter.prototype.visibleRowHeadedColumnToSourceColumn=function(n){return this.visibleToSource(this.offsettedTH(n))};WalkontableColumnFilter.prototype.sourceColumnToVisibleRowHeadedColumn=function(n){return this.unOffsettedTH(this.sourceToVisible(n))};function WalkontableColumnStrategy(containerSizeFn,sizeAtIndex,strategy){var size,i=0;this.containerSizeFn=containerSizeFn;this.cellSizesSum=0;this.cellSizes=[];this.cellStretch=[];this.cellCount=0;this.remainingSize=0;this.strategy=strategy;while(true){size=sizeAtIndex(i);if(size===void 0){break}if(this.cellSizesSum>=this.getContainerSize(this.cellSizesSum+size)){break}this.cellSizes.push(size);this.cellSizesSum+=size;this.cellCount++;i++}var containerSize=this.getContainerSize(this.cellSizesSum);this.remainingSize=this.cellSizesSum-containerSize}WalkontableColumnStrategy.prototype=new WalkontableCellStrategy();WalkontableColumnStrategy.prototype.getSize=function(index){return this.cellSizes[index]+(this.cellStretch[index]||0)};WalkontableColumnStrategy.prototype.stretch=function(){var containerSize=this.getContainerSize(this.cellSizesSum),i=0;this.remainingSize=this.cellSizesSum-containerSize;this.cellStretch.length=0;if(this.strategy==="all"){if(this.remainingSize<0){var ratio=containerSize/this.cellSizesSum;var newSize;while(i<this.cellCount-1){newSize=Math.floor(ratio*this.cellSizes[i]);this.remainingSize+=newSize-this.cellSizes[i];this.cellStretch[i]=newSize-this.cellSizes[i];i++}this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}else{if(this.strategy==="last"){if(this.remainingSize<0){this.cellStretch[this.cellCount-1]=-this.remainingSize;this.remainingSize=0}}}};function Walkontable(settings){var that=this,originalHeaders=[];this.guid="wt_"+walkontableRandomString();this.wtDom=new WalkontableDom();if(settings.cloneFrom){this.cloneFrom=settings.cloneFrom;this.cloneDirection=settings.cloneDirection;this.wtSettings=settings.cloneFrom.wtSettings;this.wtTable=new WalkontableTable(this,settings.table);this.wtScroll=new WalkontableScroll(this);this.wtViewport=settings.cloneFrom.wtViewport}else{this.wtSettings=new WalkontableSettings(this,settings);this.wtTable=new WalkontableTable(this,settings.table);this.wtScroll=new WalkontableScroll(this);this.wtViewport=new WalkontableViewport(this);this.wtScrollbars=new WalkontableScrollbars(this);this.wtWheel=new WalkontableWheel(this);this.wtEvent=new WalkontableEvent(this)}if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var c=0,clen=this.wtTable.THEAD.childNodes[0].childNodes.length;c<clen;c++){originalHeaders.push(this.wtTable.THEAD.childNodes[0].childNodes[c].innerHTML)}if(!this.getSetting("columnHeaders").length){this.update("columnHeaders",[function(column,TH){that.wtDom.fastInnerText(TH,originalHeaders[column])}])}}this.selections={};var selectionsSettings=this.getSetting("selections");if(selectionsSettings){for(var i in selectionsSettings){if(selectionsSettings.hasOwnProperty(i)){this.selections[i]=new WalkontableSelection(this,selectionsSettings[i])}}}this.drawn=false;this.drawInterrupted=false;if(window.Handsontable){Handsontable.PluginHooks.add("beforeChange",function(){if(that.rowHeightCache){that.rowHeightCache.length=0}})}}Walkontable.prototype.draw=function(selectionsOnly){this.drawInterrupted=false;if(!selectionsOnly&&!this.wtDom.isVisible(this.wtTable.TABLE)){this.drawInterrupted=true;return}this.getSetting("beforeDraw",!selectionsOnly);selectionsOnly=selectionsOnly&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn;if(this.drawn){this.scrollVertical(0);this.scrollHorizontal(0)}this.lastOffsetRow=this.getSetting("offsetRow");this.lastOffsetColumn=this.getSetting("offsetColumn");this.wtTable.draw(selectionsOnly);this.getSetting("onDraw",!selectionsOnly);return this};Walkontable.prototype.update=function(settings,value){return this.wtSettings.update(settings,value)};Walkontable.prototype.scrollVertical=function(delta){return this.wtScroll.scrollVertical(delta)};Walkontable.prototype.scrollHorizontal=function(delta){return this.wtScroll.scrollHorizontal(delta)};Walkontable.prototype.scrollViewport=function(coords){this.wtScroll.scrollViewport(coords);return this};Walkontable.prototype.getViewport=function(){return[this.wtTable.rowFilter.visibleToSource(0),this.wtTable.columnFilter.visibleToSource(0),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]};Walkontable.prototype.getSetting=function(key,param1,param2,param3){return this.wtSettings.getSetting(key,param1,param2,param3)};Walkontable.prototype.hasSetting=function(key){return this.wtSettings.has(key)};Walkontable.prototype.destroy=function(){$(document.body).off("."+this.guid);this.wtScrollbars.destroy();clearTimeout(this.wheelTimeout);this.wtEvent&&this.wtEvent.destroy()};function WalkontableDom(){}WalkontableDom.prototype.closest=function(elem,nodeNames,until){while(elem!=null&&elem!==until){if(elem.nodeType===1&&nodeNames.indexOf(elem.nodeName)>-1){return elem}elem=elem.parentNode}return null};WalkontableDom.prototype.isChildOf=function(child,parent){var node=child.parentNode;while(node!=null){if(node==parent){return true}node=node.parentNode}return false};WalkontableDom.prototype.index=function(elem){var i=0;while(elem=elem.previousSibling){++i}return i};if(document.documentElement.classList){WalkontableDom.prototype.hasClass=function(ele,cls){return ele.classList.contains(cls)};WalkontableDom.prototype.addClass=function(ele,cls){ele.classList.add(cls)};WalkontableDom.prototype.removeClass=function(ele,cls){ele.classList.remove(cls)}}else{WalkontableDom.prototype.hasClass=function(ele,cls){return ele.className.match(new RegExp("(\\s|^)"+cls+"(\\s|$)"))};WalkontableDom.prototype.addClass=function(ele,cls){if(!this.hasClass(ele,cls)){ele.className+=" "+cls}};WalkontableDom.prototype.removeClass=function(ele,cls){if(this.hasClass(ele,cls)){var reg=new RegExp("(\\s|^)"+cls+"(\\s|$)");ele.className=ele.className.replace(reg," ").trim()}}}WalkontableDom.prototype.removeTextNodes=function(elem,parent){if(elem.nodeType===3){parent.removeChild(elem)}else{if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(elem.nodeName)>-1){var childs=elem.childNodes;for(var i=childs.length-1;i>=0;i--){this.removeTextNodes(childs[i],elem)}}}};WalkontableDom.prototype.empty=function(element){var child;while(child=element.lastChild){element.removeChild(child)}};WalkontableDom.prototype.HTML_CHARACTERS=/(<(.*)>|&(.*);)/;WalkontableDom.prototype.fastInnerHTML=function(element,content){if(this.HTML_CHARACTERS.test(content)){element.innerHTML=content}else{this.fastInnerText(element,content)}};if(document.createTextNode("test").textContent){WalkontableDom.prototype.fastInnerText=function(element,content){var child=element.firstChild;if(child&&child.nodeType===3&&child.nextSibling===null){child.textContent=content}else{this.empty(element);element.appendChild(document.createTextNode(content))}}}else{WalkontableDom.prototype.fastInnerText=function(element,content){var child=element.firstChild;if(child&&child.nodeType===3&&child.nextSibling===null){child.data=content}else{this.empty(element);element.appendChild(document.createTextNode(content))}}}WalkontableDom.prototype.isVisible=function(elem){var next=elem;while(next!==document.documentElement){if(next===null){return false}else{if(next.nodeType===11){return false}else{if(next.style.display==="none"){return false}}}next=next.parentNode}return true};WalkontableDom.prototype.offset=function(elem){if(this.hasCaptionProblem()&&elem.firstChild&&elem.firstChild.nodeName==="CAPTION"){var box=elem.getBoundingClientRect();return{top:box.top+(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),left:box.left+(window.pageXOffset||document.documentElement.scrollLeft)-(document.documentElement.clientLeft||0)}}var offsetLeft=elem.offsetLeft,offsetTop=elem.offsetTop,lastElem=elem;while(elem=elem.offsetParent){if(elem===document.body){break}offsetLeft+=elem.offsetLeft;offsetTop+=elem.offsetTop;lastElem=elem}if(lastElem&&lastElem.style.position==="fixed"){offsetLeft+=window.pageXOffset||document.documentElement.scrollLeft;offsetTop+=window.pageYOffset||document.documentElement.scrollTop}return{left:offsetLeft,top:offsetTop}};WalkontableDom.prototype.getComputedStyle=function(elem){return elem.currentStyle||document.defaultView.getComputedStyle(elem)};WalkontableDom.prototype.outerWidth=function(elem){return elem.offsetWidth};WalkontableDom.prototype.outerHeight=function(elem){if(this.hasCaptionProblem()&&elem.firstChild&&elem.firstChild.nodeName==="CAPTION"){return elem.offsetHeight+elem.firstChild.offsetHeight}else{return elem.offsetHeight}};(function(){var hasCaptionProblem;function detectCaptionProblem(){var TABLE=document.createElement("TABLE");TABLE.style.borderSpacing=0;TABLE.style.borderWidth=0;TABLE.style.padding=0;var TBODY=document.createElement("TBODY");TABLE.appendChild(TBODY);TBODY.appendChild(document.createElement("TR"));TBODY.firstChild.appendChild(document.createElement("TD"));TBODY.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var CAPTION=document.createElement("CAPTION");CAPTION.innerHTML="c<br>c<br>c<br>c";CAPTION.style.padding=0;CAPTION.style.margin=0;TABLE.insertBefore(CAPTION,TBODY);document.body.appendChild(TABLE);hasCaptionProblem=(TABLE.offsetHeight<2*TABLE.lastChild.offsetHeight);document.body.removeChild(TABLE)}WalkontableDom.prototype.hasCaptionProblem=function(){if(hasCaptionProblem===void 0){detectCaptionProblem()}return hasCaptionProblem};WalkontableDom.prototype.getCaretPosition=function(el){if(el.selectionStart){return el.selectionStart}else{if(document.selection){el.focus();var r=document.selection.createRange();if(r==null){return 0}var re=el.createTextRange(),rc=re.duplicate();re.moveToBookmark(r.getBookmark());rc.setEndPoint("EndToStart",re);return rc.text.length}}return 0};WalkontableDom.prototype.setCaretPosition=function(el,pos,endPos){if(endPos===void 0){endPos=pos}if(el.setSelectionRange){el.focus();el.setSelectionRange(pos,endPos)}else{if(el.createTextRange){var range=el.createTextRange();range.collapse(true);range.moveEnd("character",endPos);range.moveStart("character",pos);range.select()}}}})();function WalkontableEvent(instance){var that=this;this.instance=instance;this.wtDom=this.instance.wtDom;var dblClickOrigin=[null,null];var dblClickTimeout=[null,null];var onMouseDown=function(event){var cell=that.parentCell(event.target);if(that.wtDom.hasClass(event.target,"corner")){that.instance.getSetting("onCellCornerMouseDown",event,event.target)}else{if(cell.TD&&cell.TD.nodeName==="TD"){if(that.instance.hasSetting("onCellMouseDown")){that.instance.getSetting("onCellMouseDown",event,cell.coords,cell.TD)}}}if(event.button!==2){if(cell.TD&&cell.TD.nodeName==="TD"){dblClickOrigin[0]=cell.TD;clearTimeout(dblClickTimeout[0]);dblClickTimeout[0]=setTimeout(function(){dblClickOrigin[0]=null},1000)}}};var lastMouseOver;var onMouseOver=function(event){if(that.instance.hasSetting("onCellMouseOver")){var TABLE=that.instance.wtTable.TABLE;var TD=that.wtDom.closest(event.target,["TD","TH"],TABLE);if(TD&&TD!==lastMouseOver&&that.wtDom.isChildOf(TD,TABLE)){lastMouseOver=TD;if(TD.nodeName==="TD"){that.instance.getSetting("onCellMouseOver",event,that.instance.wtTable.getCoords(TD),TD)}}}};var onMouseUp=function(event){if(event.button!==2){var cell=that.parentCell(event.target);if(cell.TD===dblClickOrigin[0]&&cell.TD===dblClickOrigin[1]){if(that.wtDom.hasClass(event.target,"corner")){that.instance.getSetting("onCellCornerDblClick",event,cell.coords,cell.TD)}else{if(cell.TD){that.instance.getSetting("onCellDblClick",event,cell.coords,cell.TD)}}dblClickOrigin[0]=null;dblClickOrigin[1]=null}else{if(cell.TD===dblClickOrigin[0]){dblClickOrigin[1]=cell.TD;clearTimeout(dblClickTimeout[1]);dblClickTimeout[1]=setTimeout(function(){dblClickOrigin[1]=null},1000)}}}};$(this.instance.wtTable.holder).on("mousedown",onMouseDown);$(this.instance.wtTable.TABLE).on("mouseover",onMouseOver);$(this.instance.wtTable.holder).on("mouseup",onMouseUp)}WalkontableEvent.prototype.parentCell=function(elem){var cell={};var TABLE=this.instance.wtTable.TABLE;var TD=this.wtDom.closest(elem,["TD","TH"],TABLE);if(TD&&this.wtDom.isChildOf(TD,TABLE)){cell.coords=this.instance.wtTable.getCoords(TD);cell.TD=TD}else{if(this.wtDom.hasClass(elem,"wtBorder")&&this.wtDom.hasClass(elem,"current")){cell.coords=this.instance.selections.current.selected[0];cell.TD=this.instance.wtTable.getCell(cell.coords)}}return cell};WalkontableEvent.prototype.destroy=function(){clearTimeout(this.dblClickTimeout0);clearTimeout(this.dblClickTimeout1)};function walkontableRangesIntersect(){var from=arguments[0];var to=arguments[1];for(var i=1,ilen=arguments.length/2;i<ilen;i++){if(from<=arguments[2*i+1]&&to>=arguments[2*i]){return true}}return false}function walkontableRandomString(){function s4(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return s4()+s4()+s4()+s4()}var cachedScrollbarWidth;function walkontableCalculateScrollbarWidth(){var inner=document.createElement("p");inner.style.width="100%";inner.style.height="200px";var outer=document.createElement("div");outer.style.position="absolute";outer.style.top="0px";outer.style.left="0px";outer.style.visibility="hidden";outer.style.width="200px";outer.style.height="150px";outer.style.overflow="hidden";outer.appendChild(inner);document.body.appendChild(outer);var w1=inner.offsetWidth;outer.style.overflow="scroll";var w2=inner.offsetWidth;if(w1==w2){w2=outer.clientWidth}document.body.removeChild(outer);return(w1-w2)}function walkontableGetScrollbarWidth(){if(cachedScrollbarWidth===void 0){cachedScrollbarWidth=walkontableCalculateScrollbarWidth()}return cachedScrollbarWidth}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(elt){var len=this.length>>>0;var from=Number(arguments[1])||0;from=(from<0)?Math.ceil(from):Math.floor(from);if(from<0){from+=len}for(;from<len;from++){if(from in this&&this[from]===elt){return from}}return -1}}window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){return window.setTimeout(callback,1000/60)}})();window.cancelRequestAnimFrame=(function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout})();if(!window.getComputedStyle){(function(){var elem;var styleObj={getPropertyValue:function getPropertyValue(prop){if(prop=="float"){prop="styleFloat"}return elem.currentStyle[prop.toUpperCase()]||null}};window.getComputedStyle=function(el){elem=el;return styleObj}})()}if(!String.prototype.trim){var trimRegex=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(trimRegex,"")}}function WalkontableRowFilter(){}WalkontableRowFilter.prototype=new WalkontableCellFilter();WalkontableRowFilter.prototype.readSettings=function(instance){this.offset=instance.wtSettings.settings.offsetRow;this.total=instance.getSetting("totalRows");this.fixedCount=instance.getSetting("fixedRowsTop")};function WalkontableRowStrategy(containerSizeFn,sizeAtIndex){this.containerSizeFn=containerSizeFn;this.sizeAtIndex=sizeAtIndex;this.cellSizesSum=0;this.cellSizes=[];this.cellCount=0;this.remainingSize=-Infinity}WalkontableRowStrategy.prototype=new WalkontableCellStrategy();WalkontableRowStrategy.prototype.add=function(i,TD,reverse){if(!this.isLastIncomplete()){var size=this.sizeAtIndex(i,TD);if(size===void 0){return false}var containerSize=this.getContainerSize(this.cellSizesSum+size);if(reverse){this.cellSizes.unshift(size)}else{this.cellSizes.push(size)}this.cellSizesSum+=size;this.cellCount++;this.remainingSize=this.cellSizesSum-containerSize;if(reverse&&this.isLastIncomplete()){return false}return true}return false};WalkontableRowStrategy.prototype.remove=function(){var size=this.cellSizes.pop();this.cellSizesSum-=size;this.cellCount--;this.remainingSize-=size};WalkontableRowStrategy.prototype.removeOutstanding=function(){while(this.cellCount>0&&this.cellSizes[this.cellCount-1]<this.remainingSize){this.remove()}};function WalkontableScroll(instance){this.instance=instance}WalkontableScroll.prototype.scrollVertical=function(delta){if(!this.instance.drawn){throw new Error("scrollVertical can only be called after table was drawn to DOM")}var instance=this.instance,newOffset,offset=instance.getSetting("offsetRow"),fixedCount=instance.getSetting("fixedRowsTop"),total=instance.getSetting("totalRows"),maxSize=instance.wtViewport.getViewportHeight();if(total>0){newOffset=this.scrollLogicVertical(delta,offset,total,fixedCount,maxSize,function(row){if(row-offset<fixedCount&&row-offset>=0){return instance.getSetting("rowHeight",row-offset)}else{return instance.getSetting("rowHeight",row)}},function(isReverse){instance.wtTable.verticalRenderReverse=isReverse})}else{newOffset=0}if(newOffset!==offset){this.instance.wtScrollbars.vertical.scrollTo(newOffset)}return instance};WalkontableScroll.prototype.scrollHorizontal=function(delta){if(!this.instance.drawn){throw new Error("scrollHorizontal can only be called after table was drawn to DOM")}var instance=this.instance,newOffset,offset=instance.getSetting("offsetColumn"),fixedCount=instance.getSetting("fixedColumnsLeft"),total=instance.getSetting("totalColumns"),maxSize=instance.wtViewport.getViewportWidth();if(total>0){newOffset=this.scrollLogicHorizontal(delta,offset,total,fixedCount,maxSize,function(col){if(col-offset<fixedCount&&col-offset>=0){return instance.getSetting("columnWidth",col-offset)}else{return instance.getSetting("columnWidth",col)}})}else{newOffset=0}if(newOffset!==offset){this.instance.wtScrollbars.horizontal.scrollTo(newOffset)}return instance};WalkontableScroll.prototype.scrollLogicVertical=function(delta,offset,total,fixedCount,maxSize,cellSizeFn,setReverseRenderFn){var newOffset=offset+delta;if(newOffset>=total-fixedCount){newOffset=total-fixedCount-1;setReverseRenderFn(true)}if(newOffset<0){newOffset=0}return newOffset};WalkontableScroll.prototype.scrollLogicHorizontal=function(delta,offset,total,fixedCount,maxSize,cellSizeFn){var newOffset=offset+delta,sum=0,col;if(newOffset>fixedCount){if(newOffset>=total-fixedCount){newOffset=total-fixedCount-1}col=newOffset;while(sum<maxSize&&col<total){sum+=cellSizeFn(col);col++}if(sum<maxSize){while(newOffset>0){sum+=cellSizeFn(newOffset-1);if(sum<maxSize){newOffset--}else{break}}}}else{if(newOffset<0){newOffset=0}}return newOffset};WalkontableScroll.prototype.scrollViewport=function(coords){if(!this.instance.drawn){return}var offsetRow=this.instance.getSetting("offsetRow"),offsetColumn=this.instance.getSetting("offsetColumn"),lastVisibleRow=this.instance.wtTable.getLastVisibleRow(),totalRows=this.instance.getSetting("totalRows"),totalColumns=this.instance.getSetting("totalColumns"),fixedRowsTop=this.instance.getSetting("fixedRowsTop"),fixedColumnsLeft=this.instance.getSetting("fixedColumnsLeft");if(this.instance.getSetting("nativeScrollbars")){var TD=this.instance.wtTable.getCell(coords);if(typeof TD==="object"){var offset=WalkontableDom.prototype.offset(TD);var outerHeight=WalkontableDom.prototype.outerHeight(TD);var scrollY=this.instance.wtScrollbars.vertical.getScrollPosition();var clientHeight=WalkontableDom.prototype.outerHeight(this.instance.wtScrollbars.vertical.scrollHandler);if(this.instance.wtScrollbars.vertical.scrollHandler!==window){offset.top=offset.top-WalkontableDom.prototype.offset(this.instance.wtScrollbars.vertical.scrollHandler).top}clientHeight-=20;if(outerHeight<clientHeight){if(offset.top<scrollY){this.instance.wtScrollbars.vertical.setScrollPosition(offset.top)}else{if(offset.top+outerHeight>scrollY+clientHeight){this.instance.wtScrollbars.vertical.setScrollPosition(offset.top-clientHeight+outerHeight)}}}return}}if(coords[0]<0||coords[0]>totalRows-1){throw new Error("row "+coords[0]+" does not exist")}else{if(coords[1]<0||coords[1]>totalColumns-1){throw new Error("column "+coords[1]+" does not exist")}}if(coords[0]>lastVisibleRow){this.scrollVertical(coords[0]-fixedRowsTop-offsetRow);this.instance.wtTable.verticalRenderReverse=true}else{if(coords[0]===lastVisibleRow&&this.instance.wtTable.rowStrategy.isLastIncomplete()){this.scrollVertical(coords[0]-fixedRowsTop-offsetRow);this.instance.wtTable.verticalRenderReverse=true}else{if(coords[0]-fixedRowsTop<offsetRow){this.scrollVertical(coords[0]-fixedRowsTop-offsetRow)}else{this.scrollVertical(0)}}}if(this.instance.wtTable.isColumnBeforeViewport(coords[1])){this.instance.wtScrollbars.horizontal.scrollTo(coords[1]-fixedColumnsLeft)}else{if(this.instance.wtTable.isColumnAfterViewport(coords[1])||(this.instance.wtTable.getLastVisibleColumn()===coords[1]&&!this.instance.wtTable.isLastColumnFullyVisible())){var sum=0;for(var i=0;i<fixedColumnsLeft;i++){sum+=this.instance.getSetting("columnWidth",i)}var scrollTo=coords[1];sum+=this.instance.getSetting("columnWidth",scrollTo);var available=this.instance.wtViewport.getViewportWidth();if(sum<available){var next=this.instance.getSetting("columnWidth",scrollTo-1);while(sum+next<available&&scrollTo>=fixedColumnsLeft){scrollTo--;sum+=next}}this.instance.wtScrollbars.horizontal.scrollTo(scrollTo-fixedColumnsLeft)}}return this.instance};function WalkontableScrollbar(){}WalkontableScrollbar.prototype.init=function(){var that=this;this.$table=$(this.instance.wtTable.TABLE);this.slider=document.createElement("DIV");this.sliderStyle=this.slider.style;this.sliderStyle.position="absolute";this.sliderStyle.top="0";this.sliderStyle.left="0";this.sliderStyle.display="none";this.slider.className="dragdealer "+this.type;this.handle=document.createElement("DIV");this.handleStyle=this.handle.style;this.handle.className="handle";this.slider.appendChild(this.handle);this.container=this.instance.wtTable.holder;this.container.appendChild(this.slider);var firstRun=true;this.dragTimeout=null;var dragDelta;var dragRender=function(){that.onScroll(dragDelta)};this.dragdealer=new Dragdealer(this.slider,{vertical:(this.type==="vertical"),horizontal:(this.type==="horizontal"),slide:false,speed:100,animationCallback:function(x,y){if(firstRun){firstRun=false;return}that.skipRefresh=true;dragDelta=that.type==="vertical"?y:x;if(that.dragTimeout===null){that.dragTimeout=setInterval(dragRender,100);dragRender()}},callback:function(x,y){that.skipRefresh=false;clearInterval(that.dragTimeout);that.dragTimeout=null;dragDelta=that.type==="vertical"?y:x;that.onScroll(dragDelta)}});this.skipRefresh=false};WalkontableScrollbar.prototype.onScroll=function(delta){if(this.instance.drawn){this.readSettings();if(this.total>this.visibleCount){var newOffset=Math.round(this.handlePosition*this.total/this.sliderSize);if(delta===1){if(this.type==="vertical"){this.instance.scrollVertical(Infinity).draw()}else{this.instance.scrollHorizontal(Infinity).draw()}}else{if(newOffset!==this.offset){if(this.type==="vertical"){this.instance.scrollVertical(newOffset-this.offset).draw()}else{this.instance.scrollHorizontal(newOffset-this.offset).draw()}}else{this.refresh()}}}}};WalkontableScrollbar.prototype.getHandleSizeRatio=function(viewportCount,totalCount){if(!totalCount||viewportCount>totalCount||viewportCount==totalCount){return 1}return 1/totalCount};WalkontableScrollbar.prototype.prepare=function(){if(this.skipRefresh){return}var ratio=this.getHandleSizeRatio(this.visibleCount,this.total);if(((ratio===1||isNaN(ratio))&&this.scrollMode==="auto")||this.scrollMode==="none"){this.visible=false}else{this.visible=true}};WalkontableScrollbar.prototype.refresh=function(){if(this.skipRefresh){return}else{if(!this.visible){this.sliderStyle.display="none";return}}var ratio,sliderSize,handleSize,handlePosition,visibleCount=this.visibleCount,tableWidth=this.instance.wtViewport.getWorkspaceWidth(),tableHeight=this.instance.wtViewport.getWorkspaceHeight();if(tableWidth===Infinity){tableWidth=this.instance.wtViewport.getWorkspaceActualWidth()}if(tableHeight===Infinity){tableHeight=this.instance.wtViewport.getWorkspaceActualHeight()}if(this.type==="vertical"){if(this.instance.wtTable.rowStrategy.isLastIncomplete()){visibleCount--}sliderSize=tableHeight-2;this.sliderStyle.top=this.instance.wtDom.offset(this.$table[0]).top-this.instance.wtDom.offset(this.container).top+"px";this.sliderStyle.left=tableWidth-1+"px";this.sliderStyle.height=Math.max(sliderSize,0)+"px"}else{sliderSize=tableWidth-2;this.sliderStyle.left=this.instance.wtDom.offset(this.$table[0]).left-this.instance.wtDom.offset(this.container).left+"px";this.sliderStyle.top=tableHeight-1+"px";this.sliderStyle.width=Math.max(sliderSize,0)+"px"}ratio=this.getHandleSizeRatio(visibleCount,this.total);handleSize=Math.round(sliderSize*ratio);if(handleSize<10){handleSize=15}handlePosition=Math.floor(sliderSize*(this.offset/this.total));if(handleSize+handlePosition>sliderSize){handlePosition=sliderSize-handleSize}if(this.type==="vertical"){this.handleStyle.height=handleSize+"px";this.handleStyle.top=handlePosition+"px"}else{this.handleStyle.width=handleSize+"px";this.handleStyle.left=handlePosition+"px"}this.sliderStyle.display="block"};WalkontableScrollbar.prototype.destroy=function(){clearInterval(this.dragdealer.interval)};var WalkontableVerticalScrollbar=function(instance){this.instance=instance;this.type="vertical";this.init()};WalkontableVerticalScrollbar.prototype=new WalkontableScrollbar();WalkontableVerticalScrollbar.prototype.scrollTo=function(cell){this.instance.update("offsetRow",cell)};WalkontableVerticalScrollbar.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollV");this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows");this.visibleCount=this.instance.wtTable.rowStrategy.countVisible();if(this.visibleCount>1&&this.instance.wtTable.rowStrategy.isLastIncomplete()){this.visibleCount--}this.handlePosition=parseInt(this.handleStyle.top,10);this.sliderSize=parseInt(this.sliderStyle.height,10);this.fixedCount=this.instance.getSetting("fixedRowsTop")};var WalkontableHorizontalScrollbar=function(instance){this.instance=instance;this.type="horizontal";this.init()};WalkontableHorizontalScrollbar.prototype=new WalkontableScrollbar();WalkontableHorizontalScrollbar.prototype.scrollTo=function(cell){this.instance.update("offsetColumn",cell)};WalkontableHorizontalScrollbar.prototype.readSettings=function(){this.scrollMode=this.instance.getSetting("scrollH");this.offset=this.instance.getSetting("offsetColumn");this.total=this.instance.getSetting("totalColumns");this.visibleCount=this.instance.wtTable.columnStrategy.countVisible();if(this.visibleCount>1&&this.instance.wtTable.columnStrategy.isLastIncomplete()){this.visibleCount--}this.handlePosition=parseInt(this.handleStyle.left,10);this.sliderSize=parseInt(this.sliderStyle.width,10);this.fixedCount=this.instance.getSetting("fixedColumnsLeft")};WalkontableHorizontalScrollbar.prototype.getHandleSizeRatio=function(viewportCount,totalCount){if(!totalCount||viewportCount>totalCount||viewportCount==totalCount){return 1}return viewportCount/totalCount};function WalkontableScrollbarNative(){this.lastWindowScrollPosition=NaN;this.maxOuts=10;this.lastBegin=0;this.lastEnd=0}WalkontableScrollbarNative.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE;this.fixed=this.instance.wtTable.hider;this.fixedContainer=this.instance.wtTable.holder;this.fixed.style.position="absolute";this.fixed.style.left="0";this.scrollHandler=this.getScrollableElement(this.TABLE);this.$scrollHandler=$(this.scrollHandler)};WalkontableScrollbarNative.prototype.getScrollableElement=function(TABLE){var el=TABLE.parentNode;while(el&&el.style){if(el.style.overflow==="scroll"){return el}el=el.parentNode}return window};WalkontableScrollbarNative.prototype.prepare=function(){};WalkontableScrollbarNative.prototype.availableSize=function(){var availableSize;if(this.windowScrollPosition>this.tableParentOffset){if(this.instance.wtTable.getLastVisibleRow()===this.total-1){availableSize=this.instance.wtDom.outerHeight(this.TABLE)}else{availableSize=this.windowSize}}else{availableSize=this.windowSize-(this.tableParentOffset)}return availableSize};WalkontableScrollbarNative.prototype.refresh=function(selectionsOnly){var last=this.getLastCell();this.measureBefore=this.sumCellSizes(0,this.offset);if(last===-1){this.measureAfter=0}else{this.measureAfter=this.sumCellSizes(last,this.total-last)}this.applyToDOM();this.clone&&this.clone.draw(selectionsOnly)};WalkontableScrollbarNative.prototype.destroy=function(){this.$scrollHandler.off("."+this.instance.guid);$(window).off("."+this.instance.guid);$(document).off("."+this.instance.guid)};function WalkontableCornerScrollbarNative(instance){this.instance=instance;this.init();this.clone=this.makeClone("corner")}WalkontableCornerScrollbarNative.prototype=new WalkontableScrollbarNative();WalkontableCornerScrollbarNative.prototype.makeClone=function(direction){if(this.instance.cloneFrom){return}var clone=$('<div id="cln_'+direction+'" class="handsontable"></div>');this.instance.wtTable.holder.parentNode.appendChild(clone[0]);clone.css({position:"fixed",overflow:"hidden"});var table2=$('<table class="htCore"></table>');table2.className=this.instance.wtTable.TABLE.className;clone.append(table2);var walkontableConfig={};walkontableConfig.cloneFrom=this.instance;walkontableConfig.cloneDirection=direction;walkontableConfig.table=table2[0];var wt=new Walkontable(walkontableConfig);return wt};WalkontableCornerScrollbarNative.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var elem=this.clone.wtTable.holder.parentNode;var box;if(this.scrollHandler===window){box=this.instance.wtTable.holder.getBoundingClientRect();var top=Math.ceil(box.top,10);var bottom=Math.ceil(box.bottom,10);if(top<0&&bottom>0){elem.style.top="0"}else{elem.style.top=top+"px"}var left=Math.ceil(box.left,10);var right=Math.ceil(box.right,10);if(left<0&&right>0){elem.style.left="0"}else{elem.style.left=left+"px"}}else{box=this.scrollHandler.getBoundingClientRect();elem.style.top=Math.ceil(box.top,10)+"px";elem.style.left=Math.ceil(box.left,10)+"px"}elem.style.width=WalkontableDom.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px";elem.style.height=WalkontableDom.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"};WalkontableCornerScrollbarNative.prototype.prepare=function(){};WalkontableCornerScrollbarNative.prototype.refresh=function(selectionsOnly){this.measureBefore=0;this.measureAfter=0;this.clone&&this.clone.draw(selectionsOnly)};WalkontableCornerScrollbarNative.prototype.getScrollPosition=function(){};WalkontableCornerScrollbarNative.prototype.getLastCell=function(){};WalkontableCornerScrollbarNative.prototype.getTableSize=function(){};WalkontableCornerScrollbarNative.prototype.applyToDOM=function(){};WalkontableCornerScrollbarNative.prototype.scrollTo=function(){};WalkontableCornerScrollbarNative.prototype.readWindowSize=function(){};WalkontableCornerScrollbarNative.prototype.readSettings=function(){};function WalkontableHorizontalScrollbarNative(instance){this.instance=instance;this.type="horizontal";this.cellSize=50;this.init();this.clone=this.makeClone("left")}WalkontableHorizontalScrollbarNative.prototype=new WalkontableScrollbarNative();WalkontableHorizontalScrollbarNative.prototype.makeClone=function(direction){if(this.instance.cloneFrom){return}var that=this;var clone=$('<div id="cln_'+direction+'" class="handsontable"></div>');this.instance.wtTable.holder.parentNode.appendChild(clone[0]);clone.css({position:"fixed",overflow:"hidden"});var table2=$('<table class="htCore"></table>');table2.className=this.instance.wtTable.TABLE.className;clone.append(table2);var walkontableConfig={};walkontableConfig.cloneFrom=this.instance;walkontableConfig.cloneDirection=direction;walkontableConfig.table=table2[0];var wt=new Walkontable(walkontableConfig);return wt};WalkontableHorizontalScrollbarNative.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var elem=this.clone.wtTable.holder.parentNode;var box;if(this.scrollHandler===window){box=this.instance.wtTable.holder.getBoundingClientRect();var left=Math.ceil(box.left,10);var right=Math.ceil(box.right,10);if(left<0&&right>0){elem.style.left="0"}else{elem.style.left=left+"px"}}else{box=this.scrollHandler.getBoundingClientRect();elem.style.top=Math.ceil(box.top,10)+"px";elem.style.left=Math.ceil(box.left,10)+"px"}elem.style.width=WalkontableDom.prototype.outerWidth(this.clone.wtTable.TABLE)+4+"px";elem.style.height=this.instance.wtViewport.getWorkspaceHeight()-this.instance.getSetting("scrollbarHeight")+"px"};WalkontableHorizontalScrollbarNative.prototype.prepare=function(){};WalkontableHorizontalScrollbarNative.prototype.refresh=function(selectionsOnly){this.measureBefore=0;this.measureAfter=0;this.clone&&this.clone.draw(selectionsOnly)};WalkontableHorizontalScrollbarNative.prototype.getScrollPosition=function(){if(this.scrollHandler===window){return this.scrollHandler.scrollX}else{return this.scrollHandler.scrollLeft}};WalkontableHorizontalScrollbarNative.prototype.onScroll=function(){if(this.instance.cloneFrom){return}this.windowScrollPosition=this.getScrollPosition()};WalkontableHorizontalScrollbarNative.prototype.getLastCell=function(){return this.instance.wtTable.getLastVisibleColumn()};WalkontableHorizontalScrollbarNative.prototype.getTableSize=function(){return this.instance.wtDom.outerWidth(this.TABLE)};WalkontableHorizontalScrollbarNative.prototype.applyToDOM=function(){this.fixedContainer.style.paddingLeft=this.measureBefore+"px";this.fixedContainer.style.paddingRight=this.measureAfter+"px"};WalkontableHorizontalScrollbarNative.prototype.scrollTo=function(cell){this.$scrollHandler.scrollLeft(this.tableParentOffset+cell*this.cellSize)};WalkontableHorizontalScrollbarNative.prototype.readWindowSize=function(){if(this.scrollHandler===window){this.windowSize=document.documentElement.clientWidth;this.tableParentOffset=this.instance.wtTable.holderOffset.left}else{this.windowSize=WalkontableDom.prototype.outerWidth(this.scrollHandler);this.tableParentOffset=0}this.windowScrollPosition=this.getScrollPosition()};WalkontableHorizontalScrollbarNative.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetColumn");this.total=this.instance.getSetting("totalColumns")};function WalkontableVerticalScrollbarNative(instance){this.instance=instance;this.type="vertical";this.cellSize=23;this.init();var that=this;WalkontableCellStrategy.prototype.isLastIncomplete=function(){return this.remainingSize>that.sumCellSizes(that.offset,that.offset+that.curOuts+1)};this.clone=this.makeClone("top")}WalkontableVerticalScrollbarNative.prototype=new WalkontableScrollbarNative();WalkontableVerticalScrollbarNative.prototype.makeClone=function(direction){if(this.instance.cloneFrom){return}var that=this;var clone=$('<div id="cln_'+direction+'" class="handsontable"></div>');this.instance.wtTable.holder.parentNode.appendChild(clone[0]);clone.css({position:"fixed",overflow:"hidden"});var table2=$('<table class="htCore"></table>');table2.className=this.instance.wtTable.TABLE.className;clone.append(table2);var walkontableConfig={};walkontableConfig.cloneFrom=this.instance;walkontableConfig.cloneDirection=direction;walkontableConfig.table=table2[0];var wt=new Walkontable(walkontableConfig);var cloneTable=clone.find("table")[0];this.$scrollHandler.on("scroll."+this.instance.guid,function(){if(!that.instance.wtTable.holder.parentNode){that.destroy();return}that.onScroll();that.instance.wtScrollbars.horizontal.onScroll();cloneTable.style.left=that.instance.wtScrollbars.horizontal.measureBefore-that.instance.wtScrollbars.horizontal.windowScrollPosition+"px";that.instance.wtScrollbars.horizontal.clone.wtTable.TABLE.style.top=that.instance.wtScrollbars.vertical.measureBefore-that.instance.wtScrollbars.vertical.windowScrollPosition+"px"});$(window).on("load."+this.instance.guid,function(){that.resetFixedPosition();that.instance.wtScrollbars.horizontal.resetFixedPosition();that.instance.wtScrollbars.corner.resetFixedPosition()});$(window).on("scroll."+this.instance.guid,function(){that.resetFixedPosition();that.instance.wtScrollbars.horizontal.resetFixedPosition();that.instance.wtScrollbars.corner.resetFixedPosition()});$(window).on("resize."+this.instance.guid,function(){that.resetFixedPosition();that.instance.wtScrollbars.horizontal.resetFixedPosition();that.instance.wtScrollbars.corner.resetFixedPosition()});$(document).on("ready."+this.instance.guid,function(){that.resetFixedPosition();that.instance.wtScrollbars.horizontal.resetFixedPosition();that.instance.wtScrollbars.corner.resetFixedPosition()});return wt};WalkontableVerticalScrollbarNative.prototype.resetFixedPosition=function(){if(!this.instance.wtTable.holder.parentNode){return}var elem=this.clone.wtTable.holder.parentNode;var box;if(this.scrollHandler===window){box=this.instance.wtTable.holder.getBoundingClientRect();var top=Math.ceil(box.top,10);var bottom=Math.ceil(box.bottom,10);if(top<0&&bottom>0){elem.style.top="0"}else{elem.style.top=top+"px"}}else{box=this.scrollHandler.getBoundingClientRect();elem.style.top=Math.ceil(box.top,10)+"px";elem.style.left=Math.ceil(box.left,10)+"px"}elem.style.width=WalkontableDom.prototype.outerWidth(this.instance.wtTable.holder.parentNode)+"px";elem.style.height=WalkontableDom.prototype.outerHeight(this.clone.wtTable.TABLE)+4+"px"};WalkontableVerticalScrollbarNative.prototype.getScrollPosition=function(){if(this.scrollHandler===window){return this.scrollHandler.scrollY}else{return this.scrollHandler.scrollTop}};WalkontableVerticalScrollbarNative.prototype.setScrollPosition=function(pos){this.scrollHandler.scrollTop=pos};WalkontableVerticalScrollbarNative.prototype.onScroll=function(forcePosition){if(this.instance.cloneFrom){return}this.windowScrollPosition=this.getScrollPosition();this.readSettings();if(forcePosition){this.windowScrollPosition=forcePosition}if(this.windowScrollPosition===this.lastWindowScrollPosition){return}if(this.windowScrollPosition>this.lastBegin&&this.windowScrollPosition+this.windowSize<this.lastEnd){return}this.lastWindowScrollPosition=this.windowScrollPosition;var scrollDelta;var newOffset=0;if(1==1||this.windowScrollPosition>this.tableParentOffset){scrollDelta=this.windowScrollPosition-this.tableParentOffset;partialOffset=0;if(scrollDelta>0){var sum=0;var last;for(var i=0;i<this.total;i++){last=this.instance.getSetting("rowHeight",i);sum+=last;if(sum>scrollDelta){break}}if(this.offset>0){partialOffset=(sum-scrollDelta)}newOffset=i;newOffset=Math.min(newOffset,this.total)}}this.curOuts=newOffset>this.maxOuts?this.maxOuts:newOffset;newOffset-=this.curOuts;this.instance.update("offsetRow",newOffset);this.readSettings();this.instance.draw()};WalkontableVerticalScrollbarNative.prototype.getLastCell=function(){return this.instance.getSetting("offsetRow")+this.instance.wtTable.tbodyChildrenLength-1};WalkontableVerticalScrollbarNative.prototype.getTableSize=function(){return this.instance.wtDom.outerHeight(this.TABLE)};var partialOffset=0;WalkontableVerticalScrollbarNative.prototype.sumCellSizes=function(from,length){var sum=0;while(from<length){sum+=this.instance.getSetting("rowHeight",from);from++}return sum};WalkontableVerticalScrollbarNative.prototype.applyToDOM=function(){if(this.instance.cloneDirection==="top"){return}var headerSize=this.instance.wtViewport.getColumnHeaderHeight();this.fixedContainer.style.height=headerSize+this.sumCellSizes(0,this.total)+"px";this.fixed.style.top=this.measureBefore+"px";this.fixed.style.bottom="";this.lastBegin=this.tableParentOffset+this.measureBefore;this.lastEnd=this.lastBegin+headerSize+this.instance.wtTable.rowStrategy.cellSizesSum};WalkontableVerticalScrollbarNative.prototype.scrollTo=function(cell){var newY=this.tableParentOffset+cell*this.cellSize;this.$scrollHandler.scrollTop(newY);this.onScroll(newY)};WalkontableVerticalScrollbarNative.prototype.readWindowSize=function(){if(this.scrollHandler===window){this.windowSize=document.documentElement.clientHeight;this.tableParentOffset=this.instance.wtTable.holderOffset.left}else{this.windowSize=WalkontableDom.prototype.outerHeight(this.scrollHandler);this.tableParentOffset=0}this.windowScrollPosition=this.getScrollPosition()};WalkontableVerticalScrollbarNative.prototype.readSettings=function(){this.offset=this.instance.getSetting("offsetRow");this.total=this.instance.getSetting("totalRows")};function WalkontableScrollbars(instance){if(instance.getSetting("nativeScrollbars")){instance.update("scrollbarWidth",walkontableGetScrollbarWidth());instance.update("scrollbarHeight",walkontableGetScrollbarWidth());this.vertical=new WalkontableVerticalScrollbarNative(instance);this.horizontal=new WalkontableHorizontalScrollbarNative(instance);this.corner=new WalkontableCornerScrollbarNative(instance)}else{this.vertical=new WalkontableVerticalScrollbar(instance);this.horizontal=new WalkontableHorizontalScrollbar(instance)}}WalkontableScrollbars.prototype.destroy=function(){this.vertical&&this.vertical.destroy();this.horizontal&&this.horizontal.destroy()};WalkontableScrollbars.prototype.refresh=function(selectionsOnly){this.horizontal&&this.horizontal.readSettings();this.vertical&&this.vertical.readSettings();this.horizontal&&this.horizontal.prepare();this.vertical&&this.vertical.prepare();this.horizontal&&this.horizontal.refresh(selectionsOnly);this.vertical&&this.vertical.refresh(selectionsOnly);this.corner&&this.corner.refresh(selectionsOnly)};function WalkontableSelection(instance,settings){this.instance=instance;this.settings=settings;this.selected=[];if(settings.border){this.border=new WalkontableBorder(instance,settings)}}WalkontableSelection.prototype.add=function(coords){this.selected.push(coords)};WalkontableSelection.prototype.clear=function(){this.selected.length=0};WalkontableSelection.prototype.getCorners=function(){var minRow,minColumn,maxRow,maxColumn,i,ilen=this.selected.length;if(ilen>0){minRow=maxRow=this.selected[0][0];minColumn=maxColumn=this.selected[0][1];if(ilen>1){for(i=1;i<ilen;i++){if(this.selected[i][0]<minRow){minRow=this.selected[i][0]}else{if(this.selected[i][0]>maxRow){maxRow=this.selected[i][0]}}if(this.selected[i][1]<minColumn){minColumn=this.selected[i][1]}else{if(this.selected[i][1]>maxColumn){maxColumn=this.selected[i][1]}}}}}return[minRow,minColumn,maxRow,maxColumn]};WalkontableSelection.prototype.draw=function(){var corners,r,c,source_r,source_c;var visibleRows=this.instance.wtTable.rowStrategy.countVisible(),visibleColumns=this.instance.wtTable.columnStrategy.countVisible();if(this.selected.length){corners=this.getCorners();for(r=0;r<visibleRows;r++){for(c=0;c<visibleColumns;c++){source_r=this.instance.wtTable.rowFilter.visibleToSource(r);source_c=this.instance.wtTable.columnFilter.visibleToSource(c);if(source_r>=corners[0]&&source_r<=corners[2]&&source_c>=corners[1]&&source_c<=corners[3]){this.instance.wtTable.currentCellCache.add(r,c,this.settings.className)}else{if(source_r>=corners[0]&&source_r<=corners[2]){this.instance.wtTable.currentCellCache.add(r,c,this.settings.highlightRowClassName)}else{if(source_c>=corners[1]&&source_c<=corners[3]){this.instance.wtTable.currentCellCache.add(r,c,this.settings.highlightColumnClassName)}}}}}this.border&&this.border.appear(corners)}else{this.border&&this.border.disappear()}};function WalkontableSettings(instance,settings){var that=this;this.instance=instance;this.defaults={table:void 0,scrollH:"auto",scrollV:"auto",nativeScrollbars:false,stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(row,column,TD){var cellData=that.getSetting("data",row,column);that.instance.wtDom.fastInnerText(TD,cellData===void 0||cellData===null?"":cellData)},columnWidth:50,selections:null,hideBorderOnMouseDownOver:false,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,scrollbarWidth:10,scrollbarHeight:10};this.settings={};for(var i in this.defaults){if(this.defaults.hasOwnProperty(i)){if(settings[i]!==void 0){this.settings[i]=settings[i]}else{if(this.defaults[i]===void 0){throw new Error('A required setting "'+i+'" was not provided')}else{this.settings[i]=this.defaults[i]}}}}}WalkontableSettings.prototype.update=function(settings,value){if(value===void 0){for(var i in settings){if(settings.hasOwnProperty(i)){this.settings[i]=settings[i]}}}else{this.settings[settings]=value}return this.instance};WalkontableSettings.prototype.getSetting=function(key,param1,param2,param3){if(this[key]){return this[key](param1,param2,param3)}else{return this._getSetting(key,param1,param2,param3)}};WalkontableSettings.prototype._getSetting=function(key,param1,param2,param3){if(typeof this.settings[key]==="function"){return this.settings[key](param1,param2,param3)}else{if(param1!==void 0&&Object.prototype.toString.call(this.settings[key])==="[object Array]"){return this.settings[key][param1]}else{return this.settings[key]}}};WalkontableSettings.prototype.has=function(key){return !!this.settings[key]};WalkontableSettings.prototype.rowHeight=function(row,TD){if(!this.instance.rowHeightCache){this.instance.rowHeightCache=[]}if(this.instance.rowHeightCache[row]===void 0){var size=23;if(TD){size=this.instance.wtDom.outerHeight(TD);this.instance.rowHeightCache[row]=size}return size}else{return this.instance.rowHeightCache[row]}};function WalkontableTable(instance,table){this.instance=instance;this.TABLE=table;this.wtDom=this.instance.wtDom;this.wtDom.removeTextNodes(this.TABLE);var parent=this.TABLE.parentNode;if(!parent||parent.nodeType!==1||!this.wtDom.hasClass(parent,"wtHolder")){var spreader=document.createElement("DIV");spreader.className="wtSpreader";if(parent){parent.insertBefore(spreader,this.TABLE)}spreader.appendChild(this.TABLE)}this.spreader=this.TABLE.parentNode;parent=this.spreader.parentNode;if(!parent||parent.nodeType!==1||!this.wtDom.hasClass(parent,"wtHolder")){var hider=document.createElement("DIV");hider.className="wtHider";if(parent){parent.insertBefore(hider,this.spreader)}hider.appendChild(this.spreader)}this.hider=this.spreader.parentNode;this.hiderStyle=this.hider.style;this.hiderStyle.position="relative";parent=this.hider.parentNode;if(!parent||parent.nodeType!==1||!this.wtDom.hasClass(parent,"wtHolder")){var holder=document.createElement("DIV");holder.style.position="relative";holder.className="wtHolder";if(parent){parent.insertBefore(holder,this.hider)}holder.appendChild(this.hider)}this.holder=this.hider.parentNode;this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];if(!this.TBODY){this.TBODY=document.createElement("TBODY");this.TABLE.appendChild(this.TBODY)}this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];if(!this.THEAD){this.THEAD=document.createElement("THEAD");this.TABLE.insertBefore(this.THEAD,this.TBODY)}this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];if(!this.COLGROUP){this.COLGROUP=document.createElement("COLGROUP");this.TABLE.insertBefore(this.COLGROUP,this.THEAD)}if(this.instance.getSetting("columnHeaders").length){if(!this.THEAD.childNodes.length){var TR=document.createElement("TR");this.THEAD.appendChild(TR)}}this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length;this.oldCellCache=new WalkontableClassNameCache();this.currentCellCache=new WalkontableClassNameCache();this.rowFilter=new WalkontableRowFilter();this.columnFilter=new WalkontableColumnFilter();this.verticalRenderReverse=false}WalkontableTable.prototype.refreshHiderDimensions=function(){var height=this.instance.wtViewport.getWorkspaceHeight();var width=this.instance.wtViewport.getWorkspaceWidth();var spreaderStyle=this.spreader.style;if((height!==Infinity||width!==Infinity)&&!this.instance.getSetting("nativeScrollbars")){if(height===Infinity){height=this.instance.wtViewport.getWorkspaceActualHeight()}if(width===Infinity){width=this.instance.wtViewport.getWorkspaceActualWidth()}this.hiderStyle.overflow="hidden";spreaderStyle.position="absolute";spreaderStyle.top="0";spreaderStyle.left="0";if(!this.instance.getSetting("nativeScrollbars")){spreaderStyle.height="4000px";spreaderStyle.width="4000px"}if(height<0){height=0}this.hiderStyle.height=height+"px";this.hiderStyle.width=width+"px"}else{spreaderStyle.position="relative";spreaderStyle.width="auto";spreaderStyle.height="auto"}};WalkontableTable.prototype.refreshStretching=function(){var instance=this.instance,stretchH=instance.getSetting("stretchH"),totalRows=instance.getSetting("totalRows"),totalColumns=instance.getSetting("totalColumns"),offsetColumn=instance.getSetting("offsetColumn");var containerWidthFn=function(cacheWidth){var viewportWidth=that.instance.wtViewport.getViewportWidth(cacheWidth);if(viewportWidth<cacheWidth&&that.instance.getSetting("nativeScrollbars")){return Infinity}return viewportWidth};var that=this;var columnWidthFn=function(i){var source_c=that.columnFilter.visibleToSource(i);if(source_c<totalColumns){return instance.getSetting("columnWidth",source_c)}};if(stretchH==="hybrid"){if(offsetColumn>0){stretchH="last"}else{stretchH="none"}}var containerHeightFn=function(cacheHeight){if(that.instance.getSetting("nativeScrollbars")){return 2*that.instance.wtViewport.getViewportHeight(cacheHeight)}return that.instance.wtViewport.getViewportHeight(cacheHeight)};var rowHeightFn=function(i,TD){if(that.instance.getSetting("nativeScrollbars")){return 20}var source_r=that.rowFilter.visibleToSource(i);if(source_r<totalRows){if(that.verticalRenderReverse&&i===0){return that.instance.getSetting("rowHeight",source_r,TD)-1}else{return that.instance.getSetting("rowHeight",source_r,TD)}}};this.columnStrategy=new WalkontableColumnStrategy(containerWidthFn,columnWidthFn,stretchH);this.rowStrategy=new WalkontableRowStrategy(containerHeightFn,rowHeightFn)};WalkontableTable.prototype.adjustAvailableNodes=function(){var displayTds,rowHeaders=this.instance.getSetting("rowHeaders"),displayThs=rowHeaders.length,columnHeaders=this.instance.getSetting("columnHeaders"),TR,TD,c;while(this.colgroupChildrenLength<displayThs){this.COLGROUP.appendChild(document.createElement("COL"));this.colgroupChildrenLength++}this.refreshStretching();if(this.instance.cloneFrom&&(this.instance.cloneDirection==="left"||this.instance.cloneDirection==="corner")){this.columnStrategy.cellCount=0}displayTds=this.columnStrategy.cellCount;while(this.colgroupChildrenLength<displayTds+displayThs){this.COLGROUP.appendChild(document.createElement("COL"));this.colgroupChildrenLength++}while(this.colgroupChildrenLength>displayTds+displayThs){this.COLGROUP.removeChild(this.COLGROUP.lastChild);this.colgroupChildrenLength--}TR=this.THEAD.firstChild;if(columnHeaders.length){if(!TR){TR=document.createElement("TR");this.THEAD.appendChild(TR)}this.theadChildrenLength=TR.childNodes.length;while(this.theadChildrenLength<displayTds+displayThs){TR.appendChild(document.createElement("TH"));this.theadChildrenLength++}while(this.theadChildrenLength>displayTds+displayThs){TR.removeChild(TR.lastChild);this.theadChildrenLength--}}else{if(TR){this.wtDom.empty(TR)}}for(c=0;c<this.colgroupChildrenLength;c++){if(c<displayThs){this.wtDom.addClass(this.COLGROUP.childNodes[c],"rowHeader")}else{this.wtDom.removeClass(this.COLGROUP.childNodes[c],"rowHeader")}}if(columnHeaders.length){TR=this.THEAD.firstChild;if(displayThs){TD=TR.firstChild;for(c=0;c<displayThs;c++){rowHeaders[c](-displayThs+c,TD);TD=TD.nextSibling}}}for(c=0;c<displayTds;c++){if(columnHeaders.length){columnHeaders[0](this.columnFilter.visibleToSource(c),TR.childNodes[displayThs+c])}}};WalkontableTable.prototype.adjustColumns=function(TR,desiredCount){var count=TR.childNodes.length;while(count<desiredCount){var TD=document.createElement("TD");TR.appendChild(TD);count++}while(count>desiredCount){TR.removeChild(TR.lastChild);count--}};WalkontableTable.prototype.draw=function(selectionsOnly){if(this.instance.getSetting("nativeScrollbars")){this.verticalRenderReverse=false}this.rowFilter.readSettings(this.instance);this.columnFilter.readSettings(this.instance);if(!selectionsOnly){if(this.instance.getSetting("nativeScrollbars")){if(this.instance.cloneFrom){this.tableOffset=this.instance.cloneFrom.wtTable.tableOffset}else{this.holderOffset=this.wtDom.offset(this.holder);this.tableOffset=this.wtDom.offset(this.TABLE);this.instance.wtScrollbars.vertical.readWindowSize();this.instance.wtScrollbars.horizontal.readWindowSize();this.instance.wtViewport.resetSettings()}}else{this.tableOffset=this.wtDom.offset(this.TABLE);this.instance.wtViewport.resetSettings()}this._doDraw()}else{this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(true)}this.refreshPositions(selectionsOnly);this.instance.drawn=true;return this};WalkontableTable.prototype._doDraw=function(){var r=0,source_r,c,source_c,offsetRow=this.instance.getSetting("offsetRow"),totalRows=this.instance.getSetting("totalRows"),totalColumns=this.instance.getSetting("totalColumns"),displayTds,rowHeaders=this.instance.getSetting("rowHeaders"),displayThs=rowHeaders.length,TR,TD,TH,adjusted=false,workspaceWidth,mustBeInViewport,res;if(this.verticalRenderReverse){mustBeInViewport=offsetRow}var noPartial=false;if(this.verticalRenderReverse){if(offsetRow===totalRows-this.rowFilter.fixedCount-1){noPartial=true}else{this.instance.update("offsetRow",offsetRow+1);this.rowFilter.readSettings(this.instance)}}if(totalColumns>0){source_r=this.rowFilter.visibleToSource(r);var first=true;var fixedRowsTop=this.instance.getSetting("fixedRowsTop");while(source_r<totalRows&&source_r>=0){if(r>1000){throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.")}if(this.instance.cloneFrom&&(this.instance.cloneDirection==="top"||this.instance.cloneDirection==="corner")&&r===fixedRowsTop){break}if(r>=this.tbodyChildrenLength||(this.verticalRenderReverse&&r>=this.rowFilter.fixedCount)){TR=document.createElement("TR");for(c=0;c<displayThs;c++){TR.appendChild(document.createElement("TH"))}if(this.verticalRenderReverse&&r>=this.rowFilter.fixedCount){this.TBODY.insertBefore(TR,this.TBODY.childNodes[this.rowFilter.fixedCount]||this.TBODY.firstChild)}else{this.TBODY.appendChild(TR)}this.tbodyChildrenLength++}else{if(r===0){TR=this.TBODY.firstChild}else{TR=TR.nextSibling}}TH=TR.firstChild;for(c=0;c<displayThs;c++){if(TH.nodeName=="TD"){TD=TH;TH=document.createElement("TH");TR.insertBefore(TH,TD);TR.removeChild(TD)}rowHeaders[c](source_r,TH);TH=TH.nextSibling}if(first){first=false;this.adjustAvailableNodes();adjusted=true;displayTds=this.columnStrategy.cellCount;this.adjustColumns(TR,displayTds+displayThs);workspaceWidth=this.instance.wtViewport.getWorkspaceWidth();this.columnStrategy.stretch();for(c=0;c<displayTds;c++){this.COLGROUP.childNodes[c+displayThs].style.width=this.columnStrategy.getSize(c)+"px"}}else{this.adjustColumns(TR,displayTds+displayThs)}for(c=0;c<displayTds;c++){source_c=this.columnFilter.visibleToSource(c);if(c===0){TD=TR.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(source_c)]}else{TD=TD.nextSibling}if(TD.nodeName=="TH"){TH=TD;TD=document.createElement("TD");TR.insertBefore(TD,TH);TR.removeChild(TH)}TD.className="";TD.removeAttribute("style");this.instance.getSetting("cellRenderer",source_r,source_c,TD)}offsetRow=this.instance.getSetting("offsetRow");if(this.verticalRenderReverse&&noPartial){if(-this.wtDom.outerHeight(TR.firstChild)<this.rowStrategy.remainingSize){this.TBODY.removeChild(TR);this.instance.update("offsetRow",offsetRow+1);this.tbodyChildrenLength--;this.rowFilter.readSettings(this.instance);break}else{res=this.rowStrategy.add(r,TD,this.verticalRenderReverse);if(res===false){this.rowStrategy.removeOutstanding()}}}else{res=this.rowStrategy.add(r,TD,this.verticalRenderReverse);if(res===false){if(!this.instance.getSetting("nativeScrollbars")){this.rowStrategy.removeOutstanding()}}if(this.rowStrategy.isLastIncomplete()){if(this.verticalRenderReverse&&!this.isRowInViewport(mustBeInViewport)){this.verticalRenderReverse=false;this.instance.update("offsetRow",mustBeInViewport);this.draw();return}break}}if(this.verticalRenderReverse&&r>=this.rowFilter.fixedCount){if(offsetRow===0){break}this.instance.update("offsetRow",offsetRow-1);this.rowFilter.readSettings(this.instance)}else{r++}source_r=this.rowFilter.visibleToSource(r)}}if(!adjusted){this.adjustAvailableNodes()}r=this.rowStrategy.countVisible();while(this.tbodyChildrenLength>r){this.TBODY.removeChild(this.TBODY.lastChild);this.tbodyChildrenLength--}this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(false);if(workspaceWidth!==this.instance.wtViewport.getWorkspaceWidth()){this.columnStrategy.stretch();for(c=0;c<this.columnStrategy.cellCount;c++){this.COLGROUP.childNodes[c+displayThs].style.width=this.columnStrategy.getSize(c)+"px"}}this.verticalRenderReverse=false};WalkontableTable.prototype.refreshPositions=function(selectionsOnly){this.refreshHiderDimensions();this.refreshSelections(selectionsOnly)};WalkontableTable.prototype.refreshSelections=function(selectionsOnly){var vr,r,vc,c,s,slen,classNames=[],visibleRows=this.rowStrategy.countVisible(),visibleColumns=this.columnStrategy.countVisible();this.oldCellCache=this.currentCellCache;this.currentCellCache=new WalkontableClassNameCache();if(this.instance.selections){for(r in this.instance.selections){if(this.instance.selections.hasOwnProperty(r)){this.instance.selections[r].draw();if(this.instance.selections[r].settings.className){classNames.push(this.instance.selections[r].settings.className)}if(this.instance.selections[r].settings.highlightRowClassName){classNames.push(this.instance.selections[r].settings.highlightRowClassName)}if(this.instance.selections[r].settings.highlightColumnClassName){classNames.push(this.instance.selections[r].settings.highlightColumnClassName)}}}}slen=classNames.length;for(vr=0;vr<visibleRows;vr++){for(vc=0;vc<visibleColumns;vc++){r=this.rowFilter.visibleToSource(vr);c=this.columnFilter.visibleToSource(vc);for(s=0;s<slen;s++){if(this.currentCellCache.test(vr,vc,classNames[s])){this.wtDom.addClass(this.getCell([r,c]),classNames[s])}else{if(selectionsOnly&&this.oldCellCache.test(vr,vc,classNames[s])){this.wtDom.removeClass(this.getCell([r,c]),classNames[s])}}}}}};WalkontableTable.prototype.getCell=function(coords){if(this.isRowBeforeViewport(coords[0])){return -1}else{if(this.isRowAfterViewport(coords[0])){return -2}else{if(this.isColumnBeforeViewport(coords[1])){return -3}else{if(this.isColumnAfterViewport(coords[1])){return -4}else{return this.TBODY.childNodes[this.rowFilter.sourceToVisible(coords[0])].childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(coords[1])]}}}}};WalkontableTable.prototype.getCoords=function(TD){return[this.rowFilter.visibleToSource(this.wtDom.index(TD.parentNode)),this.columnFilter.visibleRowHeadedColumnToSourceColumn(TD.cellIndex)]};WalkontableTable.prototype.getLastVisibleRow=function(){return this.rowFilter.visibleToSource(this.rowStrategy.cellCount-1)};WalkontableTable.prototype.getLastVisibleColumn=function(){return this.columnFilter.visibleToSource(this.columnStrategy.cellCount-1)};WalkontableTable.prototype.isRowBeforeViewport=function(r){return(this.rowFilter.sourceToVisible(r)<this.rowFilter.fixedCount&&r>=this.rowFilter.fixedCount)};WalkontableTable.prototype.isRowAfterViewport=function(r){return(r>this.getLastVisibleRow())};WalkontableTable.prototype.isColumnBeforeViewport=function(c){return(this.columnFilter.sourceToVisible(c)<this.columnFilter.fixedCount&&c>=this.columnFilter.fixedCount)};WalkontableTable.prototype.isColumnAfterViewport=function(c){return(c>this.getLastVisibleColumn())};WalkontableTable.prototype.isRowInViewport=function(r){return(!this.isRowBeforeViewport(r)&&!this.isRowAfterViewport(r))};WalkontableTable.prototype.isColumnInViewport=function(c){return(!this.isColumnBeforeViewport(c)&&!this.isColumnAfterViewport(c))};WalkontableTable.prototype.isLastRowFullyVisible=function(){return(this.getLastVisibleRow()===this.instance.getSetting("totalRows")-1&&!this.rowStrategy.isLastIncomplete())};WalkontableTable.prototype.isLastColumnFullyVisible=function(){return(this.getLastVisibleColumn()===this.instance.getSetting("totalColumns")-1&&!this.columnStrategy.isLastIncomplete())};function WalkontableViewport(instance){this.instance=instance;this.resetSettings();if(this.instance.getSetting("nativeScrollbars")){var that=this;$(window).on("resize",function(){that.clientHeight=that.getWorkspaceHeight()})}}WalkontableViewport.prototype.getWorkspaceHeight=function(proposedHeight){if(this.instance.getSetting("nativeScrollbars")){return this.instance.wtScrollbars.vertical.windowSize}var height=this.instance.getSetting("height");if(height===Infinity||height===void 0||height===null||height<1){if(this.instance.wtScrollbars.vertical instanceof WalkontableScrollbarNative){height=this.instance.wtScrollbars.vertical.availableSize()}else{height=Infinity}}if(height!==Infinity){if(proposedHeight>=height){height-=this.instance.getSetting("scrollbarHeight")}else{if(this.instance.wtScrollbars.horizontal.visible){height-=this.instance.getSetting("scrollbarHeight")}}}return height};WalkontableViewport.prototype.getWorkspaceWidth=function(proposedWidth){var width=this.instance.getSetting("width");if(width===Infinity||width===void 0||width===null||width<1){if(this.instance.wtScrollbars.horizontal instanceof WalkontableScrollbarNative){width=this.instance.wtScrollbars.horizontal.availableSize()}else{width=Infinity}}if(width!==Infinity){if(proposedWidth>=width){width-=this.instance.getSetting("scrollbarWidth")}else{if(this.instance.wtScrollbars.vertical.visible){width-=this.instance.getSetting("scrollbarWidth")}}}return width};WalkontableViewport.prototype.getWorkspaceActualHeight=function(){return this.instance.wtDom.outerHeight(this.instance.wtTable.TABLE)};WalkontableViewport.prototype.getWorkspaceActualWidth=function(){return this.instance.wtDom.outerWidth(this.instance.wtTable.TABLE)||this.instance.wtDom.outerWidth(this.instance.wtTable.TBODY)||this.instance.wtDom.outerWidth(this.instance.wtTable.THEAD)};WalkontableViewport.prototype.getColumnHeaderHeight=function(){if(isNaN(this.columnHeaderHeight)){var cellOffset=this.instance.wtDom.offset(this.instance.wtTable.TBODY),tableOffset=this.instance.wtTable.tableOffset;this.columnHeaderHeight=cellOffset.top-tableOffset.top}return this.columnHeaderHeight};WalkontableViewport.prototype.getViewportHeight=function(proposedHeight){var containerHeight=this.getWorkspaceHeight(proposedHeight);if(containerHeight===Infinity){return containerHeight}var columnHeaderHeight=this.getColumnHeaderHeight();if(columnHeaderHeight>0){return containerHeight-columnHeaderHeight}else{return containerHeight}};WalkontableViewport.prototype.getRowHeaderHeight=function(){if(this.instance.cloneFrom){return this.instance.cloneFrom.wtViewport.getRowHeaderHeight()}if(isNaN(this.rowHeaderWidth)){var TR=this.instance.wtTable.TBODY?this.instance.wtTable.TBODY.firstChild:null;if(TR){var TD=TR.firstChild;this.rowHeaderWidth=0;while(TD&&TD.nodeName==="TH"){this.rowHeaderWidth+=this.instance.wtDom.outerWidth(TD);TD=TD.nextSibling}}}return this.rowHeaderWidth};WalkontableViewport.prototype.getViewportWidth=function(proposedWidth){var containerWidth=this.getWorkspaceWidth(proposedWidth);if(containerWidth===Infinity){return containerWidth}var rowHeaderWidth=this.getRowHeaderHeight();if(rowHeaderWidth>0){return containerWidth-rowHeaderWidth}else{return containerWidth}};WalkontableViewport.prototype.resetSettings=function(){this.rowHeaderWidth=NaN;this.columnHeaderHeight=NaN};function WalkontableWheel(instance){if(instance.getSetting("nativeScrollbars")){return}$(instance.wtTable.spreader).on("mousewheel",function(event,delta,deltaX,deltaY){if(!deltaX&&!deltaY&&delta){deltaY=delta}if(!deltaX&&!deltaY){return}if(deltaY>0&&instance.getSetting("offsetRow")===0){return}else{if(deltaY<0&&instance.wtTable.isLastRowFullyVisible()){return}else{if(deltaX<0&&instance.getSetting("offsetColumn")===0){return}else{if(deltaX>0&&instance.wtTable.isLastColumnFullyVisible()){return}}}}clearTimeout(instance.wheelTimeout);instance.wheelTimeout=setTimeout(function(){if(deltaY){if(instance.wtScrollbars.vertical.visible){instance.scrollVertical(-Math.ceil(deltaY)).draw()}}else{if(deltaX){if(instance.wtScrollbars.horizontal.visible){instance.scrollHorizontal(Math.ceil(deltaX)).draw()}}}},0);event.preventDefault()})}var Cursor={x:0,y:0,init:function(){this.setEvent("mouse");this.setEvent("touch")},setEvent:function(type){var moveHandler=document["on"+type+"move"]||function(){};document["on"+type+"move"]=function(e){moveHandler(e);Cursor.refresh(e)}},refresh:function(e){if(!e){e=window.event}if(e.type=="mousemove"){this.set(e)}else{if(e.touches){this.set(e.touches[0])}}},set:function(e){if(e.pageX||e.pageY){this.x=e.pageX;this.y=e.pageY}else{if(e.clientX||e.clientY){this.x=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;this.y=e.clientY+document.body.scrollTop+document.documentElement.scrollTop}}}};Cursor.init();var Position={get:function(obj){var curtop=0,curleft=0;if(obj.offsetParent){do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop}while((obj=obj.offsetParent))}return[curleft,curtop]}};var Dragdealer=function(wrapper,options){if(typeof(wrapper)=="string"){wrapper=document.getElementById(wrapper)}if(!wrapper){return}var handle=wrapper.getElementsByTagName("div")[0];if(!handle||handle.className.search(/(^|\s)handle(\s|$)/)==-1){return}this.init(wrapper,handle,options||{});this.setup()};Dragdealer.prototype={init:function(wrapper,handle,options){this.wrapper=wrapper;this.handle=handle;this.options=options;this.disabled=this.getOption("disabled",false);this.horizontal=this.getOption("horizontal",true);this.vertical=this.getOption("vertical",false);this.slide=this.getOption("slide",true);this.steps=this.getOption("steps",0);this.snap=this.getOption("snap",false);this.loose=this.getOption("loose",false);this.speed=this.getOption("speed",10)/100;this.xPrecision=this.getOption("xPrecision",0);this.yPrecision=this.getOption("yPrecision",0);this.callback=options.callback||null;this.animationCallback=options.animationCallback||null;this.bounds={left:options.left||0,right:-(options.right||0),top:options.top||0,bottom:-(options.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0};this.value={prev:[-1,-1],current:[options.x||0,options.y||0],target:[options.x||0,options.y||0]};this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]};this.change=[0,0];this.activity=false;this.dragging=false;this.tapping=false},getOption:function(name,defaultValue){return this.options[name]!==undefined?this.options[name]:defaultValue},setup:function(){this.setWrapperOffset();this.setBoundsPadding();this.setBounds();this.setSteps();this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=Position.get(this.wrapper)},setBoundsPadding:function(){if(!this.bounds.left&&!this.bounds.right){this.bounds.left=Position.get(this.handle)[0]-this.offset.wrapper[0];this.bounds.right=-this.bounds.left}if(!this.bounds.top&&!this.bounds.bottom){this.bounds.top=Position.get(this.handle)[1]-this.offset.wrapper[1];this.bounds.bottom=-this.bounds.top}},setBounds:function(){this.bounds.x0=this.bounds.left;this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right;this.bounds.xRange=(this.bounds.x1-this.bounds.x0)-this.handle.offsetWidth;this.bounds.y0=this.bounds.top;this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom;this.bounds.yRange=(this.bounds.y1-this.bounds.y0)-this.handle.offsetHeight;this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth));this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var i=0;i<=this.steps-1;i++){this.stepRatios[i]=i/(this.steps-1)}}},addListeners:function(){var self=this;this.wrapper.onselectstart=function(){return false};this.handle.onmousedown=this.handle.ontouchstart=function(e){self.handleDownHandler(e)};this.wrapper.onmousedown=this.wrapper.ontouchstart=function(e){self.wrapperDownHandler(e)};var mouseUpHandler=document.onmouseup||function(){};document.onmouseup=function(e){mouseUpHandler(e);self.documentUpHandler(e)};var touchEndHandler=document.ontouchend||function(){};document.ontouchend=function(e){touchEndHandler(e);self.documentUpHandler(e)};var resizeHandler=window.onresize||function(){};window.onresize=function(e){resizeHandler(e);self.documentResizeHandler(e)};this.wrapper.onmousemove=function(e){self.activity=true};this.wrapper.onclick=function(e){return !self.activity};this.interval=setInterval(function(){self.animate()},25);self.animate(false,true)},handleDownHandler:function(e){this.activity=false;Cursor.refresh(e);this.preventDefaults(e,true);this.startDrag()},wrapperDownHandler:function(e){Cursor.refresh(e);this.preventDefaults(e,true);this.startTap()},documentUpHandler:function(e){this.stopDrag();this.stopTap()},documentResizeHandler:function(e){this.setWrapperOffset();this.setBounds();this.update()},enable:function(){this.disabled=false;this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=true;this.handle.className+=" disabled"},setStep:function(x,y,snap){this.setValue(this.steps&&x>1?(x-1)/(this.steps-1):0,this.steps&&y>1?(y-1)/(this.steps-1):0,snap)},setValue:function(x,y,snap){this.setTargetValue([x,y||0]);if(snap){this.groupCopy(this.value.current,this.value.target)}},startTap:function(target){if(this.disabled){return}this.tapping=true;this.setWrapperOffset();this.setBounds();if(target===undefined){target=[Cursor.x-this.offset.wrapper[0]-(this.handle.offsetWidth/2),Cursor.y-this.offset.wrapper[1]-(this.handle.offsetHeight/2)]}this.setTargetOffset(target)},stopTap:function(){if(this.disabled||!this.tapping){return}this.tapping=false;this.setTargetValue(this.value.current);this.result()},startDrag:function(){if(this.disabled){return}this.setWrapperOffset();this.setBounds();this.offset.mouse=[Cursor.x-Position.get(this.handle)[0],Cursor.y-Position.get(this.handle)[1]];this.dragging=true},stopDrag:function(){if(this.disabled||!this.dragging){return}this.dragging=false;var target=this.groupClone(this.value.current);if(this.slide){var ratioChange=this.change;target[0]+=ratioChange[0]*4;target[1]+=ratioChange[1]*4}this.setTargetValue(target);this.result()},feedback:function(){var value=this.value.current;if(this.snap&&this.steps>1){value=this.getClosestSteps(value)}if(!this.groupCompare(value,this.value.prev)){if(typeof(this.animationCallback)=="function"){this.animationCallback(value[0],value[1])}this.groupCopy(this.value.prev,value)}},result:function(){if(typeof(this.callback)=="function"){this.callback(this.value.target[0],this.value.target[1])}},animate:function(direct,first){if(direct&&!this.dragging){return}if(this.dragging){var prevTarget=this.groupClone(this.value.target);var offset=[Cursor.x-this.offset.wrapper[0]-this.offset.mouse[0],Cursor.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(offset,this.loose);this.change=[this.value.target[0]-prevTarget[0],this.value.target[1]-prevTarget[1]]}if(this.dragging||first){this.groupCopy(this.value.current,this.value.target)}if(this.dragging||this.glide()||first){this.update();this.feedback()}},glide:function(){var diff=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];if(!diff[0]&&!diff[1]){return false}if(Math.abs(diff[0])>this.bounds.xStep||Math.abs(diff[1])>this.bounds.yStep){this.value.current[0]+=diff[0]*this.speed;this.value.current[1]+=diff[1]*this.speed}else{this.groupCopy(this.value.current,this.value.target)}return true},update:function(){if(!this.snap){this.offset.current=this.getOffsetsByRatios(this.value.current)}else{this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current))}this.show()},show:function(){if(!this.groupCompare(this.offset.current,this.offset.prev)){if(this.horizontal){this.handle.style.left=String(this.offset.current[0])+"px"}if(this.vertical){this.handle.style.top=String(this.offset.current[1])+"px"}this.groupCopy(this.offset.prev,this.offset.current)}},setTargetValue:function(value,loose){var target=loose?this.getLooseValue(value):this.getProperValue(value);this.groupCopy(this.value.target,target);this.offset.target=this.getOffsetsByRatios(target)},setTargetOffset:function(offset,loose){var value=this.getRatiosByOffsets(offset);var target=loose?this.getLooseValue(value):this.getProperValue(value);this.groupCopy(this.value.target,target);this.offset.target=this.getOffsetsByRatios(target)},getLooseValue:function(value){var proper=this.getProperValue(value);return[proper[0]+((value[0]-proper[0])/4),proper[1]+((value[1]-proper[1])/4)]},getProperValue:function(value){var proper=this.groupClone(value);proper[0]=Math.max(proper[0],0);proper[1]=Math.max(proper[1],0);proper[0]=Math.min(proper[0],1);proper[1]=Math.min(proper[1],1);if((!this.dragging&&!this.tapping)||this.snap){if(this.steps>1){proper=this.getClosestSteps(proper)}}return proper},getRatiosByOffsets:function(group){return[this.getRatioByOffset(group[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(group[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(offset,range,padding){return range?(offset-padding)/range:0},getOffsetsByRatios:function(group){return[this.getOffsetByRatio(group[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(group[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(ratio,range,padding){return Math.round(ratio*range)+padding},getClosestSteps:function(group){return[this.getClosestStep(group[0]),this.getClosestStep(group[1])]},getClosestStep:function(value){var k=0;var min=1;for(var i=0;i<=this.steps-1;i++){if(Math.abs(this.stepRatios[i]-value)<min){min=Math.abs(this.stepRatios[i]-value);k=i}}return this.stepRatios[k]},groupCompare:function(a,b){return a[0]==b[0]&&a[1]==b[1]},groupCopy:function(a,b){a[0]=b[0];a[1]=b[1]},groupClone:function(a){return[a[0],a[1]]},preventDefaults:function(e,selection){if(!e){e=window.event}if(e.preventDefault){e.preventDefault()}e.returnValue=false;if(selection&&document.selection){document.selection.empty()}},cancelEvent:function(e){if(!e){e=window.event}if(e.stopPropagation){e.stopPropagation()}e.cancelBubble=true}};
/*! Copyright (c) 2013 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.1.3
 *
 * Requires: 1.2.2+
 */
(function(factory){if(typeof define==="function"&&define.amd){define(["jquery"],factory)}else{if(typeof exports==="object"){module.exports=factory}else{factory(jQuery)}}}(function($){var toFix=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"];var toBind="onwheel" in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];var lowestDelta,lowestDeltaXY;if($.event.fixHooks){for(var i=toFix.length;i;){$.event.fixHooks[toFix[--i]]=$.event.mouseHooks}}$.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var i=toBind.length;i;){this.addEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=handler}},teardown:function(){if(this.removeEventListener){for(var i=toBind.length;i;){this.removeEventListener(toBind[--i],handler,false)}}else{this.onmousewheel=null}}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}});function handler(event){var orgEvent=event||window.event,args=[].slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,absDeltaXY=0,fn;event=$.event.fix(orgEvent);event.type="mousewheel";if(orgEvent.wheelDelta){delta=orgEvent.wheelDelta}if(orgEvent.detail){delta=orgEvent.detail*-1}if(orgEvent.deltaY){deltaY=orgEvent.deltaY*-1;delta=deltaY}if(orgEvent.deltaX){deltaX=orgEvent.deltaX;delta=deltaX*-1}if(orgEvent.wheelDeltaY!==undefined){deltaY=orgEvent.wheelDeltaY}if(orgEvent.wheelDeltaX!==undefined){deltaX=orgEvent.wheelDeltaX*-1}absDelta=Math.abs(delta);if(!lowestDelta||absDelta<lowestDelta){lowestDelta=absDelta}absDeltaXY=Math.max(Math.abs(deltaY),Math.abs(deltaX));if(!lowestDeltaXY||absDeltaXY<lowestDeltaXY){lowestDeltaXY=absDeltaXY}fn=delta>0?"floor":"ceil";delta=Math[fn](delta/lowestDelta);deltaX=Math[fn](deltaX/lowestDeltaXY);deltaY=Math[fn](deltaY/lowestDeltaXY);args.unshift(event,delta,deltaX,deltaY);return($.event.dispatch||$.event.handle).apply(this,args)}}));if(!Array.prototype.filter){Array.prototype.filter=function(fun,thisp){if(typeof this==="undefined"||this===null){throw new TypeError()}if(typeof fun!=="function"){throw new TypeError()}thisp=thisp||this;if(isNodeList(thisp)){thisp=convertNodeListToArray(thisp)}var len=thisp.length,res=[],i,val;for(i=0;i<len;i+=1){if(thisp.hasOwnProperty(i)){val=thisp[i];if(fun.call(thisp,val,i,thisp)){res.push(val)}}}return res;function isNodeList(object){return/NodeList/i.test(object.item)}function convertNodeListToArray(nodeList){var array=[];for(var i=0,len=nodeList.length;i<len;i++){array[i]=nodeList[i]}return array}}}})(jQuery,window,Handsontable);(function(){var numeral,VERSION="1.4.7",languages={},currentLanguage="en",zeroFormat=null,hasModule=(typeof module!=="undefined"&&module.exports);function Numeral(number){this._n=number}function toFixed(value,precision,optionals){var power=Math.pow(10,precision),output;output=(Math.round(value*power)/power).toFixed(precision);if(optionals){var optionalsRegExp=new RegExp("0{1,"+optionals+"}$");output=output.replace(optionalsRegExp,"")}return output}function formatNumeral(n,format){var output;if(format.indexOf("$")>-1){output=formatCurrency(n,format)}else{if(format.indexOf("%")>-1){output=formatPercentage(n,format)}else{if(format.indexOf(":")>-1){output=formatTime(n,format)}else{output=formatNumber(n,format)}}}return output}function unformatNumeral(n,string){if(string.indexOf(":")>-1){n._n=unformatTime(string)}else{if(string===zeroFormat){n._n=0}else{var stringOriginal=string;if(languages[currentLanguage].delimiters.decimal!=="."){string=string.replace(/\./g,"").replace(languages[currentLanguage].delimiters.decimal,".")}var thousandRegExp=new RegExp(languages[currentLanguage].abbreviations.thousand+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$"),millionRegExp=new RegExp(languages[currentLanguage].abbreviations.million+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$"),billionRegExp=new RegExp(languages[currentLanguage].abbreviations.billion+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$"),trillionRegExp=new RegExp(languages[currentLanguage].abbreviations.trillion+"(?:\\)|(\\"+languages[currentLanguage].currency.symbol+")?(?:\\))?)?$");var prefixes=["KB","MB","GB","TB","PB","EB","ZB","YB"],bytesMultiplier=false;for(var power=0;power<=prefixes.length;power++){bytesMultiplier=(string.indexOf(prefixes[power])>-1)?Math.pow(1024,power+1):false;if(bytesMultiplier){break}}n._n=((bytesMultiplier)?bytesMultiplier:1)*((stringOriginal.match(thousandRegExp))?Math.pow(10,3):1)*((stringOriginal.match(millionRegExp))?Math.pow(10,6):1)*((stringOriginal.match(billionRegExp))?Math.pow(10,9):1)*((stringOriginal.match(trillionRegExp))?Math.pow(10,12):1)*((string.indexOf("%")>-1)?0.01:1)*Number(((string.indexOf("(")>-1)?"-":"")+string.replace(/[^0-9\.-]+/g,""));n._n=(bytesMultiplier)?Math.ceil(n._n):n._n}}return n._n}function formatCurrency(n,format){var prependSymbol=(format.indexOf("$")<=1)?true:false;var space="";if(format.indexOf(" $")>-1){space=" ";format=format.replace(" $","")}else{if(format.indexOf("$ ")>-1){space=" ";format=format.replace("$ ","")}else{format=format.replace("$","")}}var output=formatNumeral(n,format);if(prependSymbol){if(output.indexOf("(")>-1||output.indexOf("-")>-1){output=output.split("");output.splice(1,0,languages[currentLanguage].currency.symbol+space);output=output.join("")}else{output=languages[currentLanguage].currency.symbol+space+output}}else{if(output.indexOf(")")>-1){output=output.split("");output.splice(-1,0,space+languages[currentLanguage].currency.symbol);output=output.join("")}else{output=output+space+languages[currentLanguage].currency.symbol}}return output}function formatPercentage(n,format){var space="";if(format.indexOf(" %")>-1){space=" ";format=format.replace(" %","")}else{format=format.replace("%","")}n._n=n._n*100;var output=formatNumeral(n,format);if(output.indexOf(")")>-1){output=output.split("");output.splice(-1,0,space+"%");output=output.join("")}else{output=output+space+"%"}return output}function formatTime(n,format){var hours=Math.floor(n._n/60/60),minutes=Math.floor((n._n-(hours*60*60))/60),seconds=Math.round(n._n-(hours*60*60)-(minutes*60));return hours+":"+((minutes<10)?"0"+minutes:minutes)+":"+((seconds<10)?"0"+seconds:seconds)}function unformatTime(string){var timeArray=string.split(":"),seconds=0;if(timeArray.length===3){seconds=seconds+(Number(timeArray[0])*60*60);seconds=seconds+(Number(timeArray[1])*60);seconds=seconds+Number(timeArray[2])}else{if(timeArray.lenght===2){seconds=seconds+(Number(timeArray[0])*60);seconds=seconds+Number(timeArray[1])}}return Number(seconds)}function formatNumber(n,format){var negP=false,optDec=false,abbr="",bytes="",ord="",abs=Math.abs(n._n);if(n._n===0&&zeroFormat!==null){return zeroFormat}else{if(format.indexOf("(")>-1){negP=true;format=format.slice(1,-1)}if(format.indexOf("a")>-1){if(format.indexOf(" a")>-1){abbr=" ";format=format.replace(" a","")}else{format=format.replace("a","")}if(abs>=Math.pow(10,12)){abbr=abbr+languages[currentLanguage].abbreviations.trillion;n._n=n._n/Math.pow(10,12)}else{if(abs<Math.pow(10,12)&&abs>=Math.pow(10,9)){abbr=abbr+languages[currentLanguage].abbreviations.billion;n._n=n._n/Math.pow(10,9)}else{if(abs<Math.pow(10,9)&&abs>=Math.pow(10,6)){abbr=abbr+languages[currentLanguage].abbreviations.million;n._n=n._n/Math.pow(10,6)}else{if(abs<Math.pow(10,6)&&abs>=Math.pow(10,3)){abbr=abbr+languages[currentLanguage].abbreviations.thousand;n._n=n._n/Math.pow(10,3)}}}}}if(format.indexOf("b")>-1){if(format.indexOf(" b")>-1){bytes=" ";format=format.replace(" b","")}else{format=format.replace("b","")}var prefixes=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],min,max;for(var power=0;power<=prefixes.length;power++){min=Math.pow(1024,power);max=Math.pow(1024,power+1);if(n._n>=min&&n._n<max){bytes=bytes+prefixes[power];if(min>0){n._n=n._n/min}break}}}if(format.indexOf("o")>-1){if(format.indexOf(" o")>-1){ord=" ";format=format.replace(" o","")}else{format=format.replace("o","")}ord=ord+languages[currentLanguage].ordinal(n._n)}if(format.indexOf("[.]")>-1){optDec=true;format=format.replace("[.]",".")}var w=n._n.toString().split(".")[0],precision=format.split(".")[1],thousands=format.indexOf(","),d="",neg=false;if(precision){if(precision.indexOf("[")>-1){precision=precision.replace("]","");precision=precision.split("[");d=toFixed(n._n,(precision[0].length+precision[1].length),precision[1].length)}else{d=toFixed(n._n,precision.length)}w=d.split(".")[0];if(d.split(".")[1].length){d=languages[currentLanguage].delimiters.decimal+d.split(".")[1]}else{d=""}if(optDec&&Number(d)===0){d=""}}else{w=toFixed(n._n,null)}if(w.indexOf("-")>-1){w=w.slice(1);neg=true}if(thousands>-1){w=w.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+languages[currentLanguage].delimiters.thousands)}if(format.indexOf(".")===0){w=""}return((negP&&neg)?"(":"")+((!negP&&neg)?"-":"")+w+d+((ord)?ord:"")+((abbr)?abbr:"")+((bytes)?bytes:"")+((negP&&neg)?")":"")}}numeral=function(input){if(numeral.isNumeral(input)){input=input.value()}else{if(!Number(input)){input=0}}return new Numeral(Number(input))};numeral.version=VERSION;numeral.isNumeral=function(obj){return obj instanceof Numeral};numeral.language=function(key,values){if(!key){return currentLanguage}if(key&&!values){currentLanguage=key}if(values||!languages[key]){loadLanguage(key,values)}return numeral};numeral.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(number){var b=number%10;return(~~(number%100/10)===1)?"th":(b===1)?"st":(b===2)?"nd":(b===3)?"rd":"th"},currency:{symbol:"$"}});numeral.zeroFormat=function(format){if(typeof(format)==="string"){zeroFormat=format}else{zeroFormat=null}};function loadLanguage(key,values){languages[key]=values}numeral.fn=Numeral.prototype={clone:function(){return numeral(this)},format:function(inputString){return formatNumeral(this,inputString?inputString:numeral.defaultFormat)},unformat:function(inputString){return unformatNumeral(this,inputString?inputString:numeral.defaultFormat)},value:function(){return this._n},valueOf:function(){return this._n},set:function(value){this._n=Number(value);return this},add:function(value){this._n=this._n+Number(value);return this},subtract:function(value){this._n=this._n-Number(value);return this},multiply:function(value){this._n=this._n*Number(value);return this},divide:function(value){this._n=this._n/Number(value);return this},difference:function(value){var difference=this._n-Number(value);if(difference<0){difference=-difference}return difference}};if(hasModule){module.exports=numeral}if(typeof ender==="undefined"){this["numeral"]=numeral}if(typeof define==="function"&&define.amd){define([],function(){return numeral})}}).call(this);
/*! jQuery UI - v1.10.3 - 2013-05-03
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.effect.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js, jquery.ui.menu.js, jquery.ui.position.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js
* Copyright 2013 jQuery Foundation and other contributors; Licensed MIT */
(function($,undefined){var uuid=0,runiqueId=/^ui-id-\d+$/;$.ui=$.ui||{};$.extend($.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});$.fn.extend({focus:(function(orig){return function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem)}},delay)}):orig.apply(this,arguments)}})($.fn.focus),scrollParent:function(){var scrollParent;if(($.ui.ie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){scrollParent=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test($.css(this,"position"))&&(/(auto|scroll)/).test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0)}else{scrollParent=this.parents().filter(function(){return(/(auto|scroll)/).test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0)}return(/fixed/).test(this.css("position"))||!scrollParent.length?$(document):scrollParent},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex)}if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value}}elem=elem.parent()}}return 0},uniqueId:function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++uuid)}})},removeUniqueId:function(){return this.each(function(){if(runiqueId.test(this.id)){$(this).removeAttr("id")}})}});function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return false}img=$("img[usemap=#"+mapName+"]")[0];return !!img&&visible(img)}return(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return $.css(this,"visibility")==="hidden"}).length}$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return !!$.data(elem,dataName)}}):function(elem,i,match){return !!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}});if(!$("<a>").outerWidth(1).jquery){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0}if(margin){size-=parseFloat($.css(elem,"margin"+this))||0}});return size}$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this)}return this.each(function(){$(this).css(type,reduce(this,size)+"px")})};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size)}return this.each(function(){$(this).css(type,reduce(this,size,true,margin)+"px")})}})}if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}}if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){$.fn.removeData=(function(removeData){return function(key){if(arguments.length){return removeData.call(this,$.camelCase(key))}else{return removeData.call(this)}}})($.fn.removeData)}$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.support.selectstart="onselectstart" in document.createElement("div");$.fn.extend({disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(event){event.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});$.extend($.ui,{plugin:{add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]])}},call:function(instance,name,args){var i,set=instance.plugins[name];if(!set||!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11){return}for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args)}}}},hasScroll:function(el,a){if($(el).css("overflow")==="hidden"){return false}var scroll=(a&&a==="left")?"scrollLeft":"scrollTop",has=false;if(el[scroll]>0){return true}el[scroll]=1;has=(el[scroll]>0);el[scroll]=0;return has}})})(jQuery);(function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){try{$(elem).triggerHandler("remove")}catch(e){}}_cleanData(elems)};$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget}$.expr[":"][fullName.toLowerCase()]=function(elem){return !!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element)}if(arguments.length){this._createWidget(options,element)}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return}proxiedPrototype[prop]=(function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}})()});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else{base._childConstructors.push(constructor)}$.widget.bridge(name,constructor)};$.widget.extend=function(target){var input=slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value)}else{target[key]=value}}}}return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; attempted to call method '"+options+"'")}if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance")}methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return false}})}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{})._init()}else{$.data(this,fullName,new object(options,this))}})}return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(true,this.element,{remove:function(event){if(event.target===element){this.destroy()}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}key=parts.pop();if(value===undefined){return curOption[key]===undefined?null:curOption[key]}curOption[key]=value}else{if(value===undefined){return this.options[key]===undefined?null:this.options[key]}options[key]=value}}this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}return this},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!value).attr("aria-disabled",value);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=false}if(!handlers){handlers=element;element=this.element;delegateElement=this.widget()}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element)}$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===true||$(this).hasClass("ui-state-disabled"))){return}return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++}var match=event.match(/^(\w+)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy)}else{element.bind(eventName,handlerProxy)}})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName)},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop]}}}this.element.trigger(event,data);return !($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===false||event.isDefaultPrevented())}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options}}var hasOptions,effectName=!options?method:options===true||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options}}hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options)}else{if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}next()})}}}})})(jQuery);(function($,undefined){var mouseHandled=false;$(document).mouseup(function(){mouseHandled=false});$.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event){return that._mouseDown(event)}).bind("click."+this.widgetName,function(event){if(true===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(event){if(mouseHandled){return}(this._mouseStarted&&this._mouseUp(event));this._mouseDownEvent=event;var that=this,btnIsLeft=(event.which===1),elIsCancel=(typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:false);if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(event)!==false);if(!this._mouseStarted){event.preventDefault();return true}}if(true===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(event){return that._mouseMove(event)};this._mouseUpDelegate=function(event){return that._mouseUp(event)};$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=true;return true},_mouseMove:function(event){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event)}if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault()}if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,event)!==false);(this._mouseStarted?this._mouseDrag(event):this._mouseUp(event))}return !this._mouseStarted},_mouseUp:function(event){$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(event)}return false},_mouseDistanceMet:function(event){return(Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance)},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);(function($,undefined){$.widget("ui.draggable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}if(this.options.addClasses){this.element.addClass("ui-draggable")}if(this.options.disabled){this.element.addClass("ui-draggable-disabled")}this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(event){var o=this.options;if(this.helper||o.disabled||$(event.target).closest(".ui-resizable-handle").length>0){return false}this.handle=this._getHandle(event);if(!this.handle){return false}$(o.iframeFix===true?"iframe":o.iframeFix).each(function(){$("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css($(this).offset()).appendTo("body")});return true},_mouseStart:function(event){var o=this.options;this.helper=this._createHelper(event);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if($.ui.ddmanager){$.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offsetParent=this.helper.offsetParent();this.offsetParentCssPosition=this.offsetParent.css("position");this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.offset.scroll=false;$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this._setContainment();if(this._trigger("start",event)===false){this._clear();return false}this._cacheHelperProportions();if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event)}this._mouseDrag(event,true);if($.ui.ddmanager){$.ui.ddmanager.dragStart(this,event)}return true},_mouseDrag:function(event,noPropagation){if(this.offsetParentCssPosition==="fixed"){this.offset.parent=this._getParentOffset()}this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!noPropagation){var ui=this._uiHash();if(this._trigger("drag",event,ui)===false){this._mouseUp({});return false}this.position=ui.position}if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}if($.ui.ddmanager){$.ui.ddmanager.drag(this,event)}return false},_mouseStop:function(event){var that=this,dropped=false;if($.ui.ddmanager&&!this.options.dropBehaviour){dropped=$.ui.ddmanager.drop(this,event)}if(this.dropped){dropped=this.dropped;this.dropped=false}if(this.options.helper==="original"&&!$.contains(this.element[0].ownerDocument,this.element[0])){return false}if((this.options.revert==="invalid"&&!dropped)||(this.options.revert==="valid"&&dropped)||this.options.revert===true||($.isFunction(this.options.revert)&&this.options.revert.call(this.element,dropped))){$(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(that._trigger("stop",event)!==false){that._clear()}})}else{if(this._trigger("stop",event)!==false){this._clear()}}return false},_mouseUp:function(event){$("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});if($.ui.ddmanager){$.ui.ddmanager.dragStop(this,event)}return $.ui.mouse.prototype._mouseUp.call(this,event)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(event){return this.options.handle?!!$(event.target).closest(this.element.find(this.options.handle)).length:true},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event])):(o.helper==="clone"?this.element.clone().removeAttr("id"):this.element);if(!helper.parents("body").length){helper.appendTo((o.appendTo==="parent"?this.element[0].parentNode:o.appendTo))}if(helper[0]!==this.element[0]&&!(/(fixed|absolute)/).test(helper.css("position"))){helper.css("position","absolute")}return helper},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ")}if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0}}if("left" in obj){this.offset.click.left=obj.left+this.margins.left}if("right" in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left}if("top" in obj){this.offset.click.top=obj.top+this.margins.top}if("bottom" in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top}},_getParentOffset:function(){var po=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]===document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){po={top:0,left:0}}return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var p=this.element.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var over,c,ce,o=this.options;if(!o.containment){this.containment=null;return}if(o.containment==="window"){this.containment=[$(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,$(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,$(window).scrollLeft()+$(window).width()-this.helperProportions.width-this.margins.left,$(window).scrollTop()+($(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(o.containment==="document"){this.containment=[0,0,$(document).width()-this.helperProportions.width-this.margins.left,($(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(o.containment.constructor===Array){this.containment=o.containment;return}if(o.containment==="parent"){o.containment=this.helper[0].parentNode}c=$(o.containment);ce=c[0];if(!ce){return}over=c.css("overflow")!=="hidden";this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=c},_convertPositionTo:function(d,pos){if(!pos){pos=this.position}var mod=d==="absolute"?1:-1,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent;if(!this.offset.scroll){this.offset.scroll={top:scroll.scrollTop(),left:scroll.scrollLeft()}}return{top:(pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)*mod)),left:(pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)*mod))}},_generatePosition:function(event){var containment,co,top,left,o=this.options,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,pageX=event.pageX,pageY=event.pageY;if(!this.offset.scroll){this.offset.scroll={top:scroll.scrollTop(),left:scroll.scrollLeft()}}if(this.originalPosition){if(this.containment){if(this.relative_container){co=this.relative_container.offset();containment=[this.containment[0]+co.left,this.containment[1]+co.top,this.containment[2]+co.left,this.containment[3]+co.top]}else{containment=this.containment}if(event.pageX-this.offset.click.left<containment[0]){pageX=containment[0]+this.offset.click.left}if(event.pageY-this.offset.click.top<containment[1]){pageY=containment[1]+this.offset.click.top}if(event.pageX-this.offset.click.left>containment[2]){pageX=containment[2]+this.offset.click.left}if(event.pageY-this.offset.click.top>containment[3]){pageY=containment[3]+this.offset.click.top}}if(o.grid){top=o.grid[1]?this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1]:this.originalPageY;pageY=containment?((top-this.offset.click.top>=containment[1]||top-this.offset.click.top>containment[3])?top:((top-this.offset.click.top>=containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=o.grid[0]?this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0]:this.originalPageX;pageX=containment?((left-this.offset.click.left>=containment[0]||left-this.offset.click.left>containment[2])?left:((left-this.offset.click.left>=containment[0])?left-o.grid[0]:left+o.grid[0])):left}}return{top:(pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)),left:(pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(type,event,ui){ui=ui||this._uiHash();$.ui.plugin.call(this,type,[event,ui]);if(type==="drag"){this.positionAbs=this._convertPositionTo("absolute")}return $.Widget.prototype._trigger.call(this,type,event,ui)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});$.ui.plugin.add("draggable","connectToSortable",{start:function(event,ui){var inst=$(this).data("ui-draggable"),o=inst.options,uiSortable=$.extend({},ui,{item:inst.element});inst.sortables=[];$(o.connectToSortable).each(function(){var sortable=$.data(this,"ui-sortable");if(sortable&&!sortable.options.disabled){inst.sortables.push({instance:sortable,shouldRevert:sortable.options.revert});sortable.refreshPositions();sortable._trigger("activate",event,uiSortable)}})},stop:function(event,ui){var inst=$(this).data("ui-draggable"),uiSortable=$.extend({},ui,{item:inst.element});$.each(inst.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;inst.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=this.shouldRevert}this.instance._mouseStop(event);this.instance.options.helper=this.instance.options._helper;if(inst.options.helper==="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",event,uiSortable)}})},drag:function(event,ui){var inst=$(this).data("ui-draggable"),that=this;$.each(inst.sortables,function(){var innermostIntersecting=false,thisSortable=this;this.instance.positionAbs=inst.positionAbs;this.instance.helperProportions=inst.helperProportions;this.instance.offset.click=inst.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){innermostIntersecting=true;$.each(inst.sortables,function(){this.instance.positionAbs=inst.positionAbs;this.instance.helperProportions=inst.helperProportions;this.instance.offset.click=inst.offset.click;if(this!==thisSortable&&this.instance._intersectsWith(this.instance.containerCache)&&$.contains(thisSortable.instance.element[0],this.instance.element[0])){innermostIntersecting=false}return innermostIntersecting})}if(innermostIntersecting){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=$(that).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return ui.helper[0]};event.target=this.instance.currentItem[0];this.instance._mouseCapture(event,true);this.instance._mouseStart(event,true,true);this.instance.offset.click.top=inst.offset.click.top;this.instance.offset.click.left=inst.offset.click.left;this.instance.offset.parent.left-=inst.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=inst.offset.parent.top-this.instance.offset.parent.top;inst._trigger("toSortable",event);inst.dropped=this.instance.element;inst.currentItem=inst.element;this.instance.fromOutside=inst}if(this.instance.currentItem){this.instance._mouseDrag(event)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",event,this.instance._uiHash(this.instance));this.instance._mouseStop(event,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}inst._trigger("fromSortable",event);inst.dropped=false}}})}});$.ui.plugin.add("draggable","cursor",{start:function(){var t=$("body"),o=$(this).data("ui-draggable").options;if(t.css("cursor")){o._cursor=t.css("cursor")}t.css("cursor",o.cursor)},stop:function(){var o=$(this).data("ui-draggable").options;if(o._cursor){$("body").css("cursor",o._cursor)}}});$.ui.plugin.add("draggable","opacity",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("ui-draggable").options;if(t.css("opacity")){o._opacity=t.css("opacity")}t.css("opacity",o.opacity)},stop:function(event,ui){var o=$(this).data("ui-draggable").options;if(o._opacity){$(ui.helper).css("opacity",o._opacity)}}});$.ui.plugin.add("draggable","scroll",{start:function(){var i=$(this).data("ui-draggable");if(i.scrollParent[0]!==document&&i.scrollParent[0].tagName!=="HTML"){i.overflowOffset=i.scrollParent.offset()}},drag:function(event){var i=$(this).data("ui-draggable"),o=i.options,scrolled=false;if(i.scrollParent[0]!==document&&i.scrollParent[0].tagName!=="HTML"){if(!o.axis||o.axis!=="x"){if((i.overflowOffset.top+i.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop+o.scrollSpeed}else{if(event.pageY-i.overflowOffset.top<o.scrollSensitivity){i.scrollParent[0].scrollTop=scrolled=i.scrollParent[0].scrollTop-o.scrollSpeed}}}if(!o.axis||o.axis!=="y"){if((i.overflowOffset.left+i.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft+o.scrollSpeed}else{if(event.pageX-i.overflowOffset.left<o.scrollSensitivity){i.scrollParent[0].scrollLeft=scrolled=i.scrollParent[0].scrollLeft-o.scrollSpeed}}}}else{if(!o.axis||o.axis!=="x"){if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed)}else{if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)}}}if(!o.axis||o.axis!=="y"){if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed)}else{if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)}}}}if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(i,event)}}});$.ui.plugin.add("draggable","snap",{start:function(){var i=$(this).data("ui-draggable"),o=i.options;i.snapElements=[];$(o.snap.constructor!==String?(o.snap.items||":data(ui-draggable)"):o.snap).each(function(){var $t=$(this),$o=$t.offset();if(this!==i.element[0]){i.snapElements.push({item:this,width:$t.outerWidth(),height:$t.outerHeight(),top:$o.top,left:$o.left})}})},drag:function(event,ui){var ts,bs,ls,rs,l,r,t,b,i,first,inst=$(this).data("ui-draggable"),o=inst.options,d=o.snapTolerance,x1=ui.offset.left,x2=x1+inst.helperProportions.width,y1=ui.offset.top,y2=y1+inst.helperProportions.height;for(i=inst.snapElements.length-1;i>=0;i--){l=inst.snapElements[i].left;r=l+inst.snapElements[i].width;t=inst.snapElements[i].top;b=t+inst.snapElements[i].height;if(x2<l-d||x1>r+d||y2<t-d||y1>b+d||!$.contains(inst.snapElements[i].item.ownerDocument,inst.snapElements[i].item)){if(inst.snapElements[i].snapping){(inst.options.snap.release&&inst.options.snap.release.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})))}inst.snapElements[i].snapping=false;continue}if(o.snapMode!=="inner"){ts=Math.abs(t-y2)<=d;bs=Math.abs(b-y1)<=d;ls=Math.abs(l-x2)<=d;rs=Math.abs(r-x1)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t-inst.helperProportions.height,left:0}).top-inst.margins.top}if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b,left:0}).top-inst.margins.top}if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l-inst.helperProportions.width}).left-inst.margins.left}if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r}).left-inst.margins.left}}first=(ts||bs||ls||rs);if(o.snapMode!=="outer"){ts=Math.abs(t-y1)<=d;bs=Math.abs(b-y2)<=d;ls=Math.abs(l-x1)<=d;rs=Math.abs(r-x2)<=d;if(ts){ui.position.top=inst._convertPositionTo("relative",{top:t,left:0}).top-inst.margins.top}if(bs){ui.position.top=inst._convertPositionTo("relative",{top:b-inst.helperProportions.height,left:0}).top-inst.margins.top}if(ls){ui.position.left=inst._convertPositionTo("relative",{top:0,left:l}).left-inst.margins.left}if(rs){ui.position.left=inst._convertPositionTo("relative",{top:0,left:r-inst.helperProportions.width}).left-inst.margins.left}}if(!inst.snapElements[i].snapping&&(ts||bs||ls||rs||first)){(inst.options.snap.snap&&inst.options.snap.snap.call(inst.element,event,$.extend(inst._uiHash(),{snapItem:inst.snapElements[i].item})))}inst.snapElements[i].snapping=(ts||bs||ls||rs||first)}}});$.ui.plugin.add("draggable","stack",{start:function(){var min,o=this.data("ui-draggable").options,group=$.makeArray($(o.stack)).sort(function(a,b){return(parseInt($(a).css("zIndex"),10)||0)-(parseInt($(b).css("zIndex"),10)||0)});if(!group.length){return}min=parseInt($(group[0]).css("zIndex"),10)||0;$(group).each(function(i){$(this).css("zIndex",min+i)});this.css("zIndex",(min+group.length))}});$.ui.plugin.add("draggable","zIndex",{start:function(event,ui){var t=$(ui.helper),o=$(this).data("ui-draggable").options;if(t.css("zIndex")){o._zIndex=t.css("zIndex")}t.css("zIndex",o.zIndex)},stop:function(event,ui){var o=$(this).data("ui-draggable").options;if(o._zIndex){$(ui.helper).css("zIndex",o._zIndex)}}})})(jQuery);(function($,undefined){function isOverAxis(x,reference,size){return(x>reference)&&(x<(reference+size))}$.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var o=this.options,accept=o.accept;this.isover=false;this.isout=true;this.accept=$.isFunction(accept)?accept:function(d){return d.is(accept)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};$.ui.ddmanager.droppables[o.scope]=$.ui.ddmanager.droppables[o.scope]||[];$.ui.ddmanager.droppables[o.scope].push(this);(o.addClasses&&this.element.addClass("ui-droppable"))},_destroy:function(){var i=0,drop=$.ui.ddmanager.droppables[this.options.scope];for(;i<drop.length;i++){if(drop[i]===this){drop.splice(i,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(key,value){if(key==="accept"){this.accept=$.isFunction(value)?value:function(d){return d.is(value)}}$.Widget.prototype._setOption.apply(this,arguments)},_activate:function(event){var draggable=$.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}if(draggable){this._trigger("activate",event,this.ui(draggable))}},_deactivate:function(event){var draggable=$.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(draggable){this._trigger("deactivate",event,this.ui(draggable))}},_over:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",event,this.ui(draggable))}},_out:function(event){var draggable=$.ui.ddmanager.current;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",event,this.ui(draggable))}},_drop:function(event,custom){var draggable=custom||$.ui.ddmanager.current,childrenIntersection=false;if(!draggable||(draggable.currentItem||draggable.element)[0]===this.element[0]){return false}this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var inst=$.data(this,"ui-droppable");if(inst.options.greedy&&!inst.options.disabled&&inst.options.scope===draggable.options.scope&&inst.accept.call(inst.element[0],(draggable.currentItem||draggable.element))&&$.ui.intersect(draggable,$.extend(inst,{offset:inst.element.offset()}),inst.options.tolerance)){childrenIntersection=true;return false}});if(childrenIntersection){return false}if(this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",event,this.ui(draggable));return this.element}return false},ui:function(c){return{draggable:(c.currentItem||c.element),helper:c.helper,position:c.position,offset:c.positionAbs}}});$.ui.intersect=function(draggable,droppable,toleranceMode){if(!droppable.offset){return false}var draggableLeft,draggableTop,x1=(draggable.positionAbs||draggable.position.absolute).left,x2=x1+draggable.helperProportions.width,y1=(draggable.positionAbs||draggable.position.absolute).top,y2=y1+draggable.helperProportions.height,l=droppable.offset.left,r=l+droppable.proportions.width,t=droppable.offset.top,b=t+droppable.proportions.height;switch(toleranceMode){case"fit":return(l<=x1&&x2<=r&&t<=y1&&y2<=b);case"intersect":return(l<x1+(draggable.helperProportions.width/2)&&x2-(draggable.helperProportions.width/2)<r&&t<y1+(draggable.helperProportions.height/2)&&y2-(draggable.helperProportions.height/2)<b);case"pointer":draggableLeft=((draggable.positionAbs||draggable.position.absolute).left+(draggable.clickOffset||draggable.offset.click).left);draggableTop=((draggable.positionAbs||draggable.position.absolute).top+(draggable.clickOffset||draggable.offset.click).top);return isOverAxis(draggableTop,t,droppable.proportions.height)&&isOverAxis(draggableLeft,l,droppable.proportions.width);case"touch":return((y1>=t&&y1<=b)||(y2>=t&&y2<=b)||(y1<t&&y2>b))&&((x1>=l&&x1<=r)||(x2>=l&&x2<=r)||(x1<l&&x2>r));default:return false}};$.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(t,event){var i,j,m=$.ui.ddmanager.droppables[t.options.scope]||[],type=event?event.type:null,list=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(i=0;i<m.length;i++){if(m[i].options.disabled||(t&&!m[i].accept.call(m[i].element[0],(t.currentItem||t.element)))){continue}for(j=0;j<list.length;j++){if(list[j]===m[i].element[0]){m[i].proportions.height=0;continue droppablesLoop}}m[i].visible=m[i].element.css("display")!=="none";if(!m[i].visible){continue}if(type==="mousedown"){m[i]._activate.call(m[i],event)}m[i].offset=m[i].element.offset();m[i].proportions={width:m[i].element[0].offsetWidth,height:m[i].element[0].offsetHeight}}},drop:function(draggable,event){var dropped=false;$.each(($.ui.ddmanager.droppables[draggable.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&$.ui.intersect(draggable,this,this.options.tolerance)){dropped=this._drop.call(this,event)||dropped}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(draggable.currentItem||draggable.element))){this.isout=true;this.isover=false;this._deactivate.call(this,event)}});return dropped},dragStart:function(draggable,event){draggable.element.parentsUntil("body").bind("scroll.droppable",function(){if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event)}})},drag:function(draggable,event){if(draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event)}$.each($.ui.ddmanager.droppables[draggable.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var parentInstance,scope,parent,intersects=$.ui.intersect(draggable,this,this.options.tolerance),c=!intersects&&this.isover?"isout":(intersects&&!this.isover?"isover":null);if(!c){return}if(this.options.greedy){scope=this.options.scope;parent=this.element.parents(":data(ui-droppable)").filter(function(){return $.data(this,"ui-droppable").options.scope===scope});if(parent.length){parentInstance=$.data(parent[0],"ui-droppable");parentInstance.greedyChild=(c==="isover")}}if(parentInstance&&c==="isover"){parentInstance.isover=false;parentInstance.isout=true;parentInstance._out.call(parentInstance,event)}this[c]=true;this[c==="isout"?"isover":"isout"]=false;this[c==="isover"?"_over":"_out"].call(this,event);if(parentInstance&&c==="isout"){parentInstance.isout=false;parentInstance.isover=true;parentInstance._over.call(parentInstance,event)}})},dragStop:function(draggable,event){draggable.element.parentsUntil("body").unbind("scroll.droppable");if(!draggable.options.refreshPositions){$.ui.ddmanager.prepareOffsets(draggable,event)}}}})(jQuery);(function($,undefined){function num(v){return parseInt(v,10)||0}function isNumber(value){return !isNaN(parseInt(value,10))}$.widget("ui.resizable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var n,i,handle,axis,hname,that=this,o=this.options;this.element.addClass("ui-resizable");$.extend(this,{_aspectRatio:!!(o.aspectRatio),aspectRatio:o.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:o.helper||o.ghost||o.animate?o.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){this.element.wrap($("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=o.handles||(!$(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor===String){if(this.handles==="all"){this.handles="n,e,s,w,se,sw,ne,nw"}n=this.handles.split(",");this.handles={};for(i=0;i<n.length;i++){handle=$.trim(n[i]);hname="ui-resizable-"+handle;axis=$("<div class='ui-resizable-handle "+hname+"'></div>");axis.css({zIndex:o.zIndex});if("se"===handle){axis.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[handle]=".ui-resizable-"+handle;this.element.append(axis)}}this._renderAxis=function(target){var i,axis,padPos,padWrapper;target=target||this.element;for(i in this.handles){if(this.handles[i].constructor===String){this.handles[i]=$(this.handles[i],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){axis=$(this.handles[i],this.element);padWrapper=/sw|ne|nw|se|n|s/.test(i)?axis.outerHeight():axis.outerWidth();padPos=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");target.css(padPos,padWrapper);this._proportionallyResize()}if(!$(this.handles[i]).length){continue}}};this._renderAxis(this.element);this._handles=$(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!that.resizing){if(this.className){axis=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}that.axis=axis&&axis[1]?axis[1]:"se"}});if(o.autoHide){this._handles.hide();$(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(o.disabled){return}$(this).removeClass("ui-resizable-autohide");that._handles.show()}).mouseleave(function(){if(o.disabled){return}if(!that.resizing){$(this).addClass("ui-resizable-autohide");that._handles.hide()}})}this._mouseInit()},_destroy:function(){this._mouseDestroy();var wrapper,_destroy=function(exp){$(exp).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){_destroy(this.element);wrapper=this.element;this.originalElement.css({position:wrapper.css("position"),width:wrapper.outerWidth(),height:wrapper.outerHeight(),top:wrapper.css("top"),left:wrapper.css("left")}).insertAfter(wrapper);wrapper.remove()}this.originalElement.css("resize",this.originalResizeStyle);_destroy(this.originalElement);return this},_mouseCapture:function(event){var i,handle,capture=false;for(i in this.handles){handle=$(this.handles[i])[0];if(handle===event.target||$.contains(handle,event.target)){capture=true}}return !this.options.disabled&&capture},_mouseStart:function(event){var curleft,curtop,cursor,o=this.options,iniPos=this.element.position(),el=this.element;this.resizing=true;if((/absolute/).test(el.css("position"))){el.css({position:"absolute",top:el.css("top"),left:el.css("left")})}else{if(el.is(".ui-draggable")){el.css({position:"absolute",top:iniPos.top,left:iniPos.left})}}this._renderProxy();curleft=num(this.helper.css("left"));curtop=num(this.helper.css("top"));if(o.containment){curleft+=$(o.containment).scrollLeft()||0;curtop+=$(o.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:curleft,top:curtop};this.size=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};this.originalSize=this._helper?{width:el.outerWidth(),height:el.outerHeight()}:{width:el.width(),height:el.height()};this.originalPosition={left:curleft,top:curtop};this.sizeDiff={width:el.outerWidth()-el.width(),height:el.outerHeight()-el.height()};this.originalMousePosition={left:event.pageX,top:event.pageY};this.aspectRatio=(typeof o.aspectRatio==="number")?o.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);cursor=$(".ui-resizable-"+this.axis).css("cursor");$("body").css("cursor",cursor==="auto"?this.axis+"-resize":cursor);el.addClass("ui-resizable-resizing");this._propagate("start",event);return true},_mouseDrag:function(event){var data,el=this.helper,props={},smp=this.originalMousePosition,a=this.axis,prevTop=this.position.top,prevLeft=this.position.left,prevWidth=this.size.width,prevHeight=this.size.height,dx=(event.pageX-smp.left)||0,dy=(event.pageY-smp.top)||0,trigger=this._change[a];if(!trigger){return false}data=trigger.apply(this,[event,dx,dy]);this._updateVirtualBoundaries(event.shiftKey);if(this._aspectRatio||event.shiftKey){data=this._updateRatio(data,event)}data=this._respectSize(data,event);this._updateCache(data);this._propagate("resize",event);if(this.position.top!==prevTop){props.top=this.position.top+"px"}if(this.position.left!==prevLeft){props.left=this.position.left+"px"}if(this.size.width!==prevWidth){props.width=this.size.width+"px"}if(this.size.height!==prevHeight){props.height=this.size.height+"px"}el.css(props);if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}if(!$.isEmptyObject(props)){this._trigger("resize",event,this.ui())}return false},_mouseStop:function(event){this.resizing=false;var pr,ista,soffseth,soffsetw,s,left,top,o=this.options,that=this;if(this._helper){pr=this._proportionallyResizeElements;ista=pr.length&&(/textarea/i).test(pr[0].nodeName);soffseth=ista&&$.ui.hasScroll(pr[0],"left")?0:that.sizeDiff.height;soffsetw=ista?0:that.sizeDiff.width;s={width:(that.helper.width()-soffsetw),height:(that.helper.height()-soffseth)};left=(parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left))||null;top=(parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top))||null;if(!o.animate){this.element.css($.extend(s,{top:top,left:left}))}that.helper.height(that.size.height);that.helper.width(that.size.width);if(this._helper&&!o.animate){this._proportionallyResize()}}$("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",event);if(this._helper){this.helper.remove()}return false},_updateVirtualBoundaries:function(forceAspectRatio){var pMinWidth,pMaxWidth,pMinHeight,pMaxHeight,b,o=this.options;b={minWidth:isNumber(o.minWidth)?o.minWidth:0,maxWidth:isNumber(o.maxWidth)?o.maxWidth:Infinity,minHeight:isNumber(o.minHeight)?o.minHeight:0,maxHeight:isNumber(o.maxHeight)?o.maxHeight:Infinity};if(this._aspectRatio||forceAspectRatio){pMinWidth=b.minHeight*this.aspectRatio;pMinHeight=b.minWidth/this.aspectRatio;pMaxWidth=b.maxHeight*this.aspectRatio;pMaxHeight=b.maxWidth/this.aspectRatio;if(pMinWidth>b.minWidth){b.minWidth=pMinWidth}if(pMinHeight>b.minHeight){b.minHeight=pMinHeight}if(pMaxWidth<b.maxWidth){b.maxWidth=pMaxWidth}if(pMaxHeight<b.maxHeight){b.maxHeight=pMaxHeight}}this._vBoundaries=b},_updateCache:function(data){this.offset=this.helper.offset();if(isNumber(data.left)){this.position.left=data.left}if(isNumber(data.top)){this.position.top=data.top}if(isNumber(data.height)){this.size.height=data.height}if(isNumber(data.width)){this.size.width=data.width}},_updateRatio:function(data){var cpos=this.position,csize=this.size,a=this.axis;if(isNumber(data.height)){data.width=(data.height*this.aspectRatio)}else{if(isNumber(data.width)){data.height=(data.width/this.aspectRatio)}}if(a==="sw"){data.left=cpos.left+(csize.width-data.width);data.top=null}if(a==="nw"){data.top=cpos.top+(csize.height-data.height);data.left=cpos.left+(csize.width-data.width)}return data},_respectSize:function(data){var o=this._vBoundaries,a=this.axis,ismaxw=isNumber(data.width)&&o.maxWidth&&(o.maxWidth<data.width),ismaxh=isNumber(data.height)&&o.maxHeight&&(o.maxHeight<data.height),isminw=isNumber(data.width)&&o.minWidth&&(o.minWidth>data.width),isminh=isNumber(data.height)&&o.minHeight&&(o.minHeight>data.height),dw=this.originalPosition.left+this.originalSize.width,dh=this.position.top+this.size.height,cw=/sw|nw|w/.test(a),ch=/nw|ne|n/.test(a);if(isminw){data.width=o.minWidth}if(isminh){data.height=o.minHeight}if(ismaxw){data.width=o.maxWidth}if(ismaxh){data.height=o.maxHeight}if(isminw&&cw){data.left=dw-o.minWidth}if(ismaxw&&cw){data.left=dw-o.maxWidth}if(isminh&&ch){data.top=dh-o.minHeight}if(ismaxh&&ch){data.top=dh-o.maxHeight}if(!data.width&&!data.height&&!data.left&&data.top){data.top=null}else{if(!data.width&&!data.height&&!data.top&&data.left){data.left=null}}return data},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length){return}var i,j,borders,paddings,prel,element=this.helper||this.element;for(i=0;i<this._proportionallyResizeElements.length;i++){prel=this._proportionallyResizeElements[i];if(!this.borderDif){this.borderDif=[];borders=[prel.css("borderTopWidth"),prel.css("borderRightWidth"),prel.css("borderBottomWidth"),prel.css("borderLeftWidth")];paddings=[prel.css("paddingTop"),prel.css("paddingRight"),prel.css("paddingBottom"),prel.css("paddingLeft")];for(j=0;j<borders.length;j++){this.borderDif[j]=(parseInt(borders[j],10)||0)+(parseInt(paddings[j],10)||0)}}prel.css({height:(element.height()-this.borderDif[0]-this.borderDif[2])||0,width:(element.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var el=this.element,o=this.options;this.elementOffset=el.offset();if(this._helper){this.helper=this.helper||$("<div style='overflow:hidden;'></div>");this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++o.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(event,dx){return{width:this.originalSize.width+dx}},w:function(event,dx){var cs=this.originalSize,sp=this.originalPosition;return{left:sp.left+dx,width:cs.width-dx}},n:function(event,dx,dy){var cs=this.originalSize,sp=this.originalPosition;return{top:sp.top+dy,height:cs.height-dy}},s:function(event,dx,dy){return{height:this.originalSize.height+dy}},se:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},sw:function(event,dx,dy){return $.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))},ne:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[event,dx,dy]))},nw:function(event,dx,dy){return $.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[event,dx,dy]))}},_propagate:function(n,event){$.ui.plugin.call(this,n,[event,this.ui()]);(n!=="resize"&&this._trigger(n,event,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});$.ui.plugin.add("resizable","animate",{stop:function(event){var that=$(this).data("ui-resizable"),o=that.options,pr=that._proportionallyResizeElements,ista=pr.length&&(/textarea/i).test(pr[0].nodeName),soffseth=ista&&$.ui.hasScroll(pr[0],"left")?0:that.sizeDiff.height,soffsetw=ista?0:that.sizeDiff.width,style={width:(that.size.width-soffsetw),height:(that.size.height-soffseth)},left=(parseInt(that.element.css("left"),10)+(that.position.left-that.originalPosition.left))||null,top=(parseInt(that.element.css("top"),10)+(that.position.top-that.originalPosition.top))||null;that.element.animate($.extend(style,top&&left?{top:top,left:left}:{}),{duration:o.animateDuration,easing:o.animateEasing,step:function(){var data={width:parseInt(that.element.css("width"),10),height:parseInt(that.element.css("height"),10),top:parseInt(that.element.css("top"),10),left:parseInt(that.element.css("left"),10)};if(pr&&pr.length){$(pr[0]).css({width:data.width,height:data.height})}that._updateCache(data);that._propagate("resize",event)}})}});$.ui.plugin.add("resizable","containment",{start:function(){var element,p,co,ch,cw,width,height,that=$(this).data("ui-resizable"),o=that.options,el=that.element,oc=o.containment,ce=(oc instanceof $)?oc.get(0):(/parent/.test(oc))?el.parent().get(0):oc;if(!ce){return}that.containerElement=$(ce);if(/document/.test(oc)||oc===document){that.containerOffset={left:0,top:0};that.containerPosition={left:0,top:0};that.parentData={element:$(document),left:0,top:0,width:$(document).width(),height:$(document).height()||document.body.parentNode.scrollHeight}}else{element=$(ce);p=[];$(["Top","Right","Left","Bottom"]).each(function(i,name){p[i]=num(element.css("padding"+name))});that.containerOffset=element.offset();that.containerPosition=element.position();that.containerSize={height:(element.innerHeight()-p[3]),width:(element.innerWidth()-p[1])};co=that.containerOffset;ch=that.containerSize.height;cw=that.containerSize.width;width=($.ui.hasScroll(ce,"left")?ce.scrollWidth:cw);height=($.ui.hasScroll(ce)?ce.scrollHeight:ch);that.parentData={element:ce,left:co.left,top:co.top,width:width,height:height}}},resize:function(event){var woset,hoset,isParent,isOffsetRelative,that=$(this).data("ui-resizable"),o=that.options,co=that.containerOffset,cp=that.position,pRatio=that._aspectRatio||event.shiftKey,cop={top:0,left:0},ce=that.containerElement;if(ce[0]!==document&&(/static/).test(ce.css("position"))){cop=co}if(cp.left<(that._helper?co.left:0)){that.size.width=that.size.width+(that._helper?(that.position.left-co.left):(that.position.left-cop.left));if(pRatio){that.size.height=that.size.width/that.aspectRatio}that.position.left=o.helper?co.left:0}if(cp.top<(that._helper?co.top:0)){that.size.height=that.size.height+(that._helper?(that.position.top-co.top):that.position.top);if(pRatio){that.size.width=that.size.height*that.aspectRatio}that.position.top=that._helper?co.top:0}that.offset.left=that.parentData.left+that.position.left;that.offset.top=that.parentData.top+that.position.top;woset=Math.abs((that._helper?that.offset.left-cop.left:(that.offset.left-cop.left))+that.sizeDiff.width);hoset=Math.abs((that._helper?that.offset.top-cop.top:(that.offset.top-co.top))+that.sizeDiff.height);isParent=that.containerElement.get(0)===that.element.parent().get(0);isOffsetRelative=/relative|absolute/.test(that.containerElement.css("position"));if(isParent&&isOffsetRelative){woset-=that.parentData.left}if(woset+that.size.width>=that.parentData.width){that.size.width=that.parentData.width-woset;if(pRatio){that.size.height=that.size.width/that.aspectRatio}}if(hoset+that.size.height>=that.parentData.height){that.size.height=that.parentData.height-hoset;if(pRatio){that.size.width=that.size.height*that.aspectRatio}}},stop:function(){var that=$(this).data("ui-resizable"),o=that.options,co=that.containerOffset,cop=that.containerPosition,ce=that.containerElement,helper=$(that.helper),ho=helper.offset(),w=helper.outerWidth()-that.sizeDiff.width,h=helper.outerHeight()-that.sizeDiff.height;if(that._helper&&!o.animate&&(/relative/).test(ce.css("position"))){$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}if(that._helper&&!o.animate&&(/static/).test(ce.css("position"))){$(this).css({left:ho.left-cop.left-co.left,width:w,height:h})}}});$.ui.plugin.add("resizable","alsoResize",{start:function(){var that=$(this).data("ui-resizable"),o=that.options,_store=function(exp){$(exp).each(function(){var el=$(this);el.data("ui-resizable-alsoresize",{width:parseInt(el.width(),10),height:parseInt(el.height(),10),left:parseInt(el.css("left"),10),top:parseInt(el.css("top"),10)})})};if(typeof(o.alsoResize)==="object"&&!o.alsoResize.parentNode){if(o.alsoResize.length){o.alsoResize=o.alsoResize[0];_store(o.alsoResize)}else{$.each(o.alsoResize,function(exp){_store(exp)})}}else{_store(o.alsoResize)}},resize:function(event,ui){var that=$(this).data("ui-resizable"),o=that.options,os=that.originalSize,op=that.originalPosition,delta={height:(that.size.height-os.height)||0,width:(that.size.width-os.width)||0,top:(that.position.top-op.top)||0,left:(that.position.left-op.left)||0},_alsoResize=function(exp,c){$(exp).each(function(){var el=$(this),start=$(this).data("ui-resizable-alsoresize"),style={},css=c&&c.length?c:el.parents(ui.originalElement[0]).length?["width","height"]:["width","height","top","left"];$.each(css,function(i,prop){var sum=(start[prop]||0)+(delta[prop]||0);if(sum&&sum>=0){style[prop]=sum||null}});el.css(style)})};if(typeof(o.alsoResize)==="object"&&!o.alsoResize.nodeType){$.each(o.alsoResize,function(exp,c){_alsoResize(exp,c)})}else{_alsoResize(o.alsoResize)}},stop:function(){$(this).removeData("resizable-alsoresize")}});$.ui.plugin.add("resizable","ghost",{start:function(){var that=$(this).data("ui-resizable"),o=that.options,cs=that.size;that.ghost=that.originalElement.clone();that.ghost.css({opacity:0.25,display:"block",position:"relative",height:cs.height,width:cs.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof o.ghost==="string"?o.ghost:"");that.ghost.appendTo(that.helper)},resize:function(){var that=$(this).data("ui-resizable");if(that.ghost){that.ghost.css({position:"relative",height:that.size.height,width:that.size.width})}},stop:function(){var that=$(this).data("ui-resizable");if(that.ghost&&that.helper){that.helper.get(0).removeChild(that.ghost.get(0))}}});$.ui.plugin.add("resizable","grid",{resize:function(){var that=$(this).data("ui-resizable"),o=that.options,cs=that.size,os=that.originalSize,op=that.originalPosition,a=that.axis,grid=typeof o.grid==="number"?[o.grid,o.grid]:o.grid,gridX=(grid[0]||1),gridY=(grid[1]||1),ox=Math.round((cs.width-os.width)/gridX)*gridX,oy=Math.round((cs.height-os.height)/gridY)*gridY,newWidth=os.width+ox,newHeight=os.height+oy,isMaxWidth=o.maxWidth&&(o.maxWidth<newWidth),isMaxHeight=o.maxHeight&&(o.maxHeight<newHeight),isMinWidth=o.minWidth&&(o.minWidth>newWidth),isMinHeight=o.minHeight&&(o.minHeight>newHeight);o.grid=grid;if(isMinWidth){newWidth=newWidth+gridX}if(isMinHeight){newHeight=newHeight+gridY}if(isMaxWidth){newWidth=newWidth-gridX}if(isMaxHeight){newHeight=newHeight-gridY}if(/^(se|s|e)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight}else{if(/^(ne)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;that.position.top=op.top-oy}else{if(/^(sw)$/.test(a)){that.size.width=newWidth;that.size.height=newHeight;that.position.left=op.left-ox}else{that.size.width=newWidth;that.size.height=newHeight;that.position.top=op.top-oy;that.position.left=op.left-ox}}}}})})(jQuery);(function($,undefined){$.widget("ui.selectable",$.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var selectees,that=this;this.element.addClass("ui-selectable");this.dragged=false;this.refresh=function(){selectees=$(that.options.filter,that.element[0]);selectees.addClass("ui-selectee");selectees.each(function(){var $this=$(this),pos=$this.offset();$.data(this,"selectable-item",{element:this,$element:$this,left:pos.left,top:pos.top,right:pos.left+$this.outerWidth(),bottom:pos.top+$this.outerHeight(),startselected:false,selected:$this.hasClass("ui-selected"),selecting:$this.hasClass("ui-selecting"),unselecting:$this.hasClass("ui-unselecting")})})};this.refresh();this.selectees=selectees.addClass("ui-selectee");this._mouseInit();this.helper=$("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");this._mouseDestroy()},_mouseStart:function(event){var that=this,options=this.options;this.opos=[event.pageX,event.pageY];if(this.options.disabled){return}this.selectees=$(options.filter,this.element[0]);this._trigger("start",event);$(options.appendTo).append(this.helper);this.helper.css({left:event.pageX,top:event.pageY,width:0,height:0});if(options.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var selectee=$.data(this,"selectable-item");selectee.startselected=true;if(!event.metaKey&&!event.ctrlKey){selectee.$element.removeClass("ui-selected");selectee.selected=false;selectee.$element.addClass("ui-unselecting");selectee.unselecting=true;that._trigger("unselecting",event,{unselecting:selectee.element})}});$(event.target).parents().addBack().each(function(){var doSelect,selectee=$.data(this,"selectable-item");if(selectee){doSelect=(!event.metaKey&&!event.ctrlKey)||!selectee.$element.hasClass("ui-selected");selectee.$element.removeClass(doSelect?"ui-unselecting":"ui-selected").addClass(doSelect?"ui-selecting":"ui-unselecting");selectee.unselecting=!doSelect;selectee.selecting=doSelect;selectee.selected=doSelect;if(doSelect){that._trigger("selecting",event,{selecting:selectee.element})}else{that._trigger("unselecting",event,{unselecting:selectee.element})}return false}})},_mouseDrag:function(event){this.dragged=true;if(this.options.disabled){return}var tmp,that=this,options=this.options,x1=this.opos[0],y1=this.opos[1],x2=event.pageX,y2=event.pageY;if(x1>x2){tmp=x2;x2=x1;x1=tmp}if(y1>y2){tmp=y2;y2=y1;y1=tmp}this.helper.css({left:x1,top:y1,width:x2-x1,height:y2-y1});this.selectees.each(function(){var selectee=$.data(this,"selectable-item"),hit=false;if(!selectee||selectee.element===that.element[0]){return}if(options.tolerance==="touch"){hit=(!(selectee.left>x2||selectee.right<x1||selectee.top>y2||selectee.bottom<y1))}else{if(options.tolerance==="fit"){hit=(selectee.left>x1&&selectee.right<x2&&selectee.top>y1&&selectee.bottom<y2)}}if(hit){if(selectee.selected){selectee.$element.removeClass("ui-selected");selectee.selected=false}if(selectee.unselecting){selectee.$element.removeClass("ui-unselecting");selectee.unselecting=false}if(!selectee.selecting){selectee.$element.addClass("ui-selecting");selectee.selecting=true;that._trigger("selecting",event,{selecting:selectee.element})}}else{if(selectee.selecting){if((event.metaKey||event.ctrlKey)&&selectee.startselected){selectee.$element.removeClass("ui-selecting");selectee.selecting=false;selectee.$element.addClass("ui-selected");selectee.selected=true}else{selectee.$element.removeClass("ui-selecting");selectee.selecting=false;if(selectee.startselected){selectee.$element.addClass("ui-unselecting");selectee.unselecting=true}that._trigger("unselecting",event,{unselecting:selectee.element})}}if(selectee.selected){if(!event.metaKey&&!event.ctrlKey&&!selectee.startselected){selectee.$element.removeClass("ui-selected");selectee.selected=false;selectee.$element.addClass("ui-unselecting");selectee.unselecting=true;that._trigger("unselecting",event,{unselecting:selectee.element})}}}});return false},_mouseStop:function(event){var that=this;this.dragged=false;$(".ui-unselecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-unselecting");selectee.unselecting=false;selectee.startselected=false;that._trigger("unselected",event,{unselected:selectee.element})});$(".ui-selecting",this.element[0]).each(function(){var selectee=$.data(this,"selectable-item");selectee.$element.removeClass("ui-selecting").addClass("ui-selected");selectee.selecting=false;selectee.selected=true;selectee.startselected=true;that._trigger("selected",event,{selected:selectee.element})});this._trigger("stop",event);this.helper.remove();return false}})})(jQuery);(function($,undefined){function isOverAxis(x,reference,size){return(x>reference)&&(x<(reference+size))}function isFloating(item){return(/left|right/).test(item.css("float"))||(/inline|table-cell/).test(item.css("display"))}$.widget("ui.sortable",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var o=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?o.axis==="x"||isFloating(this.items[0].item):false;this.offset=this.element.offset();this._mouseInit();this.ready=true},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var i=this.items.length-1;i>=0;i--){this.items[i].item.removeData(this.widgetName+"-item")}return this},_setOption:function(key,value){if(key==="disabled"){this.options[key]=value;this.widget().toggleClass("ui-sortable-disabled",!!value)}else{$.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(event,overrideHandle){var currentItem=null,validHandle=false,that=this;if(this.reverting){return false}if(this.options.disabled||this.options.type==="static"){return false}this._refreshItems(event);$(event.target).parents().each(function(){if($.data(this,that.widgetName+"-item")===that){currentItem=$(this);return false}});if($.data(event.target,that.widgetName+"-item")===that){currentItem=$(event.target)}if(!currentItem){return false}if(this.options.handle&&!overrideHandle){$(this.options.handle,currentItem).find("*").addBack().each(function(){if(this===event.target){validHandle=true}});if(!validHandle){return false}}this.currentItem=currentItem;this._removeCurrentsFromItems();return true},_mouseStart:function(event,overrideHandle,noActivation){var i,body,o=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(event);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};$.extend(this.offset,{click:{left:event.pageX-this.offset.left,top:event.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(event);this.originalPageX=event.pageX;this.originalPageY=event.pageY;(o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(o.containment){this._setContainment()}if(o.cursor&&o.cursor!=="auto"){body=this.document.find("body");this.storedCursor=body.css("cursor");body.css("cursor",o.cursor);this.storedStylesheet=$("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(body)}if(o.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",o.opacity)}if(o.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",o.zIndex)}if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",event,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!noActivation){for(i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("activate",event,this._uiHash(this))}}if($.ui.ddmanager){$.ui.ddmanager.current=this}if($.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(event);return true},_mouseDrag:function(event){var i,item,itemElement,intersection,o=this.options,scrolled=false;this.position=this._generatePosition(event);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-event.pageY<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop+o.scrollSpeed}else{if(event.pageY-this.overflowOffset.top<o.scrollSensitivity){this.scrollParent[0].scrollTop=scrolled=this.scrollParent[0].scrollTop-o.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-event.pageX<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft+o.scrollSpeed}else{if(event.pageX-this.overflowOffset.left<o.scrollSensitivity){this.scrollParent[0].scrollLeft=scrolled=this.scrollParent[0].scrollLeft-o.scrollSpeed}}}else{if(event.pageY-$(document).scrollTop()<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()-o.scrollSpeed)}else{if($(window).height()-(event.pageY-$(document).scrollTop())<o.scrollSensitivity){scrolled=$(document).scrollTop($(document).scrollTop()+o.scrollSpeed)}}if(event.pageX-$(document).scrollLeft()<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed)}else{if($(window).width()-(event.pageX-$(document).scrollLeft())<o.scrollSensitivity){scrolled=$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed)}}}if(scrolled!==false&&$.ui.ddmanager&&!o.dropBehaviour){$.ui.ddmanager.prepareOffsets(this,event)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}for(i=this.items.length-1;i>=0;i--){item=this.items[i];itemElement=item.item[0];intersection=this._intersectsWithPointer(item);if(!intersection){continue}if(item.instance!==this.currentContainer){continue}if(itemElement!==this.currentItem[0]&&this.placeholder[intersection===1?"next":"prev"]()[0]!==itemElement&&!$.contains(this.placeholder[0],itemElement)&&(this.options.type==="semi-dynamic"?!$.contains(this.element[0],itemElement):true)){this.direction=intersection===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(item)){this._rearrange(event,item)}else{break}this._trigger("change",event,this._uiHash());break}}this._contactContainers(event);if($.ui.ddmanager){$.ui.ddmanager.drag(this,event)}this._trigger("sort",event,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(event,noPropagation){if(!event){return}if($.ui.ddmanager&&!this.options.dropBehaviour){$.ui.ddmanager.drop(this,event)}if(this.options.revert){var that=this,cur=this.placeholder.offset(),axis=this.options.axis,animation={};if(!axis||axis==="x"){animation.left=cur.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)}if(!axis||axis==="y"){animation.top=cur.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)}this.reverting=true;$(this.helper).animate(animation,parseInt(this.options.revert,10)||500,function(){that._clear(event)})}else{this._clear(event,noPropagation)}return false},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var i=this.containers.length-1;i>=0;i--){this.containers[i]._trigger("deactivate",null,this._uiHash(this));if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",null,this._uiHash(this));this.containers[i].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}$.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){$(this.domPosition.prev).after(this.currentItem)}else{$(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(o){var items=this._getItemsAsjQuery(o&&o.connected),str=[];o=o||{};$(items).each(function(){var res=($(o.item||this).attr(o.attribute||"id")||"").match(o.expression||(/(.+)[\-=_](.+)/));if(res){str.push((o.key||res[1]+"[]")+"="+(o.key&&o.expression?res[1]:res[2]))}});if(!str.length&&o.key){str.push(o.key+"=")}return str.join("&")},toArray:function(o){var items=this._getItemsAsjQuery(o&&o.connected),ret=[];o=o||{};items.each(function(){ret.push($(o.item||this).attr(o.attribute||"id")||"")});return ret},_intersectsWith:function(item){var x1=this.positionAbs.left,x2=x1+this.helperProportions.width,y1=this.positionAbs.top,y2=y1+this.helperProportions.height,l=item.left,r=l+item.width,t=item.top,b=t+item.height,dyClick=this.offset.click.top,dxClick=this.offset.click.left,isOverElementHeight=(this.options.axis==="x")||((y1+dyClick)>t&&(y1+dyClick)<b),isOverElementWidth=(this.options.axis==="y")||((x1+dxClick)>l&&(x1+dxClick)<r),isOverElement=isOverElementHeight&&isOverElementWidth;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>item[this.floating?"width":"height"])){return isOverElement}else{return(l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b)}},_intersectsWithPointer:function(item){var isOverElementHeight=(this.options.axis==="x")||isOverAxis(this.positionAbs.top+this.offset.click.top,item.top,item.height),isOverElementWidth=(this.options.axis==="y")||isOverAxis(this.positionAbs.left+this.offset.click.left,item.left,item.width),isOverElement=isOverElementHeight&&isOverElementWidth,verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(!isOverElement){return false}return this.floating?(((horizontalDirection&&horizontalDirection==="right")||verticalDirection==="down")?2:1):(verticalDirection&&(verticalDirection==="down"?2:1))},_intersectsWithSides:function(item){var isOverBottomHalf=isOverAxis(this.positionAbs.top+this.offset.click.top,item.top+(item.height/2),item.height),isOverRightHalf=isOverAxis(this.positionAbs.left+this.offset.click.left,item.left+(item.width/2),item.width),verticalDirection=this._getDragVerticalDirection(),horizontalDirection=this._getDragHorizontalDirection();if(this.floating&&horizontalDirection){return((horizontalDirection==="right"&&isOverRightHalf)||(horizontalDirection==="left"&&!isOverRightHalf))}else{return verticalDirection&&((verticalDirection==="down"&&isOverBottomHalf)||(verticalDirection==="up"&&!isOverBottomHalf))}},_getDragVerticalDirection:function(){var delta=this.positionAbs.top-this.lastPositionAbs.top;return delta!==0&&(delta>0?"down":"up")},_getDragHorizontalDirection:function(){var delta=this.positionAbs.left-this.lastPositionAbs.left;return delta!==0&&(delta>0?"right":"left")},refresh:function(event){this._refreshItems(event);this.refreshPositions();return this},_connectWith:function(){var options=this.options;return options.connectWith.constructor===String?[options.connectWith]:options.connectWith},_getItemsAsjQuery:function(connected){var i,j,cur,inst,items=[],queries=[],connectWith=this._connectWith();if(connectWith&&connected){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element):$(inst.options.items,inst.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),inst])}}}}queries.push([$.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):$(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(i=queries.length-1;i>=0;i--){queries[i][0].each(function(){items.push(this)})}return $(items)},_removeCurrentsFromItems:function(){var list=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=$.grep(this.items,function(item){for(var j=0;j<list.length;j++){if(list[j]===item.item[0]){return false}}return true})},_refreshItems:function(event){this.items=[];this.containers=[this];var i,j,cur,inst,targetData,_queries,item,queriesLength,items=this.items,queries=[[$.isFunction(this.options.items)?this.options.items.call(this.element[0],event,{item:this.currentItem}):$(this.options.items,this.element),this]],connectWith=this._connectWith();if(connectWith&&this.ready){for(i=connectWith.length-1;i>=0;i--){cur=$(connectWith[i]);for(j=cur.length-1;j>=0;j--){inst=$.data(cur[j],this.widgetFullName);if(inst&&inst!==this&&!inst.options.disabled){queries.push([$.isFunction(inst.options.items)?inst.options.items.call(inst.element[0],event,{item:this.currentItem}):$(inst.options.items,inst.element),inst]);this.containers.push(inst)}}}}for(i=queries.length-1;i>=0;i--){targetData=queries[i][1];_queries=queries[i][0];for(j=0,queriesLength=_queries.length;j<queriesLength;j++){item=$(_queries[j]);item.data(this.widgetName+"-item",targetData);items.push({item:item,instance:targetData,width:0,height:0,left:0,top:0})}}},refreshPositions:function(fast){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}var i,item,t,p;for(i=this.items.length-1;i>=0;i--){item=this.items[i];if(item.instance!==this.currentContainer&&this.currentContainer&&item.item[0]!==this.currentItem[0]){continue}t=this.options.toleranceElement?$(this.options.toleranceElement,item.item):item.item;if(!fast){item.width=t.outerWidth();item.height=t.outerHeight()}p=t.offset();item.left=p.left;item.top=p.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(i=this.containers.length-1;i>=0;i--){p=this.containers[i].element.offset();this.containers[i].containerCache.left=p.left;this.containers[i].containerCache.top=p.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight()}}return this},_createPlaceholder:function(that){that=that||this;var className,o=that.options;if(!o.placeholder||o.placeholder.constructor===String){className=o.placeholder;o.placeholder={element:function(){var nodeName=that.currentItem[0].nodeName.toLowerCase(),element=$("<"+nodeName+">",that.document[0]).addClass(className||that.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");if(nodeName==="tr"){that.currentItem.children().each(function(){$("<td>&#160;</td>",that.document[0]).attr("colspan",$(this).attr("colspan")||1).appendTo(element)})}else{if(nodeName==="img"){element.attr("src",that.currentItem.attr("src"))}}if(!className){element.css("visibility","hidden")}return element},update:function(container,p){if(className&&!o.forcePlaceholderSize){return}if(!p.height()){p.height(that.currentItem.innerHeight()-parseInt(that.currentItem.css("paddingTop")||0,10)-parseInt(that.currentItem.css("paddingBottom")||0,10))}if(!p.width()){p.width(that.currentItem.innerWidth()-parseInt(that.currentItem.css("paddingLeft")||0,10)-parseInt(that.currentItem.css("paddingRight")||0,10))}}}}that.placeholder=$(o.placeholder.element.call(that.element,that.currentItem));that.currentItem.after(that.placeholder);o.placeholder.update(that,that.placeholder)},_contactContainers:function(event){var i,j,dist,itemWithLeastDistance,posProperty,sizeProperty,base,cur,nearBottom,floating,innermostContainer=null,innermostIndex=null;for(i=this.containers.length-1;i>=0;i--){if($.contains(this.currentItem[0],this.containers[i].element[0])){continue}if(this._intersectsWith(this.containers[i].containerCache)){if(innermostContainer&&$.contains(this.containers[i].element[0],innermostContainer.element[0])){continue}innermostContainer=this.containers[i];innermostIndex=i}else{if(this.containers[i].containerCache.over){this.containers[i]._trigger("out",event,this._uiHash(this));this.containers[i].containerCache.over=0}}}if(!innermostContainer){return}if(this.containers.length===1){if(!this.containers[innermostIndex].containerCache.over){this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1}}else{dist=10000;itemWithLeastDistance=null;floating=innermostContainer.floating||isFloating(this.currentItem);posProperty=floating?"left":"top";sizeProperty=floating?"width":"height";base=this.positionAbs[posProperty]+this.offset.click[posProperty];for(j=this.items.length-1;j>=0;j--){if(!$.contains(this.containers[innermostIndex].element[0],this.items[j].item[0])){continue}if(this.items[j].item[0]===this.currentItem[0]){continue}if(floating&&!isOverAxis(this.positionAbs.top+this.offset.click.top,this.items[j].top,this.items[j].height)){continue}cur=this.items[j].item.offset()[posProperty];nearBottom=false;if(Math.abs(cur-base)>Math.abs(cur+this.items[j][sizeProperty]-base)){nearBottom=true;cur+=this.items[j][sizeProperty]}if(Math.abs(cur-base)<dist){dist=Math.abs(cur-base);itemWithLeastDistance=this.items[j];this.direction=nearBottom?"up":"down"}}if(!itemWithLeastDistance&&!this.options.dropOnEmpty){return}if(this.currentContainer===this.containers[innermostIndex]){return}itemWithLeastDistance?this._rearrange(event,itemWithLeastDistance,null,true):this._rearrange(event,null,this.containers[innermostIndex].element,true);this._trigger("change",event,this._uiHash());this.containers[innermostIndex]._trigger("change",event,this._uiHash(this));this.currentContainer=this.containers[innermostIndex];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[innermostIndex]._trigger("over",event,this._uiHash(this));this.containers[innermostIndex].containerCache.over=1}},_createHelper:function(event){var o=this.options,helper=$.isFunction(o.helper)?$(o.helper.apply(this.element[0],[event,this.currentItem])):(o.helper==="clone"?this.currentItem.clone():this.currentItem);if(!helper.parents("body").length){$(o.appendTo!=="parent"?o.appendTo:this.currentItem[0].parentNode)[0].appendChild(helper[0])}if(helper[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(!helper[0].style.width||o.forceHelperSize){helper.width(this.currentItem.width())}if(!helper[0].style.height||o.forceHelperSize){helper.height(this.currentItem.height())}return helper},_adjustOffsetFromHelper:function(obj){if(typeof obj==="string"){obj=obj.split(" ")}if($.isArray(obj)){obj={left:+obj[0],top:+obj[1]||0}}if("left" in obj){this.offset.click.left=obj.left+this.margins.left}if("right" in obj){this.offset.click.left=this.helperProportions.width-obj.right+this.margins.left}if("top" in obj){this.offset.click.top=obj.top+this.margins.top}if("bottom" in obj){this.offset.click.top=this.helperProportions.height-obj.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var po=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0])){po.left+=this.scrollParent.scrollLeft();po.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===document.body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&$.ui.ie)){po={top:0,left:0}}return{top:po.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:po.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var p=this.currentItem.position();return{top:p.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:p.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var ce,co,over,o=this.options;if(o.containment==="parent"){o.containment=this.helper[0].parentNode}if(o.containment==="document"||o.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,$(o.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,($(o.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(o.containment)){ce=$(o.containment)[0];co=$(o.containment).offset();over=($(ce).css("overflow")!=="hidden");this.containment=[co.left+(parseInt($(ce).css("borderLeftWidth"),10)||0)+(parseInt($(ce).css("paddingLeft"),10)||0)-this.margins.left,co.top+(parseInt($(ce).css("borderTopWidth"),10)||0)+(parseInt($(ce).css("paddingTop"),10)||0)-this.margins.top,co.left+(over?Math.max(ce.scrollWidth,ce.offsetWidth):ce.offsetWidth)-(parseInt($(ce).css("borderLeftWidth"),10)||0)-(parseInt($(ce).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,co.top+(over?Math.max(ce.scrollHeight,ce.offsetHeight):ce.offsetHeight)-(parseInt($(ce).css("borderTopWidth"),10)||0)-(parseInt($(ce).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(d,pos){if(!pos){pos=this.position}var mod=d==="absolute"?1:-1,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);return{top:(pos.top+this.offset.relative.top*mod+this.offset.parent.top*mod-((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop()))*mod)),left:(pos.left+this.offset.relative.left*mod+this.offset.parent.left*mod-((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())*mod))}},_generatePosition:function(event){var top,left,o=this.options,pageX=event.pageX,pageY=event.pageY,scroll=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&$.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,scrollIsRootNode=(/(html|body)/i).test(scroll[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}if(this.originalPosition){if(this.containment){if(event.pageX-this.offset.click.left<this.containment[0]){pageX=this.containment[0]+this.offset.click.left}if(event.pageY-this.offset.click.top<this.containment[1]){pageY=this.containment[1]+this.offset.click.top}if(event.pageX-this.offset.click.left>this.containment[2]){pageX=this.containment[2]+this.offset.click.left}if(event.pageY-this.offset.click.top>this.containment[3]){pageY=this.containment[3]+this.offset.click.top}}if(o.grid){top=this.originalPageY+Math.round((pageY-this.originalPageY)/o.grid[1])*o.grid[1];pageY=this.containment?((top-this.offset.click.top>=this.containment[1]&&top-this.offset.click.top<=this.containment[3])?top:((top-this.offset.click.top>=this.containment[1])?top-o.grid[1]:top+o.grid[1])):top;left=this.originalPageX+Math.round((pageX-this.originalPageX)/o.grid[0])*o.grid[0];pageX=this.containment?((left-this.offset.click.left>=this.containment[0]&&left-this.offset.click.left<=this.containment[2])?left:((left-this.offset.click.left>=this.containment[0])?left-o.grid[0]:left+o.grid[0])):left}}return{top:(pageY-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(scrollIsRootNode?0:scroll.scrollTop())))),left:(pageX-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():scrollIsRootNode?0:scroll.scrollLeft())))}},_rearrange:function(event,i,a,hardRefresh){a?a[0].appendChild(this.placeholder[0]):i.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?i.item[0]:i.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var counter=this.counter;this._delay(function(){if(counter===this.counter){this.refreshPositions(!hardRefresh)}})},_clear:function(event,noPropagation){this.reverting=false;var i,delayedTriggers=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(i in this._storedCSS){if(this._storedCSS[i]==="auto"||this._storedCSS[i]==="static"){this._storedCSS[i]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!noPropagation){delayedTriggers.push(function(event){this._trigger("receive",event,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!noPropagation){delayedTriggers.push(function(event){this._trigger("update",event,this._uiHash())})}if(this!==this.currentContainer){if(!noPropagation){delayedTriggers.push(function(event){this._trigger("remove",event,this._uiHash())});delayedTriggers.push((function(c){return function(event){c._trigger("receive",event,this._uiHash(this))}}).call(this,this.currentContainer));delayedTriggers.push((function(c){return function(event){c._trigger("update",event,this._uiHash(this))}}).call(this,this.currentContainer))}}for(i=this.containers.length-1;i>=0;i--){if(!noPropagation){delayedTriggers.push((function(c){return function(event){c._trigger("deactivate",event,this._uiHash(this))}}).call(this,this.containers[i]))}if(this.containers[i].containerCache.over){delayedTriggers.push((function(c){return function(event){c._trigger("out",event,this._uiHash(this))}}).call(this,this.containers[i]));this.containers[i].containerCache.over=0}}if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove()}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!noPropagation){this._trigger("beforeStop",event,this._uiHash());for(i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event)}this._trigger("stop",event,this._uiHash())}this.fromOutside=false;return false}if(!noPropagation){this._trigger("beforeStop",event,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!==this.currentItem[0]){this.helper.remove()}this.helper=null;if(!noPropagation){for(i=0;i<delayedTriggers.length;i++){delayedTriggers[i].call(this,event)}this._trigger("stop",event,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if($.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(_inst){var inst=_inst||this;return{helper:inst.helper,placeholder:inst.placeholder||$([]),position:inst.position,originalPosition:inst.originalPosition,offset:inst.positionAbs,item:inst.currentItem,sender:_inst?_inst.element:null}}})})(jQuery);(function($,undefined){var dataSpace="ui-effects-";$.effects={effect:{}};
/*!
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */
(function(jQuery,undefined){var stepHooks="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1]*2.55,execResult[2]*2.55,execResult[3]*2.55,execResult[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]]}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha)},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={"byte":{floor:true,max:255},percent:{max:1},degrees:{mod:360,floor:true}},support=color.support={},supportElem=jQuery("<p>")[0],colors,each=jQuery.each;supportElem.style.cssText="background-color:rgba(1,1,1,.5)";support.rgba=supportElem.style.backgroundColor.indexOf("rgba")>-1;each(spaces,function(spaceName,space){space.cache="_"+spaceName;space.props.alpha={idx:3,type:"percent",def:1}});function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};if(value==null){return(allowEmpty||!prop.def)?null:prop.def}value=type.floor?~~value:parseFloat(value);if(isNaN(value)){return prop.def}if(type.mod){return(value+type.mod)%type.mod}return 0>value?0:type.max<value?type.max:value}function stringParse(string){var inst=color(),rgba=inst._rgba=[];string=string.toLowerCase();each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values){parsed=inst[spaceName](values);inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache];rgba=inst._rgba=parsed._rgba;return false}});if(rgba.length){if(rgba.join()==="0,0,0,0"){jQuery.extend(rgba,colors.transparent)}return inst}return colors[string]}color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(red===undefined){this._rgba=[null,null,null,null];return this}if(red.jquery||red.nodeType){red=jQuery(red).css(green);green=undefined}var inst=this,type=jQuery.type(red),rgba=this._rgba=[];if(green!==undefined){red=[red,green,blue,alpha];type="array"}if(type==="string"){return this.parse(stringParse(red)||colors._default)}if(type==="array"){each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop)});return this}if(type==="object"){if(red instanceof color){each(spaces,function(spaceName,space){if(red[space.cache]){inst[space.cache]=red[space.cache].slice()}})}else{each(spaces,function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if(key==="alpha"||red[key]==null){return}inst[cache]=space.to(inst._rgba)}inst[cache][prop.idx]=clamp(red[key],prop,true)});if(inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0){inst[cache][3]=1;if(space.from){inst._rgba=space.from(inst[cache])}}})}return this}},is:function(compare){var is=color(compare),same=true,inst=this;each(spaces,function(_,space){var localCache,isCache=is[space.cache];if(isCache){localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[];each(space.props,function(_,prop){if(isCache[prop.idx]!=null){same=(isCache[prop.idx]===localCache[prop.idx]);return same}})}return same});return same},_space:function(){var used=[],inst=this;each(spaces,function(spaceName,space){if(inst[space.cache]){used.push(spaceName)}});return used.pop()},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=this.alpha()===0?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();end=end[space.cache];each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};if(endValue===null){return}if(startValue===null){result[index]=endValue}else{if(type.mod){if(endValue-startValue>type.mod/2){startValue+=type.mod}else{if(startValue-endValue>type.mod/2){startValue-=type.mod}}}result[index]=clamp((endValue-startValue)*distance+startValue,prop)}});return this[spaceName](result)},blend:function(opaque){if(this._rgba[3]===1){return this}var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v}))},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return v==null?(i>2?1:0):v});if(rgba[3]===1){rgba.pop();prefix="rgb("}return prefix+rgba.join()+")"},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){if(v==null){v=i>2?1:0}if(i&&i<3){v=Math.round(v*100)+"%"}return v});if(hsla[3]===1){hsla.pop();prefix="hsl("}return prefix+hsla.join()+")"},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();if(includeAlpha){rgba.push(~~(alpha*255))}return"#"+jQuery.map(rgba,function(v){v=(v||0).toString(16);return v.length===1?"0"+v:v}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}});color.fn.parse.prototype=color.fn;function hue2rgb(p,q,h){h=(h+1)%1;if(h*6<1){return p+(q-p)*h*6}if(h*2<1){return q}if(h*3<2){return p+(q-p)*((2/3)-h)*6}return p}spaces.hsla.to=function(rgba){if(rgba[0]==null||rgba[1]==null||rgba[2]==null){return[null,null,null,rgba[3]]}var r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=add*0.5,h,s;if(min===max){h=0}else{if(r===max){h=(60*(g-b)/diff)+360}else{if(g===max){h=(60*(b-r)/diff)+120}else{h=(60*(r-g)/diff)+240}}}if(diff===0){s=0}else{if(l<=0.5){s=diff/add}else{s=diff/(2-add)}}return[Math.round(h)%360,s,l,a==null?1:a]};spaces.hsla.from=function(hsla){if(hsla[0]==null||hsla[1]==null||hsla[2]==null){return[null,null,null,hsla[3]]}var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=0.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(hue2rgb(p,q,h+(1/3))*255),Math.round(hue2rgb(p,q,h)*255),Math.round(hue2rgb(p,q,h-(1/3))*255),a]};each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]){this[cache]=to(this._rgba)}if(value===undefined){return this[cache].slice()}var ret,type=jQuery.type(value),arr=(type==="array"||type==="object")?value:arguments,local=this[cache].slice();each(props,function(key,prop){var val=arr[type==="object"?key:prop.idx];if(val==null){val=local[prop.idx]}local[prop.idx]=clamp(val,prop)});if(from){ret=color(from(local));ret[cache]=local;return ret}else{return color(local)}};each(props,function(key,prop){if(color.fn[key]){return}color.fn[key]=function(value){var vtype=jQuery.type(value),fn=(key==="alpha"?(this._hsla?"hsla":"rgba"):spaceName),local=this[fn](),cur=local[prop.idx],match;if(vtype==="undefined"){return cur}if(vtype==="function"){value=value.call(this,cur);vtype=jQuery.type(value)}if(value==null&&prop.empty){return this}if(vtype==="string"){match=rplusequals.exec(value);if(match){value=cur+parseFloat(match[2])*(match[1]==="+"?1:-1)}}local[prop.idx]=value;return this[fn](local)}})});color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if(value!=="transparent"&&(jQuery.type(value)!=="string"||(parsed=stringParse(value)))){value=color(parsed||value);if(!support.rgba&&value._rgba[3]!==1){curElem=hook==="backgroundColor"?elem.parentNode:elem;while((backgroundColor===""||backgroundColor==="transparent")&&curElem&&curElem.style){try{backgroundColor=jQuery.css(curElem,"backgroundColor");curElem=curElem.parentNode}catch(e){}}value=value.blend(backgroundColor&&backgroundColor!=="transparent"?backgroundColor:"_default")}value=value.toRgbaString()}try{elem.style[hook]=value}catch(e){}}};jQuery.fx.step[hook]=function(fx){if(!fx.colorInit){fx.start=color(fx.elem,hook);fx.end=color(fx.end);fx.colorInit=true}jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos))}})};color.hook(stepHooks);jQuery.cssHooks.borderColor={expand:function(value){var expanded={};each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value});return expanded}};colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);(function(){var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};$.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(_,prop){$.fx.step[prop]=function(fx){if(fx.end!=="none"&&!fx.setAttr||fx.pos===1&&!fx.setAttr){jQuery.style(fx.elem,prop,fx.end);fx.setAttr=true}}});function getElementStyles(elem){var key,len,style=elem.ownerDocument.defaultView?elem.ownerDocument.defaultView.getComputedStyle(elem,null):elem.currentStyle,styles={};if(style&&style.length&&style[0]&&style[style[0]]){len=style.length;while(len--){key=style[len];if(typeof style[key]==="string"){styles[$.camelCase(key)]=style[key]}}}else{for(key in style){if(typeof style[key]==="string"){styles[key]=style[key]}}}return styles}function styleDifference(oldStyle,newStyle){var diff={},name,value;for(name in newStyle){value=newStyle[name];if(oldStyle[name]!==value){if(!shorthandStyles[name]){if($.fx.step[name]||!isNaN(parseFloat(value))){diff[name]=value}}}}return diff}if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}}$.effects.animateClass=function(value,duration,easing,callback){var o=$.speed(duration,easing,callback);return this.queue(function(){var animated=$(this),baseClass=animated.attr("class")||"",applyClassChange,allAnimations=o.children?animated.find("*").addBack():animated;allAnimations=allAnimations.map(function(){var el=$(this);return{el:el,start:getElementStyles(this)}});applyClassChange=function(){$.each(classAnimationActions,function(i,action){if(value[action]){animated[action+"Class"](value[action])}})};applyClassChange();allAnimations=allAnimations.map(function(){this.end=getElementStyles(this.el[0]);this.diff=styleDifference(this.start,this.end);return this});animated.attr("class",baseClass);allAnimations=allAnimations.map(function(){var styleInfo=this,dfd=$.Deferred(),opts=$.extend({},o,{queue:false,complete:function(){dfd.resolve(styleInfo)}});this.el.animate(this.diff,opts);return dfd.promise()});$.when.apply($,allAnimations.get()).done(function(){applyClassChange();$.each(arguments,function(){var el=this.el;$.each(this.diff,function(key){el.css(key,"")})});o.complete.call(animated[0])})})};$.fn.extend({addClass:(function(orig){return function(classNames,speed,easing,callback){return speed?$.effects.animateClass.call(this,{add:classNames},speed,easing,callback):orig.apply(this,arguments)}})($.fn.addClass),removeClass:(function(orig){return function(classNames,speed,easing,callback){return arguments.length>1?$.effects.animateClass.call(this,{remove:classNames},speed,easing,callback):orig.apply(this,arguments)}})($.fn.removeClass),toggleClass:(function(orig){return function(classNames,force,speed,easing,callback){if(typeof force==="boolean"||force===undefined){if(!speed){return orig.apply(this,arguments)}else{return $.effects.animateClass.call(this,(force?{add:classNames}:{remove:classNames}),speed,easing,callback)}}else{return $.effects.animateClass.call(this,{toggle:classNames},force,speed,easing)}}})($.fn.toggleClass),switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.call(this,{add:add,remove:remove},speed,easing,callback)}})})();(function(){$.extend($.effects,{version:"1.10.3",save:function(element,set){for(var i=0;i<set.length;i++){if(set[i]!==null){element.data(dataSpace+set[i],element[0].style[set[i]])}}},restore:function(element,set){var val,i;for(i=0;i<set.length;i++){if(set[i]!==null){val=element.data(dataSpace+set[i]);if(val===undefined){val=""}element.css(set[i],val)}}},setMode:function(el,mode){if(mode==="toggle"){mode=el.is(":hidden")?"show":"hide"}return mode},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=0.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height}switch(origin[1]){case"left":x=0;break;case"center":x=0.5;break;case"right":x=1;break;default:x=origin[1]/original.width}return{x:x,y:y}},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent()}var props={width:element.outerWidth(true),height:element.outerHeight(true),"float":element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),size={width:element.width(),height:element.height()},active=document.activeElement;try{active.id}catch(e){active=document.body}element.wrap(wrapper);if(element[0]===active||$.contains(element[0],active)){$(active).focus()}wrapper=element.parent();if(element.css("position")==="static"){wrapper.css({position:"relative"});element.css({position:"relative"})}else{$.extend(props,{position:element.css("position"),zIndex:element.css("z-index")});$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos);if(isNaN(parseInt(props[pos],10))){props[pos]="auto"}});element.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}element.css(size);return wrapper.css(props).show()},removeWrapper:function(element){var active=document.activeElement;if(element.parent().is(".ui-effects-wrapper")){element.parent().replaceWith(element);if(element[0]===active||$.contains(element[0],active)){$(active).focus()}}return element},setTransition:function(element,list,factor,value){value=value||{};$.each(list,function(i,x){var unit=element.cssUnit(x);if(unit[0]>0){value[x]=unit[0]*factor+unit[1]}});return value}});function _normalizeArguments(effect,options,speed,callback){if($.isPlainObject(effect)){options=effect;effect=effect.effect}effect={effect:effect};if(options==null){options={}}if($.isFunction(options)){callback=options;speed=null;options={}}if(typeof options==="number"||$.fx.speeds[options]){callback=speed;speed=options;options={}}if($.isFunction(speed)){callback=speed;speed=null}if(options){$.extend(effect,options)}speed=speed||options.duration;effect.duration=$.fx.off?0:typeof speed==="number"?speed:speed in $.fx.speeds?$.fx.speeds[speed]:$.fx.speeds._default;effect.complete=callback||options.complete;return effect}function standardAnimationOption(option){if(!option||typeof option==="number"||$.fx.speeds[option]){return true}if(typeof option==="string"&&!$.effects.effect[option]){return true}if($.isFunction(option)){return true}if(typeof option==="object"&&!option.effect){return true}return false}$.fn.extend({effect:function(){var args=_normalizeArguments.apply(this,arguments),mode=args.mode,queue=args.queue,effectMethod=$.effects.effect[args.effect];if($.fx.off||!effectMethod){if(mode){return this[mode](args.duration,args.complete)}else{return this.each(function(){if(args.complete){args.complete.call(this)}})}}function run(next){var elem=$(this),complete=args.complete,mode=args.mode;function done(){if($.isFunction(complete)){complete.call(elem[0])}if($.isFunction(next)){next()}}if(elem.is(":hidden")?mode==="hide":mode==="show"){elem[mode]();done()}else{effectMethod.call(elem[0],args,done)}}return queue===false?this.each(run):this.queue(queue||"fx",run)},show:(function(orig){return function(option){if(standardAnimationOption(option)){return orig.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args.mode="show";return this.effect.call(this,args)}}})($.fn.show),hide:(function(orig){return function(option){if(standardAnimationOption(option)){return orig.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args.mode="hide";return this.effect.call(this,args)}}})($.fn.hide),toggle:(function(orig){return function(option){if(standardAnimationOption(option)||typeof option==="boolean"){return orig.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args.mode="toggle";return this.effect.call(this,args)}}})($.fn.toggle),cssUnit:function(key){var style=this.css(key),val=[];$.each(["em","px","%","pt"],function(i,unit){if(style.indexOf(unit)>0){val=[parseFloat(style),unit]}});return val}})})();(function(){var baseEasings={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(i,name){baseEasings[name]=function(p){return Math.pow(p,i+2)}});$.extend(baseEasings,{Sine:function(p){return 1-Math.cos(p*Math.PI/2)},Circ:function(p){return 1-Math.sqrt(1-p*p)},Elastic:function(p){return p===0||p===1?p:-Math.pow(2,8*(p-1))*Math.sin(((p-1)*80-7.5)*Math.PI/15)},Back:function(p){return p*p*(3*p-2)},Bounce:function(p){var pow2,bounce=4;while(p<((pow2=Math.pow(2,--bounce))-1)/11){}return 1/Math.pow(4,3-bounce)-7.5625*Math.pow((pow2*3-2)/22-p,2)}});$.each(baseEasings,function(name,easeIn){$.easing["easeIn"+name]=easeIn;$.easing["easeOut"+name]=function(p){return 1-easeIn(1-p)};$.easing["easeInOut"+name]=function(p){return p<0.5?easeIn(p*2)/2:1-easeIn(p*-2+2)/2}})})()})(jQuery);(function($,undefined){var uid=0,hideProps={},showProps={};hideProps.height=hideProps.paddingTop=hideProps.paddingBottom=hideProps.borderTopWidth=hideProps.borderBottomWidth="hide";showProps.height=showProps.paddingTop=showProps.paddingBottom=showProps.borderTopWidth=showProps.borderBottomWidth="show";$.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:false,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var options=this.options;this.prevShow=this.prevHide=$();this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist");if(!options.collapsible&&(options.active===false||options.active==null)){options.active=0}this._processPanels();if(options.active<0){options.active+=this.headers.length}this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:!this.active.length?$():this.active.next(),content:!this.active.length?$():this.active.next()}},_createIcons:function(){var icons=this.options.icons;if(icons){$("<span>").addClass("ui-accordion-header-icon ui-icon "+icons.header).prependTo(this.headers);this.active.children(".ui-accordion-header-icon").removeClass(icons.header).addClass(icons.activeHeader);this.headers.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var contents;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){if(/^ui-accordion/.test(this.id)){this.removeAttribute("id")}});this._destroyIcons();contents=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){if(/^ui-accordion/.test(this.id)){this.removeAttribute("id")}});if(this.options.heightStyle!=="content"){contents.css("height","")}},_setOption:function(key,value){if(key==="active"){this._activate(value);return}if(key==="event"){if(this.options.event){this._off(this.headers,this.options.event)}this._setupEvents(value)}this._super(key,value);if(key==="collapsible"&&!value&&this.options.active===false){this._activate(0)}if(key==="icons"){this._destroyIcons();if(value){this._createIcons()}}if(key==="disabled"){this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!value)}},_keydown:function(event){if(event.altKey||event.ctrlKey){return}var keyCode=$.ui.keyCode,length=this.headers.length,currentIndex=this.headers.index(event.target),toFocus=false;switch(event.keyCode){case keyCode.RIGHT:case keyCode.DOWN:toFocus=this.headers[(currentIndex+1)%length];break;case keyCode.LEFT:case keyCode.UP:toFocus=this.headers[(currentIndex-1+length)%length];break;case keyCode.SPACE:case keyCode.ENTER:this._eventHandler(event);break;case keyCode.HOME:toFocus=this.headers[0];break;case keyCode.END:toFocus=this.headers[length-1];break}if(toFocus){$(event.target).attr("tabIndex",-1);$(toFocus).attr("tabIndex",0);toFocus.focus();event.preventDefault()}},_panelKeyDown:function(event){if(event.keyCode===$.ui.keyCode.UP&&event.ctrlKey){$(event.currentTarget).prev().focus()}},refresh:function(){var options=this.options;this._processPanels();if((options.active===false&&options.collapsible===true)||!this.headers.length){options.active=false;this.active=$()}else{if(options.active===false){this._activate(0)}else{if(this.active.length&&!$.contains(this.element[0],this.active[0])){if(this.headers.length===this.headers.find(".ui-state-disabled").length){options.active=false;this.active=$()}else{this._activate(Math.max(0,options.active-1))}}else{options.active=this.headers.index(this.active)}}}this._destroyIcons();this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var maxHeight,options=this.options,heightStyle=options.heightStyle,parent=this.element.parent(),accordionId=this.accordionId="ui-accordion-"+(this.element.attr("id")||++uid);this.active=this._findActive(options.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all");this.active.next().addClass("ui-accordion-content-active").show();this.headers.attr("role","tab").each(function(i){var header=$(this),headerId=header.attr("id"),panel=header.next(),panelId=panel.attr("id");if(!headerId){headerId=accordionId+"-header-"+i;header.attr("id",headerId)}if(!panelId){panelId=accordionId+"-panel-"+i;panel.attr("id",panelId)}header.attr("aria-controls",panelId);panel.attr("aria-labelledby",headerId)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex",0)}else{this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"})}this._createIcons();this._setupEvents(options.event);if(heightStyle==="fill"){maxHeight=parent.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return}maxHeight-=elem.outerHeight(true)});this.headers.each(function(){maxHeight-=$(this).outerHeight(true)});this.headers.next().each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")}else{if(heightStyle==="auto"){maxHeight=0;this.headers.next().each(function(){maxHeight=Math.max(maxHeight,$(this).css("height","").height())}).height(maxHeight)}}},_activate:function(index){var active=this._findActive(index)[0];if(active===this.active[0]){return}active=active||this.active[0];this._eventHandler({target:active,currentTarget:active,preventDefault:$.noop})},_findActive:function(selector){return typeof selector==="number"?this.headers.eq(selector):$()},_setupEvents:function(event){var events={keydown:"_keydown"};if(event){$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"})}this._off(this.headers.add(this.headers.next()));this._on(this.headers,events);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(event){var options=this.options,active=this.active,clicked=$(event.currentTarget),clickedIsActive=clicked[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():clicked.next(),toHide=active.next(),eventData={oldHeader:active,oldPanel:toHide,newHeader:collapsing?$():clicked,newPanel:toShow};event.preventDefault();if((clickedIsActive&&!options.collapsible)||(this._trigger("beforeActivate",event,eventData)===false)){return}options.active=collapsing?false:this.headers.index(clicked);this.active=clickedIsActive?$():clicked;this._toggle(eventData);active.removeClass("ui-accordion-header-active ui-state-active");if(options.icons){active.children(".ui-accordion-header-icon").removeClass(options.icons.activeHeader).addClass(options.icons.header)}if(!clickedIsActive){clicked.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top");if(options.icons){clicked.children(".ui-accordion-header-icon").removeClass(options.icons.header).addClass(options.icons.activeHeader)}clicked.next().addClass("ui-accordion-content-active")}},_toggle:function(data){var toShow=data.newPanel,toHide=this.prevShow.length?this.prevShow:data.oldPanel;this.prevShow.add(this.prevHide).stop(true,true);this.prevShow=toShow;this.prevHide=toHide;if(this.options.animate){this._animate(toShow,toHide,data)}else{toHide.hide();toShow.show();this._toggleComplete(data)}toHide.attr({"aria-expanded":"false","aria-hidden":"true"});toHide.prev().attr("aria-selected","false");if(toShow.length&&toHide.length){toHide.prev().attr("tabIndex",-1)}else{if(toShow.length){this.headers.filter(function(){return $(this).attr("tabIndex")===0}).attr("tabIndex",-1)}}toShow.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(toShow,toHide,data){var total,easing,duration,that=this,adjust=0,down=toShow.length&&(!toHide.length||(toShow.index()<toHide.index())),animate=this.options.animate||{},options=down&&animate.down||animate,complete=function(){that._toggleComplete(data)};if(typeof options==="number"){duration=options}if(typeof options==="string"){easing=options}easing=easing||options.easing||animate.easing;duration=duration||options.duration||animate.duration;if(!toHide.length){return toShow.animate(showProps,duration,easing,complete)}if(!toShow.length){return toHide.animate(hideProps,duration,easing,complete)}total=toShow.show().outerHeight();toHide.animate(hideProps,{duration:duration,easing:easing,step:function(now,fx){fx.now=Math.round(now)}});toShow.hide().animate(showProps,{duration:duration,easing:easing,complete:complete,step:function(now,fx){fx.now=Math.round(now);if(fx.prop!=="height"){adjust+=fx.now}else{if(that.options.heightStyle!=="content"){fx.now=Math.round(total-toHide.outerHeight()-adjust);adjust=0}}}})},_toggleComplete:function(data){var toHide=data.oldPanel;toHide.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");if(toHide.length){toHide.parent()[0].className=toHide.parent()[0].className}this._trigger("activate",null,data)}})})(jQuery);(function($,undefined){var requestIndex=0;$.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var suppressKeyPress,suppressKeyPressRepeat,suppressInput,nodeName=this.element[0].nodeName.toLowerCase(),isTextarea=nodeName==="textarea",isInput=nodeName==="input";this.isMultiLine=isTextarea?true:isInput?false:this.element.prop("isContentEditable");this.valueMethod=this.element[isTextarea||isInput?"val":"text"];this.isNewMenu=true;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on(this.element,{keydown:function(event){if(this.element.prop("readOnly")){suppressKeyPress=true;suppressInput=true;suppressKeyPressRepeat=true;return}suppressKeyPress=false;suppressInput=false;suppressKeyPressRepeat=false;var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:suppressKeyPress=true;this._move("previousPage",event);break;case keyCode.PAGE_DOWN:suppressKeyPress=true;this._move("nextPage",event);break;case keyCode.UP:suppressKeyPress=true;this._keyEvent("previous",event);break;case keyCode.DOWN:suppressKeyPress=true;this._keyEvent("next",event);break;case keyCode.ENTER:case keyCode.NUMPAD_ENTER:if(this.menu.active){suppressKeyPress=true;event.preventDefault();this.menu.select(event)}break;case keyCode.TAB:if(this.menu.active){this.menu.select(event)}break;case keyCode.ESCAPE:if(this.menu.element.is(":visible")){this._value(this.term);this.close(event);event.preventDefault()}break;default:suppressKeyPressRepeat=true;this._searchTimeout(event);break}},keypress:function(event){if(suppressKeyPress){suppressKeyPress=false;if(!this.isMultiLine||this.menu.element.is(":visible")){event.preventDefault()}return}if(suppressKeyPressRepeat){return}var keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.PAGE_UP:this._move("previousPage",event);break;case keyCode.PAGE_DOWN:this._move("nextPage",event);break;case keyCode.UP:this._keyEvent("previous",event);break;case keyCode.DOWN:this._keyEvent("next",event);break}},input:function(event){if(suppressInput){suppressInput=false;event.preventDefault();return}this._searchTimeout(event)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(event){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching);this.close(event);this._change(event)}});this._initSource();this.menu=$("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu");this._on(this.menu.element,{mousedown:function(event){event.preventDefault();this.cancelBlur=true;this._delay(function(){delete this.cancelBlur});var menuElement=this.menu.element[0];if(!$(event.target).closest(".ui-menu-item").length){this._delay(function(){var that=this;this.document.one("mousedown",function(event){if(event.target!==that.element[0]&&event.target!==menuElement&&!$.contains(menuElement,event.target)){that.close()}})})}},menufocus:function(event,ui){if(this.isNewMenu){this.isNewMenu=false;if(event.originalEvent&&/^mouse/.test(event.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){$(event.target).trigger(event.originalEvent)});return}}var item=ui.item.data("ui-autocomplete-item");if(false!==this._trigger("focus",event,{item:item})){if(event.originalEvent&&/^key/.test(event.originalEvent.type)){this._value(item.value)}}else{this.liveRegion.text(item.value)}},menuselect:function(event,ui){var item=ui.item.data("ui-autocomplete-item"),previous=this.previous;if(this.element[0]!==this.document[0].activeElement){this.element.focus();this.previous=previous;this._delay(function(){this.previous=previous;this.selectedItem=item})}if(false!==this._trigger("select",event,{item:item})){this._value(item.value)}this.term=this._value();this.close(event);this.selectedItem=item}});this.liveRegion=$("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element);this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(key,value){this._super(key,value);if(key==="source"){this._initSource()}if(key==="appendTo"){this.menu.element.appendTo(this._appendTo())}if(key==="disabled"&&value&&this.xhr){this.xhr.abort()}},_appendTo:function(){var element=this.options.appendTo;if(element){element=element.jquery||element.nodeType?$(element):this.document.find(element).eq(0)}if(!element){element=this.element.closest(".ui-front")}if(!element.length){element=this.document[0].body}return element},_initSource:function(){var array,url,that=this;if($.isArray(this.options.source)){array=this.options.source;this.source=function(request,response){response($.ui.autocomplete.filter(array,request.term))}}else{if(typeof this.options.source==="string"){url=this.options.source;this.source=function(request,response){if(that.xhr){that.xhr.abort()}that.xhr=$.ajax({url:url,data:request,dataType:"json",success:function(data){response(data)},error:function(){response([])}})}}else{this.source=this.options.source}}},_searchTimeout:function(event){clearTimeout(this.searching);this.searching=this._delay(function(){if(this.term!==this._value()){this.selectedItem=null;this.search(null,event)}},this.options.delay)},search:function(value,event){value=value!=null?value:this._value();this.term=this._value();if(value.length<this.options.minLength){return this.close(event)}if(this._trigger("search",event)===false){return}return this._search(value)},_search:function(value){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=false;this.source({term:value},this._response())},_response:function(){var that=this,index=++requestIndex;return function(content){if(index===requestIndex){that.__response(content)}that.pending--;if(!that.pending){that.element.removeClass("ui-autocomplete-loading")}}},__response:function(content){if(content){content=this._normalize(content)}this._trigger("response",null,{content:content});if(!this.options.disabled&&content&&content.length&&!this.cancelSearch){this._suggest(content);this._trigger("open")}else{this._close()}},close:function(event){this.cancelSearch=true;this._close(event)},_close:function(event){if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=true;this._trigger("close",event)}},_change:function(event){if(this.previous!==this._value()){this._trigger("change",event,{item:this.selectedItem})}},_normalize:function(items){if(items.length&&items[0].label&&items[0].value){return items}return $.map(items,function(item){if(typeof item==="string"){return{label:item,value:item}}return $.extend({label:item.label||item.value,value:item.value||item.label},item)})},_suggest:function(items){var ul=this.menu.element.empty();this._renderMenu(ul,items);this.isNewMenu=true;this.menu.refresh();ul.show();this._resizeMenu();ul.position($.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next()}},_resizeMenu:function(){var ul=this.menu.element;ul.outerWidth(Math.max(ul.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(ul,items){var that=this;$.each(items,function(index,item){that._renderItemData(ul,item)})},_renderItemData:function(ul,item){return this._renderItem(ul,item).data("ui-autocomplete-item",item)},_renderItem:function(ul,item){return $("<li>").append($("<a>").text(item.label)).appendTo(ul)},_move:function(direction,event){if(!this.menu.element.is(":visible")){this.search(null,event);return}if(this.menu.isFirstItem()&&/^previous/.test(direction)||this.menu.isLastItem()&&/^next/.test(direction)){this._value(this.term);this.menu.blur();return}this.menu[direction](event)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(keyEvent,event){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(keyEvent,event);event.preventDefault()}}});$.extend($.ui.autocomplete,{escapeRegex:function(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(array,term){var matcher=new RegExp($.ui.autocomplete.escapeRegex(term),"i");return $.grep(array,function(value){return matcher.test(value.label||value.value||value)})}});$.widget("ui.autocomplete",$.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(amount){return amount+(amount>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(content){var message;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return}if(content&&content.length){message=this.options.messages.results(content.length)}else{message=this.options.messages.noResults}this.liveRegion.text(message)}})}(jQuery));(function($,undefined){var lastActive,startXPos,startYPos,clickDragged,baseClasses="ui-button ui-widget ui-state-default ui-corner-all",stateClasses="ui-state-hover ui-state-active ",typeClasses="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",formResetHandler=function(){var form=$(this);setTimeout(function(){form.find(":ui-button").button("refresh")},1)},radioGroup=function(radio){var name=radio.name,form=radio.form,radios=$([]);if(name){name=name.replace(/'/g,"\\'");if(form){radios=$(form).find("[name='"+name+"']")}else{radios=$("[name='"+name+"']",radio.ownerDocument).filter(function(){return !this.form})}}return radios};$.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,formResetHandler);if(typeof this.options.disabled!=="boolean"){this.options.disabled=!!this.element.prop("disabled")}else{this.element.prop("disabled",this.options.disabled)}this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var that=this,options=this.options,toggleButton=this.type==="checkbox"||this.type==="radio",activeClass=!toggleButton?"ui-state-active":"",focusClass="ui-state-focus";if(options.label===null){options.label=(this.type==="input"?this.buttonElement.val():this.buttonElement.html())}this._hoverable(this.buttonElement);this.buttonElement.addClass(baseClasses).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(options.disabled){return}if(this===lastActive){$(this).addClass("ui-state-active")}}).bind("mouseleave"+this.eventNamespace,function(){if(options.disabled){return}$(this).removeClass(activeClass)}).bind("click"+this.eventNamespace,function(event){if(options.disabled){event.preventDefault();event.stopImmediatePropagation()}});this.element.bind("focus"+this.eventNamespace,function(){that.buttonElement.addClass(focusClass)}).bind("blur"+this.eventNamespace,function(){that.buttonElement.removeClass(focusClass)});if(toggleButton){this.element.bind("change"+this.eventNamespace,function(){if(clickDragged){return}that.refresh()});this.buttonElement.bind("mousedown"+this.eventNamespace,function(event){if(options.disabled){return}clickDragged=false;startXPos=event.pageX;startYPos=event.pageY}).bind("mouseup"+this.eventNamespace,function(event){if(options.disabled){return}if(startXPos!==event.pageX||startYPos!==event.pageY){clickDragged=true}})}if(this.type==="checkbox"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled||clickDragged){return false}})}else{if(this.type==="radio"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(options.disabled||clickDragged){return false}$(this).addClass("ui-state-active");that.buttonElement.attr("aria-pressed","true");var radio=that.element[0];radioGroup(radio).not(radio).map(function(){return $(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")})}else{this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(options.disabled){return false}$(this).addClass("ui-state-active");lastActive=this;that.document.one("mouseup",function(){lastActive=null})}).bind("mouseup"+this.eventNamespace,function(){if(options.disabled){return false}$(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(event){if(options.disabled){return false}if(event.keyCode===$.ui.keyCode.SPACE||event.keyCode===$.ui.keyCode.ENTER){$(this).addClass("ui-state-active")}}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){$(this).removeClass("ui-state-active")});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(event){if(event.keyCode===$.ui.keyCode.SPACE){$(this).click()}})}}}this._setOption("disabled",options.disabled);this._resetButton()},_determineButtonType:function(){var ancestor,labelSelector,checked;if(this.element.is("[type=checkbox]")){this.type="checkbox"}else{if(this.element.is("[type=radio]")){this.type="radio"}else{if(this.element.is("input")){this.type="input"}else{this.type="button"}}}if(this.type==="checkbox"||this.type==="radio"){ancestor=this.element.parents().last();labelSelector="label[for='"+this.element.attr("id")+"']";this.buttonElement=ancestor.find(labelSelector);if(!this.buttonElement.length){ancestor=ancestor.length?ancestor.siblings():this.element.siblings();this.buttonElement=ancestor.filter(labelSelector);if(!this.buttonElement.length){this.buttonElement=ancestor.find(labelSelector)}}this.element.addClass("ui-helper-hidden-accessible");checked=this.element.is(":checked");if(checked){this.buttonElement.addClass("ui-state-active")}this.buttonElement.prop("aria-pressed",checked)}else{this.buttonElement=this.element}},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(baseClasses+" "+stateClasses+" "+typeClasses).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle){this.buttonElement.removeAttr("title")}},_setOption:function(key,value){this._super(key,value);if(key==="disabled"){if(value){this.element.prop("disabled",true)}else{this.element.prop("disabled",false)}return}this._resetButton()},refresh:function(){var isDisabled=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");if(isDisabled!==this.options.disabled){this._setOption("disabled",isDisabled)}if(this.type==="radio"){radioGroup(this.element[0]).each(function(){if($(this).is(":checked")){$(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true")}else{$(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}})}else{if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true")}else{this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false")}}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label)}return}var buttonElement=this.buttonElement.removeClass(typeClasses),buttonText=$("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(buttonElement.empty()).text(),icons=this.options.icons,multipleIcons=icons.primary&&icons.secondary,buttonClasses=[];if(icons.primary||icons.secondary){if(this.options.text){buttonClasses.push("ui-button-text-icon"+(multipleIcons?"s":(icons.primary?"-primary":"-secondary")))}if(icons.primary){buttonElement.prepend("<span class='ui-button-icon-primary ui-icon "+icons.primary+"'></span>")}if(icons.secondary){buttonElement.append("<span class='ui-button-icon-secondary ui-icon "+icons.secondary+"'></span>")}if(!this.options.text){buttonClasses.push(multipleIcons?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle){buttonElement.attr("title",$.trim(buttonText))}}}else{buttonClasses.push("ui-button-text-only")}buttonElement.addClass(buttonClasses.join(" "))}});$.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(key,value){if(key==="disabled"){this.buttons.button("option",key,value)}this._super(key,value)},refresh:function(){var rtl=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(rtl?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(rtl?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return $(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery));(function($,undefined){$.extend($.ui,{datepicker:{version:"1.10.3"}});var PROP_NAME="datepicker",instActive;function Datepicker(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};$.extend(this._defaults,this.regional[""]);this.dpDiv=bindHover($("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(settings){extendRemove(this._defaults,settings||{});return this},_attachDatepicker:function(target,settings){var nodeName,inline,inst;nodeName=target.nodeName.toLowerCase();inline=(nodeName==="div"||nodeName==="span");if(!target.id){this.uuid+=1;target.id="dp"+this.uuid}inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{});if(nodeName==="input"){this._connectDatepicker(target,inst)}else{if(inline){this._inlineDatepicker(target,inst)}}},_newInst:function(target,inline){var id=target[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:id,input:target,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:inline,dpDiv:(!inline?this.dpDiv:bindHover($("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")))}},_connectDatepicker:function(target,inst){var input=$(target);inst.append=$([]);inst.trigger=$([]);if(input.hasClass(this.markerClassName)){return}this._attachments(input,inst);input.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);this._autoSize(inst);$.data(target,PROP_NAME,inst);if(inst.settings.disabled){this._disableDatepicker(target)}},_attachments:function(input,inst){var showOn,buttonText,buttonImage,appendText=this._get(inst,"appendText"),isRTL=this._get(inst,"isRTL");if(inst.append){inst.append.remove()}if(appendText){inst.append=$("<span class='"+this._appendClass+"'>"+appendText+"</span>");input[isRTL?"before":"after"](inst.append)}input.unbind("focus",this._showDatepicker);if(inst.trigger){inst.trigger.remove()}showOn=this._get(inst,"showOn");if(showOn==="focus"||showOn==="both"){input.focus(this._showDatepicker)}if(showOn==="button"||showOn==="both"){buttonText=this._get(inst,"buttonText");buttonImage=this._get(inst,"buttonImage");inst.trigger=$(this._get(inst,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:buttonImage,alt:buttonText,title:buttonText}):$("<button type='button'></button>").addClass(this._triggerClass).html(!buttonImage?buttonText:$("<img/>").attr({src:buttonImage,alt:buttonText,title:buttonText})));input[isRTL?"before":"after"](inst.trigger);inst.trigger.click(function(){if($.datepicker._datepickerShowing&&$.datepicker._lastInput===input[0]){$.datepicker._hideDatepicker()}else{if($.datepicker._datepickerShowing&&$.datepicker._lastInput!==input[0]){$.datepicker._hideDatepicker();$.datepicker._showDatepicker(input[0])}else{$.datepicker._showDatepicker(input[0])}}return false})}},_autoSize:function(inst){if(this._get(inst,"autoSize")&&!inst.inline){var findMax,max,maxI,i,date=new Date(2009,12-1,20),dateFormat=this._get(inst,"dateFormat");if(dateFormat.match(/[DM]/)){findMax=function(names){max=0;maxI=0;for(i=0;i<names.length;i++){if(names[i].length>max){max=names[i].length;maxI=i}}return maxI};date.setMonth(findMax(this._get(inst,(dateFormat.match(/MM/)?"monthNames":"monthNamesShort"))));date.setDate(findMax(this._get(inst,(dateFormat.match(/DD/)?"dayNames":"dayNamesShort")))+20-date.getDay())}inst.input.attr("size",this._formatDate(inst,date).length)}},_inlineDatepicker:function(target,inst){var divSpan=$(target);if(divSpan.hasClass(this.markerClassName)){return}divSpan.addClass(this.markerClassName).append(inst.dpDiv);$.data(target,PROP_NAME,inst);this._setDate(inst,this._getDefaultDate(inst),true);this._updateDatepicker(inst);this._updateAlternate(inst);if(inst.settings.disabled){this._disableDatepicker(target)}inst.dpDiv.css("display","block")},_dialogDatepicker:function(input,date,onSelect,settings,pos){var id,browserWidth,browserHeight,scrollX,scrollY,inst=this._dialogInst;if(!inst){this.uuid+=1;id="dp"+this.uuid;this._dialogInput=$("<input type='text' id='"+id+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.keydown(this._doKeyDown);$("body").append(this._dialogInput);inst=this._dialogInst=this._newInst(this._dialogInput,false);inst.settings={};$.data(this._dialogInput[0],PROP_NAME,inst)}extendRemove(inst.settings,settings||{});date=(date&&date.constructor===Date?this._formatDate(inst,date):date);this._dialogInput.val(date);this._pos=(pos?(pos.length?pos:[pos.pageX,pos.pageY]):null);if(!this._pos){browserWidth=document.documentElement.clientWidth;browserHeight=document.documentElement.clientHeight;scrollX=document.documentElement.scrollLeft||document.body.scrollLeft;scrollY=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(browserWidth/2)-100+scrollX,(browserHeight/2)-150+scrollY]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");inst.settings.onSelect=onSelect;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if($.blockUI){$.blockUI(this.dpDiv)}$.data(this._dialogInput[0],PROP_NAME,inst);return this},_destroyDatepicker:function(target){var nodeName,$target=$(target),inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}nodeName=target.nodeName.toLowerCase();$.removeData(target,PROP_NAME);if(nodeName==="input"){inst.append.remove();inst.trigger.remove();$target.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(nodeName==="div"||nodeName==="span"){$target.removeClass(this.markerClassName).empty()}}},_enableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}nodeName=target.nodeName.toLowerCase();if(nodeName==="input"){target.disabled=false;inst.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(nodeName==="div"||nodeName==="span"){inline=$target.children("."+this._inlineClass);inline.children().removeClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false)}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value===target?null:value)})},_disableDatepicker:function(target){var nodeName,inline,$target=$(target),inst=$.data(target,PROP_NAME);if(!$target.hasClass(this.markerClassName)){return}nodeName=target.nodeName.toLowerCase();if(nodeName==="input"){target.disabled=true;inst.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(nodeName==="div"||nodeName==="span"){inline=$target.children("."+this._inlineClass);inline.children().addClass("ui-state-disabled");inline.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true)}}this._disabledInputs=$.map(this._disabledInputs,function(value){return(value===target?null:value)});this._disabledInputs[this._disabledInputs.length]=target},_isDisabledDatepicker:function(target){if(!target){return false}for(var i=0;i<this._disabledInputs.length;i++){if(this._disabledInputs[i]===target){return true}}return false},_getInst:function(target){try{return $.data(target,PROP_NAME)}catch(err){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(target,name,value){var settings,date,minDate,maxDate,inst=this._getInst(target);if(arguments.length===2&&typeof name==="string"){return(name==="defaults"?$.extend({},$.datepicker._defaults):(inst?(name==="all"?$.extend({},inst.settings):this._get(inst,name)):null))}settings=name||{};if(typeof name==="string"){settings={};settings[name]=value}if(inst){if(this._curInst===inst){this._hideDatepicker()}date=this._getDateDatepicker(target,true);minDate=this._getMinMaxDate(inst,"min");maxDate=this._getMinMaxDate(inst,"max");extendRemove(inst.settings,settings);if(minDate!==null&&settings.dateFormat!==undefined&&settings.minDate===undefined){inst.settings.minDate=this._formatDate(inst,minDate)}if(maxDate!==null&&settings.dateFormat!==undefined&&settings.maxDate===undefined){inst.settings.maxDate=this._formatDate(inst,maxDate)}if("disabled" in settings){if(settings.disabled){this._disableDatepicker(target)}else{this._enableDatepicker(target)}}this._attachments($(target),inst);this._autoSize(inst);this._setDate(inst,date);this._updateAlternate(inst);this._updateDatepicker(inst)}},_changeDatepicker:function(target,name,value){this._optionDatepicker(target,name,value)},_refreshDatepicker:function(target){var inst=this._getInst(target);if(inst){this._updateDatepicker(inst)}},_setDateDatepicker:function(target,date){var inst=this._getInst(target);if(inst){this._setDate(inst,date);this._updateDatepicker(inst);this._updateAlternate(inst)}},_getDateDatepicker:function(target,noDefault){var inst=this._getInst(target);if(inst&&!inst.inline){this._setDateFromField(inst,noDefault)}return(inst?this._getDate(inst):null)},_doKeyDown:function(event){var onSelect,dateStr,sel,inst=$.datepicker._getInst(event.target),handled=true,isRTL=inst.dpDiv.is(".ui-datepicker-rtl");inst._keyEvent=true;if($.datepicker._datepickerShowing){switch(event.keyCode){case 9:$.datepicker._hideDatepicker();handled=false;break;case 13:sel=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",inst.dpDiv);if(sel[0]){$.datepicker._selectDay(event.target,inst.selectedMonth,inst.selectedYear,sel[0])}onSelect=$.datepicker._get(inst,"onSelect");if(onSelect){dateStr=$.datepicker._formatDate(inst);onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{$.datepicker._hideDatepicker()}return false;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M");break;case 34:$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M");break;case 35:if(event.ctrlKey||event.metaKey){$.datepicker._clearDate(event.target)}handled=event.ctrlKey||event.metaKey;break;case 36:if(event.ctrlKey||event.metaKey){$.datepicker._gotoToday(event.target)}handled=event.ctrlKey||event.metaKey;break;case 37:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?+1:-1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?-$.datepicker._get(inst,"stepBigMonths"):-$.datepicker._get(inst,"stepMonths")),"M")}break;case 38:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,-7,"D")}handled=event.ctrlKey||event.metaKey;break;case 39:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,(isRTL?-1:+1),"D")}handled=event.ctrlKey||event.metaKey;if(event.originalEvent.altKey){$.datepicker._adjustDate(event.target,(event.ctrlKey?+$.datepicker._get(inst,"stepBigMonths"):+$.datepicker._get(inst,"stepMonths")),"M")}break;case 40:if(event.ctrlKey||event.metaKey){$.datepicker._adjustDate(event.target,+7,"D")}handled=event.ctrlKey||event.metaKey;break;default:handled=false}}else{if(event.keyCode===36&&event.ctrlKey){$.datepicker._showDatepicker(this)}else{handled=false}}if(handled){event.preventDefault();event.stopPropagation()}},_doKeyPress:function(event){var chars,chr,inst=$.datepicker._getInst(event.target);if($.datepicker._get(inst,"constrainInput")){chars=$.datepicker._possibleChars($.datepicker._get(inst,"dateFormat"));chr=String.fromCharCode(event.charCode==null?event.keyCode:event.charCode);return event.ctrlKey||event.metaKey||(chr<" "||!chars||chars.indexOf(chr)>-1)}},_doKeyUp:function(event){var date,inst=$.datepicker._getInst(event.target);if(inst.input.val()!==inst.lastVal){try{date=$.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),(inst.input?inst.input.val():null),$.datepicker._getFormatConfig(inst));if(date){$.datepicker._setDateFromField(inst);$.datepicker._updateAlternate(inst);$.datepicker._updateDatepicker(inst)}}catch(err){}}return true},_showDatepicker:function(input){input=input.target||input;if(input.nodeName.toLowerCase()!=="input"){input=$("input",input.parentNode)[0]}if($.datepicker._isDisabledDatepicker(input)||$.datepicker._lastInput===input){return}var inst,beforeShow,beforeShowSettings,isFixed,offset,showAnim,duration;inst=$.datepicker._getInst(input);if($.datepicker._curInst&&$.datepicker._curInst!==inst){$.datepicker._curInst.dpDiv.stop(true,true);if(inst&&$.datepicker._datepickerShowing){$.datepicker._hideDatepicker($.datepicker._curInst.input[0])}}beforeShow=$.datepicker._get(inst,"beforeShow");beforeShowSettings=beforeShow?beforeShow.apply(input,[input,inst]):{};if(beforeShowSettings===false){return}extendRemove(inst.settings,beforeShowSettings);inst.lastVal=null;$.datepicker._lastInput=input;$.datepicker._setDateFromField(inst);if($.datepicker._inDialog){input.value=""}if(!$.datepicker._pos){$.datepicker._pos=$.datepicker._findPos(input);$.datepicker._pos[1]+=input.offsetHeight}isFixed=false;$(input).parents().each(function(){isFixed|=$(this).css("position")==="fixed";return !isFixed});offset={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null;inst.dpDiv.empty();inst.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});$.datepicker._updateDatepicker(inst);offset=$.datepicker._checkOffset(inst,offset,isFixed);inst.dpDiv.css({position:($.datepicker._inDialog&&$.blockUI?"static":(isFixed?"fixed":"absolute")),display:"none",left:offset.left+"px",top:offset.top+"px"});if(!inst.inline){showAnim=$.datepicker._get(inst,"showAnim");duration=$.datepicker._get(inst,"duration");inst.dpDiv.zIndex($(input).zIndex()+1);$.datepicker._datepickerShowing=true;if($.effects&&$.effects.effect[showAnim]){inst.dpDiv.show(showAnim,$.datepicker._get(inst,"showOptions"),duration)}else{inst.dpDiv[showAnim||"show"](showAnim?duration:null)}if($.datepicker._shouldFocusInput(inst)){inst.input.focus()}$.datepicker._curInst=inst}},_updateDatepicker:function(inst){this.maxRows=4;instActive=inst;inst.dpDiv.empty().append(this._generateHTML(inst));this._attachHandlers(inst);inst.dpDiv.find("."+this._dayOverClass+" a").mouseover();var origyearshtml,numMonths=this._getNumberOfMonths(inst),cols=numMonths[1],width=17;inst.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(cols>1){inst.dpDiv.addClass("ui-datepicker-multi-"+cols).css("width",(width*cols)+"em")}inst.dpDiv[(numMonths[0]!==1||numMonths[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");inst.dpDiv[(this._get(inst,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(inst===$.datepicker._curInst&&$.datepicker._datepickerShowing&&$.datepicker._shouldFocusInput(inst)){inst.input.focus()}if(inst.yearshtml){origyearshtml=inst.yearshtml;setTimeout(function(){if(origyearshtml===inst.yearshtml&&inst.yearshtml){inst.dpDiv.find("select.ui-datepicker-year:first").replaceWith(inst.yearshtml)}origyearshtml=inst.yearshtml=null},0)}},_shouldFocusInput:function(inst){return inst.input&&inst.input.is(":visible")&&!inst.input.is(":disabled")&&!inst.input.is(":focus")},_checkOffset:function(inst,offset,isFixed){var dpWidth=inst.dpDiv.outerWidth(),dpHeight=inst.dpDiv.outerHeight(),inputWidth=inst.input?inst.input.outerWidth():0,inputHeight=inst.input?inst.input.outerHeight():0,viewWidth=document.documentElement.clientWidth+(isFixed?0:$(document).scrollLeft()),viewHeight=document.documentElement.clientHeight+(isFixed?0:$(document).scrollTop());offset.left-=(this._get(inst,"isRTL")?(dpWidth-inputWidth):0);offset.left-=(isFixed&&offset.left===inst.input.offset().left)?$(document).scrollLeft():0;offset.top-=(isFixed&&offset.top===(inst.input.offset().top+inputHeight))?$(document).scrollTop():0;offset.left-=Math.min(offset.left,(offset.left+dpWidth>viewWidth&&viewWidth>dpWidth)?Math.abs(offset.left+dpWidth-viewWidth):0);offset.top-=Math.min(offset.top,(offset.top+dpHeight>viewHeight&&viewHeight>dpHeight)?Math.abs(dpHeight+inputHeight):0);return offset},_findPos:function(obj){var position,inst=this._getInst(obj),isRTL=this._get(inst,"isRTL");while(obj&&(obj.type==="hidden"||obj.nodeType!==1||$.expr.filters.hidden(obj))){obj=obj[isRTL?"previousSibling":"nextSibling"]}position=$(obj).offset();return[position.left,position.top]},_hideDatepicker:function(input){var showAnim,duration,postProcess,onClose,inst=this._curInst;if(!inst||(input&&inst!==$.data(input,PROP_NAME))){return}if(this._datepickerShowing){showAnim=this._get(inst,"showAnim");duration=this._get(inst,"duration");postProcess=function(){$.datepicker._tidyDialog(inst)};if($.effects&&($.effects.effect[showAnim]||$.effects[showAnim])){inst.dpDiv.hide(showAnim,$.datepicker._get(inst,"showOptions"),duration,postProcess)}else{inst.dpDiv[(showAnim==="slideDown"?"slideUp":(showAnim==="fadeIn"?"fadeOut":"hide"))]((showAnim?duration:null),postProcess)}if(!showAnim){postProcess()}this._datepickerShowing=false;onClose=this._get(inst,"onClose");if(onClose){onClose.apply((inst.input?inst.input[0]:null),[(inst.input?inst.input.val():""),inst])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if($.blockUI){$.unblockUI();$("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(inst){inst.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(event){if(!$.datepicker._curInst){return}var $target=$(event.target),inst=$.datepicker._getInst($target[0]);if((($target[0].id!==$.datepicker._mainDivId&&$target.parents("#"+$.datepicker._mainDivId).length===0&&!$target.hasClass($.datepicker.markerClassName)&&!$target.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&!($.datepicker._inDialog&&$.blockUI)))||($target.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!==inst)){$.datepicker._hideDatepicker()}},_adjustDate:function(id,offset,period){var target=$(id),inst=this._getInst(target[0]);if(this._isDisabledDatepicker(target[0])){return}this._adjustInstDate(inst,offset+(period==="M"?this._get(inst,"showCurrentAtPos"):0),period);this._updateDatepicker(inst)},_gotoToday:function(id){var date,target=$(id),inst=this._getInst(target[0]);if(this._get(inst,"gotoCurrent")&&inst.currentDay){inst.selectedDay=inst.currentDay;inst.drawMonth=inst.selectedMonth=inst.currentMonth;inst.drawYear=inst.selectedYear=inst.currentYear}else{date=new Date();inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear()}this._notifyChange(inst);this._adjustDate(target)},_selectMonthYear:function(id,select,period){var target=$(id),inst=this._getInst(target[0]);inst["selected"+(period==="M"?"Month":"Year")]=inst["draw"+(period==="M"?"Month":"Year")]=parseInt(select.options[select.selectedIndex].value,10);this._notifyChange(inst);this._adjustDate(target)},_selectDay:function(id,month,year,td){var inst,target=$(id);if($(td).hasClass(this._unselectableClass)||this._isDisabledDatepicker(target[0])){return}inst=this._getInst(target[0]);inst.selectedDay=inst.currentDay=$("a",td).html();inst.selectedMonth=inst.currentMonth=month;inst.selectedYear=inst.currentYear=year;this._selectDate(id,this._formatDate(inst,inst.currentDay,inst.currentMonth,inst.currentYear))},_clearDate:function(id){var target=$(id);this._selectDate(target,"")},_selectDate:function(id,dateStr){var onSelect,target=$(id),inst=this._getInst(target[0]);dateStr=(dateStr!=null?dateStr:this._formatDate(inst));if(inst.input){inst.input.val(dateStr)}this._updateAlternate(inst);onSelect=this._get(inst,"onSelect");if(onSelect){onSelect.apply((inst.input?inst.input[0]:null),[dateStr,inst])}else{if(inst.input){inst.input.trigger("change")}}if(inst.inline){this._updateDatepicker(inst)}else{this._hideDatepicker();this._lastInput=inst.input[0];if(typeof(inst.input[0])!=="object"){inst.input.focus()}this._lastInput=null}},_updateAlternate:function(inst){var altFormat,date,dateStr,altField=this._get(inst,"altField");if(altField){altFormat=this._get(inst,"altFormat")||this._get(inst,"dateFormat");date=this._getDate(inst);dateStr=this.formatDate(altFormat,date,this._getFormatConfig(inst));$(altField).each(function(){$(this).val(dateStr)})}},noWeekends:function(date){var day=date.getDay();return[(day>0&&day<6),""]},iso8601Week:function(date){var time,checkDate=new Date(date.getTime());checkDate.setDate(checkDate.getDate()+4-(checkDate.getDay()||7));time=checkDate.getTime();checkDate.setMonth(0);checkDate.setDate(1);return Math.floor(Math.round((time-checkDate)/86400000)/7)+1},parseDate:function(format,value,settings){if(format==null||value==null){throw"Invalid arguments"}value=(typeof value==="object"?value.toString():value+"");if(value===""){return null}var iFormat,dim,extra,iValue=0,shortYearCutoffTemp=(settings?settings.shortYearCutoff:null)||this._defaults.shortYearCutoff,shortYearCutoff=(typeof shortYearCutoffTemp!=="string"?shortYearCutoffTemp:new Date().getFullYear()%100+parseInt(shortYearCutoffTemp,10)),dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,year=-1,month=-1,day=-1,doy=-1,literal=false,date,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++}return matches},getNumber=function(match){var isDoubled=lookAhead(match),size=(match==="@"?14:(match==="!"?20:(match==="y"&&isDoubled?4:(match==="o"?3:2)))),digits=new RegExp("^\\d{1,"+size+"}"),num=value.substring(iValue).match(digits);if(!num){throw"Missing number at position "+iValue}iValue+=num[0].length;return parseInt(num[0],10)},getName=function(match,shortNames,longNames){var index=-1,names=$.map(lookAhead(match)?longNames:shortNames,function(v,k){return[[k,v]]}).sort(function(a,b){return -(a[1].length-b[1].length)});$.each(names,function(i,pair){var name=pair[1];if(value.substr(iValue,name.length).toLowerCase()===name.toLowerCase()){index=pair[0];iValue+=name.length;return false}});if(index!==-1){return index+1}else{throw"Unknown name at position "+iValue}},checkLiteral=function(){if(value.charAt(iValue)!==format.charAt(iFormat)){throw"Unexpected literal at position "+iValue}iValue++};for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false}else{checkLiteral()}}else{switch(format.charAt(iFormat)){case"d":day=getNumber("d");break;case"D":getName("D",dayNamesShort,dayNames);break;case"o":doy=getNumber("o");break;case"m":month=getNumber("m");break;case"M":month=getName("M",monthNamesShort,monthNames);break;case"y":year=getNumber("y");break;case"@":date=new Date(getNumber("@"));year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"!":date=new Date((getNumber("!")-this._ticksTo1970)/10000);year=date.getFullYear();month=date.getMonth()+1;day=date.getDate();break;case"'":if(lookAhead("'")){checkLiteral()}else{literal=true}break;default:checkLiteral()}}}if(iValue<value.length){extra=value.substr(iValue);if(!/^\s+/.test(extra)){throw"Extra/unparsed characters found in date: "+extra}}if(year===-1){year=new Date().getFullYear()}else{if(year<100){year+=new Date().getFullYear()-new Date().getFullYear()%100+(year<=shortYearCutoff?0:-100)}}if(doy>-1){month=1;day=doy;do{dim=this._getDaysInMonth(year,month-1);if(day<=dim){break}month++;day-=dim}while(true)}date=this._daylightSavingAdjust(new Date(year,month-1,day));if(date.getFullYear()!==year||date.getMonth()+1!==month||date.getDate()!==day){throw"Invalid date"}return date},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(format,date,settings){if(!date){return""}var iFormat,dayNamesShort=(settings?settings.dayNamesShort:null)||this._defaults.dayNamesShort,dayNames=(settings?settings.dayNames:null)||this._defaults.dayNames,monthNamesShort=(settings?settings.monthNamesShort:null)||this._defaults.monthNamesShort,monthNames=(settings?settings.monthNames:null)||this._defaults.monthNames,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++}return matches},formatNumber=function(match,value,len){var num=""+value;if(lookAhead(match)){while(num.length<len){num="0"+num}}return num},formatName=function(match,value,shortNames,longNames){return(lookAhead(match)?longNames[value]:shortNames[value])},output="",literal=false;if(date){for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false}else{output+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":output+=formatNumber("d",date.getDate(),2);break;case"D":output+=formatName("D",date.getDay(),dayNamesShort,dayNames);break;case"o":output+=formatNumber("o",Math.round((new Date(date.getFullYear(),date.getMonth(),date.getDate()).getTime()-new Date(date.getFullYear(),0,0).getTime())/86400000),3);break;case"m":output+=formatNumber("m",date.getMonth()+1,2);break;case"M":output+=formatName("M",date.getMonth(),monthNamesShort,monthNames);break;case"y":output+=(lookAhead("y")?date.getFullYear():(date.getYear()%100<10?"0":"")+date.getYear()%100);break;case"@":output+=date.getTime();break;case"!":output+=date.getTime()*10000+this._ticksTo1970;break;case"'":if(lookAhead("'")){output+="'"}else{literal=true}break;default:output+=format.charAt(iFormat)}}}}return output},_possibleChars:function(format){var iFormat,chars="",literal=false,lookAhead=function(match){var matches=(iFormat+1<format.length&&format.charAt(iFormat+1)===match);if(matches){iFormat++}return matches};for(iFormat=0;iFormat<format.length;iFormat++){if(literal){if(format.charAt(iFormat)==="'"&&!lookAhead("'")){literal=false}else{chars+=format.charAt(iFormat)}}else{switch(format.charAt(iFormat)){case"d":case"m":case"y":case"@":chars+="0123456789";break;case"D":case"M":return null;case"'":if(lookAhead("'")){chars+="'"}else{literal=true}break;default:chars+=format.charAt(iFormat)}}}return chars},_get:function(inst,name){return inst.settings[name]!==undefined?inst.settings[name]:this._defaults[name]},_setDateFromField:function(inst,noDefault){if(inst.input.val()===inst.lastVal){return}var dateFormat=this._get(inst,"dateFormat"),dates=inst.lastVal=inst.input?inst.input.val():null,defaultDate=this._getDefaultDate(inst),date=defaultDate,settings=this._getFormatConfig(inst);try{date=this.parseDate(dateFormat,dates,settings)||defaultDate}catch(event){dates=(noDefault?"":dates)}inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();inst.currentDay=(dates?date.getDate():0);inst.currentMonth=(dates?date.getMonth():0);inst.currentYear=(dates?date.getFullYear():0);this._adjustInstDate(inst)},_getDefaultDate:function(inst){return this._restrictMinMax(inst,this._determineDate(inst,this._get(inst,"defaultDate"),new Date()))},_determineDate:function(inst,date,defaultDate){var offsetNumeric=function(offset){var date=new Date();date.setDate(date.getDate()+offset);return date},offsetString=function(offset){try{return $.datepicker.parseDate($.datepicker._get(inst,"dateFormat"),offset,$.datepicker._getFormatConfig(inst))}catch(e){}var date=(offset.toLowerCase().match(/^c/)?$.datepicker._getDate(inst):null)||new Date(),year=date.getFullYear(),month=date.getMonth(),day=date.getDate(),pattern=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,matches=pattern.exec(offset);while(matches){switch(matches[2]||"d"){case"d":case"D":day+=parseInt(matches[1],10);break;case"w":case"W":day+=parseInt(matches[1],10)*7;break;case"m":case"M":month+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break;case"y":case"Y":year+=parseInt(matches[1],10);day=Math.min(day,$.datepicker._getDaysInMonth(year,month));break}matches=pattern.exec(offset)}return new Date(year,month,day)},newDate=(date==null||date===""?defaultDate:(typeof date==="string"?offsetString(date):(typeof date==="number"?(isNaN(date)?defaultDate:offsetNumeric(date)):new Date(date.getTime()))));newDate=(newDate&&newDate.toString()==="Invalid Date"?defaultDate:newDate);if(newDate){newDate.setHours(0);newDate.setMinutes(0);newDate.setSeconds(0);newDate.setMilliseconds(0)}return this._daylightSavingAdjust(newDate)},_daylightSavingAdjust:function(date){if(!date){return null}date.setHours(date.getHours()>12?date.getHours()+2:0);return date},_setDate:function(inst,date,noChange){var clear=!date,origMonth=inst.selectedMonth,origYear=inst.selectedYear,newDate=this._restrictMinMax(inst,this._determineDate(inst,date,new Date()));inst.selectedDay=inst.currentDay=newDate.getDate();inst.drawMonth=inst.selectedMonth=inst.currentMonth=newDate.getMonth();inst.drawYear=inst.selectedYear=inst.currentYear=newDate.getFullYear();if((origMonth!==inst.selectedMonth||origYear!==inst.selectedYear)&&!noChange){this._notifyChange(inst)}this._adjustInstDate(inst);if(inst.input){inst.input.val(clear?"":this._formatDate(inst))}},_getDate:function(inst){var startDate=(!inst.currentYear||(inst.input&&inst.input.val()==="")?null:this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return startDate},_attachHandlers:function(inst){var stepMonths=this._get(inst,"stepMonths"),id="#"+inst.id.replace(/\\\\/g,"\\");inst.dpDiv.find("[data-handler]").map(function(){var handler={prev:function(){$.datepicker._adjustDate(id,-stepMonths,"M")},next:function(){$.datepicker._adjustDate(id,+stepMonths,"M")},hide:function(){$.datepicker._hideDatepicker()},today:function(){$.datepicker._gotoToday(id)},selectDay:function(){$.datepicker._selectDay(id,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){$.datepicker._selectMonthYear(id,this,"M");return false},selectYear:function(){$.datepicker._selectMonthYear(id,this,"Y");return false}};$(this).bind(this.getAttribute("data-event"),handler[this.getAttribute("data-handler")])})},_generateHTML:function(inst){var maxDraw,prevText,prev,nextText,next,currentText,gotoDate,controls,buttonPanel,firstDay,showWeek,dayNames,dayNamesMin,monthNames,monthNamesShort,beforeShowDay,showOtherMonths,selectOtherMonths,defaultDate,html,dow,row,group,col,selectedDate,cornerClass,calender,thead,day,daysInMonth,leadDays,curRows,numRows,printDate,dRow,tbody,daySettings,otherMonth,unselectable,tempDate=new Date(),today=this._daylightSavingAdjust(new Date(tempDate.getFullYear(),tempDate.getMonth(),tempDate.getDate())),isRTL=this._get(inst,"isRTL"),showButtonPanel=this._get(inst,"showButtonPanel"),hideIfNoPrevNext=this._get(inst,"hideIfNoPrevNext"),navigationAsDateFormat=this._get(inst,"navigationAsDateFormat"),numMonths=this._getNumberOfMonths(inst),showCurrentAtPos=this._get(inst,"showCurrentAtPos"),stepMonths=this._get(inst,"stepMonths"),isMultiMonth=(numMonths[0]!==1||numMonths[1]!==1),currentDate=this._daylightSavingAdjust((!inst.currentDay?new Date(9999,9,9):new Date(inst.currentYear,inst.currentMonth,inst.currentDay))),minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),drawMonth=inst.drawMonth-showCurrentAtPos,drawYear=inst.drawYear;if(drawMonth<0){drawMonth+=12;drawYear--}if(maxDate){maxDraw=this._daylightSavingAdjust(new Date(maxDate.getFullYear(),maxDate.getMonth()-(numMonths[0]*numMonths[1])+1,maxDate.getDate()));maxDraw=(minDate&&maxDraw<minDate?minDate:maxDraw);while(this._daylightSavingAdjust(new Date(drawYear,drawMonth,1))>maxDraw){drawMonth--;if(drawMonth<0){drawMonth=11;drawYear--}}}inst.drawMonth=drawMonth;inst.drawYear=drawYear;prevText=this._get(inst,"prevText");prevText=(!navigationAsDateFormat?prevText:this.formatDate(prevText,this._daylightSavingAdjust(new Date(drawYear,drawMonth-stepMonths,1)),this._getFormatConfig(inst)));prev=(this._canAdjustMonth(inst,-1,drawYear,drawMonth)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>":(hideIfNoPrevNext?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+prevText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"e":"w")+"'>"+prevText+"</span></a>"));nextText=this._get(inst,"nextText");nextText=(!navigationAsDateFormat?nextText:this.formatDate(nextText,this._daylightSavingAdjust(new Date(drawYear,drawMonth+stepMonths,1)),this._getFormatConfig(inst)));next=(this._canAdjustMonth(inst,+1,drawYear,drawMonth)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>":(hideIfNoPrevNext?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+nextText+"'><span class='ui-icon ui-icon-circle-triangle-"+(isRTL?"w":"e")+"'>"+nextText+"</span></a>"));currentText=this._get(inst,"currentText");gotoDate=(this._get(inst,"gotoCurrent")&&inst.currentDay?currentDate:today);currentText=(!navigationAsDateFormat?currentText:this.formatDate(currentText,gotoDate,this._getFormatConfig(inst)));controls=(!inst.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(inst,"closeText")+"</button>":"");buttonPanel=(showButtonPanel)?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(isRTL?controls:"")+(this._isInRange(inst,gotoDate)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+currentText+"</button>":"")+(isRTL?"":controls)+"</div>":"";firstDay=parseInt(this._get(inst,"firstDay"),10);firstDay=(isNaN(firstDay)?0:firstDay);showWeek=this._get(inst,"showWeek");dayNames=this._get(inst,"dayNames");dayNamesMin=this._get(inst,"dayNamesMin");monthNames=this._get(inst,"monthNames");monthNamesShort=this._get(inst,"monthNamesShort");beforeShowDay=this._get(inst,"beforeShowDay");showOtherMonths=this._get(inst,"showOtherMonths");selectOtherMonths=this._get(inst,"selectOtherMonths");defaultDate=this._getDefaultDate(inst);html="";dow;for(row=0;row<numMonths[0];row++){group="";this.maxRows=4;for(col=0;col<numMonths[1];col++){selectedDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,inst.selectedDay));cornerClass=" ui-corner-all";calender="";if(isMultiMonth){calender+="<div class='ui-datepicker-group";if(numMonths[1]>1){switch(col){case 0:calender+=" ui-datepicker-group-first";cornerClass=" ui-corner-"+(isRTL?"right":"left");break;case numMonths[1]-1:calender+=" ui-datepicker-group-last";cornerClass=" ui-corner-"+(isRTL?"left":"right");break;default:calender+=" ui-datepicker-group-middle";cornerClass="";break}}calender+="'>"}calender+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+cornerClass+"'>"+(/all|left/.test(cornerClass)&&row===0?(isRTL?next:prev):"")+(/all|right/.test(cornerClass)&&row===0?(isRTL?prev:next):"")+this._generateMonthYearHeader(inst,drawMonth,drawYear,minDate,maxDate,row>0||col>0,monthNames,monthNamesShort)+"</div><table class='ui-datepicker-calendar'><thead><tr>";thead=(showWeek?"<th class='ui-datepicker-week-col'>"+this._get(inst,"weekHeader")+"</th>":"");for(dow=0;dow<7;dow++){day=(dow+firstDay)%7;thead+="<th"+((dow+firstDay+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+dayNames[day]+"'>"+dayNamesMin[day]+"</span></th>"}calender+=thead+"</tr></thead><tbody>";daysInMonth=this._getDaysInMonth(drawYear,drawMonth);if(drawYear===inst.selectedYear&&drawMonth===inst.selectedMonth){inst.selectedDay=Math.min(inst.selectedDay,daysInMonth)}leadDays=(this._getFirstDayOfMonth(drawYear,drawMonth)-firstDay+7)%7;curRows=Math.ceil((leadDays+daysInMonth)/7);numRows=(isMultiMonth?this.maxRows>curRows?this.maxRows:curRows:curRows);this.maxRows=numRows;printDate=this._daylightSavingAdjust(new Date(drawYear,drawMonth,1-leadDays));for(dRow=0;dRow<numRows;dRow++){calender+="<tr>";tbody=(!showWeek?"":"<td class='ui-datepicker-week-col'>"+this._get(inst,"calculateWeek")(printDate)+"</td>");for(dow=0;dow<7;dow++){daySettings=(beforeShowDay?beforeShowDay.apply((inst.input?inst.input[0]:null),[printDate]):[true,""]);otherMonth=(printDate.getMonth()!==drawMonth);unselectable=(otherMonth&&!selectOtherMonths)||!daySettings[0]||(minDate&&printDate<minDate)||(maxDate&&printDate>maxDate);tbody+="<td class='"+((dow+firstDay+6)%7>=5?" ui-datepicker-week-end":"")+(otherMonth?" ui-datepicker-other-month":"")+((printDate.getTime()===selectedDate.getTime()&&drawMonth===inst.selectedMonth&&inst._keyEvent)||(defaultDate.getTime()===printDate.getTime()&&defaultDate.getTime()===selectedDate.getTime())?" "+this._dayOverClass:"")+(unselectable?" "+this._unselectableClass+" ui-state-disabled":"")+(otherMonth&&!showOtherMonths?"":" "+daySettings[1]+(printDate.getTime()===currentDate.getTime()?" "+this._currentClass:"")+(printDate.getTime()===today.getTime()?" ui-datepicker-today":""))+"'"+((!otherMonth||showOtherMonths)&&daySettings[2]?" title='"+daySettings[2].replace(/'/g,"&#39;")+"'":"")+(unselectable?"":" data-handler='selectDay' data-event='click' data-month='"+printDate.getMonth()+"' data-year='"+printDate.getFullYear()+"'")+">"+(otherMonth&&!showOtherMonths?"&#xa0;":(unselectable?"<span class='ui-state-default'>"+printDate.getDate()+"</span>":"<a class='ui-state-default"+(printDate.getTime()===today.getTime()?" ui-state-highlight":"")+(printDate.getTime()===currentDate.getTime()?" ui-state-active":"")+(otherMonth?" ui-priority-secondary":"")+"' href='#'>"+printDate.getDate()+"</a>"))+"</td>";printDate.setDate(printDate.getDate()+1);printDate=this._daylightSavingAdjust(printDate)}calender+=tbody+"</tr>"}drawMonth++;if(drawMonth>11){drawMonth=0;drawYear++}calender+="</tbody></table>"+(isMultiMonth?"</div>"+((numMonths[0]>0&&col===numMonths[1]-1)?"<div class='ui-datepicker-row-break'></div>":""):"");group+=calender}html+=group}html+=buttonPanel;inst._keyEvent=false;return html},_generateMonthYearHeader:function(inst,drawMonth,drawYear,minDate,maxDate,secondary,monthNames,monthNamesShort){var inMinYear,inMaxYear,month,years,thisYear,determineYear,year,endYear,changeMonth=this._get(inst,"changeMonth"),changeYear=this._get(inst,"changeYear"),showMonthAfterYear=this._get(inst,"showMonthAfterYear"),html="<div class='ui-datepicker-title'>",monthHtml="";if(secondary||!changeMonth){monthHtml+="<span class='ui-datepicker-month'>"+monthNames[drawMonth]+"</span>"}else{inMinYear=(minDate&&minDate.getFullYear()===drawYear);inMaxYear=(maxDate&&maxDate.getFullYear()===drawYear);monthHtml+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(month=0;month<12;month++){if((!inMinYear||month>=minDate.getMonth())&&(!inMaxYear||month<=maxDate.getMonth())){monthHtml+="<option value='"+month+"'"+(month===drawMonth?" selected='selected'":"")+">"+monthNamesShort[month]+"</option>"}}monthHtml+="</select>"}if(!showMonthAfterYear){html+=monthHtml+(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")}if(!inst.yearshtml){inst.yearshtml="";if(secondary||!changeYear){html+="<span class='ui-datepicker-year'>"+drawYear+"</span>"}else{years=this._get(inst,"yearRange").split(":");thisYear=new Date().getFullYear();determineYear=function(value){var year=(value.match(/c[+\-].*/)?drawYear+parseInt(value.substring(1),10):(value.match(/[+\-].*/)?thisYear+parseInt(value,10):parseInt(value,10)));return(isNaN(year)?thisYear:year)};year=determineYear(years[0]);endYear=Math.max(year,determineYear(years[1]||""));year=(minDate?Math.max(year,minDate.getFullYear()):year);endYear=(maxDate?Math.min(endYear,maxDate.getFullYear()):endYear);inst.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;year<=endYear;year++){inst.yearshtml+="<option value='"+year+"'"+(year===drawYear?" selected='selected'":"")+">"+year+"</option>"}inst.yearshtml+="</select>";html+=inst.yearshtml;inst.yearshtml=null}}html+=this._get(inst,"yearSuffix");if(showMonthAfterYear){html+=(secondary||!(changeMonth&&changeYear)?"&#xa0;":"")+monthHtml}html+="</div>";return html},_adjustInstDate:function(inst,offset,period){var year=inst.drawYear+(period==="Y"?offset:0),month=inst.drawMonth+(period==="M"?offset:0),day=Math.min(inst.selectedDay,this._getDaysInMonth(year,month))+(period==="D"?offset:0),date=this._restrictMinMax(inst,this._daylightSavingAdjust(new Date(year,month,day)));inst.selectedDay=date.getDate();inst.drawMonth=inst.selectedMonth=date.getMonth();inst.drawYear=inst.selectedYear=date.getFullYear();if(period==="M"||period==="Y"){this._notifyChange(inst)}},_restrictMinMax:function(inst,date){var minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),newDate=(minDate&&date<minDate?minDate:date);return(maxDate&&newDate>maxDate?maxDate:newDate)},_notifyChange:function(inst){var onChange=this._get(inst,"onChangeMonthYear");if(onChange){onChange.apply((inst.input?inst.input[0]:null),[inst.selectedYear,inst.selectedMonth+1,inst])}},_getNumberOfMonths:function(inst){var numMonths=this._get(inst,"numberOfMonths");return(numMonths==null?[1,1]:(typeof numMonths==="number"?[1,numMonths]:numMonths))},_getMinMaxDate:function(inst,minMax){return this._determineDate(inst,this._get(inst,minMax+"Date"),null)},_getDaysInMonth:function(year,month){return 32-this._daylightSavingAdjust(new Date(year,month,32)).getDate()},_getFirstDayOfMonth:function(year,month){return new Date(year,month,1).getDay()},_canAdjustMonth:function(inst,offset,curYear,curMonth){var numMonths=this._getNumberOfMonths(inst),date=this._daylightSavingAdjust(new Date(curYear,curMonth+(offset<0?offset:numMonths[0]*numMonths[1]),1));if(offset<0){date.setDate(this._getDaysInMonth(date.getFullYear(),date.getMonth()))}return this._isInRange(inst,date)},_isInRange:function(inst,date){var yearSplit,currentYear,minDate=this._getMinMaxDate(inst,"min"),maxDate=this._getMinMaxDate(inst,"max"),minYear=null,maxYear=null,years=this._get(inst,"yearRange");if(years){yearSplit=years.split(":");currentYear=new Date().getFullYear();minYear=parseInt(yearSplit[0],10);maxYear=parseInt(yearSplit[1],10);if(yearSplit[0].match(/[+\-].*/)){minYear+=currentYear}if(yearSplit[1].match(/[+\-].*/)){maxYear+=currentYear}}return((!minDate||date.getTime()>=minDate.getTime())&&(!maxDate||date.getTime()<=maxDate.getTime())&&(!minYear||date.getFullYear()>=minYear)&&(!maxYear||date.getFullYear()<=maxYear))},_getFormatConfig:function(inst){var shortYearCutoff=this._get(inst,"shortYearCutoff");shortYearCutoff=(typeof shortYearCutoff!=="string"?shortYearCutoff:new Date().getFullYear()%100+parseInt(shortYearCutoff,10));return{shortYearCutoff:shortYearCutoff,dayNamesShort:this._get(inst,"dayNamesShort"),dayNames:this._get(inst,"dayNames"),monthNamesShort:this._get(inst,"monthNamesShort"),monthNames:this._get(inst,"monthNames")}},_formatDate:function(inst,day,month,year){if(!day){inst.currentDay=inst.selectedDay;inst.currentMonth=inst.selectedMonth;inst.currentYear=inst.selectedYear}var date=(day?(typeof day==="object"?day:this._daylightSavingAdjust(new Date(year,month,day))):this._daylightSavingAdjust(new Date(inst.currentYear,inst.currentMonth,inst.currentDay)));return this.formatDate(this._get(inst,"dateFormat"),date,this._getFormatConfig(inst))}});function bindHover(dpDiv){var selector="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return dpDiv.delegate(selector,"mouseout",function(){$(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).removeClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).removeClass("ui-datepicker-next-hover")}}).delegate(selector,"mouseover",function(){if(!$.datepicker._isDisabledDatepicker(instActive.inline?dpDiv.parent()[0]:instActive.input[0])){$(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");$(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){$(this).addClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){$(this).addClass("ui-datepicker-next-hover")}}})}function extendRemove(target,props){$.extend(target,props);for(var name in props){if(props[name]==null){target[name]=props[name]}}return target}$.fn.datepicker=function(options){if(!this.length){return this}if(!$.datepicker.initialized){$(document).mousedown($.datepicker._checkExternalClick);$.datepicker.initialized=true}if($("#"+$.datepicker._mainDivId).length===0){$("body").append($.datepicker.dpDiv)}var otherArgs=Array.prototype.slice.call(arguments,1);if(typeof options==="string"&&(options==="isDisabled"||options==="getDate"||options==="widget")){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}if(options==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return $.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this[0]].concat(otherArgs))}return this.each(function(){typeof options==="string"?$.datepicker["_"+options+"Datepicker"].apply($.datepicker,[this].concat(otherArgs)):$.datepicker._attachDatepicker(this,options)})};$.datepicker=new Datepicker();$.datepicker.initialized=false;$.datepicker.uuid=new Date().getTime();$.datepicker.version="1.10.3"})(jQuery);(function($,undefined){var sizeRelatedOptions={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},resizableRelatedOptions={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};$.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:true,buttons:[],closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(pos){var topOffset=$(this).css(pos).offset().top;if(topOffset<0){$(this).css("top",pos.top-topOffset)}}},resizable:true,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;this._createWrapper();this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog);this._createTitlebar();this._createButtonPane();if(this.options.draggable&&$.fn.draggable){this._makeDraggable()}if(this.options.resizable&&$.fn.resizable){this._makeResizable()}this._isOpen=false},_init:function(){if(this.options.autoOpen){this.open()}},_appendTo:function(){var element=this.options.appendTo;if(element&&(element.jquery||element.nodeType)){return $(element)}return this.document.find(element||"body").eq(0)},_destroy:function(){var next,originalPosition=this.originalPosition;this._destroyOverlay();this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach();this.uiDialog.stop(true,true).remove();if(this.originalTitle){this.element.attr("title",this.originalTitle)}next=originalPosition.parent.children().eq(originalPosition.index);if(next.length&&next[0]!==this.element[0]){next.before(this.element)}else{originalPosition.parent.append(this.element)}},widget:function(){return this.uiDialog},disable:$.noop,enable:$.noop,close:function(event){var that=this;if(!this._isOpen||this._trigger("beforeClose",event)===false){return}this._isOpen=false;this._destroyOverlay();if(!this.opener.filter(":focusable").focus().length){$(this.document[0].activeElement).blur()}this._hide(this.uiDialog,this.options.hide,function(){that._trigger("close",event)})},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(event,silent){var moved=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;if(moved&&!silent){this._trigger("focus",event)}return moved},open:function(){var that=this;if(this._isOpen){if(this._moveToTop()){this._focusTabbable()}return}this._isOpen=true;this.opener=$(this.document[0].activeElement);this._size();this._position();this._createOverlay();this._moveToTop(null,true);this._show(this.uiDialog,this.options.show,function(){that._focusTabbable();that._trigger("focus")});this._trigger("open")},_focusTabbable:function(){var hasFocus=this.element.find("[autofocus]");if(!hasFocus.length){hasFocus=this.element.find(":tabbable")}if(!hasFocus.length){hasFocus=this.uiDialogButtonPane.find(":tabbable")}if(!hasFocus.length){hasFocus=this.uiDialogTitlebarClose.filter(":tabbable")}if(!hasFocus.length){hasFocus=this.uiDialog}hasFocus.eq(0).focus()},_keepFocus:function(event){function checkFocus(){var activeElement=this.document[0].activeElement,isActive=this.uiDialog[0]===activeElement||$.contains(this.uiDialog[0],activeElement);if(!isActive){this._focusTabbable()}}event.preventDefault();checkFocus.call(this);this._delay(checkFocus)},_createWrapper:function(){this.uiDialog=$("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._on(this.uiDialog,{keydown:function(event){if(this.options.closeOnEscape&&!event.isDefaultPrevented()&&event.keyCode&&event.keyCode===$.ui.keyCode.ESCAPE){event.preventDefault();this.close(event);return}if(event.keyCode!==$.ui.keyCode.TAB){return}var tabbables=this.uiDialog.find(":tabbable"),first=tabbables.filter(":first"),last=tabbables.filter(":last");if((event.target===last[0]||event.target===this.uiDialog[0])&&!event.shiftKey){first.focus(1);event.preventDefault()}else{if((event.target===first[0]||event.target===this.uiDialog[0])&&event.shiftKey){last.focus(1);event.preventDefault()}}},mousedown:function(event){if(this._moveToTop(event)){this._focusTabbable()}}});if(!this.element.find("[aria-describedby]").length){this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})}},_createTitlebar:function(){var uiDialogTitle;this.uiDialogTitlebar=$("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog);this._on(this.uiDialogTitlebar,{mousedown:function(event){if(!$(event.target).closest(".ui-dialog-titlebar-close")){this.uiDialog.focus()}}});this.uiDialogTitlebarClose=$("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:false}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar);this._on(this.uiDialogTitlebarClose,{click:function(event){event.preventDefault();this.close(event)}});uiDialogTitle=$("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar);this._title(uiDialogTitle);this.uiDialog.attr({"aria-labelledby":uiDialogTitle.attr("id")})},_title:function(title){if(!this.options.title){title.html("&#160;")}title.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=$("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiButtonSet=$("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane);this._createButtons()},_createButtons:function(){var that=this,buttons=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if($.isEmptyObject(buttons)||($.isArray(buttons)&&!buttons.length)){this.uiDialog.removeClass("ui-dialog-buttons");return}$.each(buttons,function(name,props){var click,buttonOptions;props=$.isFunction(props)?{click:props,text:name}:props;props=$.extend({type:"button"},props);click=props.click;props.click=function(){click.apply(that.element[0],arguments)};buttonOptions={icons:props.icons,text:props.showText};delete props.icons;delete props.showText;$("<button></button>",props).button(buttonOptions).appendTo(that.uiButtonSet)});this.uiDialog.addClass("ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){var that=this,options=this.options;function filteredUi(ui){return{position:ui.position,offset:ui.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(event,ui){$(this).addClass("ui-dialog-dragging");that._blockFrames();that._trigger("dragStart",event,filteredUi(ui))},drag:function(event,ui){that._trigger("drag",event,filteredUi(ui))},stop:function(event,ui){options.position=[ui.position.left-that.document.scrollLeft(),ui.position.top-that.document.scrollTop()];$(this).removeClass("ui-dialog-dragging");that._unblockFrames();that._trigger("dragStop",event,filteredUi(ui))}})},_makeResizable:function(){var that=this,options=this.options,handles=options.resizable,position=this.uiDialog.css("position"),resizeHandles=typeof handles==="string"?handles:"n,e,s,w,se,sw,ne,nw";function filteredUi(ui){return{originalPosition:ui.originalPosition,originalSize:ui.originalSize,position:ui.position,size:ui.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:options.maxWidth,maxHeight:options.maxHeight,minWidth:options.minWidth,minHeight:this._minHeight(),handles:resizeHandles,start:function(event,ui){$(this).addClass("ui-dialog-resizing");that._blockFrames();that._trigger("resizeStart",event,filteredUi(ui))},resize:function(event,ui){that._trigger("resize",event,filteredUi(ui))},stop:function(event,ui){options.height=$(this).height();options.width=$(this).width();$(this).removeClass("ui-dialog-resizing");that._unblockFrames();that._trigger("resizeStop",event,filteredUi(ui))}}).css("position",position)},_minHeight:function(){var options=this.options;return options.height==="auto"?options.minHeight:Math.min(options.minHeight,options.height)},_position:function(){var isVisible=this.uiDialog.is(":visible");if(!isVisible){this.uiDialog.show()}this.uiDialog.position(this.options.position);if(!isVisible){this.uiDialog.hide()}},_setOptions:function(options){var that=this,resize=false,resizableOptions={};$.each(options,function(key,value){that._setOption(key,value);if(key in sizeRelatedOptions){resize=true}if(key in resizableRelatedOptions){resizableOptions[key]=value}});if(resize){this._size();this._position()}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option",resizableOptions)}},_setOption:function(key,value){var isDraggable,isResizable,uiDialog=this.uiDialog;if(key==="dialogClass"){uiDialog.removeClass(this.options.dialogClass).addClass(value)}if(key==="disabled"){return}this._super(key,value);if(key==="appendTo"){this.uiDialog.appendTo(this._appendTo())}if(key==="buttons"){this._createButtons()}if(key==="closeText"){this.uiDialogTitlebarClose.button({label:""+value})}if(key==="draggable"){isDraggable=uiDialog.is(":data(ui-draggable)");if(isDraggable&&!value){uiDialog.draggable("destroy")}if(!isDraggable&&value){this._makeDraggable()}}if(key==="position"){this._position()}if(key==="resizable"){isResizable=uiDialog.is(":data(ui-resizable)");if(isResizable&&!value){uiDialog.resizable("destroy")}if(isResizable&&typeof value==="string"){uiDialog.resizable("option","handles",value)}if(!isResizable&&value!==false){this._makeResizable()}}if(key==="title"){this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))}},_size:function(){var nonContentHeight,minContentHeight,maxContentHeight,options=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(options.minWidth>options.width){options.width=options.minWidth}nonContentHeight=this.uiDialog.css({height:"auto",width:options.width}).outerHeight();minContentHeight=Math.max(0,options.minHeight-nonContentHeight);maxContentHeight=typeof options.maxHeight==="number"?Math.max(0,options.maxHeight-nonContentHeight):"none";if(options.height==="auto"){this.element.css({minHeight:minContentHeight,maxHeight:maxContentHeight,height:"auto"})}else{this.element.height(Math.max(0,options.height-nonContentHeight))}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var iframe=$(this);return $("<div>").css({position:"absolute",width:iframe.outerWidth(),height:iframe.outerHeight()}).appendTo(iframe.parent()).offset(iframe.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_allowInteraction:function(event){if($(event.target).closest(".ui-dialog").length){return true}return !!$(event.target).closest(".ui-datepicker").length},_createOverlay:function(){if(!this.options.modal){return}var that=this,widgetFullName=this.widgetFullName;if(!$.ui.dialog.overlayInstances){this._delay(function(){if($.ui.dialog.overlayInstances){this.document.bind("focusin.dialog",function(event){if(!that._allowInteraction(event)){event.preventDefault();$(".ui-dialog:visible:last .ui-dialog-content").data(widgetFullName)._focusTabbable()}})}})}this.overlay=$("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo());this._on(this.overlay,{mousedown:"_keepFocus"});$.ui.dialog.overlayInstances++},_destroyOverlay:function(){if(!this.options.modal){return}if(this.overlay){$.ui.dialog.overlayInstances--;if(!$.ui.dialog.overlayInstances){this.document.unbind("focusin.dialog")}this.overlay.remove();this.overlay=null}}});$.ui.dialog.overlayInstances=0;if($.uiBackCompat!==false){$.widget("ui.dialog",$.ui.dialog,{_position:function(){var position=this.options.position,myAt=[],offset=[0,0],isVisible;if(position){if(typeof position==="string"||(typeof position==="object"&&"0" in position)){myAt=position.split?position.split(" "):[position[0],position[1]];if(myAt.length===1){myAt[1]=myAt[0]}$.each(["left","top"],function(i,offsetPosition){if(+myAt[i]===myAt[i]){offset[i]=myAt[i];myAt[i]=offsetPosition}});position={my:myAt[0]+(offset[0]<0?offset[0]:"+"+offset[0])+" "+myAt[1]+(offset[1]<0?offset[1]:"+"+offset[1]),at:myAt.join(" ")}}position=$.extend({},$.ui.dialog.prototype.options.position,position)}else{position=$.ui.dialog.prototype.options.position}isVisible=this.uiDialog.is(":visible");if(!isVisible){this.uiDialog.show()}this.uiDialog.position(position);if(!isVisible){this.uiDialog.hide()}}})}}(jQuery));(function($,undefined){var rvertical=/up|down|vertical/,rpositivemotion=/up|left|vertical|horizontal/;$.effects.effect.blind=function(o,done){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),direction=o.direction||"up",vertical=rvertical.test(direction),ref=vertical?"height":"width",ref2=vertical?"top":"left",motion=rpositivemotion.test(direction),animation={},show=mode==="show",wrapper,distance,margin;if(el.parent().is(".ui-effects-wrapper")){$.effects.save(el.parent(),props)}else{$.effects.save(el,props)}el.show();wrapper=$.effects.createWrapper(el).css({overflow:"hidden"});distance=wrapper[ref]();margin=parseFloat(wrapper.css(ref2))||0;animation[ref]=show?distance:0;if(!motion){el.css(vertical?"bottom":"right",0).css(vertical?"top":"left","auto").css({position:"absolute"});animation[ref2]=show?margin:distance+margin}if(show){wrapper.css(ref,0);if(!motion){wrapper.css(ref2,margin+distance)}}wrapper.animate(animation,{duration:o.duration,easing:o.easing,queue:false,complete:function(){if(mode==="hide"){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);done()}})}})(jQuery);(function($,undefined){$.effects.effect.bounce=function(o,done){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),hide=mode==="hide",show=mode==="show",direction=o.direction||"up",distance=o.distance,times=o.times||5,anims=times*2+(show||hide?1:0),speed=o.duration/anims,easing=o.easing,ref=(direction==="up"||direction==="down")?"top":"left",motion=(direction==="up"||direction==="left"),i,upAnim,downAnim,queue=el.queue(),queuelen=queue.length;if(show||hide){props.push("opacity")}$.effects.save(el,props);el.show();$.effects.createWrapper(el);if(!distance){distance=el[ref==="top"?"outerHeight":"outerWidth"]()/3}if(show){downAnim={opacity:1};downAnim[ref]=0;el.css("opacity",0).css(ref,motion?-distance*2:distance*2).animate(downAnim,speed,easing)}if(hide){distance=distance/Math.pow(2,times-1)}downAnim={};downAnim[ref]=0;for(i=0;i<times;i++){upAnim={};upAnim[ref]=(motion?"-=":"+=")+distance;el.animate(upAnim,speed,easing).animate(downAnim,speed,easing);distance=hide?distance*2:distance/2}if(hide){upAnim={opacity:0};upAnim[ref]=(motion?"-=":"+=")+distance;el.animate(upAnim,speed,easing)}el.queue(function(){if(hide){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);done()});if(queuelen>1){queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1)))}el.dequeue()}})(jQuery);(function($,undefined){$.effects.effect.clip=function(o,done){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show=mode==="show",direction=o.direction||"vertical",vert=direction==="vertical",size=vert?"height":"width",position=vert?"top":"left",animation={},wrapper,animate,distance;$.effects.save(el,props);el.show();wrapper=$.effects.createWrapper(el).css({overflow:"hidden"});animate=(el[0].tagName==="IMG")?wrapper:el;distance=animate[size]();if(show){animate.css(size,0);animate.css(position,distance/2)}animation[size]=show?distance:0;animation[position]=show?0:distance/2;animate.animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(!show){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);done()}})}})(jQuery);(function($,undefined){$.effects.effect.drop=function(o,done){var el=$(this),props=["position","top","bottom","left","right","opacity","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show=mode==="show",direction=o.direction||"left",ref=(direction==="up"||direction==="down")?"top":"left",motion=(direction==="up"||direction==="left")?"pos":"neg",animation={opacity:show?1:0},distance;$.effects.save(el,props);el.show();$.effects.createWrapper(el);distance=o.distance||el[ref==="top"?"outerHeight":"outerWidth"](true)/2;if(show){el.css("opacity",0).css(ref,motion==="pos"?-distance:distance)}animation[ref]=(show?(motion==="pos"?"+=":"-="):(motion==="pos"?"-=":"+="))+distance;el.animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(mode==="hide"){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);done()}})}})(jQuery);(function($,undefined){$.effects.effect.explode=function(o,done){var rows=o.pieces?Math.round(Math.sqrt(o.pieces)):3,cells=rows,el=$(this),mode=$.effects.setMode(el,o.mode||"hide"),show=mode==="show",offset=el.show().css("visibility","hidden").offset(),width=Math.ceil(el.outerWidth()/cells),height=Math.ceil(el.outerHeight()/rows),pieces=[],i,j,left,top,mx,my;function childComplete(){pieces.push(this);if(pieces.length===rows*cells){animComplete()}}for(i=0;i<rows;i++){top=offset.top+i*height;my=i-(rows-1)/2;for(j=0;j<cells;j++){left=offset.left+j*width;mx=j-(cells-1)/2;el.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-j*width,top:-i*height}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:width,height:height,left:left+(show?mx*width:0),top:top+(show?my*height:0),opacity:show?0:1}).animate({left:left+(show?0:mx*width),top:top+(show?0:my*height),opacity:show?1:0},o.duration||500,o.easing,childComplete)}}function animComplete(){el.css({visibility:"visible"});$(pieces).remove();if(!show){el.hide()}done()}}})(jQuery);(function($,undefined){$.effects.effect.fade=function(o,done){var el=$(this),mode=$.effects.setMode(el,o.mode||"toggle");el.animate({opacity:mode},{queue:false,duration:o.duration,easing:o.easing,complete:done})}})(jQuery);(function($,undefined){$.effects.effect.fold=function(o,done){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"hide"),show=mode==="show",hide=mode==="hide",size=o.size||15,percent=/([0-9]+)%/.exec(size),horizFirst=!!o.horizFirst,widthFirst=show!==horizFirst,ref=widthFirst?["width","height"]:["height","width"],duration=o.duration/2,wrapper,distance,animation1={},animation2={};$.effects.save(el,props);el.show();wrapper=$.effects.createWrapper(el).css({overflow:"hidden"});distance=widthFirst?[wrapper.width(),wrapper.height()]:[wrapper.height(),wrapper.width()];if(percent){size=parseInt(percent[1],10)/100*distance[hide?0:1]}if(show){wrapper.css(horizFirst?{height:0,width:size}:{height:size,width:0})}animation1[ref[0]]=show?distance[0]:size;animation2[ref[1]]=show?distance[1]:0;wrapper.animate(animation1,duration,o.easing).animate(animation2,duration,o.easing,function(){if(hide){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);done()})}})(jQuery);(function($,undefined){$.effects.effect.highlight=function(o,done){var elem=$(this),props=["backgroundImage","backgroundColor","opacity"],mode=$.effects.setMode(elem,o.mode||"show"),animation={backgroundColor:elem.css("backgroundColor")};if(mode==="hide"){animation.opacity=0}$.effects.save(elem,props);elem.show().css({backgroundImage:"none",backgroundColor:o.color||"#ffff99"}).animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(mode==="hide"){elem.hide()}$.effects.restore(elem,props);done()}})}})(jQuery);(function($,undefined){$.effects.effect.pulsate=function(o,done){var elem=$(this),mode=$.effects.setMode(elem,o.mode||"show"),show=mode==="show",hide=mode==="hide",showhide=(show||mode==="hide"),anims=((o.times||5)*2)+(showhide?1:0),duration=o.duration/anims,animateTo=0,queue=elem.queue(),queuelen=queue.length,i;if(show||!elem.is(":visible")){elem.css("opacity",0).show();animateTo=1}for(i=1;i<anims;i++){elem.animate({opacity:animateTo},duration,o.easing);animateTo=1-animateTo}elem.animate({opacity:animateTo},duration,o.easing);elem.queue(function(){if(hide){elem.hide()}done()});if(queuelen>1){queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1)))}elem.dequeue()}})(jQuery);(function($,undefined){$.effects.effect.puff=function(o,done){var elem=$(this),mode=$.effects.setMode(elem,o.mode||"hide"),hide=mode==="hide",percent=parseInt(o.percent,10)||150,factor=percent/100,original={height:elem.height(),width:elem.width(),outerHeight:elem.outerHeight(),outerWidth:elem.outerWidth()};$.extend(o,{effect:"scale",queue:false,fade:true,mode:mode,complete:done,percent:hide?percent:100,from:hide?original:{height:original.height*factor,width:original.width*factor,outerHeight:original.outerHeight*factor,outerWidth:original.outerWidth*factor}});elem.effect(o)};$.effects.effect.scale=function(o,done){var el=$(this),options=$.extend(true,{},o),mode=$.effects.setMode(el,o.mode||"effect"),percent=parseInt(o.percent,10)||(parseInt(o.percent,10)===0?0:(mode==="hide"?0:100)),direction=o.direction||"both",origin=o.origin,original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()},factor={y:direction!=="horizontal"?(percent/100):1,x:direction!=="vertical"?(percent/100):1};options.effect="size";options.queue=false;options.complete=done;if(mode!=="effect"){options.origin=origin||["middle","center"];options.restore=true}options.from=o.from||(mode==="show"?{height:0,width:0,outerHeight:0,outerWidth:0}:original);options.to={height:original.height*factor.y,width:original.width*factor.x,outerHeight:original.outerHeight*factor.y,outerWidth:original.outerWidth*factor.x};if(options.fade){if(mode==="show"){options.from.opacity=0;options.to.opacity=1}if(mode==="hide"){options.from.opacity=1;options.to.opacity=0}}el.effect(options)};$.effects.effect.size=function(o,done){var original,baseline,factor,el=$(this),props0=["position","top","bottom","left","right","width","height","overflow","opacity"],props1=["position","top","bottom","left","right","overflow","opacity"],props2=["width","height","overflow"],cProps=["fontSize"],vProps=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],hProps=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],mode=$.effects.setMode(el,o.mode||"effect"),restore=o.restore||mode!=="effect",scale=o.scale||"both",origin=o.origin||["middle","center"],position=el.css("position"),props=restore?props0:props1,zero={height:0,width:0,outerHeight:0,outerWidth:0};if(mode==="show"){el.show()}original={height:el.height(),width:el.width(),outerHeight:el.outerHeight(),outerWidth:el.outerWidth()};if(o.mode==="toggle"&&mode==="show"){el.from=o.to||zero;el.to=o.from||original}else{el.from=o.from||(mode==="show"?zero:original);el.to=o.to||(mode==="hide"?zero:original)}factor={from:{y:el.from.height/original.height,x:el.from.width/original.width},to:{y:el.to.height/original.height,x:el.to.width/original.width}};if(scale==="box"||scale==="both"){if(factor.from.y!==factor.to.y){props=props.concat(vProps);el.from=$.effects.setTransition(el,vProps,factor.from.y,el.from);el.to=$.effects.setTransition(el,vProps,factor.to.y,el.to)}if(factor.from.x!==factor.to.x){props=props.concat(hProps);el.from=$.effects.setTransition(el,hProps,factor.from.x,el.from);el.to=$.effects.setTransition(el,hProps,factor.to.x,el.to)}}if(scale==="content"||scale==="both"){if(factor.from.y!==factor.to.y){props=props.concat(cProps).concat(props2);el.from=$.effects.setTransition(el,cProps,factor.from.y,el.from);el.to=$.effects.setTransition(el,cProps,factor.to.y,el.to)}}$.effects.save(el,props);el.show();$.effects.createWrapper(el);el.css("overflow","hidden").css(el.from);if(origin){baseline=$.effects.getBaseline(origin,original);el.from.top=(original.outerHeight-el.outerHeight())*baseline.y;el.from.left=(original.outerWidth-el.outerWidth())*baseline.x;el.to.top=(original.outerHeight-el.to.outerHeight)*baseline.y;el.to.left=(original.outerWidth-el.to.outerWidth)*baseline.x}el.css(el.from);if(scale==="content"||scale==="both"){vProps=vProps.concat(["marginTop","marginBottom"]).concat(cProps);hProps=hProps.concat(["marginLeft","marginRight"]);props2=props0.concat(vProps).concat(hProps);el.find("*[width]").each(function(){var child=$(this),c_original={height:child.height(),width:child.width(),outerHeight:child.outerHeight(),outerWidth:child.outerWidth()};if(restore){$.effects.save(child,props2)}child.from={height:c_original.height*factor.from.y,width:c_original.width*factor.from.x,outerHeight:c_original.outerHeight*factor.from.y,outerWidth:c_original.outerWidth*factor.from.x};child.to={height:c_original.height*factor.to.y,width:c_original.width*factor.to.x,outerHeight:c_original.height*factor.to.y,outerWidth:c_original.width*factor.to.x};if(factor.from.y!==factor.to.y){child.from=$.effects.setTransition(child,vProps,factor.from.y,child.from);child.to=$.effects.setTransition(child,vProps,factor.to.y,child.to)}if(factor.from.x!==factor.to.x){child.from=$.effects.setTransition(child,hProps,factor.from.x,child.from);child.to=$.effects.setTransition(child,hProps,factor.to.x,child.to)}child.css(child.from);child.animate(child.to,o.duration,o.easing,function(){if(restore){$.effects.restore(child,props2)}})})}el.animate(el.to,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(el.to.opacity===0){el.css("opacity",el.from.opacity)}if(mode==="hide"){el.hide()}$.effects.restore(el,props);if(!restore){if(position==="static"){el.css({position:"relative",top:el.to.top,left:el.to.left})}else{$.each(["top","left"],function(idx,pos){el.css(pos,function(_,str){var val=parseInt(str,10),toRef=idx?el.to.left:el.to.top;if(str==="auto"){return toRef+"px"}return val+toRef+"px"})})}}$.effects.removeWrapper(el);done()}})}})(jQuery);(function($,undefined){$.effects.effect.shake=function(o,done){var el=$(this),props=["position","top","bottom","left","right","height","width"],mode=$.effects.setMode(el,o.mode||"effect"),direction=o.direction||"left",distance=o.distance||20,times=o.times||3,anims=times*2+1,speed=Math.round(o.duration/anims),ref=(direction==="up"||direction==="down")?"top":"left",positiveMotion=(direction==="up"||direction==="left"),animation={},animation1={},animation2={},i,queue=el.queue(),queuelen=queue.length;$.effects.save(el,props);el.show();$.effects.createWrapper(el);animation[ref]=(positiveMotion?"-=":"+=")+distance;animation1[ref]=(positiveMotion?"+=":"-=")+distance*2;animation2[ref]=(positiveMotion?"-=":"+=")+distance*2;el.animate(animation,speed,o.easing);for(i=1;i<times;i++){el.animate(animation1,speed,o.easing).animate(animation2,speed,o.easing)}el.animate(animation1,speed,o.easing).animate(animation,speed/2,o.easing).queue(function(){if(mode==="hide"){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);done()});if(queuelen>1){queue.splice.apply(queue,[1,0].concat(queue.splice(queuelen,anims+1)))}el.dequeue()}})(jQuery);(function($,undefined){$.effects.effect.slide=function(o,done){var el=$(this),props=["position","top","bottom","left","right","width","height"],mode=$.effects.setMode(el,o.mode||"show"),show=mode==="show",direction=o.direction||"left",ref=(direction==="up"||direction==="down")?"top":"left",positiveMotion=(direction==="up"||direction==="left"),distance,animation={};$.effects.save(el,props);el.show();distance=o.distance||el[ref==="top"?"outerHeight":"outerWidth"](true);$.effects.createWrapper(el).css({overflow:"hidden"});if(show){el.css(ref,positiveMotion?(isNaN(distance)?"-"+distance:-distance):distance)}animation[ref]=(show?(positiveMotion?"+=":"-="):(positiveMotion?"-=":"+="))+distance;el.animate(animation,{queue:false,duration:o.duration,easing:o.easing,complete:function(){if(mode==="hide"){el.hide()}$.effects.restore(el,props);$.effects.removeWrapper(el);done()}})}})(jQuery);(function($,undefined){$.effects.effect.transfer=function(o,done){var elem=$(this),target=$(o.to),targetFixed=target.css("position")==="fixed",body=$("body"),fixTop=targetFixed?body.scrollTop():0,fixLeft=targetFixed?body.scrollLeft():0,endPosition=target.offset(),animation={top:endPosition.top-fixTop,left:endPosition.left-fixLeft,height:target.innerHeight(),width:target.innerWidth()},startPosition=elem.offset(),transfer=$("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(o.className).css({top:startPosition.top-fixTop,left:startPosition.left-fixLeft,height:elem.innerHeight(),width:elem.innerWidth(),position:targetFixed?"fixed":"absolute"}).animate(animation,o.duration,o.easing,function(){transfer.remove();done()})}})(jQuery);(function($,undefined){$.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=false;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,$.proxy(function(event){if(this.options.disabled){event.preventDefault()}},this));if(this.options.disabled){this.element.addClass("ui-state-disabled").attr("aria-disabled","true")}this._on({"mousedown .ui-menu-item > a":function(event){event.preventDefault()},"click .ui-state-disabled > a":function(event){event.preventDefault()},"click .ui-menu-item:has(a)":function(event){var target=$(event.target).closest(".ui-menu-item");if(!this.mouseHandled&&target.not(".ui-state-disabled").length){this.mouseHandled=true;this.select(event);if(target.has(".ui-menu").length){this.expand(event)}else{if(!this.element.is(":focus")){this.element.trigger("focus",[true]);if(this.active&&this.active.parents(".ui-menu").length===1){clearTimeout(this.timer)}}}}},"mouseenter .ui-menu-item":function(event){var target=$(event.currentTarget);target.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(event,target)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(event,keepActiveItem){var item=this.active||this.element.children(".ui-menu-item").eq(0);if(!keepActiveItem){this.focus(event,item)}},blur:function(event){this._delay(function(){if(!$.contains(this.element[0],this.document[0].activeElement)){this.collapseAll(event)}})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(event){if(!$(event.target).closest(".ui-menu").length){this.collapseAll(event)}this.mouseHandled=false}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var elem=$(this);if(elem.data("ui-menu-submenu-carat")){elem.remove()}});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(event){var match,prev,character,skip,regex,preventDefault=true;function escape(value){return value.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}switch(event.keyCode){case $.ui.keyCode.PAGE_UP:this.previousPage(event);break;case $.ui.keyCode.PAGE_DOWN:this.nextPage(event);break;case $.ui.keyCode.HOME:this._move("first","first",event);break;case $.ui.keyCode.END:this._move("last","last",event);break;case $.ui.keyCode.UP:this.previous(event);break;case $.ui.keyCode.DOWN:this.next(event);break;case $.ui.keyCode.LEFT:this.collapse(event);break;case $.ui.keyCode.RIGHT:if(this.active&&!this.active.is(".ui-state-disabled")){this.expand(event)}break;case $.ui.keyCode.ENTER:case $.ui.keyCode.SPACE:this._activate(event);break;case $.ui.keyCode.ESCAPE:this.collapse(event);break;default:preventDefault=false;prev=this.previousFilter||"";character=String.fromCharCode(event.keyCode);skip=false;clearTimeout(this.filterTimer);if(character===prev){skip=true}else{character=prev+character}regex=new RegExp("^"+escape(character),"i");match=this.activeMenu.children(".ui-menu-item").filter(function(){return regex.test($(this).children("a").text())});match=skip&&match.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):match;if(!match.length){character=String.fromCharCode(event.keyCode);regex=new RegExp("^"+escape(character),"i");match=this.activeMenu.children(".ui-menu-item").filter(function(){return regex.test($(this).children("a").text())})}if(match.length){this.focus(event,match);if(match.length>1){this.previousFilter=character;this.filterTimer=this._delay(function(){delete this.previousFilter},1000)}else{delete this.previousFilter}}else{delete this.previousFilter}}if(preventDefault){event.preventDefault()}},_activate:function(event){if(!this.active.is(".ui-state-disabled")){if(this.active.children("a[aria-haspopup='true']").length){this.expand(event)}else{this.select(event)}}},refresh:function(){var menus,icon=this.options.icons.submenu,submenus=this.element.find(this.options.menus);submenus.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var menu=$(this),item=menu.prev("a"),submenuCarat=$("<span>").addClass("ui-menu-icon ui-icon "+icon).data("ui-menu-submenu-carat",true);item.attr("aria-haspopup","true").prepend(submenuCarat);menu.attr("aria-labelledby",item.attr("id"))});menus=submenus.add(this.element);menus.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()});menus.children(":not(.ui-menu-item)").each(function(){var item=$(this);if(!/[^\-\u2014\u2013\s]/.test(item.text())){item.addClass("ui-widget-content ui-menu-divider")}});menus.children(".ui-state-disabled").attr("aria-disabled","true");if(this.active&&!$.contains(this.element[0],this.active[0])){this.blur()}},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(key,value){if(key==="icons"){this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(value.submenu)}this._super(key,value)},focus:function(event,item){var nested,focused;this.blur(event,event&&event.type==="focus");this._scrollIntoView(item);this.active=item.first();focused=this.active.children("a").addClass("ui-state-focus");if(this.options.role){this.element.attr("aria-activedescendant",focused.attr("id"))}this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");if(event&&event.type==="keydown"){this._close()}else{this.timer=this._delay(function(){this._close()},this.delay)}nested=item.children(".ui-menu");if(nested.length&&(/^mouse/.test(event.type))){this._startOpening(nested)}this.activeMenu=item.parent();this._trigger("focus",event,{item:item})},_scrollIntoView:function(item){var borderTop,paddingTop,offset,scroll,elementHeight,itemHeight;if(this._hasScroll()){borderTop=parseFloat($.css(this.activeMenu[0],"borderTopWidth"))||0;paddingTop=parseFloat($.css(this.activeMenu[0],"paddingTop"))||0;offset=item.offset().top-this.activeMenu.offset().top-borderTop-paddingTop;scroll=this.activeMenu.scrollTop();elementHeight=this.activeMenu.height();itemHeight=item.height();if(offset<0){this.activeMenu.scrollTop(scroll+offset)}else{if(offset+itemHeight>elementHeight){this.activeMenu.scrollTop(scroll+offset-elementHeight+itemHeight)}}}},blur:function(event,fromFocus){if(!fromFocus){clearTimeout(this.timer)}if(!this.active){return}this.active.children("a").removeClass("ui-state-focus");this.active=null;this._trigger("blur",event,{item:this.active})},_startOpening:function(submenu){clearTimeout(this.timer);if(submenu.attr("aria-hidden")!=="true"){return}this.timer=this._delay(function(){this._close();this._open(submenu)},this.delay)},_open:function(submenu){var position=$.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(submenu.parents(".ui-menu")).hide().attr("aria-hidden","true");submenu.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(position)},collapseAll:function(event,all){clearTimeout(this.timer);this.timer=this._delay(function(){var currentMenu=all?this.element:$(event&&event.target).closest(this.element.find(".ui-menu"));if(!currentMenu.length){currentMenu=this.element}this._close(currentMenu);this.blur(event);this.activeMenu=currentMenu},this.delay)},_close:function(startMenu){if(!startMenu){startMenu=this.active?this.active.parent():this.element}startMenu.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(event){var newItem=this.active&&this.active.parent().closest(".ui-menu-item",this.element);if(newItem&&newItem.length){this._close();this.focus(event,newItem)}},expand:function(event){var newItem=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();if(newItem&&newItem.length){this._open(newItem.parent());this._delay(function(){this.focus(event,newItem)})}},next:function(event){this._move("next","first",event)},previous:function(event){this._move("prev","last",event)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(direction,filter,event){var next;if(this.active){if(direction==="first"||direction==="last"){next=this.active[direction==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1)}else{next=this.active[direction+"All"](".ui-menu-item").eq(0)}}if(!next||!next.length||!this.active){next=this.activeMenu.children(".ui-menu-item")[filter]()}this.focus(event,next)},nextPage:function(event){var item,base,height;if(!this.active){this.next(event);return}if(this.isLastItem()){return}if(this._hasScroll()){base=this.active.offset().top;height=this.element.height();this.active.nextAll(".ui-menu-item").each(function(){item=$(this);return item.offset().top-base-height<0});this.focus(event,item)}else{this.focus(event,this.activeMenu.children(".ui-menu-item")[!this.active?"first":"last"]())}},previousPage:function(event){var item,base,height;if(!this.active){this.next(event);return}if(this.isFirstItem()){return}if(this._hasScroll()){base=this.active.offset().top;height=this.element.height();this.active.prevAll(".ui-menu-item").each(function(){item=$(this);return item.offset().top-base+height>0});this.focus(event,item)}else{this.focus(event,this.activeMenu.children(".ui-menu-item").first())}},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(event){this.active=this.active||$(event.target).closest(".ui-menu-item");var ui={item:this.active};if(!this.active.has(".ui-menu").length){this.collapseAll(event,true)}this._trigger("select",event,ui)}})}(jQuery));(function($,undefined){$.ui=$.ui||{};var cachedScrollbarWidth,max=Math.max,abs=Math.abs,round=Math.round,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)]}function parseCss(element,property){return parseInt($.css(element,property),10)||0}function getDimensions(elem){var raw=elem[0];if(raw.nodeType===9){return{width:elem.width(),height:elem.height(),offset:{top:0,left:0}}}if($.isWindow(raw)){return{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}}}if(raw.preventDefault){return{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}}}return{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()}}$.position={scrollbarWidth:function(){if(cachedScrollbarWidth!==undefined){return cachedScrollbarWidth}var w1,w2,div=$("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];$("body").append(div);w1=innerDiv.offsetWidth;div.css("overflow","scroll");w2=innerDiv.offsetWidth;if(w1===w2){w2=div[0].clientWidth}div.remove();return(cachedScrollbarWidth=w1-w2)},getScrollInfo:function(within){var overflowX=within.isWindow?"":within.element.css("overflow-x"),overflowY=within.isWindow?"":within.element.css("overflow-y"),hasOverflowX=overflowX==="scroll"||(overflowX==="auto"&&within.width<within.element[0].scrollWidth),hasOverflowY=overflowY==="scroll"||(overflowY==="auto"&&within.height<within.element[0].scrollHeight);return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0}},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]);return{element:withinElement,isWindow:isWindow,offset:withinElement.offset()||{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:isWindow?withinElement.width():withinElement.outerWidth(),height:isWindow?withinElement.height():withinElement.outerHeight()}}};$.fn.position=function(options){if(!options||!options.of){return _position.apply(this,arguments)}options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};dimensions=getDimensions(target);if(target[0].preventDefault){options.at="left top"}targetWidth=dimensions.width;targetHeight=dimensions.height;targetOffset=dimensions.offset;basePosition=$.extend({},targetOffset);$.each(["my","at"],function(){var pos=(options[this]||"").split(" "),horizontalOffset,verticalOffset;if(pos.length===1){pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"]}pos[0]=rhorizontal.test(pos[0])?pos[0]:"center";pos[1]=rvertical.test(pos[1])?pos[1]:"center";horizontalOffset=roffset.exec(pos[0]);verticalOffset=roffset.exec(pos[1]);offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0];options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]});if(collision.length===1){collision[1]=collision[0]}if(options.at[0]==="right"){basePosition.left+=targetWidth}else{if(options.at[0]==="center"){basePosition.left+=targetWidth/2}}if(options.at[1]==="bottom"){basePosition.top+=targetHeight}else{if(options.at[1]==="center"){basePosition.top+=targetHeight/2}}atOffset=getOffsets(offsets.at,targetWidth,targetHeight);basePosition.left+=atOffset[0];basePosition.top+=atOffset[1];return this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());if(options.my[0]==="right"){position.left-=elemWidth}else{if(options.my[0]==="center"){position.left-=elemWidth/2}}if(options.my[1]==="bottom"){position.top-=elemHeight}else{if(options.my[1]==="center"){position.top-=elemHeight/2}}position.left+=myOffset[0];position.top+=myOffset[1];if(!$.support.offsetFractions){position.left=round(position.left);position.top=round(position.top)}collisionPosition={marginLeft:marginLeft,marginTop:marginTop};$.each(["left","top"],function(i,dir){if($.ui.position[collision[i]]){$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})}});if(options.using){using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};if(targetWidth<elemWidth&&abs(left+right)<targetWidth){feedback.horizontal="center"}if(targetHeight<elemHeight&&abs(top+bottom)<targetHeight){feedback.vertical="middle"}if(max(abs(left),abs(right))>max(abs(top),abs(bottom))){feedback.important="horizontal"}else{feedback.important="vertical"}options.using.call(this,props,feedback)}}elem.offset($.extend(position,{using:using}))})};$.ui.position={fit:{left:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset,newOverRight;if(data.collisionWidth>outerWidth){if(overLeft>0&&overRight<=0){newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset;position.left+=overLeft-newOverRight}else{if(overRight>0&&overLeft<=0){position.left=withinOffset}else{if(overLeft>overRight){position.left=withinOffset+outerWidth-data.collisionWidth}else{position.left=withinOffset}}}}else{if(overLeft>0){position.left+=overLeft}else{if(overRight>0){position.left-=overRight}else{position.left=max(position.left-collisionPosLeft,position.left)}}}},top:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset,newOverBottom;if(data.collisionHeight>outerHeight){if(overTop>0&&overBottom<=0){newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset;position.top+=overTop-newOverBottom}else{if(overBottom>0&&overTop<=0){position.top=withinOffset}else{if(overTop>overBottom){position.top=withinOffset+outerHeight-data.collisionHeight}else{position.top=withinOffset}}}}else{if(overTop>0){position.top+=overTop}else{if(overBottom>0){position.top-=overBottom}else{position.top=max(position.top-collisionPosTop,position.top)}}}}},flip:{left:function(position,data){var within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,atOffset=data.at[0]==="left"?data.targetWidth:data.at[0]==="right"?-data.targetWidth:0,offset=-2*data.offset[0],newOverRight,newOverLeft;if(overLeft<0){newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset;if(newOverRight<0||newOverRight<abs(overLeft)){position.left+=myOffset+atOffset+offset}}else{if(overRight>0){newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft;if(newOverLeft>0||abs(newOverLeft)<overRight){position.left+=myOffset+atOffset+offset}}}},top:function(position,data){var within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top=data.my[1]==="top",myOffset=top?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,atOffset=data.at[1]==="top"?data.targetHeight:data.at[1]==="bottom"?-data.targetHeight:0,offset=-2*data.offset[1],newOverTop,newOverBottom;if(overTop<0){newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset;if((position.top+myOffset+atOffset+offset)>overTop&&(newOverBottom<0||newOverBottom<abs(overTop))){position.top+=myOffset+atOffset+offset}}else{if(overBottom>0){newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop;if((position.top+myOffset+atOffset+offset)>overBottom&&(newOverTop>0||abs(newOverTop)<overBottom)){position.top+=myOffset+atOffset+offset}}}}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments);$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments);$.ui.position.fit.top.apply(this,arguments)}}};(function(){var testElement,testElementParent,testElementStyle,offsetLeft,i,body=document.getElementsByTagName("body")[0],div=document.createElement("div");testElement=document.createElement(body?"div":"body");testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(body){$.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"})}for(i in testElementStyle){testElement.style[i]=testElementStyle[i]}testElement.appendChild(div);testElementParent=body||document.documentElement;testElementParent.insertBefore(testElement,testElementParent.firstChild);div.style.cssText="position: absolute; left: 10.7432222px;";offsetLeft=$(div).offset().left;$.support.offsetFractions=offsetLeft>10&&offsetLeft<11;testElement.innerHTML="";testElementParent.removeChild(testElement)})()}(jQuery));(function($,undefined){$.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min});this.valueDiv=$("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove()},value:function(newValue){if(newValue===undefined){return this.options.value}this.options.value=this._constrainedValue(newValue);this._refreshValue()},_constrainedValue:function(newValue){if(newValue===undefined){newValue=this.options.value}this.indeterminate=newValue===false;if(typeof newValue!=="number"){newValue=0}return this.indeterminate?false:Math.min(this.options.max,Math.max(this.min,newValue))},_setOptions:function(options){var value=options.value;delete options.value;this._super(options);this.options.value=this._constrainedValue(value);this._refreshValue()},_setOption:function(key,value){if(key==="max"){value=Math.max(this.min,value)}this._super(key,value)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var value=this.options.value,percentage=this._percentage();this.valueDiv.toggle(this.indeterminate||value>this.min).toggleClass("ui-corner-right",value===this.options.max).width(percentage.toFixed(0)+"%");this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate);if(this.indeterminate){this.element.removeAttr("aria-valuenow");if(!this.overlayDiv){this.overlayDiv=$("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv)}}else{this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":value});if(this.overlayDiv){this.overlayDiv.remove();this.overlayDiv=null}}if(this.oldValue!==value){this.oldValue=value;this._trigger("change")}if(value===this.options.max){this._trigger("complete")}}})})(jQuery);(function($,undefined){var numPages=5;$.widget("ui.slider",$.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=false},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var i,handleCount,options=this.options,existingHandles=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),handle="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",handles=[];handleCount=(options.values&&options.values.length)||1;if(existingHandles.length>handleCount){existingHandles.slice(handleCount).remove();existingHandles=existingHandles.slice(0,handleCount)}for(i=existingHandles.length;i<handleCount;i++){handles.push(handle)}this.handles=existingHandles.add($(handles.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(i){$(this).data("ui-slider-handle-index",i)})},_createRange:function(){var options=this.options,classes="";if(options.range){if(options.range===true){if(!options.values){options.values=[this._valueMin(),this._valueMin()]}else{if(options.values.length&&options.values.length!==2){options.values=[options.values[0],options.values[0]]}else{if($.isArray(options.values)){options.values=options.values.slice(0)}}}}if(!this.range||!this.range.length){this.range=$("<div></div>").appendTo(this.element);classes="ui-slider-range ui-widget-header ui-corner-all"}else{this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""})}this.range.addClass(classes+((options.range==="min"||options.range==="max")?" ui-slider-range-"+options.range:""))}else{this.range=$([])}},_setupEvents:function(){var elements=this.handles.add(this.range).filter("a");this._off(elements);this._on(elements,this._handleEvents);this._hoverable(elements);this._focusable(elements)},_destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all");this._mouseDestroy()},_mouseCapture:function(event){var position,normValue,distance,closestHandle,index,allowed,offset,mouseOverHandle,that=this,o=this.options;if(o.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();position={x:event.pageX,y:event.pageY};normValue=this._normValueFromMouse(position);distance=this._valueMax()-this._valueMin()+1;this.handles.each(function(i){var thisDistance=Math.abs(normValue-that.values(i));if((distance>thisDistance)||(distance===thisDistance&&(i===that._lastChangedValue||that.values(i)===o.min))){distance=thisDistance;closestHandle=$(this);index=i}});allowed=this._start(event,index);if(allowed===false){return false}this._mouseSliding=true;this._handleIndex=index;closestHandle.addClass("ui-state-active").focus();offset=closestHandle.offset();mouseOverHandle=!$(event.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=mouseOverHandle?{left:0,top:0}:{left:event.pageX-offset.left-(closestHandle.width()/2),top:event.pageY-offset.top-(closestHandle.height()/2)-(parseInt(closestHandle.css("borderTopWidth"),10)||0)-(parseInt(closestHandle.css("borderBottomWidth"),10)||0)+(parseInt(closestHandle.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(event,index,normValue)}this._animateOff=true;return true},_mouseStart:function(){return true},_mouseDrag:function(event){var position={x:event.pageX,y:event.pageY},normValue=this._normValueFromMouse(position);this._slide(event,this._handleIndex,normValue);return false},_mouseStop:function(event){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(event,this._handleIndex);this._change(event,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal"},_normValueFromMouse:function(position){var pixelTotal,pixelMouse,percentMouse,valueTotal,valueMouse;if(this.orientation==="horizontal"){pixelTotal=this.elementSize.width;pixelMouse=position.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{pixelTotal=this.elementSize.height;pixelMouse=position.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}percentMouse=(pixelMouse/pixelTotal);if(percentMouse>1){percentMouse=1}if(percentMouse<0){percentMouse=0}if(this.orientation==="vertical"){percentMouse=1-percentMouse}valueTotal=this._valueMax()-this._valueMin();valueMouse=this._valueMin()+percentMouse*valueTotal;return this._trimAlignValue(valueMouse)},_start:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}return this._trigger("start",event,uiHash)},_slide:function(event,index,newVal){var otherVal,newValues,allowed;if(this.options.values&&this.options.values.length){otherVal=this.values(index?0:1);if((this.options.values.length===2&&this.options.range===true)&&((index===0&&newVal>otherVal)||(index===1&&newVal<otherVal))){newVal=otherVal}if(newVal!==this.values(index)){newValues=this.values();newValues[index]=newVal;allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal,values:newValues});otherVal=this.values(index?0:1);if(allowed!==false){this.values(index,newVal,true)}}}else{if(newVal!==this.value()){allowed=this._trigger("slide",event,{handle:this.handles[index],value:newVal});if(allowed!==false){this.value(newVal)}}}},_stop:function(event,index){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}this._trigger("stop",event,uiHash)},_change:function(event,index){if(!this._keySliding&&!this._mouseSliding){var uiHash={handle:this.handles[index],value:this.value()};if(this.options.values&&this.options.values.length){uiHash.value=this.values(index);uiHash.values=this.values()}this._lastChangedValue=index;this._trigger("change",event,uiHash)}},value:function(newValue){if(arguments.length){this.options.value=this._trimAlignValue(newValue);this._refreshValue();this._change(null,0);return}return this._value()},values:function(index,newValue){var vals,newValues,i;if(arguments.length>1){this.options.values[index]=this._trimAlignValue(newValue);this._refreshValue();this._change(null,index);return}if(arguments.length){if($.isArray(arguments[0])){vals=this.options.values;newValues=arguments[0];for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(newValues[i]);this._change(null,i)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(index)}else{return this.value()}}}else{return this._values()}},_setOption:function(key,value){var i,valsLength=0;if(key==="range"&&this.options.range===true){if(value==="min"){this.options.value=this._values(0);this.options.values=null}else{if(value==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null}}}if($.isArray(this.options.values)){valsLength=this.options.values.length}$.Widget.prototype._setOption.apply(this,arguments);switch(key){case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(i=0;i<valsLength;i+=1){this._change(null,i)}this._animateOff=false;break;case"min":case"max":this._animateOff=true;this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break}},_value:function(){var val=this.options.value;val=this._trimAlignValue(val);return val},_values:function(index){var val,vals,i;if(arguments.length){val=this.options.values[index];val=this._trimAlignValue(val);return val}else{if(this.options.values&&this.options.values.length){vals=this.options.values.slice();for(i=0;i<vals.length;i+=1){vals[i]=this._trimAlignValue(vals[i])}return vals}else{return[]}}},_trimAlignValue:function(val){if(val<=this._valueMin()){return this._valueMin()}if(val>=this._valueMax()){return this._valueMax()}var step=(this.options.step>0)?this.options.step:1,valModStep=(val-this._valueMin())%step,alignValue=val-valModStep;if(Math.abs(valModStep)*2>=step){alignValue+=(valModStep>0)?step:(-step)}return parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var lastValPercent,valPercent,value,valueMin,valueMax,oRange=this.options.range,o=this.options,that=this,animate=(!this._animateOff)?o.animate:false,_set={};if(this.options.values&&this.options.values.length){this.handles.each(function(i){valPercent=(that.values(i)-that._valueMin())/(that._valueMax()-that._valueMin())*100;_set[that.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";$(this).stop(1,1)[animate?"animate":"css"](_set,o.animate);if(that.options.range===true){if(that.orientation==="horizontal"){if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({left:valPercent+"%"},o.animate)}if(i===1){that.range[animate?"animate":"css"]({width:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate})}}else{if(i===0){that.range.stop(1,1)[animate?"animate":"css"]({bottom:(valPercent)+"%"},o.animate)}if(i===1){that.range[animate?"animate":"css"]({height:(valPercent-lastValPercent)+"%"},{queue:false,duration:o.animate})}}}lastValPercent=valPercent})}else{value=this.value();valueMin=this._valueMin();valueMax=this._valueMax();valPercent=(valueMax!==valueMin)?(value-valueMin)/(valueMax-valueMin)*100:0;_set[this.orientation==="horizontal"?"left":"bottom"]=valPercent+"%";this.handle.stop(1,1)[animate?"animate":"css"](_set,o.animate);if(oRange==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[animate?"animate":"css"]({width:valPercent+"%"},o.animate)}if(oRange==="max"&&this.orientation==="horizontal"){this.range[animate?"animate":"css"]({width:(100-valPercent)+"%"},{queue:false,duration:o.animate})}if(oRange==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[animate?"animate":"css"]({height:valPercent+"%"},o.animate)}if(oRange==="max"&&this.orientation==="vertical"){this.range[animate?"animate":"css"]({height:(100-valPercent)+"%"},{queue:false,duration:o.animate})}}},_handleEvents:{keydown:function(event){var allowed,curVal,newVal,step,index=$(event.target).data("ui-slider-handle-index");switch(event.keyCode){case $.ui.keyCode.HOME:case $.ui.keyCode.END:case $.ui.keyCode.PAGE_UP:case $.ui.keyCode.PAGE_DOWN:case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:event.preventDefault();if(!this._keySliding){this._keySliding=true;$(event.target).addClass("ui-state-active");allowed=this._start(event,index);if(allowed===false){return}}break}step=this.options.step;if(this.options.values&&this.options.values.length){curVal=newVal=this.values(index)}else{curVal=newVal=this.value()}switch(event.keyCode){case $.ui.keyCode.HOME:newVal=this._valueMin();break;case $.ui.keyCode.END:newVal=this._valueMax();break;case $.ui.keyCode.PAGE_UP:newVal=this._trimAlignValue(curVal+((this._valueMax()-this._valueMin())/numPages));break;case $.ui.keyCode.PAGE_DOWN:newVal=this._trimAlignValue(curVal-((this._valueMax()-this._valueMin())/numPages));break;case $.ui.keyCode.UP:case $.ui.keyCode.RIGHT:if(curVal===this._valueMax()){return}newVal=this._trimAlignValue(curVal+step);break;case $.ui.keyCode.DOWN:case $.ui.keyCode.LEFT:if(curVal===this._valueMin()){return}newVal=this._trimAlignValue(curVal-step);break}this._slide(event,index,newVal)},click:function(event){event.preventDefault()},keyup:function(event){var index=$(event.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(event,index);this._change(event,index);$(event.target).removeClass("ui-state-active")}}}})}(jQuery));(function($){function modifier(fn){return function(){var previous=this.element.val();fn.apply(this,arguments);this._refresh();if(previous!==this.element.val()){this._trigger("change")}}}$.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:true,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);this._value(this.element.val(),true);this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var options={},element=this.element;$.each(["min","max","step"],function(i,option){var value=element.attr(option);if(value!==undefined&&value.length){options[option]=value}});return options},_events:{keydown:function(event){if(this._start(event)&&this._keydown(event)){event.preventDefault()}},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(event){if(this.cancelBlur){delete this.cancelBlur;return}this._stop();this._refresh();if(this.previous!==this.element.val()){this._trigger("change",event)}},mousewheel:function(event,delta){if(!delta){return}if(!this.spinning&&!this._start(event)){return false}this._spin((delta>0?1:-1)*this.options.step,event);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){if(this.spinning){this._stop(event)}},100);event.preventDefault()},"mousedown .ui-spinner-button":function(event){var previous;previous=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();function checkFocus(){var isActive=this.element[0]===this.document[0].activeElement;if(!isActive){this.element.focus();this.previous=previous;this._delay(function(){this.previous=previous})}}event.preventDefault();checkFocus.call(this);this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;checkFocus.call(this)});if(this._start(event)===false){return}this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(event){if(!$(event.currentTarget).hasClass("ui-state-active")){return}if(this._start(event)===false){return false}this._repeat(null,$(event.currentTarget).hasClass("ui-spinner-up")?1:-1,event)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var uiSpinner=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton");this.buttons=uiSpinner.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");if(this.buttons.height()>Math.ceil(uiSpinner.height()*0.5)&&uiSpinner.height()>0){uiSpinner.height(uiSpinner.height())}if(this.options.disabled){this.disable()}},_keydown:function(event){var options=this.options,keyCode=$.ui.keyCode;switch(event.keyCode){case keyCode.UP:this._repeat(null,1,event);return true;case keyCode.DOWN:this._repeat(null,-1,event);return true;case keyCode.PAGE_UP:this._repeat(null,options.page,event);return true;case keyCode.PAGE_DOWN:this._repeat(null,-options.page,event);return true}return false},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(event){if(!this.spinning&&this._trigger("start",event)===false){return false}if(!this.counter){this.counter=1}this.spinning=true;return true},_repeat:function(i,steps,event){i=i||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,steps,event)},i);this._spin(steps*this.options.step,event)},_spin:function(step,event){var value=this.value()||0;if(!this.counter){this.counter=1}value=this._adjustValue(value+step*this._increment(this.counter));if(!this.spinning||this._trigger("spin",event,{value:value})!==false){this._value(value);this.counter++}},_increment:function(i){var incremental=this.options.incremental;if(incremental){return $.isFunction(incremental)?incremental(i):Math.floor(i*i*i/50000-i*i/500+17*i/200+1)}return 1},_precision:function(){var precision=this._precisionOf(this.options.step);if(this.options.min!==null){precision=Math.max(precision,this._precisionOf(this.options.min))}return precision},_precisionOf:function(num){var str=num.toString(),decimal=str.indexOf(".");return decimal===-1?0:str.length-decimal-1},_adjustValue:function(value){var base,aboveMin,options=this.options;base=options.min!==null?options.min:0;aboveMin=value-base;aboveMin=Math.round(aboveMin/options.step)*options.step;value=base+aboveMin;value=parseFloat(value.toFixed(this._precision()));if(options.max!==null&&value>options.max){return options.max}if(options.min!==null&&value<options.min){return options.min}return value},_stop:function(event){if(!this.spinning){return}clearTimeout(this.timer);clearTimeout(this.mousewheelTimer);this.counter=0;this.spinning=false;this._trigger("stop",event)},_setOption:function(key,value){if(key==="culture"||key==="numberFormat"){var prevValue=this._parse(this.element.val());this.options[key]=value;this.element.val(this._format(prevValue));return}if(key==="max"||key==="min"||key==="step"){if(typeof value==="string"){value=this._parse(value)}}if(key==="icons"){this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(value.up);this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(value.down)}this._super(key,value);if(key==="disabled"){if(value){this.element.prop("disabled",true);this.buttons.button("disable")}else{this.element.prop("disabled",false);this.buttons.button("enable")}}},_setOptions:modifier(function(options){this._super(options);this._value(this.element.val())}),_parse:function(val){if(typeof val==="string"&&val!==""){val=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(val,10,this.options.culture):+val}return val===""||isNaN(val)?null:val},_format:function(value){if(value===""){return""}return window.Globalize&&this.options.numberFormat?Globalize.format(value,this.options.numberFormat,this.options.culture):value},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(value,allowAny){var parsed;if(value!==""){parsed=this._parse(value);if(parsed!==null){if(!allowAny){parsed=this._adjustValue(parsed)}value=this._format(parsed)}}this.element.val(value);this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",false).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:modifier(function(steps){this._stepUp(steps)}),_stepUp:function(steps){if(this._start()){this._spin((steps||1)*this.options.step);this._stop()}},stepDown:modifier(function(steps){this._stepDown(steps)}),_stepDown:function(steps){if(this._start()){this._spin((steps||1)*-this.options.step);this._stop()}},pageUp:modifier(function(pages){this._stepUp((pages||1)*this.options.page)}),pageDown:modifier(function(pages){this._stepDown((pages||1)*this.options.page)}),value:function(newVal){if(!arguments.length){return this._parse(this.element.val())}modifier(this._value).call(this,newVal)},widget:function(){return this.uiSpinner}})}(jQuery));(function($,undefined){var tabId=0,rhash=/#.*$/;function getNextTabId(){return ++tabId}function isLocal(anchor){return anchor.hash.length>1&&decodeURIComponent(anchor.href.replace(rhash,""))===decodeURIComponent(location.href.replace(rhash,""))}$.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:false,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var that=this,options=this.options;this.running=false;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",options.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(event){if($(this).is(".ui-state-disabled")){event.preventDefault()}}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){if($(this).closest("li").is(".ui-state-disabled")){this.blur()}});this._processTabs();options.active=this._initialActive();if($.isArray(options.disabled)){options.disabled=$.unique(options.disabled.concat($.map(this.tabs.filter(".ui-state-disabled"),function(li){return that.tabs.index(li)}))).sort()}if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(options.active)}else{this.active=$()}this._refresh();if(this.active.length){this.load(options.active)}},_initialActive:function(){var active=this.options.active,collapsible=this.options.collapsible,locationHash=location.hash.substring(1);if(active===null){if(locationHash){this.tabs.each(function(i,tab){if($(tab).attr("aria-controls")===locationHash){active=i;return false}})}if(active===null){active=this.tabs.index(this.tabs.filter(".ui-tabs-active"))}if(active===null||active===-1){active=this.tabs.length?0:false}}if(active!==false){active=this.tabs.index(this.tabs.eq(active));if(active===-1){active=collapsible?false:0}}if(!collapsible&&active===false&&this.anchors.length){active=0}return active},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?$():this._getPanelForTab(this.active)}},_tabKeydown:function(event){var focusedTab=$(this.document[0].activeElement).closest("li"),selectedIndex=this.tabs.index(focusedTab),goingForward=true;if(this._handlePageNav(event)){return}switch(event.keyCode){case $.ui.keyCode.RIGHT:case $.ui.keyCode.DOWN:selectedIndex++;break;case $.ui.keyCode.UP:case $.ui.keyCode.LEFT:goingForward=false;selectedIndex--;break;case $.ui.keyCode.END:selectedIndex=this.anchors.length-1;break;case $.ui.keyCode.HOME:selectedIndex=0;break;case $.ui.keyCode.SPACE:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex);return;case $.ui.keyCode.ENTER:event.preventDefault();clearTimeout(this.activating);this._activate(selectedIndex===this.options.active?false:selectedIndex);return;default:return}event.preventDefault();clearTimeout(this.activating);selectedIndex=this._focusNextTab(selectedIndex,goingForward);if(!event.ctrlKey){focusedTab.attr("aria-selected","false");this.tabs.eq(selectedIndex).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",selectedIndex)},this.delay)}},_panelKeydown:function(event){if(this._handlePageNav(event)){return}if(event.ctrlKey&&event.keyCode===$.ui.keyCode.UP){event.preventDefault();this.active.focus()}},_handlePageNav:function(event){if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true}if(event.altKey&&event.keyCode===$.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true}},_findNextTab:function(index,goingForward){var lastTabIndex=this.tabs.length-1;function constrain(){if(index>lastTabIndex){index=0}if(index<0){index=lastTabIndex}return index}while($.inArray(constrain(),this.options.disabled)!==-1){index=goingForward?index+1:index-1}return index},_focusNextTab:function(index,goingForward){index=this._findNextTab(index,goingForward);this.tabs.eq(index).focus();return index},_setOption:function(key,value){if(key==="active"){this._activate(value);return}if(key==="disabled"){this._setupDisabled(value);return}this._super(key,value);if(key==="collapsible"){this.element.toggleClass("ui-tabs-collapsible",value);if(!value&&this.options.active===false){this._activate(0)}}if(key==="event"){this._setupEvents(value)}if(key==="heightStyle"){this._setupHeightStyle(value)}},_tabId:function(tab){return tab.attr("aria-controls")||"ui-tabs-"+getNextTabId()},_sanitizeSelector:function(hash){return hash?hash.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var options=this.options,lis=this.tablist.children(":has(a[href])");options.disabled=$.map(lis.filter(".ui-state-disabled"),function(tab){return lis.index(tab)});this._processTabs();if(options.active===false||!this.anchors.length){options.active=false;this.active=$()}else{if(this.active.length&&!$.contains(this.tablist[0],this.active[0])){if(this.tabs.length===options.disabled.length){options.active=false;this.active=$()}else{this._activate(this._findNextTab(Math.max(0,options.active-1),false))}}else{options.active=this.tabs.index(this.active)}}this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0)}else{this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0});this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})}},_processTabs:function(){var that=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return $("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=$();this.anchors.each(function(i,anchor){var selector,panel,panelId,anchorId=$(anchor).uniqueId().attr("id"),tab=$(anchor).closest("li"),originalAriaControls=tab.attr("aria-controls");if(isLocal(anchor)){selector=anchor.hash;panel=that.element.find(that._sanitizeSelector(selector))}else{panelId=that._tabId(tab);selector="#"+panelId;panel=that.element.find(selector);if(!panel.length){panel=that._createPanel(panelId);panel.insertAfter(that.panels[i-1]||that.tablist)}panel.attr("aria-live","polite")}if(panel.length){that.panels=that.panels.add(panel)}if(originalAriaControls){tab.data("ui-tabs-aria-controls",originalAriaControls)}tab.attr({"aria-controls":selector.substring(1),"aria-labelledby":anchorId});panel.attr("aria-labelledby",anchorId)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(id){return $("<div>").attr("id",id).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",true)},_setupDisabled:function(disabled){if($.isArray(disabled)){if(!disabled.length){disabled=false}else{if(disabled.length===this.anchors.length){disabled=true}}}for(var i=0,li;(li=this.tabs[i]);i++){if(disabled===true||$.inArray(i,disabled)!==-1){$(li).addClass("ui-state-disabled").attr("aria-disabled","true")}else{$(li).removeClass("ui-state-disabled").removeAttr("aria-disabled")}}this.options.disabled=disabled},_setupEvents:function(event){var events={click:function(event){event.preventDefault()}};if(event){$.each(event.split(" "),function(index,eventName){events[eventName]="_eventHandler"})}this._off(this.anchors.add(this.tabs).add(this.panels));this._on(this.anchors,events);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(heightStyle){var maxHeight,parent=this.element.parent();if(heightStyle==="fill"){maxHeight=parent.height();maxHeight-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var elem=$(this),position=elem.css("position");if(position==="absolute"||position==="fixed"){return}maxHeight-=elem.outerHeight(true)});this.element.children().not(this.panels).each(function(){maxHeight-=$(this).outerHeight(true)});this.panels.each(function(){$(this).height(Math.max(0,maxHeight-$(this).innerHeight()+$(this).height()))}).css("overflow","auto")}else{if(heightStyle==="auto"){maxHeight=0;this.panels.each(function(){maxHeight=Math.max(maxHeight,$(this).height("").height())}).height(maxHeight)}}},_eventHandler:function(event){var options=this.options,active=this.active,anchor=$(event.currentTarget),tab=anchor.closest("li"),clickedIsActive=tab[0]===active[0],collapsing=clickedIsActive&&options.collapsible,toShow=collapsing?$():this._getPanelForTab(tab),toHide=!active.length?$():this._getPanelForTab(active),eventData={oldTab:active,oldPanel:toHide,newTab:collapsing?$():tab,newPanel:toShow};event.preventDefault();if(tab.hasClass("ui-state-disabled")||tab.hasClass("ui-tabs-loading")||this.running||(clickedIsActive&&!options.collapsible)||(this._trigger("beforeActivate",event,eventData)===false)){return}options.active=collapsing?false:this.tabs.index(tab);this.active=clickedIsActive?$():tab;if(this.xhr){this.xhr.abort()}if(!toHide.length&&!toShow.length){$.error("jQuery UI Tabs: Mismatching fragment identifier.")}if(toShow.length){this.load(this.tabs.index(tab),event)}this._toggle(event,eventData)},_toggle:function(event,eventData){var that=this,toShow=eventData.newPanel,toHide=eventData.oldPanel;this.running=true;function complete(){that.running=false;that._trigger("activate",event,eventData)}function show(){eventData.newTab.closest("li").addClass("ui-tabs-active ui-state-active");if(toShow.length&&that.options.show){that._show(toShow,that.options.show,complete)}else{toShow.show();complete()}}if(toHide.length&&this.options.hide){this._hide(toHide,this.options.hide,function(){eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");show()})}else{eventData.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");toHide.hide();show()}toHide.attr({"aria-expanded":"false","aria-hidden":"true"});eventData.oldTab.attr("aria-selected","false");if(toShow.length&&toHide.length){eventData.oldTab.attr("tabIndex",-1)}else{if(toShow.length){this.tabs.filter(function(){return $(this).attr("tabIndex")===0}).attr("tabIndex",-1)}}toShow.attr({"aria-expanded":"true","aria-hidden":"false"});eventData.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(index){var anchor,active=this._findActive(index);if(active[0]===this.active[0]){return}if(!active.length){active=this.active}anchor=active.find(".ui-tabs-anchor")[0];this._eventHandler({target:anchor,currentTarget:anchor,preventDefault:$.noop})},_findActive:function(index){return index===false?$():this.tabs.eq(index)},_getIndex:function(index){if(typeof index==="string"){index=this.anchors.index(this.anchors.filter("[href$='"+index+"']"))}return index},_destroy:function(){if(this.xhr){this.xhr.abort()}this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();this.tabs.add(this.panels).each(function(){if($.data(this,"ui-tabs-destroy")){$(this).remove()}else{$(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}});this.tabs.each(function(){var li=$(this),prev=li.data("ui-tabs-aria-controls");if(prev){li.attr("aria-controls",prev).removeData("ui-tabs-aria-controls")}else{li.removeAttr("aria-controls")}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","")}},enable:function(index){var disabled=this.options.disabled;if(disabled===false){return}if(index===undefined){disabled=false}else{index=this._getIndex(index);if($.isArray(disabled)){disabled=$.map(disabled,function(num){return num!==index?num:null})}else{disabled=$.map(this.tabs,function(li,num){return num!==index?num:null})}}this._setupDisabled(disabled)},disable:function(index){var disabled=this.options.disabled;if(disabled===true){return}if(index===undefined){disabled=true}else{index=this._getIndex(index);if($.inArray(index,disabled)!==-1){return}if($.isArray(disabled)){disabled=$.merge([index],disabled).sort()}else{disabled=[index]}}this._setupDisabled(disabled)},load:function(index,event){index=this._getIndex(index);var that=this,tab=this.tabs.eq(index),anchor=tab.find(".ui-tabs-anchor"),panel=this._getPanelForTab(tab),eventData={tab:tab,panel:panel};if(isLocal(anchor[0])){return}this.xhr=$.ajax(this._ajaxSettings(anchor,event,eventData));if(this.xhr&&this.xhr.statusText!=="canceled"){tab.addClass("ui-tabs-loading");panel.attr("aria-busy","true");this.xhr.success(function(response){setTimeout(function(){panel.html(response);that._trigger("load",event,eventData)},1)}).complete(function(jqXHR,status){setTimeout(function(){if(status==="abort"){that.panels.stop(false,true)}tab.removeClass("ui-tabs-loading");panel.removeAttr("aria-busy");if(jqXHR===that.xhr){delete that.xhr}},1)})}},_ajaxSettings:function(anchor,event,eventData){var that=this;return{url:anchor.attr("href"),beforeSend:function(jqXHR,settings){return that._trigger("beforeLoad",event,$.extend({jqXHR:jqXHR,ajaxSettings:settings},eventData))}}},_getPanelForTab:function(tab){var id=$(tab).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+id))}})})(jQuery);(function($){var increments=0;function addDescribedBy(elem,id){var describedby=(elem.attr("aria-describedby")||"").split(/\s+/);describedby.push(id);elem.data("ui-tooltip-id",id).attr("aria-describedby",$.trim(describedby.join(" ")))}function removeDescribedBy(elem){var id=elem.data("ui-tooltip-id"),describedby=(elem.attr("aria-describedby")||"").split(/\s+/),index=$.inArray(id,describedby);if(index!==-1){describedby.splice(index,1)}elem.removeData("ui-tooltip-id");describedby=$.trim(describedby.join(" "));if(describedby){elem.attr("aria-describedby",describedby)}else{elem.removeAttr("aria-describedby")}}$.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var title=$(this).attr("title")||"";return $("<a>").text(title).html()},hide:true,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:true,tooltipClass:null,track:false,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};if(this.options.disabled){this._disable()}},_setOption:function(key,value){var that=this;if(key==="disabled"){this[value?"_disable":"_enable"]();this.options[key]=value;return}this._super(key,value);if(key==="content"){$.each(this.tooltips,function(id,element){that._updateContent(element)})}},_disable:function(){var that=this;$.each(this.tooltips,function(id,element){var event=$.Event("blur");event.target=event.currentTarget=element[0];that.close(event,true)});this.element.find(this.options.items).addBack().each(function(){var element=$(this);if(element.is("[title]")){element.data("ui-tooltip-title",element.attr("title")).attr("title","")}})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var element=$(this);if(element.data("ui-tooltip-title")){element.attr("title",element.data("ui-tooltip-title"))}})},open:function(event){var that=this,target=$(event?event.target:this.element).closest(this.options.items);if(!target.length||target.data("ui-tooltip-id")){return}if(target.attr("title")){target.data("ui-tooltip-title",target.attr("title"))}target.data("ui-tooltip-open",true);if(event&&event.type==="mouseover"){target.parents().each(function(){var parent=$(this),blurEvent;if(parent.data("ui-tooltip-open")){blurEvent=$.Event("blur");blurEvent.target=blurEvent.currentTarget=this;that.close(blurEvent,true)}if(parent.attr("title")){parent.uniqueId();that.parents[this.id]={element:this,title:parent.attr("title")};parent.attr("title","")}})}this._updateContent(target,event)},_updateContent:function(target,event){var content,contentOption=this.options.content,that=this,eventType=event?event.type:null;if(typeof contentOption==="string"){return this._open(event,target,contentOption)}content=contentOption.call(target[0],function(response){if(!target.data("ui-tooltip-open")){return}that._delay(function(){if(event){event.type=eventType}this._open(event,target,response)})});if(content){this._open(event,target,content)}},_open:function(event,target,content){var tooltip,events,delayedShow,positionOption=$.extend({},this.options.position);if(!content){return}tooltip=this._find(target);if(tooltip.length){tooltip.find(".ui-tooltip-content").html(content);return}if(target.is("[title]")){if(event&&event.type==="mouseover"){target.attr("title","")}else{target.removeAttr("title")}}tooltip=this._tooltip(target);addDescribedBy(target,tooltip.attr("id"));tooltip.find(".ui-tooltip-content").html(content);function position(event){positionOption.of=event;if(tooltip.is(":hidden")){return}tooltip.position(positionOption)}if(this.options.track&&event&&/^mouse/.test(event.type)){this._on(this.document,{mousemove:position});position(event)}else{tooltip.position($.extend({of:target},this.options.position))}tooltip.hide();this._show(tooltip,this.options.show);if(this.options.show&&this.options.show.delay){delayedShow=this.delayedShow=setInterval(function(){if(tooltip.is(":visible")){position(positionOption.of);clearInterval(delayedShow)}},$.fx.interval)}this._trigger("open",event,{tooltip:tooltip});events={keyup:function(event){if(event.keyCode===$.ui.keyCode.ESCAPE){var fakeEvent=$.Event(event);fakeEvent.currentTarget=target[0];this.close(fakeEvent,true)}},remove:function(){this._removeTooltip(tooltip)}};if(!event||event.type==="mouseover"){events.mouseleave="close"}if(!event||event.type==="focusin"){events.focusout="close"}this._on(true,target,events)},close:function(event){var that=this,target=$(event?event.currentTarget:this.element),tooltip=this._find(target);if(this.closing){return}clearInterval(this.delayedShow);if(target.data("ui-tooltip-title")){target.attr("title",target.data("ui-tooltip-title"))}removeDescribedBy(target);tooltip.stop(true);this._hide(tooltip,this.options.hide,function(){that._removeTooltip($(this))});target.removeData("ui-tooltip-open");this._off(target,"mouseleave focusout keyup");if(target[0]!==this.element[0]){this._off(target,"remove")}this._off(this.document,"mousemove");if(event&&event.type==="mouseleave"){$.each(this.parents,function(id,parent){$(parent.element).attr("title",parent.title);delete that.parents[id]})}this.closing=true;this._trigger("close",event,{tooltip:tooltip});this.closing=false},_tooltip:function(element){var id="ui-tooltip-"+increments++,tooltip=$("<div>").attr({id:id,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));$("<div>").addClass("ui-tooltip-content").appendTo(tooltip);tooltip.appendTo(this.document[0].body);this.tooltips[id]=element;return tooltip},_find:function(target){var id=target.data("ui-tooltip-id");return id?$("#"+id):$()},_removeTooltip:function(tooltip){tooltip.remove();delete this.tooltips[tooltip.attr("id")]},_destroy:function(){var that=this;$.each(this.tooltips,function(id,element){var event=$.Event("blur");event.target=event.currentTarget=element[0];that.close(event,true);$("#"+id).remove();if(element.data("ui-tooltip-title")){element.attr("title",element.data("ui-tooltip-title"));element.removeData("ui-tooltip-title")}})}})}(jQuery));$(document).ready(function(){$("#grid > th:first div.relative").html("he its hack")});function handsontable_with_filter(selector,data,readonly){$(selector).handsontable({startRows:5,startCols:5,minRows:5,minCols:5,rowHeaders:true,colHeaders:true,minSpareRows:1,stretchH:"all",readOnly:readonly,fixedRowsTop:2,fixedColumnsLeft:2,autoWrapRow:true,columnSorting:true,manualColumnResize:true,manualColumnMove:true,contextMenu:true,autoWrapRow:true,outsideClickDeselects:false,cells:function(row,col,prop){if(row<=0){var cellProperties={renderer:firstRowRenderer};return cellProperties}}});if(data.length>0){var handsontable=$(selector).data("handsontable");handsontable.loadData(data)}function firstRowRenderer(instance,td,row,col,prop,value,cellProperties){Handsontable.TextCell.renderer.apply(this,arguments);td.style.fontWeight="bold";td.style.color="#1B668B";td.style.background="#f0f0f0"}$(selector+" table").addClass("table-hover table-condensed");$(selector+" table tbody tr:first").css("font-weight","bold").css("color","#1B668B");function ConvertToCSV(objArray){var array=typeof objArray!="object"?JSON.parse(objArray):objArray;var str="";for(var i=0;i<array.length;i++){var line="";for(var index in array[i]){if(line!=""){line+=","}line+=array[i][index]}str+=line+"\r\n"}return str}}function remove_null_rows(selector){var total_rows=$(selector).handsontable("countRows");for(var i=total_rows-1;i>=0;i--){if($(selector).handsontable("isEmptyRow",i)){$(selector).handsontable("alter","remove_row",i)}}}function remove_null_cols(selector){var total_cols=$(selector).handsontable("countCols");for(var i=total_cols-1;i>=0;i--){if($(selector).handsontable("isEmptyCol",i)){$(selector).handsontable("alter","remove_col",i)}}}function generate_article_chart(){$(".wmd-input").hide();var converter=new Showdown.converter();var chart_types={"Pie Chart":"pie","Election Donut Chart":"election-donut","Donut Chart":"donut","Bar Chart":"bar","Column Chart":"column","Grouped Column Chart":"grouped-column","Line Chart":"line"};var edata;$.each(gon.cms_articles,function(index,data){var class_name="#preview-"+data.id;var ehtml="";var title=data.description.split("![visualization](");if(title.length>0){title=title[1].split(")")[0]}if(title.length>0){$("<div>").attr("id",title).css({height:"300px",width:"200px"}).appendTo(class_name);$.get("/generate/chart/"+title,function(vdata,status){if(vdata){console.log($("#"+title),class_name);dw.visualize({type:chart_types[vdata.chart_type]+"-chart",theme:"default",container:$("#"+title),datasource:dw.datasource.delimited({csv:vdata.mapped_output})})}})}if(title.length<=0){console.log("adfsss");var image_checker=converter.makeHtml(data.description);$(class_name).html(image_checker);var element_type=$(class_name+" img:first");if(element_type.length<=0){element_type=image_checker}$(class_name).html(element_type)}})}if(typeof window.console==="undefined"){window.console={}}if(typeof window.console.emulated==="undefined"){if(typeof window.console.log==="function"){window.console.hasLog=true}else{if(typeof window.console.log==="undefined"){window.console.log=function(){}}window.console.hasLog=false}if(typeof window.console.debug==="function"){window.console.hasDebug=true}else{if(typeof window.console.debug==="undefined"){window.console.debug=!window.console.hasLog?function(){}:function(){var arr=["console.debug:"];for(var i=0;i<arguments.length;i++){arr.push(arguments[i])}window.console.log.apply(window.console,arr)}}window.console.hasDebug=false}if(typeof window.console.warn==="function"){window.console.hasWarn=true}else{if(typeof window.console.warn==="undefined"){window.console.warn=!window.console.hasLog?function(){}:function(){var arr=["console.warn:"];for(var i=0;i<arguments.length;i++){arr.push(arguments[i])}window.console.log.apply(window.console,arr)}}window.console.hasWarn=false}if(typeof window.console.error==="function"){window.console.hasError=true}else{if(typeof window.console.error==="undefined"){window.console.error=function(){var msg="An error has occured.";if(window.console.hasLog){var arr=["console.error:"];for(var i=0;i<arguments.length;i++){arr.push(arguments[i])}window.console.log.apply(window.console,arr);msg="An error has occured. More information is available in your browser's javascript console."}for(var i=0;i<arguments.length;++i){if(typeof arguments[i]!=="string"){break}msg+="\n"+arguments[i]}if(typeof Error!=="undefined"){throw new Error(msg)}else{throw (msg)}}}window.console.hasError=false}if(typeof window.console.trace==="function"){window.console.hasTrace=true}else{if(typeof window.console.trace==="undefined"){window.console.trace=function(){window.console.error("console.trace does not exist")}}window.console.hasTrace=false}window.console.emulated=true}(function($){$.appendStylesheet=$.appendStylesheet||function(url,overwrite){if(!(document.body||false)){setTimeout(function(){$.appendStylesheet.apply($,[url,overwrite])},500);return $}var id="stylesheet-"+url.replace(/[^a-zA-Z0-9]/g,"");var $old=$("#"+id);if(typeof overwrite==="undefined"){overwrite=false}if($old.length===1){if(overwrite){$old.remove()}else{return $}}var bodyEl=document.getElementsByTagName($.browser.safari?"head":"body")[0];var linkEl=document.createElement("link");linkEl.type="text/css";linkEl.rel="stylesheet";linkEl.media="screen";linkEl.href=url;linkEl.id=id;bodyEl.appendChild(linkEl);return $};$.appendScript=$.appendScript||function(url,overwrite){if(!(document.body||false)){setTimeout(function(){$.appendScript.apply($,[url,overwrite])},500);return $}var id="script-"+url.replace(/[^a-zA-Z0-9]/g,"");var $old=$("#"+id);if(typeof overwrite==="undefined"){overwrite=false}if($old.length===1){if(overwrite){$old.remove()}else{return $}}var bodyEl=document.getElementsByTagName($.browser.safari?"head":"body")[0];var scriptEl=document.createElement("script");scriptEl.type="text/javascript";scriptEl.src=url;scriptEl.id=id;bodyEl.appendChild(scriptEl);return $}})(jQuery);(function($){$.fn.findAndSelf=$.fn.findAndSelf||function(selector){var $this=$(this);return $this.find(selector).andSelf().filter(selector)};Number.prototype.replace=Number.prototype.replace||function(){var str=String(this);return str.replace.apply(this,arguments)};if(!($.SyntaxHighlighter||false)){$.SyntaxHighlighter={config:{load:true,highlight:true,debug:false,wrapLines:true,lineNumbers:true,stripEmptyStartFinishLines:true,stripInitialWhitespace:true,alternateLines:false,defaultClassname:"highlight",theme:"balupton",themes:["balupton"],addSparkleExtension:true,prettifyBaseUrl:false?"http://192.168.1.2/repos/jquery-syntaxhighlighter/prettify":"http://balupton.github.com/jquery-syntaxhighlighter/prettify",baseUrl:false?"http://192.168.1.2/repos/jquery-syntaxhighlighter":"http://balupton.github.com/jquery-syntaxhighlighter"},init:function(options){var SyntaxHighlighter=this,config=SyntaxHighlighter.config;var baseUrl=config.baseUrl;if(baseUrl[baseUrl.length-1]==="/"){config.baseUrl=baseUrl.substr(0,baseUrl.length-2)}delete baseUrl;$.extend(true,SyntaxHighlighter.config,options||{});if($.Sparkle||false&&config.addSparkleExtension){$.Sparkle.addExtension("syntaxhighlighter",function(){$(this).syntaxHighlight()})}$.fn.syntaxHighlight=$.fn.SyntaxHighlight=SyntaxHighlighter.fn;if(config.load){SyntaxHighlighter.load()}if(config.highlight){SyntaxHighlighter.highlight()}return this},load:function(){var SyntaxHighlighter=this,config=SyntaxHighlighter.config,prettifyBaseUrl=config.prettifyBaseUrl,baseUrl=config.baseUrl,themes=config.themes;if(!SyntaxHighlighter.loaded()){$.appendScript(prettifyBaseUrl+"/prettify.min.js");$.appendStylesheet(prettifyBaseUrl+"/prettify.min.css");$.appendStylesheet(baseUrl+"/styles/style.min.css");$.each(themes,function(i,theme){$.appendStylesheet(baseUrl+"/styles/theme-"+theme+".min.css")});if($.browser.msie){$.appendStylesheet(baseUrl+"/styles/ie.min.css")}SyntaxHighlighter.loadedExtras=true}return this},loadedExtras:false,loaded:function(){return typeof prettyPrint!=="undefined"&&this.loadedExtras},determineLanguage:function(css){var language=null,regex=/lang(uage)?-([a-z0-9]+)/g,match=regex.exec(css);while(match!==null){language=match[2];match=regex.exec(css)}return language},fn:function(){var SyntaxHighlighter=$.SyntaxHighlighter,config=SyntaxHighlighter.config,$el=$(this);$.SyntaxHighlighter.highlight({el:$el});return this},highlight:function(params){if(typeof params!=="object"){params={}}var SyntaxHighlighter=this,config=SyntaxHighlighter.config,$el=params.el||false;if(!($el instanceof jQuery)){$el=$("body")}if(!SyntaxHighlighter.loaded()){if(config.debug){window.console.debug("SyntaxHighlighter.highlight: Chosen SyntaxHighlighter is not yet defined. Waiting 1200 ms then trying again.")}setTimeout(function(){SyntaxHighlighter.highlight.apply(SyntaxHighlighter,[params])},1200);return}var defaultClassname=config.defaultClassname,defaultSelector="";if(typeof defaultClassname==="array"){defaultSelector="."+defaultClassname.join(",.");defaultClassname=defaultClassname.join(" ")}else{defaultClassname=String(defaultClassname);defaultSelector="."+defaultClassname.replace(" ",",.")}if(defaultSelector==="."||!defaultClassname){window.console.error("SyntaxHighlighter.highlight: Invalid defaultClassname.",[this,arguments],[config.defaultClassname]);window.console.trace()}var $codes=$el.findAndSelf("code,pre").filter("[class*=lang],"+defaultSelector).filter(":not(.prettyprint)");$codes.css({"overflow-y":"visible","overflow-x":"visible","white-space":"pre"}).addClass("prettyprint "+defaultClassname).each(function(){var $code=$(this),css=$code.attr("class"),language=SyntaxHighlighter.determineLanguage(css);$code.addClass("lang-"+language)});if(config.lineNumbers){$codes.addClass("linenums")}if(config.theme){$codes.addClass("theme-"+config.theme)}if(config.alternateLines){$codes.addClass("alternate")}prettyPrint();if(config.stripEmptyStartFinishLines){$codes.find("li:first-child > :first-child, li:last-child > :first-child").each(function(){var $initialText=$(this),html=$initialText.html(),empty=/^([\r\n\s\t]|\&nbsp;)*$/.test(html),$parent=$initialText.parent(),$siblings=$initialText.siblings();if(empty&&($siblings.length===0||($siblings.length===1&&$siblings.filter(":last").is("br")))){var $parent=$initialText.parent(),value=$parent.val();$parent.next().val(value);$parent.remove()}})}if(config.stripInitialWhitespace){$codes.find("li:first-child > :first-child").each(function(){var $initialText=$(this),html=$initialText.html(),match=html.match(/^(([\r\n\s\t]|\&nbsp;)+)/)||[],whitespace=(match[1]||"");if(whitespace.length){$initialText.parent().siblings().children(":first-child").add($initialText).each(function(){var $nextText=$(this),html=$nextText.html();html=html.replace(new RegExp("^"+whitespace,"gm"),"");$nextText.html(html)})}})}if(config.wrapLines){$codes.css({"overflow-x":"hidden","overflow-y":"hidden","white-space":"pre-wrap","max-height":"none"})}else{$codes.css({"overflow-x":"auto","overflow-y":"auto","white-space":"normal","max-height":"500px"})}return this}}}else{window.console.warn("SyntaxHighlighter has already been defined...")}})(jQuery);var Attacklab=Attacklab||{};Attacklab.showdown=Attacklab.showdown||{};Attacklab.showdown.converter=function(){var g_urls;var g_titles;var g_html_blocks;var visualization_titles=[];var g_list_level=0;this.makeHtml=function(text){g_urls=new Array();g_titles=new Array();g_html_blocks=new Array();text=text.replace(/~/g,"~T");text=text.replace(/\$/g,"~D");text=text.replace(/\r\n/g,"\n");text=text.replace(/\r/g,"\n");text="\n\n"+text+"\n\n";text=_Detab(text);text=text.replace(/^[ \t]+$/mg,"");text=_HashHTMLBlocks(text);text=_StripLinkDefinitions(text);text=_RunBlockGamut(text);text=_UnescapeSpecialChars(text);text=text.replace(/~D/g,"$$");text=text.replace(/~T/g,"~");return text};var _StripLinkDefinitions=function(text){var text=text.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+)/gm,function(wholeMatch,m1,m2,m3,m4){m1=m1.toLowerCase();g_urls[m1]=_EncodeAmpsAndAngles(m2);if(m3){return m3+m4}else{if(m4){g_titles[m1]=m4.replace(/"/g,"&quot;")}}return""});return text};var _HashHTMLBlocks=function(text){text=text.replace(/\n/g,"\n\n");var block_tags_a="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del";var block_tags_b="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math";text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,hashElement);text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,hashElement);text=text.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/\n\n/g,"\n");return text};var hashElement=function(wholeMatch,m1){var blockText=m1;blockText=blockText.replace(/\n\n/g,"\n");blockText=blockText.replace(/^\n/,"");blockText=blockText.replace(/\n+$/g,"");blockText="\n\n~K"+(g_html_blocks.push(blockText)-1)+"K\n\n";return blockText};var _RunBlockGamut=function(text){text=_DoHeaders(text);var key=hashBlock("<hr />");text=text.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?-[ ]?){3,}[ \t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?_[ ]?){3,}[ \t]*$/gm,key);text=_DoLists(text);text=_DoCodeBlocks(text);text=_DoBlockQuotes(text);text=_HashHTMLBlocks(text);text=_FormParagraphs(text);return text};var _RunSpanGamut=function(text){text=_DoCodeSpans(text);text=_EscapeSpecialCharsWithinTagAttributes(text);text=_EncodeBackslashEscapes(text);text=_DoImages(text);text=_DoAnchors(text);text=_DoAutoLinks(text);text=_EncodeAmpsAndAngles(text);text=_DoItalicsAndBold(text);text=text.replace(/  +\n/g," <br />\n");return text};var _EscapeSpecialCharsWithinTagAttributes=function(text){var regex=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;text=text.replace(regex,function(wholeMatch){var tag=wholeMatch.replace(/(.)<\/?code>(?=.)/g,"$1`");tag=escapeCharacters(tag,"\\`*_");return tag});return text};var _DoAnchors=function(text){text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeAnchorTag);text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeAnchorTag);text=text.replace(/(\[([^\[\]]+)\])()()()()()/g,writeAnchorTag);return text};var writeAnchorTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){if(m7==undefined){m7=""}var whole_match=m1;var link_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(url==""){if(link_id==""){link_id=link_text.toLowerCase().replace(/ ?\n/g," ")}url="#"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined){title=g_titles[link_id]}}else{if(whole_match.search(/\(\s*\)$/m)>-1){url=""}else{return whole_match}}}url=escapeCharacters(url,"*_");var result='<a href="'+url+'"';if(title!=""){title=title.replace(/"/g,"&quot;");title=escapeCharacters(title,"*_");result+=' title="'+title+'"'}result+=">"+link_text+"</a>";return result};var _DoImages=function(text){text=text.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeImageTag);text=text.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeImageTag);return text};var writeImageTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){var whole_match=m1;var alt_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(m2=="visualization"){var div_id="";var possible="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var i=0;i<5;i++){div_id+=possible.charAt(Math.floor(Math.random()*possible.length))}GenerateDataWrapperChartBySlug(m4,div_id);result=""}else{if(!title){title=""}if(url==""){if(link_id==""){link_id=alt_text.toLowerCase().replace(/ ?\n/g," ")}url="#"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined){title=g_titles[link_id]}}else{return whole_match}}alt_text=alt_text.replace(/"/g,"&quot;");url=escapeCharacters(url,"*_");var result='<img src="'+url+'" alt="'+alt_text+'"';title=title.replace(/"/g,"&quot;");title=escapeCharacters(title,"*_");result+=' title="'+title+'"';result+=" />"}return result};var GenerateDataWrapperChartBySlug=function(slug,div_id,text){var chart_types={"Pie Chart":"pie","Election Donut Chart":"election-donut","Donut Chart":"donut","Bar Chart":"bar","Column Chart":"column","Grouped Column Chart":"grouped-column","Line Chart":"line"};var vdata;$.get("/generate/chart/"+slug,function(data,status){vdata=data;if(data){$("<div>").attr("id",div_id).css({height:"300px",width:"200px"}).appendTo("#preview");dw.visualize({type:chart_types[data.chart_type]+"-chart",theme:"default",container:$("#"+div_id),datasource:dw.datasource.delimited({csv:data.mapped_output})})}});return $("#"+div_id)};var _DoHeaders=function(text){text=text.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(wholeMatch,m1){return hashBlock("<h1>"+_RunSpanGamut(m1)+"</h1>")});text=text.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(matchFound,m1){return hashBlock("<h2>"+_RunSpanGamut(m1)+"</h2>")});text=text.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(wholeMatch,m1,m2){var h_level=m1.length;return hashBlock("<h"+h_level+">"+_RunSpanGamut(m2)+"</h"+h_level+">")});return text};var _ProcessListItems;var _DoLists=function(text){text+="~0";var whole_list=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;if(g_list_level){text=text.replace(whole_list,function(wholeMatch,m1,m2){var list=m1;var list_type=(m2.search(/[*+-]/g)>-1)?"ul":"ol";list=list.replace(/\n{2,}/g,"\n\n\n");var result=_ProcessListItems(list);result=result.replace(/\s+$/,"");result="<"+list_type+">"+result+"</"+list_type+">\n";return result})}else{whole_list=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g;text=text.replace(whole_list,function(wholeMatch,m1,m2,m3){var runup=m1;var list=m2;var list_type=(m3.search(/[*+-]/g)>-1)?"ul":"ol";var list=list.replace(/\n{2,}/g,"\n\n\n");var result=_ProcessListItems(list);result=runup+"<"+list_type+">\n"+result+"</"+list_type+">\n";return result})}text=text.replace(/~0/,"");return text};_ProcessListItems=function(list_str){g_list_level++;list_str=list_str.replace(/\n{2,}$/,"\n");list_str+="~0";list_str=list_str.replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(wholeMatch,m1,m2,m3,m4){var item=m4;var leading_line=m1;var leading_space=m2;if(leading_line||(item.search(/\n{2,}/)>-1)){item=_RunBlockGamut(_Outdent(item))}else{item=_DoLists(_Outdent(item));item=item.replace(/\n$/,"");item=_RunSpanGamut(item)}return"<li>"+item+"</li>\n"});list_str=list_str.replace(/~0/g,"");g_list_level--;return list_str};var _DoCodeBlocks=function(text){text+="~0";text=text.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(wholeMatch,m1,m2){var codeblock=m1;var nextChar=m2;codeblock=_EncodeCode(_Outdent(codeblock));codeblock=_Detab(codeblock);codeblock=codeblock.replace(/^\n+/g,"");codeblock=codeblock.replace(/\n+$/g,"");codeblock="<pre><code class='highlight'>"+codeblock+"\n</code></pre>";return hashBlock(codeblock)+nextChar});text=text.replace(/~0/,"");return text};var hashBlock=function(text){text=text.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(g_html_blocks.push(text)-1)+"K\n\n"};var _DoCodeSpans=function(text){text=text.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(wholeMatch,m1,m2,m3,m4){var c=m3;c=c.replace(/^([ \t]*)/g,"");c=c.replace(/[ \t]*$/g,"");c=_EncodeCode(c);return m1+"<code class='highlight'>"+c+"</code>"});return text};var _EncodeCode=function(text){text=text.replace(/&/g,"&amp;");text=text.replace(/</g,"&lt;");text=text.replace(/>/g,"&gt;");text=escapeCharacters(text,"*_{}[]\\",false);return text};var _DoItalicsAndBold=function(text){text=text.replace(/(\*\*|__)(?=\S)([^\r]*?\S[\*_]*)\1/g,"<strong>$2</strong>");text=text.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>");return text};var _DoBlockQuotes=function(text){text=text.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(wholeMatch,m1){var bq=m1;bq=bq.replace(/^[ \t]*>[ \t]?/gm,"~0");bq=bq.replace(/~0/g,"");bq=bq.replace(/^[ \t]+$/gm,"");bq=_RunBlockGamut(bq);bq=bq.replace(/(^|\n)/g,"$1  ");bq=bq.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(wholeMatch,m1){var pre=m1;pre=pre.replace(/^  /mg,"~0");pre=pre.replace(/~0/g,"");return pre});return hashBlock("<blockquote>\n"+bq+"\n</blockquote>")});return text};var _FormParagraphs=function(text){text=text.replace(/^\n+/g,"");text=text.replace(/\n+$/g,"");var grafs=text.split(/\n{2,}/g);var grafsOut=new Array();var end=grafs.length;for(var i=0;i<end;i++){var str=grafs[i];if(str.search(/~K(\d+)K/g)>=0){grafsOut.push(str)}else{if(str.search(/\S/)>=0){str=_RunSpanGamut(str);str=str.replace(/^([ \t]*)/g,"<p>");str+="</p>";grafsOut.push(str)}}}end=grafsOut.length;for(var i=0;i<end;i++){while(grafsOut[i].search(/~K(\d+)K/)>=0){var blockText=g_html_blocks[RegExp.$1];blockText=blockText.replace(/\$/g,"$$$$");grafsOut[i]=grafsOut[i].replace(/~K\d+K/,blockText)}}return grafsOut.join("\n\n")};var _EncodeAmpsAndAngles=function(text){text=text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");text=text.replace(/<(?![a-z\/?\$!])/gi,"&lt;");return text};var _EncodeBackslashEscapes=function(text){text=text.replace(/\\(\\)/g,escapeCharacters_callback);text=text.replace(/\\([`*_{}\[\]()>#+-.!])/g,escapeCharacters_callback);return text};var _DoAutoLinks=function(text){text=text.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>');text=text.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(wholeMatch,m1){return _EncodeEmailAddress(_UnescapeSpecialChars(m1))});return text};var _EncodeEmailAddress=function(addr){function char2hex(ch){var hexDigits="0123456789ABCDEF";var dec=ch.charCodeAt(0);return(hexDigits.charAt(dec>>4)+hexDigits.charAt(dec&15))}var encode=[function(ch){return"&#"+ch.charCodeAt(0)+";"},function(ch){return"&#x"+char2hex(ch)+";"},function(ch){return ch}];addr="mailto:"+addr;addr=addr.replace(/./g,function(ch){if(ch=="@"){ch=encode[Math.floor(Math.random()*2)](ch)}else{if(ch!=":"){var r=Math.random();ch=(r>0.9?encode[2](ch):r>0.45?encode[1](ch):encode[0](ch))}}return ch});addr='<a href="'+addr+'">'+addr+"</a>";addr=addr.replace(/">.+:/g,'">');return addr};var _UnescapeSpecialChars=function(text){text=text.replace(/~E(\d+)E/g,function(wholeMatch,m1){var charCodeToReplace=parseInt(m1);return String.fromCharCode(charCodeToReplace)});return text};var _Outdent=function(text){text=text.replace(/^(\t|[ ]{1,4})/gm,"~0");text=text.replace(/~0/g,"");return text};var _Detab=function(text){text=text.replace(/\t(?=\t)/g,"    ");text=text.replace(/\t/g,"~A~B");text=text.replace(/~B(.+?)~A/g,function(wholeMatch,m1,m2){var leadingText=m1;var numSpaces=4-leadingText.length%4;for(var i=0;i<numSpaces;i++){leadingText+=" "}return leadingText});text=text.replace(/~A/g,"    ");text=text.replace(/~B/g,"");return text};var escapeCharacters=function(text,charsToEscape,afterBackslash){var regexString="(["+charsToEscape.replace(/([\[\]\\])/g,"\\$1")+"])";if(afterBackslash){regexString="\\\\"+regexString}var regex=new RegExp(regexString,"g");text=text.replace(regex,escapeCharacters_callback);return text};var escapeCharacters_callback=function(wholeMatch,m1){var charCodeToEscape=m1.charCodeAt(0);return"~E"+charCodeToEscape+"E"}};var Showdown=Attacklab.showdown;if(Attacklab.fileLoaded){Attacklab.fileLoaded("showdown.js")}(function(){var WMD,Chunk,InputState,Command,Dialog,Overlay,Form,Field,LinkHelper,Translator,documentElement,eventCache=[],browser={IE:!!(window.attachEvent&&!window.opera),Opera:!!window.opera,WebKit:navigator.userAgent.indexOf("AppleWebKit/")>-1};WMD=function(input,toolbar,options){options=extend({preview:null,previewEvery:0.5,showdown:null,lineLength:40,commands:"strong em spacer a blockquote code img spacer ol ul h hr",commandTable:{},lang:"EN"},options);chooseTranslator(options.lang);if(typeof input==="string"){input=document.getElementById(input)}if(typeof toolbar==="string"){toolbar=document.getElementById(toolbar)}var obj={},shortcuts={},previewInterval,lastValue="";if(!options.showdown&&typeof Attacklab!=="undefined"&&Attacklab.showdown&&Attacklab.showdown.converter){options.showdown=new Attacklab.showdown.converter().makeHtml}function buildToolbar(){var ul,i,key,definition,builder,command,commands=options.commands.split(" ");if(toolbar){toolbar.innerHTML="";ul=document.createElement("ul");ul.className="wmd-toolbar";toolbar.appendChild(ul);for(i=0;i<commands.length;i=i+1){key=commands[i];definition=null;command=null;builder=Command.create;if(options.commandTable[key]){definition=options.commandTable[key]}else{if(Command.builtIn[key]){definition=Command.builtIn[key]}}if(definition){if(definition.builder&&typeof definition.builder==="function"){builder=definition.builder}command=builder(obj,key,definition);if(definition.shortcut&&typeof definition.shortcut==="string"){shortcuts[definition.shortcut.toLowerCase()]=command.run}command.draw(ul)}}}}function createEvents(){var onSubmit;addEvent(input,browser.Opera?"keypress":"keydown",function(event){var ev=event||window.event,keyCode=ev.keyCode||ev.which,keyChar=String.fromCharCode(keyCode).toLowerCase();if(ev.ctrlKey||ev.metaKey){if(shortcuts[keyChar]&&typeof shortcuts[keyChar]==="function"){shortcuts[keyChar]();if(ev.preventDefault){ev.preventDefault()}if(window.event){window.event.returnValue=false}return false}}});addEvent(input,"keyup",function(event){var ev=event||window.event,keyCode=ev.keyCode||ev.which,meta=ev.shiftKey||ev.ctrlKey||ev.metaKey,state,chunk;if(!meta&&keyCode===13){state=new InputState(obj);chunk=state.getChunk();Command.autoIndent(obj,chunk,function(){state.setChunk(chunk);state.restore()})}});if(browser.IE){addEvent(input,"keypress",function(event){var ev=event||window.event,keyCode=ev.keyCode||ev.which;if(keyCode===27){ev.returnValue=false;return false}})}if(options.preview&&options.previewEvery>0&&typeof options.showdown==="function"){if(typeof options.preview==="string"){options.preview=document.getElementById(options.preview)}function refreshPreview(){if(input.value!==lastValue){options.preview.innerHTML=options.showdown(input.value);lastValue=input.value}}previewInterval=setInterval(refreshPreview,options.previewEvery*1000);addEvent(input,"keypress",refreshPreview);addEvent(input,"keydown",refreshPreview)}}buildToolbar();createEvents();return extend(obj,{input:input,options:options,ieClicked:false,ieRange:null})};function addClassName(element,className){var elementClassName=element.className;if(!(elementClassName.length>0&&(elementClassName===className||new RegExp("(^|\\s)"+className+"(\\s|$)").test(elementClassName)))){element.className=element.className+(element.className?" ":"")+className}return element}function addEvent(element,event,callback,cache){if(element.attachEvent){element.attachEvent("on"+event,callback)}else{element.addEventListener(event,callback,false)}if(cache&&typeof cache.push==="function"){cache.push({element:element,event:event,callback:callback})}else{eventCache.push({element:element,event:event,callback:callback})}}function extend(dest,source){source=source||{};dest=dest||{};var prop;for(prop in source){if(source.hasOwnProperty(prop)&&typeof source[prop]!=="undefined"){dest[prop]=source[prop]}}return dest}function extendRegExp(regex,pre,post){var pattern=regex.toString(),flags="",result;if(pre===null||pre===undefined){pre=""}if(post===null||post===undefined){post=""}result=pattern.match(/\/([gim]*)$/);if(result){flags=result[1]}else{flags=""}pattern=pattern.replace(/(^\/|\/[gim]*$)/g,"");pattern=pre+pattern+post;return new RegExp(pattern,flags)}function fixEol(text){return(text||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")}function getViewportDimensions(){if(!documentElement){if(browser.WebKit&&!document.evaluate){documentElement=document}else{if(browser.Opera&&window.parseFloat(window.opera.version())<9.5){documentElement=document.body}else{documentElement=document.documentElement}}}return{width:documentElement.clientWidth,height:documentElement.clientHeight}}function indexOf(array,item){var i,n;if(array){if(typeof array.indexOf!=="undefined"){return array.indexOf(item)}if(typeof array.length!=="undefined"){for(i=0,n=array.length;i<n;i++){if(array[i]===item){return i}}}}return -1}function randomString(length,options){options=extend({numbers:false,lower:true,upper:true,other:false},options);var numbers="0123456789";var lower="abcdefjhijklmnopqrstuvwxyz";var upper="ABCDEFJHIJKLMNOPQRSTUVWXYZ";var other="`~!@#$%^&*()-_=+[{]}\\|;:'\",<.>/?";var charset="",str="";if(options.numbers){charset+=numbers}if(options.lower){charset+=lower}if(options.upper){charset+=upper}if(options.other){charset+=other}if(charset.length===0){throw ("There is no character set from which to generate random strings.")}function getCharacter(){return charset.charAt(getIndex(0,charset.length))}function getIndex(lower,upper){return Math.floor(Math.random()*(upper-lower))+lower}for(var i=0;i<length;i++){str+=getCharacter()}return str}function removeClassName(element,className){element.className=element.className.replace(new RegExp("(^|\\s+)"+className+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"");return element}function removeEvent(element,event,callback,cache){var cached=null,i=0;cache=(cache&&typeof cache.push==="function")?cache:eventCache;for(;i<cache.length;i++){if(cache[i].element===element&&cache[i].event===event&&cache[i].callback===callback){cached=cache[i];break}}if(element.detachEvent){element.detachEvent("on"+event,callback)}else{element.removeEventListener(event,callback,false)}if(cached){cache.splice(indexOf(cache,cached),1)}}function visible(element){var v=true;if(window.getComputedStyle){v=window.getComputedStyle(element,null).getPropertyValue("display")!=="none"}else{if(element.currentStyle){v=element.currentStyle.display!=="none"}}return v}addEvent(window,"unload",function(){while(eventCache.length>0){removeEvent(eventCache[0].element,eventCache[0].event,eventCache[0].callback)}});Translator_EN={urlFieldInsertion:'<span class="note">To add a tool-tip, place it in quotes after the URL (e.g., <strong>http://google.com "Google"</strong>)</span>',linkText:"link text",imageAlt:"image alt",listItem:"List item",strongTitle:"Strong <strong> Ctl+B",emTitle:"Emphasis <em> Ctl+I",aTitle:"Hyperlink <a> Ctl+L",blockquoteTitle:"Blockquote <blockquote> Ctl+Q",codeTitle:"Code Sample <pre><code> Ctl+K",imgTitle:"Image <img> Ctl+G",olTitle:"Numbered List <ol> Ctl+O",ulTitle:"Bulleted List <ul> Ctl+U",hTitle:"Heading <h1>/<h2> Ctl+H",hrTitle:"Horizontal Rule <hr> Ctl+R",strongText:"Bold",emText:"Italic",aText:"Link",blockquoteText:"Blockquote",codeText:"Code",imgText:"Image",olText:"Numbered List",ulText:"Bulleted List",hText:"Heading",hrText:"Horizontal Rule",insertImage:"Insert image",imageURL:"Image URL",enterCodeHere:"enter code here",blockquote:"Blockquote",insertLink:"Insert link",linkURL:"Link URL",submit:"Submit",cancel:"Cancel"};Translator_RU={urlFieldInsertion:'<span class="note">(например, <strong>http://google.com</strong>)</span>',linkText:"название ссылки",imageAlt:"описание картинки",listItem:"текст",strongTitle:"Жирный <strong> Ctl+B",emTitle:"Курсив <em> Ctl+I",aTitle:"Вставить ссылку <a> Ctl+L",blockquoteTitle:"Ыитировать <blockquote> Ctl+Q",codeTitle:"Вставить пример кода <pre><code> Ctl+K",imgTitle:"Вставить картинку <img> Ctl+G",olTitle:"Нумерованный список <ol> Ctl+O",ulTitle:"Маркированный список <ul> Ctl+U",hTitle:"Вставить заголовок <h1>/<h2> Ctl+H",hrTitle:"Горизонтальная черта <hr> Ctl+R",strongText:"Bold",emText:"Italic",aText:"Link",blockquoteText:"Blockquote",codeText:"Code",imgText:"Image",olText:"Numbered List",ulText:"Bulleted List",hText:"Heading",hrText:"Horizontal Rule",insertImage:"Вставить картинку",imageURL:"Адрес картинки",enterCodeHere:"вставьте код сдесь",blockquote:"текст цитаты",insertLink:"Вставить ссылку",linkURL:"Ссылка",submit:"Ок",cancel:"Отмена"};Translator=Translator_EN;function chooseTranslator(lang){if(lang=="RU"){Translator=Translator_RU}else{Translator=Translator_EN}Command.builtIn={strong:{text:Translator.strongText,title:Translator.strongTitle,css:"wmd-strong",shortcut:"b"},em:{text:Translator.emText,title:Translator.emTitle,css:"wmd-em",shortcut:"i"},a:{text:Translator.aText,title:Translator.aTitle,css:"wmd-a",shortcut:"l"},blockquote:{text:Translator.blockquoteText,title:Translator.blockquoteTitle,css:"wmd-blockquote",shortcut:"q"},code:{text:Translator.codeText,title:Translator.codeTitle,css:"wmd-code",shortcut:"k"},img:{text:Translator.imgText,title:Translator.imgTitle,css:"wmd-img",shortcut:"g"},ol:{text:Translator.olText,title:Translator.olTitle,css:"wmd-ol",shortcut:"o"},ul:{text:Translator.ulText,title:Translator.ulTitle,css:"wmd-ul",shortcut:"u"},h:{text:Translator.hText,title:Translator.hTitle,css:"wmd-h",shortcut:"h"},hr:{text:Translator.hrText,title:Translator.hrTitle,css:"wmd-hr",shortcut:"r"},spacer:{css:"wmd-spacer",builder:Command.createSpacer}}}Chunk=function(text,selectionStartIndex,selectionEndIndex,selectionScrollTop){var prefixes="(?:\\s{4,}|\\s*>|\\s*-\\s+|\\s*\\d+\\.|=|\\+|-|_|\\*|#|\\s*\\[[^\n]]+\\]:)",obj={};return extend(obj,{before:fixEol(text.substring(0,selectionStartIndex)),selection:fixEol(text.substring(selectionStartIndex,selectionEndIndex)),after:fixEol(text.substring(selectionEndIndex)),scrollTop:selectionScrollTop,startTag:"",endTag:"",addBlankLines:function(numberBefore,numberAfter,findExtra){var regexText,replacementText,match;numberBefore=(typeof numberBefore==="undefined"||numberBefore===null)?1:numberBefore;numberAfter=(typeof numberAfter==="undefined"||numberAfter===null)?1:numberAfter;numberBefore=numberBefore+1;numberAfter=numberAfter+1;match=/(^\n*)/.exec(this.selection);this.selection=this.selection.replace(/(^\n*)/,"");this.startTag=this.startTag+(match?match[1]:"");match=/(\n*$)/.exec(this.selection);this.selection=this.selection.replace(/(\n*$)/,"");this.endTag=this.endTag+(match?match[1]:"");match=/(^\n*)/.exec(this.startTag);this.startTag=this.startTag.replace(/(^\n*)/,"");this.before=this.before+(match?match[1]:"");match=/(\n*$)/.exec(this.endTag);this.endTag=this.endTag.replace(/(\n*$)/,"");this.after=this.after+(match?match[1]:"");if(this.before){regexText=replacementText="";while(numberBefore>0){regexText=regexText+"\\n?";replacementText=replacementText+"\n";numberBefore=numberBefore-1}if(findExtra){regexText="\\n*"}this.before=this.before.replace(new RegExp(regexText+"$",""),replacementText)}if(this.after){regexText=replacementText="";while(numberAfter>0){regexText=regexText+"\\n?";replacementText=replacementText+"\n";numberAfter=numberAfter-1}if(findExtra){regexText="\\n*"}this.after=this.after.replace(new RegExp(regexText,""),replacementText)}return this},setTags:function(startExp,endExp){var that=this,tempExp;if(startExp){tempExp=extendRegExp(startExp,"","$");this.before=this.before.replace(tempExp,function(match){that.startTag=that.startTag+match;return""});tempExp=extendRegExp(startExp,"^","");this.selection=this.selection.replace(tempExp,function(match){that.startTag=that.startTag+match;return""})}if(endExp){tempExp=extendRegExp(endExp,"","$");this.selection=this.selection.replace(tempExp,function(match){that.endTag=match+that.endTag;return""});tempExp=extendRegExp(endExp,"^","");this.after=this.after.replace(tempExp,function(match){that.endTag=match+that.endTag;return""})}return this},trimWhitespace:function(remove){this.selection=this.selection.replace(/^(\s*)/,"");if(!remove){this.before=this.before+RegExp.$1}this.selection=this.selection.replace(/(\s*)$/,"");if(!remove){this.after=RegExp.$1+this.after}return this},unwrap:function(){var text=new RegExp("([^\\n])\\n(?!(\\n|"+prefixes+"))","g");this.selection=this.selection.replace(text,"$1 $2");return this},wrap:function(len){var regex=new RegExp("(.{1,"+len+"})( +|$\\n?)","gm");this.unwrap();this.selection=this.selection.replace(regex,function(line,marked){if(new RegExp("^"+prefixes,"").test(line)){return line}return marked+"\n"});this.selection=this.selection.replace(/\s+$/,"");return this}})};InputState=function(wmd){var obj={},input=wmd.input;obj=extend(obj,{scrollTop:0,text:"",start:0,end:0,getChunk:function(){return new Chunk(this.text,this.start,this.end,this.scrollTop)},restore:function(){if(this.text!==input.value){input.value=this.text}this.setInputSelection();input.scrollTop=this.scrollTop},setChunk:function(chunk){chunk.before=chunk.before+chunk.startTag;chunk.after=chunk.endTag+chunk.after;if(browser.Opera){chunk.before=chunk.before.replace(/\n/g,"\r\n");chunk.selection=chunk.selection.replace(/\n/g,"\r\n");chunk.after=chunk.after.replace(/\n/g,"\r\n")}this.start=chunk.before.length;this.end=chunk.before.length+chunk.selection.length;this.text=chunk.before+chunk.selection+chunk.after;this.scrollTop=chunk.scrollTop},setInputSelection:function(){var range;if(visible(input)){input.focus();if(input.selectionStart||input.selectionStart===0){input.selectionStart=this.start;input.selectionEnd=this.end;input.scrollTop=this.scrollTop}else{if(document.selection){if(!document.activeElement||document.activeElement===input){range=input.createTextRange();range.moveStart("character",-1*input.value.length);range.moveEnd("character",-1*input.value.length);range.moveEnd("character",this.end);range.moveStart("character",this.start);range.select()}}}}},setStartEnd:function(){var range,fixedRange,markedRange,rangeText,len,marker="\x07";if(visible(input)){if(input.selectionStart||input.selectionStart===0){this.start=input.selectionStart;this.end=input.selectionEnd}else{if(document.selection){this.text=fixEol(input.value);if(wmd.ieClicked&&wmd.ieRange){range=wmd.ieRange;wmd.ieClicked=false}else{range=document.selection.createRange()}fixedRange=fixEol(range.text);markedRange=marker+fixedRange+marker;range.text=markedRange;rangeText=fixEol(input.value);range.moveStart("character",-1*markedRange.length);range.text=fixedRange;this.start=rangeText.indexOf(marker);this.end=rangeText.lastIndexOf(marker)-marker.length;len=this.text.length-fixEol(input.value).length;if(len>0){range.moveStart("character",-1*fixedRange.length);while(len>0){fixedRange=fixedRange+"\n";this.end=this.end+1;len=len-1}range.text=fixedRange}this.setInputSelection()}}}}});if(visible(input)){input.focus();obj.setStartEnd();obj.scrollTop=input.scrollTop;if(input.selectionStart||input.selectionStart===0){obj.text=input.value}}return obj};Command=function(wmd,definition,runner,options){options=extend({downCssSuffix:"-down"},options);var element,obj={},downCss=definition.css+options.downCssSuffix;function resetCss(){if(element){element.className=Command.css.base+" "+definition.css}}return extend(obj,{draw:function(parent){var span,downCss=definition.css+options.downCssSuffix;if(!element){element=document.createElement("li");element.title=definition.title;parent.appendChild(element);span=document.createElement("span");span.innerHTML=definition.text;element.appendChild(span);addEvent(element,"click",function(event){resetCss();obj.run()});addEvent(element,"mouseover",function(event){resetCss();addClassName(element,Command.css.over)});addEvent(element,"mouseout",function(event){resetCss()});addEvent(element,"mousedown",function(event){resetCss();addClassName(element,Command.css.down);addClassName(element,downCss);if(browser.IE){wmd.ieClicked=true;wmd.ieRange=document.selection.createRange()}})}else{parent.appendChild(element)}resetCss()},run:function(){var state=new InputState(wmd),chunk=state.getChunk();runner(wmd,chunk,function(){state.setChunk(chunk);state.restore()})}})};extend(Command,{css:{base:"wmd-command",over:"wmd-command-over",down:"wmd-command-down"},autoIndent:function(wmd,chunk,callback,args){args=extend(args,{preventDefaultText:true});chunk.before=chunk.before.replace(/(\n|^)[ ]{0,3}([*+-]|\d+[.])[ \t]*\n$/,"\n\n");chunk.before=chunk.before.replace(/(\n|^)[ ]{0,3}>[ \t]*\n$/,"\n\n");chunk.before=chunk.before.replace(/(\n|^)[ \t]+\n$/,"\n\n");if(/(\n|^)[ ]{0,3}([*+-])[ \t]+.*\n$/.test(chunk.before)){Command.runners.ul(wmd,chunk,callback,extend(args,{preventDefaultText:false}))}else{if(/(\n|^)[ ]{0,3}(\d+[.])[ \t]+.*\n$/.test(chunk.before)){Command.runners.ol(wmd,chunk,callback,extend(args,{preventDefaultText:false}))}else{if(/(\n|^)[ ]{0,3}>[ \t]+.*\n$/.test(chunk.before)){Command.runners.blockquote(wmd,chunk,callback,args)}else{if(/(\n|^)(\t|[ ]{4,}).*\n$/.test(chunk.before)){Command.runners.code(wmd,chunk,callback,args)}else{if(typeof callback==="function"){callback()}}}}}},create:function(wmd,key,definition){return new Command(wmd,definition,Command.runners[key])},createSpacer:function(wmd,key,definition){var element=null;return{draw:function(parent){var span;if(!element){element=document.createElement("li");element.className=Command.css.base+" "+definition.css;parent.appendChild(element);span=document.createElement("span");element.appendChild(span)}else{parent.appendChild(element)}return element},run:function(){}}},createSubmitCancelForm:function(title,onSubmit,onDestroy){var cancel=document.createElement("a"),form=new Form(title,{dialog:true,onSubmit:onSubmit,onDestroy:onDestroy}),submitField=new Field("","submit",{value:Translator.submit});form.addField("submit",submitField);cancel.href="javascript:void(0);";cancel.innerHTML=Translator.cancel;cancel.onclick=function(){form.destroy()};submitField.insert("&nbsp;or&nbsp;");submitField.insert(cancel);return form},runLinkImage:function(wmd,chunk,callback,args){var callback=typeof callback==="function"?callback:function(){};function make(link){var linkDef,num;if(link){chunk.startTag=chunk.endTag="";linkDef=" [999]: "+link;num=LinkHelper.add(chunk,linkDef);chunk.startTag=args.tag==="img"?"![":"[";chunk.endTag="]["+num+"]";if(!chunk.selection){if(args.tag==="img"){chunk.selection=Translator.imageAlt}else{chunk.selection=Translator.linkText}}}}chunk.trimWhitespace();chunk.setTags(/\s*!?\[/,/\][ ]?(?:\n[ ]*)?(\[.*?\])?/);if(chunk.endTag.length>1){chunk.startTag=chunk.startTag.replace(/!?\[/,"");chunk.endTag="";LinkHelper.add(chunk);callback()}else{if(/\n\n/.test(chunk.selection)){LinkHelper.add(chunk);callback()}else{if(typeof args.prompt==="function"){args.prompt(function(link){make(link);callback()})}else{make(args.link||null);callback()}}}},runList:function(wmd,chunk,callback,args){var previousItemsRegex=/(\n|^)(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*$/,nextItemsRegex=/^\n*(([ ]{0,3}([*+-]|\d+[.])[ \t]+.*)(\n.+|\n{2,}([*+-].*|\d+[.])[ \t]+.*|\n{2,}[ \t]+\S.*)*)\n*/,finished=false,bullet="-",num=1,hasDigits,nLinesBefore,prefix,nLinesAfter,spaces;callback=typeof callback==="function"?callback:function(){};function getItemPrefix(){var prefix;if(args.tag==="ol"){prefix=" "+num+". ";num=num+1}else{prefix=" "+bullet+" "}return prefix}function getPrefixedItem(itemText){if(args.tag===undefined){args.tag=/^\s*\d/.test(itemText)?"ol":"ul"}itemText=itemText.replace(/^[ ]{0,3}([*+-]|\d+[.])\s/gm,function(_){return getItemPrefix()});return itemText}chunk.setTags(/(\n|^)*[ ]{0,3}([*+-]|\d+[.])\s+/,null);if(chunk.before&&!/\n$/.test(chunk.before)&&!/^\n/.test(chunk.startTag)){chunk.before=chunk.before+chunk.startTag;chunk.startTag=""}if(chunk.startTag){hasDigits=/\d+[.]/.test(chunk.startTag);chunk.startTag="";chunk.selection=chunk.selection.replace(/\n[ ]{4}/g,"\n");chunk.unwrap();chunk.addBlankLines();if(hasDigits){chunk.after=chunk.after.replace(nextItemsRegex,getPrefixedItem)}if(hasDigits&&args.tag==="ol"){finished=true}}if(!finished){nLinesBefore=1;chunk.before=chunk.before.replace(previousItemsRegex,function(itemText){if(/^\s*([*+-])/.test(itemText)){bullet=RegExp.$1}nLinesBefore=/[^\n]\n\n[^\n]/.test(itemText)?1:0;return getPrefixedItem(itemText)});if(!chunk.selection){chunk.selection=args.preventDefaultText?" ":Translator.listItem}prefix=getItemPrefix();nLinesAfter=1;chunk.after=chunk.after.replace(nextItemsRegex,function(itemText){nLinesAfter=/[^\n]\n\n[^\n]/.test(itemText)?1:0;return getPrefixedItem(itemText)});chunk.trimWhitespace(true);chunk.addBlankLines(nLinesBefore,nLinesAfter,true);chunk.startTag=prefix;spaces=prefix.replace(/./g," ");chunk.wrap(wmd.options.lineLength-spaces.length);chunk.selection=chunk.selection.replace(/\n/g,"\n"+spaces)}callback()},runStrongEm:function(wmd,chunk,callback,args){var starsBefore,starsAfter,prevStars,markup;callback=typeof callback==="function"?callback:function(){};extend({stars:2},args);chunk.trimWhitespace();chunk.selection=chunk.selection.replace(/\n{2,}/g,"\n");chunk.before.search(/(\**$)/);starsBefore=RegExp.$1;chunk.after.search(/(^\**)/);starsAfter=RegExp.$1;prevStars=Math.min(starsBefore.length,starsAfter.length);if((prevStars>=args.stars)&&(prevStars!==2||args.stars!==1)){chunk.before=chunk.before.replace(RegExp("[*]{"+args.stars+"}$",""),"");chunk.after=chunk.after.replace(RegExp("^[*]{"+args.stars+"}",""),"")}else{if(!chunk.selection&&starsAfter){chunk.after=chunk.after.replace(/^([*_]*)/,"");chunk.before=chunk.before.replace(/(\s?)$/,"");chunk.before=chunk.before+starsAfter+RegExp.$1}else{if(!chunk.selection&&!starsAfter){chunk.selection=args.text||""}markup=args.stars<=1?"*":"**";chunk.before=chunk.before+markup;chunk.after=markup+chunk.after}}callback()},runners:{a:function(wmd,chunk,callback,args){Command.runLinkImage(wmd,chunk,callback,extend({tag:"a",prompt:function(onComplete){LinkHelper.createDialog(Translator.insertLink,Translator.linkURL,onComplete)}},args))},blockquote:function(wmd,chunk,callback,args){args=args||{};callback=typeof callback==="function"?callback:function(){};chunk.selection=chunk.selection.replace(/^(\n*)([^\r]+?)(\n*)$/,function(totalMatch,newlinesBefore,text,newlinesAfter){chunk.before+=newlinesBefore;chunk.after=newlinesAfter+chunk.after;return text});chunk.before=chunk.before.replace(/(>[ \t]*)$/,function(totalMatch,blankLine){chunk.selection=blankLine+chunk.selection;return""});chunk.selection=chunk.selection.replace(/^(\s|>)+$/,"");chunk.selection=chunk.selection||(args.preventDefaultText?"":Translator.blockquote);if(chunk.before){chunk.before=chunk.before.replace(/\n?$/,"\n")}if(chunk.after){chunk.after=chunk.after.replace(/^\n?/,"\n")}chunk.before=chunk.before.replace(/(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*$)/,function(totalMatch){chunk.startTag=totalMatch;return""});chunk.after=chunk.after.replace(/^(((\n|^)(\n[ \t]*)*>(.+\n)*.*)+(\n[ \t]*)*)/,function(totalMatch){chunk.endTag=totalMatch;return""});function replaceBlanksInTags(useBracket){var replacement=useBracket?"> ":"";if(chunk.startTag){chunk.startTag=chunk.startTag.replace(/\n((>|\s)*)\n$/,function(totalMatch,markdown){return"\n"+markdown.replace(/^[ ]{0,3}>?[ \t]*$/gm,replacement)+"\n"})}if(chunk.endTag){chunk.endTag=chunk.endTag.replace(/^\n((>|\s)*)\n/,function(totalMatch,markdown){return"\n"+markdown.replace(/^[ ]{0,3}>?[ \t]*$/gm,replacement)+"\n"})}}if(/^(?![ ]{0,3}>)/m.test(chunk.selection)){chunk.wrap(wmd.options.lineLength-2);chunk.selection=chunk.selection.replace(/^/gm,"> ");replaceBlanksInTags(true);chunk.addBlankLines()}else{chunk.selection=chunk.selection.replace(/^[ ]{0,3}> ?/gm,"");chunk.unwrap();replaceBlanksInTags(false);if(!/^(\n|^)[ ]{0,3}>/.test(chunk.selection)&&chunk.startTag){chunk.startTag=chunk.startTag.replace(/\n{0,2}$/,"\n\n")}if(!/(\n|^)[ ]{0,3}>.*$/.test(chunk.selection)&&chunk.endTag){chunk.endTag=chunk.endTag.replace(/^\n{0,2}/,"\n\n")}}if(!/\n/.test(chunk.selection)){chunk.selection=chunk.selection.replace(/^(> *)/,function(wholeMatch,blanks){chunk.startTag=chunk.startTag+blanks;return""})}callback()},code:function(wmd,chunk,callback,args){args=args||{};callback=typeof callback==="function"?callback:function(){};var textBefore=/\S[ ]*$/.test(chunk.before),textAfter=/^[ ]*\S/.test(chunk.after),linesBefore=1,linesAfter=1;if(!(textBefore&&!textAfter)||/\n/.test(chunk.selection)){chunk.before=chunk.before.replace(/[ ]{4}$/,function(totalMatch){chunk.selection=totalMatch+chunk.selection;return""});if(/\n(\t|[ ]{4,}).*\n$/.test(chunk.before)||chunk.after===""||/^\n(\t|[ ]{4,})/.test(chunk.after)){linesBefore=0}chunk.addBlankLines(linesBefore,linesAfter);if(!chunk.selection){chunk.startTag="    ";chunk.selection=args.preventDefaultText?"":Translator.enterCodeHere}else{if(/^[ ]{0,3}\S/m.test(chunk.selection)){chunk.selection=chunk.selection.replace(/^/gm,"    ")}else{chunk.selection=chunk.selection.replace(/^[ ]{4}/gm,"")}}}else{chunk.trimWhitespace();chunk.setTags(/`/,/`/);if(!chunk.startTag&&!chunk.endTag){chunk.startTag=chunk.endTag="`";if(!chunk.selection){chunk.selection=args.preventDefaultText?"":Translator.enterCodeHere}}else{if(chunk.endTag&&!chunk.startTag){chunk.before=chunk.before+chunk.endTag;chunk.endTag=""}else{chunk.startTag=chunk.endTag=""}}}callback()},em:function(wmd,chunk,callback,args){Command.runStrongEm(wmd,chunk,callback,extend({stars:1,text:"emphasized text"},args))},h:function(wmd,chunk,callback,args){args=args||{};callback=typeof callback==="function"?callback:function(){};var headerLevel=0,headerLevelToCreate,headerChar,len;chunk.selection=chunk.selection.replace(/\s+/g," ");chunk.selection=chunk.selection.replace(/(^\s+|\s+$)/g,"");if(!chunk.selection){chunk.startTag="## ";chunk.selection="Heading";chunk.endTag=" ##"}else{chunk.setTags(/#+[ ]*/,/[ ]*#+/);if(/#+/.test(chunk.startTag)){headerLevel=RegExp.lastMatch.length}chunk.startTag=chunk.endTag="";chunk.setTags(null,/\s?(-+|=+)/);if(/=+/.test(chunk.endTag)){headerLevel=1}else{if(/-+/.test(chunk.endTag)){headerLevel=2}}chunk.startTag=chunk.endTag="";chunk.addBlankLines(1,1);headerLevelToCreate=headerLevel===0?2:headerLevel-1;if(headerLevelToCreate>0){headerChar=headerLevelToCreate>=2?"-":"=";len=chunk.selection.length;if(len>wmd.options.lineLength){len=wmd.options.lineLength}chunk.endTag="\n";while(len>0){chunk.endTag=chunk.endTag+headerChar;len=len-1}}}callback()},hr:function(wmd,chunk,callback,args){args=args||{};callback=typeof callback==="function"?callback:function(){};chunk.startTag="----------\n";chunk.selection="";chunk.addBlankLines(2,1,true);callback()},img:function(wmd,chunk,callback,args){Command.runLinkImage(wmd,chunk,callback,extend({tag:"img",prompt:function(onComplete){LinkHelper.createDialog(Translator.insertImage,Translator.imageURL,onComplete)}},args))},ol:function(wmd,chunk,callback,args){Command.runList(wmd,chunk,callback,extend({tag:"ol"},args))},strong:function(wmd,chunk,callback,args){Command.runStrongEm(wmd,chunk,callback,extend({stars:2,text:"strong text"},args))},ul:function(wmd,chunk,callback,args){Command.runList(wmd,chunk,callback,extend({tag:"ul"},args))}}});Command.builtIn={strong:{text:Translator.strongText,title:Translator.strongTitle,css:"wmd-strong",shortcut:"b"},em:{text:Translator.emText,title:Translator.emTitle,css:"wmd-em",shortcut:"i"},a:{text:Translator.aText,title:Translator.aTitle,css:"wmd-a",shortcut:"l"},blockquote:{text:Translator.blockquoteText,title:Translator.blockquoteTitle,css:"wmd-blockquote",shortcut:"q"},code:{text:Translator.codeText,title:Translator.codeTitle,css:"wmd-code",shortcut:"k"},img:{text:Translator.imgText,title:Translator.imgTitle,css:"wmd-img",shortcut:"g"},ol:{text:Translator.olText,title:Translator.olTitle,css:"wmd-ol",shortcut:"o"},ul:{text:Translator.ulText,title:Translator.ulTitle,css:"wmd-ul",shortcut:"u"},h:{text:Translator.hText,title:Translator.hTitle,css:"wmd-h",shortcut:"h"},hr:{text:Translator.hrText,title:Translator.hrTitle,css:"wmd-hr",shortcut:"r"},spacer:{css:"wmd-spacer",builder:Command.createSpacer}};Dialog=function(options){var obj,element,overlay,events=[],options=extend({zIndex:10,css:"wmd-dialog",overlayColor:"#FFFFFF",modal:true,closeOnEsc:true,insertion:null,onDestroy:null},options);function build(){if(!element){if(options.modal){overlay=new Overlay({color:options.overlayColor,zIndex:options.zIndex-1})}element=document.createElement("div");document.body.appendChild(element);element.className=options.css;element.style.position="absolute";element.style.zIndex=options.zIndex;element.style.top=(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop)+"px";if(options.insertion){obj.fill(options.insertion)}if(options.closeOnEsc){addEvent(document,"keypress",function(event){var ev=event||window.event,keyCode=ev.keyCode||ev.which;if(keyCode===27){obj.destroy()}},events)}}}obj=extend(obj,{destroy:function(){while(events.length>0){removeEvent(events[0].element,events[0].event,events[0].callback,events)}if(overlay){overlay.destroy();overlay=null}if(element){element.parentNode.removeChild(element);element=null}if(typeof options.onDestroy==="function"){options.onDestroy(this)}},fill:function(insertion){if(element){element.innerHTML="";insertion=insertion||"";if(typeof insertion==="string"){element.innerHTML=insertion}else{element.appendChild(insertion)}}},hide:function(){if(element){element.style.display="none"}},redraw:function(){var css;if(element){css=element.className;element.className="";element.className=css}},show:function(){if(element){element.style.display=""}}});build();return obj};Overlay=function(options){var obj={},events=[],element,iframe,options=extend({color:"#FFFFFF",zIndex:9,scroll:true,opacity:0.3},options);function update(){var scroll,size;if(element){scroll={left:window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,top:window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop};size=getViewportDimensions();element.style.width=size.width+"px";element.style.height=size.height+"px";element.style.left=scroll.left+"px";element.style.top=scroll.top+"px";if(iframe){iframe.style.width=size.width+"px";iframe.style.height=size.height+"px";iframe.style.left=scroll.left+"px";iframe.style.top=scroll.top+"px"}}}function build(){if(!element){element=document.createElement("div");document.body.appendChild(element);element.style.position="absolute";element.style.background=options.color;element.style.zIndex=options.zIndex;element.style.opacity=options.opacity;if(browser.IE){element.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+(options.opacity*100)+")";iframe=document.createElement("iframe");document.body.appendChild(iframe);iframe.frameBorder="0";iframe.scrolling="no";iframe.style.position="absolute";iframe.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0)";iframe.style.zIndex=options.zIndex-1}if(options.scroll){addEvent(window,"resize",update,events);addEvent(window,"load",update,events);addEvent(window,"scroll",update,events)}update()}}obj=extend(obj,{destroy:function(){while(events.length>0){removeEvent(events[0].element,events[0].event,events[0].callback,events)}if(element){element.parentNode.removeChild(element);element=null}if(iframe){iframe.parentNode.removeChild(iframe);iframe=null}}});build();return obj};Form=function(title,options){title=title||"";options=extend({css:"wmd-form",legendCss:"wmd-legend",errorCss:"wmd-error",requiredReason:"Required",dialogCss:"wmd-dialog",dialog:false,modal:true,dialogZIndex:10,closeOnEsc:true,id:"",onSubmit:null,onDestroy:null},options);var element,events=[],fields=[],fieldset,error,dialog;if(!options.id){options.id=randomString(6,{upper:false})}element=document.createElement("form");element.id=options.id;element.className=options.css;element.onsubmit=function(){if(typeof options.onSubmit==="function"){options.onSubmit(element)}return false};fieldset=document.createElement("fieldset");element.appendChild(fieldset);legend=document.createElement("div");legend.className=options.legendCss;legend.style.display="none";fieldset.appendChild(legend);error=document.createElement("div");error.className=options.errorCss;error.style.display="none";fieldset.appendChild(error);if(options.dialog){dialog=new Dialog({modal:options.modal,zIndex:options.dialogZIndex,css:options.dialogCss,closeOnEsc:false,insertion:element})}addEvent(document,"keypress",function(event){var e=event||window.event,keyCode=e.keyCode||e.which;switch(keyCode){case (27):if(options.closeOnEsc){element.destroy()}break;default:break}},events);function findField(key){var field=null,index=-1,i,n;for(i=0,n=fields.length;i<n;i++){if(fields[i].key===key){field=fields[i].value;index=i;break}}return{field:field,index:index}}function removeField(key){var newFields=[],i,n;for(i=0,n=fields.length;i<n;i++){if(fields[i].key!==key){newFields.push(fields[i])}}fields=newFields}extend(element,{addField:function(key,field){return this.insertField(-1,key,field)},destroy:function(){var i,n;if(typeof options.onDestroy==="function"){options.onDestroy(this)}while(events.length>0){removeEvent(events[0].element,events[0].event,events[0].callback,events)}for(i=0,n=fields.length;i<n;i++){if(fields[i].value){if(typeof fields[i].value.destroy==="function"){fields[i].value.destroy()}else{if(fields[i].value.parentNode){fields[i].value.parentNode.removeChild(fields[i].value)}}fields[i].value=null}}fields=[];element.parentNode.removeChild(element);element=null;if(dialog){dialog.destroy();dialog=null}return this},error:function(message){message=(message||"").toString();error.innerHTML=message;error.style.display=message?"":"none";if(dialog){dialog.redraw()}return this},fill:function(obj){var prop;if(obj){for(prop in obj){if(obj.hasOwnProperty(prop)){this.setValue(prop,obj[prop])}}}return this},focus:function(){var i,n;for(i=0,n=fields.length;i<n;i++){if(fields[i].value&&typeof fields[i].value.focus==="function"){fields[i].value.focus();break}}return this},getDialog:function(){return dialog},getField:function(key){var field=findField(key);return field?field.value:null},getValue:function(key,primitives){var field=findField(key);if(field&&field.value&&typeof field.value.getValue==="function"){return field.value.getValue(primitives)}else{return undefined}},insertField:function(index,key,field){this.removeField(key);if(index>=0&&fields.length>index){fields.splice(index,0,{key:key,value:field});fields[index+1].value.parentNode.insertBefore(field,fields[index+1].value)}else{fields.push({key:key,value:field});fieldset.appendChild(field)}if(dialog){dialog.redraw()}return this},removeField:function(key){var field=findField(key);if(field.value){if(typeof field.value.destroy==="function"){field.value.destroy()}else{if(field.value.parentNode){field.value.parentNode.removeChild(field.value)}}removeField(key)}if(dialog){dialog.redraw()}return this},serialize:function(ensureRequired,primitives){var hash={},missing=0,field,value,type,i,n;for(i=0,n=fields.length;i<n;i++){field=fields[i].value;value=field.getValue(primitives);type=field.getType();if(type!=="empty"&&type!=="submit"&&type!=="reset"&&type!=="button"){if(value!==""&&typeof value!=="undefined"&&value!==null&&value.length!==0){hash[fields[i].key]=value;field.error()}else{if(ensureRequired&&field.isRequired()&&field.isVisible()){missing=missing+1;field.error(true,options.requiredReason)}}}}if(dialog){dialog.redraw()}return missing===0?hash:null},setTitle:function(title){legend.innerHTML=title||"";legend.style.display=title?"":"none";return this},setValue:function(key,value){var field=findField(key);if(field&&field.value&&typeof field.value.setValue==="function"){field.value.setValue(value)}return this}});element.setTitle(title);return element};Field=function(label,type,options){label=label||"";type=type.toLowerCase();options=extend({required:false,inline:false,"float":false,items:null,itemsAlign:"left",css:"wmd-field",inputCss:"wmd-fieldinput",buttonCss:"wmd-fieldbutton",passwordCss:"wmd-fieldpassword",labelCss:"wmd-fieldlabel",inlineCss:"wmd-fieldinline",floatCss:"wmd-fieldfloat",errorCss:"wmd-fielderror",reasonCss:"wmd-fieldreason",hiddenCss:"wmd-hidden",value:"",group:"",id:"",insertion:null},options);var element,labelElement,inner,inputs,errorElement,events=[],setFor=false;if(indexOf(Field.TYPES,type)<0){throw ('"'+type+'" is not a valid field type.')}if(!options.id){options.id=randomString(6,{upper:false})}element=document.createElement("div");element.id=options.id;element.className=options.css;if(options.inline){addClassName(element,options.inlineCss)}if(options["float"]){addClassname(element,options.floatCss)}if(type==="hidden"){addClassName(element,options.hiddenCss)}if(label){labelElement=document.createElement("label");labelElement.className=options.labelCss;labelElement.innerHTML=label;if(options.required){labelElement.innerHTML+=" <em>*</em>"}element.appendChild(labelElement)}inner=document.createElement("div");if(options.inline){inner.className=options.inlineCss}element.appendChild(inner);errorElement=document.createElement("div");errorElement.className=options.reasonCss;errorElement.style.display="none";element.appendChild(errorElement);switch(type){case ("empty"):break;case ("checkbox"):case ("radio"):inputs=Field.createInputList(inner,type,options);break;case ("select"):inputs=Field.createSelectList(inner,type,options);setFor=true;break;case ("textarea"):inputs=Field.createTextArea(inner,type,options);setFor=true;break;default:inputs=Field.createInput(inner,type,options);setFor=true;break}if(typeof inputs==="undefined"){inputs=null}if(labelElement&&setFor){labelElement.setAttribute("for",Field.getInputId(options))}extend(element,{addEvent:function(event,callback){var c=function(){callback(element)},input,i,n;if(inputs){switch(type){case ("empty"):break;case ("checkbox"):case ("radio"):for(i=0,n=inputs.length;i<n;i++){addEvent(inputs[i],event,c,events)}break;default:addEvent(inputs,event,c,events);break}}return this},destroy:function(){while(events.length>0){removeEvent(events[0].element,events[0].action,events[0].callback,events)}element.parentNode.removeChild(element);return this},error:function(show,message){if(show){addClassName(element,options.errorCss);if(message){errorElement.innerHTML=message.toString();errorElement.style.display=""}else{errorElement.innerHTML="";errorElement.style.display="none"}}else{removeClassName(element,options.errorCss);errorElement.style.display="none"}return this},focus:function(){if(this.isVisible()){if(inputs){if(inputs.length>0&&(type==="checkbox"||type==="radio")){inputs[0].focus()}else{inputs.focus()}}}return this},hide:function(){element.style.display="none"},insert:function(insertion){insertion=insertion||"";var div,i,n;if(typeof insertion==="string"){div=document.createElement("div");div.innerHTML=insertion;for(i=0,n=div.childNodes.length;i<n;i++){inner.appendChild(div.childNodes[i])}}else{inner.appendChild(insertion)}return this},isRequired:function(){return !!(options.required)},isVisible:function(){return !(element.style.display)},getLabel:function(){return label||""},getType:function(){return type},getValue:function(primitives){var value,i,n;function primitive(val){var bools,numbers,num;if(primitives){bools=/^(true)|(false)$/i.exec(val);if(bools){val=(typeof bools[2]==="undefined"||bools[2]==="")?true:false}else{numbers=/^\d*(\.?\d+)?$/.exec(val);if(numbers&&numbers.length>0){num=(typeof numbers[1]==="undefined"||numbers[1]==="")?parseInt(val,10):parseFloat(val,10);if(!isNaN(num)){val=num}}}}return val}if(inputs){switch(type){case ("empty"):break;case ("checkbox"):value=[];for(i=0,n=inputs.length;i<n;i++){if(inputs[i].checked){value.push(primitive(inputs[i].value))}}break;case ("radio"):value="";for(i=0,n=inputs.length;i<n;i++){if(inputs[i].checked){value=primitive(inputs[i].value);break}}break;case ("select"):value=primitive(inputs.options[input.selectedIndex].value);break;default:value=inputs.value;break}}return value},setValue:function(value){var input,i,n,j,m,selectedIndex;function li(s){return(s||"").toString()===(input?input.value:"")}if(inputs){switch(type){case ("empty"):break;case ("checkbox"):if(typeof value==="number"){value=getArrayFromEnum(value)}else{if(typeof value==="string"){value=[value]}}if(value.length){for(i=0,n=inputs.length;i<n;i++){input=inputs[i];input.checked="";for(j=0,m=value.length;j<m;j++){if(li(value[j])){input.checked="checked";break}}}}break;case ("radio"):value=(value||"").toString();for(i=0,n=inputs.length;i<n;i++){inputs[i].checked="";if(inputs[i].value===value){inputs[i].checked="checked"}}break;case ("select"):value=(value||"").toString();selectedIndex=0;for(i=0,n=inputs.options.length;i<n;i++){if(inputs.options[i].value===value){selectedIndex=i;break}}inputs.selectedIndex=selectedIndex;break;default:value=(value||"").toString();inputs.value=value;break}}return this},show:function(){element.style.display=""}});if(options.insertion){element.insert(options.insertion)}return element};extend(Field,{TYPES:["button","checkbox","empty","file","hidden","image","password","radio","reset","submit","text","select","textarea"],createInput:function(parent,type,options){var id=Field.getInputId(options),css=type==="button"||type==="submit"||type==="reset"?options.buttonCss:options.inputCss,input=document.createElement("input");input.id=id;input.name=id;input.className=css;input.type=type;if(type==="password"&&options.passwordCss){addClassName(input,options.passwordCss)}input.value=(options.value||"").toString();parent.appendChild(input);return input},createInputList:function(parent,type,options){var i,n,id,span,label,name,input,inputs=[];if(options.items&&options.items.length){for(i=0,n=options.items.length;i<n;i++){id=Field.getInputId(options)+"_"+i;span=document.createElement("span");span.className=options.inputCss;label=document.createElement("label");label["for"]=id;label.innerHTML=options.items[i].text;name=options.group?options.group:id;input=document.createElement("input");input.id=id;input.type=type;input.name=name;if(options.items[i].selected){input.checked="checked"}if(options.items[i].value){input.value=options.items[i].value.toString()}if(options.itemsAlign==="right"){span.appendChild(input);span.appendChild(document.createTextNode("&nbsp;"));span.appendChild(label)}else{span.appendChild(label);span.appendChild(document.createTextNode("&nbsp;"));span.appendChild(input)}parent.appendChild(span);inputs.push(input)}}return inputs},createSelectList:function(parent,type,options){var i,n,id=Field.getInputId(options),select,index;select=document.createElement("select");select.id=id;select.name=id;select.className=options.inputCss;parent.appendChild(select);if(options.items&&options.items.length){index=-1;for(i=0,n=options.items.length;i<n;i++){select.options[i]=new Option(options.items[i].text,options.items[i].value);if(options[i].selected){index=i}}if(index>-1){select.selectedIndex=index}}return select},createTextArea:function(parent,type,options){var id=Field.getInputId(options),input=document.createElement("textarea");input.id=id;input.name=id;input.className=options.inputCss;input.value=(options.value||"").toString();parent.appendChild(input);return input},getArrayFromEnum:function(value,map){var array=[],i=1,parsed;if(typeof value==="string"){parsed=parseInt(value,10);value=!isNaN(parse)?parsed:0}while(i<=value){if((i&value)===i){if(map){array.push(map[i.toString()])}else{array.push(i)}}i=i*2}return array},getEnumFromArray:function(array){var value=0,indexValue,i,n;for(i=0,n=array.length;i<n;i++){indexValue=array[i];if(typeof indexValue==="string"){indexValue=parseInt(indexValue,10);if(isNaN(indexValue)){indexValue=undefined}}if(typeof indexValue==="number"){value=value|indexValue}}return value},getInputId:function(options){return options.id+"_input"}});LinkHelper={add:function(chunk,linkDef){var refNumber=0,defsToAdd={},defs="",regex=/(\[(?:\[[^\]]*\]|[^\[\]])*\][ ]?(?:\n[ ]*)?\[)(\d+)(\])/g;function addDefNumber(def){refNumber=refNumber+1;def=def.replace(/^[ ]{0,3}\[(\d+)\]:/,"  ["+refNumber+"]:");defs+="\n"+def}function getLink(totalMatch,link,id,end){var result="";if(defsToAdd[id]){addDefNumber(defsToAdd[id]);result=link+refNumber+end}else{result=totalMatch}return result}chunk.before=LinkHelper.strip(chunk.before,defsToAdd);chunk.selection=LinkHelper.strip(chunk.selection,defsToAdd);chunk.after=LinkHelper.strip(chunk.after,defsToAdd);chunk.before=chunk.before.replace(regex,getLink);if(linkDef){addDefNumber(linkDef)}else{chunk.selection=chunk.selection.replace(regex,getLink)}chunk.after=chunk.after.replace(regex,getLink);if(chunk.after){chunk.after=chunk.after.replace(/\n*$/,"")}if(!chunk.after){chunk.selection=chunk.selection.replace(/\n*$/,"")}chunk.after=chunk.after+"\n\n"+defs;return refNumber},createDialog:function(formTitle,fieldLabel,callback){var form,urlField,submitted=false;callback=typeof callback==="function"?callback:function(){};form=Command.createSubmitCancelForm(formTitle,function(){var values=form.serialize(true);if(values){submitted=true;form.destroy();callback(values.url)}},function(){if(!submitted){callback("")}});urlField=new Field(fieldLabel,"text",{required:true,value:"http://",insertion:Translator.urlFieldInsertion});form.insertField(0,"url",urlField);urlField.focus()},strip:function(text,defsToAdd){var expr=/^[ ]{0,3}\[(\d+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm;text=text.replace(expr,function(totalMatch,id,link,newLines,title){var result="";defsToAdd[id]=totalMatch.replace(/\s*$/,"");if(newLines){defsToAdd[id]=totalMatch.replace(/["(](.+?)[")]$/,"");result=newLines+title}return result});return text}};window.WMD=WMD;window.WMD.Command=Command;window.WMD.Form=Form;window.WMD.Field=Field})();function selectAll(){selectElementText(document.getElementById("preview"))}function copyAll(){alert("Not implemented yet!")}function selectElementText(el,win){win=win||window;var doc=win.document,sel,range;if(win.getSelection&&doc.createRange){sel=win.getSelection();range=doc.createRange();range.selectNodeContents(el);sel.removeAllRanges();sel.addRange(range)}else{if(doc.body.createTextRange){range=doc.body.createTextRange();range.moveToElementText(el);range.select();range.execCommand("Copy")}}}$(document).ready(function(){$(".wmd-input").bind("keydown",function(e){var TABKEY=9;if(e.keyCode==TABKEY){this.value+="    ";if(e.preventDefault){e.preventDefault()}return false}})});function toHtml(){OpenWindow=window.open("","newwin","height=842, width=750,toolbar=no,scrollbars=yes,menubar=no");var target=document.getElementById("preview");var wrap=document.createElement("body");wrap.appendChild(target.cloneNode(true));OpenWindow.document.write('<html>  <head>    <title>online markdown editor</title>    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />        <!-- Styles -->    <link href="css/print_style.css" rel="stylesheet"></link>    </head>');OpenWindow.document.write(wrap.innerHTML);OpenWindow.document.close()}
/*! inline-attach - v1.3.0 - 2013-10-25 */
(function(e,n){function t(){for(var e={},n=arguments.length-1;n>=0;n--){var t=arguments[n];for(var a in t){e[a]=t[a]}}return e}n.inlineAttach=function(e,a){function i(e,n){return(e+"\n\n[[D]]"+n).replace(/(\n{2,})\[\[D\]\]/,"\n\n").replace(/^(\n*)/,"")}var o,r=t(e,inlineAttach.defaults),l=a,u="{filename}",d=this;this.uploadFile=function(e){var n=new FormData,t=new XMLHttpRequest,a="png";if(e.name){var i=e.name.match(/\.(.+)$/);i&&(a=i[1])}var org_filename=e.name.substr(0,e.name.lastIndexOf("."))||e.name;n.append(r.uploadFieldName,e,org_filename+"."+a),t.open("POST",r.uploadUrl),t.onload=function(){if(200===t.status||201===t.status){var e=JSON.parse(t.responseText);d.onUploadedFile(e)}else{d.onErrorUploading()}},t.send(n)},this.isAllowedFile=function(e){return r.allowedTypes.indexOf(e.type)>=0},this.onUploadedFile=function(e){var n=r.onUploadedFile(e),t=e[r.downloadFieldName];if(n!==!1&&t){var a=l.getValue().replace(o,r.urlText.replace(u,t));l.setValue(a)}},this.customUploadHandler=function(e){return r.customUploadHandler(e)},this.onErrorUploading=function(){var e=l.getValue().replace(o,"");l.setValue(e),r.customErrorHandler()&&n.alert(r.errorText)},this.onReceivedFile=function(e){var n=r.onReceivedFile(e);n!==!1&&(o=r.progressText,l.setValue(i(l.getValue(),o)))},this.onPaste=function(e){var n=!1,t=e.clipboardData;if("object"==typeof t&&null!==t.items){for(var a=0;t.items.length>a;a++){var i=t.items[a];d.isAllowedFile(i)&&(n=!0,this.onReceivedFile(i.getAsFile()),this.customUploadHandler(i.getAsFile())&&this.uploadFile(i.getAsFile()))}}return n},this.onDrop=function(e){for(var n=!1,t=0;e.dataTransfer.files.length>t;t++){var a=e.dataTransfer.files[t];d.isAllowedFile(a)&&(n=!0,this.onReceivedFile(a),this.customUploadHandler(a)&&this.uploadFile(a))}return n}},n.inlineAttach.Editor=function(e){var n=e;return{getValue:function(){return n.value},setValue:function(e){n.value=e}}},n.inlineAttach.defaults={uploadUrl:"upload_attachment.php",uploadFieldName:"file",downloadFieldName:"filename",allowedTypes:["image/jpeg","image/png","image/jpg","image/gif"],progressText:"![Uploading file...]()",urlText:"![file]({filename})",onReceivedFile:function(){},customUploadHandler:function(){return !0},customErrorHandler:function(){return !0},errorText:"Error uploading file",onUploadedFile:function(){}},n.inlineAttach.attachToInput=function(e,n){n=n||{};var t=new inlineAttach.Editor(e),a=new inlineAttach(n,t);e.addEventListener("paste",function(e){a.onPaste(e)},!1),e.addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault(),a.onDrop(e)},!1),e.addEventListener("dragenter",function(e){e.stopPropagation(),e.preventDefault()},!1),e.addEventListener("dragover",function(e){e.stopPropagation(),e.preventDefault()},!1)}})(document,window),function(e,n,t){function a(e){var n=t(e);return{getValue:function(){return n.val()},setValue:function(e){n.val(e)}}}a.prototype=new inlineAttach.Editor,t.fn.inlineattach=function(e){var n=t(this);return n.each(function(){var n=t(this),i=new a(n),o=new inlineAttach(e,i);n.bind({paste:function(e){o.onPaste(e.originalEvent)},drop:function(e){e.stopPropagation(),e.preventDefault(),o.onDrop(e.originalEvent)},"dragenter dragover":function(e){e.stopPropagation(),e.preventDefault()}})}),this}}(document,window,jQuery);(function(){var n=this,t=n._,r={},e=Array.prototype,u=Object.prototype,i=Function.prototype,a=e.push,o=e.slice,c=e.concat,l=u.toString,f=u.hasOwnProperty,s=e.forEach,p=e.map,h=e.reduce,v=e.reduceRight,g=e.filter,d=e.every,m=e.some,y=e.indexOf,b=e.lastIndexOf,x=Array.isArray,w=Object.keys,_=i.bind,j=function(n){return n instanceof j?n:this instanceof j?(this._wrapped=n,void 0):new j(n)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=j),exports._=j):n._=j,j.VERSION="1.5.2";var A=j.each=j.forEach=function(n,t,e){if(null!=n){if(s&&n.forEach===s){n.forEach(t,e)}else{if(n.length===+n.length){for(var u=0,i=n.length;i>u;u++){if(t.call(e,n[u],u,n)===r){return}}}else{for(var a=j.keys(n),u=0,i=a.length;i>u;u++){if(t.call(e,n[a[u]],a[u],n)===r){return}}}}}};j.map=j.collect=function(n,t,r){var e=[];return null==n?e:p&&n.map===p?n.map(t,r):(A(n,function(n,u,i){e.push(t.call(r,n,u,i))}),e)};var E="Reduce of empty array with no initial value";j.reduce=j.foldl=j.inject=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),h&&n.reduce===h){return e&&(t=j.bind(t,e)),u?n.reduce(t,r):n.reduce(t)}if(A(n,function(n,i,a){u?r=t.call(e,r,n,i,a):(r=n,u=!0)}),!u){throw new TypeError(E)}return r},j.reduceRight=j.foldr=function(n,t,r,e){var u=arguments.length>2;if(null==n&&(n=[]),v&&n.reduceRight===v){return e&&(t=j.bind(t,e)),u?n.reduceRight(t,r):n.reduceRight(t)}var i=n.length;if(i!==+i){var a=j.keys(n);i=a.length}if(A(n,function(o,c,l){c=a?a[--i]:--i,u?r=t.call(e,r,n[c],c,l):(r=n[c],u=!0)}),!u){throw new TypeError(E)}return r},j.find=j.detect=function(n,t,r){var e;return O(n,function(n,u,i){return t.call(r,n,u,i)?(e=n,!0):void 0}),e},j.filter=j.select=function(n,t,r){var e=[];return null==n?e:g&&n.filter===g?n.filter(t,r):(A(n,function(n,u,i){t.call(r,n,u,i)&&e.push(n)}),e)},j.reject=function(n,t,r){return j.filter(n,function(n,e,u){return !t.call(r,n,e,u)},r)},j.every=j.all=function(n,t,e){t||(t=j.identity);var u=!0;return null==n?u:d&&n.every===d?n.every(t,e):(A(n,function(n,i,a){return(u=u&&t.call(e,n,i,a))?void 0:r}),!!u)};var O=j.some=j.any=function(n,t,e){t||(t=j.identity);var u=!1;return null==n?u:m&&n.some===m?n.some(t,e):(A(n,function(n,i,a){return u||(u=t.call(e,n,i,a))?r:void 0}),!!u)};j.contains=j.include=function(n,t){return null==n?!1:y&&n.indexOf===y?n.indexOf(t)!=-1:O(n,function(n){return n===t})},j.invoke=function(n,t){var r=o.call(arguments,2),e=j.isFunction(t);return j.map(n,function(n){return(e?t:n[t]).apply(n,r)})},j.pluck=function(n,t){return j.map(n,function(n){return n[t]})},j.where=function(n,t,r){return j.isEmpty(t)?r?void 0:[]:j[r?"find":"filter"](n,function(n){for(var r in t){if(t[r]!==n[r]){return !1}}return !0})},j.findWhere=function(n,t){return j.where(n,t,!0)},j.max=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535){return Math.max.apply(Math,n)}if(!t&&j.isEmpty(n)){return -1/0}var e={computed:-1/0,value:-1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a>e.computed&&(e={value:n,computed:a})}),e.value},j.min=function(n,t,r){if(!t&&j.isArray(n)&&n[0]===+n[0]&&n.length<65535){return Math.min.apply(Math,n)}if(!t&&j.isEmpty(n)){return 1/0}var e={computed:1/0,value:1/0};return A(n,function(n,u,i){var a=t?t.call(r,n,u,i):n;a<e.computed&&(e={value:n,computed:a})}),e.value},j.shuffle=function(n){var t,r=0,e=[];return A(n,function(n){t=j.random(r++),e[r-1]=e[t],e[t]=n}),e},j.sample=function(n,t,r){return arguments.length<2||r?n[j.random(n.length-1)]:j.shuffle(n).slice(0,Math.max(0,t))};var k=function(n){return j.isFunction(n)?n:function(t){return t[n]}};j.sortBy=function(n,t,r){var e=k(t);return j.pluck(j.map(n,function(n,t,u){return{value:n,index:t,criteria:e.call(r,n,t,u)}}).sort(function(n,t){var r=n.criteria,e=t.criteria;if(r!==e){if(r>e||r===void 0){return 1}if(e>r||e===void 0){return -1}}return n.index-t.index}),"value")};var F=function(n){return function(t,r,e){var u={},i=null==r?j.identity:k(r);return A(t,function(r,a){var o=i.call(e,r,a,t);n(u,o,r)}),u}};j.groupBy=F(function(n,t,r){(j.has(n,t)?n[t]:n[t]=[]).push(r)}),j.indexBy=F(function(n,t,r){n[t]=r}),j.countBy=F(function(n,t){j.has(n,t)?n[t]++:n[t]=1}),j.sortedIndex=function(n,t,r,e){r=null==r?j.identity:k(r);for(var u=r.call(e,t),i=0,a=n.length;a>i;){var o=i+a>>>1;r.call(e,n[o])<u?i=o+1:a=o}return i},j.toArray=function(n){return n?j.isArray(n)?o.call(n):n.length===+n.length?j.map(n,j.identity):j.values(n):[]},j.size=function(n){return null==n?0:n.length===+n.length?n.length:j.keys(n).length},j.first=j.head=j.take=function(n,t,r){return null==n?void 0:null==t||r?n[0]:o.call(n,0,t)},j.initial=function(n,t,r){return o.call(n,0,n.length-(null==t||r?1:t))},j.last=function(n,t,r){return null==n?void 0:null==t||r?n[n.length-1]:o.call(n,Math.max(n.length-t,0))},j.rest=j.tail=j.drop=function(n,t,r){return o.call(n,null==t||r?1:t)},j.compact=function(n){return j.filter(n,j.identity)};var M=function(n,t,r){return t&&j.every(n,j.isArray)?c.apply(r,n):(A(n,function(n){j.isArray(n)||j.isArguments(n)?t?a.apply(r,n):M(n,t,r):r.push(n)}),r)};j.flatten=function(n,t){return M(n,t,[])},j.without=function(n){return j.difference(n,o.call(arguments,1))},j.uniq=j.unique=function(n,t,r,e){j.isFunction(t)&&(e=r,r=t,t=!1);var u=r?j.map(n,r,e):n,i=[],a=[];return A(u,function(r,e){(t?e&&a[a.length-1]===r:j.contains(a,r))||(a.push(r),i.push(n[e]))}),i},j.union=function(){return j.uniq(j.flatten(arguments,!0))},j.intersection=function(n){var t=o.call(arguments,1);return j.filter(j.uniq(n),function(n){return j.every(t,function(t){return j.indexOf(t,n)>=0})})},j.difference=function(n){var t=c.apply(e,o.call(arguments,1));return j.filter(n,function(n){return !j.contains(t,n)})},j.zip=function(){for(var n=j.max(j.pluck(arguments,"length").concat(0)),t=new Array(n),r=0;n>r;r++){t[r]=j.pluck(arguments,""+r)}return t},j.object=function(n,t){if(null==n){return{}}for(var r={},e=0,u=n.length;u>e;e++){t?r[n[e]]=t[e]:r[n[e][0]]=n[e][1]}return r},j.indexOf=function(n,t,r){if(null==n){return -1}var e=0,u=n.length;if(r){if("number"!=typeof r){return e=j.sortedIndex(n,t),n[e]===t?e:-1}e=0>r?Math.max(0,u+r):r}if(y&&n.indexOf===y){return n.indexOf(t,r)}for(;u>e;e++){if(n[e]===t){return e}}return -1},j.lastIndexOf=function(n,t,r){if(null==n){return -1}var e=null!=r;if(b&&n.lastIndexOf===b){return e?n.lastIndexOf(t,r):n.lastIndexOf(t)}for(var u=e?r:n.length;u--;){if(n[u]===t){return u}}return -1},j.range=function(n,t,r){arguments.length<=1&&(t=n||0,n=0),r=arguments[2]||1;for(var e=Math.max(Math.ceil((t-n)/r),0),u=0,i=new Array(e);e>u;){i[u++]=n,n+=r}return i};var R=function(){};j.bind=function(n,t){var r,e;if(_&&n.bind===_){return _.apply(n,o.call(arguments,1))}if(!j.isFunction(n)){throw new TypeError}return r=o.call(arguments,2),e=function(){if(!(this instanceof e)){return n.apply(t,r.concat(o.call(arguments)))}R.prototype=n.prototype;var u=new R;R.prototype=null;var i=n.apply(u,r.concat(o.call(arguments)));return Object(i)===i?i:u}},j.partial=function(n){var t=o.call(arguments,1);return function(){return n.apply(this,t.concat(o.call(arguments)))}},j.bindAll=function(n){var t=o.call(arguments,1);if(0===t.length){throw new Error("bindAll must be passed function names")}return A(t,function(t){n[t]=j.bind(n[t],n)}),n},j.memoize=function(n,t){var r={};return t||(t=j.identity),function(){var e=t.apply(this,arguments);return j.has(r,e)?r[e]:r[e]=n.apply(this,arguments)}},j.delay=function(n,t){var r=o.call(arguments,2);return setTimeout(function(){return n.apply(null,r)},t)},j.defer=function(n){return j.delay.apply(j,[n,1].concat(o.call(arguments,1)))},j.throttle=function(n,t,r){var e,u,i,a=null,o=0;r||(r={});var c=function(){o=r.leading===!1?0:new Date,a=null,i=n.apply(e,u)};return function(){var l=new Date;o||r.leading!==!1||(o=l);var f=t-(l-o);return e=this,u=arguments,0>=f?(clearTimeout(a),a=null,o=l,i=n.apply(e,u)):a||r.trailing===!1||(a=setTimeout(c,f)),i}},j.debounce=function(n,t,r){var e,u,i,a,o;return function(){i=this,u=arguments,a=new Date;var c=function(){var l=new Date-a;t>l?e=setTimeout(c,t-l):(e=null,r||(o=n.apply(i,u)))},l=r&&!e;return e||(e=setTimeout(c,t)),l&&(o=n.apply(i,u)),o}},j.once=function(n){var t,r=!1;return function(){return r?t:(r=!0,t=n.apply(this,arguments),n=null,t)}},j.wrap=function(n,t){return function(){var r=[n];return a.apply(r,arguments),t.apply(this,r)}},j.compose=function(){var n=arguments;return function(){for(var t=arguments,r=n.length-1;r>=0;r--){t=[n[r].apply(this,t)]}return t[0]}},j.after=function(n,t){return function(){return --n<1?t.apply(this,arguments):void 0}},j.keys=w||function(n){if(n!==Object(n)){throw new TypeError("Invalid object")}var t=[];for(var r in n){j.has(n,r)&&t.push(r)}return t},j.values=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++){e[u]=n[t[u]]}return e},j.pairs=function(n){for(var t=j.keys(n),r=t.length,e=new Array(r),u=0;r>u;u++){e[u]=[t[u],n[t[u]]]}return e},j.invert=function(n){for(var t={},r=j.keys(n),e=0,u=r.length;u>e;e++){t[n[r[e]]]=r[e]}return t},j.functions=j.methods=function(n){var t=[];for(var r in n){j.isFunction(n[r])&&t.push(r)}return t.sort()},j.extend=function(n){return A(o.call(arguments,1),function(t){if(t){for(var r in t){n[r]=t[r]}}}),n},j.pick=function(n){var t={},r=c.apply(e,o.call(arguments,1));return A(r,function(r){r in n&&(t[r]=n[r])}),t},j.omit=function(n){var t={},r=c.apply(e,o.call(arguments,1));for(var u in n){j.contains(r,u)||(t[u]=n[u])}return t},j.defaults=function(n){return A(o.call(arguments,1),function(t){if(t){for(var r in t){n[r]===void 0&&(n[r]=t[r])}}}),n},j.clone=function(n){return j.isObject(n)?j.isArray(n)?n.slice():j.extend({},n):n},j.tap=function(n,t){return t(n),n};var S=function(n,t,r,e){if(n===t){return 0!==n||1/n==1/t}if(null==n||null==t){return n===t}n instanceof j&&(n=n._wrapped),t instanceof j&&(t=t._wrapped);var u=l.call(n);if(u!=l.call(t)){return !1}switch(u){case"[object String]":return n==String(t);case"[object Number]":return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case"[object Date]":case"[object Boolean]":return +n==+t;case"[object RegExp]":return n.source==t.source&&n.global==t.global&&n.multiline==t.multiline&&n.ignoreCase==t.ignoreCase}if("object"!=typeof n||"object"!=typeof t){return !1}for(var i=r.length;i--;){if(r[i]==n){return e[i]==t}}var a=n.constructor,o=t.constructor;if(a!==o&&!(j.isFunction(a)&&a instanceof a&&j.isFunction(o)&&o instanceof o)){return !1}r.push(n),e.push(t);var c=0,f=!0;if("[object Array]"==u){if(c=n.length,f=c==t.length){for(;c--&&(f=S(n[c],t[c],r,e));){}}}else{for(var s in n){if(j.has(n,s)&&(c++,!(f=j.has(t,s)&&S(n[s],t[s],r,e)))){break}}if(f){for(s in t){if(j.has(t,s)&&!c--){break}}f=!c}}return r.pop(),e.pop(),f};j.isEqual=function(n,t){return S(n,t,[],[])},j.isEmpty=function(n){if(null==n){return !0}if(j.isArray(n)||j.isString(n)){return 0===n.length}for(var t in n){if(j.has(n,t)){return !1}}return !0},j.isElement=function(n){return !(!n||1!==n.nodeType)},j.isArray=x||function(n){return"[object Array]"==l.call(n)},j.isObject=function(n){return n===Object(n)},A(["Arguments","Function","String","Number","Date","RegExp"],function(n){j["is"+n]=function(t){return l.call(t)=="[object "+n+"]"}}),j.isArguments(arguments)||(j.isArguments=function(n){return !(!n||!j.has(n,"callee"))}),"function"!=typeof/./&&(j.isFunction=function(n){return"function"==typeof n}),j.isFinite=function(n){return isFinite(n)&&!isNaN(parseFloat(n))},j.isNaN=function(n){return j.isNumber(n)&&n!=+n},j.isBoolean=function(n){return n===!0||n===!1||"[object Boolean]"==l.call(n)},j.isNull=function(n){return null===n},j.isUndefined=function(n){return n===void 0},j.has=function(n,t){return f.call(n,t)},j.noConflict=function(){return n._=t,this},j.identity=function(n){return n},j.times=function(n,t,r){for(var e=Array(Math.max(0,n)),u=0;n>u;u++){e[u]=t.call(r,u)}return e},j.random=function(n,t){return null==t&&(t=n,n=0),n+Math.floor(Math.random()*(t-n+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};I.unescape=j.invert(I.escape);var T={escape:new RegExp("["+j.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+j.keys(I.unescape).join("|")+")","g")};j.each(["escape","unescape"],function(n){j[n]=function(t){return null==t?"":(""+t).replace(T[n],function(t){return I[n][t]})}}),j.result=function(n,t){if(null==n){return void 0}var r=n[t];return j.isFunction(r)?r.call(n):r},j.mixin=function(n){A(j.functions(n),function(t){var r=j[t]=n[t];j.prototype[t]=function(){var n=[this._wrapped];return a.apply(n,arguments),z.call(this,r.apply(j,n))}})};var N=0;j.uniqueId=function(n){var t=++N+"";return n?n+t:t},j.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var q=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n"," ":"t","\u2028":"u2028","\u2029":"u2029"},D=/\\|'|\r|\n|\t|\u2028|\u2029/g;j.template=function(n,t,r){var e;r=j.defaults({},r,j.templateSettings);var u=new RegExp([(r.escape||q).source,(r.interpolate||q).source,(r.evaluate||q).source].join("|")+"|$","g"),i=0,a="__p+='";n.replace(u,function(t,r,e,u,o){return a+=n.slice(i,o).replace(D,function(n){return"\\"+B[n]}),r&&(a+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),e&&(a+="'+\n((__t=("+e+"))==null?'':__t)+\n'"),u&&(a+="';\n"+u+"\n__p+='"),i=o+t.length,t}),a+="';\n",r.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{e=new Function(r.variable||"obj","_",a)}catch(o){throw o.source=a,o}if(t){return e(t,j)}var c=function(n){return e.call(this,n,j)};return c.source="function("+(r.variable||"obj")+"){\n"+a+"}",c},j.chain=function(n){return j(n).chain()};var z=function(n){return this._chain?j(n).chain():n};j.mixin(j),A(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=e[n];j.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!=n&&"splice"!=n||0!==r.length||delete r[0],z.call(this,r)}}),A(["concat","join","slice"],function(n){var t=e[n];j.prototype[n]=function(){return z.call(this,t.apply(this._wrapped,arguments))}}),j.extend(j.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);
/*!
 * Globalize
 *
 * http://github.com/jquery/globalize
 *
 * Copyright Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z;c=function(a){return new c.prototype.init(a)},typeof require!="undefined"&&typeof exports!="undefined"&&typeof module!="undefined"?module.exports=c:a.Globalize=c,c.cultures={},c.prototype={constructor:c,init:function(a){this.cultures=c.cultures,this.cultureSelector=a;return this}},c.prototype.init.prototype=c.prototype,c.cultures["default"]={name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",NaN:"NaN",negativeInfinity:"-Infinity",positiveInfinity:"Infinity",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}},messages:{}},c.cultures["default"].calendar=c.cultures["default"].calendars.standard,c.cultures.en=c.cultures["default"],c.cultureSelector="en",d=/^0x[a-f0-9]+$/i,e=/^[+\-]?infinity$/i,f=/^[+\-]?\d*\.?\d*(e[+\-]?\d+)?$/,g=/^\s+|\s+$/g,h=function(a,b){if(a.indexOf){return a.indexOf(b)}for(var c=0,d=a.length;c<d;c++){if(a[c]===b){return c}}return -1},i=function(a,b){return a.substr(a.length-b.length)===b},j=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,n=arguments.length,o=!1;typeof h=="boolean"&&(o=h,h=arguments[1]||{},i=2),typeof h!="object"&&!l(h)&&(h={});for(;i<n;i++){if((a=arguments[i])!=null){for(c in a){d=h[c],e=a[c];if(h===e){continue}o&&e&&(m(e)||(f=k(e)))?(f?(f=!1,g=d&&k(d)?d:[]):g=d&&m(d)?d:{},h[c]=j(o,g,e)):e!==b&&(h[c]=e)}}}return h},k=Array.isArray||function(a){return Object.prototype.toString.call(a)==="[object Array]"},l=function(a){return Object.prototype.toString.call(a)==="[object Function]"},m=function(a){return Object.prototype.toString.call(a)==="[object Object]"},n=function(a,b){return a.indexOf(b)===0},o=function(a){return(a+"").replace(g,"")},p=function(a){return isNaN(a)?NaN:Math[a<0?"ceil":"floor"](a)},q=function(a,b,c){var d;for(d=a.length;d<b;d+=1){a=c?"0"+a:a+"0"}return a},r=function(a,b){var c=0,d=!1;for(var e=0,f=a.length;e<f;e++){var g=a.charAt(e);switch(g){case"'":d?b.push("'"):c++,d=!1;break;case"\\":d&&b.push("\\"),d=!d;break;default:b.push(g),d=!1}}return c},s=function(a,b){b=b||"F";var c,d=a.patterns,e=b.length;if(e===1){c=d[b];if(!c){throw"Invalid date format string '"+b+"'."}b=c}else{e===2&&b.charAt(0)==="%"&&(b=b.charAt(1))}return b},t=function(a,b,c){function A(a,b){if(u){return u[b]}switch(b){case 0:return a.getFullYear();case 1:return a.getMonth();case 2:return a.getDate();default:throw"Invalid part value "+b}}function z(){if(m||n){return m}m=o.test(b),n=!0;return m}function y(a,b){var c,d=a+"";if(b>1&&d.length<b){c=l[b-2]+d;return c.substr(c.length-b,b)}c=d;return c}var d=c.calendar,e=d.convert,f;if(!b||!b.length||b==="i"){if(c&&c.name.length){if(e){f=t(a,d.patterns.F,c)}else{var g=new Date(a.getTime()),h=w(a,d.eras);g.setFullYear(x(a,d,h)),f=g.toLocaleString()}}else{f=a.toString()}return f}var i=d.eras,j=b==="s";b=s(d,b),f=[];var k,l=["0","00","000"],m,n,o=/([^d]|^)(d|dd)([^d]|$)/g,p=0,q=v(),u;!j&&e&&(u=e.fromGregorian(a));for(;;){var B=q.lastIndex,C=q.exec(b),D=b.slice(B,C?C.index:b.length);p+=r(D,f);if(!C){break}if(p%2){f.push(C[0]);continue}var E=C[0],F=E.length;switch(E){case"ddd":case"dddd":var G=F===3?d.days.namesAbbr:d.days.names;f.push(G[a.getDay()]);break;case"d":case"dd":m=!0,f.push(y(A(a,2),F));break;case"MMM":case"MMMM":var H=A(a,1);f.push(d.monthsGenitive&&z()?d.monthsGenitive[F===3?"namesAbbr":"names"][H]:d.months[F===3?"namesAbbr":"names"][H]);break;case"M":case"MM":f.push(y(A(a,1)+1,F));break;case"y":case"yy":case"yyyy":H=u?u[0]:x(a,d,w(a,i),j),F<4&&(H=H%100),f.push(y(H,F));break;case"h":case"hh":k=a.getHours()%12,k===0&&(k=12),f.push(y(k,F));break;case"H":case"HH":f.push(y(a.getHours(),F));break;case"m":case"mm":f.push(y(a.getMinutes(),F));break;case"s":case"ss":f.push(y(a.getSeconds(),F));break;case"t":case"tt":H=a.getHours()<12?d.AM?d.AM[0]:" ":d.PM?d.PM[0]:" ",f.push(F===1?H.charAt(0):H);break;case"f":case"ff":case"fff":f.push(y(a.getMilliseconds(),3).substr(0,F));break;case"z":case"zz":k=a.getTimezoneOffset()/60,f.push((k<=0?"+":"-")+y(Math.floor(Math.abs(k)),F));break;case"zzz":k=a.getTimezoneOffset()/60,f.push((k<=0?"+":"-")+y(Math.floor(Math.abs(k)),2)+":"+y(Math.abs(a.getTimezoneOffset()%60),2));break;case"g":case"gg":d.eras&&f.push(d.eras[w(a,i)].name);break;case"/":f.push(d["/"]);break;default:throw"Invalid date format pattern '"+E+"'."}}return f.join("")},function(){var a;a=function(a,b,c){var d=c.groupSizes,e=d[0],f=1,g=Math.pow(10,b),h=Math.round(a*g)/g;isFinite(h)||(h=a),a=h;var i=a+"",j="",k=i.split(/e/i),l=k.length>1?parseInt(k[1],10):0;i=k[0],k=i.split("."),i=k[0],j=k.length>1?k[1]:"";var m;l>0?(j=q(j,l,!1),i+=j.slice(0,l),j=j.substr(l)):l<0&&(l=-l,i=q(i,l+1,!0),j=i.slice(-l,i.length)+j,i=i.slice(0,-l)),b>0?j=c["."]+(j.length>b?j.slice(0,b):q(j,b)):j="";var n=i.length-1,o=c[","],p="";while(n>=0){if(e===0||e>n){return i.slice(0,n+1)+(p.length?o+p+j:j)}p=i.slice(n-e+1,n+1)+(p.length?o+p:""),n-=e,f<d.length&&(e=d[f],f++)}return i.slice(0,n+1)+o+p+j},u=function(b,c,d){if(!isFinite(b)){return b===Infinity?d.numberFormat.positiveInfinity:b===-Infinity?d.numberFormat.negativeInfinity:d.numberFormat.NaN}if(!c||c==="i"){return d.name.length?b.toLocaleString():b.toString()}c=c||"D";var e=d.numberFormat,f=Math.abs(b),g=-1,h;c.length>1&&(g=parseInt(c.slice(1),10));var i=c.charAt(0).toUpperCase(),j;switch(i){case"D":h="n",f=p(f),g!==-1&&(f=q(""+f,g,!0)),b<0&&(f="-"+f);break;case"N":j=e;case"C":j=j||e.currency;case"P":j=j||e.percent,h=b<0?j.pattern[0]:j.pattern[1]||"n",g===-1&&(g=j.decimals),f=a(f*(i==="P"?100:1),g,j);break;default:throw"Bad number format specifier: "+i}var k=/n|\$|-|%/g,l="";for(;;){var m=k.lastIndex,n=k.exec(h);l+=h.slice(m,n?n.index:h.length);if(!n){break}switch(n[0]){case"n":l+=f;break;case"$":l+=e.currency.symbol;break;case"-":/[1-9]/.test(f)&&(l+=e["-"]);break;case"%":l+=e.percent.symbol}}return l}}(),v=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},w=function(a,b){if(!b){return 0}var c,d=a.getTime();for(var e=0,f=b.length;e<f;e++){c=b[e].start;if(c===null||d>=c){return e}}return 0},x=function(a,b,c,d){var e=a.getFullYear();!d&&b.eras&&(e-=b.eras[c].offset);return e},function(){var a,b,c,d,e,f,g;a=function(a,b){if(b<100){var c=new Date,d=w(c),e=x(c,a,d),f=a.twoDigitYearMax;f=typeof f=="string"?(new Date).getFullYear()%100+parseInt(f,10):f,b+=e-e%100,b>f&&(b-=100)}return b},b=function(a,b,c){var d,e=a.days,i=a._upperDays;i||(a._upperDays=i=[g(e.names),g(e.namesAbbr),g(e.namesShort)]),b=f(b),c?(d=h(i[1],b),d===-1&&(d=h(i[2],b))):d=h(i[0],b);return d},c=function(a,b,c){var d=a.months,e=a.monthsGenitive||a.months,i=a._upperMonths,j=a._upperMonthsGen;i||(a._upperMonths=i=[g(d.names),g(d.namesAbbr)],a._upperMonthsGen=j=[g(e.names),g(e.namesAbbr)]),b=f(b);var k=h(c?i[1]:i[0],b);k<0&&(k=h(c?j[1]:j[0],b));return k},d=function(a,b){var c=a._parseRegExp;if(!c){a._parseRegExp=c={}}else{var d=c[b];if(d){return d}}var e=s(a,b).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),f=["^"],g=[],h=0,i=0,j=v(),k;while((k=j.exec(e))!==null){var l=e.slice(h,k.index);h=j.lastIndex,i+=r(l,f);if(i%2){f.push(k[0]);continue}var m=k[0],n=m.length,o;switch(m){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":o="(\\D+)";break;case"tt":case"t":o="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":o="(\\d{"+n+"})";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":o="(\\d\\d?)";break;case"zzz":o="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":o="([+-]?\\d\\d?)";break;case"/":o="(\\/)";break;default:throw"Invalid date format pattern '"+m+"'."}o&&f.push(o),g.push(k[0])}r(e.slice(h),f),f.push("$");var p=f.join("").replace(/\s+/g,"\\s+"),q={regExp:p,groups:g};return c[b]=q},e=function(a,b,c){return a<b||a>c},f=function(a){return a.split("Â ").join(" ").toUpperCase()},g=function(a){var b=[];for(var c=0,d=a.length;c<d;c++){b[c]=f(a[c])}return b},y=function(f,g,h){f=o(f);var i=h.calendar,j=d(i,g),k=(new RegExp(j.regExp)).exec(f);if(k===null){return null}var l=j.groups,m=null,p=null,q=null,r=null,s=null,t=0,u,v=0,w=0,x=0,y=null,z=!1;for(var A=0,B=l.length;A<B;A++){var C=k[A+1];if(C){var D=l[A],E=D.length,F=parseInt(C,10);switch(D){case"dd":case"d":r=F;if(e(r,1,31)){return null}break;case"MMM":case"MMMM":q=c(i,C,E===3);if(e(q,0,11)){return null}break;case"M":case"MM":q=F-1;if(e(q,0,11)){return null}break;case"y":case"yy":case"yyyy":p=E<4?a(i,F):F;if(e(p,0,9999)){return null}break;case"h":case"hh":t=F,t===12&&(t=0);if(e(t,0,11)){return null}break;case"H":case"HH":t=F;if(e(t,0,23)){return null}break;case"m":case"mm":v=F;if(e(v,0,59)){return null}break;case"s":case"ss":w=F;if(e(w,0,59)){return null}break;case"tt":case"t":z=i.PM&&(C===i.PM[0]||C===i.PM[1]||C===i.PM[2]);if(!z&&(!i.AM||C!==i.AM[0]&&C!==i.AM[1]&&C!==i.AM[2])){return null}break;case"f":case"ff":case"fff":x=F*Math.pow(10,3-E);if(e(x,0,999)){return null}break;case"ddd":case"dddd":s=b(i,C,E===3);if(e(s,0,6)){return null}break;case"zzz":var G=C.split(/:/);if(G.length!==2){return null}u=parseInt(G[0],10);if(e(u,-12,13)){return null}var H=parseInt(G[1],10);if(e(H,0,59)){return null}y=u*60+(n(C,"-")?-H:H);break;case"z":case"zz":u=F;if(e(u,-12,13)){return null}y=u*60;break;case"g":case"gg":var I=C;if(!I||!i.eras){return null}I=o(I.toLowerCase());for(var J=0,K=i.eras.length;J<K;J++){if(I===i.eras[J].name.toLowerCase()){m=J;break}}if(m===null){return null}}}}var L=new Date,M,N=i.convert;M=N?N.fromGregorian(L)[0]:L.getFullYear(),p===null?p=M:i.eras&&(p+=i.eras[m||0].offset),q===null&&(q=0),r===null&&(r=1);if(N){L=N.toGregorian(p,q,r);if(L===null){return null}}else{L.setFullYear(p,q,r);if(L.getDate()!==r){return null}if(s!==null&&L.getDay()!==s){return null}}z&&t<12&&(t+=12),L.setHours(t,v,w,x);if(y!==null){var O=L.getMinutes()-(y+L.getTimezoneOffset());L.setHours(L.getHours()+parseInt(O/60,10),O%60)}return L}}(),z=function(a,b,c){var d=b["-"],e=b["+"],f;switch(c){case"n -":d=" "+d,e=" "+e;case"n-":i(a,d)?f=["-",a.substr(0,a.length-d.length)]:i(a,e)&&(f=["+",a.substr(0,a.length-e.length)]);break;case"- n":d+=" ",e+=" ";case"-n":n(a,d)?f=["-",a.substr(d.length)]:n(a,e)&&(f=["+",a.substr(e.length)]);break;case"(n)":n(a,"(")&&i(a,")")&&(f=["-",a.substr(1,a.length-2)])}return f||["",a]},c.prototype.findClosestCulture=function(a){return c.findClosestCulture.call(this,a)},c.prototype.format=function(a,b,d){return c.format.call(this,a,b,d)},c.prototype.localize=function(a,b){return c.localize.call(this,a,b)},c.prototype.parseInt=function(a,b,d){return c.parseInt.call(this,a,b,d)},c.prototype.parseFloat=function(a,b,d){return c.parseFloat.call(this,a,b,d)},c.prototype.culture=function(a){return c.culture.call(this,a)},c.addCultureInfo=function(a,b,c){var d={},e=!1;typeof a!="string"?(c=a,a=this.culture().name,d=this.cultures[a]):typeof b!="string"?(c=b,e=this.cultures[a]==null,d=this.cultures[a]||this.cultures["default"]):(e=!0,d=this.cultures[b]),this.cultures[a]=j(!0,{},d,c),e&&(this.cultures[a].calendar=this.cultures[a].calendars.standard)},c.findClosestCulture=function(a){var b;if(!a){return this.findClosestCulture(this.cultureSelector)||this.cultures["default"]}typeof a=="string"&&(a=a.split(","));if(k(a)){var c,d=this.cultures,e=a,f,g=e.length,h=[];for(f=0;f<g;f++){a=o(e[f]);var i,j=a.split(";");c=o(j[0]),j.length===1?i=1:(a=o(j[1]),a.indexOf("q=")===0?(a=a.substr(2),i=parseFloat(a),i=isNaN(i)?0:i):i=1),h.push({lang:c,pri:i})}h.sort(function(a,b){if(a.pri<b.pri){return 1}if(a.pri>b.pri){return -1}return 0});for(f=0;f<g;f++){c=h[f].lang,b=d[c];if(b){return b}}for(f=0;f<g;f++){c=h[f].lang;do{var l=c.lastIndexOf("-");if(l===-1){break}c=c.substr(0,l),b=d[c];if(b){return b}}while(1)}for(f=0;f<g;f++){c=h[f].lang;for(var m in d){var n=d[m];if(n.language==c){return n}}}}else{if(typeof a=="object"){return a}}return b||null},c.format=function(a,b,c){var d=this.findClosestCulture(c);a instanceof Date?a=t(a,b,d):typeof a=="number"&&(a=u(a,b,d));return a},c.localize=function(a,b){return this.findClosestCulture(b).messages[a]||this.cultures["default"].messages[a]},c.parseDate=function(a,b,c){c=this.findClosestCulture(c);var d,e,f;if(b){typeof b=="string"&&(b=[b]);if(b.length){for(var g=0,h=b.length;g<h;g++){var i=b[g];if(i){d=y(a,i,c);if(d){break}}}}}else{f=c.calendar.patterns;for(e in f){d=y(a,f[e],c);if(d){break}}}return d||null},c.parseInt=function(a,b,d){return p(c.parseFloat(a,b,d))},c.parseFloat=function(a,b,c){typeof b!="number"&&(c=b,b=10);var g=this.findClosestCulture(c),h=NaN,i=g.numberFormat;a.indexOf(g.numberFormat.currency.symbol)>-1&&(a=a.replace(g.numberFormat.currency.symbol,""),a=a.replace(g.numberFormat.currency["."],g.numberFormat["."])),a=o(a);if(e.test(a)){h=parseFloat(a)}else{if(!b&&d.test(a)){h=parseInt(a,16)}else{var j=z(a,i,i.pattern[0]),k=j[0],l=j[1];k===""&&i.pattern[0]!=="(n)"&&(j=z(a,i,"(n)"),k=j[0],l=j[1]),k===""&&i.pattern[0]!=="-n"&&(j=z(a,i,"-n"),k=j[0],l=j[1]),k=k||"+";var m,n,p=l.indexOf("e");p<0&&(p=l.indexOf("E")),p<0?(n=l,m=null):(n=l.substr(0,p),m=l.substr(p+1));var q,r,s=i["."],t=n.indexOf(s);t<0?(q=n,r=null):(q=n.substr(0,t),r=n.substr(t+s.length));var u=i[","];q=q.split(u).join("");var v=u.replace(/\u00A0/g," ");u!==v&&(q=q.split(v).join(""));var w=k+q;r!==null&&(w+="."+r);if(m!==null){var x=z(m,i,"-n");w+="e"+(x[0]||"+")+x[1]}f.test(w)&&(h=parseFloat(w))}}return h},c.culture=function(a){typeof a!="undefined"&&(this.cultureSelector=a);return this.findClosestCulture(a)||this.cultures["default"]}})(this);!function(a){var b,c,d="0.4.2",e="hasOwnProperty",f=/[\.\/]/,g="*",h=function(){},i=function(a,b){return a-b},j={n:{}},k=function(a,d){a=String(a);var e,f=c,g=Array.prototype.slice.call(arguments,2),h=k.listeners(a),j=0,l=[],m={},n=[],o=b;b=a,c=0;for(var p=0,q=h.length;q>p;p++){"zIndex" in h[p]&&(l.push(h[p].zIndex),h[p].zIndex<0&&(m[h[p].zIndex]=h[p]))}for(l.sort(i);l[j]<0;){if(e=m[l[j++]],n.push(e.apply(d,g)),c){return c=f,n}}for(p=0;q>p;p++){if(e=h[p],"zIndex" in e){if(e.zIndex==l[j]){if(n.push(e.apply(d,g)),c){break}do{if(j++,e=m[l[j]],e&&n.push(e.apply(d,g)),c){break}}while(e)}else{m[e.zIndex]=e}}else{if(n.push(e.apply(d,g)),c){break}}}return c=f,b=o,n.length?n:null};k._events=j,k.listeners=function(a){var b,c,d,e,h,i,k,l,m=a.split(f),n=j,o=[n],p=[];for(e=0,h=m.length;h>e;e++){for(l=[],i=0,k=o.length;k>i;i++){for(n=o[i].n,c=[n[m[e]],n[g]],d=2;d--;){b=c[d],b&&(l.push(b),p=p.concat(b.f||[]))}}o=l}return p},k.on=function(a,b){if(a=String(a),"function"!=typeof b){return function(){}}for(var c=a.split(f),d=j,e=0,g=c.length;g>e;e++){d=d.n,d=d.hasOwnProperty(c[e])&&d[c[e]]||(d[c[e]]={n:{}})}for(d.f=d.f||[],e=0,g=d.f.length;g>e;e++){if(d.f[e]==b){return h}}return d.f.push(b),function(a){+a==+a&&(b.zIndex=+a)}},k.f=function(a){var b=[].slice.call(arguments,1);return function(){k.apply(null,[a,null].concat(b).concat([].slice.call(arguments,0)))}},k.stop=function(){c=1},k.nt=function(a){return a?new RegExp("(?:\\.|\\/|^)"+a+"(?:\\.|\\/|$)").test(b):b},k.nts=function(){return b.split(f)},k.off=k.unbind=function(a,b){if(!a){return k._events=j={n:{}},void 0}var c,d,h,i,l,m,n,o=a.split(f),p=[j];for(i=0,l=o.length;l>i;i++){for(m=0;m<p.length;m+=h.length-2){if(h=[m,1],c=p[m].n,o[i]!=g){c[o[i]]&&h.push(c[o[i]])}else{for(d in c){c[e](d)&&h.push(c[d])}}p.splice.apply(p,h)}}for(i=0,l=p.length;l>i;i++){for(c=p[i];c.n;){if(b){if(c.f){for(m=0,n=c.f.length;n>m;m++){if(c.f[m]==b){c.f.splice(m,1);break}}!c.f.length&&delete c.f}for(d in c.n){if(c.n[e](d)&&c.n[d].f){var q=c.n[d].f;for(m=0,n=q.length;n>m;m++){if(q[m]==b){q.splice(m,1);break}}!q.length&&delete c.n[d].f}}}else{delete c.f;for(d in c.n){c.n[e](d)&&c.n[d].f&&delete c.n[d].f}}c=c.n}}},k.once=function(a,b){var c=function(){return k.unbind(a,c),b.apply(this,arguments)};return k.on(a,c)},k.version=d,k.toString=function(){return"You are running Eve "+d},"undefined"!=typeof module&&module.exports?module.exports=k:"undefined"!=typeof define?define("eve",[],function(){return k}):a.eve=k}(this),function(a,b){"function"==typeof define&&define.amd?define(["eve"],function(c){return b(a,c)}):b(a,a.eve)}(this,function(a,b){function c(a){if(c.is(a,"function")){return u?a():b.on("raphael.DOMload",a)}if(c.is(a,V)){return c._engine.create[D](c,a.splice(0,3+c.is(a[0],T))).add(a)}var d=Array.prototype.slice.call(arguments,0);if(c.is(d[d.length-1],"function")){var e=d.pop();return u?e.call(c._engine.create[D](c,d)):b.on("raphael.DOMload",function(){e.call(c._engine.create[D](c,d))})}return c._engine.create[D](c,arguments)}function d(a){if("function"==typeof a||Object(a)!==a){return a}var b=new a.constructor;for(var c in a){a[z](c)&&(b[c]=d(a[c]))}return b}function e(a,b){for(var c=0,d=a.length;d>c;c++){if(a[c]===b){return a.push(a.splice(c,1)[0])}}}function f(a,b,c){function d(){var f=Array.prototype.slice.call(arguments,0),g=f.join("â€"),h=d.cache=d.cache||{},i=d.count=d.count||[];return h[z](g)?(e(i,g),c?c(h[g]):h[g]):(i.length>=1000&&delete h[i.shift()],i.push(g),h[g]=a[D](b,f),c?c(h[g]):h[g])}return d}function g(){return this.hex}function h(a,b){for(var c=[],d=0,e=a.length;e-2*!b>d;d+=2){var f=[{x:+a[d-2],y:+a[d-1]},{x:+a[d],y:+a[d+1]},{x:+a[d+2],y:+a[d+3]},{x:+a[d+4],y:+a[d+5]}];b?d?e-4==d?f[3]={x:+a[0],y:+a[1]}:e-2==d&&(f[2]={x:+a[0],y:+a[1]},f[3]={x:+a[2],y:+a[3]}):f[0]={x:+a[e-2],y:+a[e-1]}:e-4==d?f[3]=f[2]:d||(f[0]={x:+a[d],y:+a[d+1]}),c.push(["C",(-f[0].x+6*f[1].x+f[2].x)/6,(-f[0].y+6*f[1].y+f[2].y)/6,(f[1].x+6*f[2].x-f[3].x)/6,(f[1].y+6*f[2].y-f[3].y)/6,f[2].x,f[2].y])}return c}function i(a,b,c,d,e){var f=-3*b+9*c-9*d+3*e,g=a*f+6*b-12*c+6*d;return a*g-3*b+3*c}function j(a,b,c,d,e,f,g,h,j){null==j&&(j=1),j=j>1?1:0>j?0:j;for(var k=j/2,l=12,m=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],n=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],o=0,p=0;l>p;p++){var q=k*m[p]+k,r=i(q,a,c,e,g),s=i(q,b,d,f,h),t=r*r+s*s;o+=n[p]*N.sqrt(t)}return k*o}function k(a,b,c,d,e,f,g,h,i){if(!(0>i||j(a,b,c,d,e,f,g,h)<i)){var k,l=1,m=l/2,n=l-m,o=0.01;for(k=j(a,b,c,d,e,f,g,h,n);Q(k-i)>o;){m/=2,n+=(i>k?1:-1)*m,k=j(a,b,c,d,e,f,g,h,n)}return n}}function l(a,b,c,d,e,f,g,h){if(!(O(a,c)<P(e,g)||P(a,c)>O(e,g)||O(b,d)<P(f,h)||P(b,d)>O(f,h))){var i=(a*d-b*c)*(e-g)-(a-c)*(e*h-f*g),j=(a*d-b*c)*(f-h)-(b-d)*(e*h-f*g),k=(a-c)*(f-h)-(b-d)*(e-g);if(k){var l=i/k,m=j/k,n=+l.toFixed(2),o=+m.toFixed(2);if(!(n<+P(a,c).toFixed(2)||n>+O(a,c).toFixed(2)||n<+P(e,g).toFixed(2)||n>+O(e,g).toFixed(2)||o<+P(b,d).toFixed(2)||o>+O(b,d).toFixed(2)||o<+P(f,h).toFixed(2)||o>+O(f,h).toFixed(2))){return{x:l,y:m}}}}}function m(a,b,d){var e=c.bezierBBox(a),f=c.bezierBBox(b);if(!c.isBBoxIntersect(e,f)){return d?0:[]}for(var g=j.apply(0,a),h=j.apply(0,b),i=O(~~(g/5),1),k=O(~~(h/5),1),m=[],n=[],o={},p=d?0:[],q=0;i+1>q;q++){var r=c.findDotsAtSegment.apply(c,a.concat(q/i));m.push({x:r.x,y:r.y,t:q/i})}for(q=0;k+1>q;q++){r=c.findDotsAtSegment.apply(c,b.concat(q/k)),n.push({x:r.x,y:r.y,t:q/k})}for(q=0;i>q;q++){for(var s=0;k>s;s++){var t=m[q],u=m[q+1],v=n[s],w=n[s+1],x=Q(u.x-t.x)<0.001?"y":"x",y=Q(w.x-v.x)<0.001?"y":"x",z=l(t.x,t.y,u.x,u.y,v.x,v.y,w.x,w.y);if(z){if(o[z.x.toFixed(4)]==z.y.toFixed(4)){continue}o[z.x.toFixed(4)]=z.y.toFixed(4);var A=t.t+Q((z[x]-t[x])/(u[x]-t[x]))*(u.t-t.t),B=v.t+Q((z[y]-v[y])/(w[y]-v[y]))*(w.t-v.t);A>=0&&1.001>=A&&B>=0&&1.001>=B&&(d?p++:p.push({x:z.x,y:z.y,t1:P(A,1),t2:P(B,1)}))}}}return p}function n(a,b,d){a=c._path2curve(a),b=c._path2curve(b);for(var e,f,g,h,i,j,k,l,n,o,p=d?0:[],q=0,r=a.length;r>q;q++){var s=a[q];if("M"==s[0]){e=i=s[1],f=j=s[2]}else{"C"==s[0]?(n=[e,f].concat(s.slice(1)),e=n[6],f=n[7]):(n=[e,f,e,f,i,j,i,j],e=i,f=j);for(var t=0,u=b.length;u>t;t++){var v=b[t];if("M"==v[0]){g=k=v[1],h=l=v[2]}else{"C"==v[0]?(o=[g,h].concat(v.slice(1)),g=o[6],h=o[7]):(o=[g,h,g,h,k,l,k,l],g=k,h=l);var w=m(n,o,d);if(d){p+=w}else{for(var x=0,y=w.length;y>x;x++){w[x].segment1=q,w[x].segment2=t,w[x].bez1=n,w[x].bez2=o}p=p.concat(w)}}}}}return p}function o(a,b,c,d,e,f){null!=a?(this.a=+a,this.b=+b,this.c=+c,this.d=+d,this.e=+e,this.f=+f):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function p(){return this.x+H+this.y+H+this.width+" Ã— "+this.height}function q(a,b,c,d,e,f){function g(a){return((l*a+k)*a+j)*a}function h(a,b){var c=i(a,b);return((o*c+n)*c+m)*c}function i(a,b){var c,d,e,f,h,i;for(e=a,i=0;8>i;i++){if(f=g(e)-a,Q(f)<b){return e}if(h=(3*l*e+2*k)*e+j,Q(h)<0.000001){break}e-=f/h}if(c=0,d=1,e=a,c>e){return c}if(e>d){return d}for(;d>c;){if(f=g(e),Q(f-a)<b){return e}a>f?c=e:d=e,e=(d-c)/2+c}return e}var j=3*b,k=3*(d-b)-j,l=1-j-k,m=3*c,n=3*(e-c)-m,o=1-m-n;return h(a,1/(200*f))}function r(a,b){var c=[],d={};if(this.ms=b,this.times=1,a){for(var e in a){a[z](e)&&(d[_(e)]=a[e],c.push(_(e)))}c.sort(lb)}this.anim=d,this.top=c[c.length-1],this.percents=c}function s(a,d,e,f,g,h){e=_(e);var i,j,k,l,m,n,p=a.ms,r={},s={},t={};if(f){for(v=0,x=ic.length;x>v;v++){var u=ic[v];if(u.el.id==d.id&&u.anim==a){u.percent!=e?(ic.splice(v,1),k=1):j=u,d.attr(u.totalOrigin);break}}}else{f=+s}for(var v=0,x=a.percents.length;x>v;v++){if(a.percents[v]==e||a.percents[v]>f*a.top){e=a.percents[v],m=a.percents[v-1]||0,p=p/a.top*(e-m),l=a.percents[v+1],i=a.anim[e];break}f&&d.attr(a.anim[a.percents[v]])}if(i){if(j){j.initstatus=f,j.start=new Date-j.ms*f}else{for(var y in i){if(i[z](y)&&(db[z](y)||d.paper.customAttributes[z](y))){switch(r[y]=d.attr(y),null==r[y]&&(r[y]=cb[y]),s[y]=i[y],db[y]){case T:t[y]=(s[y]-r[y])/p;break;case"colour":r[y]=c.getRGB(r[y]);var A=c.getRGB(s[y]);t[y]={r:(A.r-r[y].r)/p,g:(A.g-r[y].g)/p,b:(A.b-r[y].b)/p};break;case"path":var B=Kb(r[y],s[y]),C=B[1];for(r[y]=B[0],t[y]=[],v=0,x=r[y].length;x>v;v++){t[y][v]=[0];for(var D=1,F=r[y][v].length;F>D;D++){t[y][v][D]=(C[v][D]-r[y][v][D])/p}}break;case"transform":var G=d._,H=Pb(G[y],s[y]);if(H){for(r[y]=H.from,s[y]=H.to,t[y]=[],t[y].real=!0,v=0,x=r[y].length;x>v;v++){for(t[y][v]=[r[y][v][0]],D=1,F=r[y][v].length;F>D;D++){t[y][v][D]=(s[y][v][D]-r[y][v][D])/p}}}else{var K=d.matrix||new o,L={_:{transform:G.transform},getBBox:function(){return d.getBBox(1)}};r[y]=[K.a,K.b,K.c,K.d,K.e,K.f],Nb(L,s[y]),s[y]=L._.transform,t[y]=[(L.matrix.a-K.a)/p,(L.matrix.b-K.b)/p,(L.matrix.c-K.c)/p,(L.matrix.d-K.d)/p,(L.matrix.e-K.e)/p,(L.matrix.f-K.f)/p]}break;case"csv":var M=I(i[y])[J](w),N=I(r[y])[J](w);if("clip-rect"==y){for(r[y]=N,t[y]=[],v=N.length;v--;){t[y][v]=(M[v]-r[y][v])/p}}s[y]=M;break;default:for(M=[][E](i[y]),N=[][E](r[y]),t[y]=[],v=d.paper.customAttributes[y].length;v--;){t[y][v]=((M[v]||0)-(N[v]||0))/p}}}}var O=i.easing,P=c.easing_formulas[O];if(!P){if(P=I(O).match(Z),P&&5==P.length){var Q=P;P=function(a){return q(a,+Q[1],+Q[2],+Q[3],+Q[4],p)}}else{P=nb}}if(n=i.start||a.start||+new Date,u={anim:a,percent:e,timestamp:n,start:n+(a.del||0),status:0,initstatus:f||0,stop:!1,ms:p,easing:P,from:r,diff:t,to:s,el:d,callback:i.callback,prev:m,next:l,repeat:h||a.times,origin:d.attr(),totalOrigin:g},ic.push(u),f&&!j&&!k&&(u.stop=!0,u.start=new Date-p*f,1==ic.length)){return kc()}k&&(u.start=new Date-u.ms*f),1==ic.length&&jc(kc)}b("raphael.anim.start."+d.id,d,a)}}function t(a){for(var b=0;b<ic.length;b++){ic[b].el.paper==a&&ic.splice(b--,1)}}c.version="2.1.2",c.eve=b;var u,v,w=/[, ]+/,x={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},y=/\{(\d+)\}/g,z="hasOwnProperty",A={doc:document,win:a},B={was:Object.prototype[z].call(A.win,"Raphael"),is:A.win.Raphael},C=function(){this.ca=this.customAttributes={}},D="apply",E="concat",F="ontouchstart" in A.win||A.win.DocumentTouch&&A.doc instanceof DocumentTouch,G="",H=" ",I=String,J="split",K="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[J](H),L={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},M=I.prototype.toLowerCase,N=Math,O=N.max,P=N.min,Q=N.abs,R=N.pow,S=N.PI,T="number",U="string",V="array",W=Object.prototype.toString,X=(c._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),Y={NaN:1,Infinity:1,"-Infinity":1},Z=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,$=N.round,_=parseFloat,ab=parseInt,bb=I.prototype.toUpperCase,cb=c._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},db=c._availableAnimAttrs={blur:T,"clip-rect":"csv",cx:T,cy:T,fill:"colour","fill-opacity":T,"font-size":T,height:T,opacity:T,path:"path",r:T,rx:T,ry:T,stroke:"colour","stroke-opacity":T,"stroke-width":T,transform:"transform",width:T,x:T,y:T},eb=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,fb={hs:1,rg:1},gb=/,?([achlmqrstvxz]),?/gi,hb=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,ib=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,jb=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,kb=(c._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),lb=function(a,b){return _(a)-_(b)},mb=function(){},nb=function(a){return a},ob=c._rectPath=function(a,b,c,d,e){return e?[["M",a+e,b],["l",c-2*e,0],["a",e,e,0,0,1,e,e],["l",0,d-2*e],["a",e,e,0,0,1,-e,e],["l",2*e-c,0],["a",e,e,0,0,1,-e,-e],["l",0,2*e-d],["a",e,e,0,0,1,e,-e],["z"]]:[["M",a,b],["l",c,0],["l",0,d],["l",-c,0],["z"]]},pb=function(a,b,c,d){return null==d&&(d=c),[["M",a,b],["m",0,-d],["a",c,d,0,1,1,0,2*d],["a",c,d,0,1,1,0,-2*d],["z"]]},qb=c._getPath={path:function(a){return a.attr("path")},circle:function(a){var b=a.attrs;return pb(b.cx,b.cy,b.r)},ellipse:function(a){var b=a.attrs;return pb(b.cx,b.cy,b.rx,b.ry)},rect:function(a){var b=a.attrs;return ob(b.x,b.y,b.width,b.height,b.r)},image:function(a){var b=a.attrs;return ob(b.x,b.y,b.width,b.height)},text:function(a){var b=a._getBBox();return ob(b.x,b.y,b.width,b.height)},set:function(a){var b=a._getBBox();return ob(b.x,b.y,b.width,b.height)}},rb=c.mapPath=function(a,b){if(!b){return a}var c,d,e,f,g,h,i;for(a=Kb(a),e=0,g=a.length;g>e;e++){for(i=a[e],f=1,h=i.length;h>f;f+=2){c=b.x(i[f],i[f+1]),d=b.y(i[f],i[f+1]),i[f]=c,i[f+1]=d}}return a};if(c._g=A,c.type=A.win.SVGAngle||A.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==c.type){var sb,tb=A.doc.createElement("div");if(tb.innerHTML='<v:shape adj="1"/>',sb=tb.firstChild,sb.style.behavior="url(#default#VML)",!sb||"object"!=typeof sb.adj){return c.type=G}tb=null}c.svg=!(c.vml="VML"==c.type),c._Paper=C,c.fn=v=C.prototype=c.prototype,c._id=0,c._oid=0,c.is=function(a,b){return b=M.call(b),"finite"==b?!Y[z](+a):"array"==b?a instanceof Array:"null"==b&&null===a||b==typeof a&&null!==a||"object"==b&&a===Object(a)||"array"==b&&Array.isArray&&Array.isArray(a)||W.call(a).slice(8,-1).toLowerCase()==b},c.angle=function(a,b,d,e,f,g){if(null==f){var h=a-d,i=b-e;return h||i?(180+180*N.atan2(-i,-h)/S+360)%360:0}return c.angle(a,b,f,g)-c.angle(d,e,f,g)},c.rad=function(a){return a%360*S/180},c.deg=function(a){return 180*a/S%360},c.snapTo=function(a,b,d){if(d=c.is(d,"finite")?d:10,c.is(a,V)){for(var e=a.length;e--;){if(Q(a[e]-b)<=d){return a[e]}}}else{a=+a;var f=b%a;if(d>f){return b-f}if(f>a-d){return b-f+a}}return b},c.createUUID=function(a,b){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(a,b).toUpperCase()}}(/[xy]/g,function(a){var b=0|16*N.random(),c="x"==a?b:8|3&b;return c.toString(16)}),c.setWindow=function(a){b("raphael.setWindow",c,A.win,a),A.win=a,A.doc=A.win.document,c._engine.initWin&&c._engine.initWin(A.win)};var ub=function(a){if(c.vml){var b,d=/^\s+|\s+$/g;try{var e=new ActiveXObject("htmlfile");e.write("<body>"),e.close(),b=e.body}catch(g){b=createPopup().document.body}var h=b.createTextRange();ub=f(function(a){try{b.style.color=I(a).replace(d,G);var c=h.queryCommandValue("ForeColor");return c=(255&c)<<16|65280&c|(16711680&c)>>>16,"#"+("000000"+c.toString(16)).slice(-6)}catch(e){return"none"}})}else{var i=A.doc.createElement("i");i.title="RaphaÃ«l Colour Picker",i.style.display="none",A.doc.body.appendChild(i),ub=f(function(a){return i.style.color=a,A.doc.defaultView.getComputedStyle(i,G).getPropertyValue("color")})}return ub(a)},vb=function(){return"hsb("+[this.h,this.s,this.b]+")"},wb=function(){return"hsl("+[this.h,this.s,this.l]+")"},xb=function(){return this.hex},yb=function(a,b,d){if(null==b&&c.is(a,"object")&&"r" in a&&"g" in a&&"b" in a&&(d=a.b,b=a.g,a=a.r),null==b&&c.is(a,U)){var e=c.getRGB(a);a=e.r,b=e.g,d=e.b}return(a>1||b>1||d>1)&&(a/=255,b/=255,d/=255),[a,b,d]},zb=function(a,b,d,e){a*=255,b*=255,d*=255;var f={r:a,g:b,b:d,hex:c.rgb(a,b,d),toString:xb};return c.is(e,"finite")&&(f.opacity=e),f};c.color=function(a){var b;return c.is(a,"object")&&"h" in a&&"s" in a&&"b" in a?(b=c.hsb2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.hex=b.hex):c.is(a,"object")&&"h" in a&&"s" in a&&"l" in a?(b=c.hsl2rgb(a),a.r=b.r,a.g=b.g,a.b=b.b,a.hex=b.hex):(c.is(a,"string")&&(a=c.getRGB(a)),c.is(a,"object")&&"r" in a&&"g" in a&&"b" in a?(b=c.rgb2hsl(a),a.h=b.h,a.s=b.s,a.l=b.l,b=c.rgb2hsb(a),a.v=b.b):(a={hex:"none"},a.r=a.g=a.b=a.h=a.s=a.v=a.l=-1)),a.toString=xb,a},c.hsb2rgb=function(a,b,c,d){this.is(a,"object")&&"h" in a&&"s" in a&&"b" in a&&(c=a.b,b=a.s,a=a.h,d=a.o),a*=360;var e,f,g,h,i;return a=a%360/60,i=c*b,h=i*(1-Q(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],zb(e,f,g,d)},c.hsl2rgb=function(a,b,c,d){this.is(a,"object")&&"h" in a&&"s" in a&&"l" in a&&(c=a.l,b=a.s,a=a.h),(a>1||b>1||c>1)&&(a/=360,b/=100,c/=100),a*=360;var e,f,g,h,i;return a=a%360/60,i=2*b*(0.5>c?c:1-c),h=i*(1-Q(a%2-1)),e=f=g=c-i/2,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],zb(e,f,g,d)},c.rgb2hsb=function(a,b,c){c=yb(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g;return f=O(a,b,c),g=f-P(a,b,c),d=0==g?null:f==a?(b-c)/g:f==b?(c-a)/g+2:(a-b)/g+4,d=60*((d+360)%6)/360,e=0==g?0:g/f,{h:d,s:e,b:f,toString:vb}},c.rgb2hsl=function(a,b,c){c=yb(a,b,c),a=c[0],b=c[1],c=c[2];var d,e,f,g,h,i;return g=O(a,b,c),h=P(a,b,c),i=g-h,d=0==i?null:g==a?(b-c)/i:g==b?(c-a)/i+2:(a-b)/i+4,d=60*((d+360)%6)/360,f=(g+h)/2,e=0==i?0:0.5>f?i/(2*f):i/(2-2*f),{h:d,s:e,l:f,toString:wb}},c._path2string=function(){return this.join(",").replace(gb,"$1")},c._preload=function(a,b){var c=A.doc.createElement("img");c.style.cssText="position:absolute;left:-9999em;top:-9999em",c.onload=function(){b.call(this),this.onload=null,A.doc.body.removeChild(this)},c.onerror=function(){A.doc.body.removeChild(this)},A.doc.body.appendChild(c),c.src=a},c.getRGB=f(function(a){if(!a||(a=I(a)).indexOf("-")+1){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:g}}if("none"==a){return{r:-1,g:-1,b:-1,hex:"none",toString:g}}!(fb[z](a.toLowerCase().substring(0,2))||"#"==a.charAt())&&(a=ub(a));var b,d,e,f,h,i,j=a.match(X);return j?(j[2]&&(e=ab(j[2].substring(5),16),d=ab(j[2].substring(3,5),16),b=ab(j[2].substring(1,3),16)),j[3]&&(e=ab((h=j[3].charAt(3))+h,16),d=ab((h=j[3].charAt(2))+h,16),b=ab((h=j[3].charAt(1))+h,16)),j[4]&&(i=j[4][J](eb),b=_(i[0]),"%"==i[0].slice(-1)&&(b*=2.55),d=_(i[1]),"%"==i[1].slice(-1)&&(d*=2.55),e=_(i[2]),"%"==i[2].slice(-1)&&(e*=2.55),"rgba"==j[1].toLowerCase().slice(0,4)&&(f=_(i[3])),i[3]&&"%"==i[3].slice(-1)&&(f/=100)),j[5]?(i=j[5][J](eb),b=_(i[0]),"%"==i[0].slice(-1)&&(b*=2.55),d=_(i[1]),"%"==i[1].slice(-1)&&(d*=2.55),e=_(i[2]),"%"==i[2].slice(-1)&&(e*=2.55),("deg"==i[0].slice(-3)||"Â°"==i[0].slice(-1))&&(b/=360),"hsba"==j[1].toLowerCase().slice(0,4)&&(f=_(i[3])),i[3]&&"%"==i[3].slice(-1)&&(f/=100),c.hsb2rgb(b,d,e,f)):j[6]?(i=j[6][J](eb),b=_(i[0]),"%"==i[0].slice(-1)&&(b*=2.55),d=_(i[1]),"%"==i[1].slice(-1)&&(d*=2.55),e=_(i[2]),"%"==i[2].slice(-1)&&(e*=2.55),("deg"==i[0].slice(-3)||"Â°"==i[0].slice(-1))&&(b/=360),"hsla"==j[1].toLowerCase().slice(0,4)&&(f=_(i[3])),i[3]&&"%"==i[3].slice(-1)&&(f/=100),c.hsl2rgb(b,d,e,f)):(j={r:b,g:d,b:e,toString:g},j.hex="#"+(16777216|e|d<<8|b<<16).toString(16).slice(1),c.is(f,"finite")&&(j.opacity=f),j)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:g}},c),c.hsb=f(function(a,b,d){return c.hsb2rgb(a,b,d).hex}),c.hsl=f(function(a,b,d){return c.hsl2rgb(a,b,d).hex}),c.rgb=f(function(a,b,c){return"#"+(16777216|c|b<<8|a<<16).toString(16).slice(1)}),c.getColor=function(a){var b=this.getColor.start=this.getColor.start||{h:0,s:1,b:a||0.75},c=this.hsb2rgb(b.h,b.s,b.b);return b.h+=0.075,b.h>1&&(b.h=0,b.s-=0.2,b.s<=0&&(this.getColor.start={h:0,s:1,b:b.b})),c.hex},c.getColor.reset=function(){delete this.start},c.parsePathString=function(a){if(!a){return null}var b=Ab(a);if(b.arr){return Cb(b.arr)}var d={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[];return c.is(a,V)&&c.is(a[0],V)&&(e=Cb(a)),e.length||I(a).replace(hb,function(a,b,c){var f=[],g=b.toLowerCase();if(c.replace(jb,function(a,b){b&&f.push(+b)}),"m"==g&&f.length>2&&(e.push([b][E](f.splice(0,2))),g="l",b="m"==b?"l":"L"),"r"==g){e.push([b][E](f))}else{for(;f.length>=d[g]&&(e.push([b][E](f.splice(0,d[g]))),d[g]);){}}}),e.toString=c._path2string,b.arr=Cb(e),e},c.parseTransformString=f(function(a){if(!a){return null}var b=[];return c.is(a,V)&&c.is(a[0],V)&&(b=Cb(a)),b.length||I(a).replace(ib,function(a,c,d){var e=[];M.call(c),d.replace(jb,function(a,b){b&&e.push(+b)}),b.push([c][E](e))}),b.toString=c._path2string,b});var Ab=function(a){var b=Ab.ps=Ab.ps||{};return b[a]?b[a].sleep=100:b[a]={sleep:100},setTimeout(function(){for(var c in b){b[z](c)&&c!=a&&(b[c].sleep--,!b[c].sleep&&delete b[c])}}),b[a]};c.findDotsAtSegment=function(a,b,c,d,e,f,g,h,i){var j=1-i,k=R(j,3),l=R(j,2),m=i*i,n=m*i,o=k*a+3*l*i*c+3*j*i*i*e+n*g,p=k*b+3*l*i*d+3*j*i*i*f+n*h,q=a+2*i*(c-a)+m*(e-2*c+a),r=b+2*i*(d-b)+m*(f-2*d+b),s=c+2*i*(e-c)+m*(g-2*e+c),t=d+2*i*(f-d)+m*(h-2*f+d),u=j*a+i*c,v=j*b+i*d,w=j*e+i*g,x=j*f+i*h,y=90-180*N.atan2(q-s,r-t)/S;return(q>s||t>r)&&(y+=180),{x:o,y:p,m:{x:q,y:r},n:{x:s,y:t},start:{x:u,y:v},end:{x:w,y:x},alpha:y}},c.bezierBBox=function(a,b,d,e,f,g,h,i){c.is(a,"array")||(a=[a,b,d,e,f,g,h,i]);var j=Jb.apply(null,a);return{x:j.min.x,y:j.min.y,x2:j.max.x,y2:j.max.y,width:j.max.x-j.min.x,height:j.max.y-j.min.y}},c.isPointInsideBBox=function(a,b,c){return b>=a.x&&b<=a.x2&&c>=a.y&&c<=a.y2},c.isBBoxIntersect=function(a,b){var d=c.isPointInsideBBox;return d(b,a.x,a.y)||d(b,a.x2,a.y)||d(b,a.x,a.y2)||d(b,a.x2,a.y2)||d(a,b.x,b.y)||d(a,b.x2,b.y)||d(a,b.x,b.y2)||d(a,b.x2,b.y2)||(a.x<b.x2&&a.x>b.x||b.x<a.x2&&b.x>a.x)&&(a.y<b.y2&&a.y>b.y||b.y<a.y2&&b.y>a.y)},c.pathIntersection=function(a,b){return n(a,b)},c.pathIntersectionNumber=function(a,b){return n(a,b,1)},c.isPointInsidePath=function(a,b,d){var e=c.pathBBox(a);return c.isPointInsideBBox(e,b,d)&&1==n(a,[["M",b,d],["H",e.x2+10]],1)%2},c._removedFactory=function(a){return function(){b("raphael.log",null,"RaphaÃ«l: you are calling to method â€œ"+a+"â€ of removed object",a)}};var Bb=c.pathBBox=function(a){var b=Ab(a);if(b.bbox){return d(b.bbox)}if(!a){return{x:0,y:0,width:0,height:0,x2:0,y2:0}}a=Kb(a);for(var c,e=0,f=0,g=[],h=[],i=0,j=a.length;j>i;i++){if(c=a[i],"M"==c[0]){e=c[1],f=c[2],g.push(e),h.push(f)}else{var k=Jb(e,f,c[1],c[2],c[3],c[4],c[5],c[6]);g=g[E](k.min.x,k.max.x),h=h[E](k.min.y,k.max.y),e=c[5],f=c[6]}}var l=P[D](0,g),m=P[D](0,h),n=O[D](0,g),o=O[D](0,h),p=n-l,q=o-m,r={x:l,y:m,x2:n,y2:o,width:p,height:q,cx:l+p/2,cy:m+q/2};return b.bbox=d(r),r},Cb=function(a){var b=d(a);return b.toString=c._path2string,b},Db=c._pathToRelative=function(a){var b=Ab(a);if(b.rel){return Cb(b.rel)}c.is(a,V)&&c.is(a&&a[0],V)||(a=c.parsePathString(a));var d=[],e=0,f=0,g=0,h=0,i=0;"M"==a[0][0]&&(e=a[0][1],f=a[0][2],g=e,h=f,i++,d.push(["M",e,f]));for(var j=i,k=a.length;k>j;j++){var l=d[j]=[],m=a[j];if(m[0]!=M.call(m[0])){switch(l[0]=M.call(m[0]),l[0]){case"a":l[1]=m[1],l[2]=m[2],l[3]=m[3],l[4]=m[4],l[5]=m[5],l[6]=+(m[6]-e).toFixed(3),l[7]=+(m[7]-f).toFixed(3);break;case"v":l[1]=+(m[1]-f).toFixed(3);break;case"m":g=m[1],h=m[2];default:for(var n=1,o=m.length;o>n;n++){l[n]=+(m[n]-(n%2?e:f)).toFixed(3)}}}else{l=d[j]=[],"m"==m[0]&&(g=m[1]+e,h=m[2]+f);for(var p=0,q=m.length;q>p;p++){d[j][p]=m[p]}}var r=d[j].length;switch(d[j][0]){case"z":e=g,f=h;break;case"h":e+=+d[j][r-1];break;case"v":f+=+d[j][r-1];break;default:e+=+d[j][r-2],f+=+d[j][r-1]}}return d.toString=c._path2string,b.rel=Cb(d),d},Eb=c._pathToAbsolute=function(a){var b=Ab(a);if(b.abs){return Cb(b.abs)}if(c.is(a,V)&&c.is(a&&a[0],V)||(a=c.parsePathString(a)),!a||!a.length){return[["M",0,0]]}var d=[],e=0,f=0,g=0,i=0,j=0;"M"==a[0][0]&&(e=+a[0][1],f=+a[0][2],g=e,i=f,j++,d[0]=["M",e,f]);for(var k,l,m=3==a.length&&"M"==a[0][0]&&"R"==a[1][0].toUpperCase()&&"Z"==a[2][0].toUpperCase(),n=j,o=a.length;o>n;n++){if(d.push(k=[]),l=a[n],l[0]!=bb.call(l[0])){switch(k[0]=bb.call(l[0]),k[0]){case"A":k[1]=l[1],k[2]=l[2],k[3]=l[3],k[4]=l[4],k[5]=l[5],k[6]=+(l[6]+e),k[7]=+(l[7]+f);break;case"V":k[1]=+l[1]+f;break;case"H":k[1]=+l[1]+e;break;case"R":for(var p=[e,f][E](l.slice(1)),q=2,r=p.length;r>q;q++){p[q]=+p[q]+e,p[++q]=+p[q]+f}d.pop(),d=d[E](h(p,m));break;case"M":g=+l[1]+e,i=+l[2]+f;default:for(q=1,r=l.length;r>q;q++){k[q]=+l[q]+(q%2?e:f)}}}else{if("R"==l[0]){p=[e,f][E](l.slice(1)),d.pop(),d=d[E](h(p,m)),k=["R"][E](l.slice(-2))}else{for(var s=0,t=l.length;t>s;s++){k[s]=l[s]}}}switch(k[0]){case"Z":e=g,f=i;break;case"H":e=k[1];break;case"V":f=k[1];break;case"M":g=k[k.length-2],i=k[k.length-1];default:e=k[k.length-2],f=k[k.length-1]}}return d.toString=c._path2string,b.abs=Cb(d),d},Fb=function(a,b,c,d){return[a,b,c,d,c,d]},Gb=function(a,b,c,d,e,f){var g=1/3,h=2/3;return[g*a+h*c,g*b+h*d,g*e+h*c,g*f+h*d,e,f]},Hb=function(a,b,c,d,e,g,h,i,j,k){var l,m=120*S/180,n=S/180*(+e||0),o=[],p=f(function(a,b,c){var d=a*N.cos(c)-b*N.sin(c),e=a*N.sin(c)+b*N.cos(c);return{x:d,y:e}});if(k){y=k[0],z=k[1],w=k[2],x=k[3]}else{l=p(a,b,-n),a=l.x,b=l.y,l=p(i,j,-n),i=l.x,j=l.y;var q=(N.cos(S/180*e),N.sin(S/180*e),(a-i)/2),r=(b-j)/2,s=q*q/(c*c)+r*r/(d*d);s>1&&(s=N.sqrt(s),c=s*c,d=s*d);var t=c*c,u=d*d,v=(g==h?-1:1)*N.sqrt(Q((t*u-t*r*r-u*q*q)/(t*r*r+u*q*q))),w=v*c*r/d+(a+i)/2,x=v*-d*q/c+(b+j)/2,y=N.asin(((b-x)/d).toFixed(9)),z=N.asin(((j-x)/d).toFixed(9));y=w>a?S-y:y,z=w>i?S-z:z,0>y&&(y=2*S+y),0>z&&(z=2*S+z),h&&y>z&&(y-=2*S),!h&&z>y&&(z-=2*S)}var A=z-y;if(Q(A)>m){var B=z,C=i,D=j;z=y+m*(h&&z>y?1:-1),i=w+c*N.cos(z),j=x+d*N.sin(z),o=Hb(i,j,c,d,e,0,h,C,D,[z,B,w,x])}A=z-y;var F=N.cos(y),G=N.sin(y),H=N.cos(z),I=N.sin(z),K=N.tan(A/4),L=4/3*c*K,M=4/3*d*K,O=[a,b],P=[a+L*G,b-M*F],R=[i+L*I,j-M*H],T=[i,j];if(P[0]=2*O[0]-P[0],P[1]=2*O[1]-P[1],k){return[P,R,T][E](o)}o=[P,R,T][E](o).join()[J](",");for(var U=[],V=0,W=o.length;W>V;V++){U[V]=V%2?p(o[V-1],o[V],n).y:p(o[V],o[V+1],n).x}return U},Ib=function(a,b,c,d,e,f,g,h,i){var j=1-i;return{x:R(j,3)*a+3*R(j,2)*i*c+3*j*i*i*e+R(i,3)*g,y:R(j,3)*b+3*R(j,2)*i*d+3*j*i*i*f+R(i,3)*h}},Jb=f(function(a,b,c,d,e,f,g,h){var i,j=e-2*c+a-(g-2*e+c),k=2*(c-a)-2*(e-c),l=a-c,m=(-k+N.sqrt(k*k-4*j*l))/2/j,n=(-k-N.sqrt(k*k-4*j*l))/2/j,o=[b,h],p=[a,g];return Q(m)>"1e12"&&(m=0.5),Q(n)>"1e12"&&(n=0.5),m>0&&1>m&&(i=Ib(a,b,c,d,e,f,g,h,m),p.push(i.x),o.push(i.y)),n>0&&1>n&&(i=Ib(a,b,c,d,e,f,g,h,n),p.push(i.x),o.push(i.y)),j=f-2*d+b-(h-2*f+d),k=2*(d-b)-2*(f-d),l=b-d,m=(-k+N.sqrt(k*k-4*j*l))/2/j,n=(-k-N.sqrt(k*k-4*j*l))/2/j,Q(m)>"1e12"&&(m=0.5),Q(n)>"1e12"&&(n=0.5),m>0&&1>m&&(i=Ib(a,b,c,d,e,f,g,h,m),p.push(i.x),o.push(i.y)),n>0&&1>n&&(i=Ib(a,b,c,d,e,f,g,h,n),p.push(i.x),o.push(i.y)),{min:{x:P[D](0,p),y:P[D](0,o)},max:{x:O[D](0,p),y:O[D](0,o)}}}),Kb=c._path2curve=f(function(a,b){var c=!b&&Ab(a);if(!b&&c.curve){return Cb(c.curve)}for(var d=Eb(a),e=b&&Eb(b),f={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},g={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},h=(function(a,b,c){var d,e;if(!a){return["C",b.x,b.y,b.x,b.y,b.x,b.y]}switch(!(a[0] in {T:1,Q:1})&&(b.qx=b.qy=null),a[0]){case"M":b.X=a[1],b.Y=a[2];break;case"A":a=["C"][E](Hb[D](0,[b.x,b.y][E](a.slice(1))));break;case"S":"C"==c||"S"==c?(d=2*b.x-b.bx,e=2*b.y-b.by):(d=b.x,e=b.y),a=["C",d,e][E](a.slice(1));break;case"T":"Q"==c||"T"==c?(b.qx=2*b.x-b.qx,b.qy=2*b.y-b.qy):(b.qx=b.x,b.qy=b.y),a=["C"][E](Gb(b.x,b.y,b.qx,b.qy,a[1],a[2]));break;case"Q":b.qx=a[1],b.qy=a[2],a=["C"][E](Gb(b.x,b.y,a[1],a[2],a[3],a[4]));break;case"L":a=["C"][E](Fb(b.x,b.y,a[1],a[2]));break;case"H":a=["C"][E](Fb(b.x,b.y,a[1],b.y));break;case"V":a=["C"][E](Fb(b.x,b.y,b.x,a[1]));break;case"Z":a=["C"][E](Fb(b.x,b.y,b.X,b.Y))}return a}),i=function(a,b){if(a[b].length>7){a[b].shift();for(var c=a[b];c.length;){a.splice(b++,0,["C"][E](c.splice(0,6)))}a.splice(b,1),l=O(d.length,e&&e.length||0)}},j=function(a,b,c,f,g){a&&b&&"M"==a[g][0]&&"M"!=b[g][0]&&(b.splice(g,0,["M",f.x,f.y]),c.bx=0,c.by=0,c.x=a[g][1],c.y=a[g][2],l=O(d.length,e&&e.length||0))},k=0,l=O(d.length,e&&e.length||0);l>k;k++){d[k]=h(d[k],f),i(d,k),e&&(e[k]=h(e[k],g)),e&&i(e,k),j(d,e,f,g,k),j(e,d,g,f,k);var m=d[k],n=e&&e[k],o=m.length,p=e&&n.length;f.x=m[o-2],f.y=m[o-1],f.bx=_(m[o-4])||f.x,f.by=_(m[o-3])||f.y,g.bx=e&&(_(n[p-4])||g.x),g.by=e&&(_(n[p-3])||g.y),g.x=e&&n[p-2],g.y=e&&n[p-1]}return e||(c.curve=Cb(d)),e?[d,e]:d},null,Cb),Lb=(c._parseDots=f(function(a){for(var b=[],d=0,e=a.length;e>d;d++){var f={},g=a[d].match(/^([^:]*):?([\d\.]*)/);if(f.color=c.getRGB(g[1]),f.color.error){return null}f.color=f.color.hex,g[2]&&(f.offset=g[2]+"%"),b.push(f)}for(d=1,e=b.length-1;e>d;d++){if(!b[d].offset){for(var h=_(b[d-1].offset||0),i=0,j=d+1;e>j;j++){if(b[j].offset){i=b[j].offset;break}}i||(i=100,j=e),i=_(i);for(var k=(i-h)/(j-d+1);j>d;d++){h+=k,b[d].offset=h+"%"}}}return b}),c._tear=function(a,b){a==b.top&&(b.top=a.prev),a==b.bottom&&(b.bottom=a.next),a.next&&(a.next.prev=a.prev),a.prev&&(a.prev.next=a.next)}),Mb=(c._tofront=function(a,b){b.top!==a&&(Lb(a,b),a.next=null,a.prev=b.top,b.top.next=a,b.top=a)},c._toback=function(a,b){b.bottom!==a&&(Lb(a,b),a.next=b.bottom,a.prev=null,b.bottom.prev=a,b.bottom=a)},c._insertafter=function(a,b,c){Lb(a,c),b==c.top&&(c.top=a),b.next&&(b.next.prev=a),a.next=b.next,a.prev=b,b.next=a},c._insertbefore=function(a,b,c){Lb(a,c),b==c.bottom&&(c.bottom=a),b.prev&&(b.prev.next=a),a.prev=b.prev,b.prev=a,a.next=b},c.toMatrix=function(a,b){var c=Bb(a),d={_:{transform:G},getBBox:function(){return c}};return Nb(d,b),d.matrix}),Nb=(c.transformPath=function(a,b){return rb(a,Mb(a,b))},c._extractTransform=function(a,b){if(null==b){return a._.transform}b=I(b).replace(/\.{3}|\u2026/g,a._.transform||G);var d=c.parseTransformString(b),e=0,f=0,g=0,h=1,i=1,j=a._,k=new o;if(j.transform=d||[],d){for(var l=0,m=d.length;m>l;l++){var n,p,q,r,s,t=d[l],u=t.length,v=I(t[0]).toLowerCase(),w=t[0]!=v,x=w?k.invert():0;"t"==v&&3==u?w?(n=x.x(0,0),p=x.y(0,0),q=x.x(t[1],t[2]),r=x.y(t[1],t[2]),k.translate(q-n,r-p)):k.translate(t[1],t[2]):"r"==v?2==u?(s=s||a.getBBox(1),k.rotate(t[1],s.x+s.width/2,s.y+s.height/2),e+=t[1]):4==u&&(w?(q=x.x(t[2],t[3]),r=x.y(t[2],t[3]),k.rotate(t[1],q,r)):k.rotate(t[1],t[2],t[3]),e+=t[1]):"s"==v?2==u||3==u?(s=s||a.getBBox(1),k.scale(t[1],t[u-1],s.x+s.width/2,s.y+s.height/2),h*=t[1],i*=t[u-1]):5==u&&(w?(q=x.x(t[3],t[4]),r=x.y(t[3],t[4]),k.scale(t[1],t[2],q,r)):k.scale(t[1],t[2],t[3],t[4]),h*=t[1],i*=t[2]):"m"==v&&7==u&&k.add(t[1],t[2],t[3],t[4],t[5],t[6]),j.dirtyT=1,a.matrix=k}}a.matrix=k,j.sx=h,j.sy=i,j.deg=e,j.dx=f=k.e,j.dy=g=k.f,1==h&&1==i&&!e&&j.bbox?(j.bbox.x+=+f,j.bbox.y+=+g):j.dirtyT=1}),Ob=function(a){var b=a[0];switch(b.toLowerCase()){case"t":return[b,0,0];case"m":return[b,1,0,0,1,0,0];case"r":return 4==a.length?[b,0,a[2],a[3]]:[b,0];case"s":return 5==a.length?[b,1,1,a[3],a[4]]:3==a.length?[b,1,1]:[b,1]}},Pb=c._equaliseTransform=function(a,b){b=I(b).replace(/\.{3}|\u2026/g,a),a=c.parseTransformString(a)||[],b=c.parseTransformString(b)||[];for(var d,e,f,g,h=O(a.length,b.length),i=[],j=[],k=0;h>k;k++){if(f=a[k]||Ob(b[k]),g=b[k]||Ob(f),f[0]!=g[0]||"r"==f[0].toLowerCase()&&(f[2]!=g[2]||f[3]!=g[3])||"s"==f[0].toLowerCase()&&(f[3]!=g[3]||f[4]!=g[4])){return}for(i[k]=[],j[k]=[],d=0,e=O(f.length,g.length);e>d;d++){d in f&&(i[k][d]=f[d]),d in g&&(j[k][d]=g[d])}}return{from:i,to:j}};c._getContainer=function(a,b,d,e){var f;return f=null!=e||c.is(a,"object")?a:A.doc.getElementById(a),null!=f?f.tagName?null==b?{container:f,width:f.style.pixelWidth||f.offsetWidth,height:f.style.pixelHeight||f.offsetHeight}:{container:f,width:b,height:d}:{container:1,x:a,y:b,width:d,height:e}:void 0},c.pathToRelative=Db,c._engine={},c.path2curve=Kb,c.matrix=function(a,b,c,d,e,f){return new o(a,b,c,d,e,f)},function(a){function b(a){return a[0]*a[0]+a[1]*a[1]}function d(a){var c=N.sqrt(b(a));a[0]&&(a[0]/=c),a[1]&&(a[1]/=c)}a.add=function(a,b,c,d,e,f){var g,h,i,j,k=[[],[],[]],l=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],m=[[a,c,e],[b,d,f],[0,0,1]];for(a&&a instanceof o&&(m=[[a.a,a.c,a.e],[a.b,a.d,a.f],[0,0,1]]),g=0;3>g;g++){for(h=0;3>h;h++){for(j=0,i=0;3>i;i++){j+=l[g][i]*m[i][h]}k[g][h]=j}}this.a=k[0][0],this.b=k[1][0],this.c=k[0][1],this.d=k[1][1],this.e=k[0][2],this.f=k[1][2]},a.invert=function(){var a=this,b=a.a*a.d-a.b*a.c;return new o(a.d/b,-a.b/b,-a.c/b,a.a/b,(a.c*a.f-a.d*a.e)/b,(a.b*a.e-a.a*a.f)/b)},a.clone=function(){return new o(this.a,this.b,this.c,this.d,this.e,this.f)},a.translate=function(a,b){this.add(1,0,0,1,a,b)},a.scale=function(a,b,c,d){null==b&&(b=a),(c||d)&&this.add(1,0,0,1,c,d),this.add(a,0,0,b,0,0),(c||d)&&this.add(1,0,0,1,-c,-d)},a.rotate=function(a,b,d){a=c.rad(a),b=b||0,d=d||0;var e=+N.cos(a).toFixed(9),f=+N.sin(a).toFixed(9);this.add(e,f,-f,e,b,d),this.add(1,0,0,1,-b,-d)},a.x=function(a,b){return a*this.a+b*this.c+this.e},a.y=function(a,b){return a*this.b+b*this.d+this.f},a.get=function(a){return +this[I.fromCharCode(97+a)].toFixed(4)},a.toString=function(){return c.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},a.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},a.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},a.split=function(){var a={};a.dx=this.e,a.dy=this.f;var e=[[this.a,this.c],[this.b,this.d]];a.scalex=N.sqrt(b(e[0])),d(e[0]),a.shear=e[0][0]*e[1][0]+e[0][1]*e[1][1],e[1]=[e[1][0]-e[0][0]*a.shear,e[1][1]-e[0][1]*a.shear],a.scaley=N.sqrt(b(e[1])),d(e[1]),a.shear/=a.scaley;var f=-e[0][1],g=e[1][1];return 0>g?(a.rotate=c.deg(N.acos(g)),0>f&&(a.rotate=360-a.rotate)):a.rotate=c.deg(N.asin(f)),a.isSimple=!(+a.shear.toFixed(9)||a.scalex.toFixed(9)!=a.scaley.toFixed(9)&&a.rotate),a.isSuperSimple=!+a.shear.toFixed(9)&&a.scalex.toFixed(9)==a.scaley.toFixed(9)&&!a.rotate,a.noRotation=!+a.shear.toFixed(9)&&!a.rotate,a},a.toTransformString=function(a){var b=a||this[J]();return b.isSimple?(b.scalex=+b.scalex.toFixed(4),b.scaley=+b.scaley.toFixed(4),b.rotate=+b.rotate.toFixed(4),(b.dx||b.dy?"t"+[b.dx,b.dy]:G)+(1!=b.scalex||1!=b.scaley?"s"+[b.scalex,b.scaley,0,0]:G)+(b.rotate?"r"+[b.rotate,0,0]:G)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(o.prototype);var Qb=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);v.safari="Apple Computer, Inc."==navigator.vendor&&(Qb&&Qb[1]<4||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&Qb&&Qb[1]<8?function(){var a=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){a.remove()})}:mb;for(var Rb=function(){this.returnValue=!1},Sb=function(){return this.originalEvent.preventDefault()},Tb=function(){this.cancelBubble=!0},Ub=function(){return this.originalEvent.stopPropagation()},Vb=function(a){var b=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,c=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft;return{x:a.clientX+c,y:a.clientY+b}},Wb=function(){return A.doc.addEventListener?function(a,b,c,d){var e=function(a){var b=Vb(a);return c.call(d,a,b.x,b.y)};if(a.addEventListener(b,e,!1),F&&L[b]){var f=function(b){for(var e=Vb(b),f=b,g=0,h=b.targetTouches&&b.targetTouches.length;h>g;g++){if(b.targetTouches[g].target==a){b=b.targetTouches[g],b.originalEvent=f,b.preventDefault=Sb,b.stopPropagation=Ub;break}}return c.call(d,b,e.x,e.y)};a.addEventListener(L[b],f,!1)}return function(){return a.removeEventListener(b,e,!1),F&&L[b]&&a.removeEventListener(L[b],e,!1),!0}}:A.doc.attachEvent?function(a,b,c,d){var e=function(a){a=a||A.win.event;var b=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,e=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft,f=a.clientX+e,g=a.clientY+b;return a.preventDefault=a.preventDefault||Rb,a.stopPropagation=a.stopPropagation||Tb,c.call(d,a,f,g)};a.attachEvent("on"+b,e);var f=function(){return a.detachEvent("on"+b,e),!0};return f}:void 0}(),Xb=[],Yb=function(a){for(var c,d=a.clientX,e=a.clientY,f=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,g=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft,h=Xb.length;h--;){if(c=Xb[h],F&&a.touches){for(var i,j=a.touches.length;j--;){if(i=a.touches[j],i.identifier==c.el._drag.id){d=i.clientX,e=i.clientY,(a.originalEvent?a.originalEvent:a).preventDefault();break}}}else{a.preventDefault()}var k,l=c.el.node,m=l.nextSibling,n=l.parentNode,o=l.style.display;A.win.opera&&n.removeChild(l),l.style.display="none",k=c.el.paper.getElementByPoint(d,e),l.style.display=o,A.win.opera&&(m?n.insertBefore(l,m):n.appendChild(l)),k&&b("raphael.drag.over."+c.el.id,c.el,k),d+=g,e+=f,b("raphael.drag.move."+c.el.id,c.move_scope||c.el,d-c.el._drag.x,e-c.el._drag.y,d,e,a)}},Zb=function(a){c.unmousemove(Yb).unmouseup(Zb);for(var d,e=Xb.length;e--;){d=Xb[e],d.el._drag={},b("raphael.drag.end."+d.el.id,d.end_scope||d.start_scope||d.move_scope||d.el,a)}Xb=[]},$b=c.el={},_b=K.length;_b--;){!function(a){c[a]=$b[a]=function(b,d){return c.is(b,"function")&&(this.events=this.events||[],this.events.push({name:a,f:b,unbind:Wb(this.shape||this.node||A.doc,a,b,d||this)})),this},c["un"+a]=$b["un"+a]=function(b){for(var d=this.events||[],e=d.length;e--;){d[e].name!=a||!c.is(b,"undefined")&&d[e].f!=b||(d[e].unbind(),d.splice(e,1),!d.length&&delete this.events)}return this}}(K[_b])}$b.data=function(a,d){var e=kb[this.id]=kb[this.id]||{};if(0==arguments.length){return e}if(1==arguments.length){if(c.is(a,"object")){for(var f in a){a[z](f)&&this.data(f,a[f])}return this}return b("raphael.data.get."+this.id,this,e[a],a),e[a]}return e[a]=d,b("raphael.data.set."+this.id,this,d,a),this},$b.removeData=function(a){return null==a?kb[this.id]={}:kb[this.id]&&delete kb[this.id][a],this},$b.getData=function(){return d(kb[this.id]||{})},$b.hover=function(a,b,c,d){return this.mouseover(a,c).mouseout(b,d||c)},$b.unhover=function(a,b){return this.unmouseover(a).unmouseout(b)};var ac=[];$b.drag=function(a,d,e,f,g,h){function i(i){(i.originalEvent||i).preventDefault();var j=i.clientX,k=i.clientY,l=A.doc.documentElement.scrollTop||A.doc.body.scrollTop,m=A.doc.documentElement.scrollLeft||A.doc.body.scrollLeft;if(this._drag.id=i.identifier,F&&i.touches){for(var n,o=i.touches.length;o--;){if(n=i.touches[o],this._drag.id=n.identifier,n.identifier==this._drag.id){j=n.clientX,k=n.clientY;break}}}this._drag.x=j+m,this._drag.y=k+l,!Xb.length&&c.mousemove(Yb).mouseup(Zb),Xb.push({el:this,move_scope:f,start_scope:g,end_scope:h}),d&&b.on("raphael.drag.start."+this.id,d),a&&b.on("raphael.drag.move."+this.id,a),e&&b.on("raphael.drag.end."+this.id,e),b("raphael.drag.start."+this.id,g||f||this,i.clientX+m,i.clientY+l,i)}return this._drag={},ac.push({el:this,start:i}),this.mousedown(i),this},$b.onDragOver=function(a){a?b.on("raphael.drag.over."+this.id,a):b.unbind("raphael.drag.over."+this.id)},$b.undrag=function(){for(var a=ac.length;a--;){ac[a].el==this&&(this.unmousedown(ac[a].start),ac.splice(a,1),b.unbind("raphael.drag.*."+this.id))}!ac.length&&c.unmousemove(Yb).unmouseup(Zb),Xb=[]},v.circle=function(a,b,d){var e=c._engine.circle(this,a||0,b||0,d||0);return this.__set__&&this.__set__.push(e),e},v.rect=function(a,b,d,e,f){var g=c._engine.rect(this,a||0,b||0,d||0,e||0,f||0);return this.__set__&&this.__set__.push(g),g},v.ellipse=function(a,b,d,e){var f=c._engine.ellipse(this,a||0,b||0,d||0,e||0);return this.__set__&&this.__set__.push(f),f},v.path=function(a){a&&!c.is(a,U)&&!c.is(a[0],V)&&(a+=G);var b=c._engine.path(c.format[D](c,arguments),this);return this.__set__&&this.__set__.push(b),b},v.image=function(a,b,d,e,f){var g=c._engine.image(this,a||"about:blank",b||0,d||0,e||0,f||0);return this.__set__&&this.__set__.push(g),g},v.text=function(a,b,d){var e=c._engine.text(this,a||0,b||0,I(d));return this.__set__&&this.__set__.push(e),e},v.set=function(a){!c.is(a,"array")&&(a=Array.prototype.splice.call(arguments,0,arguments.length));var b=new mc(a);return this.__set__&&this.__set__.push(b),b.paper=this,b.type="set",b},v.setStart=function(a){this.__set__=a||this.set()},v.setFinish=function(){var a=this.__set__;return delete this.__set__,a},v.setSize=function(a,b){return c._engine.setSize.call(this,a,b)},v.setViewBox=function(a,b,d,e,f){return c._engine.setViewBox.call(this,a,b,d,e,f)},v.top=v.bottom=null,v.raphael=c;var bc=function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,g=e.clientLeft||d.clientLeft||0,h=b.top+(A.win.pageYOffset||e.scrollTop||d.scrollTop)-f,i=b.left+(A.win.pageXOffset||e.scrollLeft||d.scrollLeft)-g;return{y:h,x:i}};v.getElementByPoint=function(a,b){var c=this,d=c.canvas,e=A.doc.elementFromPoint(a,b);if(A.win.opera&&"svg"==e.tagName){var f=bc(d),g=d.createSVGRect();g.x=a-f.x,g.y=b-f.y,g.width=g.height=1;var h=d.getIntersectionList(g,null);h.length&&(e=h[h.length-1])}if(!e){return null}for(;e.parentNode&&e!=d.parentNode&&!e.raphael;){e=e.parentNode}return e==c.canvas.parentNode&&(e=d),e=e&&e.raphael?c.getById(e.raphaelid):null},v.getElementsByBBox=function(a){var b=this.set();return this.forEach(function(d){c.isBBoxIntersect(d.getBBox(),a)&&b.push(d)}),b},v.getById=function(a){for(var b=this.bottom;b;){if(b.id==a){return b}b=b.next}return null},v.forEach=function(a,b){for(var c=this.bottom;c;){if(a.call(b,c)===!1){return this}c=c.next}return this},v.getElementsByPoint=function(a,b){var c=this.set();return this.forEach(function(d){d.isPointInside(a,b)&&c.push(d)}),c},$b.isPointInside=function(a,b){var d=this.realPath=qb[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(d=c.transformPath(d,this.attr("transform"))),c.isPointInsidePath(d,a,b)},$b.getBBox=function(a){if(this.removed){return{}}var b=this._;return a?((b.dirty||!b.bboxwt)&&(this.realPath=qb[this.type](this),b.bboxwt=Bb(this.realPath),b.bboxwt.toString=p,b.dirty=0),b.bboxwt):((b.dirty||b.dirtyT||!b.bbox)&&((b.dirty||!this.realPath)&&(b.bboxwt=0,this.realPath=qb[this.type](this)),b.bbox=Bb(rb(this.realPath,this.matrix)),b.bbox.toString=p,b.dirty=b.dirtyT=0),b.bbox)},$b.clone=function(){if(this.removed){return null}var a=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(a),a},$b.glow=function(a){if("text"==this.type){return null}a=a||{};var b={width:(a.width||10)+(+this.attr("stroke-width")||1),fill:a.fill||!1,opacity:a.opacity||0.5,offsetx:a.offsetx||0,offsety:a.offsety||0,color:a.color||"#000"},c=b.width/2,d=this.paper,e=d.set(),f=this.realPath||qb[this.type](this);f=this.matrix?rb(f,this.matrix):f;for(var g=1;c+1>g;g++){e.push(d.path(f).attr({stroke:b.color,fill:b.fill?b.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(b.width/c*g).toFixed(3),opacity:+(b.opacity/c).toFixed(3)}))}return e.insertBefore(this).translate(b.offsetx,b.offsety)};var cc=function(a,b,d,e,f,g,h,i,l){return null==l?j(a,b,d,e,f,g,h,i):c.findDotsAtSegment(a,b,d,e,f,g,h,i,k(a,b,d,e,f,g,h,i,l))},dc=function(a,b){return function(d,e,f){d=Kb(d);for(var g,h,i,j,k,l="",m={},n=0,o=0,p=d.length;p>o;o++){if(i=d[o],"M"==i[0]){g=+i[1],h=+i[2]}else{if(j=cc(g,h,i[1],i[2],i[3],i[4],i[5],i[6]),n+j>e){if(b&&!m.start){if(k=cc(g,h,i[1],i[2],i[3],i[4],i[5],i[6],e-n),l+=["C"+k.start.x,k.start.y,k.m.x,k.m.y,k.x,k.y],f){return l}m.start=l,l=["M"+k.x,k.y+"C"+k.n.x,k.n.y,k.end.x,k.end.y,i[5],i[6]].join(),n+=j,g=+i[5],h=+i[6];continue}if(!a&&!b){return k=cc(g,h,i[1],i[2],i[3],i[4],i[5],i[6],e-n),{x:k.x,y:k.y,alpha:k.alpha}}}n+=j,g=+i[5],h=+i[6]}l+=i.shift()+i}return m.end=l,k=a?n:b?m:c.findDotsAtSegment(g,h,i[0],i[1],i[2],i[3],i[4],i[5],1),k.alpha&&(k={x:k.x,y:k.y,alpha:k.alpha}),k}},ec=dc(1),fc=dc(),gc=dc(0,1);c.getTotalLength=ec,c.getPointAtLength=fc,c.getSubpath=function(a,b,c){if(this.getTotalLength(a)-c<0.000001){return gc(a,b).end}var d=gc(a,c,1);return b?gc(d,b).end:d},$b.getTotalLength=function(){var a=this.getPath();if(a){return this.node.getTotalLength?this.node.getTotalLength():ec(a)}},$b.getPointAtLength=function(a){var b=this.getPath();if(b){return fc(b,a)}},$b.getPath=function(){var a,b=c._getPath[this.type];if("text"!=this.type&&"set"!=this.type){return b&&(a=b(this)),a}},$b.getSubpath=function(a,b){var d=this.getPath();if(d){return c.getSubpath(d,a,b)}};var hc=c.easing_formulas={linear:function(a){return a},"<":function(a){return R(a,1.7)},">":function(a){return R(a,0.48)},"<>":function(a){var b=0.48-a/1.04,c=N.sqrt(0.1734+b*b),d=c-b,e=R(Q(d),1/3)*(0>d?-1:1),f=-c-b,g=R(Q(f),1/3)*(0>f?-1:1),h=e+g+0.5;return 3*(1-h)*h*h+h*h*h},backIn:function(a){var b=1.70158;return a*a*((b+1)*a-b)},backOut:function(a){a-=1;var b=1.70158;return a*a*((b+1)*a+b)+1},elastic:function(a){return a==!!a?a:R(2,-10*a)*N.sin((a-0.075)*2*S/0.3)+1},bounce:function(a){var b,c=7.5625,d=2.75;return 1/d>a?b=c*a*a:2/d>a?(a-=1.5/d,b=c*a*a+0.75):2.5/d>a?(a-=2.25/d,b=c*a*a+0.9375):(a-=2.625/d,b=c*a*a+0.984375),b}};hc.easeIn=hc["ease-in"]=hc["<"],hc.easeOut=hc["ease-out"]=hc[">"],hc.easeInOut=hc["ease-in-out"]=hc["<>"],hc["back-in"]=hc.backIn,hc["back-out"]=hc.backOut;var ic=[],jc=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(a){setTimeout(a,16)},kc=function(){for(var a=+new Date,d=0;d<ic.length;d++){var e=ic[d];if(!e.el.removed&&!e.paused){var f,g,h=a-e.start,i=e.ms,j=e.easing,k=e.from,l=e.diff,m=e.to,n=(e.t,e.el),o={},p={};if(e.initstatus?(h=(e.initstatus*e.anim.top-e.prev)/(e.percent-e.prev)*i,e.status=e.initstatus,delete e.initstatus,e.stop&&ic.splice(d--,1)):e.status=(e.prev+(e.percent-e.prev)*(h/i))/e.anim.top,!(0>h)){if(i>h){var q=j(h/i);for(var r in k){if(k[z](r)){switch(db[r]){case T:f=+k[r]+q*i*l[r];break;case"colour":f="rgb("+[lc($(k[r].r+q*i*l[r].r)),lc($(k[r].g+q*i*l[r].g)),lc($(k[r].b+q*i*l[r].b))].join(",")+")";break;case"path":f=[];for(var t=0,u=k[r].length;u>t;t++){f[t]=[k[r][t][0]];for(var v=1,w=k[r][t].length;w>v;v++){f[t][v]=+k[r][t][v]+q*i*l[r][t][v]}f[t]=f[t].join(H)}f=f.join(H);break;case"transform":if(l[r].real){for(f=[],t=0,u=k[r].length;u>t;t++){for(f[t]=[k[r][t][0]],v=1,w=k[r][t].length;w>v;v++){f[t][v]=k[r][t][v]+q*i*l[r][t][v]}}}else{var x=function(a){return +k[r][a]+q*i*l[r][a]};f=[["m",x(0),x(1),x(2),x(3),x(4),x(5)]]}break;case"csv":if("clip-rect"==r){for(f=[],t=4;t--;){f[t]=+k[r][t]+q*i*l[r][t]}}break;default:var y=[][E](k[r]);for(f=[],t=n.paper.customAttributes[r].length;t--;){f[t]=+y[t]+q*i*l[r][t]}}o[r]=f}}n.attr(o),function(a,c,d){setTimeout(function(){b("raphael.anim.frame."+a,c,d)})}(n.id,n,e.anim)}else{if(function(a,d,e){setTimeout(function(){b("raphael.anim.frame."+d.id,d,e),b("raphael.anim.finish."+d.id,d,e),c.is(a,"function")&&a.call(d)})}(e.callback,n,e.anim),n.attr(m),ic.splice(d--,1),e.repeat>1&&!e.next){for(g in m){m[z](g)&&(p[g]=e.totalOrigin[g])}e.el.attr(p),s(e.anim,e.el,e.anim.percents[0],null,e.totalOrigin,e.repeat-1)}e.next&&!e.stop&&s(e.anim,e.el,e.next,null,e.totalOrigin,e.repeat)}}}}c.svg&&n&&n.paper&&n.paper.safari(),ic.length&&jc(kc)},lc=function(a){return a>255?255:0>a?0:a};$b.animateWith=function(a,b,d,e,f,g){var h=this;if(h.removed){return g&&g.call(h),h}var i=d instanceof r?d:c.animation(d,e,f,g);s(i,h,i.percents[0],null,h.attr());for(var j=0,k=ic.length;k>j;j++){if(ic[j].anim==b&&ic[j].el==a){ic[k-1].start=ic[j].start;break}}return h},$b.onAnimation=function(a){return a?b.on("raphael.anim.frame."+this.id,a):b.unbind("raphael.anim.frame."+this.id),this},r.prototype.delay=function(a){var b=new r(this.anim,this.ms);return b.times=this.times,b.del=+a||0,b},r.prototype.repeat=function(a){var b=new r(this.anim,this.ms);return b.del=this.del,b.times=N.floor(O(a,0))||1,b},c.animation=function(a,b,d,e){if(a instanceof r){return a}(c.is(d,"function")||!d)&&(e=e||d||null,d=null),a=Object(a),b=+b||0;var f,g,h={};for(g in a){a[z](g)&&_(g)!=g&&_(g)+"%"!=g&&(f=!0,h[g]=a[g])}return f?(d&&(h.easing=d),e&&(h.callback=e),new r({100:h},b)):new r(a,b)},$b.animate=function(a,b,d,e){var f=this;if(f.removed){return e&&e.call(f),f}var g=a instanceof r?a:c.animation(a,b,d,e);return s(g,f,g.percents[0],null,f.attr()),f},$b.setTime=function(a,b){return a&&null!=b&&this.status(a,P(b,a.ms)/a.ms),this},$b.status=function(a,b){var c,d,e=[],f=0;if(null!=b){return s(a,this,-1,P(b,1)),this}for(c=ic.length;c>f;f++){if(d=ic[f],d.el.id==this.id&&(!a||d.anim==a)){if(a){return d.status}e.push({anim:d.anim,status:d.status})}}return a?0:e},$b.pause=function(a){for(var c=0;c<ic.length;c++){ic[c].el.id!=this.id||a&&ic[c].anim!=a||b("raphael.anim.pause."+this.id,this,ic[c].anim)!==!1&&(ic[c].paused=!0)}return this},$b.resume=function(a){for(var c=0;c<ic.length;c++){if(ic[c].el.id==this.id&&(!a||ic[c].anim==a)){var d=ic[c];b("raphael.anim.resume."+this.id,this,d.anim)!==!1&&(delete d.paused,this.status(d.anim,d.status))}}return this},$b.stop=function(a){for(var c=0;c<ic.length;c++){ic[c].el.id!=this.id||a&&ic[c].anim!=a||b("raphael.anim.stop."+this.id,this,ic[c].anim)!==!1&&ic.splice(c--,1)}return this},b.on("raphael.remove",t),b.on("raphael.clear",t),$b.toString=function(){return"RaphaÃ«lâ€™s object"};var mc=function(a){if(this.items=[],this.length=0,this.type="set",a){for(var b=0,c=a.length;c>b;b++){!a[b]||a[b].constructor!=$b.constructor&&a[b].constructor!=mc||(this[this.items.length]=this.items[this.items.length]=a[b],this.length++)}}},nc=mc.prototype;nc.push=function(){for(var a,b,c=0,d=arguments.length;d>c;c++){a=arguments[c],!a||a.constructor!=$b.constructor&&a.constructor!=mc||(b=this.items.length,this[b]=this.items[b]=a,this.length++)}return this},nc.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},nc.forEach=function(a,b){for(var c=0,d=this.items.length;d>c;c++){if(a.call(b,this.items[c],c)===!1){return this}}return this};for(var oc in $b){$b[z](oc)&&(nc[oc]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a][D](c,b)})}}(oc))}return nc.attr=function(a,b){if(a&&c.is(a,V)&&c.is(a[0],"object")){for(var d=0,e=a.length;e>d;d++){this.items[d].attr(a[d])}}else{for(var f=0,g=this.items.length;g>f;f++){this.items[f].attr(a,b)}}return this},nc.clear=function(){for(;this.length;){this.pop()}},nc.splice=function(a,b){a=0>a?O(this.length+a,0):a,b=O(0,P(this.length-a,b));var c,d=[],e=[],f=[];for(c=2;c<arguments.length;c++){f.push(arguments[c])}for(c=0;b>c;c++){e.push(this[a+c])}for(;c<this.length-a;c++){d.push(this[a+c])}var g=f.length;for(c=0;c<g+d.length;c++){this.items[a+c]=this[a+c]=g>c?f[c]:d[c-g]}for(c=this.items.length=this.length-=b-g;this[c];){delete this[c++]}return new mc(e)},nc.exclude=function(a){for(var b=0,c=this.length;c>b;b++){if(this[b]==a){return this.splice(b,1),!0}}},nc.animate=function(a,b,d,e){(c.is(d,"function")||!d)&&(e=d||null);var f,g,h=this.items.length,i=h,j=this;if(!h){return this}e&&(g=function(){!--h&&e.call(j)}),d=c.is(d,U)?d:g;var k=c.animation(a,b,d,g);for(f=this.items[--i].animate(k);i--;){this.items[i]&&!this.items[i].removed&&this.items[i].animateWith(f,k,k),this.items[i]&&!this.items[i].removed||h--}return this},nc.insertAfter=function(a){for(var b=this.items.length;b--;){this.items[b].insertAfter(a)}return this},nc.getBBox=function(){for(var a=[],b=[],c=[],d=[],e=this.items.length;e--;){if(!this.items[e].removed){var f=this.items[e].getBBox();a.push(f.x),b.push(f.y),c.push(f.x+f.width),d.push(f.y+f.height)}}return a=P[D](0,a),b=P[D](0,b),c=O[D](0,c),d=O[D](0,d),{x:a,y:b,x2:c,y2:d,width:c-a,height:d-b}},nc.clone=function(a){a=this.paper.set();for(var b=0,c=this.items.length;c>b;b++){a.push(this.items[b].clone())}return a},nc.toString=function(){return"RaphaÃ«lâ€˜s set"},nc.glow=function(a){var b=this.paper.set();return this.forEach(function(c){var d=c.glow(a);null!=d&&d.forEach(function(a){b.push(a)})}),b},nc.isPointInside=function(a,b){var c=!1;return this.forEach(function(d){return d.isPointInside(a,b)?(console.log("runned"),c=!0,!1):void 0}),c},c.registerFont=function(a){if(!a.face){return a}this.fonts=this.fonts||{};var b={w:a.w,face:{},glyphs:{}},c=a.face["font-family"];for(var d in a.face){a.face[z](d)&&(b.face[d]=a.face[d])}if(this.fonts[c]?this.fonts[c].push(b):this.fonts[c]=[b],!a.svg){b.face["units-per-em"]=ab(a.face["units-per-em"],10);for(var e in a.glyphs){if(a.glyphs[z](e)){var f=a.glyphs[e];if(b.glyphs[e]={w:f.w,k:{},d:f.d&&"M"+f.d.replace(/[mlcxtrv]/g,function(a){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[a]||"M"})+"z"},f.k){for(var g in f.k){f[z](g)&&(b.glyphs[e].k[g]=f.k[g])}}}}}return a},v.getFont=function(a,b,d,e){if(e=e||"normal",d=d||"normal",b=+b||{normal:400,bold:700,lighter:300,bolder:800}[b]||400,c.fonts){var f=c.fonts[a];if(!f){var g=new RegExp("(^|\\s)"+a.replace(/[^\w\d\s+!~.:_-]/g,G)+"(\\s|$)","i");for(var h in c.fonts){if(c.fonts[z](h)&&g.test(h)){f=c.fonts[h];break}}}var i;if(f){for(var j=0,k=f.length;k>j&&(i=f[j],i.face["font-weight"]!=b||i.face["font-style"]!=d&&i.face["font-style"]||i.face["font-stretch"]!=e);j++){}}return i}},v.print=function(a,b,d,e,f,g,h,i){g=g||"middle",h=O(P(h||0,1),-1),i=O(P(i||1,3),1);var j,k=I(d)[J](G),l=0,m=0,n=G;if(c.is(e,"string")&&(e=this.getFont(e)),e){j=(f||16)/e.face["units-per-em"];for(var o=e.face.bbox[J](w),p=+o[0],q=o[3]-o[1],r=0,s=+o[1]+("baseline"==g?q+ +e.face.descent:q/2),t=0,u=k.length;u>t;t++){if("\n"==k[t]){l=0,x=0,m=0,r+=q*i}else{var v=m&&e.glyphs[k[t-1]]||{},x=e.glyphs[k[t]];l+=m?(v.w||e.w)+(v.k&&v.k[k[t]]||0)+e.w*h:0,m=1}x&&x.d&&(n+=c.transformPath(x.d,["t",l*j,r*j,"s",j,j,p,s,"t",(a-p)/j,(b-s)/j]))}}return this.path(n).attr({fill:"#000",stroke:"none"})},v.add=function(a){if(c.is(a,"array")){for(var b,d=this.set(),e=0,f=a.length;f>e;e++){b=a[e]||{},x[z](b.type)&&d.push(this[b.type]().attr(b))}}return d},c.format=function(a,b){var d=c.is(b,V)?[0][E](b):arguments;return a&&c.is(a,U)&&d.length-1&&(a=a.replace(y,function(a,b){return null==d[++b]?G:d[b]})),a||G},c.fullfill=function(){var a=/\{([^\}]+)\}/g,b=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,c=function(a,c,d){var e=d;return c.replace(b,function(a,b,c,d,f){b=b||d,e&&(b in e&&(e=e[b]),"function"==typeof e&&f&&(e=e()))}),e=(null==e||e==d?a:e)+""};return function(b,d){return String(b).replace(a,function(a,b){return c(a,b,d)})}}(),c.ninja=function(){return B.was?A.win.Raphael=B.is:delete Raphael,c},c.st=nc,function(a,b,d){function e(){/in/.test(a.readyState)?setTimeout(e,9):c.eve("raphael.DOMload")}null==a.readyState&&a.addEventListener&&(a.addEventListener(b,d=function(){a.removeEventListener(b,d,!1),a.readyState="complete"},!1),a.readyState="loading"),e()}(document,"DOMContentLoaded"),b.on("raphael.DOMload",function(){u=!0}),function(){if(c.svg){var a="hasOwnProperty",b=String,d=parseFloat,e=parseInt,f=Math,g=f.max,h=f.abs,i=f.pow,j=/[, ]+/,k=c.eve,l="",m=" ",n="http://www.w3.org/1999/xlink",o={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},p={};c.toString=function(){return"Your browser supports SVG.\nYou are running RaphaÃ«l "+this.version};var q=function(d,e){if(e){"string"==typeof d&&(d=q(d));for(var f in e){e[a](f)&&("xlink:"==f.substring(0,6)?d.setAttributeNS(n,f.substring(6),b(e[f])):d.setAttribute(f,b(e[f])))}}else{d=c._g.doc.createElementNS("http://www.w3.org/2000/svg",d),d.style&&(d.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return d},r=function(a,e){var j="linear",k=a.id+e,m=0.5,n=0.5,o=a.node,p=a.paper,r=o.style,s=c._g.doc.getElementById(k);if(!s){if(e=b(e).replace(c._radial_gradient,function(a,b,c){if(j="radial",b&&c){m=d(b),n=d(c);var e=2*(n>0.5)-1;i(m-0.5,2)+i(n-0.5,2)>0.25&&(n=f.sqrt(0.25-i(m-0.5,2))*e+0.5)&&0.5!=n&&(n=n.toFixed(5)-0.00001*e)}return l}),e=e.split(/\s*\-\s*/),"linear"==j){var t=e.shift();if(t=-d(t),isNaN(t)){return null}var u=[0,0,f.cos(c.rad(t)),f.sin(c.rad(t))],v=1/(g(h(u[2]),h(u[3]))||1);u[2]*=v,u[3]*=v,u[2]<0&&(u[0]=-u[2],u[2]=0),u[3]<0&&(u[1]=-u[3],u[3]=0)}var w=c._parseDots(e);if(!w){return null}if(k=k.replace(/[\(\)\s,\xb0#]/g,"_"),a.gradient&&k!=a.gradient.id&&(p.defs.removeChild(a.gradient),delete a.gradient),!a.gradient){s=q(j+"Gradient",{id:k}),a.gradient=s,q(s,"radial"==j?{fx:m,fy:n}:{x1:u[0],y1:u[1],x2:u[2],y2:u[3],gradientTransform:a.matrix.invert()}),p.defs.appendChild(s);for(var x=0,y=w.length;y>x;x++){s.appendChild(q("stop",{offset:w[x].offset?w[x].offset:x?"100%":"0%","stop-color":w[x].color||"#fff"}))}}}return q(o,{fill:"url(#"+k+")",opacity:1,"fill-opacity":1}),r.fill=l,r.opacity=1,r.fillOpacity=1,1},s=function(a){var b=a.getBBox(1);q(a.pattern,{patternTransform:a.matrix.invert()+" translate("+b.x+","+b.y+")"})},t=function(d,e,f){if("path"==d.type){for(var g,h,i,j,k,m=b(e).toLowerCase().split("-"),n=d.paper,r=f?"end":"start",s=d.node,t=d.attrs,u=t["stroke-width"],v=m.length,w="classic",x=3,y=3,z=5;v--;){switch(m[v]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":w=m[v];break;case"wide":y=5;break;case"narrow":y=2;break;case"long":x=5;break;case"short":x=2}}if("open"==w?(x+=2,y+=2,z+=2,i=1,j=f?4:1,k={fill:"none",stroke:t.stroke}):(j=i=x/2,k={fill:t.stroke,stroke:"none"}),d._.arrows?f?(d._.arrows.endPath&&p[d._.arrows.endPath]--,d._.arrows.endMarker&&p[d._.arrows.endMarker]--):(d._.arrows.startPath&&p[d._.arrows.startPath]--,d._.arrows.startMarker&&p[d._.arrows.startMarker]--):d._.arrows={},"none"!=w){var A="raphael-marker-"+w,B="raphael-marker-"+r+w+x+y;c._g.doc.getElementById(A)?p[A]++:(n.defs.appendChild(q(q("path"),{"stroke-linecap":"round",d:o[w],id:A})),p[A]=1);var C,D=c._g.doc.getElementById(B);D?(p[B]++,C=D.getElementsByTagName("use")[0]):(D=q(q("marker"),{id:B,markerHeight:y,markerWidth:x,orient:"auto",refX:j,refY:y/2}),C=q(q("use"),{"xlink:href":"#"+A,transform:(f?"rotate(180 "+x/2+" "+y/2+") ":l)+"scale("+x/z+","+y/z+")","stroke-width":(1/((x/z+y/z)/2)).toFixed(4)}),D.appendChild(C),n.defs.appendChild(D),p[B]=1),q(C,k);var E=i*("diamond"!=w&&"oval"!=w);f?(g=d._.arrows.startdx*u||0,h=c.getTotalLength(t.path)-E*u):(g=E*u,h=c.getTotalLength(t.path)-(d._.arrows.enddx*u||0)),k={},k["marker-"+r]="url(#"+B+")",(h||g)&&(k.d=c.getSubpath(t.path,g,h)),q(s,k),d._.arrows[r+"Path"]=A,d._.arrows[r+"Marker"]=B,d._.arrows[r+"dx"]=E,d._.arrows[r+"Type"]=w,d._.arrows[r+"String"]=e}else{f?(g=d._.arrows.startdx*u||0,h=c.getTotalLength(t.path)-g):(g=0,h=c.getTotalLength(t.path)-(d._.arrows.enddx*u||0)),d._.arrows[r+"Path"]&&q(s,{d:c.getSubpath(t.path,g,h)}),delete d._.arrows[r+"Path"],delete d._.arrows[r+"Marker"],delete d._.arrows[r+"dx"],delete d._.arrows[r+"Type"],delete d._.arrows[r+"String"]}for(k in p){if(p[a](k)&&!p[k]){var F=c._g.doc.getElementById(k);F&&F.parentNode.removeChild(F)}}}},u={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},v=function(a,c,d){if(c=u[b(c).toLowerCase()]){for(var e=a.attrs["stroke-width"]||"1",f={round:e,square:e,butt:0}[a.attrs["stroke-linecap"]||d["stroke-linecap"]]||0,g=[],h=c.length;h--;){g[h]=c[h]*e+(h%2?1:-1)*f}q(a.node,{"stroke-dasharray":g.join(",")})}},w=function(d,f){var i=d.node,k=d.attrs,m=i.style.visibility;i.style.visibility="hidden";for(var o in f){if(f[a](o)){if(!c._availableAttrs[a](o)){continue}var p=f[o];switch(k[o]=p,o){case"blur":d.blur(p);break;case"href":case"title":var u=q("title"),w=c._g.doc.createTextNode(p);u.appendChild(w),i.appendChild(u);break;case"target":var x=i.parentNode;if("a"!=x.tagName.toLowerCase()){var u=q("a");x.insertBefore(u,i),u.appendChild(i),x=u}"target"==o?x.setAttributeNS(n,"show","blank"==p?"new":p):x.setAttributeNS(n,o,p);break;case"cursor":i.style.cursor=p;break;case"transform":d.transform(p);break;case"arrow-start":t(d,p);break;case"arrow-end":t(d,p,1);break;case"clip-rect":var z=b(p).split(j);if(4==z.length){d.clip&&d.clip.parentNode.parentNode.removeChild(d.clip.parentNode);var A=q("clipPath"),B=q("rect");A.id=c.createUUID(),q(B,{x:z[0],y:z[1],width:z[2],height:z[3]}),A.appendChild(B),d.paper.defs.appendChild(A),q(i,{"clip-path":"url(#"+A.id+")"}),d.clip=B}if(!p){var C=i.getAttribute("clip-path");if(C){var D=c._g.doc.getElementById(C.replace(/(^url\(#|\)$)/g,l));D&&D.parentNode.removeChild(D),q(i,{"clip-path":l}),delete d.clip}}break;case"path":"path"==d.type&&(q(i,{d:p?k.path=c._pathToAbsolute(p):"M0,0"}),d._.dirty=1,d._.arrows&&("startString" in d._.arrows&&t(d,d._.arrows.startString),"endString" in d._.arrows&&t(d,d._.arrows.endString,1)));break;case"width":if(i.setAttribute(o,p),d._.dirty=1,!k.fx){break}o="x",p=k.x;case"x":k.fx&&(p=-k.x-(k.width||0));case"rx":if("rx"==o&&"rect"==d.type){break}case"cx":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case"height":if(i.setAttribute(o,p),d._.dirty=1,!k.fy){break}o="y",p=k.y;case"y":k.fy&&(p=-k.y-(k.height||0));case"ry":if("ry"==o&&"rect"==d.type){break}case"cy":i.setAttribute(o,p),d.pattern&&s(d),d._.dirty=1;break;case"r":"rect"==d.type?q(i,{rx:p,ry:p}):i.setAttribute(o,p),d._.dirty=1;break;case"src":"image"==d.type&&i.setAttributeNS(n,"href",p);break;case"stroke-width":(1!=d._.sx||1!=d._.sy)&&(p/=g(h(d._.sx),h(d._.sy))||1),d.paper._vbSize&&(p*=d.paper._vbSize),i.setAttribute(o,p),k["stroke-dasharray"]&&v(d,k["stroke-dasharray"],f),d._.arrows&&("startString" in d._.arrows&&t(d,d._.arrows.startString),"endString" in d._.arrows&&t(d,d._.arrows.endString,1));break;case"stroke-dasharray":v(d,p,f);break;case"fill":var E=b(p).match(c._ISURL);if(E){A=q("pattern");var F=q("image");A.id=c.createUUID(),q(A,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),q(F,{x:0,y:0,"xlink:href":E[1]}),A.appendChild(F),function(a){c._preload(E[1],function(){var b=this.offsetWidth,c=this.offsetHeight;q(a,{width:b,height:c}),q(F,{width:b,height:c}),d.paper.safari()})}(A),d.paper.defs.appendChild(A),q(i,{fill:"url(#"+A.id+")"}),d.pattern=A,d.pattern&&s(d);break}var G=c.getRGB(p);if(G.error){if(("circle"==d.type||"ellipse"==d.type||"r"!=b(p).charAt())&&r(d,p)){if("opacity" in k||"fill-opacity" in k){var H=c._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g,l));if(H){var I=H.getElementsByTagName("stop");q(I[I.length-1],{"stop-opacity":("opacity" in k?k.opacity:1)*("fill-opacity" in k?k["fill-opacity"]:1)})}}k.gradient=p,k.fill="none";break}}else{delete f.gradient,delete k.gradient,!c.is(k.opacity,"undefined")&&c.is(f.opacity,"undefined")&&q(i,{opacity:k.opacity}),!c.is(k["fill-opacity"],"undefined")&&c.is(f["fill-opacity"],"undefined")&&q(i,{"fill-opacity":k["fill-opacity"]})}G[a]("opacity")&&q(i,{"fill-opacity":G.opacity>1?G.opacity/100:G.opacity});case"stroke":G=c.getRGB(p),i.setAttribute(o,G.hex),"stroke"==o&&G[a]("opacity")&&q(i,{"stroke-opacity":G.opacity>1?G.opacity/100:G.opacity}),"stroke"==o&&d._.arrows&&("startString" in d._.arrows&&t(d,d._.arrows.startString),"endString" in d._.arrows&&t(d,d._.arrows.endString,1));break;case"gradient":("circle"==d.type||"ellipse"==d.type||"r"!=b(p).charAt())&&r(d,p);break;case"opacity":k.gradient&&!k[a]("stroke-opacity")&&q(i,{"stroke-opacity":p>1?p/100:p});case"fill-opacity":if(k.gradient){H=c._g.doc.getElementById(i.getAttribute("fill").replace(/^url\(#|\)$/g,l)),H&&(I=H.getElementsByTagName("stop"),q(I[I.length-1],{"stop-opacity":p}));break}default:"font-size"==o&&(p=e(p,10)+"px");var J=o.replace(/(\-.)/g,function(a){return a.substring(1).toUpperCase()});i.style[J]=p,d._.dirty=1,i.setAttribute(o,p)}}}y(d,f),i.style.visibility=m},x=1.2,y=function(d,f){if("text"==d.type&&(f[a]("text")||f[a]("font")||f[a]("font-size")||f[a]("x")||f[a]("y"))){var g=d.attrs,h=d.node,i=h.firstChild?e(c._g.doc.defaultView.getComputedStyle(h.firstChild,l).getPropertyValue("font-size"),10):10;if(f[a]("text")){for(g.text=f.text;h.firstChild;){h.removeChild(h.firstChild)}for(var j,k=b(f.text).split("\n"),m=[],n=0,o=k.length;o>n;n++){j=q("tspan"),n&&q(j,{dy:i*x,x:g.x}),j.appendChild(c._g.doc.createTextNode(k[n])),h.appendChild(j),m[n]=j}}else{for(m=h.getElementsByTagName("tspan"),n=0,o=m.length;o>n;n++){n?q(m[n],{dy:i*x,x:g.x}):q(m[0],{dy:0})}}q(h,{x:g.x,y:g.y}),d._.dirty=1;var p=d._getBBox(),r=g.y-(p.y+p.height/2);r&&c.is(r,"finite")&&q(m[0],{dy:r})}},z=function(a,b){this[0]=this.node=a,a.raphael=!0,this.id=c._oid++,a.raphaelid=this.id,this.matrix=c.matrix(),this.realPath=null,this.paper=b,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!b.bottom&&(b.bottom=this),this.prev=b.top,b.top&&(b.top.next=this),b.top=this,this.next=null},A=c.el;z.prototype=A,A.constructor=z,c._engine.path=function(a,b){var c=q("path");b.canvas&&b.canvas.appendChild(c);var d=new z(c,b);return d.type="path",w(d,{fill:"none",stroke:"#000",path:a}),d},A.rotate=function(a,c,e){if(this.removed){return this}if(a=b(a).split(j),a.length-1&&(c=d(a[1]),e=d(a[2])),a=d(a[0]),null==e&&(c=e),null==c||null==e){var f=this.getBBox(1);c=f.x+f.width/2,e=f.y+f.height/2}return this.transform(this._.transform.concat([["r",a,c,e]])),this},A.scale=function(a,c,e,f){if(this.removed){return this}if(a=b(a).split(j),a.length-1&&(c=d(a[1]),e=d(a[2]),f=d(a[3])),a=d(a[0]),null==c&&(c=a),null==f&&(e=f),null==e||null==f){var g=this.getBBox(1)}return e=null==e?g.x+g.width/2:e,f=null==f?g.y+g.height/2:f,this.transform(this._.transform.concat([["s",a,c,e,f]])),this},A.translate=function(a,c){return this.removed?this:(a=b(a).split(j),a.length-1&&(c=d(a[1])),a=d(a[0])||0,c=+c||0,this.transform(this._.transform.concat([["t",a,c]])),this)},A.transform=function(b){var d=this._;if(null==b){return d.transform}if(c._extractTransform(this,b),this.clip&&q(this.clip,{transform:this.matrix.invert()}),this.pattern&&s(this),this.node&&q(this.node,{transform:this.matrix}),1!=d.sx||1!=d.sy){var e=this.attrs[a]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":e})}return this},A.hide=function(){return !this.removed&&this.paper.safari(this.node.style.display="none"),this},A.show=function(){return !this.removed&&this.paper.safari(this.node.style.display=""),this},A.remove=function(){if(!this.removed&&this.node.parentNode){var a=this.paper;a.__set__&&a.__set__.exclude(this),k.unbind("raphael.*.*."+this.id),this.gradient&&a.defs.removeChild(this.gradient),c._tear(this,a),"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var b in this){this[b]="function"==typeof this[b]?c._removedFactory(b):null}this.removed=!0}},A._getBBox=function(){if("none"==this.node.style.display){this.show();var a=!0}var b={};try{b=this.node.getBBox()}catch(c){}finally{b=b||{}}return a&&this.hide(),b},A.attr=function(b,d){if(this.removed){return this}if(null==b){var e={};for(var f in this.attrs){this.attrs[a](f)&&(e[f]=this.attrs[f])}return e.gradient&&"none"==e.fill&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform,e}if(null==d&&c.is(b,"string")){if("fill"==b&&"none"==this.attrs.fill&&this.attrs.gradient){return this.attrs.gradient}if("transform"==b){return this._.transform}for(var g=b.split(j),h={},i=0,l=g.length;l>i;i++){b=g[i],h[b]=b in this.attrs?this.attrs[b]:c.is(this.paper.customAttributes[b],"function")?this.paper.customAttributes[b].def:c._availableAttrs[b]}return l-1?h:h[g[0]]}if(null==d&&c.is(b,"array")){for(h={},i=0,l=b.length;l>i;i++){h[b[i]]=this.attr(b[i])}return h}if(null!=d){var m={};m[b]=d}else{null!=b&&c.is(b,"object")&&(m=b)}for(var n in m){k("raphael.attr."+n+"."+this.id,this,m[n])}for(n in this.paper.customAttributes){if(this.paper.customAttributes[a](n)&&m[a](n)&&c.is(this.paper.customAttributes[n],"function")){var o=this.paper.customAttributes[n].apply(this,[].concat(m[n]));this.attrs[n]=m[n];for(var p in o){o[a](p)&&(m[p]=o[p])}}}return w(this,m),this},A.toFront=function(){if(this.removed){return this}"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var a=this.paper;return a.top!=this&&c._tofront(this,a),this},A.toBack=function(){if(this.removed){return this}var a=this.node.parentNode;return"a"==a.tagName.toLowerCase()?a.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):a.firstChild!=this.node&&a.insertBefore(this.node,this.node.parentNode.firstChild),c._toback(this,this.paper),this.paper,this},A.insertAfter=function(a){if(this.removed){return this}var b=a.node||a[a.length-1].node;return b.nextSibling?b.parentNode.insertBefore(this.node,b.nextSibling):b.parentNode.appendChild(this.node),c._insertafter(this,a,this.paper),this},A.insertBefore=function(a){if(this.removed){return this}var b=a.node||a[0].node;return b.parentNode.insertBefore(this.node,b),c._insertbefore(this,a,this.paper),this},A.blur=function(a){var b=this;if(0!==+a){var d=q("filter"),e=q("feGaussianBlur");b.attrs.blur=a,d.id=c.createUUID(),q(e,{stdDeviation:+a||1.5}),d.appendChild(e),b.paper.defs.appendChild(d),b._blur=d,q(b.node,{filter:"url(#"+d.id+")"})}else{b._blur&&(b._blur.parentNode.removeChild(b._blur),delete b._blur,delete b.attrs.blur),b.node.removeAttribute("filter")}return b},c._engine.circle=function(a,b,c,d){var e=q("circle");a.canvas&&a.canvas.appendChild(e);var f=new z(e,a);return f.attrs={cx:b,cy:c,r:d,fill:"none",stroke:"#000"},f.type="circle",q(e,f.attrs),f},c._engine.rect=function(a,b,c,d,e,f){var g=q("rect");a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);return h.attrs={x:b,y:c,width:d,height:e,r:f||0,rx:f||0,ry:f||0,fill:"none",stroke:"#000"},h.type="rect",q(g,h.attrs),h},c._engine.ellipse=function(a,b,c,d,e){var f=q("ellipse");a.canvas&&a.canvas.appendChild(f);var g=new z(f,a);return g.attrs={cx:b,cy:c,rx:d,ry:e,fill:"none",stroke:"#000"},g.type="ellipse",q(f,g.attrs),g},c._engine.image=function(a,b,c,d,e,f){var g=q("image");q(g,{x:c,y:d,width:e,height:f,preserveAspectRatio:"none"}),g.setAttributeNS(n,"href",b),a.canvas&&a.canvas.appendChild(g);var h=new z(g,a);return h.attrs={x:c,y:d,width:e,height:f,src:b},h.type="image",h},c._engine.text=function(a,b,d,e){var f=q("text");a.canvas&&a.canvas.appendChild(f);var g=new z(f,a);return g.attrs={x:b,y:d,"text-anchor":"middle",text:e,font:c._availableAttrs.font,stroke:"none",fill:"#000"},g.type="text",w(g,g.attrs),g},c._engine.setSize=function(a,b){return this.width=a||this.width,this.height=b||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},c._engine.create=function(){var a=c._getContainer.apply(0,arguments),b=a&&a.container,d=a.x,e=a.y,f=a.width,g=a.height;if(!b){throw new Error("SVG container not found.")}var h,i=q("svg"),j="overflow:hidden;";return d=d||0,e=e||0,f=f||512,g=g||342,q(i,{height:g,version:1.1,width:f,xmlns:"http://www.w3.org/2000/svg"}),1==b?(i.style.cssText=j+"position:absolute;left:"+d+"px;top:"+e+"px",c._g.doc.body.appendChild(i),h=1):(i.style.cssText=j+"position:relative",b.firstChild?b.insertBefore(i,b.firstChild):b.appendChild(i)),b=new c._Paper,b.width=f,b.height=g,b.canvas=i,b.clear(),b._left=b._top=0,h&&(b.renderfix=function(){}),b.renderfix(),b},c._engine.setViewBox=function(a,b,c,d,e){k("raphael.setViewBox",this,this._viewBox,[a,b,c,d,e]);var f,h,i=g(c/this.width,d/this.height),j=this.top,l=e?"meet":"xMinYMin";for(null==a?(this._vbSize&&(i=1),delete this._vbSize,f="0 0 "+this.width+m+this.height):(this._vbSize=i,f=a+m+b+m+c+m+d),q(this.canvas,{viewBox:f,preserveAspectRatio:l});i&&j;){h="stroke-width" in j.attrs?j.attrs["stroke-width"]:1,j.attr({"stroke-width":h}),j._.dirty=1,j._.dirtyT=1,j=j.prev}return this._viewBox=[a,b,c,d,!!e],this},c.prototype.renderfix=function(){var a,b=this.canvas,c=b.style;try{a=b.getScreenCTM()||b.createSVGMatrix()}catch(d){a=b.createSVGMatrix()}var e=-a.e%1,f=-a.f%1;(e||f)&&(e&&(this._left=(this._left+e)%1,c.left=this._left+"px"),f&&(this._top=(this._top+f)%1,c.top=this._top+"px"))},c.prototype.clear=function(){c.eve("raphael.clear",this);for(var a=this.canvas;a.firstChild;){a.removeChild(a.firstChild)}this.bottom=this.top=null,(this.desc=q("desc")).appendChild(c._g.doc.createTextNode("Created with RaphaÃ«l "+c.version)),a.appendChild(this.desc),a.appendChild(this.defs=q("defs"))},c.prototype.remove=function(){k("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]="function"==typeof this[a]?c._removedFactory(a):null}};var B=c.st;for(var C in A){A[a](C)&&!B[a](C)&&(B[C]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(C))}}}(),function(){if(c.vml){var a="hasOwnProperty",b=String,d=parseFloat,e=Math,f=e.round,g=e.max,h=e.min,i=e.abs,j="fill",k=/[, ]+/,l=c.eve,m=" progid:DXImageTransform.Microsoft",n=" ",o="",p={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},q=/([clmz]),?([^clmz]*)/gi,r=/ progid:\S+Blur\([^\)]+\)/g,s=/-?[^,\s-]+/g,t="position:absolute;left:0;top:0;width:1px;height:1px",u=21600,v={path:1,rect:1,image:1},w={circle:1,ellipse:1},x=function(a){var d=/[ahqstv]/gi,e=c._pathToAbsolute;if(b(a).match(d)&&(e=c._path2curve),d=/[clmz]/g,e==c._pathToAbsolute&&!b(a).match(d)){var g=b(a).replace(q,function(a,b,c){var d=[],e="m"==b.toLowerCase(),g=p[b];return c.replace(s,function(a){e&&2==d.length&&(g+=d+p["m"==b?"l":"L"],d=[]),d.push(f(a*u))}),g+d});return g}var h,i,j=e(a);g=[];for(var k=0,l=j.length;l>k;k++){h=j[k],i=j[k][0].toLowerCase(),"z"==i&&(i="x");for(var m=1,r=h.length;r>m;m++){i+=f(h[m]*u)+(m!=r-1?",":o)}g.push(i)}return g.join(n)},y=function(a,b,d){var e=c.matrix();return e.rotate(-a,0.5,0.5),{dx:e.x(b,d),dy:e.y(b,d)}},z=function(a,b,c,d,e,f){var g=a._,h=a.matrix,k=g.fillpos,l=a.node,m=l.style,o=1,p="",q=u/b,r=u/c;if(m.visibility="hidden",b&&c){if(l.coordsize=i(q)+n+i(r),m.rotation=f*(0>b*c?-1:1),f){var s=y(f,d,e);d=s.dx,e=s.dy}if(0>b&&(p+="x"),0>c&&(p+=" y")&&(o=-1),m.flip=p,l.coordorigin=d*-q+n+e*-r,k||g.fillsize){var t=l.getElementsByTagName(j);t=t&&t[0],l.removeChild(t),k&&(s=y(f,h.x(k[0],k[1]),h.y(k[0],k[1])),t.position=s.dx*o+n+s.dy*o),g.fillsize&&(t.size=g.fillsize[0]*i(b)+n+g.fillsize[1]*i(c)),l.appendChild(t)}m.visibility="visible"}};c.toString=function(){return"Your browser doesnâ€™t support SVG. Falling down to VML.\nYou are running RaphaÃ«l "+this.version};var A=function(a,c,d){for(var e=b(c).toLowerCase().split("-"),f=d?"end":"start",g=e.length,h="classic",i="medium",j="medium";g--;){switch(e[g]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":h=e[g];break;case"wide":case"narrow":j=e[g];break;case"long":case"short":i=e[g]}}var k=a.node.getElementsByTagName("stroke")[0];k[f+"arrow"]=h,k[f+"arrowlength"]=i,k[f+"arrowwidth"]=j},B=function(e,i){e.attrs=e.attrs||{};var l=e.node,m=e.attrs,p=l.style,q=v[e.type]&&(i.x!=m.x||i.y!=m.y||i.width!=m.width||i.height!=m.height||i.cx!=m.cx||i.cy!=m.cy||i.rx!=m.rx||i.ry!=m.ry||i.r!=m.r),r=w[e.type]&&(m.cx!=i.cx||m.cy!=i.cy||m.r!=i.r||m.rx!=i.rx||m.ry!=i.ry),s=e;for(var t in i){i[a](t)&&(m[t]=i[t])}if(q&&(m.path=c._getPath[e.type](e),e._.dirty=1),i.href&&(l.href=i.href),i.title&&(l.title=i.title),i.target&&(l.target=i.target),i.cursor&&(p.cursor=i.cursor),"blur" in i&&e.blur(i.blur),(i.path&&"path"==e.type||q)&&(l.path=x(~b(m.path).toLowerCase().indexOf("r")?c._pathToAbsolute(m.path):m.path),"image"==e.type&&(e._.fillpos=[m.x,m.y],e._.fillsize=[m.width,m.height],z(e,1,1,0,0,0))),"transform" in i&&e.transform(i.transform),r){var y=+m.cx,B=+m.cy,D=+m.rx||+m.r||0,E=+m.ry||+m.r||0;l.path=c.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",f((y-D)*u),f((B-E)*u),f((y+D)*u),f((B+E)*u),f(y*u)),e._.dirty=1}if("clip-rect" in i){var G=b(i["clip-rect"]).split(k);if(4==G.length){G[2]=+G[2]+ +G[0],G[3]=+G[3]+ +G[1];var H=l.clipRect||c._g.doc.createElement("div"),I=H.style;I.clip=c.format("rect({1}px {2}px {3}px {0}px)",G),l.clipRect||(I.position="absolute",I.top=0,I.left=0,I.width=e.paper.width+"px",I.height=e.paper.height+"px",l.parentNode.insertBefore(H,l),H.appendChild(l),l.clipRect=H)}i["clip-rect"]||l.clipRect&&(l.clipRect.style.clip="auto")}if(e.textpath){var J=e.textpath.style;i.font&&(J.font=i.font),i["font-family"]&&(J.fontFamily='"'+i["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,o)+'"'),i["font-size"]&&(J.fontSize=i["font-size"]),i["font-weight"]&&(J.fontWeight=i["font-weight"]),i["font-style"]&&(J.fontStyle=i["font-style"])}if("arrow-start" in i&&A(s,i["arrow-start"]),"arrow-end" in i&&A(s,i["arrow-end"],1),null!=i.opacity||null!=i["stroke-width"]||null!=i.fill||null!=i.src||null!=i.stroke||null!=i["stroke-width"]||null!=i["stroke-opacity"]||null!=i["fill-opacity"]||null!=i["stroke-dasharray"]||null!=i["stroke-miterlimit"]||null!=i["stroke-linejoin"]||null!=i["stroke-linecap"]){var K=l.getElementsByTagName(j),L=!1;if(K=K&&K[0],!K&&(L=K=F(j)),"image"==e.type&&i.src&&(K.src=i.src),i.fill&&(K.on=!0),(null==K.on||"none"==i.fill||null===i.fill)&&(K.on=!1),K.on&&i.fill){var M=b(i.fill).match(c._ISURL);if(M){K.parentNode==l&&l.removeChild(K),K.rotate=!0,K.src=M[1],K.type="tile";var N=e.getBBox(1);K.position=N.x+n+N.y,e._.fillpos=[N.x,N.y],c._preload(M[1],function(){e._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{K.color=c.getRGB(i.fill).hex,K.src=o,K.type="solid",c.getRGB(i.fill).error&&(s.type in {circle:1,ellipse:1}||"r"!=b(i.fill).charAt())&&C(s,i.fill,K)&&(m.fill="none",m.gradient=i.fill,K.rotate=!1)}}if("fill-opacity" in i||"opacity" in i){var O=((+m["fill-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+c.getRGB(i.fill).o+1||2)-1);O=h(g(O,0),1),K.opacity=O,K.src&&(K.color="none")}l.appendChild(K);var P=l.getElementsByTagName("stroke")&&l.getElementsByTagName("stroke")[0],Q=!1;!P&&(Q=P=F("stroke")),(i.stroke&&"none"!=i.stroke||i["stroke-width"]||null!=i["stroke-opacity"]||i["stroke-dasharray"]||i["stroke-miterlimit"]||i["stroke-linejoin"]||i["stroke-linecap"])&&(P.on=!0),("none"==i.stroke||null===i.stroke||null==P.on||0==i.stroke||0==i["stroke-width"])&&(P.on=!1);var R=c.getRGB(i.stroke);P.on&&i.stroke&&(P.color=R.hex),O=((+m["stroke-opacity"]+1||2)-1)*((+m.opacity+1||2)-1)*((+R.o+1||2)-1);var S=0.75*(d(i["stroke-width"])||1);if(O=h(g(O,0),1),null==i["stroke-width"]&&(S=m["stroke-width"]),i["stroke-width"]&&(P.weight=S),S&&1>S&&(O*=S)&&(P.weight=1),P.opacity=O,i["stroke-linejoin"]&&(P.joinstyle=i["stroke-linejoin"]||"miter"),P.miterlimit=i["stroke-miterlimit"]||8,i["stroke-linecap"]&&(P.endcap="butt"==i["stroke-linecap"]?"flat":"square"==i["stroke-linecap"]?"square":"round"),i["stroke-dasharray"]){var T={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};P.dashstyle=T[a](i["stroke-dasharray"])?T[i["stroke-dasharray"]]:o}Q&&l.appendChild(P)}if("text"==s.type){s.paper.canvas.style.display=o;var U=s.paper.span,V=100,W=m.font&&m.font.match(/\d+(?:\.\d*)?(?=px)/);p=U.style,m.font&&(p.font=m.font),m["font-family"]&&(p.fontFamily=m["font-family"]),m["font-weight"]&&(p.fontWeight=m["font-weight"]),m["font-style"]&&(p.fontStyle=m["font-style"]),W=d(m["font-size"]||W&&W[0])||10,p.fontSize=W*V+"px",s.textpath.string&&(U.innerHTML=b(s.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var X=U.getBoundingClientRect();s.W=m.w=(X.right-X.left)/V,s.H=m.h=(X.bottom-X.top)/V,s.X=m.x,s.Y=m.y+s.H/2,("x" in i||"y" in i)&&(s.path.v=c.format("m{0},{1}l{2},{1}",f(m.x*u),f(m.y*u),f(m.x*u)+1));for(var Y=["x","y","text","font","font-family","font-weight","font-style","font-size"],Z=0,$=Y.length;$>Z;Z++){if(Y[Z] in i){s._.dirty=1;break}}switch(m["text-anchor"]){case"start":s.textpath.style["v-text-align"]="left",s.bbx=s.W/2;break;case"end":s.textpath.style["v-text-align"]="right",s.bbx=-s.W/2;break;default:s.textpath.style["v-text-align"]="center",s.bbx=0}s.textpath.style["v-text-kern"]=!0}},C=function(a,f,g){a.attrs=a.attrs||{};var h=(a.attrs,Math.pow),i="linear",j=".5 .5";if(a.attrs.gradient=f,f=b(f).replace(c._radial_gradient,function(a,b,c){return i="radial",b&&c&&(b=d(b),c=d(c),h(b-0.5,2)+h(c-0.5,2)>0.25&&(c=e.sqrt(0.25-h(b-0.5,2))*(2*(c>0.5)-1)+0.5),j=b+n+c),o}),f=f.split(/\s*\-\s*/),"linear"==i){var k=f.shift();if(k=-d(k),isNaN(k)){return null}}var l=c._parseDots(f);if(!l){return null}if(a=a.shape||a.node,l.length){a.removeChild(g),g.on=!0,g.method="none",g.color=l[0].color,g.color2=l[l.length-1].color;for(var m=[],p=0,q=l.length;q>p;p++){l[p].offset&&m.push(l[p].offset+n+l[p].color)}g.colors=m.length?m.join():"0% "+g.color,"radial"==i?(g.type="gradientTitle",g.focus="100%",g.focussize="0 0",g.focusposition=j,g.angle=0):(g.type="gradient",g.angle=(270-k)%360),a.appendChild(g)}return 1},D=function(a,b){this[0]=this.node=a,a.raphael=!0,this.id=c._oid++,a.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=b,this.matrix=c.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!b.bottom&&(b.bottom=this),this.prev=b.top,b.top&&(b.top.next=this),b.top=this,this.next=null},E=c.el;D.prototype=E,E.constructor=D,E.transform=function(a){if(null==a){return this._.transform}var d,e=this.paper._viewBoxShift,f=e?"s"+[e.scale,e.scale]+"-1-1t"+[e.dx,e.dy]:o;e&&(d=a=b(a).replace(/\.{3}|\u2026/g,this._.transform||o)),c._extractTransform(this,f+a);var g,h=this.matrix.clone(),i=this.skew,j=this.node,k=~b(this.attrs.fill).indexOf("-"),l=!b(this.attrs.fill).indexOf("url(");if(h.translate(1,1),l||k||"image"==this.type){if(i.matrix="1 0 0 1",i.offset="0 0",g=h.split(),k&&g.noRotation||!g.isSimple){j.style.filter=h.toFilter();var m=this.getBBox(),p=this.getBBox(1),q=m.x-p.x,r=m.y-p.y;j.coordorigin=q*-u+n+r*-u,z(this,1,1,q,r,0)}else{j.style.filter=o,z(this,g.scalex,g.scaley,g.dx,g.dy,g.rotate)}}else{j.style.filter=o,i.matrix=b(h),i.offset=h.offset()}return d&&(this._.transform=d),this},E.rotate=function(a,c,e){if(this.removed){return this}if(null!=a){if(a=b(a).split(k),a.length-1&&(c=d(a[1]),e=d(a[2])),a=d(a[0]),null==e&&(c=e),null==c||null==e){var f=this.getBBox(1);c=f.x+f.width/2,e=f.y+f.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",a,c,e]])),this}},E.translate=function(a,c){return this.removed?this:(a=b(a).split(k),a.length-1&&(c=d(a[1])),a=d(a[0])||0,c=+c||0,this._.bbox&&(this._.bbox.x+=a,this._.bbox.y+=c),this.transform(this._.transform.concat([["t",a,c]])),this)},E.scale=function(a,c,e,f){if(this.removed){return this}if(a=b(a).split(k),a.length-1&&(c=d(a[1]),e=d(a[2]),f=d(a[3]),isNaN(e)&&(e=null),isNaN(f)&&(f=null)),a=d(a[0]),null==c&&(c=a),null==f&&(e=f),null==e||null==f){var g=this.getBBox(1)}return e=null==e?g.x+g.width/2:e,f=null==f?g.y+g.height/2:f,this.transform(this._.transform.concat([["s",a,c,e,f]])),this._.dirtyT=1,this},E.hide=function(){return !this.removed&&(this.node.style.display="none"),this},E.show=function(){return !this.removed&&(this.node.style.display=o),this},E._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},E.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),c.eve.unbind("raphael.*.*."+this.id),c._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this){this[a]="function"==typeof this[a]?c._removedFactory(a):null}this.removed=!0}},E.attr=function(b,d){if(this.removed){return this}if(null==b){var e={};for(var f in this.attrs){this.attrs[a](f)&&(e[f]=this.attrs[f])}return e.gradient&&"none"==e.fill&&(e.fill=e.gradient)&&delete e.gradient,e.transform=this._.transform,e}if(null==d&&c.is(b,"string")){if(b==j&&"none"==this.attrs.fill&&this.attrs.gradient){return this.attrs.gradient}for(var g=b.split(k),h={},i=0,m=g.length;m>i;i++){b=g[i],h[b]=b in this.attrs?this.attrs[b]:c.is(this.paper.customAttributes[b],"function")?this.paper.customAttributes[b].def:c._availableAttrs[b]}return m-1?h:h[g[0]]}if(this.attrs&&null==d&&c.is(b,"array")){for(h={},i=0,m=b.length;m>i;i++){h[b[i]]=this.attr(b[i])}return h}var n;null!=d&&(n={},n[b]=d),null==d&&c.is(b,"object")&&(n=b);for(var o in n){l("raphael.attr."+o+"."+this.id,this,n[o])}if(n){for(o in this.paper.customAttributes){if(this.paper.customAttributes[a](o)&&n[a](o)&&c.is(this.paper.customAttributes[o],"function")){var p=this.paper.customAttributes[o].apply(this,[].concat(n[o]));this.attrs[o]=n[o];for(var q in p){p[a](q)&&(n[q]=p[q])}}}n.text&&"text"==this.type&&(this.textpath.string=n.text),B(this,n)}return this},E.toFront=function(){return !this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&c._tofront(this,this.paper),this},E.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),c._toback(this,this.paper)),this)},E.insertAfter=function(a){return this.removed?this:(a.constructor==c.st.constructor&&(a=a[a.length-1]),a.node.nextSibling?a.node.parentNode.insertBefore(this.node,a.node.nextSibling):a.node.parentNode.appendChild(this.node),c._insertafter(this,a,this.paper),this)},E.insertBefore=function(a){return this.removed?this:(a.constructor==c.st.constructor&&(a=a[0]),a.node.parentNode.insertBefore(this.node,a.node),c._insertbefore(this,a,this.paper),this)},E.blur=function(a){var b=this.node.runtimeStyle,d=b.filter;return d=d.replace(r,o),0!==+a?(this.attrs.blur=a,b.filter=d+n+m+".Blur(pixelradius="+(+a||1.5)+")",b.margin=c.format("-{0}px 0 0 -{0}px",f(+a||1.5))):(b.filter=d,b.margin=0,delete this.attrs.blur),this},c._engine.path=function(a,b){var c=F("shape");c.style.cssText=t,c.coordsize=u+n+u,c.coordorigin=b.coordorigin;var d=new D(c,b),e={fill:"none",stroke:"#000"};a&&(e.path=a),d.type="path",d.path=[],d.Path=o,B(d,e),b.canvas.appendChild(c);var f=F("skew");return f.on=!0,c.appendChild(f),d.skew=f,d.transform(o),d},c._engine.rect=function(a,b,d,e,f,g){var h=c._rectPath(b,d,e,f,g),i=a.path(h),j=i.attrs;return i.X=j.x=b,i.Y=j.y=d,i.W=j.width=e,i.H=j.height=f,j.r=g,j.path=h,i.type="rect",i},c._engine.ellipse=function(a,b,c,d,e){var f=a.path();return f.attrs,f.X=b-d,f.Y=c-e,f.W=2*d,f.H=2*e,f.type="ellipse",B(f,{cx:b,cy:c,rx:d,ry:e}),f},c._engine.circle=function(a,b,c,d){var e=a.path();return e.attrs,e.X=b-d,e.Y=c-d,e.W=e.H=2*d,e.type="circle",B(e,{cx:b,cy:c,r:d}),e},c._engine.image=function(a,b,d,e,f,g){var h=c._rectPath(d,e,f,g),i=a.path(h).attr({stroke:"none"}),k=i.attrs,l=i.node,m=l.getElementsByTagName(j)[0];return k.src=b,i.X=k.x=d,i.Y=k.y=e,i.W=k.width=f,i.H=k.height=g,k.path=h,i.type="image",m.parentNode==l&&l.removeChild(m),m.rotate=!0,m.src=b,m.type="tile",i._.fillpos=[d,e],i._.fillsize=[f,g],l.appendChild(m),z(i,1,1,0,0,0),i},c._engine.text=function(a,d,e,g){var h=F("shape"),i=F("path"),j=F("textpath");d=d||0,e=e||0,g=g||"",i.v=c.format("m{0},{1}l{2},{1}",f(d*u),f(e*u),f(d*u)+1),i.textpathok=!0,j.string=b(g),j.on=!0,h.style.cssText=t,h.coordsize=u+n+u,h.coordorigin="0 0";var k=new D(h,a),l={fill:"#000",stroke:"none",font:c._availableAttrs.font,text:g};k.shape=h,k.path=i,k.textpath=j,k.type="text",k.attrs.text=b(g),k.attrs.x=d,k.attrs.y=e,k.attrs.w=1,k.attrs.h=1,B(k,l),h.appendChild(j),h.appendChild(i),a.canvas.appendChild(h);var m=F("skew");return m.on=!0,h.appendChild(m),k.skew=m,k.transform(o),k},c._engine.setSize=function(a,b){var d=this.canvas.style;return this.width=a,this.height=b,a==+a&&(a+="px"),b==+b&&(b+="px"),d.width=a,d.height=b,d.clip="rect(0 "+a+" "+b+" 0)",this._viewBox&&c._engine.setViewBox.apply(this,this._viewBox),this},c._engine.setViewBox=function(a,b,d,e,f){c.eve("raphael.setViewBox",this,this._viewBox,[a,b,d,e,f]);var h,i,j=this.width,k=this.height,l=1/g(d/j,e/k);return f&&(h=k/e,i=j/d,j>d*h&&(a-=(j-d*h)/2/h),k>e*i&&(b-=(k-e*i)/2/i)),this._viewBox=[a,b,d,e,!!f],this._viewBoxShift={dx:-a,dy:-b,scale:l},this.forEach(function(a){a.transform("...")}),this};var F;c._engine.initWin=function(a){var b=a.document;b.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!b.namespaces.rvml&&b.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),F=function(a){return b.createElement("<rvml:"+a+' class="rvml">')}}catch(c){F=function(a){return b.createElement("<"+a+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},c._engine.initWin(c._g.win),c._engine.create=function(){var a=c._getContainer.apply(0,arguments),b=a.container,d=a.height,e=a.width,f=a.x,g=a.y;if(!b){throw new Error("VML container not found.")}var h=new c._Paper,i=h.canvas=c._g.doc.createElement("div"),j=i.style;return f=f||0,g=g||0,e=e||512,d=d||342,h.width=e,h.height=d,e==+e&&(e+="px"),d==+d&&(d+="px"),h.coordsize=1000*u+n+1000*u,h.coordorigin="0 0",h.span=c._g.doc.createElement("span"),h.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",i.appendChild(h.span),j.cssText=c.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",e,d),1==b?(c._g.doc.body.appendChild(i),j.left=f+"px",j.top=g+"px",j.position="absolute"):b.firstChild?b.insertBefore(i,b.firstChild):b.appendChild(i),h.renderfix=function(){},h},c.prototype.clear=function(){c.eve("raphael.clear",this),this.canvas.innerHTML=o,this.span=c._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},c.prototype.remove=function(){c.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]="function"==typeof this[a]?c._removedFactory(a):null}return !0};var G=c.st;for(var H in E){E[a](H)&&!G[a](H)&&(G[H]=function(a){return function(){var b=arguments;return this.forEach(function(c){c[a].apply(c,b)})}}(H))}}}(),B.was?A.win.Raphael=c:Raphael=c,c});[].map||(Array.prototype.map=function(t,n){for(var e=this,r=e.length,u=[],i=0;r>i;){i in e&&(u[i]=t.call(n,e[i],i++,e))}return u.lengh=r,u}),[].filter||(Array.prototype.filter=function(t,n,e,r,u){e=this,r=[];for(u in e){~~u+""==u&&u>=0&&t.call(n,e[u],+u,e)&&r.push(e[u])}return r}),[].forEach||(Array.prototype.forEach=function(t,n){for(var e=0,r=this.length;r>e;++e){t.call(n,this[e],e,this)}});var d3=function(){function t(t){for(var n=1;t*n%1;){n*=10}return n}function n(t,n,e){return function(){var r=e.apply(n,arguments);return r===n?t:r}}function e(t){var n=[t.a,t.b],e=[t.c,t.d],o=u(n),a=r(n,e),c=u(i(e,n,-a))||0;n[0]*e[1]<e[0]*n[1]&&(n[0]*=-1,n[1]*=-1,o*=-1,a*=-1),this.rotate=(o?Math.atan2(n[1],n[0]):Math.atan2(-e[0],e[1]))*d3_degrees,this.translate=[t.e,t.f],this.scale=[o,c],this.skew=c?Math.atan2(a,c)*d3_degrees:0}function r(t,n){return t[0]*n[0]+t[1]*n[1]}function u(t){var n=Math.sqrt(r(t,t));return n&&(t[0]/=n,t[1]/=n),n}function i(t,n,e){return t[0]+=e*n[0],t[1]+=e*n[1],t}function o(t,n){return n-=t=+t,function(e){return t+n*e}}function a(t,n){var e,r=[],u=[],i=dn.transform(t),a=dn.transform(n),c=i.translate,s=a.translate,f=i.rotate,l=a.rotate,h=i.skew,g=a.skew,m=i.scale,p=a.scale;return c[0]!=s[0]||c[1]!=s[1]?(r.push("translate(",null,",",null,")"),u.push({i:1,x:o(c[0],s[0])},{i:3,x:o(c[1],s[1])})):s[0]||s[1]?r.push("translate("+s+")"):r.push(""),f!=l?(f-l>180?l+=360:l-f>180&&(f+=360),u.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:o(f,l)})):l&&r.push(r.pop()+"rotate("+l+")"),h!=g?u.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:o(h,g)}):g&&r.push(r.pop()+"skewX("+g+")"),m[0]!=p[0]||m[1]!=p[1]?(e=r.push(r.pop()+"scale(",null,",",null,")"),u.push({i:e-4,x:o(m[0],p[0])},{i:e-2,x:o(m[1],p[1])})):(1!=p[0]||1!=p[1])&&r.push(r.pop()+"scale("+p+")"),e=u.length,function(t){for(var n,i=-1;e>++i;){r[(n=u[i]).i]=n.x(t)}return r.join("")}}function c(t,n){var e,r={},u={};for(e in t){e in n?r[e]=h(e)(t[e],n[e]):u[e]=t[e]}for(e in n){e in t||(u[e]=n[e])}return function(t){for(e in r){u[e]=r[e](t)}return u}}function s(t,n){var e,r=[],u=[],i=t.length,o=n.length,a=Math.min(t.length,n.length);for(e=0;a>e;++e){r.push(l(t[e],n[e]))}for(;i>e;++e){u[e]=t[e]}for(;o>e;++e){u[e]=n[e]}return function(t){for(e=0;a>e;++e){u[e]=r[e](t)}return u}}function f(t,n){var e,r,u,i,a,c=0,s=0,f=[],l=[];for(t+="",n+="",xn.lastIndex=0,r=0;e=xn.exec(n);++r){e.index&&f.push(n.substring(c,s=e.index)),l.push({i:f.length,x:e[0]}),f.push(null),c=xn.lastIndex}for(n.length>c&&f.push(n.substring(c)),r=0,i=l.length;(e=xn.exec(t))&&i>r;++r){if(a=l[r],a.x==e[0]){if(a.i){if(null==f[a.i+1]){for(f[a.i-1]+=a.x,f.splice(a.i,1),u=r+1;i>u;++u){l[u].i--}}else{for(f[a.i-1]+=a.x+f[a.i+1],f.splice(a.i,2),u=r+1;i>u;++u){l[u].i-=2}}}else{if(null==f[a.i+1]){f[a.i]=a.x}else{for(f[a.i]=a.x+f[a.i+1],f.splice(a.i+1,1),u=r+1;i>u;++u){l[u].i--}}}l.splice(r,1),i--,r--}else{a.x=o(parseFloat(e[0]),parseFloat(a.x))}}for(;i>r;){a=l.pop(),null==f[a.i+1]?f[a.i]=a.x:(f[a.i]=a.x+f[a.i+1],f.splice(a.i+1,1)),i--}return 1===f.length?null==f[0]?(a=l[0].x,function(t){return a(t)+""}):function(){return n}:function(t){for(r=0;i>r;++r){f[(a=l[r]).i]=a.x(t)}return f.join("")}}function l(t,n){for(var e,r=dn.interpolators.length;--r>=0&&!(e=dn.interpolators[r](t,n));){}return e}function h(t){return"transform"==t?a:l}function g(t,n){return n-=t,function(e){return Math.round(t+n*e)}}function m(t,n){return n=n-(t=+t)?1/(n-t):0,function(e){return(e-t)*n}}function p(t,n){return n=n-(t=+t)?1/(n-t):0,function(e){return Math.max(0,Math.min(1,(e-t)*n))}}function d(t,n){try{for(var e in n){Object.defineProperty(t.prototype,e,{value:n[e],enumerable:!1})}}catch(r){t.prototype=n}}function M(){}function v(t){return t}function y(t,n){var e=Math.pow(10,3*Math.abs(8-n));return{scale:n>8?function(t){return t/e}:function(t){return t*e},symbol:t}}function x(t,n){return n-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function b(t){return t+""}function w(t,n,e,r){var u=e(t[0],t[1]),i=r(n[0],n[1]);return function(t){return i(u(t))}}function D(t,n){var e,r=0,u=t.length-1,i=t[r],o=t[u];return i>o&&(e=r,r=u,u=e,e=i,i=o,o=e),(n=n(o-i))&&(t[r]=n.floor(i),t[u]=n.ceil(o)),t}function T(t,n,e,r){var u=[],i=[],o=0,a=Math.min(t.length,n.length)-1;for(t[a]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());a>=++o;){u.push(e(t[o-1],t[o])),i.push(r(n[o-1],n[o]))}return function(n){var e=dn.bisect(t,n,1,a)-1;return i[e](u[e](n))}}function _(t){var n=t[0],e=t[t.length-1];return e>n?[n,e]:[e,n]}function C(t,n,e,r){function u(){var u=Math.min(t.length,n.length)>2?T:w,c=r?p:m;return o=u(t,n,c,e),a=u(n,t,c,l),i}function i(t){return o(t)}var o,a;return i.invert=function(t){return a(t)},i.domain=function(n){return arguments.length?(t=n.map(Number),u()):t},i.range=function(t){return arguments.length?(n=t,u()):n},i.rangeRound=function(t){return i.range(t).interpolate(g)},i.clamp=function(t){return arguments.length?(r=t,u()):r},i.interpolate=function(t){return arguments.length?(e=t,u()):e},i.ticks=function(n){return F(t,n)},i.tickFormat=function(n,e){return A(t,n,e)},i.nice=function(){return D(t,Y),u()},i.copy=function(){return C(t,n,e,r)},u()}function k(t,n){return dn.rebind(t,n,"range","rangeRound","interpolate","clamp")}function Y(t){return t=Math.pow(10,Math.round(Math.log(t)/Math.LN10)-1),t&&{floor:function(n){return Math.floor(n/t)*t},ceil:function(n){return Math.ceil(n/t)*t}}}function S(t,n){var e=_(t),r=e[1]-e[0],u=Math.pow(10,Math.floor(Math.log(r/n)/Math.LN10)),i=n/r*u;return 0.15>=i?u*=10:0.35>=i?u*=5:0.75>=i&&(u*=2),e[0]=Math.ceil(e[0]/u)*u,e[1]=Math.floor(e[1]/u)*u+0.5*u,e[2]=u,e}function F(t,n){return dn.range.apply(dn,S(t,n))}function A(t,n,e){var r=-Math.floor(Math.log(S(t,n)[2])/Math.LN10+0.01);return dn.format(e?e.replace(kn,function(t,n,e,u,i,o,a,c,s,f){return[n,e,u,i,o,a,c,s||"."+(r-2*("%"===f)),f].join("")}):",."+r+"f")}function O(t,n,e,r,u){function i(n){return t(e(n))}function o(){return e===L?{floor:a,ceil:c}:{floor:function(t){return -c(-t)},ceil:function(t){return -a(-t)}}}function a(t){return Math.pow(n,Math.floor(Math.log(t)/Math.log(n)))}function c(t){return Math.pow(n,Math.ceil(Math.log(t)/Math.log(n)))}return i.invert=function(n){return r(t.invert(n))},i.domain=function(n){return arguments.length?(0>n[0]?(e=U,r=H):(e=L,r=I),t.domain((u=n.map(Number)).map(e)),i):u},i.base=function(t){return arguments.length?(n=+t,i):n},i.nice=function(){return t.domain(D(u,o).map(e)),i},i.ticks=function(){var u=_(t.domain()),i=[];if(u.every(isFinite)){var o=Math.log(n),a=Math.floor(u[0]/o),c=Math.ceil(u[1]/o),s=r(u[0]),f=r(u[1]),l=n%1?2:n;if(e===U){for(i.push(-Math.pow(n,-a));c>a++;){for(var h=l-1;h>0;h--){i.push(-Math.pow(n,-a)*h)}}}else{for(;c>a;a++){for(var h=1;l>h;h++){i.push(Math.pow(n,a)*h)}}i.push(Math.pow(n,a))}for(a=0;s>i[a];a++){}for(c=i.length;i[c-1]>f;c--){}i=i.slice(a,c)}return i},i.tickFormat=function(t,u){if(2>arguments.length&&(u=On),!arguments.length){return u}var o,a=Math.log(n),c=Math.max(0.1,t/i.ticks().length),s=e===U?(o=-1e-12,Math.floor):(o=1e-12,Math.ceil);return function(t){return c>=t/r(a*s(e(t)/a+o))?u(t):""}},i.copy=function(){return O(t.copy(),n,e,r,u)},k(i,t)}function L(t){return Math.log(0>t?0:t)}function I(t){return Math.exp(t)}function U(t){return -Math.log(t>0?0:-t)}function H(t){return -Math.exp(-t)}function E(){return !0}function j(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function N(t,n,e){function r(n){var e=t(n),r=i(e,1);return r-n>n-e?e:r}function u(e){return n(e=t(new Ln(e-1)),1),e}function i(t,e){return n(t=new Ln(+t),e),t}function o(t,r,i){var o=u(t),a=[];if(i>1){for(;r>o;){e(o)%i||a.push(new Date(+o)),n(o,1)}}else{for(;r>o;){a.push(new Date(+o)),n(o,1)}}return a}function a(t,n,e){try{Ln=j;var r=new j;return r._=t,o(r,n,e)}finally{Ln=Date}}t.floor=t,t.round=r,t.ceil=u,t.offset=i,t.range=o;var c=t.utc=z(t);return c.floor=c,c.round=z(r),c.ceil=z(u),c.offset=z(i),c.range=a,t}function z(t){return function(n,e){try{Ln=j;var r=new j;return r._=n,t(r,e)._}finally{Ln=Date}}}function X(t,n,e,r){for(var u,i,o=0,a=n.length,c=e.length;a>o;){if(r>=c){return -1}if(u=n.charCodeAt(o++),37===u){if(i=Kn[n.charAt(o++)],!i||0>(r=i(t,e,r))){return -1}}else{if(u!=e.charCodeAt(r++)){return -1}}}return r}function P(t){return RegExp("^(?:"+t.map(dn.requote).join("|")+")","i")}function q(t){for(var n=new M,e=-1,r=t.length;r>++e;){n.set(t[e].toLowerCase(),e)}return n}function G(t,n,e){t+="";var r=t.length;return e>r?Array(e-r+1).join(n)+t:t}function R(t,n,e){Rn.lastIndex=0;var r=Rn.exec(n.substring(e));return r?e+=r[0].length:-1}function B(t,n,e){Gn.lastIndex=0;var r=Gn.exec(n.substring(e));return r?e+=r[0].length:-1}function W(t,n,e){Zn.lastIndex=0;var r=Zn.exec(n.substring(e));return r?(t.m=$n.get(r[0].toLowerCase()),e+=r[0].length):-1}function Z(t,n,e){Bn.lastIndex=0;var r=Bn.exec(n.substring(e));return r?(t.m=Wn.get(r[0].toLowerCase()),e+=r[0].length):-1}function $(t,n,e){return X(t,""+Jn.c,n,e)}function V(t,n,e){return X(t,""+Jn.x,n,e)}function J(t,n,e){return X(t,""+Jn.X,n,e)}function K(t,n,e){Qn.lastIndex=0;var r=Qn.exec(n.substring(e,e+4));return r?(t.y=+r[0],e+=r[0].length):-1}function Q(t,n,e){Qn.lastIndex=0;var r=Qn.exec(n.substring(e,e+2));return r?(t.y=tn(+r[0]),e+=r[0].length):-1}function tn(t){return t+(t>68?1900:2000)}function nn(t,n,e){Qn.lastIndex=0;var r=Qn.exec(n.substring(e,e+2));return r?(t.m=r[0]-1,e+=r[0].length):-1}function en(t,n,e){Qn.lastIndex=0;var r=Qn.exec(n.substring(e,e+2));return r?(t.d=+r[0],e+=r[0].length):-1}function rn(t,n,e){Qn.lastIndex=0;var r=Qn.exec(n.substring(e,e+2));return r?(t.H=+r[0],e+=r[0].length):-1}function un(t,n,e){Qn.lastIndex=0;var r=Qn.exec(n.substring(e,e+2));return r?(t.M=+r[0],e+=r[0].length):-1}function on(t,n,e){Qn.lastIndex=0;var r=Qn.exec(n.substring(e,e+2));return r?(t.S=+r[0],e+=r[0].length):-1}function an(t,n,e){Qn.lastIndex=0;var r=Qn.exec(n.substring(e,e+3));return r?(t.L=+r[0],e+=r[0].length):-1}function cn(t,n,e){var r=te.get(n.substring(e,e+=2).toLowerCase());return null==r?-1:(t.p=r,e)}function sn(t){var n=t.getTimezoneOffset(),e=n>0?"-":"+",r=~~(Math.abs(n)/60),u=Math.abs(n)%60;return e+G(r,"0",2)+G(u,"0",2)}function fn(t,n,e){function r(n){return t(n)}return r.invert=function(n){return ln(t.invert(n))},r.domain=function(n){return arguments.length?(t.domain(n),r):t.domain().map(ln)},r.nice=function(t){return r.domain(D(r.domain(),function(){return t}))},r.ticks=function(e,u){var i=_(r.domain());if("function"!=typeof e){var o=i[1]-i[0],a=o/e,c=dn.bisect(ne,a);if(c==ne.length){return n.year(i,e)}if(!c){return t.ticks(e).map(ln)}Math.log(a/ne[c-1])<Math.log(ne[c]/a)&&--c,e=n[c],u=e[1],e=e[0].range}return e(i[0],new Date(+i[1]+1),u)},r.tickFormat=function(){return e},r.copy=function(){return fn(t.copy(),n,e)},k(r,t)}function ln(t){return new Date(t)}function hn(t){return function(n){for(var e=t.length-1,r=t[e];!r[1](n);){r=t[--e]}return r[0](n)}}function gn(t){var n=new Date(t,0,1);return n.setFullYear(t),n}function mn(t){var n=t.getFullYear(),e=gn(n),r=gn(n+1);return n+(t-e)/(r-e)}function pn(t){return null!=t&&!isNaN(t)}var dn={version:"3.1.7"};dn.range=function(n,e,r){if(3>arguments.length&&(r=1,2>arguments.length&&(e=n,n=0)),1/0===(e-n)/r){throw Error("infinite range")}var u,i=[],o=t(Math.abs(r)),a=-1;if(n*=o,e*=o,r*=o,0>r){for(;(u=n+r*++a)>e;){i.push(u/o)}}else{for(;e>(u=n+r*++a);){i.push(u/o)}}return i},dn.rebind=function(t,e){for(var r,u=1,i=arguments.length;i>++u;){t[r=arguments[u]]=n(t,e,e[r])}return t};var Mn=document,vn={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};dn.ns={prefix:vn,qualify:function(t){var n=t.indexOf(":"),e=t;return n>=0&&(e=t.substring(0,n),t=t.substring(n+1)),vn.hasOwnProperty(e)?{space:vn[e],local:t}:t}},dn.transform=function(t){var n=Mn.createElementNS(dn.ns.prefix.svg,"g");return(dn.transform=function(t){if(null!=t){n.setAttribute("transform",t);var r=n.transform.baseVal.consolidate()}return new e(r?r.matrix:yn)})(t)},e.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var yn={a:1,b:0,c:0,d:1,e:0,f:0};dn.interpolateNumber=o,dn.interpolateTransform=a,dn.interpolateObject=c,dn.interpolateArray=s,dn.interpolateString=f;var xn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;dn.interpolate=l,dn.interpolators=[function(t,n){var e=typeof n;return("string"===e?f:"object"===e?Array.isArray(n)?s:c:o)(t,n)}],dn.interpolateRound=g,dn.map=function(t){var n=new M;for(var e in t){n.set(e,t[e])}return n},d(M,{has:function(t){return bn+t in this},get:function(t){return this[bn+t]},set:function(t,n){return this[bn+t]=n},remove:function(t){return t=bn+t,t in this&&delete this[t]},keys:function(){var t=[];return this.forEach(function(n){t.push(n)}),t},values:function(){var t=[];return this.forEach(function(n,e){t.push(e)}),t},entries:function(){var t=[];return this.forEach(function(n,e){t.push({key:n,value:e})}),t},forEach:function(t){for(var n in this){n.charCodeAt(0)===wn&&t.call(this,n.substring(1),this[n])}}});var bn="\0",wn=bn.charCodeAt(0),Dn=".",Tn=",",_n=[3,3],Cn=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"].map(y);dn.formatPrefix=function(t,n){var e=0;return t&&(0>t&&(t*=-1),n&&(t=dn.round(t,x(t,n))),e=1+Math.floor(1e-12+Math.log(t)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((0>=e?e+1:e-1)/3)))),Cn[8+e/3]},dn.round=function(t,n){return n?Math.round(t*(n=Math.pow(10,n)))/n:Math.round(t)},dn.format=function(t){var n=kn.exec(t),e=n[1]||" ",r=n[2]||">",u=n[3]||"",i=n[4]||"",o=n[5],a=+n[6],c=n[7],s=n[8],f=n[9],l=1,h="",g=!1;switch(s&&(s=+s.substring(1)),(o||"0"===e&&"="===r)&&(o=e="0",r="=",c&&(a-=Math.floor((a-1)/4))),f){case"n":c=!0,f="g";break;case"%":l=100,h="%",f="f";break;case"p":l=100,h="%",f="r";break;case"b":case"o":case"x":case"X":i&&(i="0"+f.toLowerCase());case"c":case"d":g=!0,s=0;break;case"s":l=-1,f="r"}"#"===i&&(i=""),"r"!=f||s||(f="g"),null!=s&&("g"==f?s=Math.max(1,Math.min(21,s)):("e"==f||"f"==f)&&(s=Math.max(0,Math.min(20,s)))),f=Yn.get(f)||b;var m=o&&c;return function(t){if(g&&t%1){return""}var n=0>t||0===t&&0>1/t?(t=-t,"-"):u;if(0>l){var p=dn.formatPrefix(t,s);t=p.scale(t),h=p.symbol}else{t*=l}t=f(t,s),!o&&c&&(t=Sn(t));var d=i.length+t.length+(m?0:n.length),M=a>d?Array(d=a-d+1).join(e):"";return m&&(t=Sn(M+t)),Dn&&t.replace(".",Dn),n+=i,("<"===r?n+t+M:">"===r?M+n+t:"^"===r?M.substring(0,d>>=1)+n+t+M.substring(d):n+(m?t:M+t))+h}};var kn=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Yn=dn.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,n){return t.toPrecision(n)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},r:function(t,n){return(t=dn.round(t,x(t,n))).toFixed(Math.max(0,Math.min(20,x(t*(1+1e-15),n))))}}),Sn=v;if(_n){var Fn=_n.length;Sn=function(t){for(var n=t.lastIndexOf("."),e=n>=0?"."+t.substring(n+1):(n=t.length,""),r=[],u=0,i=_n[0];n>0&&i>0;){r.push(t.substring(n-=i,n+i)),i=_n[u=(u+1)%Fn]}return r.reverse().join(Tn||"")+e}}dn.bisector=function(t){return{left:function(n,e,r,u){for(3>arguments.length&&(r=0),4>arguments.length&&(u=n.length);u>r;){var i=r+u>>>1;e>t.call(n,n[i],i)?r=i+1:u=i}return r},right:function(n,e,r,u){for(3>arguments.length&&(r=0),4>arguments.length&&(u=n.length);u>r;){var i=r+u>>>1;t.call(n,n[i],i)>e?u=i:r=i+1}return r}}};var An=dn.bisector(function(t){return t});dn.bisectLeft=An.left,dn.bisect=dn.bisectRight=An.right,dn.scale={},dn.scale.linear=function(){return C([0,1],[0,1],l,!1)},dn.scale.log=function(){return O(dn.scale.linear().domain([0,Math.LN10]),10,L,I,[1,10])};var On=dn.format(".0e");dn.time={};var Ln=Date,In=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];j.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Un.setUTCDate.apply(this._,arguments)},setDay:function(){Un.setUTCDay.apply(this._,arguments)},setFullYear:function(){Un.setUTCFullYear.apply(this._,arguments)},setHours:function(){Un.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Un.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Un.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Un.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Un.setUTCSeconds.apply(this._,arguments)},setTime:function(){Un.setTime.apply(this._,arguments)}};var Un=Date.prototype;dn.time.year=N(function(t){return t=dn.time.day(t),t.setMonth(0,1),t},function(t,n){t.setFullYear(t.getFullYear()+n)},function(t){return t.getFullYear()}),dn.time.years=dn.time.year.range,dn.time.years.utc=dn.time.year.utc.range,dn.time.day=N(function(t){var n=new Ln(1970,0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n},function(t,n){t.setDate(t.getDate()+n)},function(t){return t.getDate()-1}),dn.time.days=dn.time.day.range,dn.time.days.utc=dn.time.day.utc.range,dn.time.dayOfYear=function(t){var n=dn.time.year(t);return Math.floor((t-n-60000*(t.getTimezoneOffset()-n.getTimezoneOffset()))/86400000)},dn.requote=function(t){return t.replace(Hn,"\\$&")};var Hn=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,En="%a %e %b %X %Y",jn="%d.%m.%Y",Nn="%H:%M:%S",zn=Globalize.culture(__locale).calendar.days.names,Xn=Globalize.culture(__locale).calendar.days.namesAbbr,Pn=Globalize.culture(__locale).calendar.months.names,qn=Globalize.culture(__locale).calendar.months.namesAbbr;In.forEach(function(t,n){t=t.toLowerCase(),n=7-n;var e=dn.time[t]=N(function(t){return(t=dn.time.day(t)).setDate(t.getDate()-(t.getDay()+n)%7),t},function(t,n){t.setDate(t.getDate()+7*Math.floor(n))},function(t){var e=dn.time.year(t).getDay();return Math.floor((dn.time.dayOfYear(t)+(e+n)%7)/7)-(e!==n)});dn.time[t+"s"]=e.range,dn.time[t+"s"].utc=e.utc.range,dn.time[t+"OfYear"]=function(t){var e=dn.time.year(t).getDay();return Math.floor((dn.time.dayOfYear(t)+(e+n)%7)/7)}}),dn.time.week=dn.time.sunday,dn.time.weeks=dn.time.sunday.range,dn.time.weeks.utc=dn.time.sunday.utc.range,dn.time.weekOfYear=dn.time.sundayOfYear,dn.time.format=function(t){function n(n){for(var r,u,i,o=[],a=-1,c=0;e>++a;){37===t.charCodeAt(a)&&(o.push(t.substring(c,a)),null!=(u=Vn[r=t.charAt(++a)])&&(r=t.charAt(++a)),(i=Jn[r])&&(r=i(n,null==u?"e"===r?" ":"0":u)),o.push(r),c=a+1)}return o.push(t.substring(c,a)),o.join("")}var e=t.length;return n.parse=function(n){var e={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},r=X(e,t,n,0);if(r!=n.length){return null}"p" in e&&(e.H=e.H%12+12*e.p);var u=new Ln;return u.setFullYear(e.y,e.m,e.d),u.setHours(e.H,e.M,e.S,e.L),u},n.toString=function(){return t},n};var Gn=P(zn),Rn=P(Xn),Bn=P(Pn),Wn=q(Pn),Zn=P(qn),$n=q(qn),Vn={"-":"",_:" ",0:"0"},Jn={a:function(t){return Xn[t.getDay()]},A:function(t){return zn[t.getDay()]},b:function(t){return qn[t.getMonth()]},B:function(t){return Pn[t.getMonth()]},c:dn.time.format(En),d:function(t,n){return G(t.getDate(),n,2)},e:function(t,n){return G(t.getDate(),n,2)},H:function(t,n){return G(t.getHours(),n,2)},I:function(t,n){return G(t.getHours()%12||12,n,2)},j:function(t,n){return G(1+dn.time.dayOfYear(t),n,3)},L:function(t,n){return G(t.getMilliseconds(),n,3)},m:function(t,n){return G(t.getMonth()+1,n,2)},M:function(t,n){return G(t.getMinutes(),n,2)},p:function(t){return t.getHours()>=12?"PM":"AM"},S:function(t,n){return G(t.getSeconds(),n,2)},U:function(t,n){return G(dn.time.sundayOfYear(t),n,2)},w:function(t){return t.getDay()},W:function(t,n){return G(dn.time.mondayOfYear(t),n,2)},x:dn.time.format(jn),X:dn.time.format(Nn),y:function(t,n){return G(t.getFullYear()%100,n,2)},Y:function(t,n){return G(t.getFullYear()%10000,n,4)},Z:sn,"%":function(){return"%"}},Kn={a:R,A:B,b:W,B:Z,c:$,d:en,e:en,H:rn,I:rn,L:an,m:nn,M:un,p:cn,S:on,x:V,X:J,y:Q,Y:K},Qn=/^\s*\d+/,te=dn.map({am:0,pm:1});dn.time.hour=N(function(t){var n=t.getTimezoneOffset()/60;return new Ln(3600000*(Math.floor(t/3600000-n)+n))},function(t,n){t.setTime(t.getTime()+3600000*Math.floor(n))},function(t){return t.getHours()}),dn.time.hours=dn.time.hour.range,dn.time.hours.utc=dn.time.hour.utc.range,dn.time.minute=N(function(t){return new Ln(60000*Math.floor(t/60000))},function(t,n){t.setTime(t.getTime()+60000*Math.floor(n))},function(t){return t.getMinutes()}),dn.time.minutes=dn.time.minute.range,dn.time.minutes.utc=dn.time.minute.utc.range,dn.time.month=N(function(t){return t=dn.time.day(t),t.setDate(1),t},function(t,n){t.setMonth(t.getMonth()+n)},function(t){return t.getMonth()}),dn.time.months=dn.time.month.range,dn.time.months.utc=dn.time.month.utc.range,dn.time.second=N(function(t){return new Ln(1000*Math.floor(t/1000))},function(t,n){t.setTime(t.getTime()+1000*Math.floor(n))},function(t){return t.getSeconds()}),dn.time.seconds=dn.time.second.range,dn.time.seconds.utc=dn.time.second.utc.range;var ne=[1000,5000,15000,30000,60000,300000,900000,1800000,3600000,10800000,21600000,43200000,86400000,172800000,604800000,2592000000,7776000000,31536000000],ee=[[dn.time.second,1],[dn.time.second,5],[dn.time.second,15],[dn.time.second,30],[dn.time.minute,1],[dn.time.minute,5],[dn.time.minute,15],[dn.time.minute,30],[dn.time.hour,1],[dn.time.hour,3],[dn.time.hour,6],[dn.time.hour,12],[dn.time.day,1],[dn.time.day,2],[dn.time.week,1],[dn.time.month,1],[dn.time.month,3],[dn.time.year,1]],re=[[dn.time.format("%Y"),E],[dn.time.format("%B"),function(t){return t.getMonth()}],[dn.time.format("%b %d"),function(t){return 1!=t.getDate()}],[dn.time.format("%a %d"),function(t){return t.getDay()&&1!=t.getDate()}],[dn.time.format("%I %p"),function(t){return t.getHours()}],[dn.time.format("%I:%M"),function(t){return t.getMinutes()}],[dn.time.format(":%S"),function(t){return t.getSeconds()}],[dn.time.format(".%L"),function(t){return t.getMilliseconds()}]],ue=dn.scale.linear(),ie=hn(re);return ee.year=function(t,n){return ue.domain(t.map(mn)).ticks(n).map(gn)},dn.time.scale=function(){return fn(dn.scale.linear(),ee,ie)},dn.ascending=function(t,n){return n>t?-1:t>n?1:t>=n?0:0/0},dn.quantile=function(t,n){var e=(t.length-1)*n+1,r=Math.floor(e),u=+t[r-1],i=e-r;return i?u+i*(t[r]-u):u},dn.median=function(t,n){return arguments.length>1&&(t=t.map(n)),t=t.filter(pn),t.length?dn.quantile(t.sort(dn.ascending),0.5):void 0},dn}();!function(){var Color,K,PITHIRD,TWOPI,X,Y,Z,bezier,brewer,chroma,clip_rgb,colors,cos,css2rgb,hex2rgb,hsi2rgb,hsl2rgb,hsv2rgb,lab2lch,lab2rgb,lab_xyz,lch2lab,lch2rgb,limit,luminance,luminance_x,rgb2hex,rgb2hsi,rgb2hsl,rgb2hsv,rgb2lab,rgb2lch,rgb_xyz,root,type,unpack,xyz_lab,xyz_rgb,_ref;root=typeof exports!=="undefined"&&exports!==null?exports:this;chroma=root.chroma=function(x,y,z,m){return new Color(x,y,z,m)};if(typeof module!=="undefined"&&module!==null){module.exports=chroma}chroma.color=function(x,y,z,m){return new Color(x,y,z,m)};chroma.hsl=function(h,s,l,a){return new Color(h,s,l,a,"hsl")};chroma.hsv=function(h,s,v,a){return new Color(h,s,v,a,"hsv")};chroma.rgb=function(r,g,b,a){return new Color(r,g,b,a,"rgb")};chroma.hex=function(x){return new Color(x)};chroma.css=function(x){return new Color(x)};chroma.lab=function(l,a,b){return new Color(l,a,b,"lab")};chroma.lch=function(l,c,h){return new Color(l,c,h,"lch")};chroma.hsi=function(h,s,i){return new Color(h,s,i,"hsi")};chroma.interpolate=function(a,b,f,m){if(a==null||b==null){return"#000"}if(type(a)==="string"){a=new Color(a)}if(type(b)==="string"){b=new Color(b)}return a.interpolate(f,b,m)};chroma.mix=chroma.interpolate;chroma.contrast=function(a,b){var l1,l2;if(type(a)==="string"){a=new Color(a)}if(type(b)==="string"){b=new Color(b)}l1=a.luminance();l2=b.luminance();if(l1>l2){return(l1+0.05)/(l2+0.05)}else{return(l2+0.05)/(l1+0.05)}};chroma.luminance=function(color){return chroma(color).luminance()};chroma._Color=Color;Color=function(){function Color(){var a,arg,args,m,me,me_rgb,x,y,z,_i,_len,_ref,_ref1,_ref2,_ref3;me=this;args=[];for(_i=0,_len=arguments.length;_i<_len;_i++){arg=arguments[_i];if(arg!=null){args.push(arg)}}if(args.length===0){_ref=[255,0,255,1,"rgb"],x=_ref[0],y=_ref[1],z=_ref[2],a=_ref[3],m=_ref[4]}else{if(type(args[0])==="array"){if(args[0].length===3){_ref1=args[0],x=_ref1[0],y=_ref1[1],z=_ref1[2];a=1}else{if(args[0].length===4){_ref2=args[0],x=_ref2[0],y=_ref2[1],z=_ref2[2],a=_ref2[3]}else{throw"unknown input argument"}}m=args[1]}else{if(type(args[0])==="string"){x=args[0];m="hex"}else{if(type(args[0])==="object"){_ref3=args[0]._rgb,x=_ref3[0],y=_ref3[1],z=_ref3[2],a=_ref3[3];m="rgb"}else{if(args.length>=3){x=args[0];y=args[1];z=args[2]}}}}}if(args.length===3){m="rgb";a=1}else{if(args.length===4){if(type(args[3])==="string"){m=args[3];a=1}else{if(type(args[3])==="number"){m="rgb";a=args[3]}}}else{if(args.length===5){a=args[3];m=args[4]}}}if(a==null){a=1}if(m==="rgb"){me._rgb=[x,y,z,a]}else{if(m==="hsl"){me._rgb=hsl2rgb(x,y,z);me._rgb[3]=a}else{if(m==="hsv"){me._rgb=hsv2rgb(x,y,z);me._rgb[3]=a}else{if(m==="hex"){me._rgb=hex2rgb(x)}else{if(m==="lab"){me._rgb=lab2rgb(x,y,z);me._rgb[3]=a}else{if(m==="lch"){me._rgb=lch2rgb(x,y,z);me._rgb[3]=a}else{if(m==="hsi"){me._rgb=hsi2rgb(x,y,z);me._rgb[3]=a}}}}}}}me_rgb=clip_rgb(me._rgb)}Color.prototype.rgb=function(){return this._rgb.slice(0,3)};Color.prototype.rgba=function(){return this._rgb};Color.prototype.hex=function(){return rgb2hex(this._rgb)};Color.prototype.toString=function(){return this.hex()};Color.prototype.hsl=function(){return rgb2hsl(this._rgb)};Color.prototype.hsv=function(){return rgb2hsv(this._rgb)};Color.prototype.lab=function(){return rgb2lab(this._rgb)};Color.prototype.lch=function(){return rgb2lch(this._rgb)};Color.prototype.hsi=function(){return rgb2hsi(this._rgb)};Color.prototype.luminance=function(){return luminance(this._rgb)};Color.prototype.name=function(){var h,k;h=this.hex();for(k in chroma.colors){if(h===chroma.colors[k]){return k}}return h};Color.prototype.alpha=function(alpha){if(arguments.length){this._rgb[3]=alpha;return this}return this._rgb[3]};Color.prototype.css=function(){if(this._rgb[3]<1){return"rgba("+this._rgb.join(",")+")"}else{return"rgb("+this._rgb.slice(0,3).join(",")+")"}};Color.prototype.interpolate=function(f,col,m){var dh,hue,hue0,hue1,lbv,lbv0,lbv1,me,res,sat,sat0,sat1,xyz0,xyz1;me=this;if(m==null){m="rgb"}if(type(col)==="string"){col=new Color(col)}if(m==="hsl"||m==="hsv"||m==="lch"||m==="hsi"){if(m==="hsl"){xyz0=me.hsl();xyz1=col.hsl()}else{if(m==="hsv"){xyz0=me.hsv();xyz1=col.hsv()}else{if(m==="hsi"){xyz0=me.hsi();xyz1=col.hsi()}else{if(m==="lch"){xyz0=me.lch();xyz1=col.lch()}}}}if(m.substr(0,1)==="h"){hue0=xyz0[0],sat0=xyz0[1],lbv0=xyz0[2];hue1=xyz1[0],sat1=xyz1[1],lbv1=xyz1[2]}else{lbv0=xyz0[0],sat0=xyz0[1],hue0=xyz0[2];lbv1=xyz1[0],sat1=xyz1[1],hue1=xyz1[2]}if(!isNaN(hue0)&&!isNaN(hue1)){if(hue1>hue0&&hue1-hue0>180){dh=hue1-(hue0+360)}else{if(hue1<hue0&&hue0-hue1>180){dh=hue1+360-hue0}else{dh=hue1-hue0}}hue=hue0+f*dh}else{if(!isNaN(hue0)){hue=hue0;if(lbv1===1||lbv1===0){sat=sat0}}else{if(!isNaN(hue1)){hue=hue1;if(lbv0===1||lbv0===0){sat=sat1}}else{hue=Number.NaN}}}if(sat==null){sat=sat0+f*(sat1-sat0)}lbv=lbv0+f*(lbv1-lbv0);if(m.substr(0,1)==="h"){res=new Color(hue,sat,lbv,m)}else{res=new Color(lbv,sat,hue,m)}}else{if(m==="rgb"){xyz0=me._rgb;xyz1=col._rgb;res=new Color(xyz0[0]+f*(xyz1[0]-xyz0[0]),xyz0[1]+f*(xyz1[1]-xyz0[1]),xyz0[2]+f*(xyz1[2]-xyz0[2]),m)}else{if(m==="lab"){xyz0=me.lab();xyz1=col.lab();res=new Color(xyz0[0]+f*(xyz1[0]-xyz0[0]),xyz0[1]+f*(xyz1[1]-xyz0[1]),xyz0[2]+f*(xyz1[2]-xyz0[2]),m)}else{throw"color mode "+m+" is not supported"}}}res.alpha(me.alpha()+f*(col.alpha()-me.alpha()));return res};Color.prototype.darken=function(amount){var lch,me;if(amount==null){amount=20}me=this;lch=me.lch();lch[0]-=amount;return chroma.lch(lch).alpha(me.alpha())};Color.prototype.darker=function(amount){return this.darken(amount)};Color.prototype.brighten=function(amount){if(amount==null){amount=20}return this.darken(-amount)};Color.prototype.brighter=function(amount){return this.brighten(amount)};Color.prototype.saturate=function(amount){var lch,me;if(amount==null){amount=20}me=this;lch=me.lch();lch[1]+=amount;return chroma.lch(lch).alpha(me.alpha())};Color.prototype.desaturate=function(amount){if(amount==null){amount=20}return this.saturate(-amount)};return Color}();clip_rgb=function(rgb){var i;for(i in rgb){if(i<3){if(rgb[i]<0){rgb[i]=0}if(rgb[i]>255){rgb[i]=255}}else{if(i===3){if(rgb[i]<0){rgb[i]=0}if(rgb[i]>1){rgb[i]=1}}}}return rgb};css2rgb=function(css){var hsl,i,m,rgb,_i,_j,_k,_l;if(chroma.colors!=null&&chroma.colors[css]){return hex2rgb(chroma.colors[css])}if(m=css.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){rgb=m.slice(1,4);for(i=_i=0;_i<=2;i=++_i){rgb[i]=+rgb[i]}rgb[3]=1}else{if(m=css.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/)){rgb=m.slice(1,5);for(i=_j=0;_j<=3;i=++_j){rgb[i]=+rgb[i]}}else{if(m=css.match(/rgb\(\s*(\-?\d+)%,\s*(\-?\d+)%\s*,\s*(\-?\d+)%\s*\)/)){rgb=m.slice(1,4);for(i=_k=0;_k<=2;i=++_k){rgb[i]=Math.round(rgb[i]*2.55)}rgb[3]=1}else{if(m=css.match(/rgba\(\s*(\-?\d+)%,\s*(\-?\d+)%\s*,\s*(\-?\d+)%\s*,\s*([01]|[01]?\.\d+)\)/)){rgb=m.slice(1,5);for(i=_l=0;_l<=2;i=++_l){rgb[i]=Math.round(rgb[i]*2.55)}rgb[3]=+rgb[3]}else{if(m=css.match(/hsl\(\s*(\-?\d+),\s*(\-?\d+)%\s*,\s*(\-?\d+)%\s*\)/)){hsl=m.slice(1,4);hsl[1]*=0.01;hsl[2]*=0.01;rgb=hsl2rgb(hsl);rgb[3]=1}else{if(m=css.match(/hsla\(\s*(\-?\d+),\s*(\-?\d+)%\s*,\s*(\-?\d+)%\s*,\s*([01]|[01]?\.\d+)\)/)){hsl=m.slice(1,4);hsl[1]*=0.01;hsl[2]*=0.01;rgb=hsl2rgb(hsl);rgb[3]=+m[4]}}}}}}return rgb};hex2rgb=function(hex){var a,b,g,r,rgb,u;if(hex.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/)){if(hex.length===4||hex.length===7){hex=hex.substr(1)}if(hex.length===3){hex=hex.split("");hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]}u=parseInt(hex,16);r=u>>16;g=u>>8&255;b=u&255;return[r,g,b,1]}if(hex.match(/^#?([A-Fa-f0-9]{8})$/)){if(hex.length===9){hex=hex.substr(1)}u=parseInt(hex,16);r=u>>24&255;g=u>>16&255;b=u>>8&255;a=u&255;return[r,g,b,a]}if(rgb=css2rgb(hex)){return rgb}throw"unknown color: "+hex};hsi2rgb=function(h,s,i){var b,g,r,_ref;_ref=unpack(arguments),h=_ref[0],s=_ref[1],i=_ref[2];h/=360;if(h<1/3){b=(1-s)/3;r=(1+s*cos(TWOPI*h)/cos(PITHIRD-TWOPI*h))/3;g=1-(b+r)}else{if(h<2/3){h-=1/3;r=(1-s)/3;g=(1+s*cos(TWOPI*h)/cos(PITHIRD-TWOPI*h))/3;b=1-(r+g)}else{h-=2/3;g=(1-s)/3;b=(1+s*cos(TWOPI*h)/cos(PITHIRD-TWOPI*h))/3;r=1-(g+b)}}r=limit(i*r*3);g=limit(i*g*3);b=limit(i*b*3);return[r*255,g*255,b*255]};hsl2rgb=function(){var b,c,g,h,i,l,r,s,t1,t2,t3,_i,_ref,_ref1;_ref=unpack(arguments),h=_ref[0],s=_ref[1],l=_ref[2];if(s===0){r=g=b=l*255}else{t3=[0,0,0];c=[0,0,0];t2=l<0.5?l*(1+s):l+s-l*s;t1=2*l-t2;h/=360;t3[0]=h+1/3;t3[1]=h;t3[2]=h-1/3;for(i=_i=0;_i<=2;i=++_i){if(t3[i]<0){t3[i]+=1}if(t3[i]>1){t3[i]-=1}if(6*t3[i]<1){c[i]=t1+(t2-t1)*6*t3[i]}else{if(2*t3[i]<1){c[i]=t2}else{if(3*t3[i]<2){c[i]=t1+(t2-t1)*(2/3-t3[i])*6}else{c[i]=t1}}}}_ref1=[Math.round(c[0]*255),Math.round(c[1]*255),Math.round(c[2]*255)],r=_ref1[0],g=_ref1[1],b=_ref1[2]}return[r,g,b]};hsv2rgb=function(){var b,f,g,h,i,p,q,r,s,t,v,_ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6;_ref=unpack(arguments),h=_ref[0],s=_ref[1],v=_ref[2];v*=255;if(s===0){r=g=b=v}else{if(h===360){h=0}if(h>360){h-=360}if(h<0){h+=360}h/=60;i=Math.floor(h);f=h-i;p=v*(1-s);q=v*(1-s*f);t=v*(1-s*(1-f));switch(i){case 0:_ref1=[v,t,p],r=_ref1[0],g=_ref1[1],b=_ref1[2];break;case 1:_ref2=[q,v,p],r=_ref2[0],g=_ref2[1],b=_ref2[2];break;case 2:_ref3=[p,v,t],r=_ref3[0],g=_ref3[1],b=_ref3[2];break;case 3:_ref4=[p,q,v],r=_ref4[0],g=_ref4[1],b=_ref4[2];break;case 4:_ref5=[t,p,v],r=_ref5[0],g=_ref5[1],b=_ref5[2];break;case 5:_ref6=[v,p,q],r=_ref6[0],g=_ref6[1],b=_ref6[2]}}r=Math.round(r);g=Math.round(g);b=Math.round(b);return[r,g,b]};K=18;X=0.95047;Y=1;Z=1.08883;lab2lch=function(){var a,b,c,h,l,_ref;_ref=unpack(arguments),l=_ref[0],a=_ref[1],b=_ref[2];c=Math.sqrt(a*a+b*b);h=Math.atan2(b,a)/Math.PI*180;return[l,c,h]};lab2rgb=function(l,a,b){var g,r,x,y,z,_ref,_ref1;if(l!==void 0&&l.length===3){_ref=l,l=_ref[0],a=_ref[1],b=_ref[2]}if(l!==void 0&&l.length===3){_ref1=l,l=_ref1[0],a=_ref1[1],b=_ref1[2]}y=(l+16)/116;x=y+a/500;z=y-b/200;x=lab_xyz(x)*X;y=lab_xyz(y)*Y;z=lab_xyz(z)*Z;r=xyz_rgb(3.2404542*x-1.5371385*y-0.4985314*z);g=xyz_rgb(-0.969266*x+1.8760108*y+0.041556*z);b=xyz_rgb(0.0556434*x-0.2040259*y+1.0572252*z);return[limit(r,0,255),limit(g,0,255),limit(b,0,255),1]};lab_xyz=function(x){if(x>0.206893034){return x*x*x}else{return(x-4/29)/7.787037}};xyz_rgb=function(r){return Math.round(255*(r<=0.00304?12.92*r:1.055*Math.pow(r,1/2.4)-0.055))};lch2lab=function(){var c,h,l,_ref;_ref=unpack(arguments),l=_ref[0],c=_ref[1],h=_ref[2];h=h*Math.PI/180;return[l,Math.cos(h)*c,Math.sin(h)*c]};lch2rgb=function(l,c,h){var L,a,b,g,r,_ref,_ref1;_ref=lch2lab(l,c,h),L=_ref[0],a=_ref[1],b=_ref[2];_ref1=lab2rgb(L,a,b),r=_ref1[0],g=_ref1[1],b=_ref1[2];return[limit(r,0,255),limit(g,0,255),limit(b,0,255)]};luminance=function(r,g,b){var _ref;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];r=luminance_x(r);g=luminance_x(g);b=luminance_x(b);return 0.2126*r+0.7152*g+0.0722*b};luminance_x=function(x){x/=255;if(x<=0.03928){return x/12.92}else{return Math.pow((x+0.055)/1.055,2.4)}};rgb2hex=function(){var b,g,r,str,u,_ref;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];u=r<<16|g<<8|b;str="000000"+u.toString(16);return"#"+str.substr(str.length-6)};rgb2hsi=function(){var TWOPI,b,g,h,i,min,r,s,_ref;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];TWOPI=Math.PI*2;r/=255;g/=255;b/=255;min=Math.min(r,g,b);i=(r+g+b)/3;s=1-min/i;if(s===0){h=0}else{h=(r-g+(r-b))/2;h/=Math.sqrt((r-g)*(r-g)+(r-b)*(g-b));h=Math.acos(h);if(b>g){h=TWOPI-h}h/=TWOPI}return[h*360,s,i]};rgb2hsl=function(r,g,b){var h,l,max,min,s,_ref;if(r!==void 0&&r.length>=3){_ref=r,r=_ref[0],g=_ref[1],b=_ref[2]}r/=255;g/=255;b/=255;min=Math.min(r,g,b);max=Math.max(r,g,b);l=(max+min)/2;if(max===min){s=0;h=Number.NaN}else{s=l<0.5?(max-min)/(max+min):(max-min)/(2-max-min)}if(r===max){h=(g-b)/(max-min)}else{if(g===max){h=2+(b-r)/(max-min)}else{if(b===max){h=4+(r-g)/(max-min)}}}h*=60;if(h<0){h+=360}return[h,s,l]};rgb2hsv=function(){var b,delta,g,h,max,min,r,s,v,_ref;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];min=Math.min(r,g,b);max=Math.max(r,g,b);delta=max-min;v=max/255;if(max===0){h=Number.NaN;s=0}else{s=delta/max;if(r===max){h=(g-b)/delta}if(g===max){h=2+(b-r)/delta}if(b===max){h=4+(r-g)/delta}h*=60;if(h<0){h+=360}}return[h,s,v]};rgb2lab=function(){var b,g,r,x,y,z,_ref;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];r=rgb_xyz(r);g=rgb_xyz(g);b=rgb_xyz(b);x=xyz_lab((0.4124564*r+0.3575761*g+0.1804375*b)/X);y=xyz_lab((0.2126729*r+0.7151522*g+0.072175*b)/Y);z=xyz_lab((0.0193339*r+0.119192*g+0.9503041*b)/Z);return[116*y-16,500*(x-y),200*(y-z)]};rgb_xyz=function(r){if((r/=255)<=0.04045){return r/12.92}else{return Math.pow((r+0.055)/1.055,2.4)}};xyz_lab=function(x){if(x>0.008856){return Math.pow(x,1/3)}else{return 7.787037*x+4/29}};rgb2lch=function(){var a,b,g,l,r,_ref,_ref1;_ref=unpack(arguments),r=_ref[0],g=_ref[1],b=_ref[2];_ref1=rgb2lab(r,g,b),l=_ref1[0],a=_ref1[1],b=_ref1[2];return lab2lch(l,a,b)};chroma.scale=function(colors,positions){var classifyValue,f,getClass,getColor,resetCache,setColors,setDomain,tmap,_colorCache,_colors,_correctLightness,_domain,_fixed,_max,_min,_mode,_nacol,_numClasses,_out,_pos,_spread;_mode="rgb";_nacol=chroma("#ccc");_spread=0;_fixed=false;_domain=[0,1];_colors=[];_out=false;_pos=[];_min=0;_max=1;_correctLightness=false;_numClasses=0;_colorCache={};setColors=function(colors,positions){var c,col,_i,_j,_ref,_ref1,_ref2;if(colors==null){colors=["#ddd","#222"]}if(colors!=null&&type(colors)==="string"&&((_ref=chroma.brewer)!=null?_ref[colors]:void 0)!=null){colors=chroma.brewer[colors]}if(type(colors)==="array"){colors=colors.slice(0);for(c=_i=0,_ref1=colors.length-1;0<=_ref1?_i<=_ref1:_i>=_ref1;c=0<=_ref1?++_i:--_i){col=colors[c];if(type(col)==="string"){colors[c]=chroma(col)}}if(positions!=null){_pos=positions}else{_pos=[];for(c=_j=0,_ref2=colors.length-1;0<=_ref2?_j<=_ref2:_j>=_ref2;c=0<=_ref2?++_j:--_j){_pos.push(c/(colors.length-1))}}}resetCache();return _colors=colors};setDomain=function(domain){if(domain==null){domain=[]}_domain=domain;_min=domain[0];_max=domain[domain.length-1];resetCache();if(domain.length===2){return _numClasses=0}else{return _numClasses=domain.length-1}};getClass=function(value){var i,n;if(_domain!=null){n=_domain.length-1;i=0;while(i<n&&value>=_domain[i]){i++}return i-1}return 0};tmap=function(t){return t};classifyValue=function(value){var i,maxc,minc,n,val;val=value;if(_domain.length>2){n=_domain.length-1;i=getClass(value);minc=_domain[0]+(_domain[1]-_domain[0])*(0+_spread*0.5);maxc=_domain[n-1]+(_domain[n]-_domain[n-1])*(1-_spread*0.5);val=_min+(_domain[i]+(_domain[i+1]-_domain[i])*0.5-minc)/(maxc-minc)*(_max-_min)}return val};getColor=function(val,bypassMap){var c,col,f0,i,k,p,t,_i,_ref;if(bypassMap==null){bypassMap=false}if(isNaN(val)){return _nacol}if(!bypassMap){if(_domain.length>2){c=getClass(val);t=c/(_numClasses-1)}else{t=f0=(val-_min)/(_max-_min);t=Math.min(1,Math.max(0,t))}}else{t=val}if(!bypassMap){t=tmap(t)}k=Math.floor(t*10000);if(_colorCache[k]){col=_colorCache[k]}else{if(type(_colors)==="array"){for(i=_i=0,_ref=_pos.length-1;0<=_ref?_i<=_ref:_i>=_ref;i=0<=_ref?++_i:--_i){p=_pos[i];if(t<=p){col=_colors[i];break}if(t>=p&&i===_pos.length-1){col=_colors[i];break}if(t>p&&t<_pos[i+1]){t=(t-p)/(_pos[i+1]-p);col=chroma.interpolate(_colors[i],_colors[i+1],t,_mode);break}}}else{if(type(_colors)==="function"){col=_colors(t)}}_colorCache[k]=col}return col};resetCache=function(){return _colorCache={}};setColors(colors,positions);f=function(v){var c;c=getColor(v);if(_out&&c[_out]){return c[_out]()}else{return c}};f.domain=function(domain,classes,mode,key){var d;if(mode==null){mode="e"}if(!arguments.length){return _domain}if(classes!=null){d=chroma.analyze(domain,key);if(classes===0){domain=[d.min,d.max]}else{domain=chroma.limits(d,mode,classes)}}setDomain(domain);return f};f.mode=function(_m){if(!arguments.length){return _mode}_mode=_m;resetCache();return f};f.range=function(colors,_pos){setColors(colors,_pos);return f};f.out=function(_o){_out=_o;return f};f.spread=function(val){if(!arguments.length){return _spread}_spread=val;return f};f.correctLightness=function(v){if(!arguments.length){return _correctLightness}_correctLightness=v;resetCache();if(_correctLightness){tmap=function(t){var L0,L1,L_actual,L_diff,L_ideal,max_iter,pol,t0,t1;L0=getColor(0,true).lab()[0];L1=getColor(1,true).lab()[0];pol=L0>L1;L_actual=getColor(t,true).lab()[0];L_ideal=L0+(L1-L0)*t;L_diff=L_actual-L_ideal;t0=0;t1=1;max_iter=20;while(Math.abs(L_diff)>0.01&&max_iter-->0){!function(){if(pol){L_diff*=-1}if(L_diff<0){t0=t;t+=(t1-t)*0.5}else{t1=t;t+=(t0-t)*0.5}L_actual=getColor(t,true).lab()[0];return L_diff=L_actual-L_ideal}()}return t}}else{tmap=function(t){return t}}return f};return f};if((_ref=chroma.scales)==null){chroma.scales={}}chroma.scales.cool=function(){return chroma.scale([chroma.hsl(180,1,0.9),chroma.hsl(250,0.7,0.4)])};chroma.scales.hot=function(){return chroma.scale(["#000","#f00","#ff0","#fff"],[0,0.25,0.75,1]).mode("rgb")};chroma.analyze=function(data,key,filter){var add,k,r,val,visit,_i,_len;r={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};if(filter==null){filter=function(){return true}}add=function(val){if(val!=null&&!isNaN(val)){r.values.push(val);r.sum+=val;if(val<r.min){r.min=val}if(val>r.max){r.max=val}r.count+=1}};visit=function(val,k){if(filter(val,k)){if(key!=null&&type(key)==="function"){return add(key(val))}else{if(key!=null&&type(key)==="string"||type(key)==="number"){return add(val[key])}else{return add(val)}}}};if(type(data)==="array"){for(_i=0,_len=data.length;_i<_len;_i++){val=data[_i];visit(val)}}else{for(k in data){val=data[k];visit(val,k)}}r.domain=[r.min,r.max];r.limits=function(mode,num){return chroma.limits(r,mode,num)};return r};chroma.limits=function(data,mode,num){var assignments,best,centroids,cluster,clusterSizes,dist,i,j,kClusters,limits,max,max_log,min,min_log,mindist,n,nb_iters,newCentroids,p,pb,pr,repeat,sum,tmpKMeansBreaks,value,values,_i,_j,_k,_l,_m,_n,_o,_p,_q,_r,_ref1,_ref10,_ref11,_ref12,_ref13,_ref14,_ref15,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_ref9,_s,_t,_u,_v,_w;if(mode==null){mode="equal"}if(num==null){num=7}if(data.values==null){data=chroma.analyze(data)}min=data.min;max=data.max;sum=data.sum;values=data.values.sort(function(a,b){return a-b});limits=[];if(mode.substr(0,1)==="c"){limits.push(min);limits.push(max)}if(mode.substr(0,1)==="e"){limits.push(min);for(i=_i=1,_ref1=num-1;1<=_ref1?_i<=_ref1:_i>=_ref1;i=1<=_ref1?++_i:--_i){limits.push(min+i/num*(max-min))}limits.push(max)}else{if(mode.substr(0,1)==="l"){if(min<=0){throw"Logarithmic scales are only possible for values > 0"}min_log=Math.LOG10E*Math.log(min);max_log=Math.LOG10E*Math.log(max);limits.push(min);for(i=_j=1,_ref2=num-1;1<=_ref2?_j<=_ref2:_j>=_ref2;i=1<=_ref2?++_j:--_j){limits.push(Math.pow(10,min_log+i/num*(max_log-min_log)))}limits.push(max)}else{if(mode.substr(0,1)==="q"){limits.push(min);for(i=_k=1,_ref3=num-1;1<=_ref3?_k<=_ref3:_k>=_ref3;i=1<=_ref3?++_k:--_k){p=values.length*i/num;pb=Math.floor(p);if(pb===p){limits.push(values[pb])}else{pr=p-pb;limits.push(values[pb]*pr+values[pb+1]*(1-pr))}}limits.push(max)}else{if(mode.substr(0,1)==="k"){n=values.length;assignments=new Array(n);clusterSizes=new Array(num);repeat=true;nb_iters=0;centroids=null;centroids=[];centroids.push(min);for(i=_l=1,_ref4=num-1;1<=_ref4?_l<=_ref4:_l>=_ref4;i=1<=_ref4?++_l:--_l){centroids.push(min+i/num*(max-min))}centroids.push(max);while(repeat){for(j=_m=0,_ref5=num-1;0<=_ref5?_m<=_ref5:_m>=_ref5;j=0<=_ref5?++_m:--_m){clusterSizes[j]=0}for(i=_n=0,_ref6=n-1;0<=_ref6?_n<=_ref6:_n>=_ref6;i=0<=_ref6?++_n:--_n){value=values[i];mindist=Number.MAX_VALUE;for(j=_o=0,_ref7=num-1;0<=_ref7?_o<=_ref7:_o>=_ref7;j=0<=_ref7?++_o:--_o){dist=Math.abs(centroids[j]-value);if(dist<mindist){mindist=dist;best=j}}clusterSizes[best]++;assignments[i]=best}newCentroids=new Array(num);for(j=_p=0,_ref8=num-1;0<=_ref8?_p<=_ref8:_p>=_ref8;j=0<=_ref8?++_p:--_p){newCentroids[j]=null}for(i=_q=0,_ref9=n-1;0<=_ref9?_q<=_ref9:_q>=_ref9;i=0<=_ref9?++_q:--_q){cluster=assignments[i];if(newCentroids[cluster]===null){newCentroids[cluster]=values[i]}else{newCentroids[cluster]+=values[i]}}for(j=_r=0,_ref10=num-1;0<=_ref10?_r<=_ref10:_r>=_ref10;j=0<=_ref10?++_r:--_r){newCentroids[j]*=1/clusterSizes[j]}repeat=false;for(j=_s=0,_ref11=num-1;0<=_ref11?_s<=_ref11:_s>=_ref11;j=0<=_ref11?++_s:--_s){if(newCentroids[j]!==centroids[i]){repeat=true;break}}centroids=newCentroids;nb_iters++;if(nb_iters>200){repeat=false}}kClusters={};for(j=_t=0,_ref12=num-1;0<=_ref12?_t<=_ref12:_t>=_ref12;j=0<=_ref12?++_t:--_t){kClusters[j]=[]}for(i=_u=0,_ref13=n-1;0<=_ref13?_u<=_ref13:_u>=_ref13;i=0<=_ref13?++_u:--_u){cluster=assignments[i];kClusters[cluster].push(values[i])}tmpKMeansBreaks=[];for(j=_v=0,_ref14=num-1;0<=_ref14?_v<=_ref14:_v>=_ref14;j=0<=_ref14?++_v:--_v){tmpKMeansBreaks.push(kClusters[j][0]);tmpKMeansBreaks.push(kClusters[j][kClusters[j].length-1])}tmpKMeansBreaks=tmpKMeansBreaks.sort(function(a,b){return a-b});limits.push(tmpKMeansBreaks[0]);for(i=_w=1,_ref15=tmpKMeansBreaks.length-1;_w<=_ref15;i=_w+=2){if(!isNaN(tmpKMeansBreaks[i])){limits.push(tmpKMeansBreaks[i])}}}}}}return limits};root=typeof exports!=="undefined"&&exports!==null?exports:this;chroma.brewer=brewer={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]};root=typeof exports!=="undefined"&&exports!==null?exports:this;chroma.colors=colors={indigo:"#4b0082",gold:"#ffd700",hotpink:"#ff69b4",firebrick:"#b22222",indianred:"#cd5c5c",yellow:"#ffff00",mistyrose:"#ffe4e1",darkolivegreen:"#556b2f",olive:"#808000",darkseagreen:"#8fbc8f",pink:"#ffc0cb",tomato:"#ff6347",lightcoral:"#f08080",orangered:"#ff4500",navajowhite:"#ffdead",lime:"#00ff00",palegreen:"#98fb98",darkslategrey:"#2f4f4f",greenyellow:"#adff2f",burlywood:"#deb887",seashell:"#fff5ee",mediumspringgreen:"#00fa9a",fuchsia:"#ff00ff",papayawhip:"#ffefd5",blanchedalmond:"#ffebcd",chartreuse:"#7fff00",dimgray:"#696969",black:"#000000",peachpuff:"#ffdab9",springgreen:"#00ff7f",aquamarine:"#7fffd4",white:"#ffffff",orange:"#ffa500",lightsalmon:"#ffa07a",darkslategray:"#2f4f4f",brown:"#a52a2a",ivory:"#fffff0",dodgerblue:"#1e90ff",peru:"#cd853f",lawngreen:"#7cfc00",chocolate:"#d2691e",crimson:"#dc143c",forestgreen:"#228b22",darkgrey:"#a9a9a9",lightseagreen:"#20b2aa",cyan:"#00ffff",mintcream:"#f5fffa",silver:"#c0c0c0",antiquewhite:"#faebd7",mediumorchid:"#ba55d3",skyblue:"#87ceeb",gray:"#808080",darkturquoise:"#00ced1",goldenrod:"#daa520",darkgreen:"#006400",floralwhite:"#fffaf0",darkviolet:"#9400d3",darkgray:"#a9a9a9",moccasin:"#ffe4b5",saddlebrown:"#8b4513",grey:"#808080",darkslateblue:"#483d8b",lightskyblue:"#87cefa",lightpink:"#ffb6c1",mediumvioletred:"#c71585",slategrey:"#708090",red:"#ff0000",deeppink:"#ff1493",limegreen:"#32cd32",darkmagenta:"#8b008b",palegoldenrod:"#eee8aa",plum:"#dda0dd",turquoise:"#40e0d0",lightgrey:"#d3d3d3",lightgoldenrodyellow:"#fafad2",darkgoldenrod:"#b8860b",lavender:"#e6e6fa",maroon:"#800000",yellowgreen:"#9acd32",sandybrown:"#f4a460",thistle:"#d8bfd8",violet:"#ee82ee",navy:"#000080",magenta:"#ff00ff",dimgrey:"#696969",tan:"#d2b48c",rosybrown:"#bc8f8f",olivedrab:"#6b8e23",blue:"#0000ff",lightblue:"#add8e6",ghostwhite:"#f8f8ff",honeydew:"#f0fff0",cornflowerblue:"#6495ed",slateblue:"#6a5acd",linen:"#faf0e6",darkblue:"#00008b",powderblue:"#b0e0e6",seagreen:"#2e8b57",darkkhaki:"#bdb76b",snow:"#fffafa",sienna:"#a0522d",mediumblue:"#0000cd",royalblue:"#4169e1",lightcyan:"#e0ffff",green:"#008000",mediumpurple:"#9370db",midnightblue:"#191970",cornsilk:"#fff8dc",paleturquoise:"#afeeee",bisque:"#ffe4c4",slategray:"#708090",darkcyan:"#008b8b",khaki:"#f0e68c",wheat:"#f5deb3",teal:"#008080",darkorchid:"#9932cc",deepskyblue:"#00bfff",salmon:"#fa8072",darkred:"#8b0000",steelblue:"#4682b4",palevioletred:"#db7093",lightslategray:"#778899",aliceblue:"#f0f8ff",lightslategrey:"#778899",lightgreen:"#90ee90",orchid:"#da70d6",gainsboro:"#dcdcdc",mediumseagreen:"#3cb371",lightgray:"#d3d3d3",mediumturquoise:"#48d1cc",lemonchiffon:"#fffacd",cadetblue:"#5f9ea0",lightyellow:"#ffffe0",lavenderblush:"#fff0f5",coral:"#ff7f50",purple:"#800080",aqua:"#00ffff",whitesmoke:"#f5f5f5",mediumslateblue:"#7b68ee",darkorange:"#ff8c00",mediumaquamarine:"#66cdaa",darksalmon:"#e9967a",beige:"#f5f5dc",blueviolet:"#8a2be2",azure:"#f0ffff",lightsteelblue:"#b0c4de",oldlace:"#fdf5e6"};type=function(){var classToType,name,_i,_len,_ref1;classToType={};_ref1="Boolean Number String Function Array Date RegExp Undefined Null".split(" ");for(_i=0,_len=_ref1.length;_i<_len;_i++){name=_ref1[_i];classToType["[object "+name+"]"]=name.toLowerCase()}return function(obj){var strType;strType=Object.prototype.toString.call(obj);return classToType[strType]||"object"}}();limit=function(x,min,max){if(min==null){min=0}if(max==null){max=1}if(x<min){x=min}if(x>max){x=max}return x};unpack=function(args){if(args.length>=3){return args}else{return args[0]}};TWOPI=Math.PI*2;PITHIRD=Math.PI/3;cos=Math.cos;bezier=function(colors){var I,I0,I1,c,lab0,lab1,lab2,lab3,_ref1,_ref2,_ref3;colors=function(){var _i,_len,_results;_results=[];for(_i=0,_len=colors.length;_i<_len;_i++){c=colors[_i];_results.push(chroma(c))}return _results}();if(colors.length===2){_ref1=function(){var _i,_len,_results;_results=[];for(_i=0,_len=colors.length;_i<_len;_i++){c=colors[_i];_results.push(c.lab())}return _results}(),lab0=_ref1[0],lab1=_ref1[1];I=function(t){var i,lab;lab=function(){var _i,_results;_results=[];for(i=_i=0;_i<=2;i=++_i){_results.push(lab0[i]+t*(lab1[i]-lab0[i]))}return _results}();return chroma.lab.apply(chroma,lab)}}else{if(colors.length===3){_ref2=function(){var _i,_len,_results;_results=[];for(_i=0,_len=colors.length;_i<_len;_i++){c=colors[_i];_results.push(c.lab())}return _results}(),lab0=_ref2[0],lab1=_ref2[1],lab2=_ref2[2];I=function(t){var i,lab;lab=function(){var _i,_results;_results=[];for(i=_i=0;_i<=2;i=++_i){_results.push((1-t)*(1-t)*lab0[i]+2*(1-t)*t*lab1[i]+t*t*lab2[i])}return _results}();return chroma.lab.apply(chroma,lab)}}else{if(colors.length===4){_ref3=function(){var _i,_len,_results;_results=[];for(_i=0,_len=colors.length;_i<_len;_i++){c=colors[_i];_results.push(c.lab())}return _results}(),lab0=_ref3[0],lab1=_ref3[1],lab2=_ref3[2],lab3=_ref3[3];I=function(t){var i,lab;lab=function(){var _i,_results;_results=[];for(i=_i=0;_i<=2;i=++_i){_results.push((1-t)*(1-t)*(1-t)*lab0[i]+3*(1-t)*(1-t)*t*lab1[i]+3*(1-t)*t*t*lab2[i]+t*t*t*lab3[i])}return _results}();return chroma.lab.apply(chroma,lab)}}else{if(colors.length===5){I0=bezier(colors.slice(0,3));I1=bezier(colors.slice(2,5));I=function(t){if(t<0.5){return I0(t*2)}else{return I1((t-0.5)*2)}}}}}}return I};chroma.interpolate.bezier=bezier}.call(this);(function(){var root=this,dw={};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=dw}exports.dw=dw}else{window.dw=dw}dw.dataset=function(columns,opts){var columnsByName={},origColumns=columns.slice(0);_.each(columns,function(col){uniqueName(col);columnsByName[col.name()]=col});opts=_.extend(opts,{});function uniqueName(col){var origColName=col.name(),colName=origColName,appendix=1;while(columnsByName.hasOwnProperty(colName)){colName=origColName+"."+(appendix++)}if(colName!=origColName){col.name(colName)}}var dataset={columns:function(){return columns},column:function(x){if(_.isString(x)){if(columnsByName[x]!==undefined){return columnsByName[x]}throw'No column found with that name: "'+x+'"'}if(columns[x]!==undefined){return columns[x]}throw"No column found with that index: "+x},numColumns:function(){return columns.length},numRows:function(){return columns[0].length},eachColumn:function(func){_.each(columns,func)},hasColumn:function(x){return(_.isString(x)?columnsByName[x]:columns[x])!==undefined},indexOf:function(column_name){if(!dataset.hasColumn(column_name)){return -1}return _.indexOf(columns,columnsByName[column_name])},toCSV:function(){var csv="",sep=",",quote='"';_.each(columns,function(col,i){var t=col.title();if(t.indexOf(quote)>-1){t.replace(quote,"\\"+quote)}if(t.indexOf(sep)>-1){t=quote+t+quote}csv+=(i>0?sep:"")+t});_.each(_.range(dataset.numRows()),function(row){csv+="\n";_.each(columns,function(col,i){var t=""+(col.type()=="date"?col.raw(row):col.val(row));if(t.indexOf(quote)>-1){t.replace(quote,"\\"+quote)}if(t.indexOf(sep)>-1){t=quote+t+quote}csv+=(i>0?sep:"")+t})});return csv},filterColumns:function(ignore){columns=_.filter(columns,function(c){return !ignore[c.name()]});_.each(ignore,function(ign,key){if(ign&&columnsByName[key]){delete columnsByName[key]}});return dataset},eachRow:function(func){var i;for(i=0;i<dataset.numRows();i++){func(i)}return dataset},add:function(column){uniqueName(column);columns.push(column);columnsByName[column.name()]=column;return dataset},reset:function(){columns=origColumns.slice(0);columnsByName={};_.each(columns,function(col){columnsByName[col.name()]=col});return dataset}};return dataset};dw.column=function(name,rows,type){function guessType(sample){if(_.every(rows,_.isNumber)){return dw.column.types.number()}if(_.every(rows,_.isDate)){return dw.column.types.date()}var types=[dw.column.types.date(sample),dw.column.types.number(sample),dw.column.types.text()],type,k=rows.length,tolerance=0.1;_.each(rows,function(val){_.each(types,function(t){t.parse(val)})});_.every(types,function(t){if(t.errors()/k<tolerance){type=t}return !type});return type}var sample=_.map(_.shuffle(_.range(rows.length)).slice(0,200),function(i){return rows[i]});type=type?dw.column.types[type](sample):guessType(sample);var range,total,origRows=rows.slice(0),title;var column={name:function(){if(arguments.length){name=arguments[0];return column}return dw.utils.purifyHtml(name)},title:function(){if(arguments.length){title=arguments[0];return column}return dw.utils.purifyHtml(title||name)},length:rows.length,val:function(i,unfiltered){if(!arguments.length){return undefined}var r=unfiltered?origRows:rows;if(i<0){i+=r.length}return type.parse(dw.utils.purifyHtml(r[i]))},values:function(unfiltered){var r=unfiltered?origRows:rows;r=_.map(r,dw.utils.purifyHtml);return _.map(r,type.parse)},each:function(f){for(i=0;i<rows.length;i++){f(column.val(i),i)}},raw:function(i,val){if(!arguments.length){return rows}if(arguments.length==2){rows[i]=val;return column}return dw.utils.purifyHtml(rows[i])},type:function(o){if(o===true){return type}if(_.isString(o)){if(dw.column.types[o]){type=dw.column.types[o](sample);return column}else{throw"unknown column type: "+o}}return type.name()},range:function(){if(!type.toNum){return false}if(!range){range=[Number.MAX_VALUE,-Number.MAX_VALUE];column.each(function(v){v=type.toNum(v);if(!_.isNumber(v)||_.isNaN(v)){return}if(v<range[0]){range[0]=v}if(v>range[1]){range[1]=v}});range[0]=type.fromNum(range[0]);range[1]=type.fromNum(range[1])}return range},total:function(){if(!type.toNum){return false}if(!total){total=0;column.each(function(v){total+=type.toNum(v)});total=type.fromNum(total)}return total},filterRows:function(r){rows=[];if(arguments.length){_.each(r,function(i){rows.push(origRows[i])})}else{rows=origRows.slice(0)}column.length=rows.length;range=total=false;return column},toString:function(){return name+" ("+type.name()+")"},indexOf:function(val){return _.find(_.range(rows.length),function(i){return column.val(i)==val})}};return column};dw.column.types={};dw.column.types.text=function(){return{parse:_.identity,errors:function(){return 0},name:function(){return"text"},formatter:function(){return _.identity},isValid:function(){return true},format:function(){}}};dw.column.types.number=function(sample){function signDigitsDecimalPlaces(num,sig){if(num===0){return 0}return Math.round(sig-Math.ceil(Math.log(Math.abs(num))/Math.LN10))}var format,errors=0,knownFormats={"-.":/^ *-?[0-9]*(\.[0-9]+)?(e[\+\-][0-9]+) *$/,"-,":/^ *-?[0-9]*(,[0-9]+)? *$/,",.":/^ *-?[0-9]{1,3}(,[0-9]{3})*(\.[0-9]+)? *$/,".,":/^ *-?[0-9]{1,3}(\.[0-9]{3})*(,[0-9]+)? *$/," .":/^ *-?[0-9]{1,3}( [0-9]{3})*(\.[0-9]+)? *$/," ,":/^ *-?[0-9]{1,3}( [0-9]{3})*(,[0-9]+)? *$/," .":/^ *-?[0-9]{1,3}( [0-9]{3})*(\.[0-9]+)? *$/," ,":/^ *-?[0-9]{1,3}( [0-9]{3})*(,[0-9]+)? *$/},formatLabels={"-.":"1234.56","-,":"1234,56",",.":"1,234.56",".,":"1.234,56"," .":"1 234.56"," ,":"1 234,56"," .":"1 234.56"," ,":"1 234,56"},naStrings={na:1,"n/a":1,"-":1,":":1};var matches={},bestMatch=["-.",0];sample=sample||[];_.each(sample,function(n){_.each(knownFormats,function(regex,fmt){if(matches[fmt]===undefined){matches[fmt]=0}if(regex.test(n)){matches[fmt]+=1;if(matches[fmt]>bestMatch[1]){bestMatch[0]=fmt;bestMatch[1]=matches[fmt]}}})});format=bestMatch[0];var type={parse:function(raw){if(_.isNumber(raw)||_.isUndefined(raw)||_.isNull(raw)){return raw}var number=raw;if(format[0]!="-"){number=number.replace(format[0],"")}if(format[1]!="."){number=number.replace(format[1],".")}if(isNaN(number)||number===""){if(!naStrings[number.toLowerCase()]&&number!==""){errors++}return raw}return Number(number)},toNum:function(i){return i},fromNum:function(i){return i},errors:function(){return errors},name:function(){return"number"},formatter:function(config){var format=config["number-format"]||"-",div=Number(config["number-divisor"]||0),append=(config["number-append"]||"").replace(/ /g,"\u00A0"),prepend=(config["number-prepend"]||"").replace(/ /g,"\u00A0");return function(val,full,round){if(isNaN(val)){return val}var _fmt=format;if(div!==0&&_fmt=="-"){_fmt="n1"}if(div!==0){val=Number(val)/Math.pow(10,div)}if(_fmt.substr(0,1)=="s"){var sig=+_fmt.substr(1);_fmt="n"+Math.max(0,signDigitsDecimalPlaces(val,sig))}if(round){_fmt="n0"}val=Globalize.format(val,_fmt!="-"?_fmt:null);return full?prepend+val+append:val}},isValid:function(val){return val===""||naStrings[String(val).toLowerCase()]||_.isNumber(type.parse(val))},ambiguousFormats:function(){var candidates=[];_.each(matches,function(cnt,fmt){if(cnt==bestMatch[1]){candidates.push([fmt,formatLabels[fmt]])}});return candidates},format:function(fmt){if(arguments.length){format=fmt;return type}return format}};return type};dw.column.types.date=function(sample){var format,errors=0,matches={},bestMatch=["",0],knownFormats={YYYY:{test:/^ *(?:1[7-9]|20)\d{2} *$/,parse:/^ *(\d{4}) *$/,precision:"year"},"YYYY-H":{test:/^ *[12]\d{3}[ \-\/]?[hH][12] *$/,parse:/^ *(\d{4})[ \-\/]?[hH]([12]) *$/,precision:"half"},"H-YYYY":{test:/^ *[hH][12][ \-\/][12]\d{3} *$/,parse:/^ *[hH]([12])[ \-\/](\d{4}) *$/,precision:"half"},"YYYY-Q":{test:/^ *[12]\d{3}[ \-\/]?[qQ][1234] *$/,parse:/^ *(\d{4})[ \-\/]?[qQ]([1234]) *$/,precision:"quarter"},"Q-YYYY":{test:/^ *[qQ]([1234])[ \-\/][12]\d{3} *$/,parse:/^ *[qQ]([1234])[ \-\/](\d{4}) *$/,precision:"quarter"},"YYYY-M":{test:/^ *([12]\d{3}) ?[ \-\/\.mM](0?[1-9]|1[0-2]) *$/,parse:/^ *(\d{4}) ?[ \-\/\.mM](0?[1-9]|1[0-2]) *$/,precision:"month"},"M-YYYY":{test:/^ *(0?[1-9]|1[0-2]) ?[ \-\/\.][12]\d{3} *$/,parse:/^ *(0?[1-9]|1[0-2]) ?[ \-\/\.](\d{4}) *$/,precision:"month"},"YYYY-WW":{test:/^ *[12]\d{3}[ -]?[wW](0?[1-9]|[1-4]\d|5[0-3]) *$/,parse:/^ *(\d{4})[ -]?[wW](0?[1-9]|[1-4]\d|5[0-3]) *$/,precision:"week"},"MM/DD/YYYY":{test:/^ *(0?[1-9]|1[0-2])([\-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2([12]\d{3})$/,parse:/^ *(0?[1-9]|1[0-2])([\-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2(\d{4})$/,precision:"day"},"DD/MM/YYYY":{test:/^ *(0?[1-9]|[1-2]\d|3[01])([\-\.\/ ?])(0?[1-9]|1[0-2])\2([12]\d{3})$/,parse:/^ *(0?[1-9]|[1-2]\d|3[01])([\-\.\/ ?])(0?[1-9]|1[0-2])\2(\d{4})$/,precision:"day"},"YYYY-MM-DD":{test:/^ *([12]\d{3})([\-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01])$/,parse:/^ *(\d{4})([\-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01])$/,precision:"day"},"YYYY-WW-d":{test:/^ *[12]\d{3}[ \-]?[wW](0?[1-9]|[1-4]\d|5[0-3])(?:[ \-]?[1-7]) *$/,parse:/^ *(\d{4})[ \-]?[wW](0?[1-9]|[1-4]\d|5[0-3])(?:[ \-]?([1-7])) *$/,precision:"day"},"MM/DD/YYYY HH:MM":{test:/^ *(0?[1-9]|1[0-2])([-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2([12]\d{3}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,parse:/^ *(0?[1-9]|1[0-2])([-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2(\d{4}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,precision:"day-minutes"},"DD.MM.YYYY HH:MM":{test:/^ *(0?[1-9]|[1-2]\d|3[01])([-\.\/ ?])(0?[1-9]|1[0-2])\2([12]\d{3}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,parse:/^ *(0?[1-9]|[1-2]\d|3[01])([-\.\/ ?])(0?[1-9]|1[0-2])\2(\d{4}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,precision:"day-minutes"},"YYYY-MM-DD HH:MM":{test:/^ *([12]\d{3})([-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01]) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,parse:/^ *(\d{4})([-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01]) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d) *$/,precision:"day-minutes"},"MM/DD/YYYY HH:MM:SS":{test:/^ *(0?[1-9]|1[0-2])([-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2([12]\d{3}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,parse:/^ *(0?[1-9]|1[0-2])([-\/] ?)(0?[1-9]|[1-2]\d|3[01])\2(\d{4}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,precision:"day-seconds"},"DD.MM.YYYY HH:MM:SS":{test:/^ *(0?[1-9]|[1-2]\d|3[01])([-\.\/ ?])(0?[1-9]|1[0-2])\2([12]\d{3}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,parse:/^ *(0?[1-9]|[1-2]\d|3[01])([-\.\/ ?])(0?[1-9]|1[0-2])\2(\d{4}) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,precision:"day-seconds"},"YYYY-MM-DD HH:MM:SS":{test:/^ *([12]\d{3})([-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01]) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,parse:/^ *(\d{4})([-\/\. ?])(0?[1-9]|1[0-2])\2(0?[1-9]|[1-2]\d|3[01]) *[ \-\|] *(0?\d|1\d|2[0-3]):([0-5]\d)(?::([0-5]\d))? *$/,precision:"day-seconds"}};function test(str,key){var fmt=knownFormats[key];if(_.isRegExp(fmt.test)){return fmt.test.test(str)}else{return fmt.test(str,key)}}function parse(str,key){var fmt=knownFormats[key];if(_.isRegExp(fmt.parse)){return str.match(fmt.parse)}else{return fmt.parse(str,key)}}sample=sample||[];_.each(knownFormats,function(format,key){_.each(sample,function(n){if(matches[key]===undefined){matches[key]=0}if(test(n,key)){matches[key]+=1;if(matches[key]>bestMatch[1]){bestMatch[0]=key;bestMatch[1]=matches[key]}}})});format=bestMatch[0];function dateFromIsoWeek(year,week,day){var d=new Date(Date.UTC(year,0,3));d.setUTCDate(3-d.getUTCDay()+(week-1)*7+parseInt(day,10));return d}function dateToIsoWeek(date){var d=date.getUTCDay(),t=new Date(date.valueOf());t.setDate(t.getDate()-((d+6)%7)+3);var iso_year=t.getUTCFullYear(),w=Math.floor((t.getTime()-new Date(iso_year,0,1,-6))/86400000);return[iso_year,1+Math.floor(w/7),d>0?d:7]}var type={parse:function(raw){if(_.isDate(raw)||_.isUndefined(raw)){return raw}if(!format||!_.isString(raw)){errors++;return raw}var m=parse(raw,format);if(!m){errors++;return raw}else{if(!test(raw,format)){errors++}}switch(format){case"YYYY":return new Date(m[1],0,1);case"YYYY-H":return new Date(m[1],(m[2]-1)*6,1);case"H-YYYY":return new Date(m[2],(m[1]-1)*6,1);case"YYYY-Q":return new Date(m[1],(m[2]-1)*3,1);case"Q-YYYY":return new Date(m[2],(m[1]-1)*3,1);case"YYYY-M":return new Date(m[1],(m[2]-1),1);case"M-YYYY":return new Date(m[2],(m[1]-1),1);case"YYYY-WW":return dateFromIsoWeek(m[1],m[2],1);case"YYYY-WW-d":return dateFromIsoWeek(m[1],m[2],m[3]);case"YYYY-MM-DD":return new Date(m[1],(m[3]-1),m[4]);case"DD/MM/YYYY":return new Date(m[4],(m[3]-1),m[1]);case"MM/DD/YYYY":return new Date(m[4],(m[1]-1),m[3]);case"YYYY-MM-DD HH:MM":return new Date(m[1],(m[3]-1),m[4],m[5]||0,m[6]||0,0);case"DD.MM.YYYY HH:MM":return new Date(m[4],(m[3]-1),m[1],m[5]||0,m[6]||0,0);case"MM/DD/YYYY HH:MM":return new Date(m[4],(m[1]-1),m[3],m[5]||0,m[6]||0,0);case"YYYY-MM-DD HH:MM:SS":return new Date(m[1],(m[3]-1),m[4],m[5]||0,m[6]||0,m[7]||0);case"DD.MM.YYYY HH:MM:SS":return new Date(m[4],(m[3]-1),m[1],m[5]||0,m[6]||0,m[7]||0);case"MM/DD/YYYY HH:MM:SS":return new Date(m[4],(m[1]-1),m[3],m[5]||0,m[6]||0,m[7]||0)}errors++;return raw},toNum:function(d){return d.getTime()},fromNum:function(i){return new Date(i)},errors:function(){return errors},name:function(){return"date"},format:function(fmt){if(arguments.length){format=fmt;return type}return format},precision:function(){return knownFormats[format].precision},formatter:function(config){if(!format){return _.identity}var M_pattern=Globalize.culture().calendar.patterns.M.replace("MMMM","MMM");switch(knownFormats[format].precision){case"year":return function(d){return !_.isDate(d)?d:d.getFullYear()};case"half":return function(d){return !_.isDate(d)?d:d.getFullYear()+" H"+(d.getMonth()/6+1)};case"quarter":return function(d){return !_.isDate(d)?d:d.getFullYear()+" Q"+(d.getMonth()/3+1)};case"month":return function(d){return !_.isDate(d)?d:Globalize.format(d,"MMM yy")};case"week":return function(d){return !_.isDate(d)?d:dateToIsoWeek(d).slice(0,2).join(" W")};case"day":return function(d,verbose){return !_.isDate(d)?d:Globalize.format(d,verbose?"D":"d")};case"day-minutes":return function(d){return !_.isDate(d)?d:Globalize.format(d,M_pattern).replace(" ","&nbsp;")+" - "+Globalize.format(d,"t").replace(" ","&nbsp;")};case"day-seconds":return function(d){return !_.isDate(d)?d:Globalize.format(d,"T").replace(" ","&nbsp;")}}},isValid:function(val){return _.isDate(type.parse(val))},ambiguousFormats:function(){var candidates=[];_.each(matches,function(cnt,fmt){if(cnt==bestMatch[1]){candidates.push([fmt,fmt])}});return candidates}};return type};dw.datasource={};dw.datasource.delimited=function(opts){function loadAndParseCsv(){if(opts.url){return $.ajax({url:opts.url,method:"GET",dataType:"text"}).then(function(raw){return new DelimitedParser(opts).parse(raw)})}else{if(opts.csv){var dfd=$.Deferred(),parsed=dfd.then(function(raw){return new DelimitedParser(opts).parse(raw)});dfd.resolve(opts.csv);return parsed}}throw"you need to provide either an URL or CSV data."}var delimited={dataset:loadAndParseCsv};return delimited};var DelimitedParser=function(opts){opts=_.extend({delimiter:"auto",quoteChar:'"',skipRows:0,emptyValue:null,transpose:false,firstRowIsHeader:true},opts);this.__delimiterPatterns=getDelimiterPatterns(opts.delimiter,opts.quoteChar);this.opts=opts};function getDelimiterPatterns(delimiter,quoteChar){return new RegExp(("(\\"+delimiter+"|\\r?\\n|\\r|^)(?:"+quoteChar+"([^"+quoteChar+"]*(?:"+quoteChar+'"[^'+quoteChar+"]*)*)"+quoteChar+"|([^"+quoteChar+"\\"+delimiter+"\\r\\n]*))"),"gi")}_.extend(DelimitedParser.prototype,{parse:function(data){var me=this,opts=this.opts;me.__rawData=data;if(opts.delimiter=="auto"){opts.delimiter=me.guessDelimiter(data,opts.skipRows);me.__delimiterPatterns=getDelimiterPatterns(opts.delimiter,opts.quoteChar)}var columns=[],closure=opts.delimiter!="|"?"|":"#",arrData;data=closure+data.replace(/\s+$/g,"")+closure;function parseCSV(delimiterPattern,strData,strDelimiter){strDelimiter=(strDelimiter||",");var arrData=[[]];var arrMatches=null,strMatchedValue;while(arrMatches=delimiterPattern.exec(strData)){var strMatchedDelimiter=arrMatches[1];if(strMatchedDelimiter.length&&(strMatchedDelimiter!=strDelimiter)){arrData.push([])}if(arrMatches[2]){strMatchedValue=arrMatches[2].replace(new RegExp('""',"g"),'"')}else{strMatchedValue=arrMatches[3]}arrData[arrData.length-1].push(strMatchedValue)}if(arrData[0][0].substr(0,1)==closure){arrData[0][0]=arrData[0][0].substr(1)}var p=arrData.length-1,q=arrData[p].length-1,r=arrData[p][q].length-1;if(arrData[p][q].substr(r)==closure){arrData[p][q]=arrData[p][q].substr(0,r)}return(arrData)}function transpose(arrMatrix){var a=arrMatrix,w=a.length?a.length:0,h=a[0] instanceof Array?a[0].length:0;if(h===0||w===0){return[]}var i,j,t=[];for(i=0;i<h;i++){t[i]=[];for(j=0;j<w;j++){t[i][j]=a[j][i]}}return t}function makeDataset(arrData){var columns=[],columnNames={},rowCount=arrData.length,columnCount=arrData[0].length,rowIndex=opts.skipRows;var srcColumns=[];if(opts.firstRowIsHeader){srcColumns=arrData[rowIndex];rowIndex++}for(var c=0;c<columnCount;c++){var col=_.isString(srcColumns[c])?srcColumns[c].replace(/^\s+|\s+$/g,""):"",suffix=col!==""?"":1;col=col!==""?col:"X.";while(columnNames[col+suffix]!==undefined){suffix=suffix===""?1:suffix+1}columns.push({name:col+suffix,data:[]});columnNames[col+suffix]=true}_.each(_.range(rowIndex,rowCount),function(row){_.each(columns,function(c,i){c.data.push(arrData[row][i]!==""?arrData[row][i]:opts.emptyValue)})});columns=_.map(columns,function(c){return dw.column(c.name,c.data)});return dw.dataset(columns)}arrData=parseCSV(this.__delimiterPatterns,data,opts.delimiter);if(opts.transpose){arrData=transpose(arrData)}return makeDataset(arrData)},guessDelimiter:function(strData){var maxMatchCount=0,k=-1,me=this,delimiters=["\t",";","|",","];_.each(delimiters,function(delimiter,i){var regex=getDelimiterPatterns(delimiter,me.quoteChar),c=strData.match(regex).length;if(c>maxMatchCount){maxMatchCount=c;k=i}});return delimiters[k]}});dw.utils={minMax:function(columns){var minmax=[Number.MAX_VALUE,-Number.MAX_VALUE];_.each(columns,function(column){minmax[0]=Math.min(minmax[0],column.range()[0]);minmax[1]=Math.max(minmax[1],column.range()[1])});return minmax},dateFormat:function(daysDelta){var new_month=true,last_date=false;function timeFormat(formats){return function(date){new_month=!last_date||date.getMonth()!=last_date.getMonth();last_date=date;var i=formats.length-1,f=formats[i];while(!f[1](date)){f=formats[--i]}return f[0](date)}}function time_fmt(fmt){var format=function(date){var r=Globalize.format(date,fmt);return fmt!="htt"?r:r.toLowerCase()};return format}var fmt=(function(lang){return{date:lang=="de"?"dd.":"dd",hour:lang!="en"?"H:00":"htt",minute:lang=="de"?"H:mm":"h:mm",mm:lang=="de"?"d.M.":"MM/dd",mmm:lang=="de"?"d.MMM":"MMM dd",mmmm:lang=="de"?"d. MMMM":"MMMM dd"}})(Globalize.culture().language);return timeFormat([[time_fmt("yyyy"),function(){return true}],[time_fmt(daysDelta>70?"MMM":"MMM"),function(d){return d.getMonth()!==0}],[time_fmt(fmt.date),function(d){return d.getDate()!=1}],[time_fmt(daysDelta<7?fmt.mm:daysDelta>70?fmt.mmm:fmt.mmm),function(d){return d.getDate()!=1&&new_month}],[time_fmt(fmt.hour),function(d){return d.getHours()}],[time_fmt(fmt.minute),function(d){return d.getMinutes()}],[time_fmt(":ss"),function(d){return d.getSeconds()}],[time_fmt(".fff"),function(d){return d.getMilliseconds()}]])},longDateFormat:function(column){var me=this;return function(d){if(column.type()=="date"){switch(column.type(true).precision()){case"year":return d.getFullYear();case"quarter":return d.getFullYear()+" Q"+(d.getMonth()/3+1);case"month":return Globalize.format(d,"MMM yy");case"day":return Globalize.format(d,"MMM d");case"minute":return Globalize.format(d,"t");case"second":return Globalize.format(d,"T")}}else{return d}}},columnNameColumn:function(columns){var names=_.map(columns,function(col){return col.title()});return dw.column("",names)},name:function(obj){return _.isFunction(obj.name)?obj.name():_.isString(obj.name)?obj.name:obj},getMaxChartHeight:function(el){function margin(el,type){if($(el).css("margin-"+type)=="auto"){return 0}return +$(el).css("margin-"+type).replace("px","")}var ch=0,bottom=0;$("body > *").each(function(i,el){var t=el.tagName.toLowerCase();if(t!="script"&&el.id!="chart"&&!$(el).hasClass("tooltip")&&!$(el).hasClass("qtip")&&!$(el).hasClass("container")&&!$(el).hasClass("noscript")){ch+=$(el).outerHeight(false)}ch+=Math.max(margin(el,"top"),bottom);bottom=margin(el,"bottom")});ch+=bottom;var mt=$("#chart").css("margin-top").replace("px",""),mb=$("#chart").css("margin-bottom").replace("px",""),maxH=$(window).height()-ch-8;if(!$.support.leadingWhitespace){maxH-=15}maxH-=$("body").css("padding-top").replace("px","");maxH-=$("body").css("padding-bottom").replace("px","");return maxH},purifyHtml:function(input,allowed){var tags=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi,commentsAndPhpTags=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,default_allowed="<b><br><br/><i><strong><sup><sub><strike><u><em><tt>",allowed_split={};if(allowed===undefined){allowed=default_allowed}allowed_split[allowed]=(((allowed||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");function purifyHtml(input,allowed){if(!_.isString(input)||input.indexOf("<")<0){return input}if(allowed===undefined){allowed=default_allowed}if(!allowed_split[allowed]){allowed_split[allowed]=(((allowed||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("")}return input.replace(commentsAndPhpTags,"").replace(tags,function($0,$1){return allowed_split[allowed].indexOf("<"+$1.toLowerCase()+">")>-1?$0:""})}dw.utils.purifyHtml=purifyHtml;return purifyHtml(input,allowed)},significantDimension:function(values){var result=[],dimension=0,nonEqual=true,uniqValues=_.uniq(values),check,diff;if(uniqValues.length==1){return -1*Math.floor(Math.log(uniqValues[0])/Math.LN10)}if(_.uniq(_.map(uniqValues,round)).length==uniqValues.length){check=function(){return _.uniq(result).length==uniqValues.length};diff=-1}else{check=function(){return _.uniq(result).length<uniqValues.length};diff=+1}var max_iter=100;do{result=_.map(uniqValues,round);dimension+=diff}while(check()&&max_iter-->0);if(max_iter<10){console.warn("maximum iteration reached",values,result,dimension)}if(diff<0){dimension+=2}else{dimension--}function round(v){return dw.utils.round(v,dimension)}return dimension},round:function(value,dimension){var base=Math.pow(10,dimension);return Math.round(value*base)/base},smartRound:function(values,add_precision){var dim=dw.utils.significantDimension(values);dim+=add_precision||0;return _.map(values,function(v){return dw.utils.round(v,dim)})},nearest:function(array,value){var min_diff=Number.MAX_VALUE,min_diff_val;_.each(array,function(v){var d=Math.abs(v-value);if(d<min_diff){min_diff=d;min_diff_val=v}});return min_diff_val},metricSuffix:function(locale){switch(locale.substr(0,2).toLowerCase()){case"de":return{3:" Tsd.",6:" Mio.",9:" Mrd.",12:" Bio."};case"fr":return{3:" mil",6:" Mio",9:" Mrd"};case"es":return{3:" Mil",6:" millón"};default:return{3:"k",6:"M",9:" bil"}}},magnitudeRange:function(minmax){var e0=Math.round(Math.log(minmax[0])/Math.LN10),e1=Math.round(Math.log(minmax[1])/Math.LN10);return e1-e0},logTicks:function(min,max){var e0=Math.round(Math.log(min)/Math.LN10),e1=Math.round(Math.log(max)/Math.LN10);return _.map(_.range(e0,e1),function(exp){return Math.pow(10,exp)})}};dw.utils.filter=function(column,active,type,format){var callbacks=[],lastActiveRow;type=type||"auto";format=format||_.identity;if(type=="auto"){if(column.type()=="date"){type="timescale"}else{if(column.type()=="text"){type=column.length<6?"buttons":"select"}}}var filter={ui:getFilterUI(type),change:function(callback){callbacks.push(callback)}};function update(i){_.each(callbacks,function(cb){if(_.isFunction(cb)){cb(column.val(i),i)}})}function getFilterUI(type){var f;if(type=="auto"){type=column.type()=="date"?"timescale":column.length<6?"buttons":"select"}if(column.length<2){return function(){return false}}if(type=="select"){f=function(vis){var select=$("<select />");column.each(function(val,i){var lbl=format(val);if(!lbl){return}select.append('<option value="'+i+'">'+(_.isString(lbl)?$.trim(lbl):lbl)+"</option>")});select.change(function(evt){var cur=select.val();update(cur)});select.addClass("filter-ui filter-select");return select}}if(type=="buttons"){f=function(vis){var div=$("<div />");div.addClass("filter-ui filter-links");column.each(function(val,i){var lbl=format(val);if(!lbl){return}var a=$('<a href="#'+i+'"'+(i==active?' class="active" ':"")+">"+(_.isString(lbl)?$.trim(lbl):lbl)+"</a>").data("row",i);div.append(a)});$("a",div).click(function(e){var a=$(e.target);e.preventDefault();if(a.hasClass("active")){return}$("a",div).removeClass("active");a.addClass("active");update(a.data("row"))});div.appendTo("body");var fy=$("a:first",div).offset().top,ly=$("a:last",div).offset().top;if(fy!=ly){div.remove();return getFilterUI("select")(vis)}return div}}if(type=="timescale"){f=function(vis){var w=Math.min(vis.__w-30,Math.max(300,vis.__w*0.7)),timescale=d3.time.scale().domain([column.val(0),column.val(-1)]).range([0,w]),timesel=$("<div></div>").css({position:"relative",height:45,"margin-left":3}).addClass("filter-ui"),nticks=w/80,ticks=timescale.ticks(nticks),daysDelta=Math.round((column.val(-1).getTime()-column.val(0).getTime())/86400000),fmt=dw.utils.dateFormat(daysDelta),lfmt=column.type(true).formatter(),dots=timescale.ticks(w/8),lbl_x=function(i){return Math.max(-18,timescale(column.val(i))-40)};_.each(ticks,function(d){var s=$("<span>"+fmt(d)+"</span>"),x=timescale(d)-40,lw=vis.labelWidth(fmt(d));if(40-lw*0.5+x<0){x=-40+0.5*lw}s.css({position:"absolute",top:0,width:80,left:x,"text-align":"center",opacity:0.55});timesel.append(s)});_.each(dots,function(d){if(d.getTime()<column.val(0).getTime()||d.getTime()>column.val(-1).getTime()){return}var s=$('<span class="dot"></span>');s.css({position:"absolute",bottom:19,width:1,height:"1ex","border-left":"1px solid #000","vertical-align":"bottom",left:Math.round(timescale(d))+0.5});if(!_.find(ticks,function(td){return d.getTime()==td.getTime()})){s.css({height:"0.6ex",opacity:0.5})}timesel.append(s)});var pointer=$("<div>▲</div>").css({position:"absolute",width:20,bottom:2,left:timescale(column.val(active))-9,"text-align":"center"});timesel.append(pointer);var lbl=$("<div><span></span></div>").css({position:"absolute",width:80,top:0,left:lbl_x(active),"text-align":"center"}).data("last-txt",lfmt(column.val(active))).data("last-left",lbl_x(active));$("span",lbl).css({background:vis.theme().colors.background,"font-weight":"bold",padding:"0 1ex"}).html(lfmt(column.val(active)));timesel.append(lbl);$("<div />").css({position:"absolute",width:w+1,bottom:15,height:2,"border-bottom":"1px solid #000"}).appendTo(timesel);var bar=$("<div />").css({position:"absolute",left:0,width:w,height:40});timesel.append(bar);function nearest(rel_x){var x_date=timescale.invert(rel_x),min_dist=Number.MAX_VALUE,nearest_row=0;column.each(function(date,i){var dist=Math.abs(date.getTime()-x_date.getTime());if(dist<min_dist){min_dist=dist;nearest_row=i}});return nearest_row}var autoClickTimer;bar.click(function(evt){var rel_x=evt.clientX-bar.offset().left,nearest_row=nearest(rel_x);update(nearest_row);timesel.data("update-func")(nearest_row);clearTimeout(autoClickTimer)});bar.mousemove(function(evt){var rel_x=evt.clientX-bar.offset().left,nearest_row=nearest(rel_x);$("span",lbl).html(lfmt(column.val(nearest_row)));lbl.css({left:lbl_x(nearest_row)});pointer.css({left:timescale(column.val(nearest_row))-10});clearTimeout(autoClickTimer);autoClickTimer=setTimeout(function(){update(nearest_row);lbl.data("last-left",lbl_x(nearest_row));lbl.data("last-txt",lbl.text())},500)});bar.mouseleave(function(){lbl.css({left:lbl.data("last-left")});pointer.css({left:lbl.data("last-left")+30});$("span",lbl).html(lbl.data("last-txt"));clearTimeout(autoClickTimer)});timesel.data("update-func",function(i){pointer.stop().animate({left:timescale(column.val(i))-10},500,"expoInOut");var l_x=lbl_x(i),lbl_txt=lfmt(column.val(i));$("span",lbl).html(lbl_txt);lbl.css({left:l_x});lbl.data("last-left",l_x);lbl.data("last-txt",lbl_txt)});return timesel}}return f}return filter};dw.chart=function(attributes){var dataset,theme,visualization,metric_prefix,change_callbacks=$.Callbacks(),locale;var chart={get:function(key,_default){var keys=key.split("."),pt=attributes;_.some(keys,function(key){if(_.isUndefined(pt)||_.isNull(pt)){return true}pt=pt[key];return false});return _.isUndefined(pt)||_.isNull(pt)?_default:pt},set:function(key,value){var keys=key.split("."),lastKey=keys.pop(),pt=attributes;_.each(keys,function(key){if(_.isUndefined(pt[key])||_.isNull(pt[key])){pt[key]={}}pt=pt[key]});if(!_.isEqual(pt[lastKey],value)){pt[lastKey]=value;change_callbacks.fire(chart,key,value)}return this},load:function(){var datasource;datasource=dw.datasource.delimited({url:"data.csv",firstRowIsHeader:chart.get("metadata.data.horizontal-header",true),transpose:chart.get("metadata.data.transpose",false)});return datasource.dataset().pipe(function(ds){chart.dataset(ds);return ds})},dataset:function(ds){if(arguments.length){dataset=applyChanges(ds);return chart}return dataset},theme:function(_theme){if(arguments.length){theme=_theme;return chart}return theme||{}},vis:function(_vis){if(arguments.length){visualization=_vis;visualization.chart(chart);return chart}return visualization},hasHighlight:function(){var hl=chart.get("metadata.visualize.highlighted-series");return _.isArray(hl)&&hl.length>0},isHighlighted:function(obj){if(_.isUndefined(obj)===undefined){return false}var hl=this.get("metadata.visualize.highlighted-series"),obj_name=dw.utils.name(obj);return !_.isArray(hl)||hl.length===0||_.indexOf(hl,obj_name)>=0},locale:function(_locale){if(arguments.length){locale=_locale;Globalize.culture(locale);return chart}return locale},metricPrefix:function(_metric_prefix){if(arguments.length){metric_prefix=_metric_prefix;return chart}return metric_prefix},formatValue:function(val,full,round){var format=chart.get("metadata.describe.number-format"),div=Number(chart.get("metadata.describe.number-divisor")),append=chart.get("metadata.describe.number-append","").replace(" ","&nbsp;"),prepend=chart.get("metadata.describe.number-prepend","").replace(" ","&nbsp;");if(div!==0){val=Number(val)/Math.pow(10,div)}if(format!="-"){if(round||val==Math.round(val)){format=format.substr(0,1)+"0"}val=Globalize.format(val,format)}else{if(div!==0){val=val.toFixed(1)}}return full?prepend+val+append:val},render:function(container){if(!visualization||!theme||!dataset){throw"cannot render the chart!"}visualization.chart(chart);visualization.__init();var $cont=$(container);$cont.parent().addClass("vis-"+visualization.id).addClass("theme-"+theme.id);visualization.render($cont)},attributes:function(attrs){if(arguments.length){attributes=attrs;return chart}return attributes},onChange:change_callbacks.add,columnFormatter:function(column){var colFormat=chart.get("metadata.data.column-format",{});colFormat=colFormat[column.name()]||{};if(column.type()=="number"&&colFormat=="auto"){var mtrSuf=dw.utils.metricSuffix(chart.locale()),values=column.values(),dim=dw.utils.significantDimension(values),div=dim<-2?Math.round((dim*-1)/3)*3:dim>2?dim*-1:0;ndim=dw.utils.significantDimension(_.map(values,function(v){return v/Math.pow(10,div)}));colFormat={"number-divisor":div,"number-append":div?mtrSuf[div]||" × 10<sup>"+div+"</sup>":"","number-format":"n"+Math.max(0,ndim)}}return column.type(true).formatter(colFormat)}};function applyChanges(dataset){var changes=chart.get("metadata.data.changes",[]);var transpose=chart.get("metadata.data.transpose",false);_.each(changes,function(change){var row="row",column="column";if(transpose){row="column";column="row"}if(dataset.hasColumn(change[column])){if(change[row]===0){dataset.column(change[column]).title(change.value)}else{dataset.column(change[column]).raw(change[row]-1,change.value)}}});var columnFormats=chart.get("metadata.data.column-format",{});_.each(columnFormats,function(columnFormat,key){if(columnFormat.type&&dataset.hasColumn(key)){dataset.column(key).type(columnFormat.type)}if(columnFormat["input-format"]&&dataset.hasColumn(key)){dataset.column(key).type(true).format(columnFormat["input-format"])}});return dataset}return chart};dw.visualization=(function(){var __vis={};var visualization=function(id){return new __vis[id]()};visualization.register=function(id){var parent=arguments.length==3?__vis[arguments[1]].prototype:dw.visualization.base,props=arguments[arguments.length-1],vis=__vis[id]=function(){};_.extend(vis.prototype,parent,{id:id},props)};return visualization})();dw.visualization.base=(function(){}).prototype;_.extend(dw.visualization.base,{__init:function(){this.__renderedDfd=$.Deferred();if(window.parent&&window.parent.postMessage){window.parent.postMessage("datawrapper:vis:init","*")}return this},render:function(el){$(el).html("implement me!")},theme:function(theme){if(!arguments.length){return this.__theme}this.__theme=theme;var attr_properties=["horizontalGrid","verticalGrid","yAxis","xAxis"];_.each(attr_properties,function(prop){if(theme.hasOwnProperty(prop)){for(var key in theme[prop]){var lkey=key.replace(/([A-Z])/g,"-$1").toLowerCase();if(!theme[prop].hasOwnProperty(lkey)){theme[prop][lkey]=theme[prop][key]}}}});return this},size:function(width,height){var me=this;if(!arguments.length){return[me.__w,me.__h]}me.__w=width;me.__h=height;return me},get:function(str,_default){return this.chart().get("metadata.visualize."+str,_default)},notify:function(str){if(dw.backend&&_.isFunction(dw.backend.notify)){return dw.backend.notify(str)}else{if(window.parent&&window.parent.postMessage){window.parent.postMessage("notify:"+str,"*")}else{if(window.console){console.log(str)}}}},signature:function(){},translate:function(str){var locale=this.meta.locale,lang=this.lang;return locale[str]?locale[str][lang]||locale[str]:str},checkBrowserCompatibility:function(){return true},chart:function(chart){var me=this;if(!arguments.length){return me.__chart}me.dataset=chart.dataset();me.theme(chart.theme());me.__chart=chart;var columnFormat=chart.get("metadata.data.column-format",{});var ignore={};_.each(columnFormat,function(format,key){ignore[key]=!!format.ignore});me.dataset.filterColumns(ignore);return me},axes:function(returnAsColumns){var me=this,dataset=me.dataset,usedColumns={},axes={},axesDef,axesAsColumns={},errors=[];axesDef=me.chart().get("metadata.axes",{});_.each(me.meta.axes,function(o,key){if(axesDef[key]){var columns=axesDef[key];if(columnExists(columns)){axes[key]=columns;if(!_.isArray(columns)){columns=[columns]}_.each(columns,function(column){usedColumns[column]=true})}}});_.each(me.meta.axes,function(axisDef,key){function checkColumn(col){return !usedColumns[col.name()]&&_.indexOf(axisDef.accepts,col.type())>=0}function errMissingColumn(){var msg=dw.backend?dw.backend.messages.insufficientData:"The visualization needs at least one column of the type %type to populate axis %key";errors.push(msg.replace("%type",axisDef.accepts).replace("%key",key))}if(axes[key]){return}if(!axisDef.optional){if(!axisDef.multiple){var c=_.find(dataset.columns(),checkColumn);if(c){usedColumns[c.name()]=true;axes[key]=c.name()}else{if(_.indexOf(axisDef.accepts,"text")>=0){var col=dw.column(key,_.map(_.range(dataset.numRows()),function(i){return(i>25?String.fromCharCode(64+i/26):"")+String.fromCharCode(65+(i%26))}),"text");dataset.add(col);me.chart().dataset(dataset);usedColumns[col.name()]=true;axes[key]=col.name()}else{errMissingColumn()}}}else{axes[key]=[];dataset.eachColumn(function(c){if(checkColumn(c)){usedColumns[c.name()]=true;axes[key].push(c.name())}});if(!axes[key].length){errMissingColumn()}}}else{axes[key]=false}});if(errors.length){me.notify(errors.join("<br />"))}_.each(axes,function(columns,key){if(!_.isArray(columns)){axesAsColumns[key]=columns!==false?me.dataset.column(columns):null}else{axesAsColumns[key]=[];_.each(columns,function(column,i){axesAsColumns[key][i]=column!==false?me.dataset.column(column):null})}});me.axes=function(returnAsColumns){return returnAsColumns?axesAsColumns:axes};function columnExists(columns){if(!_.isArray(columns)){columns=[columns]}for(var i=0;i<columns.length;i++){if(!dataset.hasColumn(columns[i])){return false}}return true}return me.axes(returnAsColumns)},keys:function(){var me=this,axesDef=me.axes();if(axesDef.labels){var lblCol=me.dataset.column(axesDef.labels),fmt=me.chart().columnFormatter(lblCol),keys=[];lblCol.each(function(val){keys.push(String(fmt(val)))});return keys}return[]},keyLabel:function(key){return key},reset:function(){this.clear();$("#chart").html("").off("click").off("mousemove").off("mouseenter").off("mouseover");$(".chart .filter-ui").remove();$(".chart .legend").remove()},clear:function(){},renderingComplete:function(){if(window.parent&&window.parent.postMessage){window.parent.postMessage("datawrapper:vis:rendered","*")}this.__renderedDfd.resolve()},rendered:function(){return this.__renderedDfd.promise()},supportsSmartRendering:function(){return false},_svgCanvas:function(){return false}});dw.theme=(function(){var __themes={};var theme=function(id){return __themes[id]};theme.register=function(id){var parent=arguments.length==3?__themes[arguments[1]]:dw.theme.base,props=arguments[arguments.length-1];__themes[id]=extend({},parent,{id:id},props)};function extend(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length;if(typeof target!=="object"&&!_.isFunction(target)){target={}}for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}if(copy&&isPlainObject(copy)){clone=src&&isPlainObject(src)?src:{};target[name]=extend(clone,copy)}else{if(copy!==undefined){target[name]=copy}}}}}return target}function isPlainObject(o){return _.isObject(o)&&!_.isArray(o)&&!_.isFunction(o)}return theme})();dw.theme.base={colors:{palette:["#6E7DA1","#64A4C4","#53CCDD","#4EF4E8"],secondary:["#000000","#777777","#cccccc","#ffd500","#6FAA12"],positive:"#85B4D4",negative:"#E31A1C",background:"#ffffff",text:"#000000",gradients:[["#fefaca","#008b15"],["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],["#8c510a","#d8b365","#f6e8c3","#f5f7ea","#c7eae5","#5ab4ac","#01665e"],["#c51b7d","#e9a3c9","#fde0ef","#faf6ea","#e6f5d0","#a1d76a","#4d9221"],["#b2182b","#ef8a62","#fddbc7","#f8f6e9","#d1e5f0","#67a9cf","#2166ac"]],categories:[["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"],["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]]},padding:{left:0,right:20,bottom:30,top:10},lineChart:{strokeWidth:3,maxLabelWidth:80,fillOpacity:0.2,xLabelOffset:20},columnChart:{cutGridLines:false,barAttrs:{"stroke-width":1},darkenStroke:18},barChart:{barAttrs:{"stroke-width":1}},xAxis:{stroke:"#333"},yAxis:{strokeWidth:1},horizontalGrid:{stroke:"#d9d9d9"},verticalGrid:false,frame:false,frameStrokeOnTop:false,yTicks:false,hover:true,tooltip:true,hpadding:0,vpadding:10,minWidth:400,locale:"de_DE",duration:1000,easing:"expoInOut"}}).call(this);(function(){dw.__visMeta={};dw.visualize=(function(){var locale="en-US",metricPrefix={"3":"k","6":"m","9":"b","12":"t"};return function(opts){var chart=dw.chart({type:opts.type,theme:opts.theme,metadata:{visualize:opts.options||{},axes:opts.axes||{}}}),vis=dw.visualization(opts.type);vis.meta=dw.__visMeta[opts.type];vis.lang=locale;opts.datasource.dataset().done(function(ds){chart.dataset(ds).locale(locale).metricPrefix(metricPrefix).theme(dw.theme(opts.theme)).vis(vis);vis.size(opts.container.width(),opts.container.height()).__init().render(opts.container)})}})()}).call(this);dw.__visMeta["data-table"]={dimensions:2,title:"Data Table",locale:{sSearch:"Search:",sInfoThousands:",",sInfoEmpty:"Showing 0 to 0 of 0 entries",sProcessing:"Processing...",sEmptyTable:"No data available in table",sInfoFiltered:"(filtered from _MAX_ total entries)",oPaginate_sPrevious:"Previous",oPaginate_sNext:"Next",oAria_sSortAscending:": activate to sort column ascending",sZeroRecords:"No matching records found",sLoadingRecords:"Loading...",oPaginate_sLast:"Last",sLengthMenu:"Show _MENU_ entries",oPaginate_sFirst:"First",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",oAria_sSortDescending:": activate to sort column descending"},options:{"table-paginate":{type:"checkbox",label:"Display content over multiple pages"},"table-filter":{type:"checkbox",label:"Show filter"},"table-sortable":{type:"checkbox",label:"Make columns sortable"}},libraries:["vendor/jquery.dataTables.min.js"],version:"1.5.0",id:"data-table",order:70};dw.__visMeta["raphael-chart"]={libraries:[{cdn:"//assets-datawrapper.s3.amazonaws.com/vendor/d3-light/3.1.7/d3-light.min.js",local:"vendor/d3-light.min.js"},{cdn:"//assets-datawrapper.s3.amazonaws.com/vendor/chroma-js/0.5.4/chroma.min.js",local:"vendor/chroma.min.js"},{cdn:"//assets-datawrapper.s3.amazonaws.com/vendor/raphael-js/2.1.2/raphael-min.js",local:"vendor/raphael-2.1.2.min.js"}],id:"raphael-chart",version:"1.5.0"};dw.__visMeta["column-chart"]={dimensions:1,title:"Column Chart",axes:{labels:{accepts:["text","date"]},columns:{multiple:true,accepts:["number"]}},id:"column-chart",version:"1.5.0","extends":"raphael-chart",options:{"absolute-scale":{"depends-on":{"chart.min_columns[columns]":2},type:"checkbox",label:"Use the same scale for all columns"},"grid-lines":{"default":false,type:"radio-left",options:[{value:"auto",label:"Automatic"},{value:"show",label:"Show"},{value:"hide",label:"Hide"}],label:"Grid lines"},"ignore-missing-values":{"default":false,type:"checkbox",label:"Ignore missing values"},"sort-values":{type:"checkbox",label:"Automatically sort bars"},"reverse-order":{type:"checkbox",label:"Reverse order"},"negative-color":{"depends-on":{"chart.min_value[columns]":"<0"},type:"checkbox",label:"Use different color for negative values"},"base-color":{type:"base-color",label:"Base color"}},order:9};dw.__visMeta["bar-chart"]={dimensions:1,title:"Bar Chart",axes:{bars:{multiple:true,accepts:["number"]},labels:{accepts:["text","date"]}},id:"bar-chart",libraries:[],version:"1.5.1","extends":"raphael-chart",options:{"sort-values":{type:"checkbox",label:"Autmatically sort bars"},"absolute-scale":{type:"checkbox",label:"Use the same scale for all columns"},"reverse-order":{type:"checkbox",label:"Reverse order"},"negative-color":{"depends-on":{"chart.min_value[columns]":"<0"},type:"checkbox",label:"Use different color for negative values"},"base-color":{type:"base-color",label:"Base color"}},order:5};dw.__visMeta["line-chart"]={dimensions:2,title:"Line Chart",locale:{tooManyLinesToLabel:"Your chart contains <b>more lines than we can label</b>, so automatic labeling is turned off. To fix this <ul><li>filter some columns in the data table in the previous step, or</li><li>use direct labeling and the highlight feature to label the lines that are important to your story.</li></ul>",couldNotParseAllDates:"Some of the <b>dates in your x-axis could not be parsed</b>, hence the line chart cannot display a proper date axis. To fix this<ul><li>return to the previous step and clean your date column.</li><li><a href='http://blog.datawrapper.de/2013/cleaning-your-data-in-datawrapper/'>Read more about how to do this.</a></li></ul>",useLogarithmicScale:"Use logarithmic scale"},axes:{y1:{multiple:true,accepts:["number"]},x:{accepts:["text","date"]},y2:{multiple:true,accepts:["number"],optional:true}},id:"line-chart",options:{"sep-y-axis":{type:"separator",label:"Customize y-Axis"},"sep-labeling":{"depends-on":{"chart.min_columns[y1]":2},type:"separator",label:"Customize labeling"},"direct-labeling":{"default":false,"depends-on":{"chart.min_columns[y1]":2,"chart.max_columns[y2]":0},type:"checkbox",help:"Show the labels right nearby the line ends instead of a separate legend",label:"Direct labeling"},"fill-between":{"default":false,"depends-on":{"chart.min_columns[y1]":2,"chart.max_columns[y1]":2,"chart.max_columns[y2]":0},type:"checkbox",label:"Fill area between lines"},"force-banking":{hidden:true,type:"checkbox",label:"Bank the lines to 45 degrees"},"invert-y-axis":{"default":false,type:"checkbox",label:"Invert direction"},"line-mode":{"default":"straight",type:"radio-left",options:[{value:"straight",label:"Straight"},{value:"curved",label:"Curved"},{value:"stepped",label:"Stepped"}],label:"Line interpolation"},"fill-below":{"depends-on":{"chart.max_columns[y1]":1,"chart.max_columns[y2]":0},defaut:false,type:"checkbox",label:"Fill area below line"},"legend-position":{"default":"right","depends-on":{"chart.min_columns[y1]":2,"direct-labeling":false},type:"radio-left",options:[{value:"right",label:"right"},{value:"top",label:"top"},{value:"inside",label:"inside left"},{value:"inside-right",label:"inside right"}],label:"Legend position"},"sep-lines":{type:"separator",label:"Customize lines"},"scale-y1":{"default":"linear","depends-on":{"chart.min_value[y1]":">0","chart.magnitude_range[y1]":">3"},type:"radio-left",options:[{value:"linear",label:"linear"},{value:"log",label:"logarithmic"}],label:"Scale (y-axis)"},"connect-missing-values":{type:"checkbox",label:"Connect lines between missing values"},"extend-range":{type:"checkbox",help:"Extend the y-axis range to nice, rounded values instead of the default range from the minimum to maximum value.",label:"Extend to nice ticks"},"baseline-zero":{type:"checkbox",label:"Extend to zero"},"show-grid":{"default":false,hidden:true,type:"checkbox",label:"Show grid"},"user-change-scale":{"default":false,"depends-on":{"chart.min_value[y1]":">0","chart.magnitude_range[y1]":">3"},type:"checkbox",label:"Let user change scale"},"base-color":{type:"base-color",label:"Base color"}},"extends":"raphael-chart",annotations:[{type:"axis-range",axis:"x"},{type:"axis-point",axis:"x"},{type:"axis-range",axis:"y"},{type:"axis-point",axis:"y"},{type:"data-point"}],version:"1.5.0",order:40};dw.__visMeta.maps={version:"0.9.5",title:"Map (beta)",locale:{"ids-mismatching":"A significant fraction of your data (%d) could not be assigned to regions of the chosen map. Please make sure that <ul><li>you have selected the correct map and</li><li>that your dataset uses the same identifiers as used in the map.</li></ul>\n                    <p>You may find this <a download='template.csv' href='%t'>template dataset useful</a>.</li></ul>"},axes:{keys:{accepts:["text","number"],title:"Key"},color:{accepts:["number","text"],title:"Color"},tooltip:{optional:true,multiple:true,accepts:["text","number","date"],title:"Tooltip"}},id:"maps",libraries:[{cdn:"//assets-datawrapper.s3.amazonaws.com/vendor/kartograph-js/0.8.3/kartograph.min.js",local:"vendor/kartograph.min.js"},{cdn:"//assets-datawrapper.s3.amazonaws.com/vendor/qtip/2.1.1/jquery.qtip.min.js",local:"vendor/jquery.qtip.min.js"}],options:{map:{type:"map-selector",options:[{keys:["AD","AE","AF","AG","AI","AL","AM","AO","AQ","AR","AS","AT","AU","AW","AX","AZ","BA","BB","BD","BE","BF","BG","BH","BI","BJ","BL","BM","BN","BO","BQ","BR","BS","BT","BV","BW","BY","BZ","CA","CC","CD","CF","CG","CH","CI","CK","CL","CM","CN","CO","CR","CU","CV","CW","CX","CY","CZ","DE","DJ","DK","DM","DO","DZ","EC","EE","EG","EH","ER","ES","ET","FI","FJ","FK","FM","FO","FR","GA","GB","GD","GE","GF","GG","GH","GI","GL","GM","GN","GP","GQ","GR","GS","GT","GU","GW","GY","HK","HM","HN","HR","HT","HU","ID","IE","IL","IM","IN","IO","IQ","IR","IS","IT","JE","JM","JO","JP","KE","KG","KH","KI","KM","KN","KP","KR","XK","KW","KY","KZ","LA","LB","LC","LI","LK","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MF","MG","MH","MK","ML","MM","MN","MO","MP","MQ","MR","MS","MT","MU","MV","MW","MX","MY","MZ","NA","NC","NE","NF","NG","NI","NL","NO","NP","NR","NU","NZ","OM","PA","PE","PF","PG","PH","PK","PL","PM","PN","PR","PS","PT","PW","PY","QA","RE","RO","RS","RU","RW","SA","SB","SC","SD","SS","SE","SG","SH","SI","SJ","SK","SL","SM","SN","SO","SR","ST","SV","SX","SY","SZ","TC","TD","TF","TG","TH","TJ","TK","TL","TM","TN","TO","TR","TT","TV","TW","TZ","UA","UG","UM","US","UY","UZ","VA","VC","VE","VG","VI","VN","VU","WF","WS","YE","YT","ZA","ZM","ZW","CS","AN"],path:"plugins/visualization-maps/maps/1-world",has_locale:true,value:"1-world",label:"Welt"},{keys:["AL","AD","AT","BE","BG","BA","BY","CH","CY","CZ","DE","DK","ES","EE","FI","FR","FO","GB","GE","GG","GR","HR","HU","IM","IE","IS","IT","JE","JO","LI","LT","LU","LV","MC","MD","MK","MT","ME","NL","NO","PL","PT","RO","RU","RS","SK","SI","SE","TR","UA","VA"],path:"plugins/visualization-maps/maps/2-europe",has_locale:true,value:"2-europe",label:"Europa"},{keys:["AGO","ARE","BDI","BEN","BFA","BHR","BWA","CAF","CIV","CMR","COD","COG","COM","DJI","DZA","EGY","ERI","ETH","FRA","GAB","GAZ","GHA","GIN","GMB","GNB","GNQ","ISR","JOR","KEN","KWT","LBN","LBR","LBY","LSO","MAR","MDG","MLI","MOZ","MRT","MWI","NAM","NER","NGA","OMN","PR1","QAT","RWA","SAH","SAU","SDN","SDS","SEN","SHN","SLE","SOL","SOM","STP","SWZ","SYC","TCD","TGO","TUN","TZA","UGA","WEB","YEM","ZAF","ZMB","ZWE"],path:"plugins/visualization-maps/maps/3-africa",has_locale:true,value:"3-africa",label:"Afrika"},{keys:["ATG","AIA","ABW","BRB","BLM","BMU","BES","BHS","BLZ","CAN","CRI","CUB","CUW","DMA","DOM","GRD","GRL","GLP","GTM","HND","HTI","JAM","KNA","CYM","LCA","MAF","MTQ","MSR","MEX","NIC","PAN","SPM","PRI","SLV","SXM","TCA","TTO","USA","VCT","VGB","VIR","ANT"],path:"plugins/visualization-maps/maps/4-north-america",has_locale:true,value:"4-north-america",label:"Nordamerika"},{keys:["ARG","BOL","BRA","CHL","COL","ECU","FLK","GUF","GUY","PER","PRY","SUR","URY","VEN","FRA","PAN"],path:"plugins/visualization-maps/maps/5-south-america",has_locale:true,value:"5-south-america",label:"S\u00fcdamerika"},{keys:["AK","AL","AR","AZ","CA","CO","CT","DC","DE","FL","GA","HI","IA","ID","IL","IN","KS","KY","LA","MA","MD","ME","MI","MN","MO","MS","MT","NC","ND","NE","NH","NJ","NM","NV","NY","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VA","VT","WA","WI","WV","WY"],path:"plugins/map-us-admin/us-states",has_locale:true,value:"de-states",label:"Vereinigte Staaten von Amerika"}],label:"Base map"},"map-keys":{axes:[{id:"keys",label:"Map key column"}],type:"select-axis-column",help:"Please select the column which contains the <b>map region keys</b>."},gradient:{help:"Here you can define a <b>color gradient</b> from which map colors are picked according to the <b>classification</b>.","color-axis":"color","depends-on":{"chart.column_type[color]":"number"},"use-classes":true,label:"Color gradient",type:"color-gradient-selector"},"category-colors":{keys:"color","depends-on":{"chart.column_type[color]":"text"},type:"color-category-selector",help:"Here you can select a palette from which the category colors are picked. On top of that you can assign custom colors for each category.",label:"Category colors"},"map-data":{axes:[{id:"color",label:"Data column"}],type:"select-axis-column",help:"Please select the data columns that contain the <b>data values</b> to be displayed in the map."},"---map-options---":{type:"separator",label:"Configure the map"}},"extends":"raphael-chart",order:92};dw.__visMeta["pie-chart"]={axes:{labels:{accepts:["text","date"]},slices:{multiple:true,accepts:["number"]}},dimensions:1,author:{name:"gka",email:"gka@vis4.net"},locale:{cannotShowNegativeValues:"Pie charts are intended to show part-of-whole relations, and thus they <b>cannot be used to display negative numbers</b>. Please consider using a different chart type instead (eg. a bar chart).",noMoreThanFiveSlices:"Your data contains <b>more values than can be shown in a pie chart</b>, so we grouped %count slices into the slice named <i>'others'</i>.<p>Why not use a bar chart to allow better comparison of values?</p>",other:"other"},title:"Pie chart",id:"pie-chart",libraries:[],options:{"base-color":{type:"base-color",label:"Base color"}},"extends":"raphael-chart",version:"1.5.0",order:50,"color-by":"row"};dw.__visMeta["donut-chart"]={axes:{labels:{accepts:["text","date"]},slices:{multiple:true,accepts:["number"]}},dimensions:1,author:{name:"gka",email:"gka@vis4.net"},title:"Donut chart",id:"donut-chart",version:"1.5.0","extends":"pie-chart",options:{"show-total":{"default":true,type:"checkbox",label:"Show total value in center"},"custom-total":{"default":false,"depends-on":{"show-total":true,"chart.max_row_num":1},type:"checkbox",label:"Use custom total value instead of sum"},"custom-total-value":{"depends-on":{"show-total":true,"custom-total":true},type:"text",label:"Custom total value"}},order:60};dw.__visMeta["election-donut-chart"]={dimensions:1,title:"Election Donut",axes:{labels:{accepts:["text","date"]},slices:{multiple:true,accepts:["number"]}},id:"election-donut-chart",version:"1.5.0","extends":"donut-chart",options:{"sort-values":{"default":true,type:"checkbox",label:"Sort by size"},"base-color":{type:"base-color",label:"Base color"}},order:60};dw.__visMeta["grouped-column-chart"]={dimensions:2,title:"Grouped Column Chart",axes:{labels:{accepts:["text","date"]},columns:{multiple:true,accepts:["number"]}},order:10,libraries:[],version:"1.5.0","extends":"raphael-chart",options:{"sort-values":{type:"checkbox",label:"Automatically sort bars"},"reverse-order":{type:"checkbox",label:"Reverse order"},"negative-color":{"depends-on":{"chart.min_value[columns]":"<0"},type:"checkbox",label:"Use different color for negative values"},"base-color":{type:"base-color",label:"Base color"}},id:"grouped-column-chart","color-by":"row"};dw.__visMeta["stacked-column-chart"]={dimensions:2,title:"Stacked Column Chart",locale:{cannotShowNegativeValues:"Negative values, as contained in your dataset, cannot be stacked on top of each other in a stacked column chart. Please consider using a different chart type instead (eg. a grouped column chart).","stack percentages":"stack percentages"},axes:{labels:{accepts:["text","date"]},columns:{multiple:true,accepts:["number"]}},order:11,version:"1.5.0","extends":"grouped-column-chart",options:{normalize:{"default":false,type:"checkbox",label:"Stack percentages"},"normalize-user":{"depends-on":{normalize:true},type:"checkbox",label:"Let user switch mode"},"sort-values":{type:"checkbox",label:"Automatically sort bars"},"reverse-order":{type:"checkbox",label:"Reverse order"},"negative-color":{type:"checkbox",label:"Use different color for negative values"},"base-color":{type:"base-color",label:"Base color"}},id:"stacked-column-chart","color-by":"row"};(function(){dw.theme.register("default",{colors:{palette:["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd"],secondary:["#000000","#777777","#cccccc","#ffd500","#6FAA12"],context:"#aaa",axis:"#000000",positive:"#1f77b4",negative:"#d62728",background:"#ffffff"},lineChart:{fillOpacity:0.2},vpadding:10,frame:false,verticalGrid:false,columnChart:{darkenStroke:5}})}).call(this);(function(){dw.visualization.register("raphael-chart",{init:function(){this.__elements={};this.__labels={}},update:function(row){console.warn("vis.update(): override me!",row)},setRoot:function(el){var me=this;me.__root=el;el.css({position:"relative"});el.addClass(me.chart().get("type"))},getSize:function(){return[this.__w,this.__h]},initCanvas:function(canvas,w_sub,h_sub){var me=this,el=me.__root,size=me.size(),theme=me.theme();canvas=_.extend({w:size[0]-(w_sub||0),h:size[1]-(h_sub||0),rpad:theme.padding.right,lpad:theme.padding.left,bpad:theme.padding.bottom,tpad:theme.padding.top},canvas);if(size[0]<=400){canvas.bpad=canvas.tpad=canvas.lpad=canvas.rpad=5;canvas.bpad=canvas.tpad=15}canvas.root=el;canvas.paper=Raphael(el[0],canvas.w,canvas.h+2);el.height(canvas.h);$(".tooltip").hide();me.__canvas=canvas;Raphael.easing_formulas.expoInOut=function(n,time,beg,diff,dur){dur=1000;time=n*1000;beg=0;diff=1;if(time===0){return beg}if(time==dur){return beg+diff}if((time/=dur/2)<1){return diff/2*Math.pow(2,10*(time-1))+beg}return diff/2*(-Math.pow(2,-10*--time)+2)+beg};$.extend(jQuery.easing,{expoIn:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},expoOut:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},expoInOut:function(x,t,b,c,d){if(t==0){return b}if(t==d){return b+c}if((t/=d/2)<1){return c/2*Math.pow(2,10*(t-1))+b}return c/2*(-Math.pow(2,-10*--t)+2)+b}});return canvas},onMouseMove:function(e){var me=this,x=e.pageX,y=e.pageY,hovered_key=this.getKeyByPoint(x,y,e),row=this.getDataRowByPoint(x,y),theme=me.theme(),hoveredNode=hovered_key!==null;if(!hovered_key){hovered_key=me.getKeyByLabel()}if(!hovered_key){clearTimeout(me.__mouseOverTimer);me.__mouseOutTimer=setTimeout(function(){clearTimeout(me.__mouseOverTimer);clearTimeout(me.__mouseOutTimer);if(theme.hover){me.hover()}if(theme.tooltip){me.hideTooltip()}},200)}else{if(me.__mouseOutTimer){clearTimeout(me.__mouseOutTimer)}me.__mouseOverTimer=setTimeout(function(){clearTimeout(me.__mouseOverTimer);clearTimeout(me.__mouseOutTimer);if(theme.hover){me.hover(hovered_key)}},100)}},registerElement:function(el,key,row){el.data("key",key);if(_.isNumber(row)){el.data("row",row)}if(!this.__elements[key]){this.__elements[key]=[]}this.__elements[key].push(el);return el},registerLabel:function(lbl,key,column,row){var me=this;lbl.data("key",key);if(column&&!_.isUndefined(row)){lbl.el.attr("data-column",column);lbl.el.attr("data-row",row)}if(!me.__labels[key]){me.__labels[key]=[]}me.__labels[key].push(lbl);lbl.on("mouseenter",function(e){me.__hoveredLabel=e.target;clearTimeout(me.__mouseLeaveTimer)});lbl.on("mouseleave",function(){me.__mouseLeaveTimer=setTimeout(function(){me.__hoveredLabel=null},100)});return lbl},getLabels:function(key){return this.__labels[key]||[]},hover:function(hover_key){var keyElements=this.__elements;_.each(keyElements,function(elements,key){var h=!hover_key||key==hover_key;_.each(elements,function(el){el.animate({opacity:h?1:0.5},80)})});var keyLabels=this.__labels;_.each(keyLabels,function(labels,key){var h=!hover_key||key==hover_key;_.each(labels,function(lbl){if(key==hover_key){lbl.addClass("highlighted")}else{lbl.removeClass("highlighted")}})})},path:function(pathdata,className){var p=this.__canvas.paper.path(pathdata);if(className&&Raphael.svg){$(p.node).attr("class",className)}return p},label:function(x,y,txt,_attrs){var me=this,lbl,attrs={root:this.__canvas.root,align:"left",valign:"middle",cl:"",rotate:0,css:{position:"absolute",width:_attrs.w?_attrs.w:"auto"},x:x,y:y,txt:txt};$.extend(true,attrs,_attrs||{});lbl=$('<div class="label'+(attrs.cl?" "+attrs.cl:"")+'"><span>'+txt+"</span></div>");lbl.css(attrs.css);lbl.css({"text-align":attrs.align});attrs.root.append(lbl);function position(){var w=attrs.w||me.labelWidth(attrs.txt,attrs.cl,attrs.size),h=attrs.h||lbl.height(),x=attrs.x,y=attrs.y,rot_w=100;var css=attrs.rotate==-90?{left:x-rot_w*0.5,top:attrs.valign=="top"?y+rot_w*0.5:y-rot_w*0.5,width:rot_w,height:20,"text-align":attrs.valign=="top"?"right":"left"}:{left:attrs.align=="left"?x:attrs.align=="center"?x-w*0.5:x-w,top:y-h*(attrs.valign=="top"?0:attrs.valign=="middle"?0.5:1),width:w,height:h};if(attrs.size){css["font-size"]=attrs.size}return css}lbl.css($.extend({},attrs.css,position()));if(attrs.rotate==-90){lbl.css({"-moz-transform":"rotate(-90deg)","-webkit-transform":"rotate(-90deg)","-ms-transform":"rotate(-90deg)","-o-transform":"rotate(-90deg)",filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)"})}var label={el:lbl};label.text=function(txt){if(arguments.length){$("span",lbl).html(txt);return label}return $("span",lbl).html()};label.animate=function(_attrs,duration,easing){if(_attrs.align!=attrs.align){setTimeout(function(){lbl.css({"text-align":_attrs.align})},duration?duration*0.5:10)}if(attrs.rotate&&_attrs.valign!=attrs.valign){setTimeout(function(){lbl.css({"text-align":_attrs.valign=="top"?"right":"left"})},duration?duration*0.5:10)}if(_attrs.txt!=attrs.txt){label.text(_attrs.txt)}$.extend(attrs,_attrs);var _css=$.extend({},attrs.css,position());return duration?lbl.stop().animate(_css,duration,easing):lbl.css(_css)};label.attr=label.animate;label.data=function(){return lbl.data.apply(lbl,arguments)};label.hide=function(){return lbl.hide.apply(lbl,arguments)};label.show=function(){return lbl.show.apply(lbl,arguments)};label.width=function(){return lbl.width.apply(lbl,arguments)};label.height=function(){return lbl.height.apply(lbl,arguments)};label.left=function(){return lbl.offset().left};label.top=function(){return lbl.offset().top};label.on=function(){return lbl.on.apply(lbl,arguments)};label.hasClass=function(){return lbl.hasClass.apply(lbl,arguments)};label.addClass=function(){return lbl.addClass.apply(lbl,arguments)};label.removeClass=function(){return lbl.removeClass.apply(lbl,arguments)};label.remove=function(){return lbl.remove.apply(lbl,arguments)};lbl.data("label",label);return label},labelWidth:function(txt,className,fontSize){var lbl,span,$span,ow,root=this.__root.get(0);lbl=document.createElement("div");lbl.style.position="absolute";lbl.style.left="-10000px";span=document.createElement("span");lbl.appendChild(span);$span=$(span);root.appendChild(lbl);ow=!_.isUndefined(span.offsetWidth)?function(){return span.offsetWidth}:function(){return $span.outerWidth()};function labelWidth(txt,className,fontSize){lbl.setAttribute("class","label "+(className?" "+className:""));span.style.fontSize=fontSize?fontSize:null;span.innerHTML=txt;return ow()}this.labelWidth=labelWidth;return labelWidth(txt,className,fontSize)},labelHeight:function(txt,className,width,fontSize){var lbl,span,$span,oh,root=this.__root.get(0);lbl=document.createElement("div");lbl.style.position="absolute";lbl.style.left="-10000px";span=document.createElement("span");lbl.appendChild(span);$span=$(span);root.appendChild(lbl);oh=!_.isUndefined(span.offsetHeight)?function(){return span.offsetHeight}:function(){return $span.height()};function labelHeight(txt,className,width,fontSize){lbl.setAttribute("class","label "+(className?" "+className:""));lbl.style.width=width+"px";span.style.fontSize=fontSize?fontSize:null;span.innerHTML=txt;return oh()}this.labelHeight=labelHeight;return labelHeight(txt,className,width,fontSize)},orderSeriesElements:function(){var me=this;_.each(me.dataset.columns(),function(column){if(me.chart().isHighlighted(column)){_.each(me.__elements[column.name()],function(el){el.toFront()})}})},getKeyByPoint:function(x,y,evt){var me=this,el=me.__canvas.paper.getElementByPoint(x,y);if(!el){el=$(evt.target);if(!el.hasClass("label")){el=el.parents(".label")}}if(el&&el.data("key")){return el.data("key")}return null},getKeyByLabel:function(){var me=this;if(me.__hoveredLabel){lbl=$(me.__hoveredLabel);if(me.__hoveredLabel.nodeName.toLowerCase()=="span"){lbl=lbl.parent()}if(lbl.data("key")){return lbl.data("key")}}return null},getDataRowByPoint:function(x,y){throw"getDataRowByPoint() needs to be implemented by each visualization"},_baseColor:function(){var me=this,base=me.get("base-color",0),palette=me.theme().colors.palette,fromPalette=!_.isString(base);return fromPalette?palette[base]:base},_getColor:function(series,row,opts){var me=this,key=opts.key;if(!key&&series){key=series.name()}if(key){var customColors=me.get("custom-colors",{});if(customColors[key]){return customColors[key]}}if(opts.byValue&&series){return opts.byValue(series.val(row))}if(series&&me.__colors&&me.__colors[key]){return me.__colors[key]}var palette=me.theme().colors.palette,baseColor=me._baseColor();if(opts.usePalette){return palette[(Math.max(0,palette.indexOf(baseColor))+row)%palette.length]}if(opts.varyLightness){var lab=chroma.color(baseColor).lab(),minL=Math.min(lab[0],50),maxL=91,f=row/(me.dataset.numRows()-1);return chroma.lab(minL+f*(maxL-minL),lab[1],lab[2]).hex()}return baseColor},getColor:function(series,row,opts){var me=this,chart=me.chart(),color=me._getColor(series,row,opts);if(series&&chart.hasHighlight()&&!chart.isHighlighted(series)){return chroma.interpolate(color,me.theme().colors.background,0.65,"rgb").hex()}return color},getKeyColor:function(_key,_value,_useNegativeColor,_colorful){var me=this,palette=me.theme().colors.palette,colorByRow=me.meta["color-by"]=="row",colorCache={};function keyColor(key,value,useNegativeColor,colorful){var color;key=String(key);var userCustomColors=me.get("custom-colors",{});if(userCustomColors[key]){color=userCustomColors[key]}else{if(value&&useNegativeColor){color=me.theme().colors[value<0?"negative":"positive"]}else{if(key&&me.__customColors&&me.__customColors[key]){color=me.__customColors[key]}else{color=me._baseColor()}}}var key_color=chroma.hex(color),bg_color=chroma.hex(me.theme().colors.background),bg_lch=bg_color.lch();if(key&&!me.chart().isHighlighted(key)){if(!colorCache[color+"-hl"]){colorCache[color+"-hl"]=chroma.interpolate(key_color,bg_color,bg_lch[0]<60?0.7:0.63)}return colorCache[color+"-hl"]}return color}me.getKeyColor=keyColor;return keyColor(_key,_value,_useNegativeColor,_colorful)},setKeyColor:function(key,color){var me=this;if(!me.__customColors){me.__customColors={}}me.__customColors[key]=color},getYTicks:function(yscale,h,noDomain,useLogScale){var me=this,domain=yscale.domain(),ticks=useLogScale?dw.utils.logTicks(domain[0],domain[1]):yscale.ticks(h/80),bt=yscale(ticks[0]),tt=yscale(ticks[ticks.length-1]);if(!noDomain){if(Math.abs(yscale(domain[0])-bt)<30){ticks.shift()}if(Math.abs(tt-yscale(domain[1]))<30){ticks.pop()}ticks.unshift(domain[0]);ticks.push(domain[1])}return ticks},invertLabel:function(col){var c=chroma.color(col),bg=chroma.color(this.theme().colors.background);return bg.lab()[0]>60?c.lab()[0]<80:c.lab()[0]>60},signature:function(){var me=this,sig={type:"raphael-chart",el:{}};$.each(me.__elements,function(key,elements){sig.el[key]=elements.length});return sig},addLegend:function(items,container){var me=this,l=$('<div class="legend"></div>'),xo=me.__canvas.lpad;_.each(items,function(item){div=$("<div></div>");div.css({background:item.color,width:12,height:12,position:"absolute",left:xo,top:1});l.append(div);lbl=me.label(xo+15,0,item.label,{valign:"left",root:l});xo+=me.labelWidth(item.label)+30});l.css({position:"relative"});container.append(l)},optimizeLabelPositions:function(labels,pad,valign){if(!labels.length){return}var i=1,c=valign=="top"?0:valign=="middle"?0.5:1,min_y=labels[0].el.parent().offset().top,max_y=min_y+labels[0].el.parent().height();labels=_.filter(labels,function(lbl){return lbl.el.is(":visible")});if(!labels.length){return}_.each(labels,function(lbl){lbl.__noverlap={otop:lbl.top(),top:lbl.top(),dy:0};lbl.height("auto")});(function loop(){var overlap=false;_.each(labels,function(lbl0,p){_.each(labels,function(lbl1,q){if(q>p){var l0=lbl0.left(),l1=lbl1.left(),r0=l0+lbl0.width(),r1=l1+lbl1.width(),t0=lbl0.__noverlap.top-pad,t1=lbl1.__noverlap.top-pad,b0=t0+lbl0.height()+pad*2,b1=t1+lbl1.height()+pad*2,dy,l0up;if(!(l1>r0||r1<l0||t1>b0||b1<t0)){overlap=true;dy=Math.min(b0,b1)-Math.max(t0,t1);l0up=t0+(b0-t0)*c<t1+(b1-t1)*c;lbl0.__noverlap.dy+=dy*0.5*(l0up?-1:1);lbl1.__noverlap.dy+=dy*0.5*(l0up?1:-1)}}})});if(overlap){_.each(labels,function(lbl){lbl.__noverlap.top=Math.max(min_y,lbl.__noverlap.top+lbl.__noverlap.dy);lbl.__noverlap.dy=0})}if(overlap&&++i<10){loop()}})();_.each(labels,function(lbl){lbl.el.css({top:lbl.__noverlap.top-lbl.el.parent().offset().top})})},checkBrowserCompatibility:function(){return window.Raphael&&Raphael.type},clear:function(){var me=this;_.each(me.__elements,function(elements){_.each(elements,function(el){el.remove()})});_.each(me.__labels,function(elements){_.each(elements,function(el){el.remove()})});me.__elements={};me.__labels={}},_svgCanvas:function(){return this.__canvas.paper.canvas}})}).call(this);(function(){var lastTime=0;var vendors=["ms","moz","webkit","o"];for(var x=0;x<vendors.length&&!window.requestAnimationFrame;++x){window.requestAnimationFrame=window[vendors[x]+"RequestAnimationFrame"];window.cancelAnimationFrame=window[vendors[x]+"CancelAnimationFrame"]||window[vendors[x]+"CancelRequestAnimationFrame"]}if(!window.requestAnimationFrame){window.requestAnimationFrame=function(callback,element){var currTime=new Date().getTime();var timeToCall=Math.max(0,16-(currTime-lastTime));var id=window.setTimeout(function(){callback(currTime+timeToCall)},timeToCall);lastTime=currTime+timeToCall;return id}}if(!window.cancelAnimationFrame){window.cancelAnimationFrame=function(id){clearTimeout(id)}}}());(function(){dw.visualization.register("line-chart","raphael-chart",{render:function(el){var vis=this,dataset=vis.dataset,theme=vis.theme(),chart=vis.chart(),y1Domain,axesDef=vis.axes(true);if(!axesDef.x||!axesDef.y1[0]){return}var formatter={x:chart.columnFormatter(axesDef.x),y1:chart.columnFormatter(axesDef.y1[0])},useLogScale=vis.get("scale-y1")=="log";vis.setRoot(el);var bpad=theme.padding.bottom,baseCol=Math.max(0,vis.get("base-color",0)),scales=vis.__scales={x:xScale(),y:yScale()},legend={pos:vis.get("legend-position","right"),xoffset:0,yoffset:-10},h=vis.get("force-banking")?el.width()/vis.computeAspectRatio():vis.getSize()[1],c;if(vis.get("direct-labeling")){legend.pos="direct"}var extendRange=vis.get("extend-range",false)||(theme.frame&&vis.get("show-grid",false));vis.init();initMargins();if(theme.frame&&vis.get("show-grid",false)){if(theme.frameStrokeOnTop){frame().attr({stroke:false})}else{frame()}}if(extendRange){scales.y=scales.y.nice()}scales.x=scales.x.range([c.lpad+c.lpad2,c.w-c.rpad]);scales.y=scales.y.range(vis.get("invert-y-axis",false)?[c.tpad,c.h-c.bpad]:[c.h-c.bpad,c.tpad]);drawYAxis();drawXAxis();var all_series=axesDef.y1,seriesLines=this.__seriesLines={};if(legend.pos!="direct"){all_series=all_series.sort(function(a,b){return b.val(-1)-a.val(-1)});if(vis.get("invert-y-axis",false)){all_series.reverse()}if(legend.pos.substr(0,6)=="inside"){legend.xoffset=yAxisWidth(h);legend.yoffset=40}}var highlightedSeriesCount=0,seriesColIndex=0;$.each(all_series,function(i,column){if(chart.hasHighlight()&&chart.isHighlighted(column)){highlightedSeriesCount++}});highlightedSeriesCount=highlightedSeriesCount||all_series.length;var all_paths=[],legend_labels=[];legend.cont=$("<div />").addClass("legend").appendTo(el).css({position:"absolute",top:0,left:0});_.each(all_series,renderLine);if(axesDef.y1.length>1){if(legend.pos=="direct"){vis.optimizeLabelPositions(legend_labels,3,"top")}else{if(legend.pos=="inside-right"){legend.cont.css({left:c.w-legend.xoffset-c.rpad})}}}addAreaFills();vis.orderSeriesElements();initMouseActions();if(theme.frameStrokeOnTop){if(theme.frame&&vis.get("show-grid",false)){frame().attr({fill:false})}}if(vis.get("user-change-scale",false)){addScaleChangeUI()}vis.renderingComplete();if(axesDef.y1.length>1&&!lineLabelsVisible()){vis.notify(vis.translate("tooManyLinesToLabel"))}function initMargins(){c=vis.initCanvas({h:h,bpad:vis.get("rotate-x-labels")?bpad+20:bpad});if(lineLabelsVisible()&&legend.pos!="direct"&&legend.pos!="right"){c.tpad+=20;c.rpad=0}if(vis.get("user-change-scale",false)){c.bpad+=25}if(lineLabelsVisible()&&(legend.pos=="direct"||legend.pos=="right")){c.labelWidth=0;dataset.eachColumn(function(col){c.labelWidth=Math.max(c.labelWidth,vis.labelWidth(col.name(),"series highlighted"))});if(c.labelWidth>this.__w*0.25){c.labelWidth=this.__w*0.25}c.rpad+=c.labelWidth+20;if(legend.pos=="right"){c.rpad+=15}}else{c.rpad+=5}if(legend.pos!="direct"&&legend.pos!="right"){c.rpad+=0.25*vis.labelWidth(vis.axes(true).x.val(-1));legend.xoffset+=c.lpad}c.lpad2=yAxisWidth(h)}function frame(){return c.paper.rect(c.lpad+c.lpad2,c.tpad,c.w-c.rpad-c.lpad-c.lpad2,c.h-c.bpad-c.tpad).attr(theme.frame)}function renderLine(col,index){var paths=[],pts_=[],pts=[],x,y,sw,connectMissingValuePath=[],last_valid_y;col.each(buildPathPoints);if(pts.length>0){pts_.push(pts)}_.each(pts_,function(pts){paths.push("M"+[pts.shift(),pts.shift()]+(vis.get("line-mode")=="curved"?"R":"L")+pts)});sw=lineWidth(col);var palette=theme.colors.palette.slice();if(legend.pos!="direct"&&all_series.length>1){vis.setKeyColor(col.name(),palette[(seriesColIndex+baseCol)%palette.length]);seriesColIndex++}var strokeColor=lineColor(col);all_paths.push(paths);_.each(paths,renderPath);renderMissingValueConnections();if(lineLabelsVisible()){renderLabels()}function buildPathPoints(val,i){if(!_.isNumber(val)){if(pts.length>0){pts_.push(pts);pts=[]}return}x=scales.x(useDateFormat()?rowName(i):i);y=scales.y(val);if(pts.length===0&&pts_.length>0){var lp=pts_[pts_.length-1],s=lp.length-2;connectMissingValuePath.push("M"+[lp[s],lp[s+1]]+"L"+[x,y])}if(vis.get("line-mode")=="stepped"&&last_valid_y!==undefined){pts.push(x,last_valid_y)}pts.push(x,y);last_valid_y=y}function renderPath(path){vis.registerElement(c.paper.path(path).attr({"stroke-width":sw,"stroke-linecap":"round","stroke-linejoin":"round","stroke-opacity":1,stroke:strokeColor}),col.name());vis.registerElement(c.paper.path(path).attr({"stroke-width":sw*4,opacity:0}),col.name())}function renderMissingValueConnections(){if(vis.get("connect-missing-values",false)){vis.registerElement(c.paper.path(connectMissingValuePath).attr({"stroke-width":sw*0.35,"stroke-dasharray":"- ",stroke:strokeColor}),col.name())}}function renderLabels(){var visible=all_series.length<10||chart.isHighlighted(col),div,lbl,lblx=x+10,lbly=last_valid_y,valign="top";if(visible){if(legend.pos=="right"){lblx+=15;lbly=legend.yoffset;div=$("<div></div>");div.css({background:strokeColor,width:10,height:10,position:"absolute",left:x+10,top:lbly+3});legend.cont.append(div)}else{if(legend.pos=="top"||legend.pos.substr(0,6)=="inside"){lblx=legend.xoffset+15;lbly=legend.yoffset;div=$("<div></div>");div.css({background:strokeColor,width:10,height:10,position:"absolute",left:legend.xoffset,top:lbly+3});legend.cont.append(div);legend.xoffset+=vis.labelWidth(col.name(),"series")+30}}}lbl=vis.label(lblx,lbly,col.title(),{cl:chart.isHighlighted(col)?"highlighted series":"series",w:c.labelWidth,valign:valign,root:legend.cont});legend_labels.push(lbl);if(!visible){lbl.hide()}if(legend.pos=="right"){legend.yoffset+=lbl.height("auto").height()+5}lbl.data("highlighted",chart.isHighlighted(col));vis.registerLabel(lbl,col.name(),col.name(),-1)}}function initMouseActions(){el.mousemove(onMouseMove);$(".chart").mouseenter(function(){$(".label.x-axis").css({opacity:0.4});$(".label.tooltip").show()}).mouseleave(function(){$(".label.x-axis").css({opacity:1});if(vis.__xlab){vis.__xlab.remove()}vis.__xlab=null;$(".label.tooltip").hide();_.each(vis.__labels,function(labels){_.each(labels,function(l){l.show()})})})}function useDateFormat(){return axesDef.x.type()=="date"&&_.filter(axesDef.x.values(),_.isDate).length==axesDef.x.length}function rowName(r){return axesDef.x.val(r)}function xScale(){if(useDateFormat()){return d3.time.scale().domain([rowName(0),rowName(-1)])}else{if(axesDef.x.type()=="date"){vis.notify(vis.translate("couldNotParseAllDates"))}return d3.scale.linear().domain([0,dataset.numRows()-1])}}function yScale(){var scale,domain=[Number.MAX_VALUE,Number.MAX_VALUE*-1];_.each(axesDef.y1,function(col){domain[0]=Math.min(domain[0],col.range()[0]);domain[1]=Math.max(domain[1],col.range()[1])});y1Domain=domain;if(vis.get("baseline-zero",false)||vis.get("fill-below",false)){if(domain[0]>0){domain[0]=0}if(domain[1]<0){domain[1]=0}}scale=useLogScale?"log":"linear";if(scale=="log"&&domain[0]===0){domain[0]=0.03}return d3.scale[scale]().domain(domain)}function lineLabelsVisible(){return axesDef.y1.length>1&&(axesDef.y1.length<15||chart.hasHighlight())&&c.w>=theme.minWidth}function yAxisWidth(h){var ticks=vis.getYTicks(scales.y,h,extendRange,useLogScale),maxw=0;_.each(ticks,function(val,t){val=formatter.y1(val,false);maxw=Math.max(maxw,vis.labelWidth(val))});return maxw+20}function drawYAxis(){var domain=y1Domain,styles=vis.__styles,ticks=vis.getYTicks(scales.y,c.h,extendRange,useLogScale);if(!extendRange&&ticks[ticks.length-1]!=domain[1]){ticks.push(domain[1])}if($("body").hasClass("fullscreen")){theme.horizontalGrid["stroke-width"]=2}_.each(ticks,function(val,t){var y=scales.y(val),x=c.lpad;if(val>=domain[0]&&val<=domain[1]||extendRange){vis.label(x+2,y-10,formatter.y1(val,t==ticks.length-1),{align:"left",cl:"axis"});if(theme.yTicks){vis.path([["M",c.lpad-25,y],["L",c.lpad-20,y]],"tick")}if(theme.horizontalGrid){vis.path([["M",c.lpad,y],["L",c.w-c.rpad,y]],"grid").attr(theme.horizontalGrid)}}});if(domain[0]<=0&&domain[1]>=0){y=scales.y(0);vis.path([["M",c.lpad,y],["L",c.w-c.rpad,y]],"axis").attr(theme.xAxis)}}function drawXAxis(){var rotate45=vis.get("rotate-x-labels"),labels=axesDef.x.raw(),k=labels.length-1;if(useDateFormat()){return drawDateAxis()}var last_label_x=-100,min_label_distance=rotate45?30:0;axesDef.x.each(function(val,i){min_label_distance=Math.max(min_label_distance,vis.labelWidth(val))});function addlbl(x,val,i,low){var y=c.h-c.bpad+theme.lineChart.xLabelOffset,lbl;if(!val){return}if(rotate45){x-=5}lbl=vis.label(x,y,val,{align:"center",cl:"axis x-axis"+(rotate45?" rotate45":"")})}addlbl(scales.x(0),labels[0],0);var cl="axis x-axis",lw,x,l0=scales.x(0)+vis.labelWidth(labels[0],cl)*0.6,l1=scales.x(k)-vis.labelWidth(labels[k],cl)*0.6;for(var i=1;i<k;i++){lw=vis.labelWidth(labels[i],cl);x=scales.x(i);if(x-lw*0.6>l0&&x+lw*0.6<l1){addlbl(scales.x(i),labels[i],i);l0=x+lw*0.6}}addlbl(scales.x(k),labels[k],k);if(vis.get("show-grid",false)&&theme.verticalGrid){_.each(scales.x.ticks(20),function(tick){var x=scales.x(tick),t=c.tpad,b=c.h-c.bpad;var p=c.paper.path("M"+x+","+t+" "+x+","+b).attr(theme.verticalGrid)})}}function drawDateAxis(){var tickCount=Math.round(c.w/75),ticks=scales.x.ticks(tickCount),fmt=axesDef.x.type(true).format(),daysDelta=Math.round((rowName(-1).getTime()-rowName(0).getTime())/86400000),tickFormat=dw.utils.dateFormat(daysDelta),last_month=-1,new_month,last_year=-1,new_year,last_day=-1,new_day,new_decade,new_quarter,real_data_as_ticks=false;if(ticks.length>axesDef.x.length){ticks=axesDef.x.values();real_data_as_ticks=true}_.each(ticks,function(date,i){new_day=date.getDate()!=last_day;new_month=date.getMonth()!=last_month;new_quarter=new_month&&(date.getMonth()%3===0);new_year=date.getFullYear()!=last_year;new_decade=new_year&&date.getFullYear()%10===0;var x=scales.x(date),y=c.h-c.bpad+theme.lineChart.xLabelOffset,lbl=tickFormat(date);if(fmt=="YYYY"&&i>0&&i<ticks.length-1){lbl="’"+String(date.getFullYear()).substr(2)}var l=vis.label(x,y,lbl,{align:"center",cl:"axis x-axis"});if(((daysDelta<=9&&new_day)||(daysDelta>9&&daysDelta<=35&&date.getDay()==Globalize.culture().calendar.firstDay)||(daysDelta>35&&daysDelta<=180&&new_month)||(daysDelta>180&&daysDelta<=500&&new_quarter)||(daysDelta>500&&daysDelta<3650&&new_year)||(daysDelta>=3650&&new_decade))||real_data_as_ticks){if(theme.horizontalGrid){vis.path("M"+[x,c.h-c.bpad]+"V"+c.tpad,"grid").attr(theme.horizontalGrid)}}else{l.el.addClass("minor-tick")}last_day=date.getDate();last_month=date.getMonth();last_year=date.getFullYear()})}function lineWidth(column){var fs_scale=$("body").hasClass("fullscreen")?1.5:1,scale=chart.hasHighlight()?chart.isHighlighted(column)?1:0.65:1;return theme.lineChart.strokeWidth*fs_scale*scale}function lineColor(column){var bgcol=chroma.hex(theme.colors.background),bglum=bgcol.luminance(),col=chroma.hex(vis.getKeyColor(column.name())),min_contrast=chart.hasHighlight()?(chart.isHighlighted(column)?4.5:1.45):1.7,i=0;while(chroma.contrast(bgcol,col)<min_contrast&&i++<20){if(bglum>0.5){col=col.darken(5)}else{col=col.brighten(5)}}return col.hex()}function onMouseMove(e){var x=e.pageX,y=e.pageY,moKey=vis.getKeyByPoint(x,y,e),moColumn=moKey?dataset.column(moKey):null,row=dataRowByPoint(x,y,e),hoveredNode=moColumn!==null,xLabelTop=c.h-c.bpad+theme.lineChart.xLabelOffset,xlabel=vis.__xlab=vis.__xlab||vis.label(x,xLabelTop,"foo",{cl:"axis x-axis h",align:"center",css:{background:theme.colors.background,zIndex:100}});var lx=scales.x(useDateFormat()?rowName(row):row),lfmt=formatter.x,lw=vis.labelWidth(lfmt(rowName(row)),"axis x-axis")+10;xlabel.text(lfmt(rowName(row)));xlabel.attr({x:lx,y:xLabelTop,w:lw});var spaghetti=dataset.numColumns()>3;var valueLabels=[];_.each(axesDef.y1,function(column){var lbl;if(column.__label&&column.__label.el.parent().length){lbl=column.__label}else{if(column.__label){delete column.__label}lbl=column.__label=vis.label(0,0,"0",{cl:"tooltip"+(vis.getKeyColor(column.name())?" inverted":""),align:"center",valign:"middle",css:{background:lineColor(column)}})}var val=formatter.y1(column.val(row));lbl.data("key",column.name());lbl.data("row",0);lbl.text(val);lbl.attr({x:lx,y:scales.y(column.val(row))-21,w:vis.labelWidth(val)+10});if(isNaN(column.val(row))){lbl.hide()}else{lbl.show()}valueLabels.push(lbl);if(spaghetti){if(!(column==moColumn||chart.hasHighlight()&&chart.isHighlighted(column))){lbl.hide()}var hide_label=chart.hasHighlight()&&!chart.isHighlighted(column)&&(column!=moColumn);if(vis.get("direct-labeling")){if(hide_label){$.each(vis.getLabels(column.name()),function(i,l){l.hide()})}else{$.each(vis.getLabels(column.name()),function(i,l){l.show()})}}else{if(hide_label){$.each(vis.getLabels(column.name()),function(i,l){l.el.css("text-decoration","none")})}else{if(!chart.isHighlighted(column.name())){$.each(vis.getLabels(column.name()),function(i,l){l.el.css("text-decoration","underline")})}}}}});vis.optimizeLabelPositions(valueLabels,3,"middle");return}function dataRowByPoint(x,y){x-=vis.__root.offset().left;y-=vis.__root.offset().top;if(useDateFormat()){var mouse_date=scales.x.invert(x),min_dist=Number.MAX_VALUE,closest_row=0;axesDef.x.each(function(date,i){var dist=Math.abs(date.getTime()-mouse_date.getTime());if(dist<min_dist){min_dist=dist;closest_row=i}});return closest_row}return Math.min(dataset.numRows()-1,Math.max(0,Math.round(scales.x.invert(x))))}function addAreaFills(){if(vis.get("fill-between",false)&&all_series.length==2){fillBetweenLines()}if(vis.get("fill-below",false)&&all_paths.length==1&&all_paths[0].length==1){if(all_paths[0].length==1){addFill(all_series[0],all_paths[0][0]+"V"+scales.y(0)+"H"+scales.x(useDateFormat()?axesDef.x.val(0):0))}}function fillBetweenLines(){if(all_paths.length==2){if(all_paths[0].length==1&&all_paths[1].length==1){var path1=Raphael.parsePathString(all_paths[0][0]),path2=Raphael.parsePathString(all_paths[1][0]),pts=Raphael.pathIntersection(path1,path2),h1=[],h2=[],f1=[],f2=[],s1=0,s2=0,next;if(vis.get("line-mode")!="curved"){$.each(pts,function(i,pt){while(s1<pt.segment1){h1.push(path1[s1][1],path1[s1][2]);s1++}h1.push([pt.x,pt.y]);while(s2<pt.segment2){h2.unshift(path2[s2][1],path2[s2][2]);s2++}(h1[1]<h2[h2.length-1]?f1:f2).push([].concat(h1,h2));h1=[pt.x,pt.y];h2=[]});while(s1<path1.length){h1.push(path1[s1][1],path1[s1][2]);s1++}while(s2<path2.length){h2.unshift(path2[s2][1],path2[s2][2]);s2++}(h1[1]<h2[h2.length-1]?f1:f2).push([].concat(h1,h2));$.each([f1,f2],function(i,fills){var path=[];_.each(fills,function(pts){path.push("M"+[pts.shift(),pts.shift()]+"L"+pts)});addFill(all_series[i],path)})}else{var pts1=[].concat(path1[0].slice(1),path1[1].slice(1)),pts2=[].concat(path2[0].slice(1),path2[1].slice(1));$.each(pts,function(i,pt){while(s1<pt.segment1){h1.push(pts1[s1*2],pts1[s1*2+1]);s1++}h1.push(pt.x,pt.y);while(s2<pt.segment2){h2.unshift(pts2[s2*2],pts2[s2*2+1]);s2++}var f=h1[1]<h2[h2.length-(i===0?1:3)]?f1:f2;f.push("M"+[h1.shift(),h1.shift()]+(h1.length>2?"R"+h1+"R"+h2:"L"+h1+"L"+h2));h1=[pt.x,pt.y];h2=[pt.x,pt.y]});while(s1*2<pts1.length){h1.push(pts1[s1*2],pts1[s1*2+1]);s1++}while(s2*2<pts2.length){h2.unshift(pts2[s2*2],pts2[s2*2+1]);s2++}var f=h1[1]<h2[h2.length-3]?f1:f2;f.push("M"+[h1.shift(),h1.shift()]+(h1.length>2?"R"+h1+"L"+[h2.shift(),h2.shift()]+"R"+h2:"L"+h1+"L"+h2));$.each([f1,f2],function(i,fills){_.each(fills,function(path){addFill(all_series[i],path)})})}}else{vis.warn("<b>Warning:</b> Area filling is not supported for lines with missing values.")}}else{vis.warn("<b>Warning:</b> Filling is only supported for exactly two lines.")}}function addFill(series,path){c.paper.path(path).attr({fill:lineColor(series),"fill-opacity":theme.lineChart.fillOpacity,stroke:false})}}function addScaleChangeUI(){var div=$("<div />").addClass("filter-ui").appendTo($("#header")),id="use-log-"+_.random(10000),chk=$('<input type="checkbox" />').attr("id",id).prop("checked",useLogScale).appendTo(div),lbl=$("<label />").attr("for",id).text(vis.translate("useLogarithmicScale")).appendTo(div);chk.change(function(){var s=chk.prop("checked")?"log":"linear",attrs=vis.chart().attributes();attrs.metadata.visualize["scale-y1"]=s;vis.chart().attributes(attrs);__dw.render()})}},lineColumns:function(){return this.axes(true).y1},computeAspectRatio:function(){var vis=this,slopes=[],M,Rx,Ry;vis.lineColumns().each(function(col){var lval;_.each(col.data,function(val,i){if(i>0&&val!=lval){slopes.push(Math.abs(val-lval))}lval=val})});M=d3.median(slopes);Rx=slopes.length;Ry=me.__domain[1]-me.__domain[0];return M*Rx/Ry},hover:function(series){},keys:function(){var vis=this,axes=vis.axes();return[].concat(axes.y1,axes.y2||[])}})}).call(this);(function(){dw.visualization.register("column-chart","raphael-chart",{render:function(el){var me=this,filter,filterUI,sortBars,reverse,c,dataset=me.dataset,chart_width,column_gap,row_gap,row,column,bars,theme=me.theme();me.axesDef=me.axes();if(!me.axesDef){return}this.setRoot(el);row=0;if(!_.isUndefined(me.get("selected-row"))){row=me.get("selected-row",0);if(row>dataset.numRows()){row=0}}me.__lastRow=row;var barColumns=_.map(me.axesDef.columns,function(i){return dataset.column(i)});filter=dw.utils.filter(dw.utils.columnNameColumn(barColumns),row);filterUI=filter.ui(me);var filterH=0;if(filterUI){(function(){var $h=$("#header"),oldHeaderHeight=$h.height();$h.append(filterUI);filterH=$h.height()-oldHeaderHeight;filter.change(function(val,i){me.__lastRow=i;me.update(i)})})()}sortBars=me.get("sort-values");reverse=me.get("reverse-order");c=me.initCanvas({},0,filterH);chart_width=c.w-c.lpad-c.rpad;column_gap=0.05;row_gap=0.01;if(filterUI){c.tpad+=5}me.init();column=me.getBarColumn();if(!column){return}bars=me.getBarValues();var lh=0,mm=column.range(),mm_r=mm[0]>=0?1:mm[1]<=0?0:mm[1]/(mm[1]-mm[0]),n=me.__n=bars.length;_.each(bars,function(bar,s){lh=Math.max(lh,chart_width/(n+(n-1)*0.35)>38?me.labelHeight(bar.name,"series",c.w/(n)):Math.min(80,me.labelWidth(bar.name,"series")))});c.bpad=c.bpad-30+lh*mm_r+15;c.tpad+=lh*(1-mm_r);me.initDimensions();$(".tooltip").hide();if(!theme.columnChart.cutGridLines){me.horzGrid()}_.each(me.getBarValues(sortBars,reverse),_.bind(me.__barEnter,me));var y=c.h-me.__scales.y(0)-c.bpad;el.mousemove(_.bind(me.onMouseMove,me));$(".showOnHover").hide();if(theme.columnChart.cutGridLines){me.horzGrid()}if(me.__gridLines&&me.__gridLines["0"]){me.__gridLines["0"].toFront()}me.renderingComplete()},__barEnter:function(barv,s){var me=this,c=me.__canvas,d=me.barDimensions(barv,s),n=me.__n,chart=me.chart(),theme=me.theme(),val=barv.value,fill=me.getBarColor(barv,me.get("negative-color",false)),stroke=chroma.color(fill).darken(theme.columnChart.darkenStroke).hex(),bar,formatter=chart.columnFormatter(me.getBarColumn());bar=me.registerElement(c.paper.rect().attr(d).attr({stroke:stroke,fill:fill}).data("strokeCol",stroke),barv.name);if(theme.columnChart.barAttrs){bar.attr(theme.columnChart.barAttrs)}var val_y=val>0?d.y-10:d.y+d.height+10,lbl_y=val<=0?d.y-10:d.y+d.height+5,f_val=formatter(val,true),vlbl_w=me.labelWidth(f_val,"value"),bw=(d.width+d.width*d.pad),lblcl=["series"],lbl_w=c.w/(n+2),valign=val>0?"top":"bottom",halign="center",alwaysShow=(chart.hasHighlight()&&chart.isHighlighted(barv.name))||(bw>vlbl_w);var lpos=me.labelPosition(barv,s,"value"),spos=me.labelPosition(barv,s,"series");me.registerLabel(me.label(lpos.left,lpos.top,formatter(barv.value,true),{w:lpos.width,align:"center",cl:"value outline "+(alwaysShow?"":" showOnHover")}),barv.name);if(chart.hasHighlight()&&chart.isHighlighted(barv.name)){lblcl.push("highlighted")}if(d.bw<30){halign="right"}if(d.bw<20){lblcl.push("smaller")}if(!/^X\.\d+$/.test(barv.name)){me.registerLabel(me.label(spos.left,spos.top,barv.name,{w:spos.width,align:spos.halign,valign:spos.valign,cl:lblcl.join(" "),rotate:d.bw<30?-90:0}),barv.name,me.axes().labels,barv.row)}},__barExit:function(bar_name,s){var me=this;_.each(me.__elements[bar_name],function(el){el.remove()});_.each(me.__labels[bar_name],function(el){el.remove()});me.__elements[bar_name]=undefined;me.__labels[bar_name]=undefined},getBarValues:function(sortBars,reverse){var me=this,values=[],filter=me.__lastRow,labels=me.dataset.column(me.axesDef.labels),column=me.getBarColumn(filter),fmt=labels.type(true).formatter();column.each(function(val,i){if(!isNaN(val)||!me.get("ignore-missing-values",false)){values.push({name:fmt(labels.val(i)),value:val,row:i})}});if(sortBars){values.sort(function(a,b){return(isNaN(b.value)?0:b.value)-(isNaN(a.value)?0:a.value)})}if(reverse){values.reverse()}return values},getBarColumn:function(){var me=this,filter=me.__lastRow;if(_.isUndefined(filter)){throw"filter must not be undefined"}if(_.isUndefined(me.axesDef.columns[filter])){return null}return me.dataset.column(me.axesDef.columns[filter])},update:function(row){var me=this,theme=me.theme(),formatter=me.chart().columnFormatter(me.getBarColumn());me.initDimensions();me.horzGrid();var n=me.__n=me.getBarValues().length,updated_bars={};_.each(me.getBarValues(me.get("sort-values"),me.get("reverse-order")),function(bar,s){if(!me.__elements[bar.name]){me.__barEnter(bar,s)}_.each(me.__elements[bar.name],function(rect){var dim=me.barDimensions(bar,s,0);rect.animate(dim,theme.duration,theme.easing)});_.each(me.__labels[bar.name],function(lbl){var lpos;if(lbl.hasClass("value")){lbl.text(formatter(bar.value,true));lpos=me.labelPosition(bar,s,"value")}else{if(lbl.hasClass("series")){lpos=me.labelPosition(bar,s,"series")}}if(lpos){lbl.animate({x:lpos.left,y:lpos.top,align:lpos.halign,valign:lpos.valign},theme.duration,theme.easing)}});updated_bars[bar.name]=true});_.each(me.__elements,function(elements,key){if(!updated_bars[key]){me.__barExit(key)}});if(me.__gridLines["0"]){me.__gridLines["0"].toFront()}},getBarColor:function(bar,useNegativeColor,colorful){var me=this;return me.getKeyColor(bar?bar.name:null,bar?bar.value:null,useNegativeColor)},initDimensions:function(r){var me=this,c=me.__canvas,domain=me.getBarColumn().range();if(me.get("absolute-scale",false)){domain=dw.utils.minMax(_.map(me.axesDef.columns,function(c){return me.dataset.column(c)}))}if(domain[0]>0){domain[0]=0}if(domain[1]<0){domain[1]=0}me.__domain=domain;me.__scales={y:d3.scale.linear().domain(domain)};me.__scales.y.rangeRound([0,c.h-c.bpad-c.tpad])},barDimensions:function(bar,s){var me=this,sc=me.__scales,c=me.__canvas,n=me.getBarValues().length,w,h,x,y,i,cw,bw,pad=0.35,vspace=0.1,val=bar.value;if(isNaN(val)){val=0}if(c.w/n<30){vspace=0.05}if(!me.gridVisible()){vspace=0.02}cw=(c.w-c.lpad-c.rpad)*(1-vspace-vspace);bw=cw/(n+(n-1)*pad);if(bw<10){bw=2;pad=((cw/bw)-n)/(n-1)}h=sc.y(val)-sc.y(0);w=Math.round(bw);if(h>=0){y=c.h-c.bpad-sc.y(0)-h}else{y=c.h-c.bpad-sc.y(0);h*=-1}if(h!==0){h=Math.max(1,h)}x=Math.round((c.w-c.lpad-c.rpad)*vspace+c.lpad+s*(bw+bw*pad));return{width:w,height:h,x:x,y:y,bx:x,bw:bw,pad:pad}},labelPosition:function(bar,s,type){var me=this,d=me.barDimensions(bar,s),lbl_w,val=bar.value,c=me.__canvas,lbl_top=val>=0||isNaN(val),valign=lbl_top?"top":"bottom",halign="center",val_y=lbl_top?d.y-10:d.y+d.height+10,lbl_y=!lbl_top?d.y-5:d.y+d.height+5,formatter=me.chart().columnFormatter(me.getBarColumn());if(type=="value"){lbl_w=me.labelWidth(formatter(val,true),"value outline hover");return{left:d.x+d.width*0.5,top:val_y,width:lbl_w}}else{if(type=="series"){lbl_w=c.w/(me.getBarValues().length+2);if(d.bw<30){lbl_y-=10;lbl_w=100;halign="right"}if(d.bw<20){lbl_w=90}return{left:d.bx+d.bw*0.5,top:lbl_y,width:lbl_w,halign:halign,valign:valign}}}},getDataRowByPoint:function(x,y){return 0},showTooltip:function(){},hideTooltip:function(){},horzGrid:function(){var me=this,yscale=me.__scales.y,c=me.__canvas,domain=me.__domain,styles=me.__styles,theme=me.theme(),ticks=me.getYTicks(yscale,c.h,true),tickLabels=me.__tickLabels=me.__tickLabels||{},gridLines=me.__gridLines=me.__gridLines||{},formatter=me.chart().columnFormatter(me.getBarColumn());if(!me.gridVisible()){ticks=[]}ticks=ticks.filter(function(val,t){return val>=domain[0]&&val<=domain[1]});_.each(ticks,function(val,t){var y=c.h-c.bpad-yscale(val),x=c.lpad,ly=y-10;if(theme.columnChart.cutGridLines){ly+=10}var key=String(val);if(val!==0){var lbl=tickLabels[key]=tickLabels[key]||me.label(x+2,ly,formatter(val,t==ticks.length-1,true),{align:"left",cl:"axis",css:{opacity:0}});lbl.animate({x:c.lpad+2,y:ly,css:{opacity:1}},theme.duration,theme.easing)}if(theme.yTicks){me.path([["M",c.lpad-25,y],["L",c.lpad-20,y]],"tick")}if(theme.horizontalGrid){var lattrs={path:[["M",c.lpad,y],["L",c.w-c.rpad,y]],opacity:1},l=gridLines[key]=gridLines[key]||me.path(lattrs.path,"grid");l.toBack();if(val===0){$.extend(lattrs,theme.xAxis);l.toFront()}else{l.attr(theme.horizontalGrid);$.extend(lattrs,theme.horizontalGrid)}if(!me.__lastTicks||_.indexOf(me.__lastTicks,Number(val))<0){var old_path=lattrs.path;if(me.__lastDomain){yscale.domain(me.__lastDomain);y=c.h-c.bpad-yscale(val);yscale.domain(domain);old_path=[["M",c.lpad,y],["L",c.w-c.rpad,y]]}l.attr({opacity:0,path:old_path})}if(val!==0&&theme.columnChart.cutGridLines){lattrs.stroke=theme.colors.background}l.animate(lattrs,theme.duration*(me.__lastTicks?1:0.2),theme.easing)}});$.each(gridLines,function(val,line){if(_.indexOf(ticks,+val)<0){var y=c.h-c.bpad-yscale(val),props={};$.extend(props,theme.horizontalGrid,{path:[["M",c.lpad,y],["L",c.w-c.rpad,y]],opacity:0});line.animate(props,theme.duration,theme.easing);if(tickLabels[val]){var lbl=tickLabels[val];tickLabels[val].animate({x:c.lpad+2,y:y+(theme.columnChart.cutGridLines?-10:0),css:{opacity:0}},theme.duration,theme.easing)}}});me.__lastTicks=ticks;me.__lastDomain=domain.slice(0)},hovers:function(column){var me=this,theme=me.theme();_.each(me.getBarColumns(),function(col){_.each(me.__labels[col.name()],function(lbl){if(column!==undefined&&col.name()==column.name()){lbl.addClass("hover");if(lbl.hasClass("showOnHover")){lbl.show(0.5)}}else{lbl.removeClass("hover");if(lbl.hasClass("showOnHover")){lbl.hide(0.5)}}_.each(me.__elements[col.name()],function(el){var fill=me.getBarColor(col,el.data("row"),me.get("negative-color",false)),stroke;if(column!==undefined&&col.name()==column.name()){fill=chroma.color(fill).darken(14).hex()}stroke=chroma.color(fill).darken(theme.columnChart.darkenStroke).hex();if(el.attrs.fill!=fill||el.attrs.stroke!=stroke){el.animate({fill:fill,stroke:stroke},50)}})})})},unhoverSeries:function(){this.hoverSeries()},gridVisible:function(){var me=this;return me.get("grid-lines","show")=="show"?true:me.get("grid-lines")=="hide"?false:(me.__canvas.w/me.getBarValues().length)<50||me.getBarValues().length>8}})}).call(this);(function(){var MAX_LABEL_WIDTH=160;dw.visualization.register("bar-chart","raphael-chart",{render:function(el){this.setRoot(el);var me=this,row=0,dataset=me.dataset,sortBars=me.get("sort-values",false),reverse=me.get("reverse-order"),useNegativeColor=me.get("negative-color",false);me.axesDef=me.axes();if(!me.axesDef){return}if(!_.isUndefined(me.get("selected-row"))){row=me.get("selected-row",0);row=row>me.axesDef.bars.length?0:row}me.__lastRow=row;if(!me.getBarColumn()){return}var sliceColumns=_.map(me.axesDef.bars,function(i){return dataset.column(i)}),filter=dw.utils.filter(dw.utils.columnNameColumn(sliceColumns),row),filterUI=filter.ui(me);if(filterUI){$("#header").append(filterUI);filter.change(function(val,i){me.__lastRow=i;me.update(i)})}var c=me.initCanvas({h:Math.max(dw.utils.getMaxChartHeight(el)+5,18*1.35*me.getBarColumn().length+5)});var chart_width=c.w-c.lpad-c.rpad,series_gap=0.05,row_gap=0.01,formatValue=me.chart().columnFormatter(me.getBarColumn()),barvalues=me.getBarValues(sortBars,reverse);me.init();me.initDimensions();$(".tooltip").hide();c.lastBarY=0;function render(barv){var d=me.barDimensions(barv,s,row),lpos=me.labelPosition(barv,s,row),fill=me.getKeyColor(barv.name,barv.value,useNegativeColor),stroke=chroma.color(fill).darken(14).hex();var bar=me.registerElement(c.paper.rect(d.x,d.y,d.width,d.height).attr({stroke:stroke,fill:fill}).data("strokeCol",stroke),barv.name);if(me.theme().barChart.barAttrs){bar.attr(me.theme().barChart.barAttrs)}if(lpos.show_val){me.registerLabel(me.label(lpos.val_x,lpos.top,formatValue(barv.value,true),{align:lpos.val_align,cl:"value"+lpos.lblClass}),barv.name)}if(lpos.show_lbl){me.registerLabel(me.label(lpos.lbl_x,lpos.top,barv.name,{w:Math.min(me.labelWidth(barv.name,"series")+20,MAX_LABEL_WIDTH),align:lpos.lbl_align,valign:"middle",cl:"series"+lpos.lblClass}),barv.name,me.axes().labels,barv.row)}c.lastBarY=Math.max(c.lastBarY,d.y+d.height);if(s==barvalues.length-1){complete()}s++}var barGroups=_.groupBy(barvalues,function(bar,i){return Math.floor(i/10)});var s=0;_.each(barGroups,function(bars){_.defer(function(){_.each(bars,render)})});function complete(){if(me.__domain[0]<0){var x=c.lpad+c.zero;me.__yaxis=me.path("M"+[x,c.tpad]+"V"+c.lastBarY,"axis").attr(me.theme().yAxis)}el.mousemove(_.bind(me.onMouseMove,me));me.renderingComplete()}},getBarValues:function(sortBars,reverse){var me=this,values=[],filter=me.__lastRow,labels=me.axes(true).labels,column=me.getBarColumn(filter),fmt=me.chart().columnFormatter(labels);column.each(function(val,i){values.push({name:fmt(labels.val(i)),value:val,row:i})});if(sortBars){values.sort(function(a,b){return(isNaN(b.value)?0:b.value)-(isNaN(a.value)?0:a.value)})}if(reverse){values.reverse()}return values},getBarColumn:function(){var me=this,filter=me.__lastRow;if(_.isUndefined(filter)){throw"filter must not be undefined"}return me.axes(true).bars[filter]},update:function(row){var me=this,formatValue=me.chart().columnFormatter(me.getBarColumn());me.initDimensions();_.each(me.getBarValues(me.get("sort-values",false)),function(bar,s){_.each(me.__elements[bar.name],function(rect){var dim=me.barDimensions(bar,s,row);dim.fill=me.getKeyColor(bar.name,bar.value,me.get("negative-color",false));dim.stroke=chroma.color(dim.fill).darken(14).hex();rect.animate(dim,me.theme().duration,me.theme().easing)});_.each(me.__labels[bar.name],function(lbl){var pos=me.labelPosition(bar,s,row),lpos;if(lbl.hasClass("value")){lbl.text(formatValue(bar.value));lpos={halign:pos.val_align,left:pos.val_x,top:pos.top}}else{if(lbl.hasClass("series")){lpos={halign:pos.lbl_align,left:pos.lbl_x,top:pos.top}}}if(lpos){lbl.animate({align:lpos.halign,x:lpos.left,y:lpos.top},me.theme().duration,me.theme().easing)}})});if(me.__domain[0]<0){var c=me.__canvas,x=c.lpad+c.zero,p="M"+[x,c.tpad]+"V"+c.lastBarY;if(me.__yaxis){me.__yaxis.animate({path:p,opacity:1},me.theme().duration,me.theme().easing)}else{me.__yaxis=me.path(p,"axis").attr(me.theme().yAxis)}}else{if(me.__yaxis){me.__yaxis.animate({opacity:0},me.theme().duration*0.5,me.theme().easing)}}},initDimensions:function(){var me=this,c=me.__canvas,w=c.w-c.lpad-c.rpad-30,column=me.getBarColumn(),bars=me.getBarValues(),formatValue=me.chart().columnFormatter(column),domain=me.get("absolute-scale",false)?dw.utils.minMax(_.map(me.axesDef.bars,function(c){return me.dataset.column(c)})):column.range();if(domain[0]>0){domain[0]=0}if(domain[1]<0){domain[1]=0}me.__domain=domain;me.__scales={y:d3.scale.linear().domain(domain)};var maxw=[0,0,0,0],ratio,largestVal=[0,0],lw;_.each(bars,function(bar){if(isNaN(bar.value)){return}var neg=bar.value<0;largestVal[neg?1:0]=Math.max(largestVal[neg?1:0],Math.abs(bar.value))});me.__longLabels=false;_.each(_.first(bars,50),function(bar){if(isNaN(bar.value)){return}var neg=bar.value<0,t=neg?2:0,bw;bw=Math.abs(bar.value)/(largestVal[0]+largestVal[1])*w;lw=me.labelWidth(bar.name,"series");if(lw>MAX_LABEL_WIDTH){me.__longLabels=true}maxw[t]=Math.max(maxw[t],Math.min(lw,MAX_LABEL_WIDTH)+20);maxw[t+1]=Math.max(maxw[t+1],me.labelWidth(me.chart().formatValue(bar.value,true),"value")+20+bw)});c.left=0;c.right=0;c.zero=largestVal[1]/(largestVal[0]+largestVal[1])*w;var maxNegBar=c.zero;c.left=Math.max(maxw[0],maxw[3])-c.zero;c.right=Math.max(maxw[1],maxw[2])-(w-c.zero);w-=c.left+c.right;c.zero=c.left+largestVal[1]/(largestVal[0]+largestVal[1])*w;c.maxSeriesLabelWidth=[maxw[0],maxw[2]];c.maxValueLabelWidth=[maxw[1],maxw[3]];me.__scales.y.rangeRound([c.lpad,w])},barDimensions:function(bar,s,r){var me=this,w,h,x,y,i,cw,n=me.getBarValues().length,sc=me.__scales,c=me.__canvas,bw,pad=0.35,vspace=0.1,val=bar.value;if(isNaN(val)){val=0}cw=c.h-c.bpad-c.tpad;bw=Math.max(18,Math.min(50,cw/(n+(n-1)*pad)));w=sc.y(val)-sc.y(0);h=bw;if(w>0){x=c.lpad+c.zero}else{x=c.lpad+c.zero+w;w*=-1}if(val!==0){w=Math.max(1,w)}y=Math.round(c.tpad+s*(bw+bw*pad));return{width:w,height:h,x:x,y:y}},labelPosition:function(bar,s,r){var me=this,d=me.barDimensions(bar,s,r),formatValue=me.chart().columnFormatter(me.getBarColumn()),c=me.__canvas,val=bar.value,lbl_left=val>=0||isNaN(val),lbl_x=lbl_left?c.zero-10:c.zero+10,lbl_align=lbl_left?"right":"left",val_x=lbl_left?d.x+d.width+10:d.x-10,val_align=lbl_left?"left":"right",show_lbl=true,show_val=true,lblClass=me.chart().hasHighlight()&&me.chart().isHighlighted(bar)?" highlighted":"";if(me.__longLabels&&me.__domain[0]>=0){lbl_align=lbl_left?"left":"right";lbl_x=c.lpad}return{lblClass:lblClass,val_align:val_align,show_lbl:show_lbl,show_val:show_val,lbl_align:lbl_align,lbl_x:lbl_x,val_x:val_x,top:d.y+d.height*0.5}},getDataRowByPoint:function(x,y){return 0},showTooltip:function(){},hideTooltip:function(){},hover:function(hover_key){var me=this,barvalues=me.getBarValues(),l=barvalues.length;_.each(barvalues,function(bar){_.each(me.__labels[bar.name],function(lbl){if(hover_key!==undefined&&bar.name==hover_key){lbl.addClass("hover")}else{lbl.removeClass("hover")}});if(l>50){return}_.each(me.__elements[bar.name],function(el){var fill=me.getKeyColor(bar.name,bar.value,me.get("negative-color",false)),stroke;if(hover_key!==undefined&&bar.name==hover_key){fill=chroma.color(fill).darken(14).hex()}stroke=chroma.color(fill).darken(14).hex();if(el.attrs.fill!=fill||el.attrs.stroke!=stroke){el.animate({fill:fill,stroke:stroke},50)}})})},unhoverSeries:function(){this.hoverSeries()}})}).call(this);(function(){dw.visualization.register("pie-chart","raphael-chart",{isDonut:function(){return false},getFullArc:function(){return TWO_PI},groupAfter:function(){return 4},render:function(el){this.setRoot(el);var me=this,dataset=me.dataset,sort=true,donut=me.isDonut(),row=0;if(!_.isUndefined(me.get("selected-row"))){row=me.get("selected-row",0);if(row>dataset.numRows()||row===undefined){row=0}}me.axesDef=me.axes();if(!me.axesDef){return}var sliceColumns=_.map(me.axesDef.slices,function(i){return dataset.column(i)});filter=dw.utils.filter(dw.utils.columnNameColumn(sliceColumns),row),filterUI=filter.ui(me),filterH=0;if(filterUI){(function(){var $h=$("#header"),oldHeaderHeight=$h.height();$h.append(filterUI);filterH=$h.height()-oldHeaderHeight;filter.change(function(val,i){me.update(i)})})()}var c=me.initCanvas({},0,filterH),FA=me.getFullArc();c.cx=c.w*0.5;c.cy=(c.h-c.bpad+30)*(FA<TWO_PI?0.69:0.5);c.or=Math.min(FA==TWO_PI?(c.h-c.bpad+30)*0.5:c.h*0.66,c.w*0.35)-3;c.ir=donut?c.or*0.3:0;c.or_sq=c.or*c.or;c.ir_sq=c.ir*c.ir;me.init();$(".tooltip").hide();me.__initialRow=row;me.update(row);el.mousemove(_.bind(me.onMouseMove,me));me.renderingComplete()},update:function(row){var me=this,dataset=me.dataset,groupAfter=me.groupAfter(),c=me.__canvas,donut=me.isDonut(),showTotal=donut&&me.get("show-total",false),FA=me.getFullArc();me.__slices=me.__slices?me.__slices:{};var column=me.axes(true).slices[row];if(!column){return}var labels=me.axes(true).labels,total=0,min=Number.MAX_VALUE,max=0,reverse,slices,others=0,ocnt=0,hasNegativeValues=column.range()[0]<0,values=[],formatValue=me.chart().columnFormatter(column),formatLabel=me.chart().columnFormatter(labels);column.each(function(val,i){values.push({name:labels.val(i),label:formatLabel(labels.val(i)),value:val,index:i})});if(me.get("sort-values",true)){values.sort(function(a,b){return me.axes(true).slices[0].val(b.index)-me.axes(true).slices[0].val(a.index)})}slices=me.__values=[];_.each(values,function(o,i){if(i<groupAfter||values.length<=groupAfter+1){slices.push(o)}else{ocnt+=1;others+=o.value}});if(hasNegativeValues){me.notify(me.translate("cannotShowNegativeValues"))}if(ocnt>0){slices.push({name:me.translate("other"),value:others});me.notify(me.translate("noMoreThanFiveSlices").replace("%count",ocnt))}if(me.get("sort-values",true)){slices.sort(function(a,b){return(isNaN(b.value)?0:b.value)-(isNaN(a.value)?0:a.value)})}_.each(slices,function(s){total+=s.value;min=Math.min(min,s.value);max=Math.max(max,s.value)});reverse=min<total/slices.length*0.66||max>total/slices.length*1.5;sa=-HALF_PI;if(reverse){sa+=FA*(slices[0].value/total)}if(FA<TWO_PI){reverse=false;sa=-HALF_PI-FA*0.5}else{sa=-QUARTER_PI*0.8-(slices[slices.length-1].value/total*Math.PI);reverse=true}me.__seriesAngles={};function normalize(a0,a1){a0+=HALF_PI;a1+=HALF_PI;if(a0<0){a0+=TWO_PI;a1+=TWO_PI}return[a0,a1]}me.__sliceKeys=[];me.__sliceSet=c.paper.set();if(me.__out_labels){_.each(me.__out_labels,function(lbl){lbl.el.animate({opacity:0},200,function(){if(lbl.data("line")){lbl.data("line").remove()}lbl.el.remove()})})}me.__out_labels=[];var all_labels_inside=true,out_labels_max_width=c.w-c.or*2.3-60,out_labels_total_height=-20,num_labels_outside=0,out_label_w=0;function lblOutside(o){if(me.getFullArc()<TWO_PI){return false}return o.name.length>10?o.value/total<0.15:o.name.length>5?o.value/total<0.1:false}_.each(slices,function(o){if(lblOutside(o)){all_labels_inside=false;out_label_w=Math.max(out_label_w,Math.min(out_labels_max_width,me.labelWidth(o.name,"series out")));o.__lbl_h=me.labelHeight(o.name,"series out",out_labels_max_width);out_labels_total_height+=o.__lbl_h+20;num_labels_outside++}});var cx=c.cx-(all_labels_inside?0:(out_label_w+50)*0.5),lbl_duration=_.keys(me.__slices).length>0?me.theme().duration:100;_.each(slices,function(o,index){var da=o.value/total*FA,fill=me.getKeyColor(o.name,0),stroke=chroma.color(fill).darken(15).hex(),a0=reverse?sa-da:sa,a1=reverse?sa:sa+da,value=showTotal?Math.round(o.value/total*100)+"%":formatValue(o.value,true);if(o.value===0){return}me.__sliceKeys.push(o.name);if(!me.__slices[o.name]){var lblcl=me.chart().hasHighlight()&&me.chart().isHighlighted(o.name)?"series highlighted":"series";if(me.invertLabel(fill)){lblcl+=" inverted"}if(lblOutside(o)){lblcl+=" outside"}var lbl=me.registerLabel(me.label(0,0,"<b>"+o.name+"</b>"+value,{w:80,cl:lblcl,align:"center",valign:"middle"}),o.name);slice=me.__slices[o.name]=Slice(c.paper,cx,c.cy,c.or,c.ir,a0,a1,lbl,me.theme);slice.path.attr({stroke:me.theme().colors.background,"stroke-width":1.6,"stroke-linejoin":"round",fill:fill});slice.path.data("slice",slice);me.__sliceSet.push(slice.path);me.registerElement(slice.path,o.name)}else{slice=me.__slices[o.name];slice.label.text("<b>"+o.name+"</b>"+value);slice.label[lblOutside(o)?"addClass":"removeClass"]("outside");slice.animate(cx,c.cy,c.or,c.ir,a0,a1,me.theme().duration,me.theme().easing)}me.__seriesAngles[o.name]=normalize(a0,a1);sa+=reverse?-da:da;if(lblOutside(o)){var lx=cx+c.or+30,ca=(me.__seriesAngles[o.name][0]+me.__seriesAngles[o.name][1])*0.5-HALF_PI,ly=c.cy+Math.sin(ca)*(c.or+30),out_lbl;out_lbl=me.registerLabel(me.label(lx,ly,o.name,{cl:"series out",w:out_label_w}),o.name);out_lbl.data("oy",ly).data("ca",ca).data("key",o.name).data("index",num_labels_outside-index).css({opacity:0});if(o.value/total<=0.02){slice.label.hide();out_lbl.text(out_lbl.text()+"&nbsp;("+value+")")}else{slice.label.show()}me.__out_labels.push(out_lbl)}});if(me.__out_labels.length>0){me.optimizeLabelPositions(me.__out_labels,5,"top");_.each(me.__out_labels,function(lbl){var ly=+lbl.el.css("top").replace("px",""),lx=+lbl.el.css("left").replace("px",""),ca=lbl.data("ca"),h=lbl.el.height(),line;function cxy(r){return[cx+Math.cos(ca)*r,c.cy+Math.sin(ca)*r]}if(lbl.data("oy")>ly&&lbl.data("oy")<h){line=c.paper.path("M"+cxy(c.or+4)+"L"+cxy(c.or+30)+"H"+(lx-5))}else{line=c.paper.path("M"+cxy(c.or+4)+"L"+cxy(c.or+8)+"L"+[lx-5,ly+h*0.5])}me.registerElement(line,lbl.data("key"));line.attr("opacity",0);lbl.el.data("line",line);setTimeout(function(){lbl.el.animate({opacity:1},200);line.animate({opacity:1},200)},lbl_duration+lbl.data("index")*50)})}if(showTotal){if(me.get("custom-total")){total=me.get("custom-total-value","")}else{total=formatValue(total,true)}if(me.__labelTotal){me.__labelTotal.remove()}me.__labelTotal=me.label(cx,c.cy,"<strong>Total:</strong><br />"+total,{w:50,align:"center",valign:"middle"})}},getSeriesByPoint:function(x,y){var me=this,c=me.__canvas,a,match;x-=c.root.offset().left+c.cx;y-=c.root.offset().top+c.cy;dist=x*x+y*y;if(dist>c.or_sq||dist<c.ir_sq){return false}a=Math.atan2(y,x)+HALF_PI;if(a<0){a+=TWO_PI}_.each(me.__seriesAngles,function(range,sname){if(a>=range[0]&&a<range[1]){match=sname;return false}});return _.find(me.__values,function(v){return v.name()==match})},getDataRowByPoint:function(x,y){return 0},showTooltip:function(){},hideTooltip:function(){},hover:function(hovered_key){var me=this,bg=chroma.color(me.theme().colors.background);_.each(me.__sliceKeys,function(key){_.each(me.__labels[key],function(lbl){if(!lbl){return}if(hovered_key!==undefined&&key==hovered_key){lbl.addClass("hover")}else{lbl.removeClass("hover")}});_.each(me.__elements[key],function(el){var h=!hovered_key||key==hovered_key;if(el.animate){el.animate({opacity:h?1:0.5},100)}})})},unhoverSeries:function(){this.hoverSeries()},formatValue:function(){var me=this;return me.chart().columnFormatter(me.axes(true).slices);return me.formatValue.apply(me,arguments)}});var TWO_PI=Math.PI*2,HALF_PI=Math.PI*0.5,QUARTER_PI=Math.PI*0.25;var Slice=function(paper,cx,cy,or,ir,startAngle,endAngle,label){var me={cx:cx,cy:cy,or:or,ir:ir,startAngle:startAngle,endAngle:endAngle};function arcPath(){var cx=me.cx,cy=me.cy,ir=me.ir,or=me.or,startAngle=me.startAngle,endAngle=me.endAngle;var x0=cx+Math.cos(startAngle)*ir,y0=cy+Math.sin(startAngle)*ir,x1=cx+Math.cos(endAngle)*ir,y1=cy+Math.sin(endAngle)*ir,x2=cx+Math.cos(endAngle)*or,y2=cy+Math.sin(endAngle)*or,x3=cx+Math.cos(startAngle)*or,y3=cy+Math.sin(startAngle)*or,largeArc=endAngle-startAngle>Math.PI?1:0;if(ir>0){return"M"+x0+" "+y0+" A"+ir+","+ir+" 0 "+largeArc+",1 "+x1+","+y1+" L"+x2+" "+y2+" A"+or+","+or+" 0 "+largeArc+",0 "+x3+" "+y3+" Z"}else{return"M"+cx+" "+cy+" L"+x2+" "+y2+" A"+or+","+or+" 0 "+largeArc+",0 "+x3+" "+y3+" Z"}}function updateLabelPos(){var r=label.hasClass("outside")?0.8:0.65;lx=me.cx+Math.cos((me.startAngle+me.endAngle)*0.5)*me.or*r,ly=me.cy+Math.sin((me.startAngle+me.endAngle)*0.5)*me.or*r;label.attr({x:lx,y:ly})}var running;function frame(){path.attr({path:arcPath()}).attr("stroke-linejoin","round");updateLabelPos();if(running){requestAnimationFrame(frame)}}var path=paper.path(arcPath());updateLabelPos();return{path:path,label:label,animate:function(cx,cy,or,ir,sa,ea,duration,easing){running=true;$(me).animate({cx:cx,cy:cy,or:or,ir:ir,startAngle:sa,endAngle:ea},{easing:easing,duration:duration,complete:function(){running=false;frame()}});requestAnimationFrame(frame)},startAngle:function(){return me.startAngle},endAngle:function(){return me.endAngle},midAngle:function(){return(me.startAngle+me.endAngle)*0.5}}}}).call(this);(function(){dw.visualization.register("donut-chart","pie-chart",{isDonut:function(){return true}})}).call(this);(function(){dw.visualization.register("grouped-column-chart","raphael-chart",{_showValueLabels:function(){return true},render:function(el){this.setRoot(el);var me=this,c=me.initCanvas({}),dataset=me.dataset,chart_width=c.w-c.lpad-c.rpad,series_gap=0.05,row_gap=0.01;me.axesDef=me.axes();if(!me.axesDef){return}if(!_.isUndefined(me.get("selected-row"))){row=me.get("selected-row")}me.checkData();me._color_opts={};if(me.get("negative-color",false)){me._color_opts.byValue=function(v){return me.theme().colors[v<0?"negative":"positive"]}}else{me._color_opts.varyLightness=true}me.init();var lh=0,barColumns=me.getBarColumns(),n=barColumns.length;_.each(barColumns,function(column,s){lh=Math.max(lh,me.labelHeight(column.title(),"series",c.w/(n)))});c.bpad+=lh;me.initDimensions();me.__bars={};me.__barLbls={};me.__gridlines={};me.__gridlabels={};me.__series_names={};if(!me.theme().columnChart.cutGridLines){me.horzGrid()}me.update();el.mousemove(_.bind(me.onMouseMove,me));if(dataset.numRows()>1){var items=[],lblFmt=me.chart().columnFormatter(me.axes(true).labels);dataset.eachRow(function(r){items.push({label:lblFmt(me.axes(true).labels.val(r)),color:me.getColor(null,r,{varyLightness:true,key:me.axes(true).labels.val(r)})})});me.addLegend(items,$("#header",c.root.parent()))}$(".showOnHover").hide();if(me.theme().columnChart.cutGridLines){me.horzGrid()}me.post_render();me.renderingComplete()},update:function(){var me=this,c=me.__canvas,n=me.axesDef.columns.length;_.each(me.getBarColumns(me.get("sort-values"),me.get("reverse-order")),function(column,s){column.each(function(val,r){me._color_opts.key=me.axes(true).labels.val(r);var d=me.barDimensions(column,s,r),fill=me.getColor(column,r,me._color_opts),stroke=chroma.color(fill).darken(10).hex(),key=column.name()+"-"+r,bar_attrs={x:d.x,y:d.y,width:d.w,height:d.h,stroke:stroke,fill:fill};me.__bars[key]=me.__bars[key]||me.registerElement(c.paper.rect().attr(bar_attrs),column.name(),r);if(me.theme().columnChart.barAttrs){me.__bars[key].attr(me.theme().columnChart.barAttrs)}me.__barLbls[key]=me.__barLbls[key]||me.registerLabel(me.label(0,0,"X",{align:"center",cl:"value"}),column.name());me.__barLbls[key].animate({x:d.x+d.w*0.5,y:d.y+d.h*0.5,txt:me.formatValue(column.val(r))},1000,"expoInOut");me.__barLbls[key].data("row",r);me.__barLbls[key].hide();me.__bars[key].animate(bar_attrs,me.theme().duration,me.theme().easing).data("strokeCol",stroke);var val_y=val>=0?d.y-10:d.y+d.h+10,lbl_y=val<0?d.y-10:d.y+d.h+5,lblcl=["series"],lbl_w=c.w/(n+2),valign=val>=0?"top":"bottom",halign="center",alwaysShow=(me.chart().hasHighlight()&&me.chart().isHighlighted(column.name()))||(d.w>40);if(me.chart().hasHighlight()&&me.chart().isHighlighted(column.name())){lblcl.push("highlighted")}if(d.bw<30){lbl_y+=5;lbl_w=100;halign="right"}if(d.bw<20){lblcl.push("smaller");lbl_w=90}if(!/^X\.\d+$/.test(column.title())&&r===0){var la={x:d.bx+d.bw*0.5,y:lbl_y,w:lbl_w,align:halign,valign:valign,cl:lblcl.join(" "),rotate:d.bw<30?-90:0},sl=me.__series_names[column.name()]=me.__series_names[column.name()]||me.registerLabel(me.label(la.x,la.y,column.title(),la),column.name());sl.animate(la,me.theme().duration,me.theme().easing)}})});var y=c.h-me.__scales.y(0)-c.bpad;me.path([["M",c.lpad,y],["L",c.w-c.rpad,y]],"axis").attr(me.theme().yAxis)},getBarColumns:function(sortBars,reverse){return this._getBarColumns(sortBars,reverse)},_getBarColumns:function(sortBars,reverse){var me=this,columns=_.map(me.axesDef.columns,function(i){return me.dataset.column(i)});if(sortBars){columns.sort(function(a,b){var aType=a.type(true);return aType.toNum?aType.toNum(a.val(0))-aType.toNum(b.val(0)):a.val()>b.val()?1:a.val()==b.val()?0:-1})}if(reverse){columns.reverse()}return columns},initDimensions:function(r){var me=this,c=me.__canvas;me.__domain=dw.utils.minMax(me.getBarColumns());if(me.__domain[0]>0){me.__domain[0]=0}if(me.__domain[1]<0){me.__domain[1]=0}me.__scales={y:d3.scale.linear().domain(me.__domain)};me.__scales.y.rangeRound([0,c.h-c.bpad-c.tpad-30])},barDimensions:function(column,s,r){var me=this,sc=me.__scales,c=me.__canvas,n=me.axesDef.columns.length,w,h,x,y,i,cw,bw,pad=0.35,vspace=0.1,val=column.val(r);if(c.w/n<30){vspace=0.05}cw=(c.w-c.lpad-c.rpad)*(1-vspace-vspace);bw=cw/(n+(n-1)*pad);h=sc.y(val)-sc.y(0);w=Math.round(bw/column.length);if(h>=0){y=c.h-c.bpad-sc.y(0)-h}else{y=c.h-c.bpad-sc.y(0);h*=-1}if(val!==0){h=Math.max(0.5,h)}x=Math.round((c.w-c.lpad-c.rpad)*vspace+c.lpad+s*(bw+bw*pad));return{w:w,h:h,x:x+Math.floor((w+1)*r),y:y,bx:x,bw:bw}},getDataRowByPoint:function(x,y){return 0},showTooltip:function(){},hideTooltip:function(){},horzGrid:function(){var me=this,yscale=me.__scales.y,c=me.__canvas,domain=me.__domain,styles=me.__styles,ticks=me.getYTicks(yscale,c.h,true);ticks=ticks.filter(function(val,t){return val>=domain[0]&&val<=domain[1]});_.each(ticks,function(val,t){var y=c.h-c.bpad-yscale(val),x=c.lpad,ly=y-10,lbl,txt=me.formatValue(val,t==ticks.length-1,true);if(me.theme().columnChart.cutGridLines){ly+=10}if(val!==0){lbl=me.__gridlabels[val]=me.__gridlabels[val]||me.label(x+2,ly,txt,{align:"left",cl:"axis",css:{opacity:0}});lbl.animate({x:x+2,y:ly,css:{opacity:1}},me.theme().duration,me.theme().easing)}if(me.theme().yTicks){me.path([["M",c.lpad-25,y],["L",c.lpad-20,y]],"tick")}if(me.theme().horizontalGrid){var p="M"+[c.lpad,y]+"H"+c.w,l=me.__gridlines[val]=me.__gridlines[val]||me.path(p,"grid").attr(me.theme().horizontalGrid).attr("opacity",0);if(val===0){l.attr(me.theme().xAxis)}else{if(me.theme().columnChart.cutGridLines){l.attr("stroke",me.theme().colors.background)}}l.animate({path:p,opacity:1},me.theme().duration,me.theme().easing);l.toBack()}});_.each(me.__gridlabels,function(lbl,val){if(_.indexOf(ticks,+val)<0){lbl.animate({css:{opacity:0}},me.theme().duration,me.theme().easing)}});_.each(me.__gridlines,function(line,val){if(_.indexOf(ticks,+val)<0){line.animate({opacity:0},me.theme().duration,me.theme().easing)}})},hover:function(hoveredSeries){var me=this,whitishBg=chroma.color(me.theme().colors.background).lch()[0]>60;function getFill(col,el){var fill=me.getColor(null,el.data("row"),{varyLightness:true,key:me.axes(true).labels.val(el.data("row"))});if(hoveredSeries!==undefined&&col.name()==dw.utils.name(hoveredSeries)){fill=chroma.color(fill).darken(whitishBg?15:-25).hex()}return fill}_.each(me.getBarColumns(),function(column){var fill,stroke;_.each(me.__labels[column.name()],function(lbl){if(hoveredSeries!==undefined&&column.name()==dw.utils.name(hoveredSeries)){lbl.addClass("hover");if(lbl.hasClass("showOnHover")){lbl.show(0.5)}}else{lbl.removeClass("hover");if(lbl.hasClass("showOnHover")){lbl.hide(0.5)}}if(lbl.hasClass("value")){lbl.removeClass("hover");fill=getFill(column,lbl);lbl.addClass("inverted")}});_.each(me.__elements[column.name()],function(el){fill=getFill(column,el);stroke=chroma.color(fill).darken(10).hex();if(el.attrs.fill!=fill||el.attrs.stroke!=stroke){el.animate({fill:fill,stroke:stroke},50)}})});var visibleLbls=[];_.each(me.__barLbls,function(lbl,key){if(hoveredSeries&&lbl.data("key")==dw.utils.name(hoveredSeries)){lbl.show();visibleLbls.push(lbl.data("label"))}else{lbl.hide()}});me.optimizeLabelPositions(visibleLbls,5)},unhoverSeries:function(){this.hoverSeries()},formatValue:function(){var me=this;me.formatValue=me.chart().columnFormatter(me.axes(true).columns[0]);return me.formatValue.apply(me,arguments)},post_render:function(){},checkData:function(){return true}})}).call(this);(function(){dw.visualization.register("stacked-column-chart","grouped-column-chart",{_showValueLabels:function(){return false},getBarColumns:function(sortBars,reverse){var me=this,stackedColumns=[],normalize=me.is_normalized(),columns=me._getBarColumns(sortBars,reverse);_.each(columns,function(column){var normValues;if(normalize){normValues=[];column.each(function(val){normValues.push(val/column.total())});stackedColumns.push(dw.column(column.name(),normValues))}else{stackedColumns.push(column)}});return stackedColumns},initDimensions:function(r){var me=this,c=me.__canvas,normalize=me.is_normalized(),dMin=0,dMax=0;_.each(me._getBarColumns(),function(column){if(normalize){dMin=0;dMax=1}else{dMin=Math.min(dMin,column.range()[0]);dMax=Math.max(dMax,column.total())}});me.__domain=normalize?[0,1]:[dMin,dMax];me.__scales={y:d3.scale.linear().domain(me.__domain)};me.__scales.y.rangeRound([0,c.h-c.bpad-c.tpad-30]);return},barDimensions:function(column,s,r){var me=this,sc=me.__scales,yo=me.__yoffset||0,c=me.__canvas,n=me.axesDef.columns.length,w,h,x,y,i,cw,bw,pad=0.35,vspace=0.1;if(c.w/n<30){vspace=0.05}cw=(c.w-c.lpad-c.rpad)*(1-vspace-vspace);bw=bw=cw/(n+(n-1)*pad);h=sc.y(column.val(r))-sc.y(0);if(r===0){yo=0}w=bw;if(h>=0){y=c.h-c.bpad-sc.y(0)-h}else{y=c.h-c.bpad-sc.y(0);h*=-1}x=Math.round((c.w-c.lpad-c.rpad)*vspace+c.lpad+s*(bw+bw*pad));y=y-yo;me.__yoffset=yo+h;return{w:w,h:h,x:x,y:y,bx:x,bw:bw}},formatValue:function(){var me=this,formatter=me.chart().columnFormatter(me.axes(true).columns[0]);me.formatValue=function(v,b,c){return me.is_normalized()?Math.round(v*100)+"%":formatter(v,b,c)};return me.formatValue.apply(me,arguments)},is_normalized:function(){var me=this;return me.get("normalize",false)&&(!me.get("normalize-user",false)||$("#normalize:checked").length>0)},post_render:function(){var me=this;if(me.get("normalize-user",false)){$(".header-right").remove();var chkNormalize=$('<div><label for="normalize"><input type="checkbox" id="normalize" /> '+me.translate("stack percentages")+"</label></div>");chkNormalize.addClass("header-right");$("#normalize",chkNormalize).on("change",function(){me.initDimensions();me.update();me.horzGrid()});$("#header").append(chkNormalize)}},checkData:function(){var me=this,ds=me.dataset,allPositive=true;_.each(me.getBarColumns(),function(column){column.each(function(val){if(val<0){allPositive=false;return false}});if(!allPositive){return false}});if(!allPositive){me.notify(me.translate("cannotShowNegativeValues"))}}})}).call(this);(function(){var trim=function(myString){return myString.replace(/^\s+/g,"").replace(/\s+$/g,"")};dw.visualization.register("data-table",{render:function(el){el=$(el);var me=this,table,tr,td,th,r,css_class=me.theme().datatable&&me.theme().datatable["class"]?me.theme().datatable["class"]:"datatable-default",isHighlighted=function(series){return me.chart().hasHighlight()&&me.chart().isHighlighted(series)},dataset=me.dataset;table=$('<table class="'+css_class+'" id="datatable"><thead /><tbody /></table>');tr=$("<tr />");var colType=[];dataset.eachColumn(function(column){th=$("<th>"+column.title()+"</th>");if(isHighlighted(column)){th.addClass("highlight")}var number_count=0;column.each(function(val){if(_.isNumber(val)){number_count++}});colType.push(column.type());tr.append(th)});$("thead",table).append(tr);_.each(_.range(dataset.numRows()),function(r){tr=$("<tr />");var highlighted_rows=me.get("highlighted-rows");if(_.isArray(highlighted_rows)&&_.indexOf(highlighted_rows,"Row "+(me.chart().rowLabel(r)+1))>=0){tr.addClass("highlight")}dataset.eachColumn(function(column,s){var cell_content=me.chart().columnFormatter(column)(column.val(r),true);if(cell_content=="n/a"){cell_content="&mdash;"}td=$("<td>"+cell_content+"</td>");if(isHighlighted(column)){td.addClass("highlight")}td.addClass(column.type());if(cell_content=="&mdash;"){td.addClass("not-available")}td.attr("title",column.title());tr.append(td)});$("tbody",table).append(tr)});el.append(table);if(me.get("table-responsive")){table.addClass("responsive")}var datatable_i18n={sEmptyTable:me.translate("sEmptyTable"),sInfo:me.translate("sInfo"),sInfoEmpty:me.translate("sInfoEmpty"),sInfoFiltered:me.translate("sInfoFiltered"),sInfoPostFix:"",sInfoThousands:me.translate("sInfoThousands"),sLengthMenu:me.translate("sLengthMenu"),sLoadingRecords:me.translate("sLoadingRecords"),sProcessing:me.translate("sProcessing"),sSearch:me.translate("sSearch"),sZeroRecords:me.translate("sZeroRecords"),oPaginate:{sFirst:me.translate("oPaginate_sFirst"),sLast:me.translate("oPaginate_sLast"),sNext:me.translate("oPaginate_sNext"),sPrevious:me.translate("oPaginate_sPrevious")},oAria:{sSortAscending:me.translate("oAria_sSortAscending"),sSortDescending:me.translate("oAria_sSortDescending")}};jQuery.extend(jQuery.fn.dataTableExt.oSort,{"formatted-num-pre":function(a){a=(a==="—"||a==="")?-1:a.replace(/[^\d\-\.,]/g,"").replace(",",".");return parseFloat(a)},"formatted-num-asc":function(a,b){return a-b},"formatted-num-desc":function(a,b){return b-a},"formatted-date-pre":function(a){return Globalize.parseDate(a)},"formatted-date-asc":function(a,b){return a&b?a.getTime()-b.getTime():0},"formatted-date-desc":function(a,b){return a&b?b.getTime()-a.getTime():0}});var colum_types=[];_.each(colType,function(type,s){if(type=="number"){colum_types.push({sType:"formatted-num"})}else{if(type=="date"){colum_types.push({sType:"formatted-date"})}else{colum_types.push({sType:null})}}});table.dataTable({bPaginate:me.get("table-paginate",false),bInfo:me.get("table-paginate",false),bFilter:me.get("table-filter",false),bSort:me.get("table-sortable",false),oLanguage:datatable_i18n,aoColumns:colum_types});el.append('<br style="clear:both"/>');me.renderingComplete()},keys:function(){return _.map(this.dataset.columns(),function(c){return c.name()})}})}).call(this);(function(){dw.visualization.register("maps","raphael-chart",{render:function(el){var me=this;me.setRoot(el);$.fn.qtip.defaults.style.classes="ui-tooltip-datawrapper";if(me.map&&me.get("map")==me.__lastSVG){me.updateMap();me.renderingComplete()}else{if(me.map){me._reset()}else{me.notifications=[]}if(me.get("map")!==undefined&&me.get("map-path")!==undefined){me.loadMap(el)}}},reset:function(){},_reset:function(){var me=this;me._localized_labels=undefined;me.map_meta=undefined;me.map.clear();$("#chart").html("").off("click").off("mousemove").off("mouseenter").off("mouseover");$(".chart .filter-ui").remove();$(".chart .legend").remove()},getSVG:function(){var me=this;return"assets/"+me.get("map-path")+"/map.svg"},loadMap:function(el){var me=this,c=me.__initCanvas({}),$map=$('<div id="map"></div>').html("").appendTo(el),map_path=me.get("map-path");function getMapMeta(){return $.getJSON("assets/"+map_path+"/map.json").done(function(res){me.map_meta=res})}function getLabelJSON(){var mapOpt=_.find(me.meta.options.map.options,function(m){return m.path==map_path});if(mapOpt.has_locale){return $.getJSON("assets/"+map_path+"/locale.json").done(function(res){me._all_locales=res;var loc=me.chart().locale().slice(0,2);if(res[loc]){me._localized_labels=res[loc]}})}return false}me.map=kartograph.map($map,c.w-10);me.__lastSVG=me.get("map");$.when(me.map.load(me.getSVG()),getMapMeta(),getLabelJSON()).done(function(r0,r1){var layers=_.pairs(r1[0].layers);nextLayer();me.__root.css("opacity",0);function nextLayer(){if(layers.length){var l=layers.shift();l[1].name=l[0];l[1].key="key";l[1].chunks=50;l[1].done=nextLayer;me.map.addLayer(l[1].src,l[1])}else{proceed()}}function proceed(){me.__root.css("opacity",1);if(me.map_meta.options){$.extend(me.map.opts,me.map_meta.options)}me.updateMap();me.map.getLayer("layer0").tooltips(_.bind(me.tooltip,me));me.renderingComplete()}})},updateMap:function(){var me=this,reverseAlias=getReverseAliases(),highlighted=me.get("highlighted-series",[]),data=[];me.data=getData();me.scale=colorByNumbers()?eval(me.get("gradient.chromajs-constructor")):(function(){var catColors=$.extend({},me.get("custom-colors",{})),colors=me.theme().colors.categories[me.get("category-color-preset",0)],num_colors=colors.length,pos=0;return function(cat){if(!catColors[cat]){catColors[cat]=colors[pos%num_colors];pos++}return chroma.hex(catColors[cat])}})();if(!me.scale){me.scale=chroma.scale("Reds")}me.map.getLayer("layer0").style({fill:fill,stroke:function(pd){var color=fill(pd);if(startsWith(color,"url(")){color=null}return chroma.hex(color||"#ccc").darken(25).hex()}},0,0);me.showLegend(me.scale);me.map.getLayer("layer0").sort(function(pd){var color=pd.__last_fill;if(startsWith(color,"url(")){color=null}return chroma.hex(color||"#ccc").luminance()*-1});try{me.map.removeSymbols()}catch(e){}if(highlighted.length>0){me.map.addSymbols({type:$K.HtmlLabel,data:_.filter(highlighted,function(key){return me.data[key]||me.data[reverseAlias[key]]}),location:function(key){if(!me.data[key]&&reverseAlias[key]){key=reverseAlias[key]}if(me.map_meta["custom-center"]&&me.map_meta["custom-center"][key]){return me.map_meta["custom-center"][key]}return"layer0."+key},text:function(key){if(!me.data[key]&&reverseAlias[key]){key=reverseAlias[key]}return me.data[key].label+"<br/>"+me.formatValue(me.data[key].value,true)},css:function(key){if(!me.data[key]&&reverseAlias[key]){key=reverseAlias[key]}var fill=chroma.hex(me.data[key].color).luminance()>0.5?"#000":"#fff";var css={color:fill,"font-size":"13px","line-height":"15px","text-shadow":("0 1px 0 %, 1px 0 0 %, 0 -1px 0 %, -1px 0 0 %,1px 1px 0 %, 1px -1px 0 %, -1px -1px 0 %, -1px 1px 0 %,0 2px 1px %, 2px 0 1px %, 0 -2px 1px %, -2px 0 1px %,-1px 2px 0px %, 2px -1px 0px %, -1px -2px 0px %, -2px -1px 0px %,1px 2px 0px %, 2px 1px 0px %, 1px -2px 0px %, -2px 1px 0px %").replace(/%/g,me.data[key].color)};return css}});if(me.map.layers["tooltip-target"]){me.map.getLayer("tooltip-target").remove();me.map.getLayer("tooltip-target").paper.remove();delete me.map.layers["tooltip-target"]}me.map.addLayer("layer0",{name:"tooltip-target",styles:{stroke:false,fill:"#fff",opacity:0},tooltips:_.bind(me.tooltip,me),add_svg_layer:true})}me.keyLabel=getLabel;function fill(path_data){if(path_data===undefined||(path_data===null)){return false}var data=me.data[path_data.key],no_data_color="url('"+window.__dw.vis.meta.__static_path+"stripped.png')";if(data!==undefined){var color;if(_.isNumber(data.raw)||!colorByNumbers()){if($.isFunction(me.scale)){color=me.scale(data.raw)?me.scale(data.raw).hex():"#f00"}else{color="#ccc"}data.color=color;path_data.__last_fill=color;return data.color}}return no_data_color}function colorByNumbers(){return me.axes(true).color.type()=="number"}function getReverseAliases(){var rev={};_.each(me.map_meta.keys,function(key){if(me.map_meta["alias-keys"]){_.each(me.map_meta["alias-keys"],function(alias){if(alias[key]){rev[alias[key]]=key}})}if(me._localized_labels&&me._localized_labels[key]){rev[me._localized_labels[key]]=key}if(me._all_locales){_.each(me._all_locales,function(labels){if(labels[key]){rev[labels[key]]=key}})}});return rev}function getKeyCandidates(key){var keys=[key];if(me.map_meta["alias-keys"]){_.each(me.map_meta["alias-keys"],function(alias){if(alias[key]){keys.push(alias[key])}})}if(me._all_locales){_.each(me._all_locales,function(labels){if(labels[key]){keys.push(labels[key])}})}return keys}function getData(){var data=getDataSeries(),filtered={},paths=me.map.getLayer("layer0").paths,pathIDs=[],found=0;_.each(paths,function(path){var key=path.data.key,keys=getKeyCandidates(key);pathIDs.push(key);_.some(keys,function(k){if(data[k]){filtered[key]=data[k];found++;return true}return false})});var missing_percent=1-found/paths.length;if(missing_percent>0.4){if(me.notifications["ids-mismatching"]===undefined){var template_ds=dw.dataset([dw.column("ID",pathIDs,"text"),dw.column("Label",_.map(pathIDs,function(k){return getLabel(k)}),"text"),dw.column("Value",_.times(pathIDs.length,function(){return _.random(0,Math.random()<0.2?1000:500)}),"number")]),template_csv="data:application/octet-stream;charset=utf-8,"+encodeURIComponent(template_ds.toCSV()).replace(/'/g,"%27");me.notifications["ids-mismatching"]=me.notify(me.translate("ids-mismatching").replace("%d",(missing_percent*100).toFixed(0)+"%").replace("%t",template_csv),"ids-mismatching")}}else{if(me.notifications["ids-mismatching"]){me.notifications["ids-mismatching"].fadeOutAndRemove();delete me.notifications["ids-mismatching"]}}return filtered}function getLabel(key){var layer0=me.map.getLayer("layer0");if(me._localized_labels&&me._localized_labels[key]){return me._localized_labels[key]}if(layer0){var paths=layer0.getPaths({key:key.toString()});if(paths.length&&paths[0].data.label){return paths[0].data.label}if(reverseAlias[key]){return getLabel(reverseAlias[key])}}return key}function getDataSeries(){var data={},keyColumn=me.axes(true).keys,valueColumn=me.axes(true).color;_.each(keyColumn.raw(),function(geo_code,index){var value=colorByNumbers()?valueColumn.val(index):valueColumn.raw(index);data[geo_code]={};data[geo_code].raw=value;data[geo_code].label=getLabel(geo_code);if(_.isNull(value)){data[geo_code].value="n/a"}else{data[geo_code].value=me.formatValue(value,true)}});return data}},resizeMap:function(w,h){var me=this,view=me.map.layers.layer0.view,ratio=view.height/view.width,winH=me.__h;h=Math.min(h,winH);if(me.__lastH&&me.__lastH==h&&me.__lastW==w){return}me.__lastH=h;me.__lastW=w;$("#map").css({height:h});me.map.resize(w,h)},showLegend:function(scale){var me=this,$legend=$("#chart .scale, #chart .legend").remove();if(me.axes(true).color.type()!="number"){var lvalues=[];$legend=$("<div />").addClass("legend");_.each(_.unique(me.axes(true).color.values()),function(val){var d=$("<div />").html(val).css({"border-left-color":me.scale(val)}).addClass("legend-item").appendTo($legend);d.hover(function mouseover(e){function o(pd){return me.data[pd.key]&&me.data[pd.key].raw==val?1:0.1}if(me.map.layers.bg){me.map.getLayer("bg").style("opacity",o)}me.map.getLayer("layer0").style("opacity",o)},function mouseout(){me.map.getLayer("layer0").style("opacity",1);if(me.map.layers.bg){me.map.getLayer("bg").style("opacity",1)}})});$("#map").before($legend)}else{$legend=$("<div />").addClass("scale");var domains=scale.domain(),legend_size=Math.min(Math.max(Math.min(300,me.__w),me.__w*0.6),500),domains_delta=domains[domains.length-1]-domains[0],offset=0,max_height=0,size_by_value=true,label_size=0;$legend.css("width",legend_size);_.each(domains,function(step,i){if(i>0){if((domains[i]-domains[i-1])/domains_delta*legend_size<20){size_by_value=false}}});var roundedDomains=dw.utils.smartRound(domains,1);_.each(domains,function(step,index){if(index<domains.length-1){var delta=domains[index+1]-step,color=scale(step),label=me.formatValue(roundedDomains[index],index==domains.length-2),size=size_by_value?delta/domains_delta*legend_size:legend_size/(domains.length-1),$step=$("<div class='step'></div>"),$sticker=$("<span class='sticker'></span>").appendTo($legend);$step.css({width:size,"background-color":color.hex()});$sticker.css("left",offset);if(step.toString().split(".")[1]&&step.toString().split(".")[1].length>2){step=Globalize.format(step,"n")}if(index>0){label_size+=size;if(label_size<30){label=""}else{label_size=0}$("<div />").addClass("value").html(label).appendTo($sticker)}else{$sticker.remove()}$step.hover(function(e){var stepColor=chroma.color($(e.target).css("background-color")).hex();function o(pd){return me.data[pd.key]&&me.data[pd.key].color==stepColor?1:0.1}if(me.map.layers.bg){me.map.getLayer("bg").style("opacity",o)}me.map.getLayer("layer0").style("opacity",o)},function(){me.map.getLayer("layer0").style("opacity",1);if(me.map.layers.bg){me.map.getLayer("bg").style("opacity",1)}});$legend.append($step);offset+=size}});$("<div />").addClass("scale_title label").attr("data-column",me.axes().color).attr("data-row",-1).html("<span>"+me.axes(true).color.title()+"</span>").prependTo($legend);$("#map").after($legend)}var h=$legend.outerHeight(true);me.resizeMap(me.__w,me.__h-h)},getStickersMaxWidth:function($scale){var max=0;_.each($scale.find(".sticker"),function(sticker){max=Math.max(max,$(sticker).outerWidth(false))});return max},tooltip:function(data,path,event){var me=this;if(me.data[data.key]===undefined){return false}return[me.data[data.key].label,me.data[data.key].value]},__initCanvas:function(canvas){var me=this;canvas=_.extend({w:me.__w,h:me.__h,rpad:me.theme().padding.right,lpad:me.theme().padding.left,bpad:me.theme().padding.bottom,tpad:me.theme().padding.top},canvas);me.__canvas=canvas;return canvas},keys:function(){var me=this;return me.axes(true).keys.values()},keyLabel:function(key){return key},formatValue:function(){var me=this;me.formatValue=me.chart().columnFormatter(me.axes(true).color);return me.formatValue.apply(me,arguments)},supportsSmartRendering:function(){return true},_svgCanvas:function(){if(!this.map||!this.map.layers||!this.map.layers.layer0){return null}return this.map.layers.layer0.paper.canvas}});function startsWith(str,starts){if(starts===""){return true}if(str===null||starts===null){return false}str=String(str);starts=String(starts);return str.length>=starts.length&&str.slice(0,starts.length)===starts}}).call(this);(function(){dw.visualization.register("election-donut-chart","donut-chart",{getFullArc:function(){return Math.PI*1.2},groupAfter:function(){return 10}})}).call(this);